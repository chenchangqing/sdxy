{"pages/é‡æ‹¾æœåŠ¡ç«¯/åŸŸåçš„æ³¨å†ŒåŠå¤‡æ¡ˆ.html":{"url":"pages/é‡æ‹¾æœåŠ¡ç«¯/åŸŸåçš„æ³¨å†ŒåŠå¤‡æ¡ˆ.html","title":"åŸŸåçš„æ³¨å†ŒåŠå¤‡æ¡ˆ","keywords":"","body":"åŸŸåçš„æ³¨å†ŒåŠå¤‡æ¡ˆ ä¸€ã€è´­ä¹°äº‘æœåŠ¡å™¨ æ‰“å¼€è…¾è®¯äº‘->äº§å“->çƒ­é—¨äº§å“->è½»é‡åº”ç”¨æœåŠ¡å™¨ äºŒã€è´­ä¹°åŸŸå è…¾è®¯äº‘Â·DNSPod å…¬å®‰å¤‡æ¡ˆæŒ‡å— è…¾è®¯äº‘Â·æ§åˆ¶å° ä¸‰ã€åŸŸåè§£æ è…¾è®¯äº‘Â·DNSè§£æDNSPod DNS.TECH åŸŸåæ£€æµ‹ åŸŸåå·²ç»å®åè®¤è¯ï¼Œä½†æ˜¯æ˜¾ç¤ºçŠ¶æ€è¿˜æ˜¯æ³¨å†Œå±€æš‚åœè§£æ å››ã€macä¸Šç™»å½•æœåŠ¡å™¨åŠä¸Šä¼  æŒ‡å®šç«¯å£å·è¿è¡Œgitbook serve --port 80 æ€æ ·åœ¨Macä¸ŠSSHå’ŒFTPï¼Ÿå®Œç¾æ›¿ä»£XShellæ˜¯å“ªä¸ªè½¯ä»¶ï¼Ÿitem2å—ï¼ŸRoyal TSX! æ²¡æœ‰æ¯”å®ƒæ›´å¥½ äº”ã€centos7.6ä¸Šå®‰è£…gitbook CentOS7.6å®‰è£…Nodejs(Npm) CentOS7ç³»ç»Ÿä¸­nodeå®‰è£…é…ç½® make_unique ä¸æ˜¯ 'std'æˆå‘˜ Centos 7é»˜è®¤gccç‰ˆæœ¬ä¸º4.8ï¼Œæœ‰æ—¶éœ€è¦æ›´é«˜ç‰ˆæœ¬çš„ï¼Œè¿™é‡Œä»¥å‡çº§è‡³8.3.1ç‰ˆæœ¬ä¸ºä¾‹ï¼Œåˆ†åˆ«æ‰§è¡Œä¸‹é¢ä¸‰æ¡å‘½ä»¤å³å¯ï¼Œæ— éœ€æ‰‹åŠ¨ä¸‹è½½æºç ç¼–è¯‘ Centos7å¸è½½nodejs åœ¨centos7ä¸Šå®‰è£…gitbook debug of plugin-mathjax of gitbook å…­ã€FTP Linux äº‘æœåŠ¡å™¨æ­å»º FTP æœåŠ¡ ä¸ƒã€Ngnix è¿å‰ç«¯éƒ½çœ‹å¾—æ‡‚çš„ã€ŠNginx å…¥é—¨æŒ‡å—ã€‹ Nginx æœåŠ¡å™¨ SSL è¯ä¹¦å®‰è£…éƒ¨ç½² Centos å®‰è£… Gitbook Centos7.6å®‰è£…å’Œé…ç½®æœ€æ–°ç‰ˆNginxæœåŠ¡ centOS7.6å®‰è£…Nginx "},"pages/é‡æ‹¾æœåŠ¡ç«¯/Javaå¼€å‘å·¥å…·.html":{"url":"pages/é‡æ‹¾æœåŠ¡ç«¯/Javaå¼€å‘å·¥å…·.html","title":"Javaå¼€å‘å·¥å…·","keywords":"","body":"Javaå¼€å‘å·¥å…· Spring Boot æˆ‘çš„Spring Bootå­¦ä¹ ä¹‹è·¯ï¼ IntelliJ IDEA IntelliJ IDEA 2022.2.3ç ´è§£ç‰ˆå›¾æ–‡æ•™ç¨‹mac,windows,linuxå‡é€‚ç”¨ï¼ˆ2022.11.10äº²æµ‹æœ‰æ•ˆï¼‰ "},"pages/mysql/Macä¸‹MYSQLçš„å®‰è£….html":{"url":"pages/mysql/Macä¸‹MYSQLçš„å®‰è£….html","title":"Macä¸‹MYSQLçš„å®‰è£…","keywords":"","body":"Macä¸‹MYSQLçš„å®‰è£… ç¯å¢ƒï¼šmacos 11.7.4 ä¸€ã€MYSQLä¸‹è½½ 1ã€è¿›å…¥å®˜ç½‘ï¼Œæ»‘åŠ¨è‡³æœ€ä¸‹æ–¹ï¼Œæ‰¾åˆ°Downloadsï¼Œç‚¹å‡»MySQL Community Serverã€‚2ã€ç‚¹å‡»Archivesï¼Œé€‰æ‹©Product Version:5.7.31ï¼Œé€‰æ‹©Operating System:macOSã€‚3ã€ä¸‹è½½â€œmacOS 10.14 (x86, 64-bit), Compressed TAR Archiveâ€ã€‚4ã€è§£å‹ç¼©ï¼š cd /usr/local/ sudo mkdir src sudo mv ~/Downloads/mysql-5.7.31-macos10.14-x86_64.tar.gz src sudo tar -xzvf mysql-5.7.31-macos10.14-x86_64.tar.gz sudo ln -sf mysql-5.7.31-macos10.14-x86_64 mysql sudo chown -R chenchangqing:staff mysql* äºŒã€é…ç½®ç¯å¢ƒå˜é‡ 1ã€ vi ~/.bash_profileï¼Œåœ¨ ~/.bashrc ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®é¡¹ã€‚ MYSQL_HOME=/usr/local/mysql export PATH=$PATH:$MYSQL_HOME/bin:$MYSQL_HOME/support-files 2ã€source ~/.bash_profileã€‚3ã€mysql --versionã€‚ chenchangqingdeMacBook-Pro-2:sdxy chenchangqing$ mysql --version mysql Ver 14.14 Distrib 5.7.31, for macos10.14 (x86_64) using EditLine wrapper 4ã€é”™è¯¯åˆ†æï¼š dyld: Symbol not found: __ZTTNSt3__118basic_stringstreamIcNS_11char_traitsIcEENS_9allocatorIcEEEE Referenced from: /usr/local/mysql/bin/mysql (which was built for Mac OS X 12.0) Expected in: /usr/lib/libc++.1.dylib in /usr/local/mysql/bin/mysql Abort trap: 6 å¦‚æœå‡ºç°ä»¥ä¸Šé”™è¯¯ï¼Œè¯´æ˜ä¸‹è½½çš„mysqlç‰ˆæœ¬å’Œå½“å‰çš„macosç³»ç»Ÿä¸åŒ¹é…ï¼Œæ¯”å¦‚â€œmacos 11.7.4â€ä¸‹è½½äº†â€œmacOS 13 (x86, 64-bit), Compressed TAR Archiveâ€ï¼Œå°±ä¼šå‡ºç°ä¸Šé¢çš„é”™è¯¯ã€‚ -bash: /usr/local/mysql/bin/mysql: Bad CPU type in executableã€‚ å¦‚æœå‡ºç°ä»¥ä¸Šé”™è¯¯ï¼Œè¯´æ˜ä¸‹è½½çš„mysqlç‰ˆæœ¬ä¸å½“å‰macosç³»ç»Ÿä¸åŒ¹é…CPUæ¶æ„ä¸åŒ¹é…ï¼Œæ¯”å¦‚â€œmacos 11.7.4â€ä¸‹è½½äº†â€œmacOS 12 (ARM, 64-bit), Compressed TAR Archiveâ€ï¼Œå°±ä¼šå‡ºç°ä¸Šé¢çš„é”™è¯¯ã€‚ ä¸‰ã€åˆå§‹åŒ–root chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysqld --initialize-insecure 2023-03-24T17:25:46.055794Z 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details). 2023-03-24T17:25:46.057786Z 0 [Warning] Setting lower_case_table_names=2 because file system for /usr/local/mysql-5.7.31-macos10.14-x86_64/data/ is case insensitive 2023-03-24T17:25:46.237798Z 0 [Warning] InnoDB: New log files created, LSN=45790 2023-03-24T17:25:46.269409Z 0 [Warning] InnoDB: Creating foreign key constraint system tables. 2023-03-24T17:25:46.329085Z 0 [Warning] No existing UUID has been found, so we assume that this is the first time that this server has been started. Generating a new UUID: e99f3ed4-ca68-11ed-b222-0a4a56d116f7. 2023-03-24T17:25:46.340828Z 0 [Warning] Gtid table is not ready to be used. Table 'mysql.gtid_executed' cannot be opened. 2023-03-24T17:25:46.790867Z 0 [Warning] CA certificate ca.pem is self signed. 2023-03-24T17:25:46.937195Z 1 [Warning] root@localhost is created with an empty password ! Please consider switching off the --initialize-insecure option. ä»è¾“å‡ºå¯ä»¥çœ‹åˆ°ï¼Œmysqld å·²ç»å¸®æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª root ç”¨æˆ·ï¼Œä¸”è¯¥ root ç”¨æˆ·çš„ password ä¸ºç©ºã€‚ å››ã€å¯åŠ¨MYSQL chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysql.server start Starting MySQL . SUCCESS! äº”ã€ç™»å½•root chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysql -uroot -p Enter password: Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 2 Server version: 5.7.31 MySQL Community Server (GPL) Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> å…­ã€ç»™rootç”¨æˆ·åˆ›å»ºå¯†ç  mysql> ALTER USER root@localhost IDENTIFIED WITH caching_sha2_password BY '123456'; -> ; ERROR 1524 (HY000): Plugin 'caching_sha2_password' is not loaded MySQLæ–°ç‰ˆé»˜è®¤ä½¿ç”¨caching_sha2_passwordä½œä¸ºèº«ä»½éªŒè¯æ’ä»¶ï¼Œè€Œæ—§ç‰ˆæ˜¯ä½¿ç”¨mysql_native_passwordã€‚å½“è¿æ¥MySQLæ—¶æŠ¥é”™â€œplugin caching_sha2_password could not be loadedâ€æ—¶ï¼Œå¯æ¢å›æ—§ç‰ˆæ’ä»¶ã€‚ mysql> ALTER USER root@localhost IDENTIFIED WITH mysql_native_password BY '123456'; Query OK, 0 rows affected (0.00 sec) mysql> FLUSH PRIVILEGES; Query OK, 0 rows affected (0.00 sec) mysql> quit Bye ä¸ƒã€å¸¸ç”¨å‘½ä»¤ 1ã€å¯åŠ¨MYSQL chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysql.server start Starting MySQL SUCCESS! 2ã€åœæ­¢MYSQL chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysql.server stop Shutting down MySQL .. SUCCESS! 3ã€é‡å¯MYSQL chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysql.server restart ERROR! MySQL server PID file could not be found! Starting MySQL . SUCCESS! 4ã€æ£€æŸ¥ MySQL è¿è¡ŒçŠ¶æ€ chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysql.server status SUCCESS! MySQL running (1725) å…«ã€å‚è€ƒ https://learnku.com/articles/62379 https://blog.csdn.net/weixin_33728077/article/details/113902283 https://www.cnblogs.com/yjmyzz/p/how-to-install-mysql8-on-mac-using-tar-gz.html "},"pages/jdbc/prepare.html":{"url":"pages/jdbc/prepare.html","title":"å‡†å¤‡å·¥ä½œ","keywords":"","body":"å‡†å¤‡å·¥ä½œ å·¥å…· Navicat for MySQL PowerDesigner JDK API "},"pages/jdbc/nature.html":{"url":"pages/jdbc/nature.html","title":"JDBCæœ¬è´¨","keywords":"","body":"JDBCæœ¬è´¨ JDBCæ˜¯ä»€ä¹ˆï¼Ÿ Java Database Connectivityï¼ˆJavaè¯­è¨€è¿æ¥æ•°æ®åº“ï¼‰ã€‚ JDBCçš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ JDBCæ˜¯SUNå…¬å¸åˆ¶å®šçš„ä¸€å¥—æ¥å£ï¼ˆinterfaceï¼‰ã€‚æ¥å£éƒ½æœ‰è°ƒç”¨è€…å’Œå®ç°è€…ï¼Œé¢å‘æ¥å£è°ƒç”¨ã€é¢å‘æ¥å£å†™å®ç°ç±»ï¼Œè¿™éƒ½å±äºé¢å‘æ¥å£ç¼–ç¨‹ã€‚java.sql.*ï¼Œè¿™ä¸ªè½¯ä»¶åŒ…ä¸‹æœ‰å¾ˆå¤šçš„æ¥å£ã€‚ ä¸ºä»€ä¹ˆè¦é¢å‘æ¥å£ç¼–ç¨‹ï¼Ÿ è§£è€¦åˆï¼šé™ä½ç¨‹åºçš„è€¦åˆåº¦ï¼Œæä¾›ç¨‹åºçš„æ‰©å±•åŠ›ã€‚å¤šæ€æœºåˆ¶å°±æ˜¯éå¸¸å…¸å‹çš„é¢å‘æŠ½è±¡ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯é¢å‘å…·ä½“ç¼–ç¨‹ã€‚ æˆ‘ä»¬å»ºè®®ï¼š Animal a = new Cat(); Animal b = new Dog(); // å–‚å…»çš„æ–¹æ³• public void feed(Animal a) { // é¢å‘çˆ¶ç±»å‹ç¼–ç¨‹ } æˆ‘ä»¬ä¸å»ºè®®ï¼š Cat a = new Cat(); Dog b = new Dog(); // å–‚å…»çš„æ–¹æ³• public void feed(Cat a) { // é¢å‘å®ç°ç±»ç¼–ç¨‹ } ä¸ºä»€ä¹ˆSUNåˆ¶å®šä¸€å¥—JDBCæ¥å£å‘¢ï¼Ÿ å› ä¸ºæ¯ä¸€ä¸ªæ•°æ®åº“çš„åº•å±‚å®ç°åŸç†ä¸ä¸€æ ·ï¼ŒOracleæ•°æ®åº“æœ‰è‡ªå·±çš„åŸç†ï¼ŒMYSQLæ•°æ®åº“ä¹Ÿæœ‰è‡ªå·±çš„åŸç†ï¼ŒMS SQLServeræ•°æ®åº“ä¹Ÿæœ‰è‡ªå·±çš„åŸç†ï¼Œæ¯ä¸ªæ•°æ®åº“éƒ½æœ‰è‡ªå·±ç‹¬ç‰¹çš„å®ç°åŸç†ã€‚ "},"pages/fultter/åœ¨MacOSä¸Šæ­å»ºFlutterå¼€å‘ç¯å¢ƒ.html":{"url":"pages/fultter/åœ¨MacOSä¸Šæ­å»ºFlutterå¼€å‘ç¯å¢ƒ.html","title":"åœ¨MacOSä¸Šæ­å»ºFlutterå¼€å‘ç¯å¢ƒ","keywords":"","body":"åœ¨MacOSä¸Šæ­å»ºFlutterå¼€å‘ç¯å¢ƒ é—®é¢˜è®°å½• ä¸‹è½½åœ°å€é”™è¯¯ åœ¨ä¸‹è½½fultterçš„æ—¶å€™ï¼Œéœ€è¦ä¸‹è½½macOSä¸‹çš„x64ï¼Œè€Œä¸æ˜¯arm64ã€‚å¦‚æœä½¿ç”¨äº†é”™è¯¯çš„CPUæ¶æ„ç±»å‹ï¼Œè¿è¡Œflutterå‘½ä»¤ï¼Œflutterä¼šæç¤ºCPUä¸æ”¯æŒçš„ä¿¡æ¯ã€‚ å‘½ä»¤è¡Œæ²¡æœ‰ç¿»å¢™ å¦‚æœæ²¡æœ‰ç¿»å¢™ï¼Œä¼šå¯¼è‡´ä»¥ä¸‹ä¸¤ä¸ªé”™è¯¯ï¼š HTTP Host availability check is taking a long time...[!] HTTP Host Availability âœ— HTTP host \"https://maven.google.com/\" is not reachable. Reason: An error occurred while checking the HTTP host: Operation timed out âœ— HTTP host \"https://cloud.google.com/\" is not reachable. Reason: An error occurred while checking the HTTP host: Operation timed out Android sdkmanager not found. https://stackoverflow.com/questions/70719767/android-sdkmanager-not-found-update-to-the-latest-android-sdk-and-ensure-that-t ! NO_PROXY is not set https://zhuanlan.zhihu.com/p/474652737 "},"pages/fultter/åˆ›å»ºFlutteråº”ç”¨.html":{"url":"pages/fultter/åˆ›å»ºFlutteråº”ç”¨.html","title":"åˆ›å»ºFlutteråº”ç”¨","keywords":"","body":"åˆ›å»ºFlutteråº”ç”¨ 1ï¼‰å®‰è£…Flutterå’ŒDartæ’ä»¶ 2ï¼‰åˆ›å»ºFlutteråº”ç”¨ 3ï¼‰Organizationå‘½åä¸è§„èŒƒé”™è¯¯ å‘ç°ä¸€ä¸ªé”™è¯¯ï¼ŒOrganizationå‘½åä¸è§„èŒƒï¼Œä¸èƒ½å‡ºç°çº¯æ•°å­—ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š 4ï¼‰AndroidçœŸæœºè¿è¡Œ 5ï¼‰iOSæ¨¡æ‹Ÿå™¨è¿è¡Œ 6ï¼‰åœ¨Android Studioä¸Šé€‰æ‹©å¤šè®¾å¤‡è¿è¡Œ æ•ˆæœï¼š ã€ŠFlutterå®æˆ˜Â·ç¬¬äºŒç‰ˆã€‹1.3.2 ï½ 1.3.3 "},"pages/fultter/ç¬¬ä¸€ä¸ªFlutteråº”ç”¨.html":{"url":"pages/fultter/ç¬¬ä¸€ä¸ªFlutteråº”ç”¨.html","title":"ç¬¬ä¸€ä¸ªFlutteråº”ç”¨","keywords":"","body":"ç¬¬ä¸€ä¸ªFlutteråº”ç”¨ æ¨¡æ¿ä»£ç åˆ†æ 1. å¯¼å…¥åŒ… import 'package:flutter/material.dart'; æ­¤è¡Œä»£ç ä½œç”¨æ˜¯å¯¼å…¥äº† Material UI ç»„ä»¶åº“ã€‚ 2. åº”ç”¨å…¥å£ void main() => runApp(MyApp()); å¯åŠ¨Flutteråº”ç”¨ï¼šmainè°ƒç”¨runAppï¼ŒrunAppæ¥å—MyAppå¯¹è±¡å‚æ•°ï¼ŒMyApp()æ˜¯ Flutteråº”ç”¨æ ¹ç»„ä»¶ã€‚ 3. åº”ç”¨ç»“æ„ class MyApp extends StatelessWidget { @override Widget build(BuildContext context) { return MaterialApp( //åº”ç”¨åç§° title: 'Flutter Demo', theme: ThemeData( //è“è‰²ä¸»é¢˜ primarySwatch: Colors.blue, ), //åº”ç”¨é¦–é¡µè·¯ç”± home: MyHomePage(title: 'Flutter Demo Home Page'), ); } } MyAppç±»ä»£è¡¨Flutteråº”ç”¨ï¼Œç»§æ‰¿äº†StatelessWidgetç±»ï¼Œæ˜¯ä¸€ä¸ªwidgetã€‚ Flutteré€šè¿‡widgetæä¾›çš„buildæ–¹æ³•æ¥æ„å»ºUIç•Œé¢ã€‚ MaterialAppæ˜¯Flutter APPæ¡†æ¶ï¼Œå¯ä»¥è®¾ç½®åº”ç”¨çš„åç§°ã€ä¸»é¢˜ã€è¯­è¨€ã€é¦–é¡µåŠè·¯ç”±åˆ—è¡¨ç­‰ã€‚ homeæŒ‡å®šäº†Appçš„é¦–é¡µï¼Œæ˜¯ä¸€ä¸ªwidgetã€‚ é¦–é¡µ 1. MyHomePageç±» class MyHomePage extends StatefulWidget { MyHomePage({Key? key, required this.title}) : super(key: key); final String title; @override _MyHomePageState createState() => _MyHomePageState(); } class _MyHomePageState extends State { ... } MyHomePageæ˜¯åº”ç”¨é¦–é¡µï¼Œå®ƒç»§æ‰¿è‡ªStatefulWidgetç±»ï¼Œè¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªæœ‰çŠ¶æ€çš„ç»„ä»¶ï¼ˆStateful widgetï¼‰ã€‚ MyHomePageæ²¡æœ‰æä¾›buildæ–¹æ³•ï¼Œä½†æ˜¯å®ƒæœ‰_MyHomePageStateçŠ¶æ€ç±»ï¼Œbulidæ–¹æ³•è¢«æŒªåˆ°äº†è¿™ä¸ªçŠ¶æ€ç±»ï¼Œ 2. Stateç±» ç»„ä»¶çš„çŠ¶æ€ã€‚int _counter = 0; //ç”¨äºè®°å½•æŒ‰é’®ç‚¹å‡»çš„æ€»æ¬¡æ•° è®¾ç½®çŠ¶æ€çš„è‡ªå¢å‡½æ•°ã€‚ void _incrementCounter() { setState(() { _counter++; }); } ç‚¹å‡»æŒ‰é’®+æ—¶ä¼šè°ƒç”¨ï¼Œé€šè¿‡setStateé€šçŸ¥FlutterçŠ¶æ€ä¿®æ”¹äº†ï¼Œç„¶åé‡æ–°æ‰§è¡Œbuildæ–¹æ³•é‡æ–°æ„å»ºUIã€‚ æ„å»ºUIç•Œé¢çš„buildæ–¹æ³• Widget build(BuildContext context) { return Scaffold( appBar: AppBar( title: Text(widget.title), ), body: Center( child: Column( mainAxisAlignment: MainAxisAlignment.center, children: [ Text('You have pushed the button this many times:'), Text( '$_counter', style: Theme.of(context).textTheme.headline4, ), ], ), ), floatingActionButton: FloatingActionButton( onPressed: _incrementCounter, tooltip: 'Increment', child: Icon(Icons.add), ), ); } Scaffoldæ˜¯ Material åº“ä¸­æä¾›çš„é¡µé¢è„šæ‰‹æ¶ã€‚ bodyæ˜¯å…·ä½“çš„ç»„ä»¶æ ‘ã€‚ floatingActionButtonå³ä¸‹è§’çš„åŠ å·æŒ‰é’®ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ•´ä¸ªè®¡æ•°å™¨æ‰§è¡Œæµç¨‹ä¸²èµ·æ¥ï¼šå½“å³ä¸‹è§’çš„floatingActionButtonæŒ‰é’®è¢«ç‚¹å‡»ä¹‹åï¼Œä¼šè°ƒç”¨_incrementCounteræ–¹æ³•ã€‚åœ¨_incrementCounteræ–¹æ³•ä¸­ï¼Œé¦–å…ˆä¼šè‡ªå¢_counterè®¡æ•°å™¨ï¼ˆçŠ¶æ€ï¼‰ï¼Œç„¶åsetStateä¼šé€šçŸ¥ Flutter æ¡†æ¶çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œæ¥ç€ï¼ŒFlutter æ¡†æ¶ä¼šè°ƒç”¨buildæ–¹æ³•ä»¥æ–°çš„çŠ¶æ€é‡æ–°æ„å»ºUIï¼Œæœ€ç»ˆæ˜¾ç¤ºåœ¨è®¾å¤‡å±å¹•ä¸Šã€‚ 3. buildæ–¹æ³•æ”¾åœ¨Stateçš„åŸå›  ä¸ºä»€ä¹ˆè¦å°†buildæ–¹æ³•æ”¾åœ¨Stateä¸­ï¼Œè€Œä¸æ˜¯æ”¾åœ¨StatefulWidgetä¸­ï¼Ÿ çŠ¶æ€è®¿é—®ä¸ä¾¿ã€‚ å°†buildæ–¹æ³•æ”¾åœ¨widgetä¸­ï¼Œç”±äºæ„å»ºUIéœ€è¦è®¿é—®Stateçš„å±æ€§ï¼Œä¾‹å¦‚ä¸Šé¢çš„_counterï¼Œä¹Ÿå°±æ˜¯è¯´buildæ–¹æ³•éœ€è¦ä¾èµ–State ï¼Œå¹¶ä¸”å…¬å¼€_counterï¼Œè¿™å°±ä¼šå¯¼è‡´å¯¹çŠ¶æ€çš„ä¿®æ”¹å°†ä¼šå˜çš„ä¸å¯æ§ã€‚åä¹‹ï¼Œbuildæ”¾åœ¨Stateä¸­ï¼Œå¯ä»¥ç›´æ¥è®¿é—®çŠ¶æ€ï¼Œå¹¶ä¸”æ‹¿åˆ°_counterï¼Œè¿™ä¼šéå¸¸æ–¹ä¾¿ã€‚ ç»§æ‰¿StatefulWidgetä¸ä¾¿ã€‚ å­ç±»åœ¨è°ƒç”¨çˆ¶ç±»buildæ–¹æ³•æ—¶ï¼Œéœ€è¦ä¾èµ–çˆ¶ç±»Stateç±»ï¼Œè¿™æ˜¯ä¸åˆç†çš„ï¼Œå› ä¸ºçˆ¶ç±»çš„çŠ¶æ€æ˜¯çˆ¶ç±»å†…éƒ¨çš„å®ç°ç»†èŠ‚ï¼Œä¸åº”è¯¥æš´éœ²ç»™å­ç±»ã€‚ æ¨¡æ¿ä»£ç åˆ†æ "},"pages/fultter/Widgetç®€ä»‹.html":{"url":"pages/fultter/Widgetç®€ä»‹.html","title":"Widgetç®€ä»‹","keywords":"","body":"Widgetç®€ä»‹ Widgetæ¦‚å¿µ æè¿°ä¸€ä¸ªUIå…ƒç´ çš„é…ç½®ä¿¡æ¯ï¼Œæ¯”å¦‚å¯¹äºTextæ¥è®²ï¼Œæ–‡æœ¬çš„å†…å®¹ã€å¯¹é½æ–¹å¼ã€æ–‡æœ¬æ ·å¼éƒ½æ˜¯å®ƒçš„é…ç½®ä¿¡æ¯ã€‚ Widgetç±»çš„å£°æ˜ï¼š @immutable // ä¸å¯å˜çš„ abstract class`Widget`extends DiagnosticableTree { const Widget({ this.key }); final Key? key; @protected @factory Element createElement(); @override String toStringShort() { final String type = objectRuntimeType(this, 'Widget'); return key == null ? type : '$type-$key'; } @override void debugFillProperties(DiagnosticPropertiesBuilder properties) { super.debugFillProperties(properties); properties.defaultDiagnosticsTreeStyle = DiagnosticsTreeStyle.dense; } @override @nonVirtual bool operator ==(Object other) => super == other; @override @nonVirtual int get hashCode => super.hashCode; static bool canUpdate(Widget oldWidget,`Widget`newWidget) { return oldWidget.runtimeType == newWidget.runtimeType && oldWidget.key == newWidget.key; } ... } @immutableä»£è¡¨Widgetæ˜¯ä¸å¯å˜çš„ï¼Œé™åˆ¶Widgetä¸­çš„å±æ€§å¿…é¡»ä½¿ç”¨finalä¿®é¥°ã€‚ ä¸ºå•¥ä¸å…è®¸å±æ€§ä¿®æ”¹å‘¢ï¼Ÿå±æ€§ä¿®æ”¹ä¼šé‡æ–°åˆ›å»ºæ–°çš„Widgetå®ä¾‹ï¼Œè¿™æ²¡æœ‰æ„ä¹‰ï¼Œè¿˜æœ‰å°±æ˜¯å¯å˜å±æ€§åº”è¯¥äº¤ç»™Stateç®¡ç†ã€‚ keyçš„ä½œç”¨æ˜¯å†³å®šä¸‹ä¸€æ¬¡buildæ˜¯å¦å¤ç”¨æ—§çš„widgetï¼Œå†³å®šçš„æ¡ä»¶åœ¨canUpdate()æ–¹æ³•ã€‚ createElementæ„å»ºUIæ ‘æ—¶ï¼Œç”Ÿæˆå¯¹åº”èŠ‚ç‚¹çš„Elementå¯¹è±¡ã€‚ä¸€ä¸ªwidgetå¯ä»¥å¯¹åº”å¤šä¸ªElementã€‚ canUpdate(...)ï¼šæ˜¯å¦ç”¨æ–°çš„widgetå¯¹è±¡å»æ›´æ–°æ—§UIæ ‘ä¸Šæ‰€å¯¹åº”çš„Elementå¯¹è±¡çš„é…ç½®ï¼Œè¿”å›falseçš„è¯ï¼Œä¼šé‡æ–°åˆ›å»ºæ–°çš„Elementã€‚ Widgetç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå…¶ä¸­æœ€æ ¸å¿ƒçš„å°±æ˜¯å®šä¹‰äº†createElement()æ¥å£ã€‚ Flutterä¸­çš„å››æ£µæ ‘ Widget åªæ˜¯æè¿°ä¸€ä¸ªUIå…ƒç´ çš„é…ç½®ä¿¡æ¯ï¼Œé‚£ä¹ˆçœŸæ­£çš„å¸ƒå±€ã€ç»˜åˆ¶æ˜¯ç”±è°æ¥å®Œæˆçš„å‘¢ï¼ŸFlutter æ¡†æ¶çš„çš„å¤„ç†æµç¨‹æ˜¯è¿™æ ·çš„ï¼š æ ¹æ®Widgetæ ‘ç”Ÿæˆä¸€ä¸ª Element æ ‘ï¼ŒElement æ ‘ä¸­çš„èŠ‚ç‚¹éƒ½ç»§æ‰¿è‡ª Element ç±»ã€‚ æ ¹æ® Element æ ‘ç”ŸæˆRenderæ ‘ï¼ˆæ¸²æŸ“æ ‘ï¼‰ï¼Œæ¸²æŸ“æ ‘ä¸­çš„èŠ‚ç‚¹éƒ½ç»§æ‰¿è‡ªRenderObject ç±»ã€‚ æ ¹æ®æ¸²æŸ“æ ‘ç”Ÿæˆ Layer æ ‘ï¼Œç„¶åä¸Šå±æ˜¾ç¤ºï¼ŒLayer æ ‘ä¸­çš„èŠ‚ç‚¹éƒ½ç»§æ‰¿è‡ª Layer ç±»ã€‚ çœŸæ­£çš„å¸ƒå±€å’Œæ¸²æŸ“é€»è¾‘åœ¨Renderæ ‘ä¸­ï¼ŒElement æ˜¯Widgetå’Œ RenderObject çš„ç²˜åˆå‰‚ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªä¸­é—´ä»£ç†ã€‚ Widgetç±» 1. StatelessWidget ç»§æ‰¿Widgetç±»ï¼Œé‡å†™äº†createElement()æ–¹æ³•ï¼Œå¯¹åº”StatelessElementç±»ã€‚ ç”¨äºä¸éœ€è¦ç»´æŠ¤çŠ¶æ€çš„åœºæ™¯ï¼Œæœ‰ä¸€ä¸ªbuildæ–¹æ³•ç”¨æ¥æ„å»ºUIã€‚ 2. BuildContext buildæ–¹æ³•çš„contextå‚æ•°ï¼Œè¡¨ç¤ºå½“å‰widgetåœ¨widgetæ ‘ä¸­çš„ä¸Šä¸‹æ–‡ï¼Œæ¯ä¸ªwidgetå¯¹åº”ä¸€ä¸ªcontextã€‚ contextæ˜¯å½“å‰widgetåœ¨widgetæ ‘ä¸­ä½ç½®ä¸­æ‰§è¡Œâ€ç›¸å…³æ“ä½œâ€œçš„ä¸€ä¸ªå¥æŸ„ã€‚ 3. StatefulWidget å¯¹åº”StatefulElementï¼Œå¤šäº†ä¸€ä¸ªcreateState()æ–¹æ³•ã€‚ StatefulElementä¸­å¯èƒ½ä¼šå¤šæ¬¡è°ƒç”¨createState()æ¥åˆ›å»ºçŠ¶æ€ï¼ˆStateï¼‰å¯¹è±¡ã€‚ createState()ç”¨äºåˆ›å»ºå’ŒStatefulWidgetç›¸å…³çš„çŠ¶æ€ï¼Œå®ƒåœ¨StatefulWidgetçš„ç”Ÿå‘½å‘¨æœŸä¸­å¯èƒ½ä¼šè¢«å¤šæ¬¡è°ƒç”¨ã€‚ åœ¨StatefulWidgetä¸­ï¼ŒStateå¯¹è±¡å’ŒStatefulElementå…·æœ‰ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚ State 1. ç®€ä»‹ ä¸€ä¸ªStatefulWidgetç±»ä¼šå¯¹åº”ä¸€ä¸ªStateç±»ï¼ŒStateè¡¨ç¤ºä¸å…¶å¯¹åº”çš„StatefulWidgetè¦ç»´æŠ¤çš„çŠ¶æ€ã€‚State ä¸­çš„ä¿å­˜çš„çŠ¶æ€ä¿¡æ¯å¯ä»¥ï¼š åœ¨widgetæ„å»ºæ—¶å¯ä»¥è¢«åŒæ­¥è¯»å–ã€‚ å¯ä»¥ä¿®æ”¹ï¼Œç„¶åæ‰‹åŠ¨è°ƒç”¨å…¶setState()æ–¹æ³•ï¼Œé‡æ–°è°ƒç”¨å…¶buildæ–¹æ³•è¾¾åˆ°æ›´æ–°UIçš„ç›®çš„ã€‚ State ä¸­æœ‰ä¸¤ä¸ªå¸¸ç”¨å±æ€§ï¼š widgetï¼Œé‡æ–°æ„å»ºæ—¶å¯èƒ½ä¼šå˜åŒ–ï¼Œä½†Stateå®ä¾‹åªä¼šåœ¨ç¬¬ä¸€æ¬¡æ’å…¥åˆ°æ ‘ä¸­æ—¶è¢«åˆ›å»ºã€‚ contextï¼ŒStatefulWidgetå¯¹åº”çš„BuildContextã€‚ 2. Stateç”Ÿå‘½å‘¨æœŸ initStateï¼šå½“widgetç¬¬ä¸€æ¬¡æ’å…¥åˆ°widgetæ ‘æ—¶ä¼šè¢«è°ƒç”¨ã€‚ didChangeDependenciesï¼šå½“Stateå¯¹è±¡çš„ä¾èµ–å‘ç”Ÿå˜åŒ–æ—¶ä¼šè¢«è°ƒç”¨ã€‚ build()ä¼šåœ¨å¦‚ä¸‹åœºæ™¯è¢«è°ƒç”¨ï¼š åœ¨è°ƒç”¨initState()ä¹‹åã€‚ åœ¨è°ƒç”¨didUpdateWidget()ä¹‹åã€‚ åœ¨è°ƒç”¨setState()ä¹‹åã€‚ åœ¨è°ƒç”¨didChangeDependencies()ä¹‹åã€‚ åœ¨Stateå¯¹è±¡ä»æ ‘ä¸­ä¸€ä¸ªä½ç½®ç§»é™¤åï¼ˆä¼šè°ƒç”¨deactivateï¼‰åˆé‡æ–°æ’å…¥åˆ°æ ‘çš„å…¶ä»–ä½ç½®ä¹‹åã€‚ reassembleï¼šçƒ­é‡è½½(hot reload)æ—¶ä¼šè¢«è°ƒç”¨ï¼Œæ­¤å›è°ƒåœ¨Releaseæ¨¡å¼ä¸‹æ°¸è¿œä¸ä¼šè¢«è°ƒç”¨ã€‚ didUpdateWidgetï¼šåœ¨widgeté‡æ–°æ„å»ºæ—¶ï¼ŒFlutter æ¡†æ¶ä¼šè°ƒç”¨widget.canUpdateæ¥æ£€æµ‹widgetæ ‘ä¸­åŒä¸€ä½ç½®çš„æ–°æ—§èŠ‚ç‚¹ï¼Œç„¶åå†³å®šæ˜¯å¦éœ€è¦æ›´æ–°ï¼Œå¦‚æœwidget.canUpdateè¿”å›trueåˆ™ä¼šè°ƒç”¨æ­¤å›è°ƒã€‚ deactivateï¼šå½“ State å¯¹è±¡ä»æ ‘ä¸­è¢«ç§»é™¤æ—¶ï¼Œä¼šè°ƒç”¨æ­¤å›è°ƒã€‚ disposeï¼šå½“ State å¯¹è±¡ä»æ ‘ä¸­è¢«æ°¸ä¹…ç§»é™¤æ—¶è°ƒç”¨ã€‚ åœ¨widgetæ ‘ä¸­è·å–Stateå¯¹è±¡ 1. é€šè¿‡Contextè·å– findAncestorStateOfTypeæ–¹æ³•ï¼š // æŸ¥æ‰¾çˆ¶çº§æœ€è¿‘çš„Scaffoldå¯¹åº”çš„ScaffoldStateå¯¹è±¡ ScaffoldState _state = context.findAncestorStateOfType()!; // æ‰“å¼€æŠ½å±‰èœå• _state.openDrawer(); StatefulWidgetä¸­æä¾›ä¸€ä¸ªofé™æ€æ–¹æ³•æ¥è·å–å…¶Stateå¯¹è±¡ã€‚// ç›´æ¥é€šè¿‡ofé™æ€æ–¹æ³•æ¥è·å–ScaffoldState ScaffoldState _state=Scaffold.of(context); // æ‰“å¼€æŠ½å±‰èœå• _state.openDrawer(); 2. é€šè¿‡GlobalKey ç»™ç›®æ ‡StatefulWidgetæ·»åŠ GlobalKeyã€‚ //å®šä¹‰ä¸€ä¸ªglobalKey, ç”±äºGlobalKeyè¦ä¿æŒå…¨å±€å”¯ä¸€æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨é™æ€å˜é‡å­˜å‚¨ static GlobalKey _globalKey= GlobalKey(); ... Scaffold( key: _globalKey , //è®¾ç½®key ... ) é€šè¿‡GlobalKeyæ¥è·å–Stateå¯¹è±¡ _globalKey.currentState.openDrawer() é€šè¿‡ RenderObject è‡ªå®šä¹‰ Widget é€šè¿‡RenderObjectå®šä¹‰ç»„ä»¶çš„æ–¹å¼ï¼š class CustomWidget extends LeafRenderObjectWidget{ @override RenderObject createRenderObject(BuildContext context) { // åˆ›å»º RenderObject return RenderCustomObject(); } @override void updateRenderObject(BuildContext context, RenderCustomObject renderObject) { // æ›´æ–° RenderObject super.updateRenderObject(context, renderObject); } } class RenderCustomObject extends RenderBox{ @override void performLayout() { // å®ç°å¸ƒå±€é€»è¾‘ } @override void paint(PaintingContext context, Offset offset) { // å®ç°ç»˜åˆ¶ } } å¦‚æœç»„ä»¶ä¸ä¼šåŒ…å«å­ç»„ä»¶ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥ç›´æ¥ç»§æ‰¿è‡ª LeafRenderObjectWidgetã€‚ abstract class LeafRenderObjectWidget extends RenderObjectWidget { const LeafRenderObjectWidget({ Key? key }) : super(key: key); @override LeafRenderObjectElement createElement() => LeafRenderObjectElement(this); } é‡å†™äº† createRenderObject æ–¹æ³•ã€‚è¯¥æ–¹æ³•è¢«ç»„ä»¶å¯¹åº”çš„ Element è°ƒç”¨ï¼ˆæ„å»ºæ¸²æŸ“æ ‘æ—¶ï¼‰ç”¨äºç”Ÿæˆæ¸²æŸ“å¯¹è±¡ã€‚ updateRenderObject æ–¹æ³•æ˜¯ç”¨äºåœ¨ç»„ä»¶æ ‘çŠ¶æ€å‘ç”Ÿå˜åŒ–ä½†ä¸éœ€è¦é‡æ–°åˆ›å»º RenderObject æ—¶ç”¨äºæ›´æ–°ç»„ä»¶æ¸²æŸ“å¯¹è±¡çš„å›è°ƒã€‚ RenderCustomObject ç±»æ˜¯ç»§æ‰¿è‡ª RenderBoxï¼Œè€Œ RenderBox ç»§æ‰¿è‡ª RenderObjectï¼Œæˆ‘ä»¬éœ€è¦åœ¨ RenderCustomObject ä¸­å®ç°å¸ƒå±€ã€ç»˜åˆ¶ã€äº‹ä»¶å“åº”ç­‰é€»è¾‘ Flutter SDKå†…ç½®ç»„ä»¶åº“ä»‹ç» 1. åŸºç¡€ç»„ä»¶ è¦ä½¿ç”¨åŸºç¡€ç»„ä»¶åº“ï¼Œéœ€è¦å…ˆå¯¼å…¥ï¼š import 'package:flutter/widgets.dart'; Textï¼šæ–‡æœ¬ã€‚ Rowã€Columnï¼šåœ¨æ°´å¹³ï¼ˆRowï¼‰å’Œå‚ç›´ï¼ˆColumnï¼‰æ–¹å‘ä¸Šåˆ›å»ºçµæ´»çš„å¸ƒå±€ã€‚ Stackï¼šå–ä»£çº¿æ€§å¸ƒå±€ã€‚ Containerï¼šçŸ©å½¢è§†è§‰å…ƒç´ ã€‚ 2. Materialç»„ä»¶ Androidç³»UIã€‚ è¦ä½¿ç”¨ Material ç»„ä»¶ï¼Œéœ€è¦å…ˆå¼•å…¥å®ƒï¼š import 'package:flutter/material.dart'; Material åº”ç”¨ç¨‹åºä»¥MaterialApp (opens new window) ç»„ä»¶å¼€å§‹ã€‚ Material ç»„ä»¶æœ‰Scaffoldã€AppBarã€TextButtonç­‰ã€‚ 3. Cupertinoç»„ä»¶ iOSç³»UIã€‚ MaterialPageRouteï¼šåœ¨è·¯ç”±åˆ‡æ¢æ—¶ï¼Œå¦‚æœæ˜¯ Android ç³»ç»Ÿï¼Œå®ƒå°†ä¼šä½¿ç”¨ Android ç³»ç»Ÿé»˜è®¤çš„é¡µé¢åˆ‡æ¢åŠ¨ç”»(ä»åº•å‘ä¸Š)ï¼›å¦‚æœæ˜¯ iOS ç³»ç»Ÿï¼Œå®ƒä¼šä½¿ç”¨ iOS ç³»ç»Ÿé»˜è®¤çš„é¡µé¢åˆ‡æ¢åŠ¨ç”»ï¼ˆä»å³å‘å·¦ï¼‰ã€‚ Cupertino ç»„ä»¶é£æ ¼çš„é¡µé¢ï¼š //å¯¼å…¥cupertino `widget`åº“ import 'package:flutter/cupertino.dart'; class CupertinoTestRoute extends StatelessWidget { @override `widget`build(BuildContext context) { return CupertinoPageScaffold( navigationBar: CupertinoNavigationBar( middle: Text(\"Cupertino Demo\"), ), child: Center( child: CupertinoButton( color: CupertinoColors.activeBlue, child: Text(\"Press\"), onPressed: () {} ), ), ); } } æ€»ç»“ Flutter çš„widgetç±»å‹åˆ†ä¸ºStatefulWidget å’Œ StatelessWidget ä¸¤ç§ã€‚ å¼•å…¥è¿‡å¤šç»„ä»¶åº“ä¼šè®©ä½ çš„åº”ç”¨å®‰è£…åŒ…å˜å¤§ã€‚ ç”±äº Material å’Œ Cupertino éƒ½æ˜¯åœ¨åŸºç¡€ç»„ä»¶åº“ä¹‹ä¸Šçš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬çš„åº”ç”¨ä¸­å¼•å…¥äº†è¿™ä¸¤è€…ä¹‹ä¸€ï¼Œåˆ™ä¸éœ€è¦å†å¼•å…¥flutter/ widgets.dartäº†ï¼Œå› ä¸ºå®ƒä»¬å†…éƒ¨å·²ç»å¼•å…¥è¿‡äº†ã€‚ Widget ç®€ä»‹Flutterä¸­Widget ã€Elementã€RenderObjectè§’è‰²æ·±å…¥åˆ†æFlutter Stateç”Ÿå‘½å‘¨æœŸ "},"pages/fultter/çŠ¶æ€ç®¡ç†.html":{"url":"pages/fultter/çŠ¶æ€ç®¡ç†.html","title":"çŠ¶æ€ç®¡ç†","keywords":"","body":"çŠ¶æ€ç®¡ç† Widgetç®¡ç†è‡ªèº«çŠ¶æ€ _TapboxAState ç±»: ç®¡ç†TapboxAçš„çŠ¶æ€ã€‚ å®šä¹‰_activeï¼šç¡®å®šç›’å­çš„å½“å‰é¢œè‰²çš„å¸ƒå°”å€¼ã€‚ å®šä¹‰_handleTap()å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨ç‚¹å‡»è¯¥ç›’å­æ—¶æ›´æ–°_activeï¼Œå¹¶è°ƒç”¨setState()æ›´æ–°UIã€‚ å®ç°widgetçš„æ‰€æœ‰äº¤äº’å¼è¡Œä¸ºã€‚ // TapboxA ç®¡ç†è‡ªèº«çŠ¶æ€. //------------------------- TapboxA ---------------------------------- class TapboxA extends StatefulWidget { TapboxA({Key? key}) : super(key: key); @override _TapboxAState createState() => _TapboxAState(); } class _TapboxAState extends State { bool _active = false; void _handleTap() { setState(() { _active = !_active; }); } @override Widget build(BuildContext context) { return GestureDetector( onTap: _handleTap, child: Container( width: 200.0, height: 200.0, decoration: BoxDecoration( color: _active ? Colors.lightGreen[700] : Colors.grey[600], ), child: Center( child: Text( _active ? 'Active' : 'Inactive', style: const TextStyle(fontSize: 32.0, color: Colors.white), ), ), ), ); } } çˆ¶Widgetç®¡ç†å­Widgetçš„çŠ¶æ€ ParentWidgetState ç±»: ä¸ºTapboxB ç®¡ç†_activeçŠ¶æ€ã€‚ å®ç°_handleTapboxChanged()ï¼Œå½“ç›’å­è¢«ç‚¹å‡»æ—¶è°ƒç”¨çš„æ–¹æ³•ã€‚ å½“çŠ¶æ€æ”¹å˜æ—¶ï¼Œè°ƒç”¨setState()æ›´æ–°UIã€‚ TapboxB ç±»: ç»§æ‰¿StatelessWidgetç±»ï¼Œå› ä¸ºæ‰€æœ‰çŠ¶æ€éƒ½ç”±å…¶çˆ¶ç»„ä»¶å¤„ç†ã€‚ å½“æ£€æµ‹åˆ°ç‚¹å‡»æ—¶ï¼Œå®ƒä¼šé€šçŸ¥çˆ¶ç»„ä»¶ã€‚ // ParentWidget ä¸º TapboxB ç®¡ç†çŠ¶æ€. //------------------------ ParentWidget -------------------------------- class ParentWidget extends StatefulWidget { @override _ParentWidgetState createState() => _ParentWidgetState(); } class _ParentWidgetState extends State { bool _active = false; void _handleTapboxChanged(bool newValue) { setState(() { _active = newValue; }); } @override Widget build(BuildContext context) { return Container( child: TapboxB( active: _active, onChanged: _handleTapboxChanged, ), ); } } //------------------------- TapboxB ---------------------------------- class TapboxB extends StatelessWidget { TapboxB({Key? key, this.active: false, required this.onChanged}) : super(key: key); final bool active; final ValueChanged onChanged; void _handleTap() { onChanged(!active); } Widget build(BuildContext context) { return GestureDetector( onTap: _handleTap, child: Container( child: Center( child: Text( active ? 'Active' : 'Inactive', style: TextStyle(fontSize: 32.0, color: Colors.white), ), ), width: 200.0, height: 200.0, decoration: BoxDecoration( color: active ? Colors.lightGreen[700] : Colors.grey[600], ), ), ); } } æ··åˆçŠ¶æ€ç®¡ç† _ParentWidgetStateCç±»: ç®¡ç†_active çŠ¶æ€ã€‚ å®ç° _handleTapboxChanged() ï¼Œå½“ç›’å­è¢«ç‚¹å‡»æ—¶è°ƒç”¨ã€‚ å½“ç‚¹å‡»ç›’å­å¹¶ä¸”_activeçŠ¶æ€æ”¹å˜æ—¶è°ƒç”¨setState()æ›´æ–°UIã€‚ _TapboxCState å¯¹è±¡: ç®¡ç†_highlight çŠ¶æ€ã€‚ GestureDetectorç›‘å¬æ‰€æœ‰tapäº‹ä»¶ã€‚å½“ç”¨æˆ·ç‚¹ä¸‹æ—¶ï¼Œå®ƒæ·»åŠ é«˜äº®ï¼ˆæ·±ç»¿è‰²è¾¹æ¡†ï¼‰ï¼›å½“ç”¨æˆ·é‡Šæ”¾æ—¶ï¼Œä¼šç§»é™¤é«˜äº®ã€‚ å½“æŒ‰ä¸‹ã€æŠ¬èµ·ã€æˆ–è€…å–æ¶ˆç‚¹å‡»æ—¶æ›´æ–°_highlightçŠ¶æ€ï¼Œè°ƒç”¨setState()æ›´æ–°UIã€‚ å½“ç‚¹å‡»æ—¶ï¼Œå°†çŠ¶æ€çš„æ”¹å˜ä¼ é€’ç»™çˆ¶ç»„ä»¶ã€‚ //---------------------------- ParentWidget ---------------------------- class ParentWidgetC extends StatefulWidget { @override _ParentWidgetCState createState() => _ParentWidgetCState(); } class _ParentWidgetCState extends State { bool _active = false; void _handleTapboxChanged(bool newValue) { setState(() { _active = newValue; }); } @override Widget build(BuildContext context) { return Container( child: TapboxC( active: _active, onChanged: _handleTapboxChanged, ), ); } } //----------------------------- TapboxC ------------------------------ class TapboxC extends StatefulWidget { TapboxC({Key? key, this.active: false, required this.onChanged}) : super(key: key); final bool active; final ValueChanged onChanged; @override _TapboxCState createState() => _TapboxCState(); } class _TapboxCState extends State { bool _highlight = false; void _handleTapDown(TapDownDetails details) { setState(() { _highlight = true; }); } void _handleTapUp(TapUpDetails details) { setState(() { _highlight = false; }); } void _handleTapCancel() { setState(() { _highlight = false; }); } void _handleTap() { widget.onChanged(!widget.active); } @override Widget build(BuildContext context) { // åœ¨æŒ‰ä¸‹æ—¶æ·»åŠ ç»¿è‰²è¾¹æ¡†ï¼Œå½“æŠ¬èµ·æ—¶ï¼Œå–æ¶ˆé«˜äº® return GestureDetector( onTapDown: _handleTapDown, // å¤„ç†æŒ‰ä¸‹äº‹ä»¶ onTapUp: _handleTapUp, // å¤„ç†æŠ¬èµ·äº‹ä»¶ onTap: _handleTap, onTapCancel: _handleTapCancel, child: Container( child: Center( child: Text( widget.active ? 'Active' : 'Inactive', style: TextStyle(fontSize: 32.0, color: Colors.white), ), ), width: 200.0, height: 200.0, decoration: BoxDecoration( color: widget.active ? Colors.lightGreen[700] : Colors.grey[600], border: _highlight ? Border.all( color: Colors.black38, width: 10.0, ) : null, ), ), ); } } å…¨å±€çŠ¶æ€ç®¡ç† å®ç°ä¸€ä¸ªå…¨å±€çš„äº‹ä»¶æ€»çº¿ï¼Œå°†è¯­è¨€çŠ¶æ€æ”¹å˜å¯¹åº”ä¸ºä¸€ä¸ªäº‹ä»¶ï¼Œç„¶ååœ¨APPä¸­ä¾èµ–åº”ç”¨è¯­è¨€çš„ç»„ä»¶çš„initState æ–¹æ³•ä¸­è®¢é˜…è¯­è¨€æ”¹å˜çš„äº‹ä»¶ã€‚å½“ç”¨æˆ·åœ¨è®¾ç½®é¡µåˆ‡æ¢è¯­è¨€åï¼Œæˆ‘ä»¬å‘å¸ƒè¯­è¨€æ”¹å˜äº‹ä»¶ï¼Œè€Œè®¢é˜…äº†æ­¤äº‹ä»¶çš„ç»„ä»¶å°±ä¼šæ”¶åˆ°é€šçŸ¥ï¼Œæ”¶åˆ°é€šçŸ¥åè°ƒç”¨setState(...)æ–¹æ³•é‡æ–°buildä¸€ä¸‹è‡ªèº«å³å¯ã€‚ è¿™ç§ç±»ä¼¼iOSçš„é€šçŸ¥ã€‚ ä½¿ç”¨ä¸€äº›ä¸“é—¨ç”¨äºçŠ¶æ€ç®¡ç†çš„åŒ…ï¼Œå¦‚ Providerã€Reduxï¼Œè¯»è€…å¯ä»¥åœ¨ pub ä¸ŠæŸ¥çœ‹å…¶è¯¦ç»†ä¿¡æ¯ã€‚ çŠ¶æ€ç®¡ç† "},"pages/fultter/è·¯ç”±ç®¡ç†.html":{"url":"pages/fultter/è·¯ç”±ç®¡ç†.html","title":"è·¯ç”±ç®¡ç†","keywords":"","body":"è·¯ç”±ç®¡ç† ä¸€ä¸ªç®€å•ç¤ºä¾‹ åˆ›å»ºä¸€ä¸ªæ–°è·¯ç”±ï¼Œå‘½åâ€œNewRouteâ€ã€‚ class NewRoute extends StatelessWidget { @override Widget build(BuildContext context) { return Scaffold( appBar: AppBar( title: Text(\"New route\"), ), body: Center( child: Text(\"This is new route\"), ), ); } } æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªæ‰“å¼€æ–°è·¯ç”±çš„æŒ‰é’®ï¼Œç‚¹å‡»è¯¥æŒ‰é’®åå°±ä¼šæ‰“å¼€æ–°çš„è·¯ç”±é¡µé¢ã€‚ Column( mainAxisAlignment: MainAxisAlignment.center, children: [ ... //çœç•¥æ— å…³ä»£ç  TextButton( child: Text(\"open new route\"), onPressed: () { //å¯¼èˆªåˆ°æ–°è·¯ç”± Navigator.push( context, MaterialPageRoute(builder: (context) { return NewRoute(); }), ); }, ), ], ) MaterialPageRoute MaterialPageRouteç»§æ‰¿è‡ªPageRouteç±»ï¼ŒPageRouteç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œè¡¨ç¤ºå æœ‰æ•´ä¸ªå±å¹•ç©ºé—´çš„ä¸€ä¸ªæ¨¡æ€è·¯ç”±é¡µé¢ã€‚ MaterialPageRoute æ˜¯ Materialç»„ä»¶åº“æä¾›çš„ç»„ä»¶ï¼Œå®ƒå¯ä»¥é’ˆå¯¹ä¸åŒå¹³å°ï¼Œå®ç°ä¸å¹³å°é¡µé¢åˆ‡æ¢åŠ¨ç”»é£æ ¼ä¸€è‡´çš„è·¯ç”±åˆ‡æ¢åŠ¨ç”»ã€‚ MaterialPageRoute æ„é€ å‡½æ•°çš„å„ä¸ªå‚æ•°çš„æ„ä¹‰ï¼š MaterialPageRoute({ WidgetBuilder builder, RouteSettings settings, bool maintainState = true, bool fullscreenDialog = false, }) builderï¼šæ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªwidgetï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è·³è½¬çš„é¡µé¢ã€‚ settingsï¼šåŒ…å«è·¯ç”±çš„é…ç½®ä¿¡æ¯ï¼Œå¦‚è·¯ç”±åç§°ã€æ˜¯å¦åˆå§‹è·¯ç”±ï¼ˆé¦–é¡µï¼‰ã€‚ maintainStateï¼šä¸€ä¸ªå·²ç»ä¸å¯è§(è¢«ä¸Šé¢çš„ç›–ä½å®Œå…¨çœ‹ä¸åˆ°å•¦~)çš„ç»„ä»¶ï¼Œæ˜¯å¦è¿˜éœ€è¦ä¿å­˜çŠ¶æ€ã€‚ fullscreenDialogï¼šè¡¨ç¤ºæ–°çš„è·¯ç”±é¡µé¢æ˜¯å¦æ˜¯ä¸€ä¸ªå…¨å±çš„æ¨¡æ€å¯¹è¯æ¡†ã€‚ Navigator Navigatoræ˜¯ä¸€ä¸ªè·¯ç”±ç®¡ç†çš„ç»„ä»¶ï¼Œå®ƒæä¾›äº†æ‰“å¼€å’Œé€€å‡ºè·¯ç”±é¡µæ–¹æ³•ã€‚ Future push(BuildContext context, Route route) å°†ç»™å®šçš„è·¯ç”±å…¥æ ˆï¼ˆå³æ‰“å¼€æ–°çš„é¡µé¢ï¼‰ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªFutureå¯¹è±¡ï¼Œç”¨ä»¥æ¥æ”¶æ–°è·¯ç”±å‡ºæ ˆï¼ˆå³å…³é—­ï¼‰æ—¶çš„è¿”å›æ•°æ®ã€‚ bool pop(BuildContext context, [ result ]) å°†æ ˆé¡¶è·¯ç”±å‡ºæ ˆï¼Œresult ä¸ºé¡µé¢å…³é—­æ—¶è¿”å›ç»™ä¸Šä¸€ä¸ªé¡µé¢çš„æ•°æ®ã€‚ å®ä¾‹æ–¹æ³• Navigator.push(BuildContext context, Route route)ç­‰ä»·äºNavigator.of(context).push(Route route)ã€‚ è·¯ç”±ä¼ å€¼ ä¼ å€¼ï¼š Navigator.pop(context, \"æˆ‘æ˜¯è¿”å›å€¼\") è·å–å€¼ï¼š () async { // æ‰“å¼€`TipRoute`ï¼Œå¹¶ç­‰å¾…è¿”å›ç»“æœ var result = await Navigator.push( context, MaterialPageRoute( builder: (context) { return TipRoute( // è·¯ç”±å‚æ•° text: \"æˆ‘æ˜¯æç¤ºxxxx\", ); }, ), ); //è¾“å‡º`TipRoute`è·¯ç”±è¿”å›ç»“æœ print(\"è·¯ç”±è¿”å›å€¼: $result\"); } å‘½åè·¯ç”± 1. è·¯ç”±è¡¨ å®ƒæ˜¯ä¸€ä¸ªMapï¼Œkeyä¸ºè·¯ç”±çš„åå­—ï¼Œæ˜¯ä¸ªå­—ç¬¦ä¸²ï¼›valueæ˜¯ä¸ªbuilderå›è°ƒå‡½æ•°ï¼Œç”¨äºç”Ÿæˆç›¸åº”çš„è·¯ç”±widgetã€‚ Map routes; 2. æ³¨å†Œè·¯ç”±è¡¨ MaterialAppæ·»åŠ routeså±æ€§: MaterialApp( title: 'Flutter Demo', theme: ThemeData( primarySwatch: Colors.blue, ), //æ³¨å†Œè·¯ç”±è¡¨ routes:{ \"new_page\":(context) => NewRoute(), ... // çœç•¥å…¶ä»–è·¯ç”±æ³¨å†Œä¿¡æ¯ } , home: MyHomePage(title: 'Flutter Demo Home Page'), ); å°†homeæ³¨å†Œä¸ºå‘½åè·¯ç”±: MaterialApp( title: 'Flutter Demo', initialRoute:\"/\", //åä¸º\"/\"çš„è·¯ç”±ä½œä¸ºåº”ç”¨çš„home(é¦–é¡µ) theme: ThemeData( primarySwatch: Colors.blue, ), //æ³¨å†Œè·¯ç”±è¡¨ routes:{ \"new_page\":(context) => NewRoute(), \"/\":(context) => MyHomePage(title: 'Flutter Demo Home Page'), //æ³¨å†Œé¦–é¡µè·¯ç”± } ); 3. æ‰“å¼€æ–°è·¯ç”±é¡µ å¯ä»¥ä½¿ç”¨Navigator çš„pushNamedæ–¹æ³•ï¼š Future pushNamed(BuildContext context, String routeName,{Object arguments}) è°ƒç”¨ï¼š onPressed: () { Navigator.pushNamed(context, \"new_page\"); //Navigator.push(context, // MaterialPageRoute(builder: (context) { // return NewRoute(); //})); }, 4. å‘½åè·¯ç”±å‚æ•°ä¼ é€’ ä¼ é€’å‚æ•°: Navigator.of(context).pushNamed(\"new_page\", arguments: \"hi\"); è·å–è·¯ç”±å‚æ•°: @override Widget build(BuildContext context) { //è·å–è·¯ç”±å‚æ•° var args=ModalRoute.of(context).settings.arguments; //...çœç•¥æ— å…³ä»£ç  } 5. å¸¦å‚æ•°çš„è·¯ç”± MaterialApp( ... //çœç•¥æ— å…³ä»£ç  routes: { \"tip2\": (context){ return TipRoute(text: ModalRoute.of(context)!.settings.arguments); }, }, ); è·¯ç”±ç”Ÿæˆé’©å­ MaterialAppæœ‰ä¸€ä¸ªonGenerateRouteå±æ€§ï¼Œå®ƒåœ¨æ‰“å¼€å‘½åè·¯ç”±æ—¶å¯èƒ½ä¼šè¢«è°ƒç”¨ï¼Œä¹‹æ‰€ä»¥è¯´å¯èƒ½ï¼Œæ˜¯å› ä¸ºå½“è°ƒç”¨Navigator.pushNamed(...)æ‰“å¼€å‘½åè·¯ç”±æ—¶ï¼Œå¦‚æœæŒ‡å®šçš„è·¯ç”±ååœ¨è·¯ç”±è¡¨ä¸­å·²æ³¨å†Œï¼Œåˆ™ä¼šè°ƒç”¨è·¯ç”±è¡¨ä¸­çš„builderå‡½æ•°æ¥ç”Ÿæˆè·¯ç”±ç»„ä»¶ï¼›å¦‚æœè·¯ç”±è¡¨ä¸­æ²¡æœ‰æ³¨å†Œï¼Œæ‰ä¼šè°ƒç”¨onGenerateRouteæ¥ç”Ÿæˆè·¯ç”±ã€‚onGenerateRouteå›è°ƒç­¾åå¦‚ä¸‹ï¼š Route Function(RouteSettings settings) æœ‰äº†onGenerateRouteå›è°ƒï¼Œè¦å®ç°ä¸Šé¢æ§åˆ¶é¡µé¢æƒé™çš„åŠŸèƒ½å°±éå¸¸å®¹æ˜“ï¼šæˆ‘ä»¬æ”¾å¼ƒä½¿ç”¨è·¯ç”±è¡¨ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯æä¾›ä¸€ä¸ªonGenerateRouteå›è°ƒï¼Œç„¶ååœ¨è¯¥å›è°ƒä¸­è¿›è¡Œç»Ÿä¸€çš„æƒé™æ§åˆ¶ï¼Œå¦‚ï¼š MaterialApp( ... //çœç•¥æ— å…³ä»£ç  onGenerateRoute:(RouteSettings settings){ return MaterialPageRoute(builder: (context){ String routeName = settings.name; // å¦‚æœè®¿é—®çš„è·¯ç”±é¡µéœ€è¦ç™»å½•ï¼Œä½†å½“å‰æœªç™»å½•ï¼Œåˆ™ç›´æ¥è¿”å›ç™»å½•é¡µè·¯ç”±ï¼Œ // å¼•å¯¼ç”¨æˆ·ç™»å½•ï¼›å…¶ä»–æƒ…å†µåˆ™æ­£å¸¸æ‰“å¼€è·¯ç”±ã€‚ } ); } ); onGenerateRoute onUnknownRouteåŒºåˆ«ï¼šonGenerateRoute æ— æ³•ç”Ÿæˆè·¯ç”±ï¼Œä¼šè§¦å‘OnUnknownRoute å±æ€§æ¥å¤„ç†è¯¥åœºæ™¯ã€‚ æ³¨æ„ï¼ŒonGenerateRoute åªä¼šå¯¹å‘½åè·¯ç”±ç”Ÿæ•ˆã€‚ä¹Ÿå°±æ˜¯éœ€è¦è°ƒç”¨Navigator.pushNamedã€‚ è·¯ç”±ç®¡ç†Flutter è·¯ç”±åŸç†è§£æFlutter ä¸­çš„ onUnknownRoute æ˜¯ä»€ä¹ˆ "},"pages/fultter/åŒ…ç®¡ç†.html":{"url":"pages/fultter/åŒ…ç®¡ç†.html","title":"åŒ…ç®¡ç†","keywords":"","body":"åŒ…ç®¡ç† YAML name: flutter_in_action description: First Flutter Application. version: 1.0.0+1 dependencies: flutter: sdk: flutter cupertino_icons: ^0.1.2 dev_dependencies: flutter_test: sdk: flutter flutter: uses-material-design: true Pubä»“åº“ Pubï¼ˆhttps://pub.dev/ ï¼‰æ˜¯ Google å®˜æ–¹çš„ Dart Packages ä»“åº“ï¼Œç±»ä¼¼äº node ä¸­çš„ npmä»“åº“ã€Androidä¸­çš„ jcenterã€‚æˆ‘ä»¬å¯ä»¥åœ¨ Pub ä¸Šé¢æŸ¥æ‰¾æˆ‘ä»¬éœ€è¦çš„åŒ…å’Œæ’ä»¶ï¼Œä¹Ÿå¯ä»¥å‘ Pub å‘å¸ƒæˆ‘ä»¬çš„åŒ…å’Œæ’ä»¶ã€‚ ç¤ºä¾‹ 1.å°†â€œenglish_wordsâ€ æ·»åŠ åˆ°ä¾èµ–é¡¹åˆ—è¡¨ï¼Œå¦‚ä¸‹ï¼š dependencies: flutter: sdk: flutter # æ–°æ·»åŠ çš„ä¾èµ– english_words: ^4.0.0 2.ä¸‹è½½åŒ…ã€‚åœ¨Android Studioçš„ç¼–è¾‘å™¨è§†å›¾ä¸­æŸ¥çœ‹pubspec.yamlæ—¶ï¼ˆå›¾2-13ï¼‰ï¼Œå•å‡»å³ä¸Šè§’çš„ Pub get ã€‚3.å¼•å…¥english_wordsåŒ…ã€‚ import 'package:english_words/english_words.dart'; 4.ä½¿ç”¨english_wordsåŒ…æ¥ç”Ÿæˆéšæœºå­—ç¬¦ä¸²ã€‚ // ç”Ÿæˆéšæœºå­—ç¬¦ä¸² final wordPair = WordPair.random(); å…¶ä»–ä¾èµ–æ–¹å¼ 1.ä¾èµ–æœ¬åœ°åŒ… dependencies: pkg1: path: ../../code/pkg1 2.ä¾èµ–Git dependencies: pkg1: git: url: git://github.com/xxx/pkg1.git 3.ä½¿ç”¨pathå‚æ•°æŒ‡å®šç›¸å¯¹ä½ç½® dependencies: package1: git: url: git://github.com/flutter/packages.git path: packages/package1 ä¾èµ–æ–¹å¼:https://www.dartlang.org/tools/pub/dependencies åŒ…ç®¡ç† "},"pages/fultter/èµ„æºç®¡ç†.html":{"url":"pages/fultter/èµ„æºç®¡ç†.html","title":"èµ„æºç®¡ç†","keywords":"","body":"èµ„æºç®¡ç† å¸¸è§ç±»å‹çš„ assets åŒ…æ‹¬é™æ€æ•°æ®ï¼ˆä¾‹å¦‚JSONæ–‡ä»¶ï¼‰ã€é…ç½®æ–‡ä»¶ã€å›¾æ ‡å’Œå›¾ç‰‡ç­‰ã€‚ æŒ‡å®š assets åœ¨pubspec.yamlä¸­é…ç½®ï¼š flutter: assets: - assets/my_icon.png - assets/background.png assetsæŒ‡å®šåº”åŒ…å«åœ¨åº”ç”¨ç¨‹åºä¸­çš„æ–‡ä»¶ï¼Œ æ¯ä¸ª asset éƒ½é€šè¿‡ç›¸å¯¹äºpubspec.yamlæ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶ç³»ç»Ÿè·¯å¾„æ¥æ ‡è¯†è‡ªèº«çš„è·¯å¾„ã€‚ Asset å˜ä½“ï¼ˆvariantï¼‰ ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºç›®å½•ä¸­æœ‰ä»¥ä¸‹æ–‡ä»¶: â€¦/pubspec.yaml â€¦/graphics/my_icon.png â€¦/graphics/background.png â€¦/graphics/dark/background.png â€¦etc. ç„¶åpubspec.yamlæ–‡ä»¶ä¸­åªéœ€åŒ…å«: flutter: assets: - graphics/background.png é‚£ä¹ˆè¿™ä¸¤ä¸ªgraphics/background.pngå’Œgraphics/dark/background.png éƒ½å°†åŒ…å«åœ¨æ‚¨çš„ asset bundleä¸­ã€‚å‰è€…è¢«è®¤ä¸ºæ˜¯main asset ï¼ˆä¸»èµ„æºï¼‰ï¼Œåè€…è¢«è®¤ä¸ºæ˜¯ä¸€ç§å˜ä½“ï¼ˆvariantï¼‰ã€‚ åœ¨é€‰æ‹©åŒ¹é…å½“å‰è®¾å¤‡åˆ†è¾¨ç‡çš„å›¾ç‰‡æ—¶ï¼ŒFlutterä¼šä½¿ç”¨åˆ° asset å˜ä½“ï¼ˆè§ä¸‹æ–‡ï¼‰ã€‚ åŠ è½½ assets 1. åŠ è½½æ–‡æœ¬assets rootBundleï¼šå…¨å±€é™æ€å¯¹è±¡ã€‚ Future loadAsset() async { return await rootBundle.loadString('assets/config.json'); } DefaultAssetBundle: DefaultAssetBundle.of(context) 2. åŠ è½½å›¾ç‰‡ 1) å£°æ˜åˆ†è¾¨ç‡ç›¸å…³çš„å›¾ç‰‡ assets 2) åŠ è½½å›¾ç‰‡ Widget build(BuildContext context) { return DecoratedBox( decoration: BoxDecoration( image: DecorationImage( image: AssetImage('graphics/background.png'), ), ), ); } AssetImage å¹¶éæ˜¯ä¸€ä¸ªwidgetï¼Œ å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªImageProviderï¼Œæœ‰äº›æ—¶å€™ä½ å¯èƒ½æœŸæœ›ç›´æ¥å¾—åˆ°ä¸€ä¸ªæ˜¾ç¤ºå›¾ç‰‡çš„widgetï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨Image.asset()æ–¹æ³•ï¼Œå¦‚ï¼š Widget build(BuildContext context) { return Image.asset('graphics/background.png'); } 3) ä¾èµ–åŒ…ä¸­çš„èµ„æºå›¾ç‰‡ AssetImage('icons/heart.png', package: 'my_icons' æˆ– Image.asset('icons/heart.png', package: 'my_icons') 4) æ‰“åŒ…åŒ…ä¸­çš„ assets 3. ç‰¹å®šå¹³å° assets 1ï¼‰è®¾ç½®APPå›¾æ ‡ 2ï¼‰æ›´æ–°å¯åŠ¨é¡µ å¹³å°å…±äº« assets Flutter æä¾›äº†ä¸€ç§Flutterå’ŒåŸç”Ÿä¹‹é—´å…±äº«èµ„æºçš„æ–¹å¼ã€‚ èµ„æºç®¡ç† "},"pages/fultter/æ–‡æœ¬åŠæ ·å¼.html":{"url":"pages/fultter/æ–‡æœ¬åŠæ ·å¼.html","title":"æ–‡æœ¬åŠæ ·å¼","keywords":"","body":"æ–‡æœ¬åŠæ ·å¼ æºç  Flutter ä¸­ä½¿ç”¨è‡ªå®šä¹‰å­—ä½“ æ–‡æœ¬åŠæ ·å¼ Text Text(\"Hello world\", textAlign: TextAlign.left, ); Text(\"Hello world! I'm Jack. \"*4, maxLines: 1, overflow: TextOverflow.ellipsis, ); Text(\"Hello world\", textScaleFactor: 1.5, ); TextStyle Text(\"Hello world\", style: TextStyle( color: Colors.blue, fontSize: 18.0, height: 1.2, fontFamily: \"Courier\", background: Paint()..color=Colors.yellow, decoration:TextDecoration.underline, decorationStyle: TextDecorationStyle.dashed ), ); TextSpan Text.rich(TextSpan( children: [ TextSpan( text: \"Home: \" ), TextSpan( text: \"https://flutterchina.club\", style: TextStyle( color: Colors.blue ), recognizer: _tapRecognizer ), ] )) DefaultTextStyle DefaultTextStyle( //1.è®¾ç½®æ–‡æœ¬é»˜è®¤æ ·å¼ style: TextStyle( color:Colors.red, fontSize: 20.0, ), textAlign: TextAlign.start, child: Column( crossAxisAlignment: CrossAxisAlignment.start, children: [ Text(\"hello world\"), Text(\"I am Jack\"), Text(\"I am Jack\", style: TextStyle( inherit: false, //2.ä¸ç»§æ‰¿é»˜è®¤æ ·å¼ color: Colors.grey ), ), ], ), ); å­—ä½“ "},"pages/fultter/æŒ‰é’®æ ·å¼.html":{"url":"pages/fultter/æŒ‰é’®æ ·å¼.html","title":"æŒ‰é’®æ ·å¼","keywords":"","body":"æŒ‰é’®æ ·å¼ æºç  æŒ‰é’® flutter TextButtonæ ·å¼ ElevatedButton ElevatedButton( child: Text(\"normal\"), onPressed: () {}, ); TextButton TextButton( child: Text(\"normal\"), onPressed: () {}, ) OutlinedButton OutlineButton( child: Text(\"normal\"), onPressed: () {}, ) IconButton IconButton( icon: Icon(Icons.thumb_up), onPressed: () {}, ) å¸¦å›¾æ ‡çš„æŒ‰é’® ElevatedButton.icon( icon: Icon(Icons.send), label: Text(\"å‘é€\"), onPressed: _onPressed, ), OutlinedButton.icon( icon: Icon(Icons.add), label: Text(\"æ·»åŠ \"), onPressed: _onPressed, ), TextButton.icon( icon: Icon(Icons.info), label: Text(\"è¯¦æƒ…\"), onPressed: _onPressed, ), "},"pages/fultter/å›¾ç‰‡æ ·å¼.html":{"url":"pages/fultter/å›¾ç‰‡æ ·å¼.html","title":"å›¾ç‰‡æ ·å¼","keywords":"","body":"å›¾ç‰‡æ ·å¼ æºç  å›¾ç‰‡åŠICON å›¾ç‰‡èµ„æº ä½¿ç”¨flutteråŠ è½½æœ¬åœ°å›¾ç‰‡æŠ¥é”™ å›¾ç‰‡ Flutter ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Imageç»„ä»¶æ¥åŠ è½½å¹¶æ˜¾ç¤ºå›¾ç‰‡ï¼ŒImageçš„æ•°æ®æºå¯ä»¥æ˜¯assetã€æ–‡ä»¶ã€å†…å­˜ä»¥åŠç½‘ç»œã€‚ 1. ImageProvider ImageProvider æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä¸»è¦å®šä¹‰äº†å›¾ç‰‡æ•°æ®è·å–çš„æ¥å£load()ï¼Œä»ä¸åŒçš„æ•°æ®æºè·å–å›¾ç‰‡éœ€è¦å®ç°ä¸åŒçš„ImageProvider ï¼Œå¦‚AssetImageæ˜¯å®ç°äº†ä»Assetä¸­åŠ è½½å›¾ç‰‡çš„ ImageProviderï¼Œè€ŒNetworkImage å®ç°äº†ä»ç½‘ç»œåŠ è½½å›¾ç‰‡çš„ ImageProviderã€‚ 2. Image Image widget æœ‰ä¸€ä¸ªå¿…é€‰çš„imageå‚æ•°ï¼Œå®ƒå¯¹åº”ä¸€ä¸ª ImageProviderã€‚ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«æ¼”ç¤ºä¸€ä¸‹å¦‚ä½•ä» asset å’Œç½‘ç»œåŠ è½½å›¾ç‰‡ã€‚ 1ï¼‰å…ˆé…ç½®.yamlï¼Œå†ä»assetä¸­åŠ è½½å›¾ç‰‡ï¼š Image( image: AssetImage(\"images/avatar.png\"), width: 100.0 ); æˆ– Image.asset(\"images/avatar.png\", width: 100.0, ) 2) ä»ç½‘ç»œåŠ è½½å›¾ç‰‡ï¼š Image( image: NetworkImage( \"https://avatars2.githubusercontent.com/u/20411648?s=460&v=4\"), width: 100.0, ) æˆ– Image.network( \"https://avatars2.githubusercontent.com/u/20411648?s=460&v=4\", width: 100.0, ) 3ï¼‰å‚æ•° ICON "},"pages/fultter/å•é€‰å¼€å…³å’Œå¤é€‰æ¡†.html":{"url":"pages/fultter/å•é€‰å¼€å…³å’Œå¤é€‰æ¡†.html","title":"å•é€‰å¼€å…³å’Œå¤é€‰æ¡†","keywords":"","body":"å•é€‰å¼€å…³å’Œå¤é€‰æ¡† æºç  å•é€‰å¼€å…³å’Œå¤é€‰æ¡† class SwitchAndCheckBoxTestRoute extends StatefulWidget { @override _SwitchAndCheckBoxTestRouteState createState() => _SwitchAndCheckBoxTestRouteState(); } class _SwitchAndCheckBoxTestRouteState extends State { bool _switchSelected=true; //ç»´æŠ¤å•é€‰å¼€å…³çŠ¶æ€ bool _checkboxSelected=true;//ç»´æŠ¤å¤é€‰æ¡†çŠ¶æ€ @override Widget build(BuildContext context) { return Column( children: [ Switch( value: _switchSelected,//å½“å‰çŠ¶æ€ onChanged:(value){ //é‡æ–°æ„å»ºé¡µé¢ setState(() { _switchSelected=value; }); }, ), Checkbox( value: _checkboxSelected, activeColor: Colors.red, //é€‰ä¸­æ—¶çš„é¢œè‰² onChanged:(value){ setState(() { _checkboxSelected=value; }); } , ) ], ); } } "},"pages/fultter/è¾“å…¥æ¡†åŠè¡¨å•.html":{"url":"pages/fultter/è¾“å…¥æ¡†åŠè¡¨å•.html","title":"è¾“å…¥æ¡†åŠè¡¨å•","keywords":"","body":"è¾“å…¥æ¡†åŠè¡¨å• æºç  è¾“å…¥æ¡†åŠè¡¨å• TextFieldå‚æ•° controllerï¼šç¼–è¾‘æ¡†çš„æ§åˆ¶å™¨ï¼Œé€šè¿‡å®ƒå¯ä»¥è®¾ç½®/è·å–ç¼–è¾‘æ¡†çš„å†…å®¹ã€é€‰æ‹©ç¼–è¾‘å†…å®¹ã€ç›‘å¬ç¼–è¾‘æ–‡æœ¬æ”¹å˜äº‹ä»¶ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬éƒ½éœ€è¦æ˜¾å¼æä¾›ä¸€ä¸ªcontrolleræ¥ä¸æ–‡æœ¬æ¡†äº¤äº’ã€‚å¦‚æœæ²¡æœ‰æä¾›controllerï¼Œåˆ™TextFieldå†…éƒ¨ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªã€‚ focusNodeï¼šç”¨äºæ§åˆ¶TextFieldæ˜¯å¦å æœ‰å½“å‰é”®ç›˜çš„è¾“å…¥ç„¦ç‚¹ã€‚å®ƒæ˜¯æˆ‘ä»¬å’Œé”®ç›˜äº¤äº’çš„ä¸€ä¸ªå¥æŸ„ï¼ˆhandleï¼‰ã€‚ InputDecorationï¼šç”¨äºæ§åˆ¶TextFieldçš„å¤–è§‚æ˜¾ç¤ºï¼Œå¦‚æç¤ºæ–‡æœ¬ã€èƒŒæ™¯é¢œè‰²ã€è¾¹æ¡†ç­‰ã€‚ keyboardTypeï¼šç”¨äºè®¾ç½®è¯¥è¾“å…¥æ¡†é»˜è®¤çš„é”®ç›˜è¾“å…¥ç±»å‹ã€‚ textInputActionï¼šé”®ç›˜åŠ¨ä½œæŒ‰é’®å›¾æ ‡(å³å›è½¦é”®ä½å›¾æ ‡)ï¼Œå®ƒæ˜¯ä¸€ä¸ªæšä¸¾å€¼ï¼Œæœ‰å¤šä¸ªå¯é€‰å€¼ã€‚ styleï¼šæ­£åœ¨ç¼–è¾‘çš„æ–‡æœ¬æ ·å¼ã€‚ textAlign: è¾“å…¥æ¡†å†…ç¼–è¾‘æ–‡æœ¬åœ¨æ°´å¹³æ–¹å‘çš„å¯¹é½æ–¹å¼ã€‚ autofocus: æ˜¯å¦è‡ªåŠ¨è·å–ç„¦ç‚¹ã€‚ obscureTextï¼šæ˜¯å¦éšè—æ­£åœ¨ç¼–è¾‘çš„æ–‡æœ¬ï¼Œå¦‚ç”¨äºè¾“å…¥å¯†ç çš„åœºæ™¯ç­‰ï¼Œæ–‡æœ¬å†…å®¹ä¼šç”¨â€œâ€¢â€æ›¿æ¢ã€‚ maxLinesï¼šè¾“å…¥æ¡†çš„æœ€å¤§è¡Œæ•°ï¼Œé»˜è®¤ä¸º1ï¼›å¦‚æœä¸ºnullï¼Œåˆ™æ— è¡Œæ•°é™åˆ¶ã€‚ maxLengthå’ŒmaxLengthEnforcement ï¼šmaxLengthä»£è¡¨è¾“å…¥æ¡†æ–‡æœ¬çš„æœ€å¤§é•¿åº¦ï¼Œè®¾ç½®åè¾“å…¥æ¡†å³ä¸‹è§’ä¼šæ˜¾ç¤ºè¾“å…¥çš„æ–‡æœ¬è®¡æ•°ã€‚maxLengthEnforcementå†³å®šå½“è¾“å…¥æ–‡æœ¬é•¿åº¦è¶…è¿‡maxLengthæ—¶å¦‚ä½•å¤„ç†ï¼Œå¦‚æˆªæ–­ã€è¶…å‡ºç­‰ã€‚ toolbarOptionsï¼šé•¿æŒ‰æˆ–é¼ æ ‡å³å‡»æ—¶å‡ºç°çš„èœå•ï¼ŒåŒ…æ‹¬ copyã€cutã€paste ä»¥åŠ selectAllã€‚ onChangeï¼šè¾“å…¥æ¡†å†…å®¹æ”¹å˜æ—¶çš„å›è°ƒå‡½æ•°ï¼›æ³¨ï¼šå†…å®¹æ”¹å˜äº‹ä»¶ä¹Ÿå¯ä»¥é€šè¿‡controlleræ¥ç›‘å¬ã€‚ onEditingCompleteå’ŒonSubmittedï¼šè¿™ä¸¤ä¸ªå›è°ƒéƒ½æ˜¯åœ¨è¾“å…¥æ¡†è¾“å…¥å®Œæˆæ—¶è§¦å‘ï¼Œæ¯”å¦‚æŒ‰äº†é”®ç›˜çš„å®Œæˆé”®ï¼ˆå¯¹å·å›¾æ ‡ï¼‰æˆ–æœç´¢é”®ï¼ˆğŸ”å›¾æ ‡ï¼‰ã€‚ä¸åŒçš„æ˜¯ä¸¤ä¸ªå›è°ƒç­¾åä¸åŒï¼ŒonSubmittedå›è°ƒæ˜¯ValueChangedç±»å‹ï¼Œå®ƒæ¥æ”¶å½“å‰è¾“å…¥å†…å®¹åšä¸ºå‚æ•°ï¼Œè€ŒonEditingCompleteä¸æ¥æ”¶å‚æ•°ã€‚ inputFormattersï¼šç”¨äºæŒ‡å®šè¾“å…¥æ ¼å¼ï¼›å½“ç”¨æˆ·è¾“å…¥å†…å®¹æ”¹å˜æ—¶ï¼Œä¼šæ ¹æ®æŒ‡å®šçš„æ ¼å¼æ¥æ ¡éªŒã€‚ enableï¼šå¦‚æœä¸ºfalseï¼Œåˆ™è¾“å…¥æ¡†ä¼šè¢«ç¦ç”¨ï¼Œç¦ç”¨çŠ¶æ€ä¸æ¥æ”¶è¾“å…¥å’Œäº‹ä»¶ï¼ŒåŒæ—¶æ˜¾ç¤ºç¦ç”¨æ€æ ·å¼ï¼ˆåœ¨å…¶decorationä¸­å®šä¹‰ï¼‰ã€‚ cursorWidthã€cursorRadiuså’ŒcursorColorï¼šè¿™ä¸‰ä¸ªå±æ€§æ˜¯ç”¨äºè‡ªå®šä¹‰è¾“å…¥æ¡†å…‰æ ‡å®½åº¦ã€åœ†è§’å’Œé¢œè‰²çš„ã€‚ ç¤ºä¾‹ 1. å¸ƒå±€ Column( children: [ TextField( autofocus: true, decoration: InputDecoration( labelText: \"ç”¨æˆ·å\", hintText: \"ç”¨æˆ·åæˆ–é‚®ç®±\", prefixIcon: Icon(Icons.person) ), ), TextField( decoration: InputDecoration( labelText: \"å¯†ç \", hintText: \"æ‚¨çš„ç™»å½•å¯†ç \", prefixIcon: Icon(Icons.lock) ), obscureText: true, ), ], ); 2. è·å–è¾“å…¥å†…å®¹ //å®šä¹‰ä¸€ä¸ªcontroller TextEditingController _unameController = TextEditingController(); TextField( autofocus: true, controller: _unameController, //è®¾ç½®controller ... ) print(_unameController.text) 3. ç›‘å¬æ–‡æœ¬å˜åŒ– TextField( autofocus: true, onChanged: (v) { print(\"onChange: $v\"); } ) æˆ– @override void initState() { //ç›‘å¬è¾“å…¥æ”¹å˜ _unameController.addListener((){ print(_unameController.text); }); } 4. æ§åˆ¶ç„¦ç‚¹ 5. ç›‘å¬ç„¦ç‚¹çŠ¶æ€æ”¹å˜äº‹ä»¶ 6. è‡ªå®šä¹‰æ ·å¼ è¡¨å•Form 1. Form 2. FormField 3. FormState "},"pages/fultter/è¿›åº¦æŒ‡ç¤ºå™¨.html":{"url":"pages/fultter/è¿›åº¦æŒ‡ç¤ºå™¨.html","title":"è¿›åº¦æŒ‡ç¤ºå™¨","keywords":"","body":"è¿›åº¦æŒ‡ç¤ºå™¨ æºç  è¿›åº¦æŒ‡ç¤ºå™¨ LinearProgressIndicator LinearProgressIndicatoræ˜¯ä¸€ä¸ªçº¿æ€§ã€æ¡çŠ¶çš„è¿›åº¦æ¡ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š LinearProgressIndicator({ double value, Color backgroundColor, Animation valueColor, ... }) valueï¼švalueè¡¨ç¤ºå½“å‰çš„è¿›åº¦ï¼Œå–å€¼èŒƒå›´ä¸º[0,1]ï¼›å¦‚æœvalueä¸ºnullæ—¶åˆ™æŒ‡ç¤ºå™¨ä¼šæ‰§è¡Œä¸€ä¸ªå¾ªç¯åŠ¨ç”»ï¼ˆæ¨¡ç³Šè¿›åº¦ï¼‰ï¼›å½“valueä¸ä¸ºnullæ—¶ï¼ŒæŒ‡ç¤ºå™¨ä¸ºä¸€ä¸ªå…·ä½“è¿›åº¦çš„è¿›åº¦æ¡ã€‚ backgroundColorï¼šæŒ‡ç¤ºå™¨çš„èƒŒæ™¯è‰²ã€‚ valueColor: æŒ‡ç¤ºå™¨çš„è¿›åº¦æ¡é¢œè‰²ï¼›å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¯¥å€¼ç±»å‹æ˜¯Animationï¼Œè¿™å…è®¸æˆ‘ä»¬å¯¹è¿›åº¦æ¡çš„é¢œè‰²ä¹Ÿå¯ä»¥æŒ‡å®šåŠ¨ç”»ã€‚å¦‚æœæˆ‘ä»¬ä¸éœ€è¦å¯¹è¿›åº¦æ¡é¢œè‰²æ‰§è¡ŒåŠ¨ç”»ï¼Œæ¢è¨€ä¹‹ï¼Œæˆ‘ä»¬æƒ³å¯¹è¿›åº¦æ¡åº”ç”¨ä¸€ç§å›ºå®šçš„é¢œè‰²ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡AlwaysStoppedAnimationæ¥æŒ‡å®šã€‚ ç¤ºä¾‹ï¼š // æ¨¡ç³Šè¿›åº¦æ¡(ä¼šæ‰§è¡Œä¸€ä¸ªåŠ¨ç”») LinearProgressIndicator( backgroundColor: Colors.grey[200], valueColor: AlwaysStoppedAnimation(Colors.blue), ), //è¿›åº¦æ¡æ˜¾ç¤º50% LinearProgressIndicator( backgroundColor: Colors.grey[200], valueColor: AlwaysStoppedAnimation(Colors.blue), value: .5, ) CircularProgressIndicator CircularProgressIndicatoræ˜¯ä¸€ä¸ªåœ†å½¢è¿›åº¦æ¡ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š CircularProgressIndicator({ double value, Color backgroundColor, Animation valueColor, this.strokeWidth = 4.0, ... }) å‰ä¸‰ä¸ªå‚æ•°å’ŒLinearProgressIndicatorç›¸åŒï¼Œä¸å†èµ˜è¿°ã€‚strokeWidth è¡¨ç¤ºåœ†å½¢è¿›åº¦æ¡çš„ç²—ç»†ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š // æ¨¡ç³Šè¿›åº¦æ¡(ä¼šæ‰§è¡Œä¸€ä¸ªæ—‹è½¬åŠ¨ç”») CircularProgressIndicator( backgroundColor: Colors.grey[200], valueColor: AlwaysStoppedAnimation(Colors.blue), ), //è¿›åº¦æ¡æ˜¾ç¤º50%ï¼Œä¼šæ˜¾ç¤ºä¸€ä¸ªåŠåœ† CircularProgressIndicator( backgroundColor: Colors.grey[200], valueColor: AlwaysStoppedAnimation(Colors.blue), value: .5, ), "},"pages/fultter/å¸ƒå±€ç±»ç»„ä»¶ä»‹ç».html":{"url":"pages/fultter/å¸ƒå±€ç±»ç»„ä»¶ä»‹ç».html","title":"å¸ƒå±€ç±»ç»„ä»¶ä»‹ç»","keywords":"","body":"å¸ƒå±€ç±»ç»„ä»¶ä»‹ç» å¸ƒå±€ç±»ç»„ä»¶ä»‹ç» å¸ƒå±€ç±»ç»„ä»¶éƒ½ä¼šåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå­ç»„ä»¶ï¼Œä¸åŒçš„å¸ƒå±€ç±»ç»„ä»¶å¯¹å­ç»„ä»¶æ’åˆ—ï¼ˆlayoutï¼‰æ–¹å¼ä¸åŒã€‚ å¸ƒå±€ç±» 1. LeafRenderObjectWidget éå®¹å™¨ç±»ç»„ä»¶åŸºç±»ï¼ŒWidgetæ ‘çš„å¶å­èŠ‚ç‚¹ï¼Œç”¨äºæ²¡æœ‰å­èŠ‚ç‚¹çš„widgetï¼Œé€šå¸¸åŸºç¡€ç»„ä»¶éƒ½å±äºè¿™ä¸€ç±»ï¼Œå¦‚Imageã€‚ 2. SingleChildRenderObjectWidget å•å­ç»„ä»¶åŸºç±»ï¼ŒåŒ…å«ä¸€ä¸ªå­Widgetï¼Œå¦‚ï¼šConstrainedBoxã€DecoratedBoxç­‰ã€‚ 3. MultiChildRenderObjectWidget å¤šå­ç»„ä»¶åŸºç±»ï¼ŒåŒ…å«å¤šä¸ªå­Widgetï¼Œä¸€èˆ¬éƒ½æœ‰ä¸€ä¸ªchildrenå‚æ•°ï¼Œæ¥å—ä¸€ä¸ªWidgetæ•°ç»„ã€‚å¦‚Rowã€Columnã€Stackç­‰ã€‚ 4. ç»§æ‰¿å…³ç³» Widget > RenderObjectWidget > (Leaf/SingleChild/MultiChild)RenderObjectWidget ã€‚ RenderObjectWidget å­ç±»å¿…é¡»å®ç°åˆ›å»ºã€æ›´æ–°RenderObjectçš„æ–¹æ³•ã€‚RenderObjectæ˜¯æœ€ç»ˆå¸ƒå±€ã€æ¸²æŸ“UIç•Œé¢çš„å¯¹è±¡ï¼Œå®ç°å¸ƒå±€ç®—æ³•ã€‚Stackï¼ˆå±‚å å¸ƒå±€ï¼‰å¯¹åº”çš„RenderObjectå¯¹è±¡å°±æ˜¯RenderStackï¼Œè€Œå±‚å å¸ƒå±€çš„å®ç°å°±åœ¨RenderStackä¸­ã€‚ "},"pages/fultter/å¸ƒå±€åŸç†ä¸çº¦æŸ.html":{"url":"pages/fultter/å¸ƒå±€åŸç†ä¸çº¦æŸ.html","title":"å¸ƒå±€åŸç†ä¸çº¦æŸ","keywords":"","body":"å¸ƒå±€åŸç†ä¸çº¦æŸ æºç  å¸ƒå±€åŸç†ä¸çº¦æŸ å°ºå¯¸é™åˆ¶ç±»å®¹å™¨ç”¨äºé™åˆ¶å®¹å™¨å¤§å°ï¼ŒFlutterä¸­æä¾›äº†å¤šç§è¿™æ ·çš„å®¹å™¨ï¼Œå¦‚ConstrainedBoxã€SizedBoxã€UnconstrainedBoxã€AspectRatio ç­‰ï¼Œæœ¬èŠ‚å°†ä»‹ç»ä¸€äº›å¸¸ç”¨çš„ã€‚ ä»»ä½•æ—¶å€™å­ç»„ä»¶éƒ½å¿…é¡»å…ˆéµå®ˆçˆ¶ç»„ä»¶çš„çº¦æŸã€‚ Flutterå¸ƒå±€æ¨¡å‹ 1. ä¸¤ç§å¸ƒå±€æ¨¡å‹ åŸºäº RenderBox çš„ç›’æ¨¡å‹å¸ƒå±€ã€‚ åŸºäº Sliver ( RenderSliver ) æŒ‰éœ€åŠ è½½åˆ—è¡¨å¸ƒå±€ã€‚ 2. å¸ƒå±€æµç¨‹ ä¸Šå±‚ç»„ä»¶å‘ä¸‹å±‚ç»„ä»¶ä¼ é€’çº¦æŸï¼ˆconstraintsï¼‰æ¡ä»¶ã€‚ ä¸‹å±‚ç»„ä»¶ç¡®å®šè‡ªå·±çš„å¤§å°ï¼Œç„¶åå‘Šè¯‰ä¸Šå±‚ç»„ä»¶ã€‚æ³¨æ„ä¸‹å±‚ç»„ä»¶çš„å¤§å°å¿…é¡»ç¬¦åˆçˆ¶ç»„ä»¶çš„çº¦æŸã€‚ ä¸Šå±‚ç»„ä»¶ç¡®å®šä¸‹å±‚ç»„ä»¶ç›¸å¯¹äºè‡ªèº«çš„åç§»å’Œç¡®å®šè‡ªèº«çš„å¤§å°ï¼ˆå¤§å¤šæ•°æƒ…å†µä¸‹ä¼šæ ¹æ®å­ç»„ä»¶çš„å¤§å°æ¥ç¡®å®šè‡ªèº«çš„å¤§å°ï¼‰ã€‚ BoxConstraints BoxConstraints æ˜¯ç›’æ¨¡å‹å¸ƒå±€è¿‡ç¨‹ä¸­çˆ¶æ¸²æŸ“å¯¹è±¡ä¼ é€’ç»™å­æ¸²æŸ“å¯¹è±¡çš„çº¦æŸä¿¡æ¯ã€‚BoxConstraints.tight(Size size)ï¼šå›ºå®šå®½é«˜ï¼ŒBoxConstraints.expand()ï¼šå°½å¯èƒ½å¤§ã€‚ const BoxConstraints({ this.minWidth = 0.0, //æœ€å°å®½åº¦ this.maxWidth = double.infinity, //æœ€å¤§å®½åº¦ this.minHeight = 0.0, //æœ€å°é«˜åº¦ this.maxHeight = double.infinity //æœ€å¤§é«˜åº¦ }) ConstrainedBox å¯¹å­ç»„ä»¶æ·»åŠ é¢å¤–çš„çº¦æŸï¼Œå¯ä»¥è®¾ç½®constraintsã€‚ ConstrainedBox( constraints: BoxConstraints( minWidth: double.infinity, //å®½åº¦å°½å¯èƒ½å¤§ minHeight: 50.0 //æœ€å°é«˜åº¦ä¸º50åƒç´  ), child: Container( height: 5.0, child: redBox , ), ) SizedBox ç”¨äºç»™å­å…ƒç´ æŒ‡å®šå›ºå®šçš„å®½é«˜ã€‚ SizedBox( width: 80.0, height: 80.0, child: redBox ) ConstrainedBoxä¸SizedBoxå…³ç³» ConstrainedBoxå’ŒSizedBoxéƒ½æ˜¯é€šè¿‡RenderConstrainedBoxæ¥æ¸²æŸ“çš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ConstrainedBoxå’ŒSizedBoxçš„createRenderObject()æ–¹æ³•éƒ½è¿”å›çš„æ˜¯ä¸€ä¸ªRenderConstrainedBoxå¯¹è±¡ @override RenderConstrainedBox createRenderObject(BuildContext context) { return RenderConstrainedBox( additionalConstraints: ..., ); } å¤šé‡é™åˆ¶ ConstrainedBox( constraints: BoxConstraints(minWidth: 60.0, minHeight: 60.0), //çˆ¶ child: ConstrainedBox( constraints: BoxConstraints(minWidth: 90.0, minHeight: 20.0),//å­ child: redBox, ), ) æˆ– ConstrainedBox( constraints: BoxConstraints(minWidth: 90.0, minHeight: 20.0), child: ConstrainedBox( constraints: BoxConstraints(minWidth: 60.0, minHeight: 60.0), child: redBox, ) ) æ˜¾ç¤ºæ•ˆæœç›¸åŒï¼Œ90x60ã€‚æˆ‘ä»¬å‘ç°æœ‰å¤šé‡é™åˆ¶æ—¶ï¼Œå¯¹äºminWidthå’ŒminHeightæ¥è¯´ï¼Œæ˜¯å–çˆ¶å­ä¸­ç›¸åº”æ•°å€¼è¾ƒå¤§çš„ã€‚å®é™…ä¸Šï¼Œåªæœ‰è¿™æ ·æ‰èƒ½ä¿è¯çˆ¶é™åˆ¶ä¸å­é™åˆ¶ä¸å†²çªã€‚ UnconstrainedBox ConstrainedBox( constraints: BoxConstraints(minWidth: 60.0, minHeight: 100.0), //çˆ¶ child: UnconstrainedBox( //â€œå»é™¤â€çˆ¶çº§é™åˆ¶ child: ConstrainedBox( constraints: BoxConstraints(minWidth: 90.0, minHeight: 20.0),//å­ child: redBox, ), ) ) ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœæ²¡æœ‰ä¸­é—´çš„UnconstrainedBoxï¼Œé‚£ä¹ˆæ ¹æ®ä¸Šé¢æ‰€è¿°çš„å¤šé‡é™åˆ¶è§„åˆ™ï¼Œé‚£ä¹ˆæœ€ç»ˆå°†æ˜¾ç¤ºä¸€ä¸ª90Ã—100çš„çº¢è‰²æ¡†ã€‚ä½†æ˜¯ç”±äºUnconstrainedBox â€œå»é™¤â€äº†çˆ¶ConstrainedBoxçš„é™åˆ¶ï¼Œåˆ™æœ€ç»ˆä¼šæŒ‰ç…§å­ConstrainedBoxçš„é™åˆ¶æ¥ç»˜åˆ¶redBoxï¼Œå³90Ã—20ã€‚ ä½†æ˜¯ï¼Œè¯»è€…è¯·æ³¨æ„ï¼ŒUnconstrainedBoxå¯¹çˆ¶ç»„ä»¶é™åˆ¶çš„â€œå»é™¤â€å¹¶éæ˜¯çœŸæ­£çš„å»é™¤ï¼šä¸Šé¢ä¾‹å­ä¸­è™½ç„¶çº¢è‰²åŒºåŸŸå¤§å°æ˜¯90Ã—20ï¼Œä½†ä¸Šæ–¹ä»ç„¶æœ‰80çš„ç©ºç™½ç©ºé—´ã€‚ä¹Ÿå°±æ˜¯è¯´çˆ¶é™åˆ¶çš„minHeight(100.0)ä»ç„¶æ˜¯ç”Ÿæ•ˆçš„ï¼Œåªä¸è¿‡å®ƒä¸å½±å“æœ€ç»ˆå­å…ƒç´ redBoxçš„å¤§å°ï¼Œä½†ä»ç„¶è¿˜æ˜¯å æœ‰ç›¸åº”çš„ç©ºé—´ï¼Œå¯ä»¥è®¤ä¸ºæ­¤æ—¶çš„çˆ¶ConstrainedBoxæ˜¯ä½œç”¨äºå­UnconstrainedBoxä¸Šï¼Œè€ŒredBoxåªå—å­ConstrainedBoxé™åˆ¶ã€‚ "},"pages/fultter/çº¿æ€§å¸ƒå±€.html":{"url":"pages/fultter/çº¿æ€§å¸ƒå±€.html","title":"çº¿æ€§å¸ƒå±€","keywords":"","body":"çº¿æ€§å¸ƒå±€ æºç  çº¿æ€§å¸ƒå±€ ä¸»è½´å’Œçºµè½´ ä¸»è½´ï¼šRowçš„ä¸»è½´æ˜¯æ°´å¹³æ–¹å‘ï¼Œå› ä¸ºRowæ˜¯æ²¿æ°´å¹³æ–¹å‘å¸ƒå±€ï¼›Columnçš„ä¸»è½´æ˜¯å‚ç›´æ–¹å‘ï¼ŒåŒç†ï¼› çºµè½´ï¼šRowçš„çºµè½´æ˜¯å‚ç›´æ–¹å‘ï¼Œè€ŒColumnçš„çºµè½´æ˜¯æ°´å¹³æ–¹å‘ã€‚ Row Rowå¯ä»¥æ²¿æ°´å¹³æ–¹å‘æ’åˆ—å…¶å­widgetã€‚å®šä¹‰å¦‚ä¸‹ï¼š Row({ ... TextDirection textDirection, MainAxisSize mainAxisSize = MainAxisSize.max, MainAxisAlignment mainAxisAlignment = MainAxisAlignment.start, VerticalDirection verticalDirection = VerticalDirection.down, CrossAxisAlignment crossAxisAlignment = CrossAxisAlignment.center, List children = const [], }) textDirectionï¼šRowæ˜¯æ²¿ç€æ°´å¹³æ–¹å‘å¸ƒå±€ï¼Œé‚£ä¹ˆå°±å­˜åœ¨ï¼Œä»å·¦åˆ°å³è¿˜æ˜¯ä»å³åˆ°å·¦ï¼ŒtextDirectionå°±æ˜¯å†³å®šè¿™ä¸ªå¸ƒå±€æ–¹å‘ã€‚ mainAxisSizeï¼šæ°´å¹³æ–¹å‘ä¸Šæ˜¯å¦å ç”¨æœ€å¤§ç©ºé—´ã€‚ mainAxisAlignmentï¼šæ°´å¹³æ–¹å‘çš„å¯¹é½æ–¹å¼ï¼Œä¸textDirectionå…±åŒå†³å®šã€‚ verticalDirectionï¼šå‚ç›´æ–¹å‘å¯¹é½æ–¹å‘ã€‚ crossAxisAlignmentï¼šå‚ç›´æ–¹å‘çš„å¯¹é½æ–¹å¼ï¼Œä¸verticalDirectionå…±åŒå†³å®šã€‚ ç¤ºä¾‹ï¼š Column( //æµ‹è¯•Rowå¯¹é½æ–¹å¼ï¼Œæ’é™¤Columné»˜è®¤å±…ä¸­å¯¹é½çš„å¹²æ‰° crossAxisAlignment: CrossAxisAlignment.start, children: [ Row( mainAxisAlignment: MainAxisAlignment.center, children: [ Text(\" hello world \"), Text(\" I am Jack \"), ], ), Row( mainAxisSize: MainAxisSize.min, mainAxisAlignment: MainAxisAlignment.center, children: [ Text(\" hello world \"), Text(\" I am Jack \"), ], ), Row( mainAxisAlignment: MainAxisAlignment.end, textDirection: TextDirection.rtl, children: [ Text(\" hello world \"), Text(\" I am Jack \"), ], ), Row( crossAxisAlignment: CrossAxisAlignment.start, verticalDirection: VerticalDirection.up, children: [ Text(\" hello world \", style: TextStyle(fontSize: 30.0),), Text(\" I am Jack \"), ], ), ], ) è§£é‡Šï¼šç¬¬ä¸€ä¸ªRowå¾ˆç®€å•ï¼Œé»˜è®¤ä¸ºå±…ä¸­å¯¹é½ï¼›ç¬¬äºŒä¸ªRowï¼Œç”±äºmainAxisSizeå€¼ä¸ºMainAxisSize.minï¼ŒRowçš„å®½åº¦ç­‰äºä¸¤ä¸ªTextçš„å®½åº¦å’Œï¼Œæ‰€ä»¥å¯¹é½æ˜¯æ— æ„ä¹‰çš„ï¼Œæ‰€ä»¥ä¼šä»å·¦å¾€å³æ˜¾ç¤ºï¼›ç¬¬ä¸‰ä¸ªRowè®¾ç½®textDirectionå€¼ä¸ºTextDirection.rtlï¼Œæ‰€ä»¥å­ç»„ä»¶ä¼šä»å³å‘å·¦çš„é¡ºåºæ’åˆ—ï¼Œè€Œæ­¤æ—¶MainAxisAlignment.endè¡¨ç¤ºå·¦å¯¹é½ï¼Œæ‰€ä»¥æœ€ç»ˆæ˜¾ç¤ºç»“æœå°±æ˜¯å›¾ä¸­ç¬¬ä¸‰è¡Œçš„æ ·å­ï¼›ç¬¬å››ä¸ª Row æµ‹è¯•çš„æ˜¯çºµè½´çš„å¯¹é½æ–¹å¼ï¼Œç”±äºä¸¤ä¸ªå­ Text å­—ä½“ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å…¶é«˜åº¦ä¹Ÿä¸åŒï¼Œæˆ‘ä»¬æŒ‡å®šäº†verticalDirectionå€¼ä¸ºVerticalDirection.upï¼Œå³ä»ä½å‘é¡¶æ’åˆ—ï¼Œè€Œæ­¤æ—¶crossAxisAlignmentå€¼ä¸ºCrossAxisAlignment.startè¡¨ç¤ºåº•å¯¹é½ã€‚ Column Columnå¯ä»¥åœ¨å‚ç›´æ–¹å‘æ’åˆ—å…¶å­ç»„ä»¶ã€‚ "},"pages/fultter/å¼¹æ€§å¸ƒå±€.html":{"url":"pages/fultter/å¼¹æ€§å¸ƒå±€.html","title":"å¼¹æ€§å¸ƒå±€","keywords":"","body":"å¼¹æ€§å¸ƒå±€ æºç  å¼¹æ€§å¸ƒå±€ å¼¹æ€§å¸ƒå±€å…è®¸å­ç»„ä»¶æŒ‰ç…§ä¸€å®šæ¯”ä¾‹æ¥åˆ†é…çˆ¶å®¹å™¨ç©ºé—´ã€‚ Flex Flexç»§æ‰¿è‡ªMultiChildRenderObjectWidgetï¼Œå¯¹åº”çš„RenderObjectä¸ºRenderFlexï¼ŒRenderFlexä¸­å®ç°äº†å…¶å¸ƒå±€ç®—æ³•ã€‚ Flex({ ... required this.direction, //å¼¹æ€§å¸ƒå±€çš„æ–¹å‘, Rowé»˜è®¤ä¸ºæ°´å¹³æ–¹å‘ï¼ŒColumné»˜è®¤ä¸ºå‚ç›´æ–¹å‘ List children = const [], }) Expanded Expanded åªèƒ½ä½œä¸º Flex çš„å­©å­ï¼ˆå¦åˆ™ä¼šæŠ¥é”™ï¼‰ï¼Œå®ƒå¯ä»¥æŒ‰æ¯”ä¾‹â€œæ‰©ä¼¸â€Flexå­ç»„ä»¶æ‰€å ç”¨çš„ç©ºé—´ã€‚å› ä¸º Rowå’ŒColumn éƒ½ç»§æ‰¿è‡ª Flexï¼Œæ‰€ä»¥ Expanded ä¹Ÿå¯ä»¥ä½œä¸ºå®ƒä»¬çš„å­©å­ã€‚ const Expanded({ int flex = 1, required Widget child, }) flexå‚æ•°ä¸ºå¼¹æ€§ç³»æ•°ï¼Œå¦‚æœä¸º 0 æˆ–nullï¼Œåˆ™childæ˜¯æ²¡æœ‰å¼¹æ€§çš„ï¼Œå³ä¸ä¼šè¢«æ‰©ä¼¸å ç”¨çš„ç©ºé—´ã€‚å¦‚æœå¤§äº0ï¼Œæ‰€æœ‰çš„ExpandedæŒ‰ç…§å…¶ flex çš„æ¯”ä¾‹æ¥åˆ†å‰²ä¸»è½´çš„å…¨éƒ¨ç©ºé—²ç©ºé—´ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼š class FlexLayoutTestRoute extends StatelessWidget { @override Widget build(BuildContext context) { return Column( children: [ //Flexçš„ä¸¤ä¸ªå­widgetæŒ‰1ï¼š2æ¥å æ®æ°´å¹³ç©ºé—´ Flex( direction: Axis.horizontal, children: [ Expanded( flex: 1, child: Container( height: 30.0, color: Colors.red, ), ), Expanded( flex: 2, child: Container( height: 30.0, color: Colors.green, ), ), ], ), Padding( padding: const EdgeInsets.only(top: 20.0), child: SizedBox( height: 100.0, //Flexçš„ä¸‰ä¸ªå­widgetï¼Œåœ¨å‚ç›´æ–¹å‘æŒ‰2ï¼š1ï¼š1æ¥å ç”¨100åƒç´ çš„ç©ºé—´ child: Flex( direction: Axis.vertical, children: [ Expanded( flex: 2, child: Container( height: 30.0, color: Colors.red, ), ), Spacer( flex: 1, ), Expanded( flex: 1, child: Container( height: 30.0, color: Colors.green, ), ), ], ), ), ), ], ); } } ç¤ºä¾‹ä¸­çš„Spacerçš„åŠŸèƒ½æ˜¯å ç”¨æŒ‡å®šæ¯”ä¾‹çš„ç©ºé—´ï¼Œå®é™…ä¸Šå®ƒåªæ˜¯Expandedçš„ä¸€ä¸ªåŒ…è£…ç±»ï¼ŒSpacerçš„æºç å¦‚ä¸‹ï¼š class Spacer extends StatelessWidget { const Spacer({Key? key, this.flex = 1}) : assert(flex != null), assert(flex > 0), super(key: key); final int flex; @override Widget build(BuildContext context) { return Expanded( flex: flex, child: const SizedBox.shrink(), ); } } "},"pages/fultter/æµå¼å¸ƒå±€.html":{"url":"pages/fultter/æµå¼å¸ƒå±€.html","title":"æµå¼å¸ƒå±€","keywords":"","body":"æµå¼å¸ƒå±€ æºç  æµå¼å¸ƒå±€ è¶…å‡ºå±å¹•æ˜¾ç¤ºèŒƒå›´ä¼šè‡ªåŠ¨æŠ˜è¡Œçš„å¸ƒå±€ç§°ä¸ºæµå¼å¸ƒå±€ã€‚ Wrap ä¸‹é¢æ˜¯Wrapçš„å®šä¹‰: Wrap({ ... this.direction = Axis.horizontal, this.alignment = WrapAlignment.start, this.spacing = 0.0, this.runAlignment = WrapAlignment.start, this.runSpacing = 0.0, this.crossAxisAlignment = WrapCrossAlignment.start, this.textDirection, this.verticalDirection = VerticalDirection.down, List children = const [], }) spacingï¼šä¸»è½´æ–¹å‘å­widgetçš„é—´è· runSpacingï¼šçºµè½´æ–¹å‘çš„é—´è· runAlignmentï¼šçºµè½´æ–¹å‘çš„å¯¹é½æ–¹å¼ ä¸‹é¢çœ‹ä¸€ä¸ªç¤ºä¾‹å­ï¼š Wrap( spacing: 8.0, // ä¸»è½´(æ°´å¹³)æ–¹å‘é—´è· runSpacing: 4.0, // çºµè½´ï¼ˆå‚ç›´ï¼‰æ–¹å‘é—´è· alignment: WrapAlignment.center, //æ²¿ä¸»è½´æ–¹å‘å±…ä¸­ children: [ Chip( avatar: CircleAvatar(backgroundColor: Colors.blue, child: Text('A')), label: Text('Hamilton'), ), Chip( avatar: CircleAvatar(backgroundColor: Colors.blue, child: Text('M')), label: Text('Lafayette'), ), Chip( avatar: CircleAvatar(backgroundColor: Colors.blue, child: Text('H')), label: Text('Mulligan'), ), Chip( avatar: CircleAvatar(backgroundColor: Colors.blue, child: Text('J')), label: Text('Laurens'), ), ], ) Flow ä¸»è¦ç”¨äºä¸€äº›éœ€è¦è‡ªå®šä¹‰å¸ƒå±€ç­–ç•¥æˆ–æ€§èƒ½è¦æ±‚è¾ƒé«˜(å¦‚åŠ¨ç”»ä¸­)çš„åœºæ™¯ã€‚ "},"pages/fultter/å±‚å å¸ƒå±€.html":{"url":"pages/fultter/å±‚å å¸ƒå±€.html","title":"å±‚å å¸ƒå±€","keywords":"","body":"å±‚å å¸ƒå±€ æºç  å±‚å å¸ƒå±€ å­ç»„ä»¶å¯ä»¥æ ¹æ®è·çˆ¶å®¹å™¨å››ä¸ªè§’çš„ä½ç½®æ¥ç¡®å®šè‡ªèº«çš„ä½ç½®ã€‚å±‚å å¸ƒå±€å…è®¸å­ç»„ä»¶æŒ‰ç…§ä»£ç ä¸­å£°æ˜çš„é¡ºåºå †å èµ·æ¥ã€‚ Stack Stack({ this.alignment = AlignmentDirectional.topStart, this.textDirection, this.fit = StackFit.loose, this.clipBehavior = Clip.hardEdge, List children = const [], }) alignmentï¼šå†³å®šå¦‚ä½•å»å¯¹é½æ²¡æœ‰å®šä½ï¼ˆæ²¡æœ‰ä½¿ç”¨Positionedï¼‰æˆ–éƒ¨åˆ†å®šä½çš„å­ç»„ä»¶ã€‚ textDirectionï¼šå’ŒRowã€Wrapçš„textDirectionåŠŸèƒ½ä¸€æ ·ï¼Œéƒ½ç”¨äºç¡®å®šalignmentå¯¹é½çš„å‚è€ƒç³»ã€‚ fitï¼šæ­¤å‚æ•°ç”¨äºç¡®å®šæ²¡æœ‰å®šä½çš„å­ç»„ä»¶å¦‚ä½•å»é€‚åº”Stackçš„å¤§å°ã€‚ clipBehaviorï¼šæ­¤å±æ€§å†³å®šå¯¹è¶…å‡ºStackæ˜¾ç¤ºç©ºé—´çš„éƒ¨åˆ†å¦‚ä½•å‰ªè£ã€‚ Positioned const Positioned({ Key? key, this.left, this.top, this.right, this.bottom, this.width, this.height, required Widget child, }) leftã€top ã€rightã€ bottomåˆ†åˆ«ä»£è¡¨ç¦»Stackå·¦ã€ä¸Šã€å³ã€åº•å››è¾¹çš„è·ç¦»ã€‚widthå’Œheightç”¨äºæŒ‡å®šéœ€è¦å®šä½å…ƒç´ çš„å®½åº¦å’Œé«˜åº¦ã€‚æ³¨æ„ï¼ŒPositionedçš„widthã€height å’Œå…¶ä»–åœ°æ–¹çš„æ„ä¹‰ç¨å¾®æœ‰ç‚¹åŒºåˆ«ï¼Œæ­¤å¤„ç”¨äºé…åˆleftã€top ã€rightã€ bottomæ¥å®šä½ç»„ä»¶ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œåœ¨æ°´å¹³æ–¹å‘æ—¶ï¼Œä½ åªèƒ½æŒ‡å®šleftã€rightã€widthä¸‰ä¸ªå±æ€§ä¸­çš„ä¸¤ä¸ªï¼Œå¦‚æŒ‡å®šleftå’Œwidthåï¼Œrightä¼šè‡ªåŠ¨ç®—å‡º(left+width)ï¼Œå¦‚æœåŒæ—¶æŒ‡å®šä¸‰ä¸ªå±æ€§åˆ™ä¼šæŠ¥é”™ï¼Œå‚ç›´æ–¹å‘åŒç†ã€‚ ç¤ºä¾‹ //é€šè¿‡ConstrainedBoxæ¥ç¡®ä¿Stackå æ»¡å±å¹• ConstrainedBox( constraints: BoxConstraints.expand(), child: Stack( alignment:Alignment.center , //æŒ‡å®šæœªå®šä½æˆ–éƒ¨åˆ†å®šä½widgetçš„å¯¹é½æ–¹å¼ children: [ Container( child: Text(\"Hello world\",style: TextStyle(color: Colors.white)), color: Colors.red, ), Positioned( left: 18.0, child: Text(\"I am Jack\"), ), Positioned( top: 18.0, child: Text(\"Your friend\"), ) ], ), ); ç”±äºç¬¬ä¸€ä¸ªå­æ–‡æœ¬ç»„ä»¶Text(\"Hello world\")æ²¡æœ‰æŒ‡å®šå®šä½ï¼Œå¹¶ä¸”alignmentå€¼ä¸ºAlignment.centerï¼Œæ‰€ä»¥å®ƒä¼šå±…ä¸­æ˜¾ç¤ºã€‚ç¬¬äºŒä¸ªå­æ–‡æœ¬ç»„ä»¶Text(\"I am Jack\")åªæŒ‡å®šäº†æ°´å¹³æ–¹å‘çš„å®šä½(left)ï¼Œæ‰€ä»¥å±äºéƒ¨åˆ†å®šä½ï¼Œå³å‚ç›´æ–¹å‘ä¸Šæ²¡æœ‰å®šä½ï¼Œé‚£ä¹ˆå®ƒåœ¨å‚ç›´æ–¹å‘çš„å¯¹é½æ–¹å¼åˆ™ä¼šæŒ‰ç…§alignmentæŒ‡å®šçš„å¯¹é½æ–¹å¼å¯¹é½ï¼Œå³å‚ç›´æ–¹å‘å±…ä¸­ã€‚å¯¹äºç¬¬ä¸‰ä¸ªå­æ–‡æœ¬ç»„ä»¶Text(\"Your friend\")ï¼Œå’Œç¬¬äºŒä¸ªTextåŸç†ä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯æ°´å¹³æ–¹å‘æ²¡æœ‰å®šä½ï¼Œåˆ™æ°´å¹³æ–¹å‘å±…ä¸­ã€‚ æˆ‘ä»¬ç»™ä¸Šä¾‹ä¸­çš„StackæŒ‡å®šä¸€ä¸ªfitå±æ€§ï¼Œç„¶åå°†ä¸‰ä¸ªå­æ–‡æœ¬ç»„ä»¶çš„é¡ºåºè°ƒæ•´ä¸€ä¸‹ï¼š Stack( alignment:Alignment.center , fit: StackFit.expand, //æœªå®šä½widgetå æ»¡Stackæ•´ä¸ªç©ºé—´ children: [ Positioned( left: 18.0, child: Text(\"I am Jack\"), ), Container(child: Text(\"Hello world\",style: TextStyle(color: Colors.white)), color: Colors.red, ), Positioned( top: 18.0, child: Text(\"Your friend\"), ) ], ), å¯ä»¥çœ‹åˆ°ï¼Œç”±äºç¬¬äºŒä¸ªå­æ–‡æœ¬ç»„ä»¶æ²¡æœ‰å®šä½ï¼Œæ‰€ä»¥fitå±æ€§ä¼šå¯¹å®ƒèµ·ä½œç”¨ï¼Œå°±ä¼šå æ»¡Stackã€‚ç”±äºStackå­å…ƒç´ æ˜¯å †å çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå­æ–‡æœ¬ç»„ä»¶è¢«ç¬¬äºŒä¸ªé®ä½äº†ï¼Œè€Œç¬¬ä¸‰ä¸ªåœ¨æœ€ä¸Šå±‚ï¼Œæ‰€ä»¥å¯ä»¥æ­£å¸¸æ˜¾ç¤ºã€‚ "},"pages/fultter/å¯¹é½ä¸ç›¸å¯¹å®šä½.html":{"url":"pages/fultter/å¯¹é½ä¸ç›¸å¯¹å®šä½.html","title":"å¯¹é½ä¸ç›¸å¯¹å®šä½","keywords":"","body":"å¯¹é½ä¸ç›¸å¯¹å®šä½ æºç  å¯¹é½ä¸ç›¸å¯¹å®šä½ Align Align ç»„ä»¶å¯ä»¥è°ƒæ•´å­ç»„ä»¶çš„ä½ç½®ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š Align({ Key key, this.alignment = Alignment.center, this.widthFactor, this.heightFactor, Widget child, }) alignmentï¼šéœ€è¦ä¸€ä¸ªAlignmentGeometryç±»å‹çš„å€¼ï¼Œè¡¨ç¤ºå­ç»„ä»¶åœ¨çˆ¶ç»„ä»¶ä¸­çš„èµ·å§‹ä½ç½®ã€‚ AlignmentGeometry æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒæœ‰ä¸¤ä¸ªå¸¸ç”¨çš„å­ç±»ï¼šAlignmentå’Œ FractionalOffsetã€‚ widthFactorå’ŒheightFactoræ˜¯ç”¨äºç¡®å®šAlign ç»„ä»¶æœ¬èº«å®½é«˜çš„å±æ€§ï¼›å®ƒä»¬æ˜¯ä¸¤ä¸ªç¼©æ”¾å› å­ï¼Œä¼šåˆ†åˆ«ä¹˜ä»¥å­å…ƒç´ çš„å®½ã€é«˜ï¼Œæœ€ç»ˆçš„ç»“æœå°±æ˜¯Align ç»„ä»¶çš„å®½é«˜ã€‚å¦‚æœå€¼ä¸ºnullï¼Œåˆ™ç»„ä»¶çš„å®½é«˜å°†ä¼šå ç”¨å°½å¯èƒ½å¤šçš„ç©ºé—´ã€‚ ç¤ºä¾‹ Container( height: 120.0, width: 120.0, color: Colors.blue.shade50, child: Align( alignment: Alignment.topRight, child: FlutterLogo( size: 60, ), ), ) æˆ– Align( widthFactor: 2, heightFactor: 2, alignment: Alignment.topRight, child: FlutterLogo( size: 60, ), ), æ•ˆæœä¸€æ ·ï¼ŒFlutterLogoçš„å®½é«˜ä¸º 60ï¼Œåˆ™Alignçš„æœ€ç»ˆå®½é«˜éƒ½ä¸º2*60=120ã€‚ Alignment.topRightï¼š //å³ä¸Šè§’ static const Alignment topRight = Alignment(1.0, -1.0); å¯ä»¥çœ‹åˆ°å®ƒåªæ˜¯Alignmentçš„ä¸€ä¸ªå®ä¾‹ã€‚ Alignment Alignmentç»§æ‰¿è‡ªAlignmentGeometryï¼Œè¡¨ç¤ºçŸ©å½¢å†…çš„ä¸€ä¸ªç‚¹ï¼Œä»–æœ‰ä¸¤ä¸ªå±æ€§xã€yï¼Œåˆ†åˆ«è¡¨ç¤ºåœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘çš„åç§»ï¼ŒAlignmentå®šä¹‰å¦‚ä¸‹ï¼š Alignment(this.x, this.y) Alignment Widgetä¼šä»¥çŸ©å½¢çš„ä¸­å¿ƒç‚¹ä½œä¸ºåæ ‡åŸç‚¹ã€‚ Alignmentå¯ä»¥é€šè¿‡å…¶åæ ‡è½¬æ¢å…¬å¼å°†å…¶åæ ‡è½¬ä¸ºå­å…ƒç´ çš„å…·ä½“åç§»åæ ‡ï¼š (Alignment.x*childWidth/2+childWidth/2, Alignment.y*childHeight/2+childHeight/2) FractionalOffset FractionalOffset ç»§æ‰¿è‡ª Alignmentï¼Œå®ƒå’Œ Alignmentå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯åæ ‡åŸç‚¹ä¸åŒï¼FractionalOffset çš„åæ ‡åŸç‚¹ä¸ºçŸ©å½¢çš„å·¦ä¾§é¡¶ç‚¹ï¼Œè¿™å’Œå¸ƒå±€ç³»ç»Ÿçš„ä¸€è‡´ã€‚FractionalOffsetçš„åæ ‡è½¬æ¢å…¬å¼ä¸ºï¼š å®é™…åç§» = (FractionalOffse.x * childWidth, FractionalOffse.y * childHeight) Center Centerç»„ä»¶å…¶å®æ˜¯å¯¹é½æ–¹å¼ç¡®å®šï¼ˆAlignment.centerï¼‰äº†çš„Alignã€‚ class Center extends Align { const Center({ Key? key, double widthFactor, double heightFactor, Widget? child }) : super(key: key, widthFactor: widthFactor, heightFactor: heightFactor, child: child); } "},"pages/fultter/LayoutBuilder.html":{"url":"pages/fultter/LayoutBuilder.html","title":"LayoutBuilder","keywords":"","body":"LayoutBuilder æºç  LayoutBuilder é€šè¿‡ LayoutBuilderï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¸ƒå±€è¿‡ç¨‹ä¸­æ‹¿åˆ°çˆ¶ç»„ä»¶ä¼ é€’çš„çº¦æŸä¿¡æ¯ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥æ ¹æ®çº¦æŸä¿¡æ¯åŠ¨æ€çš„æ„å»ºä¸åŒçš„å¸ƒå±€ã€‚ ç¤ºä¾‹ æ¯”å¦‚æˆ‘ä»¬å®ç°ä¸€ä¸ªå“åº”å¼çš„ Column ç»„ä»¶ ResponsiveColumnï¼Œå®ƒçš„åŠŸèƒ½æ˜¯å½“å½“å‰å¯ç”¨çš„å®½åº¦å°äº 200 æ—¶ï¼Œå°†å­ç»„ä»¶æ˜¾ç¤ºä¸ºä¸€åˆ—ï¼Œå¦åˆ™æ˜¾ç¤ºä¸ºä¸¤åˆ—ã€‚ç®€å•æ¥å®ç°ä¸€ä¸‹ï¼š class ResponsiveColumn extends StatelessWidget { const ResponsiveColumn({Key? key, required this.children}) : super(key: key); final List children; @override Widget build(BuildContext context) { // é€šè¿‡ LayoutBuilder æ‹¿åˆ°çˆ¶ç»„ä»¶ä¼ é€’çš„çº¦æŸï¼Œç„¶ååˆ¤æ–­ maxWidth æ˜¯å¦å°äº200 return LayoutBuilder( builder: (BuildContext context, BoxConstraints constraints) { if (constraints.maxWidth []; for (var i = 0; i å¯ä»¥å‘ç° LayoutBuilder çš„ä½¿ç”¨å¾ˆç®€å•ï¼Œä½†æ˜¯ä¸è¦å°çœ‹å®ƒï¼Œå› ä¸ºå®ƒéå¸¸å®ç”¨ä¸”é‡è¦ï¼Œå®ƒä¸»è¦æœ‰ä¸¤ä¸ªä½¿ç”¨åœºæ™¯ï¼š å¯ä»¥ä½¿ç”¨ LayoutBuilder æ¥æ ¹æ®è®¾å¤‡çš„å°ºå¯¸æ¥å®ç°å“åº”å¼å¸ƒå±€ã€‚ LayoutBuilder å¯ä»¥å¸®æˆ‘ä»¬é«˜æ•ˆæ’æŸ¥é—®é¢˜ã€‚æ¯”å¦‚æˆ‘ä»¬åœ¨é‡åˆ°å¸ƒå±€é—®é¢˜æˆ–è€…æƒ³è°ƒè¯•ç»„ä»¶æ ‘ä¸­æŸä¸€ä¸ªèŠ‚ç‚¹å¸ƒå±€çš„çº¦æŸæ—¶ LayoutBuilder å°±å¾ˆæœ‰ç”¨ã€‚ æ‰“å°å¸ƒå±€æ—¶çš„çº¦æŸä¿¡æ¯ class LayoutLogPrint extends StatelessWidget { const LayoutLogPrint({ Key? key, this.tag, required this.child, }) : super(key: key); final Widget child; final T? tag; //æŒ‡å®šæ—¥å¿—tag @override Widget build(BuildContext context) { return LayoutBuilder(builder: (_, constraints) { // assertåœ¨ç¼–è¯‘releaseç‰ˆæœ¬æ—¶ä¼šè¢«å»é™¤ assert(() { print('${tag ?? key ?? child}: $constraints'); return true; }()); return child; }); } } æ§åˆ¶å°è¾“å‡ºï¼š flutter: Text(\"xfsdjlfsx\"): BoxConstraints(0.0 æ³¨æ„ï¼æˆ‘ä»¬çš„å¤§å‰ææ˜¯ç›’æ¨¡å‹å¸ƒå±€ï¼Œå¦‚æœæ˜¯Sliver å¸ƒå±€ï¼Œå¯ä»¥ä½¿ç”¨ SliverLayoutBuiler æ¥æ‰“å°ã€‚ AfterLayout "},"pages/fultter/Padding.html":{"url":"pages/fultter/Padding.html","title":"Padding","keywords":"","body":"Padding æºç  å¡«å……ï¼ˆPaddingï¼‰ Padding Paddingå¯ä»¥ç»™å…¶å­èŠ‚ç‚¹æ·»åŠ å¡«å……ï¼ˆç•™ç™½ï¼‰ï¼Œå’Œè¾¹è·æ•ˆæœç±»ä¼¼ã€‚æˆ‘ä»¬åœ¨å‰é¢å¾ˆå¤šç¤ºä¾‹ä¸­éƒ½å·²ç»ä½¿ç”¨è¿‡å®ƒäº†ï¼Œç°åœ¨æ¥çœ‹çœ‹å®ƒçš„å®šä¹‰ï¼š Padding({ ... EdgeInsetsGeometry padding, Widget child, }) EdgeInsetsGeometryæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä½¿ç”¨EdgeInsetsç±»ï¼Œå®ƒæ˜¯EdgeInsetsGeometryçš„ä¸€ä¸ªå­ç±»ï¼Œå®šä¹‰äº†ä¸€äº›è®¾ç½®å¡«å……çš„ä¾¿æ·æ–¹æ³•ã€‚ EdgeInsets æˆ‘ä»¬çœ‹çœ‹EdgeInsetsæä¾›çš„ä¾¿æ·æ–¹æ³•ï¼š fromLTRB(double left, double top, double right, double bottom)ï¼šåˆ†åˆ«æŒ‡å®šå››ä¸ªæ–¹å‘çš„å¡«å……ã€‚ all(double value) : æ‰€æœ‰æ–¹å‘å‡ä½¿ç”¨ç›¸åŒæ•°å€¼çš„å¡«å……ã€‚ only({left, top, right ,bottom })ï¼šå¯ä»¥è®¾ç½®å…·ä½“æŸä¸ªæ–¹å‘çš„å¡«å……(å¯ä»¥åŒæ—¶æŒ‡å®šå¤šä¸ªæ–¹å‘)ã€‚ symmetric({ vertical, horizontal })ï¼šç”¨äºè®¾ç½®å¯¹ç§°æ–¹å‘çš„å¡«å……ï¼ŒverticalæŒ‡topå’Œbottomï¼ŒhorizontalæŒ‡leftå’Œrightã€‚ ç¤ºä¾‹ ä¸‹é¢çš„ç¤ºä¾‹ä¸»è¦å±•ç¤ºäº†EdgeInsetsçš„ä¸åŒç”¨æ³•ï¼Œæ¯”è¾ƒç®€å•ï¼Œæºç å¦‚ä¸‹ï¼š class PaddingTestRoute extends StatelessWidget { const PaddingTestRoute({Key? key}) : super(key: key); @override Widget build(BuildContext context) { return Padding( //ä¸Šä¸‹å·¦å³å„æ·»åŠ 16åƒç´ è¡¥ç™½ padding: const EdgeInsets.all(16), child: Column( //æ˜¾å¼æŒ‡å®šå¯¹é½æ–¹å¼ä¸ºå·¦å¯¹é½ï¼Œæ’é™¤å¯¹é½å¹²æ‰° crossAxisAlignment: CrossAxisAlignment.start, mainAxisSize: MainAxisSize.min, children: const [ Padding( //å·¦è¾¹æ·»åŠ 8åƒç´ è¡¥ç™½ padding: EdgeInsets.only(left: 8), child: Text(\"Hello world\"), ), Padding( //ä¸Šä¸‹å„æ·»åŠ 8åƒç´ è¡¥ç™½ padding: EdgeInsets.symmetric(vertical: 8), child: Text(\"I am Jack\"), ), Padding( // åˆ†åˆ«æŒ‡å®šå››ä¸ªæ–¹å‘çš„è¡¥ç™½ padding: EdgeInsets.fromLTRB(20, 0, 20, 20), child: Text(\"Your friend\"), ) ], ), ); } } "},"pages/fultter/DecoratedBox.html":{"url":"pages/fultter/DecoratedBox.html","title":"DecoratedBox","keywords":"","body":"DecoratedBox æºç  è£…é¥°å®¹å™¨ï¼ˆDecoratedBoxï¼‰ DecoratedBox DecoratedBoxå¯ä»¥åœ¨å…¶å­ç»„ä»¶ç»˜åˆ¶å‰(æˆ–å)ç»˜åˆ¶ä¸€äº›è£…é¥°ï¼ˆDecorationï¼‰ï¼Œå¦‚èƒŒæ™¯ã€è¾¹æ¡†ã€æ¸å˜ç­‰ã€‚DecoratedBoxå®šä¹‰å¦‚ä¸‹ï¼š const DecoratedBox({ Decoration decoration, DecorationPosition position = DecorationPosition.background, Widget? child }) decorationï¼šä»£è¡¨å°†è¦ç»˜åˆ¶çš„è£…é¥°ï¼Œå®ƒçš„ç±»å‹ä¸ºDecorationã€‚Decorationæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªæ¥å£ createBoxPainter()ï¼Œå­ç±»çš„ä¸»è¦èŒè´£æ˜¯éœ€è¦é€šè¿‡å®ç°å®ƒæ¥åˆ›å»ºä¸€ä¸ªç”»ç¬”ï¼Œè¯¥ç”»ç¬”ç”¨äºç»˜åˆ¶è£…é¥°ã€‚ positionï¼šæ­¤å±æ€§å†³å®šåœ¨å“ªé‡Œç»˜åˆ¶Decorationï¼Œå®ƒæ¥æ”¶DecorationPositionçš„æšä¸¾ç±»å‹ï¼Œè¯¥æšä¸¾ç±»æœ‰ä¸¤ä¸ªå€¼ï¼š backgroundï¼šåœ¨å­ç»„ä»¶ä¹‹åç»˜åˆ¶ï¼Œå³èƒŒæ™¯è£…é¥°ã€‚ foregroundï¼šåœ¨å­ç»„ä»¶ä¹‹ä¸Šç»˜åˆ¶ï¼Œå³å‰æ™¯ã€‚BoxDecoration æˆ‘ä»¬é€šå¸¸ä¼šç›´æ¥ä½¿ç”¨BoxDecorationç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ªDecorationçš„å­ç±»ï¼Œå®ç°äº†å¸¸ç”¨çš„è£…é¥°å…ƒç´ çš„ç»˜åˆ¶ã€‚ BoxDecoration({ Color color, //é¢œè‰² DecorationImage image,//å›¾ç‰‡ BoxBorder border, //è¾¹æ¡† BorderRadiusGeometry borderRadius, //åœ†è§’ List boxShadow, //é˜´å½±,å¯ä»¥æŒ‡å®šå¤šä¸ª Gradient gradient, //æ¸å˜ BlendMode backgroundBlendMode, //èƒŒæ™¯æ··åˆæ¨¡å¼ BoxShape shape = BoxShape.rectangle, //å½¢çŠ¶ }) ç¤ºä¾‹ DecoratedBox( decoration: BoxDecoration( gradient: LinearGradient(colors:[Colors.red,Colors.orange.shade700]), //èƒŒæ™¯æ¸å˜ borderRadius: BorderRadius.circular(3.0), //3åƒç´ åœ†è§’ boxShadow: [ //é˜´å½± BoxShadow( color:Colors.black54, offset: Offset(2.0,2.0), blurRadius: 4.0 ) ] ), child: Padding( padding: EdgeInsets.symmetric(horizontal: 80.0, vertical: 18.0), child: Text(\"Login\", style: TextStyle(color: Colors.white),), ) ) LinearGradientã€RadialGradientã€SweepGradient "},"pages/fultter/Transform.html":{"url":"pages/fultter/Transform.html","title":"Transform","keywords":"","body":"Transform æºç  å˜æ¢ï¼ˆTransformï¼‰ Transformå¯ä»¥åœ¨å…¶å­ç»„ä»¶ç»˜åˆ¶æ—¶å¯¹å…¶åº”ç”¨ä¸€äº›çŸ©é˜µå˜æ¢æ¥å®ç°ä¸€äº›ç‰¹æ•ˆã€‚Matrix4æ˜¯ä¸€ä¸ª4DçŸ©é˜µï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥å®ç°å„ç§çŸ©é˜µæ“ä½œï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š Container( color: Colors.black, child: Transform( alignment: Alignment.topRight, //ç›¸å¯¹äºåæ ‡ç³»åŸç‚¹çš„å¯¹é½æ–¹å¼ transform: Matrix4.skewY(0.3), //æ²¿Yè½´å€¾æ–œ0.3å¼§åº¦ child: Container( padding: const EdgeInsets.all(8.0), color: Colors.deepOrange, child: const Text('Apartment for rent!'), ), ), ) å¹³ç§» Transform.translateæ¥æ”¶ä¸€ä¸ªoffsetå‚æ•°ï¼Œå¯ä»¥åœ¨ç»˜åˆ¶æ—¶æ²¿xã€yè½´å¯¹å­ç»„ä»¶å¹³ç§»æŒ‡å®šçš„è·ç¦»ã€‚ DecoratedBox( decoration:BoxDecoration(color: Colors.red), //é»˜è®¤åŸç‚¹ä¸ºå·¦ä¸Šè§’ï¼Œå·¦ç§»20åƒç´ ï¼Œå‘ä¸Šå¹³ç§»5åƒç´  child: Transform.translate( offset: Offset(-20.0, -5.0), child: Text(\"Hello world\"), ), ) æ—‹è½¬ DecoratedBox( decoration:BoxDecoration(color: Colors.red), child: Transform.rotate( //æ—‹è½¬90åº¦ angle:math.pi/2 , child: Text(\"Hello world\"), ), ) æ³¨æ„ï¼šè¦ä½¿ç”¨math.piéœ€å…ˆè¿›è¡Œå¦‚ä¸‹å¯¼åŒ…ã€‚ import 'dart:math' as math; ç¼©æ”¾ Transform.scaleå¯ä»¥å¯¹å­ç»„ä»¶è¿›è¡Œç¼©å°æˆ–æ”¾å¤§ï¼Œå¦‚ï¼š DecoratedBox( decoration:BoxDecoration(color: Colors.red), child: Transform.scale( scale: 1.5, //æ”¾å¤§åˆ°1.5å€ child: Text(\"Hello world\") ) ); Transform æ³¨æ„äº‹é¡¹ Transformçš„å˜æ¢æ˜¯åº”ç”¨åœ¨ç»˜åˆ¶é˜¶æ®µï¼Œè€Œå¹¶ä¸æ˜¯åº”ç”¨åœ¨å¸ƒå±€(layout)é˜¶æ®µï¼Œæ‰€ä»¥æ— è®ºå¯¹å­ç»„ä»¶åº”ç”¨ä½•ç§å˜åŒ–ï¼Œå…¶å ç”¨ç©ºé—´çš„å¤§å°å’Œåœ¨å±å¹•ä¸Šçš„ä½ç½®éƒ½æ˜¯å›ºå®šä¸å˜çš„ï¼Œå› ä¸ºè¿™äº›æ˜¯åœ¨å¸ƒå±€é˜¶æ®µå°±ç¡®å®šçš„ã€‚ä¸‹é¢æˆ‘ä»¬å…·ä½“è¯´æ˜ï¼š Row( mainAxisAlignment: MainAxisAlignment.center, children: [ DecoratedBox( decoration:BoxDecoration(color: Colors.red), child: Transform.scale(scale: 1.5, child: Text(\"Hello world\") ) ), Text(\"ä½ å¥½\", style: TextStyle(color: Colors.green, fontSize: 18.0),) ], ) RotatedBox RotatedBoxå’ŒTransform.rotateåŠŸèƒ½ç›¸ä¼¼ï¼Œå®ƒä»¬éƒ½å¯ä»¥å¯¹å­ç»„ä»¶è¿›è¡Œæ—‹è½¬å˜æ¢ï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹ä¸åŒï¼šRotatedBoxçš„å˜æ¢æ˜¯åœ¨layouté˜¶æ®µï¼Œä¼šå½±å“åœ¨å­ç»„ä»¶çš„ä½ç½®å’Œå¤§å°ã€‚æˆ‘ä»¬å°†ä¸Šé¢ä»‹ç»Transform.rotateæ—¶çš„ç¤ºä¾‹æ”¹ä¸€ä¸‹ï¼š Row( mainAxisAlignment: MainAxisAlignment.center, children: [ DecoratedBox( decoration: BoxDecoration(color: Colors.red), //å°†Transform.rotateæ¢æˆRotatedBox child: RotatedBox( quarterTurns: 1, //æ—‹è½¬90åº¦(1/4åœˆ) child: Text(\"Hello world\"), ), ), Text(\"ä½ å¥½\", style: TextStyle(color: Colors.green, fontSize: 18.0),) ], ), "},"pages/fultter/Container.html":{"url":"pages/fultter/Container.html","title":"Container","keywords":"","body":"Container æºç  å®¹å™¨ç»„ä»¶ï¼ˆContainerï¼‰ Containeræ˜¯ä¸€ä¸ªç»„åˆç±»å®¹å™¨ï¼Œå®ƒæœ¬èº«ä¸å¯¹åº”å…·ä½“çš„RenderObjectï¼Œå®ƒæ˜¯DecoratedBoxã€ConstrainedBoxã€Transformã€Paddingã€Alignç­‰ç»„ä»¶ç»„åˆçš„ä¸€ä¸ªå¤šåŠŸèƒ½å®¹å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€é€šè¿‡ä¸€ä¸ªContainerç»„ä»¶å¯ä»¥å®ç°åŒæ—¶éœ€è¦è£…é¥°ã€å˜æ¢ã€é™åˆ¶çš„åœºæ™¯ã€‚ä¸‹é¢æ˜¯Containerçš„å®šä¹‰ï¼š Container({ this.alignment, this.padding, //å®¹å™¨å†…è¡¥ç™½ï¼Œå±äºdecorationçš„è£…é¥°èŒƒå›´ Color color, // èƒŒæ™¯è‰² Decoration decoration, // èƒŒæ™¯è£…é¥° Decoration foregroundDecoration, //å‰æ™¯è£…é¥° double width,//å®¹å™¨çš„å®½åº¦ double height, //å®¹å™¨çš„é«˜åº¦ BoxConstraints constraints, //å®¹å™¨å¤§å°çš„é™åˆ¶æ¡ä»¶ this.margin,//å®¹å™¨å¤–è¡¥ç™½ï¼Œä¸å±äºdecorationçš„è£…é¥°èŒƒå›´ this.transform, //å˜æ¢ this.child, ... }) å®¹å™¨çš„å¤§å°å¯ä»¥é€šè¿‡widthã€heightå±æ€§æ¥æŒ‡å®šï¼Œä¹Ÿå¯ä»¥é€šè¿‡constraintsæ¥æŒ‡å®šï¼›å¦‚æœå®ƒä»¬åŒæ—¶å­˜åœ¨æ—¶ï¼Œwidthã€heightä¼˜å…ˆã€‚å®é™…ä¸ŠContainerå†…éƒ¨ä¼šæ ¹æ®widthã€heightæ¥ç”Ÿæˆä¸€ä¸ªconstraintsã€‚ colorå’Œdecorationæ˜¯äº’æ–¥çš„ï¼Œå¦‚æœåŒæ—¶è®¾ç½®å®ƒä»¬åˆ™ä¼šæŠ¥é”™ï¼å®é™…ä¸Šï¼Œå½“æŒ‡å®šcoloræ—¶ï¼ŒContainerå†…ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªdecorationã€‚ ç¤ºä¾‹ Container( margin: EdgeInsets.only(top: 50.0, left: 120.0), constraints: BoxConstraints.tightFor(width: 200.0, height: 150.0),//å¡ç‰‡å¤§å° decoration: BoxDecoration( //èƒŒæ™¯è£…é¥° gradient: RadialGradient( //èƒŒæ™¯å¾„å‘æ¸å˜ colors: [Colors.red, Colors.orange], center: Alignment.topLeft, radius: .98, ), boxShadow: [ //å¡ç‰‡é˜´å½± BoxShadow( color: Colors.black54, offset: Offset(2.0, 2.0), blurRadius: 4.0, ) ], ), transform: Matrix4.rotationZ(.2),//å¡ç‰‡å€¾æ–œå˜æ¢ alignment: Alignment.center, //å¡ç‰‡å†…æ–‡å­—å±…ä¸­ child: Text( //å¡ç‰‡æ–‡å­— \"5.20\", style: TextStyle(color: Colors.white, fontSize: 40.0), ), ) Paddingå’ŒMargin ... Container( margin: EdgeInsets.all(20.0), //å®¹å™¨å¤–è¡¥ç™½ color: Colors.orange, child: Text(\"Hello world!\"), ), Container( padding: EdgeInsets.all(20.0), //å®¹å™¨å†…è¡¥ç™½ color: Colors.orange, child: Text(\"Hello world!\"), ), ... ç­‰ä»·äºï¼š ... Padding( padding: EdgeInsets.all(20.0), child: DecoratedBox( decoration: BoxDecoration(color: Colors.orange), child: Text(\"Hello world!\"), ), ), DecoratedBox( decoration: BoxDecoration(color: Colors.orange), child: Padding( padding: const EdgeInsets.all(20.0), child: Text(\"Hello world!\"), ), ), ... "},"pages/fultter/Clip.html":{"url":"pages/fultter/Clip.html","title":"Clip","keywords":"","body":"Clip æºç  å‰ªè£ï¼ˆClipï¼‰ å‰ªè£ç±»ç»„ä»¶ å‰ªè£Widget é»˜è®¤è¡Œä¸º ClipOval å­ç»„ä»¶ä¸ºæ­£æ–¹å½¢æ—¶å‰ªè£æˆå†…è´´åœ†å½¢ï¼›ä¸ºçŸ©å½¢æ—¶ï¼Œå‰ªè£æˆå†…è´´æ¤­åœ† ClipRRect å°†å­ç»„ä»¶å‰ªè£ä¸ºåœ†è§’çŸ©å½¢ ClipRect é»˜è®¤å‰ªè£æ‰å­ç»„ä»¶å¸ƒå±€ç©ºé—´ä¹‹å¤–çš„ç»˜åˆ¶å†…å®¹ï¼ˆæº¢å‡ºéƒ¨åˆ†å‰ªè£ï¼‰ ClipPath æŒ‰ç…§è‡ªå®šä¹‰çš„è·¯å¾„å‰ªè£ ç¤ºä¾‹ import 'package:flutter/material.dart'; class ClipTestRoute extends StatelessWidget { @override Widget build(BuildContext context) { // å¤´åƒ Widget avatar = Image.asset(\"imgs/avatar.png\", width: 60.0); return Center( child: Column( children: [ avatar, //ä¸å‰ªè£ ClipOval(child: avatar), //å‰ªè£ä¸ºåœ†å½¢ ClipRRect( //å‰ªè£ä¸ºåœ†è§’çŸ©å½¢ borderRadius: BorderRadius.circular(5.0), child: avatar, ), Row( mainAxisAlignment: MainAxisAlignment.center, children: [ Align( alignment: Alignment.topLeft, widthFactor: .5,//å®½åº¦è®¾ä¸ºåŸæ¥å®½åº¦ä¸€åŠï¼Œå¦ä¸€åŠä¼šæº¢å‡º child: avatar, ), Text(\"ä½ å¥½ä¸–ç•Œ\", style: TextStyle(color: Colors.green),) ], ), Row( mainAxisAlignment: MainAxisAlignment.center, children: [ ClipRect(//å°†æº¢å‡ºéƒ¨åˆ†å‰ªè£ child: Align( alignment: Alignment.topLeft, widthFactor: .5,//å®½åº¦è®¾ä¸ºåŸæ¥å®½åº¦ä¸€åŠ child: avatar, ), ), Text(\"ä½ å¥½ä¸–ç•Œ\",style: TextStyle(color: Colors.green)) ], ), ], ), ); } } è‡ªå®šä¹‰è£å‰ªï¼ˆCustomClipperï¼‰ é¦–å…ˆï¼Œè‡ªå®šä¹‰ä¸€ä¸ªCustomClipperï¼š class MyClipper extends CustomClipper { @override Rect getClip(Size size) => Rect.fromLTWH(10.0, 15.0, 40.0, 30.0); @override bool shouldReclip(CustomClipper oldClipper) => false; } getClip()æ˜¯ç”¨äºè·å–å‰ªè£åŒºåŸŸçš„æ¥å£ï¼Œç”±äºå›¾ç‰‡å¤§å°æ˜¯60Ã—60ï¼Œæˆ‘ä»¬è¿”å›å‰ªè£åŒºåŸŸä¸ºRect.fromLTWH(10.0, 15.0, 40.0, 30.0)ï¼Œå³å›¾ç‰‡ä¸­éƒ¨40Ã—30åƒç´ çš„èŒƒå›´ã€‚ shouldReclip() æ¥å£å†³å®šæ˜¯å¦é‡æ–°å‰ªè£ã€‚å¦‚æœåœ¨åº”ç”¨ä¸­ï¼Œå‰ªè£åŒºåŸŸå§‹ç»ˆä¸ä¼šå‘ç”Ÿå˜åŒ–æ—¶åº”è¯¥è¿”å›falseï¼Œè¿™æ ·å°±ä¸ä¼šè§¦å‘é‡æ–°å‰ªè£ï¼Œé¿å…ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ã€‚å¦‚æœå‰ªè£åŒºåŸŸä¼šå‘ç”Ÿå˜åŒ–ï¼ˆæ¯”å¦‚åœ¨å¯¹å‰ªè£åŒºåŸŸæ‰§è¡Œä¸€ä¸ªåŠ¨ç”»ï¼‰ï¼Œé‚£ä¹ˆå˜åŒ–ååº”è¯¥è¿”å›trueæ¥é‡æ–°æ‰§è¡Œå‰ªè£ã€‚DecoratedBox( decoration: BoxDecoration( color: Colors.red ), child: ClipRect( clipper: MyClipper(), //ä½¿ç”¨è‡ªå®šä¹‰çš„clipper child: avatar ), ) ClipPath å¯ä»¥æŒ‰ç…§è‡ªå®šä¹‰çš„è·¯å¾„å®ç°å‰ªè£ï¼Œå®ƒéœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªCustomClipper ç±»å‹çš„ Clipperï¼Œå®šä¹‰æ–¹å¼å’Œ MyClipper ç±»ä¼¼ï¼Œåªä¸è¿‡ getClip éœ€è¦è¿”å›ä¸€ä¸ª Pathã€‚ "},"pages/fultter/FittedBox.html":{"url":"pages/fultter/FittedBox.html","title":"FittedBox","keywords":"","body":"FittedBox æºç  ç©ºé—´é€‚é…ï¼ˆFittedBoxï¼‰ FittedBox const FittedBox({ Key? key, this.fit = BoxFit.contain, // é€‚é…æ–¹å¼ this.alignment = Alignment.center, //å¯¹é½æ–¹å¼ this.clipBehavior = Clip.none, //æ˜¯å¦å‰ªè£ Widget? child, }) é€‚é…åŸç† FittedBoxå…è®¸å­ç»„ä»¶æ— é™å¤§(0 FittedBox å¯¹å­ç»„ä»¶å¸ƒå±€ç»“æŸåå°±å¯ä»¥è·å¾—å­ç»„ä»¶çœŸå®çš„å¤§å°ã€‚ FittedBox çŸ¥é“å­ç»„ä»¶çš„çœŸå®å¤§å°ä¹ŸçŸ¥é“ä»–çˆ¶ç»„ä»¶çš„çº¦æŸï¼Œé‚£ä¹ˆFittedBox å°±å¯ä»¥é€šè¿‡æŒ‡å®šçš„é€‚é…æ–¹å¼ï¼ˆBoxFit æšä¸¾ä¸­æŒ‡å®šï¼‰ï¼Œè®©èµ·å­ç»„ä»¶åœ¨ FittedBox çˆ¶ç»„ä»¶çš„çº¦æŸèŒƒå›´å†…æŒ‰ç…§æŒ‡å®šçš„æ–¹å¼æ˜¾ç¤ºã€‚ ç¤ºä¾‹ Widget build(BuildContext context) { return Center( child: Column( children: [ wContainer(BoxFit.none), Text('Wendux'), wContainer(BoxFit.contain), Text('Flutterä¸­å›½'), ], ), ); } Widget wContainer(BoxFit boxFit) { return Container( width: 50, height: 50, color: Colors.red, child: FittedBox( fit: boxFit, // å­å®¹å™¨è¶…è¿‡çˆ¶å®¹å™¨å¤§å° child: Container(width: 60, height: 70, color: Colors.blue), ), ); } å•è¡Œç¼©æ”¾å¸ƒå±€ @override Widget build(BuildContext context) { return Center( child: Column( children: [ wRow(' 90000000000000000 '), FittedBox(child: wRow(' 90000000000000000 ')), wRow(' 800 '), FittedBox(child: wRow(' 800 ')), ] .map((e) => Padding( padding: EdgeInsets.symmetric(vertical: 20), child: e, )) .toList();, ), ); } // ç›´æ¥ä½¿ç”¨Row Widget wRow(String text) { Widget child = Text(text); child = Row( mainAxisAlignment: MainAxisAlignment.spaceEvenly, children: [child, child, child], ); return child; } "},"pages/fultter/Scaffold.html":{"url":"pages/fultter/Scaffold.html","title":"Scaffold","keywords":"","body":"Scaffold æºç  é¡µé¢éª¨æ¶ï¼ˆScaffoldï¼‰ Scaffold æ˜¯ä¸€ä¸ªè·¯ç”±é¡µçš„éª¨æ¶ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒå¯ä»¥å¾ˆå®¹æ˜“åœ°æ‹¼è£…å‡ºä¸€ä¸ªå®Œæ•´çš„é¡µé¢ã€‚ ç¤ºä¾‹ æˆ‘ä»¬å®ç°ä¸€ä¸ªé¡µé¢ï¼Œå®ƒåŒ…å«ï¼š ä¸€ä¸ªå¯¼èˆªæ  å¯¼èˆªæ å³è¾¹æœ‰ä¸€ä¸ªåˆ†äº«æŒ‰é’® æœ‰ä¸€ä¸ªæŠ½å±‰èœå• æœ‰ä¸€ä¸ªåº•éƒ¨å¯¼èˆª å³ä¸‹è§’æœ‰ä¸€ä¸ªæ‚¬æµ®çš„åŠ¨ä½œæŒ‰é’® class ScaffoldRoute extends StatefulWidget { @override _ScaffoldRouteState createState() => _ScaffoldRouteState(); } class _ScaffoldRouteState extends State { int _selectedIndex = 1; @override Widget build(BuildContext context) { return Scaffold( appBar: AppBar( //å¯¼èˆªæ  title: Text(\"App Name\"), actions: [ //å¯¼èˆªæ å³ä¾§èœå• IconButton(icon: Icon(Icons.share), onPressed: () {}), ], ), drawer: MyDrawer(), //æŠ½å±‰ bottomNavigationBar: BottomNavigationBar( // åº•éƒ¨å¯¼èˆª items: [ BottomNavigationBarItem(icon: Icon(Icons.home), title: Text('Home')), BottomNavigationBarItem(icon: Icon(Icons.business), title: Text('Business')), BottomNavigationBarItem(icon: Icon(Icons.school), title: Text('School')), ], currentIndex: _selectedIndex, fixedColor: Colors.blue, onTap: _onItemTapped, ), floatingActionButton: FloatingActionButton( //æ‚¬æµ®æŒ‰é’® child: Icon(Icons.add), onPressed:_onAdd ), ); } void _onItemTapped(int index) { setState(() { _selectedIndex = index; }); } void _onAdd(){ } } ç»„ä»¶åç§° è§£é‡Š AppBar ä¸€ä¸ªå¯¼èˆªæ éª¨æ¶ MyDrawer æŠ½å±‰èœå• BottomNavigationBar åº•éƒ¨å¯¼èˆªæ  FloatingActionButton æ¼‚æµ®æŒ‰é’® AppBar AppBaræ˜¯ä¸€ä¸ªMaterialé£æ ¼çš„å¯¼èˆªæ ï¼Œé€šè¿‡å®ƒå¯ä»¥è®¾ç½®å¯¼èˆªæ æ ‡é¢˜ã€å¯¼èˆªæ èœå•ã€å¯¼èˆªæ åº•éƒ¨çš„Tabæ ‡é¢˜ç­‰ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹AppBarçš„å®šä¹‰ï¼š AppBar({ Key? key, this.leading, //å¯¼èˆªæ æœ€å·¦ä¾§Widgetï¼Œå¸¸è§ä¸ºæŠ½å±‰èœå•æŒ‰é’®æˆ–è¿”å›æŒ‰é’®ã€‚ this.automaticallyImplyLeading = true, //å¦‚æœleadingä¸ºnullï¼Œæ˜¯å¦è‡ªåŠ¨å®ç°é»˜è®¤çš„leadingæŒ‰é’® this.title,// é¡µé¢æ ‡é¢˜ this.actions, // å¯¼èˆªæ å³ä¾§èœå• this.bottom, // å¯¼èˆªæ åº•éƒ¨èœå•ï¼Œé€šå¸¸ä¸ºTabæŒ‰é’®ç»„ this.elevation = 4.0, // å¯¼èˆªæ é˜´å½± this.centerTitle, //æ ‡é¢˜æ˜¯å¦å±…ä¸­ this.backgroundColor, ... //å…¶ä»–å±æ€§è§æºç æ³¨é‡Š }) æŠ½å±‰èœå•Drawer class MyDrawer extends StatelessWidget { const MyDrawer({ Key? key, }) : super(key: key); @override Widget build(BuildContext context) { return Drawer( child: MediaQuery.removePadding( context: context, //ç§»é™¤æŠ½å±‰èœå•é¡¶éƒ¨é»˜è®¤ç•™ç™½ removeTop: true, child: Column( crossAxisAlignment: CrossAxisAlignment.start, children: [ Padding( padding: const EdgeInsets.only(top: 38.0), child: Row( children: [ Padding( padding: const EdgeInsets.symmetric(horizontal: 16.0), child: ClipOval( child: Image.asset( \"imgs/avatar.png\", width: 80, ), ), ), Text( \"Wendux\", style: TextStyle(fontWeight: FontWeight.bold), ) ], ), ), Expanded( child: ListView( children: [ ListTile( leading: const Icon(Icons.add), title: const Text('Add account'), ), ListTile( leading: const Icon(Icons.settings), title: const Text('Manage accounts'), ), ], ), ), ], ), ), ); } } "},"pages/fultter/å¯æ»šåŠ¨ç»„ä»¶ç®€ä»‹.html":{"url":"pages/fultter/å¯æ»šåŠ¨ç»„ä»¶ç®€ä»‹.html","title":"å¯æ»šåŠ¨ç»„ä»¶ç®€ä»‹","keywords":"","body":"å¯æ»šåŠ¨ç»„ä»¶ç®€ä»‹ å¯æ»šåŠ¨ç»„ä»¶ç®€ä»‹CustomScrollViewå’ŒNestedScrollViewçš„è¯¦ç»†ä»‹ç»åœ¨Flutterä¸­åˆ›å»ºæœ‰æ„æ€çš„æ»šåŠ¨æ•ˆæœ - Sliverç³»åˆ— Sliverå¸ƒå±€æ¨¡å‹ 1. å¸ƒå±€æ¨¡å‹ åŸºäº RenderBox çš„ç›’æ¨¡å‹å¸ƒå±€ã€‚ åŸºäº Sliver ( RenderSliver ) æŒ‰éœ€åŠ è½½åˆ—è¡¨å¸ƒå±€ã€‚ 2. ä¸»è¦ä½œç”¨ Sliver å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå­ç»„ä»¶ã€‚åŠ è½½å­ç»„ä»¶å¹¶ç¡®å®šæ¯ä¸€ä¸ªå­ç»„ä»¶çš„å¸ƒå±€å’Œç»˜åˆ¶ä¿¡æ¯ï¼Œå®ç°æŒ‰éœ€åŠ è½½æ¨¡å‹ã€‚ 3. ä¸‰ä¸ªè§’è‰² Scrollable ï¼šç”¨äºå¤„ç†æ»‘åŠ¨æ‰‹åŠ¿ï¼Œç¡®å®šæ»‘åŠ¨åç§»ï¼Œæ»‘åŠ¨åç§»å˜åŒ–æ—¶æ„å»º Viewport ã€‚ Viewportï¼šæ˜¾ç¤ºçš„è§†çª—ï¼Œå³åˆ—è¡¨çš„å¯è§†åŒºåŸŸï¼› Sliverï¼šè§†çª—é‡Œæ˜¾ç¤ºçš„å…ƒç´ ã€‚ 4. è§’è‰²å…³ç³» ä¸‰è€…æ‰€å ç”¨çš„ç©ºé—´é‡åˆã€‚ Sliver çˆ¶ç»„ä»¶ä¸º Viewportï¼ŒViewportçš„ çˆ¶ç»„ä»¶ä¸º Scrollableã€‚ 5. å¸ƒå±€è¿‡ç¨‹ Scrollable ç›‘å¬åˆ°ç”¨æˆ·æ»‘åŠ¨è¡Œä¸ºåï¼Œæ ¹æ®æœ€æ–°çš„æ»‘åŠ¨åç§»æ„å»º Viewport ã€‚ Viewport å°†å½“å‰è§†å£ä¿¡æ¯å’Œé…ç½®ä¿¡æ¯é€šè¿‡ SliverConstraints ä¼ é€’ç»™ Sliverã€‚ Sliver ä¸­å¯¹å­ç»„ä»¶ï¼ˆRenderBoxï¼‰æŒ‰éœ€è¿›è¡Œæ„å»ºå’Œå¸ƒå±€ï¼Œç„¶åç¡®è®¤è‡ªèº«çš„ä½ç½®ã€ç»˜åˆ¶ç­‰ä¿¡æ¯ï¼Œä¿å­˜åœ¨ geometry ä¸­ï¼ˆä¸€ä¸ª SliverGeometry ç±»å‹çš„å¯¹è±¡ï¼‰ã€‚ 6. cacheExtent é¢„æ¸²æŸ“çš„é«˜åº¦ï¼Œåœ¨å¯è§†åŒºåŸŸä¹‹å¤–ï¼Œå¦‚æœ RenderBox è¿›å…¥è¿™ä¸ªåŒºåŸŸå†…ï¼Œå³ä½¿å®ƒè¿˜æœªæ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œä¹Ÿæ˜¯è¦å…ˆè¿›è¡Œæ„å»ºï¼Œé»˜è®¤å€¼æ˜¯ 250ã€‚ Scrollable ç”¨äºå¤„ç†æ»‘åŠ¨æ‰‹åŠ¿ï¼Œç¡®å®šæ»‘åŠ¨åç§»ï¼Œæ»‘åŠ¨åç§»å˜åŒ–æ—¶æ„å»º Viewportï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å…¶å…³é”®çš„å±æ€§ï¼š Scrollable({ ... this.axisDirection = AxisDirection.down,//æ»šåŠ¨æ–¹å‘ã€‚ this.controller, this.physics, required this.viewportBuilder, //åé¢ä»‹ç» }) 1. physics ScrollPhysicsç±»å‹çš„å¯¹è±¡ï¼Œå“åº”ç”¨æˆ·æ“ä½œï¼š ç”¨æˆ·æ»‘åŠ¨å®ŒæŠ¬èµ·æ‰‹æŒ‡åï¼Œç»§ç»­æ‰§è¡ŒåŠ¨ç”»ã€‚ æ»‘åŠ¨åˆ°è¾¹ç•Œæ—¶ï¼Œå¦‚ä½•æ˜¾ç¤ºã€‚ ScrollPhysicsçš„å­ç±»ï¼š ClampingScrollPhysicsï¼šåˆ—è¡¨æ»‘åŠ¨åˆ°è¾¹ç•Œæ—¶å°†ä¸èƒ½ç»§ç»­æ»‘åŠ¨ï¼Œé€šå¸¸åœ¨Android ä¸­ é…åˆ GlowingOverscrollIndicatorï¼ˆå®ç°å¾®å…‰æ•ˆæœçš„ç»„ä»¶ï¼‰ ä½¿ç”¨ã€‚ BouncingScrollPhysicsï¼šiOS ä¸‹å¼¹æ€§æ•ˆæœã€‚ 2. controller ScrollControllerå¯¹è±¡ï¼Œé»˜è®¤çš„PrimaryScrollControllerï¼Œæ§åˆ¶æ»šåŠ¨ä½ç½®å’Œç›‘å¬æ»šåŠ¨äº‹ä»¶ã€‚ 3. viewportBuilder æ„å»º Viewport çš„å›è°ƒã€‚å½“ç”¨æˆ·æ»‘åŠ¨æ—¶ï¼ŒScrollable ä¼šè°ƒç”¨æ­¤å›è°ƒæ„å»ºæ–°çš„ Viewportï¼ŒåŒæ—¶ä¼ é€’ä¸€ä¸ª ViewportOffset ç±»å‹çš„ offset å‚æ•°ï¼Œè¯¥å‚æ•°æè¿° Viewport åº”è¯¥æ˜¾ç¤ºé‚£ä¸€éƒ¨åˆ†å†…å®¹ã€‚ Viewport æ˜¾ç¤º Sliverã€‚ Viewport({ Key? key, this.axisDirection = AxisDirection.down, this.crossAxisDirection, this.anchor = 0.0, required ViewportOffset offset, // ç”¨æˆ·çš„æ»šåŠ¨åç§» // ç±»å‹ä¸ºKeyï¼Œè¡¨ç¤ºä»ä»€ä¹ˆåœ°æ–¹å¼€å§‹ç»˜åˆ¶ï¼Œé»˜è®¤æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´  this.center, this.cacheExtent, // é¢„æ¸²æŸ“åŒºåŸŸ //è¯¥å‚æ•°ç”¨äºé…åˆè§£é‡ŠcacheExtentçš„å«ä¹‰ï¼Œä¹Ÿå¯ä»¥ä¸ºä¸»è½´é•¿åº¦çš„ä¹˜æ•° this.cacheExtentStyle = CacheExtentStyle.pixel, this.clipBehavior = Clip.hardEdge, List slivers = const [], // éœ€è¦æ˜¾ç¤ºçš„ Sliver åˆ—è¡¨ }) 1. offset è¯¥å‚æ•°ä¸ºScrollable æ„å»º Viewport æ—¶ä¼ å…¥ï¼Œå®ƒæè¿°äº† Viewport åº”è¯¥æ˜¾ç¤ºé‚£ä¸€éƒ¨åˆ†å†…å®¹ã€‚ 2. cacheExtent å’Œ cacheExtentStyle CacheExtentStyle æ˜¯ä¸€ä¸ªæšä¸¾ï¼Œæœ‰ pixel å’Œ viewport ä¸¤ä¸ªå–å€¼ã€‚ å½“ cacheExtentStyle å€¼ä¸º pixel æ—¶ï¼ŒcacheExtent çš„å€¼ä¸ºé¢„æ¸²æŸ“åŒºåŸŸçš„å…·ä½“åƒç´ é•¿åº¦ï¼› å½“å€¼ä¸º viewport æ—¶ï¼ŒcacheExtent çš„å€¼æ˜¯ä¸€ä¸ªä¹˜æ•°ï¼Œè¡¨ç¤ºæœ‰å‡ ä¸ª viewport çš„é•¿åº¦ï¼Œæœ€ç»ˆçš„é¢„æ¸²æŸ“åŒºåŸŸçš„åƒç´ é•¿åº¦ä¸ºï¼šcacheExtent * viewport çš„ç§¯ã€‚ Sliver 1. ä¸»è¦ä½œç”¨ å¯¹å­ç»„ä»¶è¿›è¡Œæ„å»ºå’Œå¸ƒå±€ï¼Œæ¯”å¦‚ ListView çš„ Sliver éœ€è¦å®ç°å­ç»„ä»¶ï¼ˆåˆ—è¡¨é¡¹ï¼‰æŒ‰éœ€åŠ è½½åŠŸèƒ½ï¼Œåªæœ‰å½“åˆ—è¡¨é¡¹è¿›å…¥é¢„æ¸²æŸ“åŒºåŸŸæ—¶æ‰ä¼šå»å¯¹å®ƒè¿›è¡Œæ„å»ºå’Œå¸ƒå±€ã€æ¸²æŸ“ã€‚ 2. RenderSliver Sliver å¯¹åº”çš„æ¸²æŸ“å¯¹è±¡ç±»å‹æ˜¯ RenderSliverã€‚ RenderSliver å’Œ RenderBox éƒ½ç»§æ‰¿è‡ª RenderObject ç±»ã€‚ RenderSliver å’Œ RenderBox çº¦æŸä¿¡æ¯åˆ†åˆ«æ˜¯ BoxConstraints å’Œ SliverConstraintsã€‚ é€šç”¨é…ç½® scrollDirectionï¼ˆæ»‘åŠ¨çš„ä¸»è½´ï¼‰ã€reverseï¼ˆæ»‘åŠ¨æ–¹å‘æ˜¯å¦åå‘ï¼‰ã€controllerã€physics ã€cacheExtent ï¼Œè¿™äº›å±æ€§æœ€ç»ˆä¼šé€ä¼ ç»™å¯¹åº”çš„ Scrollable å’Œ Viewportï¼Œè¿™äº›å±æ€§æˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ˜¯å¯æ»šåŠ¨ç»„ä»¶çš„é€šç”¨å±æ€§ã€‚ reverseè¡¨ç¤ºæ˜¯å¦æŒ‰ç…§é˜…è¯»æ–¹å‘ç›¸åçš„æ–¹å‘æ»‘åŠ¨ï¼Œå¦‚ï¼šscrollDirectionå€¼ä¸ºAxis.horizontal æ—¶ï¼Œå³æ»‘åŠ¨å‘ç°ä¸ºæ°´å¹³ï¼Œå¦‚æœé˜…è¯»æ–¹å‘æ˜¯ä»å·¦åˆ°å³ï¼ˆå–å†³äºè¯­è¨€ç¯å¢ƒï¼Œé˜¿æ‹‰ä¼¯è¯­å°±æ˜¯ä»å³åˆ°å·¦ï¼‰ã€‚reverseä¸ºtrueæ—¶ï¼Œé‚£ä¹ˆæ»‘åŠ¨æ–¹å‘å°±æ˜¯ä»å³å¾€å·¦ã€‚ "},"pages/fultter/SingleChildScrollView.html":{"url":"pages/fultter/SingleChildScrollView.html","title":"SingleChildScrollView","keywords":"","body":"SingleChildScrollView æºç  SingleChildScrollView ç®€ä»‹ SingleChildScrollViewç±»ä¼¼äºAndroidä¸­çš„ScrollViewï¼Œå®ƒåªèƒ½æ¥æ”¶ä¸€ä¸ªå­ç»„ä»¶ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š SingleChildScrollView({ this.scrollDirection = Axis.vertical, //æ»šåŠ¨æ–¹å‘ï¼Œé»˜è®¤æ˜¯å‚ç›´æ–¹å‘ this.reverse = false, this.padding, bool primary, this.physics, this.controller, this.child, }) ç¤ºä¾‹ ä¸‹é¢æ˜¯ä¸€ä¸ªå°†å¤§å†™å­—æ¯ A-Z æ²¿å‚ç›´æ–¹å‘æ˜¾ç¤ºçš„ä¾‹å­ï¼Œç”±äºå‚ç›´æ–¹å‘ç©ºé—´ä¼šè¶…è¿‡å±å¹•è§†å£é«˜åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨SingleChildScrollViewï¼š class SingleChildScrollViewTestRoute extends StatelessWidget { @override Widget build(BuildContext context) { String str = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"; return Scrollbar( // æ˜¾ç¤ºè¿›åº¦æ¡ child: SingleChildScrollView( padding: EdgeInsets.all(16.0), child: Center( child: Column( //åŠ¨æ€åˆ›å»ºä¸€ä¸ªList children: str.split(\"\") //æ¯ä¸€ä¸ªå­—æ¯éƒ½ç”¨ä¸€ä¸ªTextæ˜¾ç¤º,å­—ä½“ä¸ºåŸæ¥çš„ä¸¤å€ .map((c) => Text(c, textScaleFactor: 2.0,)) .toList(), ), ), ), ); } } "},"pages/fultter/ListView.html":{"url":"pages/fultter/ListView.html","title":"ListView","keywords":"","body":"ListView æºç  ListView ListViewæ˜¯æœ€å¸¸ç”¨çš„å¯æ»šåŠ¨ç»„ä»¶ä¹‹ä¸€ï¼Œå®ƒå¯ä»¥æ²¿ä¸€ä¸ªæ–¹å‘çº¿æ€§æ’å¸ƒæ‰€æœ‰å­ç»„ä»¶ï¼Œå¹¶ä¸”å®ƒä¹Ÿæ”¯æŒåˆ—è¡¨é¡¹æ‡’åŠ è½½ï¼ˆåœ¨éœ€è¦æ—¶æ‰ä¼šåˆ›å»ºï¼‰ã€‚ é»˜è®¤æ„é€ å‡½æ•° ListView({ ... //å¯æ»šåŠ¨widgetå…¬å…±å‚æ•° Axis scrollDirection = Axis.vertical, bool reverse = false, ScrollController? controller, bool? primary, ScrollPhysics? physics, EdgeInsetsGeometry? padding, //ListViewå„ä¸ªæ„é€ å‡½æ•°çš„å…±åŒå‚æ•° double? itemExtent, Widget? prototypeItem, //åˆ—è¡¨é¡¹åŸå‹ï¼Œåé¢è§£é‡Š bool shrinkWrap = false, bool addAutomaticKeepAlives = true, bool addRepaintBoundaries = true, double? cacheExtent, // é¢„æ¸²æŸ“åŒºåŸŸé•¿åº¦ //å­widgetåˆ—è¡¨ List children = const [], }) itemExtentï¼šåˆ—è¡¨é¡¹é«˜åº¦ã€‚ prototypeItemï¼šæŒ‡å®šä¸€ä¸ªåˆ—è¡¨é¡¹ï¼Œç”¨äºè®¡ç®—åˆ—è¡¨é¡¹é«˜åº¦ã€‚ shrinkWrapï¼šåˆ—è¡¨é«˜åº¦æ˜¯å¦æ˜¯å­ç»„ä»¶æ€»é•¿åº¦ã€‚ ç¤ºä¾‹ï¼š ListView( shrinkWrap: true, padding: const EdgeInsets.all(20.0), children: [ const Text('I\\'m dedicating every day to you'), const Text('Domestic life was never quite my style'), const Text('When you smile, you knock me out, I fall apart'), const Text('And I thought I was so smart'), ], ); ListView.builder ListView.builderé€‚åˆåˆ—è¡¨é¡¹æ¯”è¾ƒå¤šæˆ–è€…åˆ—è¡¨é¡¹ä¸ç¡®å®šçš„æƒ…å†µï¼Œä¸‹é¢çœ‹ä¸€ä¸‹ListView.builderçš„æ ¸å¿ƒå‚æ•°åˆ—è¡¨ï¼š ListView.builder({ // ListViewå…¬å…±å‚æ•°å·²çœç•¥ ... required IndexedWidgetBuilder itemBuilder, int itemCount, ... }) itemBuilderï¼šæ ¹æ®indexå‚æ•°åŠ¨æ€æ„å»ºåˆ—è¡¨é¡¹ã€‚ itemCountï¼šåˆ—è¡¨é¡¹çš„æ•°é‡ï¼Œå¦‚æœä¸ºnullï¼Œåˆ™ä¸ºæ— é™åˆ—è¡¨ã€‚ ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­ï¼š ListView.builder( itemCount: 100, itemExtent: 50.0, //å¼ºåˆ¶é«˜åº¦ä¸º50.0 itemBuilder: (BuildContext context, int index) { return ListTile(title: Text(\"$index\")); } ); ListView.separated ListView.separatedå¯ä»¥åœ¨ç”Ÿæˆçš„åˆ—è¡¨é¡¹ä¹‹é—´æ·»åŠ ä¸€ä¸ªåˆ†å‰²ç»„ä»¶ï¼Œå®ƒæ¯”ListView.builderå¤šäº†ä¸€ä¸ªseparatorBuilderå‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯ä¸€ä¸ªåˆ†å‰²ç»„ä»¶ç”Ÿæˆå™¨ã€‚ ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼šå¥‡æ•°è¡Œæ·»åŠ ä¸€æ¡è“è‰²ä¸‹åˆ’çº¿ï¼Œå¶æ•°è¡Œæ·»åŠ ä¸€æ¡ç»¿è‰²ä¸‹åˆ’çº¿ã€‚ class ListView3 extends StatelessWidget { @override Widget build(BuildContext context) { //ä¸‹åˆ’çº¿widgeté¢„å®šä¹‰ä»¥ä¾›å¤ç”¨ã€‚ Widget divider1=Divider(color: Colors.blue,); Widget divider2=Divider(color: Colors.green); return ListView.separated( itemCount: 100, //åˆ—è¡¨é¡¹æ„é€ å™¨ itemBuilder: (BuildContext context, int index) { return ListTile(title: Text(\"$index\")); }, //åˆ†å‰²å™¨æ„é€ å™¨ separatorBuilder: (BuildContext context, int index) { return index%2==0?divider1:divider2; }, ); } } "},"pages/fultter/æ»šåŠ¨ç›‘å¬åŠæ§åˆ¶.html":{"url":"pages/fultter/æ»šåŠ¨ç›‘å¬åŠæ§åˆ¶.html","title":"æ»šåŠ¨ç›‘å¬åŠæ§åˆ¶","keywords":"","body":"æ»šåŠ¨ç›‘å¬åŠæ§åˆ¶ æºç  æ»šåŠ¨ç›‘å¬åŠæ§åˆ¶ ScrollController ScrollControlleræ„é€ å‡½æ•°å¦‚ä¸‹ï¼š ScrollController({ double initialScrollOffset = 0.0, //åˆå§‹æ»šåŠ¨ä½ç½® this.keepScrollOffset = true,//æ˜¯å¦ä¿å­˜æ»šåŠ¨ä½ç½® ... }) offsetï¼šå¯æ»šåŠ¨ç»„ä»¶å½“å‰çš„æ»šåŠ¨ä½ç½®ã€‚ jumpTo(double offset)ã€animateTo(double offset,...)ï¼šè¿™ä¸¤ä¸ªæ–¹æ³•ç”¨äºè·³è½¬åˆ°æŒ‡å®šçš„ä½ç½®ï¼Œå®ƒä»¬ä¸åŒä¹‹å¤„åœ¨äºï¼Œåè€…åœ¨è·³è½¬æ—¶ä¼šæ‰§è¡Œä¸€ä¸ªåŠ¨ç”»ï¼Œè€Œå‰è€…ä¸ä¼šã€‚ 1. æ»šåŠ¨ç›‘å¬ ScrollControlleré—´æ¥ç»§æ‰¿è‡ªListenableï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ScrollControlleræ¥ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œå¦‚ï¼š controller.addListener(()=>print(controller.offset)) 2. å®ä¾‹ æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªListViewï¼Œå½“æ»šåŠ¨ä½ç½®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæˆ‘ä»¬å…ˆæ‰“å°å‡ºå½“å‰æ»šåŠ¨ä½ç½®ï¼Œç„¶ååˆ¤æ–­å½“å‰ä½ç½®æ˜¯å¦è¶…è¿‡1000åƒç´ ï¼Œå¦‚æœè¶…è¿‡åˆ™åœ¨å±å¹•å³ä¸‹è§’æ˜¾ç¤ºä¸€ä¸ªâ€œè¿”å›é¡¶éƒ¨â€çš„æŒ‰é’®ï¼Œè¯¥æŒ‰é’®ç‚¹å‡»åå¯ä»¥ä½¿ListViewæ¢å¤åˆ°åˆå§‹ä½ç½®ï¼›å¦‚æœæ²¡æœ‰è¶…è¿‡1000åƒç´ ï¼Œåˆ™éšè—â€œè¿”å›é¡¶éƒ¨â€æŒ‰é’®ã€‚ä»£ç å¦‚ä¸‹ï¼š class ScrollControllerTestRoute extends StatefulWidget { @override ScrollControllerTestRouteState createState() { return ScrollControllerTestRouteState(); } } class ScrollControllerTestRouteState extends State { ScrollController _controller = ScrollController(); bool showToTopBtn = false; //æ˜¯å¦æ˜¾ç¤ºâ€œè¿”å›åˆ°é¡¶éƒ¨â€æŒ‰é’® @override void initState() { super.initState(); //ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œæ‰“å°æ»šåŠ¨ä½ç½® _controller.addListener(() { print(_controller.offset); //æ‰“å°æ»šåŠ¨ä½ç½® if (_controller.offset = 1000 && showToTopBtn == false) { setState(() { showToTopBtn = true; }); } }); } @override void dispose() { //ä¸ºäº†é¿å…å†…å­˜æ³„éœ²ï¼Œéœ€è¦è°ƒç”¨_controller.dispose _controller.dispose(); super.dispose(); } @override Widget build(BuildContext context) { return Scaffold( appBar: AppBar(title: Text(\"æ»šåŠ¨æ§åˆ¶\")), body: Scrollbar( child: ListView.builder( itemCount: 100, itemExtent: 50.0, //åˆ—è¡¨é¡¹é«˜åº¦å›ºå®šæ—¶ï¼Œæ˜¾å¼æŒ‡å®šé«˜åº¦æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯(æ€§èƒ½æ¶ˆè€—å°) controller: _controller, itemBuilder: (context, index) { return ListTile(title: Text(\"$index\"),); } ), ), floatingActionButton: !showToTopBtn ? null : FloatingActionButton( child: Icon(Icons.arrow_upward), onPressed: () { //è¿”å›åˆ°é¡¶éƒ¨æ—¶æ‰§è¡ŒåŠ¨ç”» _controller.animateTo( .0, duration: Duration(milliseconds: 200), curve: Curves.ease, ); } ), ); } } 3. æ»šåŠ¨ä½ç½®æ¢å¤ PageStorageæ˜¯ä¸€ä¸ªç”¨äºä¿å­˜é¡µé¢(è·¯ç”±)ç›¸å…³æ•°æ®çš„ç»„ä»¶ï¼Œå®ƒå¹¶ä¸ä¼šå½±å“å­æ ‘çš„UIå¤–è§‚ï¼Œå…¶å®ï¼ŒPageStorageæ˜¯ä¸€ä¸ªåŠŸèƒ½å‹ç»„ä»¶ï¼Œå®ƒæ‹¥æœ‰ä¸€ä¸ªå­˜å‚¨æ¡¶ï¼ˆbucketï¼‰ï¼Œå­æ ‘ä¸­çš„Widgetå¯ä»¥é€šè¿‡æŒ‡å®šä¸åŒçš„PageStorageKeyæ¥å­˜å‚¨å„è‡ªçš„æ•°æ®æˆ–çŠ¶æ€ã€‚ ä½¿ç”¨PageStorageåœ¨é¡µé¢åˆ‡æ¢æ—¶ä¿å­˜çŠ¶æ€ 4. ScrollPosition ScrollPositionæ˜¯ç”¨æ¥ä¿å­˜å¯æ»šåŠ¨ç»„ä»¶çš„æ»šåŠ¨ä½ç½®çš„ã€‚ä¸€ä¸ªScrollControllerå¯¹è±¡å¯ä»¥åŒæ—¶è¢«å¤šä¸ªå¯æ»šåŠ¨ç»„ä»¶ä½¿ç”¨ï¼ŒScrollControllerä¼šä¸ºæ¯ä¸€ä¸ªå¯æ»šåŠ¨ç»„ä»¶åˆ›å»ºä¸€ä¸ªScrollPositionå¯¹è±¡ï¼Œè¿™äº›ScrollPositionä¿å­˜åœ¨ScrollControllerçš„positionså±æ€§ä¸­ï¼ˆListï¼‰ã€‚ScrollPositionæ˜¯çœŸæ­£ä¿å­˜æ»‘åŠ¨ä½ç½®ä¿¡æ¯çš„å¯¹è±¡ï¼Œoffsetåªæ˜¯ä¸€ä¸ªä¾¿æ·å±æ€§ï¼š double get offset => position.pixels; 5. ScrollControlleræ§åˆ¶åŸç† æ»šåŠ¨ç›‘å¬ 1. æ»šåŠ¨é€šçŸ¥ Flutter Widgetæ ‘ä¸­å­Widgetå¯ä»¥é€šè¿‡å‘é€é€šçŸ¥ï¼ˆNotificationï¼‰ä¸çˆ¶(åŒ…æ‹¬ç¥–å…ˆ)Widgeté€šä¿¡ã€‚ 2. å®ä¾‹ import 'package:flutter/material.dart'; class ScrollNotificationTestRoute extends StatefulWidget { @override _ScrollNotificationTestRouteState createState() => _ScrollNotificationTestRouteState(); } class _ScrollNotificationTestRouteState extends State { String _progress = \"0%\"; //ä¿å­˜è¿›åº¦ç™¾åˆ†æ¯” @override Widget build(BuildContext context) { return Scrollbar( //è¿›åº¦æ¡ // ç›‘å¬æ»šåŠ¨é€šçŸ¥ child: NotificationListener( onNotification: (ScrollNotification notification) { double progress = notification.metrics.pixels / notification.metrics.maxScrollExtent; //é‡æ–°æ„å»º setState(() { _progress = \"${(progress * 100).toInt()}%\"; }); print(\"BottomEdge: ${notification.metrics.extentAfter == 0}\"); return false; //return true; //æ”¾å¼€æ­¤è¡Œæ³¨é‡Šåï¼Œè¿›åº¦æ¡å°†å¤±æ•ˆ }, child: Stack( alignment: Alignment.center, children: [ ListView.builder( itemCount: 100, itemExtent: 50.0, itemBuilder: (context, index) => ListTile(title: Text(\"$index\")), ), CircleAvatar( //æ˜¾ç¤ºè¿›åº¦ç™¾åˆ†æ¯” radius: 30.0, child: Text(_progress), backgroundColor: Colors.black54, ) ], ), ), ); } } "},"pages/fultter/AnimatedList.html":{"url":"pages/fultter/AnimatedList.html","title":"AnimatedList","keywords":"","body":"AnimatedList æºç  AnimatedList AnimatedList å’Œ ListView çš„åŠŸèƒ½å¤§ä½“ç›¸ä¼¼ï¼Œä¸åŒçš„æ˜¯ï¼Œ AnimatedList å¯ä»¥åœ¨åˆ—è¡¨ä¸­æ’å…¥æˆ–åˆ é™¤èŠ‚ç‚¹æ—¶æ‰§è¡Œä¸€ä¸ªåŠ¨ç”»ï¼Œåœ¨éœ€è¦æ·»åŠ æˆ–åˆ é™¤åˆ—è¡¨é¡¹çš„åœºæ™¯ä¸­ä¼šæé«˜ç”¨æˆ·ä½“éªŒã€‚ AnimatedList æ˜¯ä¸€ä¸ª StatefulWidgetï¼Œå®ƒå¯¹åº”çš„ State ç±»å‹ä¸º AnimatedListStateï¼Œæ·»åŠ å’Œåˆ é™¤å…ƒç´ çš„æ–¹æ³•ä½äº AnimatedListState ä¸­ï¼š void insertItem(int index, { Duration duration = _kDuration }); void removeItem(int index, AnimatedListRemovedItemBuilder builder, { Duration duration = _kDuration }) ; ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼šå®ç°ä¸‹é¢è¿™æ ·çš„ä¸€ä¸ªåˆ—è¡¨ï¼Œç‚¹å‡»åº•éƒ¨ + æŒ‰é’®æ—¶å‘åˆ—è¡¨è¿½åŠ ä¸€ä¸ªåˆ—è¡¨é¡¹ï¼›ç‚¹å‡»æ¯ä¸ªåˆ—è¡¨é¡¹åé¢çš„åˆ é™¤æŒ‰é’®æ—¶ï¼Œåˆ é™¤è¯¥åˆ—è¡¨é¡¹ï¼Œæ·»åŠ å’Œåˆ é™¤æ—¶åˆ†åˆ«æ‰§è¡ŒæŒ‡å®šçš„åŠ¨ç”»ï¼š åˆå§‹çš„æ—¶å€™æœ‰5ä¸ªåˆ—è¡¨é¡¹ï¼Œå…ˆç‚¹å‡»äº† + å·æŒ‰é’®ï¼Œä¼šæ·»åŠ ä¸€ä¸ª 6ï¼Œæ·»åŠ è¿‡ç¨‹æ‰§è¡Œæ¸æ˜¾åŠ¨ç”»ã€‚ç„¶åç‚¹å‡»äº† 4 åé¢çš„åˆ é™¤æŒ‰é’®ï¼Œåˆ é™¤çš„æ—¶å€™æ‰§è¡Œäº†ä¸€ä¸ªæ¸éš+æ”¶ç¼©çš„åˆæˆåŠ¨ç”»ã€‚ ä¸‹é¢æ˜¯å®ç°ä»£ç ï¼š class AnimatedListRoute extends StatefulWidget { const AnimatedListRoute({Key? key}) : super(key: key); @override _AnimatedListRouteState createState() => _AnimatedListRouteState(); } class _AnimatedListRouteState extends State { var data = []; int counter = 5; final globalKey = GlobalKey(); @override void initState() { for (var i = 0; i animation, ) { //æ·»åŠ åˆ—è¡¨é¡¹æ—¶ä¼šæ‰§è¡Œæ¸æ˜¾åŠ¨ç”» return FadeTransition( opacity: animation, child: buildItem(context, index), ); }, ), buildAddBtn(), ], ); } // åˆ›å»ºä¸€ä¸ª â€œ+â€ æŒ‰é’®ï¼Œç‚¹å‡»åä¼šå‘åˆ—è¡¨ä¸­æ’å…¥ä¸€é¡¹ Widget buildAddBtn() { return Positioned( child: FloatingActionButton( child: Icon(Icons.add), onPressed: () { // æ·»åŠ ä¸€ä¸ªåˆ—è¡¨é¡¹ data.add('${++counter}'); // å‘Šè¯‰åˆ—è¡¨é¡¹æœ‰æ–°æ·»åŠ çš„åˆ—è¡¨é¡¹ globalKey.currentState!.insertItem(data.length - 1); print('æ·»åŠ  $counter'); }, ), bottom: 30, left: 0, right: 0, ); } // æ„å»ºåˆ—è¡¨é¡¹ Widget buildItem(context, index) { String char = data[index]; return ListTile( //æ•°å­—ä¸ä¼šé‡å¤ï¼Œæ‰€ä»¥ä½œä¸ºKey key: ValueKey(char), title: Text(char), trailing: IconButton( icon: Icon(Icons.delete), // ç‚¹å‡»æ—¶åˆ é™¤ onPressed: () => onDelete(context, index), ), ); } void onDelete(context, index) { // å¾…å®ç° } } åˆ é™¤çš„æ—¶å€™éœ€è¦æˆ‘ä»¬é€šè¿‡AnimatedListState çš„ removeItem æ–¹æ³•æ¥åº”ç”¨åˆ é™¤åŠ¨ç”»ï¼Œå…·ä½“é€»è¾‘åœ¨ onDelete ä¸­ï¼š setState(() { globalKey.currentState!.removeItem( index, (context, animation) { // åˆ é™¤è¿‡ç¨‹æ‰§è¡Œçš„æ˜¯åå‘åŠ¨ç”»ï¼Œanimation.value ä¼šä»1å˜ä¸º0 var item = buildItem(context, index); print('åˆ é™¤ ${data[index]}'); data.removeAt(index); // åˆ é™¤åŠ¨ç”»æ˜¯ä¸€ä¸ªåˆæˆåŠ¨ç”»ï¼šæ¸éš + ç¼©å°åˆ—è¡¨é¡¹å‘Šè¯‰ return FadeTransition( opacity: CurvedAnimation( parent: animation, //è®©é€æ˜åº¦å˜åŒ–çš„æ›´å¿«ä¸€äº› curve: const Interval(0.5, 1.0), ), // ä¸æ–­ç¼©å°åˆ—è¡¨é¡¹çš„é«˜åº¦ child: SizeTransition( sizeFactor: animation, axisAlignment: 0.0, child: item, ), ); }, duration: Duration(milliseconds: 200), // åŠ¨ç”»æ—¶é—´ä¸º 200 ms ); }); ä»£ç å¾ˆç®€å•ï¼Œä½†æˆ‘ä»¬éœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬çš„æ•°æ®æ˜¯å•ç‹¬åœ¨ data ä¸­ç»´æŠ¤çš„ï¼Œè°ƒç”¨ AnimatedListState çš„æ’å…¥å’Œç§»é™¤æ–¹æ³•çŸ¥è¯†ç›¸å½“äºä¸€ä¸ªé€šçŸ¥ï¼šåœ¨ä»€ä¹ˆä½ç½®æ‰§è¡Œæ’å…¥æˆ–ç§»é™¤åŠ¨ç”»ï¼Œä»ç„¶æ˜¯æ•°æ®é©±åŠ¨çš„ï¼ˆå“åº”å¼å¹¶éå‘½ä»¤å¼ï¼‰ã€‚ "},"pages/fultter/GridView.html":{"url":"pages/fultter/GridView.html","title":"GridView","keywords":"","body":"GridView æºç  GridView SliverGridDelegate SliverGridDelegateæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®šä¹‰äº†GridView Layoutç›¸å…³æ¥å£ï¼Œå­ç±»éœ€è¦é€šè¿‡å®ç°å®ƒä»¬æ¥å®ç°å…·ä½“çš„å¸ƒå±€ç®—æ³•ã€‚Flutterä¸­æä¾›äº†ä¸¤ä¸ªSliverGridDelegateçš„å­ç±»SliverGridDelegateWithFixedCrossAxisCountå’ŒSliverGridDelegateWithMaxCrossAxisExtentã€‚ 1. SliverGridDelegateWithFixedCrossAxisCount é€šè¿‡è®¾ç½®æ¨ªè½´å­å…ƒç´ çš„æ•°é‡å’Œæ¯”ä¾‹çš„layoutç®—æ³•ã€‚ SliverGridDelegateWithFixedCrossAxisCount({ @required double crossAxisCount, double mainAxisSpacing = 0.0, double crossAxisSpacing = 0.0, double childAspectRatio = 1.0, }) 2. SliverGridDelegateWithMaxCrossAxisExtent è®¾ç½®å­å…ƒç´ æœ€å¤§é•¿åº¦çš„layoutç®—æ³•ã€‚ SliverGridDelegateWithMaxCrossAxisExtent({ double maxCrossAxisExtent, double mainAxisSpacing = 0.0, double crossAxisSpacing = 0.0, double childAspectRatio = 1.0, }) GridView.count GridView.countæ„é€ å‡½æ•°å†…éƒ¨ä½¿ç”¨äº†SliverGridDelegateWithFixedCrossAxisCountã€‚ GridView.count( crossAxisCount: 3, childAspectRatio: 1.0, children: [ Icon(Icons.ac_unit), Icon(Icons.airport_shuttle), Icon(Icons.all_inclusive), Icon(Icons.beach_access), Icon(Icons.cake), Icon(Icons.free_breakfast), ], ); GridView.extent GridView.extentæ„é€ å‡½æ•°å†…éƒ¨ä½¿ç”¨äº†SliverGridDelegateWithMaxCrossAxisExtentã€‚ GridView.extent( maxCrossAxisExtent: 120.0, childAspectRatio: 2.0, children: [ Icon(Icons.ac_unit), Icon(Icons.airport_shuttle), Icon(Icons.all_inclusive), Icon(Icons.beach_access), Icon(Icons.cake), Icon(Icons.free_breakfast), ], ); GridView.builder å½“å­widgetæ¯”è¾ƒå¤šæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡GridView.builderæ¥åŠ¨æ€åˆ›å»ºå­widgetã€‚GridView.builder å¿…é¡»æŒ‡å®šçš„å‚æ•°æœ‰ä¸¤ä¸ªï¼š GridView.builder( ... required SliverGridDelegate gridDelegate, required IndexedWidgetBuilder itemBuilder, ) ç¤ºä¾‹ å‡è®¾æˆ‘ä»¬éœ€è¦ä»ä¸€ä¸ªå¼‚æ­¥æ•°æ®æºï¼ˆå¦‚ç½‘ç»œï¼‰åˆ†æ‰¹è·å–ä¸€äº›Iconï¼Œç„¶åç”¨GridViewæ¥å±•ç¤ºï¼š class InfiniteGridView extends StatefulWidget { @override _InfiniteGridViewState createState() => _InfiniteGridViewState(); } class _InfiniteGridViewState extends State { List _icons = []; //ä¿å­˜Iconæ•°æ® @override void initState() { super.initState(); // åˆå§‹åŒ–æ•°æ® _retrieveIcons(); } @override Widget build(BuildContext context) { return GridView.builder( gridDelegate: SliverGridDelegateWithFixedCrossAxisCount( crossAxisCount: 3, //æ¯è¡Œä¸‰åˆ— childAspectRatio: 1.0, //æ˜¾ç¤ºåŒºåŸŸå®½é«˜ç›¸ç­‰ ), itemCount: _icons.length, itemBuilder: (context, index) { //å¦‚æœæ˜¾ç¤ºåˆ°æœ€åä¸€ä¸ªå¹¶ä¸”Iconæ€»æ•°å°äº200æ—¶ç»§ç»­è·å–æ•°æ® if (index == _icons.length - 1 && _icons.length "},"pages/fultter/PageView.html":{"url":"pages/fultter/PageView.html","title":"PageView","keywords":"","body":"PageView æºç  PageViewä¸é¡µé¢ç¼“å­˜ æ„é€ æ–¹æ³• PageView({ Key? key, this.scrollDirection = Axis.horizontal, // æ»‘åŠ¨æ–¹å‘ this.reverse = false, PageController? controller, this.physics, List children = const [], this.onPageChanged, //æ¯æ¬¡æ»‘åŠ¨æ˜¯å¦å¼ºåˆ¶åˆ‡æ¢æ•´ä¸ªé¡µé¢ï¼Œå¦‚æœä¸ºfalseï¼Œåˆ™ä¼šæ ¹æ®å®é™…çš„æ»‘åŠ¨è·ç¦»æ˜¾ç¤ºé¡µé¢ this.pageSnapping = true, //ä¸»è¦æ˜¯é…åˆè¾…åŠ©åŠŸèƒ½ç”¨çš„ï¼Œåé¢è§£é‡Š this.allowImplicitScrolling = false, //åé¢è§£é‡Š this.padEnds = true, }) ç¤ºä¾‹ æˆ‘ä»¬çœ‹ä¸€ä¸ª Tab åˆ‡æ¢çš„å®ä¾‹ï¼Œä¸ºäº†çªå‡ºé‡ç‚¹ï¼Œæˆ‘ä»¬è®©æ¯ä¸ª Tab é¡µéƒ½åªæ˜¾ç¤ºä¸€ä¸ªæ•°å­—ã€‚ // Tab é¡µé¢ class Page extends StatefulWidget { const Page({ Key? key, required this.text }) : super(key: key); final String text; @override _PageState createState() => _PageState(); } class _PageState extends State { @override Widget build(BuildContext context) { print(\"build ${widget.text}\"); return Center(child: Text(\"${widget.text}\", textScaleFactor: 5)); } } æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª PageViewï¼š @override Widget build(BuildContext context) { var children = []; // ç”Ÿæˆ 6 ä¸ª Tab é¡µ for (int i = 0; i é¡µé¢ç¼“å­˜ allowImplicitScrollingè®¾ç½®ä¸ºtrueå¯ä»¥ç¼“å­˜å‰åå„ä¸€é¡µæ•°æ®ã€‚ "},"pages/fultter/KeepAlive.html":{"url":"pages/fultter/KeepAlive.html","title":"KeepAlive","keywords":"","body":"KeepAlive æºç  KeepAlive AutomaticKeepAliveè¯¦è§£ åœ¨åˆ—è¡¨é¡¹Widgetçš„Stateä¸­æ··å…¥AutomaticKeepAliveClientMixinã€‚ è¦†å†™wantKeepAliveè¿”å›trueã€‚ åœ¨build()å†…è°ƒç”¨super.build(context)ã€‚ "},"pages/fultter/TabbarView.html":{"url":"pages/fultter/TabbarView.html","title":"TabbarView","keywords":"","body":"TabbarView æºç  TabbarView TabBarView TabBarView å°è£…äº† PageViewï¼Œå®ƒçš„æ„é€ æ–¹æ³•å¾ˆç®€å• TabBarView({ Key? key, required this.children, // tab é¡µ this.controller, // TabController this.physics, this.dragStartBehavior = DragStartBehavior.start, }) TabController ç”¨äºç›‘å¬å’Œæ§åˆ¶ TabBarView çš„é¡µé¢åˆ‡æ¢ï¼Œé€šå¸¸å’Œ TabBar è”åŠ¨ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™ä¼šåœ¨ç»„ä»¶æ ‘ä¸­å‘ä¸ŠæŸ¥æ‰¾å¹¶ä½¿ç”¨æœ€è¿‘çš„ä¸€ä¸ª DefaultTabController ã€‚ TabBar TabBar æœ‰å¾ˆå¤šé…ç½®å‚æ•°ï¼Œé€šè¿‡è¿™äº›å‚æ•°æˆ‘ä»¬å¯ä»¥å®šä¹‰ TabBar çš„æ ·å¼ï¼Œå¾ˆå¤šå±æ€§éƒ½æ˜¯åœ¨é…ç½® indicator å’Œ labelï¼Œæ‹¿ä¸Šå›¾æ¥ä¸¾ä¾‹ï¼ŒLabel æ˜¯æ¯ä¸ªTab çš„æ–‡æœ¬ï¼Œindicator æŒ‡ â€œå†å²â€ ä¸‹é¢çš„ç™½è‰²ä¸‹åˆ’çº¿ã€‚ const TabBar({ Key? key, required this.tabs, // å…·ä½“çš„ Tabsï¼Œéœ€è¦æˆ‘ä»¬åˆ›å»º this.controller, this.isScrollable = false, // æ˜¯å¦å¯ä»¥æ»‘åŠ¨ this.padding, this.indicatorColor,// æŒ‡ç¤ºå™¨é¢œè‰²ï¼Œé»˜è®¤æ˜¯é«˜åº¦ä¸º2çš„ä¸€æ¡ä¸‹åˆ’çº¿ this.automaticIndicatorColorAdjustment = true, this.indicatorWeight = 2.0,// æŒ‡ç¤ºå™¨é«˜åº¦ this.indicatorPadding = EdgeInsets.zero, //æŒ‡ç¤ºå™¨padding this.indicator, // æŒ‡ç¤ºå™¨ this.indicatorSize, // æŒ‡ç¤ºå™¨é•¿åº¦ï¼Œæœ‰ä¸¤ä¸ªå¯é€‰å€¼ï¼Œä¸€ä¸ªtabçš„é•¿åº¦ï¼Œä¸€ä¸ªæ˜¯labelé•¿åº¦ this.labelColor, this.labelStyle, this.labelPadding, this.unselectedLabelColor, this.unselectedLabelStyle, this.mouseCursor, this.onTap, ... }) TabBar é€šå¸¸ä½äº AppBar çš„åº•éƒ¨ï¼Œå®ƒä¹Ÿå¯ä»¥æ¥æ”¶ä¸€ä¸ª TabController ï¼Œå¦‚æœéœ€è¦å’Œ TabBarView è”åŠ¨ï¼Œ TabBar å’Œ TabBarView ä½¿ç”¨åŒä¸€ä¸ª TabController å³å¯ï¼Œæ³¨æ„ï¼Œè”åŠ¨æ—¶ TabBar å’Œ TabBarView çš„å­©å­æ•°é‡éœ€è¦ä¸€è‡´ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®š controllerï¼Œåˆ™ä¼šåœ¨ç»„ä»¶æ ‘ä¸­å‘ä¸ŠæŸ¥æ‰¾å¹¶ä½¿ç”¨æœ€è¿‘çš„ä¸€ä¸ª DefaultTabController ã€‚å¦å¤–æˆ‘ä»¬éœ€è¦åˆ›å»ºéœ€è¦çš„ tab å¹¶é€šè¿‡ tabs ä¼ ç»™ TabBarï¼Œ tab å¯ä»¥æ˜¯ä»»ä½• Widgetï¼Œä¸è¿‡Material ç»„ä»¶åº“ä¸­å·²ç»å®ç°äº†ä¸€ä¸ª Tab ç»„ä»¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šç›´æ¥ä½¿ç”¨å®ƒï¼š const Tab({ Key? key, this.text, //æ–‡æœ¬ this.icon, // å›¾æ ‡ this.iconMargin = const EdgeInsets.only(bottom: 10.0), this.height, this.child, // è‡ªå®šä¹‰ widget }) æ³¨æ„ï¼Œtext å’Œ child æ˜¯äº’æ–¥çš„ï¼Œä¸èƒ½åŒæ—¶åˆ¶å®šã€‚ å®ä¾‹ class TabViewRoute1 extends StatefulWidget { @override _TabViewRoute1State createState() => _TabViewRoute1State(); } class _TabViewRoute1State extends State with SingleTickerProviderStateMixin { late TabController _tabController; List tabs = [\"æ–°é—»\", \"å†å²\", \"å›¾ç‰‡\"]; @override void initState() { super.initState(); _tabController = TabController(length: tabs.length, vsync: this); } @override Widget build(BuildContext context) { return Scaffold( appBar: AppBar( title: Text(\"App Name\"), bottom: TabBar( controller: _tabController, tabs: tabs.map((e) => Tab(text: e)).toList(), ), ), body: TabBarView( //æ„å»º controller: _tabController, children: tabs.map((e) { return KeepAliveWrapper( child: Container( alignment: Alignment.center, child: Text(e, textScaleFactor: 5), ), ); }).toList(), ), ); } @override void dispose() { // é‡Šæ”¾èµ„æº _tabController.dispose(); super.dispose(); } } æ»‘åŠ¨é¡µé¢æ—¶é¡¶éƒ¨çš„ Tab ä¹Ÿä¼šè·Ÿç€åŠ¨ï¼Œç‚¹å‡»é¡¶éƒ¨ Tab æ—¶é¡µé¢ä¹Ÿä¼šè·Ÿç€åˆ‡æ¢ã€‚ä¸ºäº†å®ç° TabBar å’Œ TabBarView çš„è”åŠ¨ï¼Œæˆ‘ä»¬æ˜¾å¼åˆ›å»ºäº†ä¸€ä¸ª TabControllerï¼Œç”±äº TabController åˆéœ€è¦ä¸€ä¸ª TickerProvider ï¼ˆvsync å‚æ•°ï¼‰ï¼Œ æˆ‘ä»¬åˆæ··å…¥äº† SingleTickerProviderStateMixinï¼›ç”±äº TabController ä¸­ä¼šæ‰§è¡ŒåŠ¨ç”»ï¼ŒæŒæœ‰ä¸€äº›èµ„æºï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨é¡µé¢é”€æ¯æ—¶å¿…é¡»å¾—é‡Šæ”¾èµ„æºï¼ˆdisposeï¼‰ã€‚ç»¼ä¸Šï¼Œæˆ‘ä»¬å‘ç°åˆ›å»º TabController çš„è¿‡ç¨‹è¿˜æ˜¯æ¯”è¾ƒå¤æ‚ï¼Œå®æˆ˜ä¸­ï¼Œå¦‚æœéœ€è¦ TabBar å’Œ TabBarView è”åŠ¨ï¼Œé€šå¸¸ä¼šåˆ›å»ºä¸€ä¸ª DefaultTabController ä½œä¸ºå®ƒä»¬å…±åŒçš„çˆ¶çº§ç»„ä»¶ï¼Œè¿™æ ·å®ƒä»¬åœ¨æ‰§è¡Œæ—¶å°±ä¼šä»ç»„ä»¶æ ‘å‘ä¸ŠæŸ¥æ‰¾ï¼Œéƒ½ä¼šä½¿ç”¨æˆ‘ä»¬æŒ‡å®šçš„è¿™ä¸ª DefaultTabControllerã€‚æˆ‘ä»¬ä¿®æ”¹åçš„å®ç°å¦‚ä¸‹ï¼š class TabViewRoute2 extends StatelessWidget { @override Widget build(BuildContext context) { List tabs = [\"æ–°é—»\", \"å†å²\", \"å›¾ç‰‡\"]; return DefaultTabController( length: tabs.length, child: Scaffold( appBar: AppBar( title: Text(\"App Name\"), bottom: TabBar( tabs: tabs.map((e) => Tab(text: e)).toList(), ), ), body: TabBarView( //æ„å»º children: tabs.map((e) { return KeepAliveWrapper( child: Container( alignment: Alignment.center, child: Text(e, textScaleFactor: 5), ), ); }).toList(), ), ), ); } } å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ— éœ€å»æ‰‹åŠ¨ç®¡ç† Controller çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¹Ÿä¸éœ€è¦æä¾› SingleTickerProviderStateMixinï¼ŒåŒæ—¶ä¹Ÿæ²¡æœ‰å…¶ä»–çš„çŠ¶æ€éœ€è¦ç®¡ç†ï¼Œä¹Ÿå°±ä¸éœ€è¦ç”¨ StatefulWidget äº†ï¼Œè¿™æ ·ç®€å•å¾ˆå¤šã€‚ "},"pages/fultter/CustomScrollView.html":{"url":"pages/fultter/CustomScrollView.html","title":"CustomScrollView","keywords":"","body":"CustomScrollView æºç  CustomScrollView CustomScrollView å‰é¢ä»‹ç»çš„ ListViewã€GridViewã€PageView éƒ½æ˜¯ä¸€ä¸ªå®Œæ•´çš„å¯æ»šåŠ¨ç»„ä»¶ï¼Œæ‰€è°“å®Œæ•´æ˜¯æŒ‡å®ƒä»¬éƒ½åŒ…æ‹¬Scrollable ã€ Viewport å’Œ Sliverã€‚å‡å¦‚æˆ‘ä»¬æƒ³è¦åœ¨ä¸€ä¸ªé¡µé¢ä¸­ï¼ŒåŒæ—¶åŒ…å«å¤šä¸ªå¯æ»šåŠ¨ç»„ä»¶ï¼Œä¸”ä½¿å®ƒä»¬çš„æ»‘åŠ¨æ•ˆæœèƒ½ç»Ÿä¸€èµ·æ¥ï¼Œæ¯”å¦‚ï¼šæˆ‘ä»¬æƒ³å°†å·²æœ‰çš„ä¸¤ä¸ªæ²¿å‚ç›´æ–¹å‘æ»šåŠ¨çš„ ListView æˆä¸€ä¸ª ListView ï¼Œè¿™æ ·åœ¨ç¬¬ä¸€ListView æ»‘åŠ¨åˆ°åº•éƒ¨æ—¶èƒ½è‡ªåŠ¨æ¥ä¸Šç¬¬äºŒ ListViewï¼Œå¦‚æœå°è¯•å†™ä¸€ä¸ª demoï¼š Widget buildTwoListView() { var listView = ListView.builder( itemCount: 20, itemBuilder: (_, index) => ListTile(title: Text('$index')), ); return Column( children: [ Expanded(child: listView), Divider(color: Colors.grey), Expanded(child: listView), ], ); } } é¡µé¢ä¸­æœ‰ä¸¤ä¸ª ListViewï¼Œå„å å¯è§†åŒºåŸŸä¸€åŠé«˜åº¦ï¼Œè™½ç„¶èƒ½å¤Ÿæ˜¾å¼å‡ºæ¥ï¼Œä½†æ¯ä¸€ä¸ª ListView åªä¼šå“åº”è‡ªå·±å¯è§†åŒºåŸŸä¸­æ»‘åŠ¨ï¼Œå®ç°ä¸äº†æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚ä¹‹æ‰€ä»¥ä¼šè¿™æ ·çš„åŸå› æ˜¯ä¸¤ä¸ª ListView éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„ Scrollable ã€ Viewport å’Œ Sliverï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬è‡ªå·±åˆ›å»ºä¸€ä¸ªå…±ç”¨çš„ Scrollable å’Œ Viewport å¯¹è±¡ï¼Œç„¶åå†å°†ä¸¤ä¸ª ListView å¯¹åº”çš„ Sliver æ·»åŠ åˆ°è¿™ä¸ªå…±ç”¨çš„ Viewport å¯¹è±¡ä¸­å°±å¯ä»¥å®ç°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœäº†ã€‚å¦‚æœè¿™ä¸ªå·¥ä½œè®©å¼€å‘è€…è‡ªå·±æ¥åšæ— ç–‘æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œå› æ­¤ Flutter æä¾›äº†ä¸€ä¸ª CustomScrollView ç»„ä»¶æ¥å¸®åŠ©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå…¬å…±çš„ Scrollable å’Œ Viewport ï¼Œç„¶åå®ƒçš„ slivers å‚æ•°æ¥å—ä¸€ä¸ª Sliver æ•°ç»„ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨CustomScrollView æ–¹é¢çš„å®ç°æˆ‘ä»¬æœŸæœ›çš„åŠŸèƒ½äº†ï¼š Widget buildTwoSliverList() { // SliverFixedExtentList æ˜¯ä¸€ä¸ª Sliverï¼Œå®ƒå¯ä»¥ç”Ÿæˆé«˜åº¦ç›¸åŒçš„åˆ—è¡¨é¡¹ã€‚ // å†æ¬¡æé†’ï¼Œå¦‚æœåˆ—è¡¨é¡¹é«˜åº¦ç›¸åŒï¼Œæˆ‘ä»¬åº”è¯¥ä¼˜å…ˆä½¿ç”¨SliverFixedExtentList // å’Œ SliverPrototypeExtentListï¼Œå¦‚æœä¸åŒï¼Œä½¿ç”¨ SliverList. var listView = SliverFixedExtentList( itemExtent: 56, //åˆ—è¡¨é¡¹é«˜åº¦å›ºå®š delegate: SliverChildBuilderDelegate( (_, index) => ListTile(title: Text('$index')), childCount: 10, ), ); // ä½¿ç”¨ return CustomScrollView( slivers: [ listView, listView, ], ); } Sliver Sliveråç§° åŠŸèƒ½ å¯¹åº”çš„å¯æ»šåŠ¨ç»„ä»¶ SliverList åˆ—è¡¨ ListView SliverFixedExtentList é«˜åº¦å›ºå®šçš„åˆ—è¡¨ ListViewï¼ŒæŒ‡å®šitemExtentæ—¶ SliverAnimatedList æ·»åŠ /åˆ é™¤åˆ—è¡¨é¡¹å¯ä»¥æ‰§è¡ŒåŠ¨ç”» AnimatedList SliverGrid ç½‘æ ¼ GridView SliverPrototypeExtentList æ ¹æ®åŸå‹ç”Ÿæˆé«˜åº¦å›ºå®šçš„åˆ—è¡¨ ListViewï¼ŒæŒ‡å®šprototypeItem æ—¶ SliverFillViewport åŒ…å«å¤šä¸ªå­ç»„ä»¶ï¼Œæ¯ä¸ªéƒ½å¯ä»¥å¡«æ»¡å±å¹• PageView é™¤äº†å’Œåˆ—è¡¨å¯¹åº”çš„ Sliver ä¹‹å¤–è¿˜æœ‰ä¸€äº›ç”¨äºå¯¹ Sliver è¿›è¡Œå¸ƒå±€ã€è£…é¥°çš„ç»„ä»¶ï¼Œå®ƒä»¬çš„å­ç»„ä»¶å¿…é¡»æ˜¯ Sliverï¼Œæˆ‘ä»¬åˆ—ä¸¾å‡ ä¸ªå¸¸ç”¨çš„ï¼š |Sliveråç§°|å¯¹åº”RenderBox| |----|----| |SliverPadding|Padding| |SliverVisibilityã€SliverOpacity |Visibilityã€Opacity| |SliverFadeTransition|FadeTransition| |SliverLayoutBuilder|LayoutBuilder| è¿˜æœ‰ä¸€äº›å…¶ä»–å¸¸ç”¨çš„ Sliverï¼š |Sliveråç§°|è¯´æ˜| |----|----| |SliverAppBar|å¯¹åº” AppBarï¼Œä¸»è¦æ˜¯ä¸ºäº†åœ¨ CustomScrollView ä¸­ä½¿ç”¨ã€‚| |SliverToBoxAdapter|ä¸€ä¸ªé€‚é…å™¨ï¼Œå¯ä»¥å°† RenderBox é€‚é…ä¸º Sliverï¼Œåé¢ä»‹ç»ã€‚| |SliverPersistentHeader|æ»‘åŠ¨åˆ°é¡¶éƒ¨æ—¶å¯ä»¥å›ºå®šä½ï¼Œåé¢ä»‹ç»ã€‚| ç¤ºä¾‹ // å› ä¸ºæœ¬è·¯ç”±æ²¡æœ‰ä½¿ç”¨ Scaffoldï¼Œä¸ºäº†è®©å­çº§Widget(å¦‚Text)ä½¿ç”¨ // Material Design é»˜è®¤çš„æ ·å¼é£æ ¼,æˆ‘ä»¬ä½¿ç”¨ Material ä½œä¸ºæœ¬è·¯ç”±çš„æ ¹ã€‚ Material( child: CustomScrollView( slivers: [ // AppBarï¼ŒåŒ…å«ä¸€ä¸ªå¯¼èˆªæ . SliverAppBar( pinned: true, // æ»‘åŠ¨åˆ°é¡¶ç«¯æ—¶ä¼šå›ºå®šä½ expandedHeight: 250.0, flexibleSpace: FlexibleSpaceBar( title: const Text('Demo'), background: Image.asset( \"./imgs/sea.png\", fit: BoxFit.cover, ), ), ), SliverPadding( padding: const EdgeInsets.all(8.0), sliver: SliverGrid( //Grid gridDelegate: SliverGridDelegateWithFixedCrossAxisCount( crossAxisCount: 2, //GridæŒ‰ä¸¤åˆ—æ˜¾ç¤º mainAxisSpacing: 10.0, crossAxisSpacing: 10.0, childAspectRatio: 4.0, ), delegate: SliverChildBuilderDelegate( (BuildContext context, int index) { //åˆ›å»ºå­widget return Container( alignment: Alignment.center, color: Colors.cyan[100 * (index % 9)], child: Text('grid item $index'), ); }, childCount: 20, ), ), ), SliverFixedExtentList( itemExtent: 50.0, delegate: SliverChildBuilderDelegate( (BuildContext context, int index) { //åˆ›å»ºåˆ—è¡¨é¡¹ return Container( alignment: Alignment.center, color: Colors.lightBlue[100 * (index % 9)], child: Text('list item $index'), ); }, childCount: 20, ), ), ], ), ); å¤´éƒ¨SliverAppBarï¼šSliverAppBarå¯¹åº”AppBarï¼Œä¸¤è€…ä¸åŒä¹‹å¤„åœ¨äºSliverAppBarå¯ä»¥é›†æˆåˆ°CustomScrollViewã€‚SliverAppBarå¯ä»¥ç»“åˆFlexibleSpaceBarå®ç°Material Designä¸­å¤´éƒ¨ä¼¸ç¼©çš„æ¨¡å‹ï¼Œå…·ä½“æ•ˆæœï¼Œè¯»è€…å¯ä»¥è¿è¡Œè¯¥ç¤ºä¾‹æŸ¥çœ‹ã€‚ ä¸­é—´çš„SliverGridï¼šå®ƒç”¨SliverPaddingåŒ…è£¹ä»¥ç»™SliverGridæ·»åŠ è¡¥ç™½ã€‚SliverGridæ˜¯ä¸€ä¸ªä¸¤åˆ—ï¼Œå®½é«˜æ¯”ä¸º4çš„ç½‘æ ¼ï¼Œå®ƒæœ‰20ä¸ªå­ç»„ä»¶ã€‚ åº•éƒ¨SliverFixedExtentListï¼šå®ƒæ˜¯ä¸€ä¸ªæ‰€æœ‰å­å…ƒç´ é«˜åº¦éƒ½ä¸º50åƒç´ çš„åˆ—è¡¨ã€‚ SliverToBoxAdapter åœ¨å®é™…å¸ƒå±€ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦å¾€ CustomScrollView ä¸­æ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„ç»„ä»¶ï¼Œè€Œè¿™äº›ç»„ä»¶å¹¶ééƒ½æœ‰ Sliver ç‰ˆæœ¬ï¼Œä¸ºæ­¤ Flutter æä¾›äº†ä¸€ä¸ª SliverToBoxAdapter ç»„ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªé€‚é…å™¨ï¼šå¯ä»¥å°† RenderBox é€‚é…ä¸º Sliverã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³åœ¨åˆ—è¡¨é¡¶éƒ¨æ·»åŠ ä¸€ä¸ªå¯ä»¥æ¨ªå‘æ»‘åŠ¨çš„ PageViewï¼Œå¯ä»¥ä½¿ç”¨ SliverToBoxAdapter æ¥é…ç½®ï¼š CustomScrollView( slivers: [ SliverToBoxAdapter( child: SizedBox( height: 300, child: PageView( children: [Text(\"1\"), Text(\"2\")], ), ), ), buildSliverFixedList(), ], ); æ³¨æ„ï¼Œä¸Šé¢çš„ä»£ç æ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ï¼Œä½†æ˜¯å¦‚æœå°† PageView æ¢æˆä¸€ä¸ªæ»‘åŠ¨æ–¹å‘å’Œ CustomScrollView ä¸€è‡´çš„ ListView åˆ™ä¸ä¼šæ­£å¸¸å·¥ä½œï¼åŸå› æ˜¯ï¼šCustomScrollView ç»„åˆ Sliver çš„åŸç†æ˜¯ä¸ºæ‰€æœ‰å­ Sliver æä¾›ä¸€ä¸ªå…±äº«çš„ Scrollableï¼Œç„¶åç»Ÿä¸€å¤„ç†æŒ‡å®šæ»‘åŠ¨æ–¹å‘çš„æ»‘åŠ¨äº‹ä»¶ï¼Œå¦‚æœ Sliver ä¸­å¼•å…¥äº†å…¶ä»–çš„ Scrollableï¼Œåˆ™æ»‘åŠ¨äº‹ä»¶ä¾¿ä¼šå†²çªã€‚ä¸Šä¾‹ä¸­ PageView ä¹‹æ‰€ä»¥èƒ½æ­£å¸¸å·¥ä½œï¼Œæ˜¯å› ä¸º PageView çš„ Scrollable åªå¤„ç†æ°´å¹³æ–¹å‘çš„æ»‘åŠ¨ï¼Œè€Œ CustomScrollView æ˜¯å¤„ç†å‚ç›´æ–¹å‘çš„ï¼Œä¸¤è€…å¹¶æœªå†²çªï¼Œæ‰€ä»¥ä¸ä¼šæœ‰é—®é¢˜ï¼Œä½†æ˜¯æ¢ä¸€ä¸ªä¹Ÿæ˜¯å‚ç›´æ–¹å‘çš„ ListView æ—¶åˆ™ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œæœ€ç»ˆçš„æ•ˆæœæ˜¯ï¼Œåœ¨ListViewå†…æ»‘åŠ¨æ—¶åªä¼šå¯¹ListView èµ·ä½œç”¨ï¼ŒåŸå› æ˜¯æ»‘åŠ¨äº‹ä»¶è¢« ListView çš„ Scrollable ä¼˜å…ˆæ¶ˆè´¹ï¼ŒCustomScrollView çš„ Scrollable ä¾¿æ¥æ”¶ä¸åˆ°æ»‘åŠ¨äº‹ä»¶äº†ã€‚ SliverPersistentHeader SliverPersistentHeader çš„åŠŸèƒ½æ˜¯å½“æ»‘åŠ¨åˆ° CustomScrollView çš„é¡¶éƒ¨æ—¶ï¼Œå¯ä»¥å°†ç»„ä»¶å›ºå®šåœ¨é¡¶éƒ¨ã€‚ "},"pages/fultter/CustomSliver.html":{"url":"pages/fultter/CustomSliver.html","title":"CustomSliver","keywords":"","body":"CustomSliver "},"pages/fultter/NestedScrollView.html":{"url":"pages/fultter/NestedScrollView.html","title":"NestedScrollView","keywords":"","body":"NestedScrollView "},"pages/fultter/Flutterå­¦ä¹ è®°å½•.html":{"url":"pages/fultter/Flutterå­¦ä¹ è®°å½•.html","title":"Flutterå­¦ä¹ è®°å½•","keywords":"","body":"Flutterå­¦ä¹ è®°å½• é—®é¢˜è®°å½• \" Error: Member not found: 'packageRoot' \" in Flutter [duplicate] ä½¿ç”¨ Flutter å°†æ–‡æœ¬åŸºçº¿ä¸åˆ—å†…çš„æ–‡æœ¬å¯¹é½ flutterä¸­å¯†ç è¾“å…¥å¦‚ä½•åˆ‡æ¢éšè—/æ˜¾ç¤ºï¼Ÿ Do not use BuildContexts across async gaps Bad state: add Fetch Article was called without a registered event handler [Discussion] Should Cubit expose Stream API? #1429 Flutter TextFieldè¾“å…¥æ¡†å¦‚ä½•ä¼˜é›…çš„ç¦æ­¢å¼¹å‡ºè½¯é”®ç›˜ å…¥é—¨ Flutter å¼€å‘æ–‡æ¡£ Flutter Gallery æ¨èå‡ ä¸ªä¼˜è´¨Flutter å¼€æºé¡¹ç›® Flutter å¿«é€Ÿä¸Šæ‰‹ - 4.2 assetså¯¼å…¥èµ„æº | çŒ«å“¥ Flutterå­¦ä¹ è®°å½•â€”â€”28.Flutter è°ƒè¯•åŠ Android å’Œ iOS æ‰“åŒ… FLUTTERå¼€å‘ä¹‹DARTçº¿ç¨‹ä¸å¼‚æ­¥ ç‚¹å‡»ç©ºç™½åŒºåŸŸæ— ååº”è§£å†³åŠæ³• Dartè¯­è¨€æ•™ç¨‹ å¦‚ä½•åœ¨ Flutter ä¸­æ·»åŠ  ListTile æºç åˆ†æç³»åˆ—ä¹‹InheritedWidget Flutter-çŠ¶æ€ç®¡ç† Flutterå­¦ä¹ ç¬”è®°ï¼šFlutterçŠ¶æ€ç®¡ç†ï¼ˆä½¿ç”¨Providerè¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼‰ Flutterä¸­æ–‡ç½‘ rxDart RxDart - ä½¿ç”¨ mapã€flatMapã€concatMapã€switchMapã€asyncMapã€exhaustMap textæˆªæ–­æ–¹å¼ textæˆªæ–­æ–¹å¼ Text ä»¥å­—ç¬¦çš„æ–¹å¼æˆªæ–­ dart dart.cn Dart | æµ…ædartä¸­åº“çš„å¯¼å…¥ä¸æ‹†åˆ† ã€-Flutter/Dart è¯­æ³•è¡¥é—-ã€‘ sync å’Œ async ã€yield å’Œyield* ã€async å’Œ await Dartä¸­ä¸¤ä¸ªç‚¹..å’Œä¸‰ä¸ªç‚¹...çš„ç”¨æ³• Flutter äº‹ä»¶æœºåˆ¶ - Future å’Œ MicroTask å…¨è§£æ Dartä¸­çš„FutureåŠå…¶thenã€catchErroræ–¹æ³• Dart:factoryå·¥å‚æ„é€ å‡½æ•°çš„ä½¿ç”¨åœºæ™¯ Dart Stringè½¬æ•°å€¼intæˆ–double GSYGithubApp ã€Œ Flutter é¡¹ç›®å®æˆ˜ ã€è®¾è®¡ä¼ä¸šçº§é¡¹ç›®å…¥å£ main.dart è®¾è®¡ä¸å®ç° ( GSYGithubApp æºç è§£è¯»Â·äºŒ ) GSYGithubApp æºç åˆ†æè§†é¢‘ Flutterä½¿ç”¨ json_serializable è§£æ JSON æœ€ä½³æ–¹æ¡ˆ ç¯å¢ƒé…ç½® flutter é…ç½®ä¸åŒçš„å¼€å‘ç¯å¢ƒ(qa/dev/prod) flutterç¯å¢ƒé…ç½® Redux Flutter Redux ä¸­çš„ combineReducers redux_epics å›½é™…åŒ– flutter-Intlå›½é™…åŒ–ã€æ ¼å¼åŒ–æ—¥æœŸã€æ•°å­— Flutter å¤šè¯­è¨€å›½é™…åŒ–é…ç½® -- ä½¿ç”¨Intlæ’ä»¶ FunFlutterç³»åˆ—ä¹‹å›½é™…åŒ–Intlæ–¹æ¡ˆ çŸ¥è¯† systemOverlayStyleå¯ä»¥è®¾ç½®çŠ¶æ€æ é¢œè‰² Flutter ThemeDataè¯¦è§£ BaseAppBar Complete Guide To Flutter Drawer Flutterä¸‹æ‹‰åˆ·æ–°ç»„ä»¶CupertinoSliverRefreshControlè‹¹æœé£æ ¼åˆ·æ–°æ•ˆæœ Flutter åŸºäºNestedScrollView+RefreshIndicatorå®Œç¾è§£å†³æ»‘åŠ¨å†²çª GraphQL å…¥é—¨çœ‹è¿™ç¯‡å°±å¤Ÿäº† è·å–å±å¹•å°ºå¯¸ Flutter-è·å–å±å¹•é«˜åº¦ã€å¯†åº¦ã€å®‰å…¨åŒºåŸŸç­‰ Flutteræ§åˆ¶ç»„ä»¶æ˜¾ç¤ºå’Œéšè—ä¸‰ç§æ–¹å¼è¯¦è§£ å·¥å…· Flutterä¸­è®¡ç®—æ–‡å­—çš„å®½åº¦/é«˜åº¦ Flutter Utils å…¨ç½‘æœ€é½å…¨çš„å·¥å…·ç±» Flutter-å‡ºç”Ÿæ—¥æœŸè®¡ç®—å¹´é¾„å·¥å…·ç±» ä¸»é¢˜ Flutter å¤„ç†ä¸»é¢˜ Theme çš„ä¸€äº›å»ºè®® ç”¨æŠ½è±¡å·¥å‚æ–¹æ³•æ„å»º Flutter ä¸»é¢˜ Flutterä¹‹textTheme FlutterComponentæœ€ä½³å®è·µä¹‹è‰²å½©ç®¡ç† Flutter å°æŠ€å·§ä¹‹ Flutter 3 ä¸‹çš„ ThemeExtensions å’Œ Material3 Flutter TextStyleå‚æ•°è§£æ å¦‚ä½•åœ¨FLutter ThemeDataä¸­ä½¿ç”¨ColorSchemeï¼Ÿ Flutter æ·±è‰²æ¨¡å¼åˆ†æ&å®è·µ Flutter: å¦‚ä½•æ‰©å±•ThemeData å¦‚ä½•åœ¨ Flutter ä¸­æ›´æ”¹é¢œè‰²çš„è‰²è°ƒã€é¥±å’Œåº¦æˆ–å€¼ï¼Ÿ flutter Iconså…¨éƒ¨å›¾æ ‡ iconfont Flutter3.3å¯¹Material3è®¾è®¡é£æ ¼çš„æ”¯æŒ å®æˆ˜é¡¹ç›® Flutter æ‰‹æŠŠæ‰‹å†™å‡ºè¶…æ¼‚äº®çš„ç™»å½•æ³¨å†Œ UI - é¥®æ–™é£Ÿè°±App - Speed Code flutter-demo æ•™ç¨‹ Flutter App Development Tutorial Series' Articles FlutteråŸºç¡€æ•™ç¨‹ fluttervideo å¿«æ·é”® 105--Flutterç¼–è¾‘å™¨Android Studioå¿«æ·æ“ä½œ Flutter-å¼€å‘ä¸­å¸¸ç”¨çš„å¿«æ·é”®Android Studioï¼ˆMacï¼‰ æŒ‰é’® Flutterçš„buttonçš„æŒ‰é’®ElevatedButton å•å…ƒæµ‹è¯• ä½¿ç”¨ Mockito å¯¹ Flutter ä»£ç è¿›è¡Œå•å…ƒæµ‹è¯• Flutter å•å…ƒæµ‹è¯• ä½¿ç”¨ Mockito æ¨¡æ‹Ÿä¾èµ–å…³ç³» çŠ¶æ€ç®¡ç† flutter_bloc [Flutter] Cubitä»‹ç´¹ï¼†Blocå„ªç¼ºæ¯”è¼ƒ Flutter å…¥é—¨ä¸å®æˆ˜ï¼ˆå…«åä¹ï¼‰ï¼šä½¿ç”¨BlocListenerå¤„ç†çŠ¶æ€å˜åŒ– Flutter å…¥é—¨ä¸å®æˆ˜ï¼ˆä¹åï¼‰ï¼šä½¿ç”¨ BlocConsumer åŒæ—¶æ„å»ºå“åº”å¼ç»„ä»¶å’Œç›‘å¬çŠ¶æ€ Flutter å…¥é—¨ä¸å®æˆ˜ï¼ˆä¹åä¸€ï¼‰ï¼šä½¿ç”¨ RepositoryProviderç®€åŒ–çˆ¶å­ç»„ä»¶çš„ä¼ å€¼ flutter_blocä½¿ç”¨è§£æ---éªšå¹´ï¼Œä½ è¿˜åœ¨æ‰‹æ­blocå—ï¼ slaw-getx Flutter GetXä½¿ç”¨---ç®€æ´çš„é­…åŠ›ï¼ get-cli getx_pattern flutter_ducafecat_news_getx getx-docs ä½¿ç”¨ç»„ä»¶ Flutter ä»¿iOSå·¦æ»‘åˆ é™¤ï¼Œé•¿æŒ‰æ‹–åŠ¨ "},"pages/æ¸¸æˆUIè®¾è®¡/å¹³é¢æ„æˆçš„åŸºæœ¬å½¢ä¸éª¨éª¼.html":{"url":"pages/æ¸¸æˆUIè®¾è®¡/å¹³é¢æ„æˆçš„åŸºæœ¬å½¢ä¸éª¨éª¼.html","title":"å¹³é¢æ„æˆçš„åŸºæœ¬å½¢ä¸éª¨éª¼","keywords":"","body":"å¹³é¢æ„æˆçš„åŸºæœ¬å½¢ä¸éª¨éª¼ ç»„æˆç”»é¢å†…å®¹çš„è§†è§‰å…ƒç´ ä¸ªä½“ç§°ä¸ºåŸºæœ¬å½¢ï¼ŒåŸºæœ¬å½¢æ’åˆ—æ‰€ä¾ç…§çš„è§„åˆ™é¡ºåºï¼ˆæ„å›¾ï¼‰ç§°ä¸ºâ€œéª¨éª¼â€ã€‚ 1ï¼‰åŸºæœ¬å½¢ å½“åŸºæœ¬å½¢ç›¸åŒæ—¶ï¼Œä¼šäº§ç”Ÿä»¥ä¸‹ç»„åˆå…³ç³»ï¼Œå…¶è¢«å¹¿æ³›è¿ç”¨åœ¨æ¸¸æˆUIè®¾è®¡ä¸­ï¼Œå¦‚å›¾å½¢ã€å›¾æ ‡ä¸èŠ±çº¹è®¾è®¡ï¼Œå¦‚å›¾3-32æ‰€ç¤ºã€‚ åˆ†ç¦» æ¥è§¦ é‡å  å±€éƒ¨é€å  é®æŒ¡ æ®‹ç¼º å·®å  åŒ…å®¹ åˆ†ç¦» æ¥è§¦ é®æŒ¡ æ®‹ç¼º åŒ…å®¹ ï¼ˆ2ï¼‰éª¨éª¼ å¹³é¢æ„æˆç»„æˆå…ƒç´ çš„æ¡†æ¶å«ä½œâ€œéª¨éª¼â€ï¼Œå®ƒè®©ä¸€åˆ‡åŸºæœ¬å½¢äº§ç”Ÿæœ‰ç§©åºçš„ç¼–æ’é¡ºåºï¼Œæˆ–äº§ç”Ÿæ„Ÿè§‰ä¸Šç»è¿‡åˆ»æ„ç¼–æ’çš„é¡ºåºï¼Œå¸¸åœ¨æ¸¸æˆUIæ„å›¾ä¸­ä½¿ç”¨ï¼Œä½¿ç”»é¢å†…å®¹çš„æ’åˆ—å¸ƒå±€æ¸…æ™°ã€‚ æ¯”å¦‚é€šè¿‡éª¨éª¼æ¥æ£€æŸ¥ä¸‹é¢è¿™ä¸ªç•Œé¢æ„å›¾ä¸­å„ä¸ªåŒºå—å†…å®¹çš„é—®é¢˜ï¼Œå¦‚å›¾3-33æ‰€ç¤ºã€‚åŠ ä¸Šéª¨éª¼çº¿åï¼Œå¯ä»¥çœ‹å‡ºå¾ˆå¤šé—®é¢˜ï¼Œæ¯”å¦‚éª¨éª¼é¡¶éƒ¨ä¸å±…ä¸­ï¼Œå¹¶ä¸”åœ¨ç”»é¢ä¸Šéƒ¨æ•´ä½“éª¨éª¼æ¡†æ¶ä¸‹æ˜¾å¾—è´§å¸ä¸‹çš„æ„å›¾å¤ªç©ºï¼Œä¸‹é¢é¢æ¿ä¸­çš„å³è¾¹éª¨éª¼åŒºåŸŸä¸å·¦è¾¹éª¨éª¼åŒºåŸŸå†…å®¹é«˜åº¦ä¸åŒã€‚ æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ä¸åŒç±»å‹çš„éª¨éª¼æ¥è®¾è®¡ç”»é¢ã€‚ éª¨éª¼åˆ†ç±» æŒ‰å¤æ‚ç¨‹åº¦åˆ†ï¼šå•ä¸€éª¨éª¼ã€å¤åˆéª¨éª¼ã€‚æ¸¸æˆUIè®¾è®¡ä¸­å¤§å¤šæ•°éƒ½æ˜¯å•ä¸€éª¨éª¼ï¼Œå¶å°”ä¼šç”¨åˆ°å¤åˆéª¨éª¼ï¼Œå¦‚å›¾3-34æ‰€ç¤ºã€‚ æŒ‰åŠŸèƒ½åˆ† ï¼šæœ‰ä½œç”¨æ€§éª¨éª¼ã€æ— ä½œç”¨æ€§éª¨éª¼ã€‚ æŒ‰ç»“æ„åˆ†ï¼šæœ‰è§„å¾‹æ€§éª¨éª¼ã€åŠè§„å¾‹æ€§éª¨éª¼ã€éè§„å¾‹æ€§éª¨éª¼ã€‚ 1.æœ‰ä½œç”¨æ€§éª¨éª¼ éª¨éª¼ç»™åŸºæœ¬å½¢å‡†ç¡®çš„ç©ºé—´ä½ç½®ï¼Œå¹¶å¯å½±å“åŸºæœ¬å½¢çš„å½¢çŠ¶ï¼ŒåŸºæœ¬å½¢éƒ½åœ¨éª¨éª¼å†…ï¼Œå¹¶å¯ä»¥æ”¹å˜å¤§å°ã€æ­£è´Ÿã€æ–¹å‘ã€ä½ç½®ã€è‚Œç†å’Œé¢œè‰²ï¼Œéª¨éª¼çº¿èµ·åˆ’åˆ†ç©ºé—´çš„ä½œç”¨ï¼Œå¹¶åˆ†å‰²èƒŒæ™¯ï¼Œè¶…å‡ºéª¨éª¼çº¿çš„éƒ¨åˆ†å¯è¢«éª¨éª¼çº¿åˆ‡æ‰ï¼Œä¸å¯å½±å“å…¶ä»–å•ä½éª¨éª¼å†…çš„å…ƒç´ ã€‚éª¨éª¼çº¿ä¸éª¨éª¼çº¿å†…çš„åŸºæœ¬å½¢ä¸ä¸€å®šå…¨éƒ¨å‡ºç°ï¼Œå¦‚æœä¸éœ€è¦å¯å°†éƒ¨åˆ†éª¨éª¼çº¿ä¸åŸºæœ¬å½¢å»æ‰ï¼Œå¦‚å›¾3-35æ‰€ç¤ºã€‚ 2æ— ä½œç”¨æ€§éª¨æ ¼ éª¨éª¼ä¸ä¼šåˆ†å‰²ç©ºé—´ï¼Œå®ƒåªç»™åŸºæœ¬å½¢å‡†ç¡®çš„ç©ºé—´ä½ç½®ï¼ŒåŸºæœ¬å½¢å®‰æ’åœ¨éª¨æ ¼çš„äº¤ç‚¹ä¸Šï¼ŒåŸºæœ¬å½¢å¯ä»¥æ”¹å˜å¤§å°ã€æ­£è´Ÿã€æ–¹å‘ã€è‚Œç†å’Œé¢œè‰²ï¼Œå¦‚å›¾3-36æ‰€ç¤ºã€‚ 3.è§„å¾‹æ€§éª¨æ ¼ è§„å¾‹æ€§éª¨æ ¼æœ‰ç²¾ç¡®ä¸¥è°¨çš„éª¨æ ¼çº¿ï¼Œæœ‰è§„å¾‹ï¼ŒåŸºæœ¬å½¢æŒ‰ç…§éª¨æ ¼æ’åˆ—ï¼Œæœ‰å¼ºçƒˆçš„ç§©åºæ„Ÿï¼Œä¸»è¦æœ‰é‡å¤ã€æ¸å˜ã€å‘å°„å’Œè¡å˜ç­‰å½¢å¼ï¼Œå¦‚å›¾3-37æ‰€ç¤ºã€‚ "},"pages/é¢è¯•ç³»åˆ—/01_é¢è¯•é—®é¢˜é›†é”¦.html":{"url":"pages/é¢è¯•ç³»åˆ—/01_é¢è¯•é—®é¢˜é›†é”¦.html","title":"é¢è¯•é—®é¢˜é›†é”¦1","keywords":"","body":"1.é¢è¯•é—®é¢˜é›†é”¦ 1. weakå’Œassignçš„åŒºåˆ« ä¸€ã€ä»€ä¹ˆæƒ…å†µä½¿ç”¨ weak å…³é”®å­—ï¼Ÿ åœ¨ ARC ä¸­ï¼Œåœ¨æœ‰å¯èƒ½å‡ºç°å¾ªç¯å¼•ç”¨çš„æ—¶å€™ï¼Œå¾€å¾€è¦é€šè¿‡è®©å…¶ä¸­ä¸€ç«¯ä½¿ç”¨ weak æ¥è§£å†³ï¼Œæ¯”å¦‚ï¼š delegate ä»£ç†å±æ€§ã€‚ è‡ªèº«å·²ç»å¯¹å®ƒè¿›è¡Œä¸€æ¬¡å¼ºå¼•ç”¨ï¼Œæ²¡æœ‰å¿…è¦å†å¼ºå¼•ç”¨ä¸€æ¬¡ï¼Œæ­¤æ—¶ä¹Ÿä¼šä½¿ç”¨ weak ï¼Œè‡ªå®šä¹‰ IBOutlet æ§ä»¶å±æ€§ä¸€èˆ¬ä¹Ÿä½¿ç”¨ weak ï¼›å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ strong ã€‚ äºŒã€åŒºåˆ« 2.1. ä¿®é¥°å˜é‡ç±»å‹çš„åŒºåˆ« weak åªå¯ä»¥ä¿®é¥°å¯¹è±¡ã€‚å¦‚æœä¿®é¥°åŸºæœ¬æ•°æ®ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™-â€œProperty with â€˜weakâ€™ attribute must be of object typeâ€ã€‚ assign å¯ä¿®é¥°å¯¹è±¡ï¼Œå’ŒåŸºæœ¬æ•°æ®ç±»å‹ã€‚å½“éœ€è¦ä¿®é¥°å¯¹è±¡ç±»å‹æ—¶ï¼ŒMRCæ—¶ä»£ä½¿ç”¨ unsafeunretained ã€‚å½“ç„¶ï¼Œ unsafe_unretained ä¹Ÿå¯èƒ½äº§ç”Ÿé‡æŒ‡é’ˆï¼Œæ‰€ä»¥å®ƒåå­—æ˜¯ unsafe ã€‚ 2.2. æ˜¯å¦äº§ç”Ÿé‡æŒ‡é’ˆçš„åŒºåˆ« weak ä¸ä¼šäº§ç”Ÿé‡æŒ‡é’ˆé—®é¢˜ã€‚å› ä¸º weak ä¿®é¥°çš„å¯¹è±¡é‡Šæ”¾åï¼ˆå¼•ç”¨è®¡æ•°å™¨å€¼ä¸º0ï¼‰ï¼ŒæŒ‡é’ˆä¼šè‡ªåŠ¨è¢«ç½®nilï¼Œä¹‹åå†å‘è¯¥å¯¹è±¡å‘æ¶ˆæ¯ä¹Ÿä¸ä¼šå´©æºƒã€‚ weakæ˜¯å®‰å…¨çš„ã€‚ assign å¦‚æœä¿®é¥°å¯¹è±¡ï¼Œä¼šäº§ç”Ÿé‡æŒ‡é’ˆé—®é¢˜ï¼›å¦‚æœä¿®é¥°åŸºæœ¬æ•°æ®ç±»å‹åˆ™æ˜¯å®‰å…¨çš„ã€‚ä¿®é¥°çš„å¯¹è±¡é‡Šæ”¾åï¼ŒæŒ‡é’ˆä¸ä¼šè‡ªåŠ¨è¢«ç½®ç©ºï¼Œæ­¤æ—¶å‘å¯¹è±¡å‘æ¶ˆæ¯ä¼šå´©æºƒã€‚ ä¸‰ã€ç›¸åŒ éƒ½å¯ä»¥ä¿®é¥°å¯¹è±¡ç±»å‹ï¼Œä½†æ˜¯ assign ä¿®é¥°å¯¹è±¡ä¼šå­˜åœ¨é—®é¢˜ã€‚ å››ã€æ€»ç»“ assign é€‚ç”¨äºåŸºæœ¬æ•°æ®ç±»å‹å¦‚ intï¼Œfloatï¼Œstruct ç­‰å€¼ç±»å‹ï¼Œä¸é€‚ç”¨äºå¼•ç”¨ç±»å‹ã€‚å› ä¸ºå€¼ç±»å‹ä¼šè¢«æ”¾å…¥æ ˆä¸­ï¼Œéµå¾ªå…ˆè¿›åå‡ºåŸåˆ™ï¼Œç”±ç³»ç»Ÿè´Ÿè´£ç®¡ç†æ ˆå†…å­˜ã€‚è€Œå¼•ç”¨ç±»å‹ä¼šè¢«æ”¾å…¥å †ä¸­ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨ç®¡ç†å†…å­˜æˆ–é€šè¿‡ ARC ç®¡ç†ã€‚weak é€‚ç”¨äº delegate å’Œ block ç­‰å¼•ç”¨ç±»å‹ï¼Œä¸ä¼šå¯¼è‡´é‡æŒ‡é’ˆé—®é¢˜ï¼Œä¹Ÿä¸ä¼šå¾ªç¯å¼•ç”¨ï¼Œéå¸¸å®‰å…¨ã€‚ äº”ã€å‚è€ƒæ–‡ç«  iOSå¼€å‘ä¸­ weak å’Œ assign çš„åŒºåˆ« 2. ä¸ºä»€ä¹ˆè¦ç”¨ Copy ä¿®é¥° Block ä¸€ã€æ ˆåŒºå’Œå †åŒºæ¦‚å¿µ å†…å­˜çš„æ ˆåŒºï¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…é‡Šæ”¾ï¼Œå­˜æ”¾å‡½æ•°çš„å‚æ•°å€¼ï¼Œå±€éƒ¨å˜é‡çš„å€¼ç­‰ã€‚ å…¶æ“ä½œæ–¹å¼ç±»ä¼¼äºæ•°æ®ç»“æ„ä¸­çš„æ ˆã€‚ å†…å­˜çš„å †åŒºï¼šä¸€èˆ¬ç”±ç¨‹åºå‘˜åˆ†é…é‡Šæ”¾ï¼Œè‹¥ç¨‹åºå‘˜ä¸é‡Šæ”¾ï¼Œç¨‹åºç»“æŸæ—¶å¯èƒ½ç”±OSå›æ”¶ã€‚æ³¨æ„å®ƒä¸æ•°æ®ç»“æ„ä¸­çš„å †æ˜¯ä¸¤å›äº‹ï¼Œ åˆ†é…æ–¹å¼å€’æ˜¯ç±»ä¼¼äºé“¾è¡¨ã€‚ äºŒã€Block çš„ä¸‰ç§ç±»å‹ iOS å†…å­˜åˆ†å¸ƒï¼Œä¸€èˆ¬åˆ†ä¸ºï¼šæ ˆåŒºã€å †åŒºã€å…¨å±€åŒºã€å¸¸é‡åŒºã€ä»£ç åŒºã€‚å…¶å® Block ä¹Ÿæ˜¯ä¸€ä¸ª Objective-C å¯¹è±¡ï¼Œå¸¸è§çš„æœ‰ä»¥ä¸‹ä¸‰ç§ Block ï¼š NSGlobalBlockï¼šå…¨å±€çš„é™æ€ Block æ²¡æœ‰è®¿é—®å¤–éƒ¨å˜é‡ã€‚ NSStackBlockï¼šä¿å­˜åœ¨æ ˆä¸­çš„ Block ï¼Œæ²¡æœ‰ç”¨copyå»ä¿®é¥°å¹¶ä¸”è®¿é—®äº†å¤–éƒ¨å˜é‡ï¼Œä¼šåœ¨å‡½æ•°è°ƒç”¨ç»“æŸè¢«é”€æ¯ï¼ˆéœ€è¦åœ¨MRCï¼‰ã€‚ NSMallocBlockï¼šä¿å­˜åœ¨å †ä¸­çš„ Block ï¼Œ æ­¤ç±»å‹ Block æ˜¯ç”¨ Copy ä¿®é¥°å‡ºæ¥çš„ Block ï¼Œå®ƒä¼šéšç€å¯¹è±¡çš„é”€æ¯è€Œé”€æ¯ï¼Œåªè¦å¯¹è±¡ä¸é”€æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨çš„åˆ°åœ¨å †ä¸­çš„ Block ã€‚ ä¸‰ã€å›ç­” Block å¼•ç”¨äº†æ™®é€šå¤–éƒ¨å˜é‡ï¼Œéƒ½æ˜¯åˆ›å»ºåœ¨æ ˆåŒºçš„ï¼›å¯¹äºåˆ†é…åœ¨æ ˆåŒºçš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“ä¼šåœ¨é‡Šæ”¾ä¹‹åç»§ç»­è°ƒç”¨ï¼Œå¯¼è‡´ç¨‹åºå¥”æºƒï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™éœ€è¦å°†æ ˆåŒºçš„å¯¹è±¡ç§»åˆ°å †åŒºï¼Œæ¥å»¶é•¿è¯¥å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œå¾—åŒºåˆ† MRC ç¯å¢ƒå’Œ ARC ç¯å¢ƒï¼š å¯¹äº MRC ç¯å¢ƒï¼Œä½¿ç”¨ Copy ä¿®é¥° Blockï¼Œä¼šå°†æ ˆåŒºçš„ Block æ‹·è´åˆ°å †åŒºã€‚ å¯¹äº ARC ç¯å¢ƒï¼Œä½¿ç”¨ Strongã€Copy ä¿®é¥° Blockï¼Œéƒ½ä¼šå°†æ ˆåŒºçš„ Block æ‹·è´åˆ°å †åŒºã€‚ æ‰€ä»¥ï¼ŒBlock ä¸æ˜¯ä¸€å®šè¦ç”¨ Copy æ¥ä¿®é¥°çš„ï¼Œåœ¨ ARC ç¯å¢ƒä¸‹é¢ Strong å’Œ Copy ä¿®é¥°æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚ å››ã€å‚è€ƒæ–‡ç«  iOS block ä¸ºä»€ä¹ˆç”¨copyä¿®é¥° ä¸ºä»€ä¹ˆè¦ç”¨copyä¿®é¥°Block Â·iOS é¢è¯•é¢˜Â·Block çš„åŸç†ï¼ŒBlock çš„å±æ€§ä¿®é¥°è¯ä¸ºä»€ä¹ˆç”¨ copyï¼Œä½¿ç”¨ Block æ—¶æœ‰å“ªäº›è¦æ³¨æ„çš„ï¼Ÿ 3. æ€ä¹ˆç”¨ Copy å…³é”®å­—ï¼Ÿ NSStringã€NSArrayã€NSDictionary ç­‰ç­‰ç»å¸¸ä½¿ç”¨ Copy å…³é”®å­—ã€‚å› ä¸ºä»–ä»¬æœ‰å¯¹åº”çš„å¯å˜ç±»å‹ï¼šNSMutableStringã€NSMutableArrayã€NSMutableDictionaryï¼Œä»–ä»¬ä¹‹é—´å¯èƒ½è¿›è¡Œèµ‹å€¼æ“ä½œï¼Œä¸ºç¡®ä¿å¯¹è±¡ä¸­çš„å­—ç¬¦ä¸²å€¼ä¸ä¼šæ— æ„é—´å˜åŠ¨ï¼Œåº”è¯¥åœ¨è®¾ç½®æ–°å±æ€§å€¼æ—¶æ‹·è´ä¸€ä»½ã€‚ Block ä¹Ÿç»å¸¸ä½¿ç”¨ Copy å…³é”®å­—ã€‚Block ä½¿ç”¨ Copy æ˜¯ä» MRC é—ç•™ä¸‹æ¥çš„â€œä¼ ç»Ÿâ€ï¼Œåœ¨ MRC ä¸­ï¼Œæ–¹æ³•å†…éƒ¨çš„ Block æ˜¯åœ¨æ ˆåŒºçš„ï¼Œä½¿ç”¨ Copy å¯ä»¥æŠŠå®ƒæ”¾åˆ°å †åŒºã€‚ 4. è¿™ä¸ªå†™æ³•ä¼šå‡ºä»€ä¹ˆé—®é¢˜ï¼š@property (copy) NSMutableArray *array; æ·»åŠ ï¼Œåˆ é™¤ï¼Œä¿®æ”¹æ•°ç»„å†…çš„å…ƒç´ çš„æ—¶å€™ï¼Œç¨‹åºä¼šå› ä¸ºæ‰¾ä¸åˆ°å¯¹åº”çš„æ–¹æ³•è€Œå´©æºƒ.å› ä¸º copy å°±æ˜¯å¤åˆ¶ä¸€ä¸ªä¸å¯å˜ NSArray çš„å¯¹è±¡ï¼› æ¯”å¦‚ä¸‹é¢çš„ä»£ç å°±ä¼šå‘ç”Ÿå´©æºƒ // .hæ–‡ä»¶ // http://weibo.com/luohanchenyilong/ // https://github.com/ChenYilong // ä¸‹é¢çš„ä»£ç å°±ä¼šå‘ç”Ÿå´©æºƒ @property (nonatomicï¼Œ copy) NSMutableArray *mutableArray; // .mæ–‡ä»¶ // http://weibo.com/luohanchenyilong/ // https://github.com/ChenYilong // ä¸‹é¢çš„ä»£ç å°±ä¼šå‘ç”Ÿå´©æºƒ NSMutableArray *array = [NSMutableArray arrayWithObjects:@1ï¼Œ@2ï¼Œnil]; self.mutableArray = array; [self.mutableArray removeObjectAtIndex:0]; æ¥ä¸‹æ¥å°±ä¼šå¥”æºƒï¼š -[__NSArrayI removeObjectAtIndex:]: unrecognized selector sent to instance 0x7fcd1bc30460 ä½¿ç”¨äº† atomic å±æ€§ä¼šä¸¥é‡å½±å“æ€§èƒ½ï¼› è¯¥å±æ€§ä½¿ç”¨äº†äº’æ–¥é”ï¼ˆatomic çš„åº•å±‚å®ç°ï¼Œè€ç‰ˆæœ¬æ˜¯è‡ªæ—‹é”ï¼ŒiOS10å¼€å§‹æ˜¯äº’æ–¥é”--spinlockåº•å±‚å®ç°æ”¹å˜äº†ã€‚ï¼‰ï¼Œä¼šåœ¨åˆ›å»ºæ—¶ç”Ÿæˆä¸€äº›é¢å¤–çš„ä»£ç ç”¨äºå¸®åŠ©ç¼–å†™å¤šçº¿ç¨‹ç¨‹åºï¼Œè¿™ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ï¼Œé€šè¿‡å£°æ˜ nonatomic å¯ä»¥èŠ‚çœè¿™äº›è™½ç„¶å¾ˆå°ä½†æ˜¯ä¸å¿…è¦é¢å¤–å¼€é”€ã€‚ 5. å¦‚ä½•è®©è‡ªå·±çš„ç±»ç”¨ copy ä¿®é¥°ç¬¦ï¼Ÿå¦‚ä½•é‡å†™å¸¦ copy å…³é”®å­—çš„ setterï¼Ÿ è‹¥æƒ³ä»¤è‡ªå·±æ‰€å†™çš„å¯¹è±¡å…·æœ‰æ‹·è´åŠŸèƒ½ï¼Œåˆ™éœ€å®ç° NSCopying åè®®ã€‚å¦‚æœè‡ªå®šä¹‰çš„å¯¹è±¡åˆ†ä¸ºå¯å˜ç‰ˆæœ¬ä¸ä¸å¯å˜ç‰ˆæœ¬ï¼Œé‚£ä¹ˆå°±è¦åŒæ—¶å®ç° NSCopying ä¸ NSMutableCopying åè®®ã€‚ å…·ä½“æ­¥éª¤ï¼š éœ€å£°æ˜è¯¥ç±»éµä» NSCopying åè®® å®ç° NSCopying åè®®ã€‚è¯¥åè®®åªæœ‰ä¸€ä¸ªæ–¹æ³•: - (id)copyWithZone:(NSZone *)zone; æ¡ˆä¾‹ï¼š .hæ–‡ // ä»¶ // http://weibo.com/luohanchenyilong/ // https://github.com/ChenYilong // ä»¥ç¬¬ä¸€é¢˜ã€Šé£æ ¼çº é”™é¢˜ã€‹é‡Œçš„ä»£ç ä¸ºä¾‹ typedef NS_ENUM(NSIntegerï¼Œ CYLSex) { CYLSexManï¼Œ CYLSexWoman }; @interface CYLUser : NSObject @property (nonatomicï¼Œ readonlyï¼Œ copy) NSString *name; @property (nonatomicï¼Œ readonlyï¼Œ assign) NSUInteger age; @property (nonatomicï¼Œ readonlyï¼Œ assign) CYLSex sex; - (instancetype)initWithName:(NSString *)name age:(NSUInteger)age sex:(CYLSex)sex; + (instancetype)userWithName:(NSString *)name age:(NSUInteger)age sex:(CYLSex)sex; - (void)addFriend:(CYLUser *)user; - (void)removeFriend:(CYLUser *)user; @end // .mæ–‡ä»¶ // http://weibo.com/luohanchenyilong/ // https://github.com/ChenYilong // @implementation CYLUser { NSMutableSet *_friends; } - (void)setName:(NSString *)name { _name = [name copy]; } - (instancetype)initWithName:(NSString *)name age:(NSUInteger)age sex:(CYLSex)sex { if(self = [super init]) { _name = [name copy]; _age = age; _sex = sex; _friends = [[NSMutableSet alloc] init]; } return self; } - (void)addFriend:(CYLUser *)user { [_friends addObject:user]; } - (void)removeFriend:(CYLUser *)user { [_friends removeObject:user]; } - (id)copyWithZone:(NSZone *)zone { CYLUser *copy = [[[self class] allocWithZone:zone] initWithName:_name age:_age sex:_sex]; copy->_friends = [_friends mutableCopy]; return copy; } - (id)deepCopy { CYLUser *copy = [[[self class] alloc] initWithName:_name age:_age sex:_sex]; copy->_friends = [[NSMutableSet alloc] initWithSet:_friends copyItems:YES]; return copy; } @end è‡³äºå¦‚ä½•é‡å†™å¸¦ copy å…³é”®å­—çš„ setterè¿™ä¸ªé—®é¢˜ï¼Œ å¦‚æœæŠ›å¼€æœ¬ä¾‹æ¥å›ç­”çš„è¯ï¼Œå¦‚ä¸‹ï¼š - (void)setName:(NSString *)name { //[_name release]; _name = [name copy]; } é‚£å¦‚ä½•ç¡®ä¿ name è¢« copyï¼Ÿåœ¨åˆå§‹åŒ–æ–¹æ³•(initializer)ä¸­åšï¼š - (instancetype)initWithName:(NSString *)name age:(NSUInteger)age sex:(CYLSex)sex { if(self = [super init]) { _name = [name copy]; _age = age; _sex = sex; _friends = [[NSMutableSet alloc] init]; } return self; } 6. @property çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿivarã€getterã€setter æ˜¯å¦‚ä½•ç”Ÿæˆå¹¶æ·»åŠ åˆ°è¿™ä¸ªç±»ä¸­çš„ @property çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ @property = ivar + getter + setter; ä¸‹é¢è§£é‡Šä¸‹ï¼š â€œå±æ€§â€ (property)æœ‰ä¸¤å¤§æ¦‚å¿µï¼šivarï¼ˆå®ä¾‹å˜é‡ï¼‰ã€å­˜å–æ–¹æ³•ï¼ˆaccess method ï¼ getter + setterï¼‰ã€‚ â€œå±æ€§â€ (property)ä½œä¸º Objective-C çš„ä¸€é¡¹ç‰¹æ€§ï¼Œä¸»è¦çš„ä½œç”¨å°±åœ¨äºå°è£…å¯¹è±¡ä¸­çš„æ•°æ®ã€‚ Objective-C å¯¹è±¡é€šå¸¸ä¼šæŠŠå…¶æ‰€éœ€è¦çš„æ•°æ®ä¿å­˜ä¸ºå„ç§å®ä¾‹å˜é‡ã€‚å®ä¾‹å˜é‡ä¸€èˆ¬é€šè¿‡â€œå­˜å–æ–¹æ³•â€(access method)æ¥è®¿é—®ã€‚å…¶ä¸­ï¼Œâ€œè·å–æ–¹æ³•â€ (getter)ç”¨äºè¯»å–å˜é‡å€¼ï¼Œè€Œâ€œè®¾ç½®æ–¹æ³•â€ (setter)ç”¨äºå†™å…¥å˜é‡å€¼ã€‚è¿™ä¸ªæ¦‚å¿µå·²ç»å®šå‹ï¼Œå¹¶ä¸”ç»ç”±â€œå±æ€§â€è¿™ä¸€ç‰¹æ€§è€Œæˆä¸º Objective-C 2.0 çš„ä¸€éƒ¨åˆ†ã€‚ è€Œåœ¨æ­£è§„çš„ Objective-C ç¼–ç é£æ ¼ä¸­ï¼Œå­˜å–æ–¹æ³•æœ‰ç€ä¸¥æ ¼çš„å‘½åè§„èŒƒã€‚ æ­£å› ä¸ºæœ‰äº†è¿™ç§ä¸¥æ ¼çš„å‘½åè§„èŒƒï¼Œæ‰€ä»¥ Objective-C è¿™é—¨è¯­è¨€æ‰èƒ½æ ¹æ®åç§°è‡ªåŠ¨åˆ›å»ºå‡ºå­˜å–æ–¹æ³•ã€‚å…¶å®ä¹Ÿå¯ä»¥æŠŠå±æ€§å½“åšä¸€ç§å…³é”®å­—ï¼Œå…¶è¡¨ç¤º: ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å†™å‡ºä¸€å¥—å­˜å–æ–¹æ³•ï¼Œç”¨ä»¥è®¿é—®ç»™å®šç±»å‹ä¸­å…·æœ‰ç»™å®šåç§°çš„å˜é‡ã€‚ æ‰€ä»¥ä½ ä¹Ÿå¯ä»¥è¿™ä¹ˆè¯´ï¼š @property = getter + setter; ä¾‹å¦‚ä¸‹é¢è¿™ä¸ªç±»ï¼š @interface Person : NSObject @property NSString *firstName; @property NSString *lastName; @end ä¸Šè¿°ä»£ç å†™å‡ºæ¥çš„ç±»ä¸ä¸‹é¢è¿™ç§å†™æ³•ç­‰æ•ˆ @interface Person : NSObject - (NSString *)firstName; - (void)setFirstName:(NSString *)firstName; - (NSString *)lastName; - (void)setLastName:(NSString *)lastName; @end æºç åˆ†æ propertyåœ¨runtimeä¸­æ˜¯ objc_property_t å®šä¹‰å¦‚ä¸‹: typedef struct objc_property *objc_property_t; è€Œ objc_property æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼ŒåŒ…æ‹¬nameå’Œattributesï¼Œå®šä¹‰å¦‚ä¸‹ï¼š struct property_t { const char *name; const char *attributes; }; è€Œattributesæœ¬è´¨æ˜¯ objc_property_attribute_tï¼Œå®šä¹‰äº†propertyçš„ä¸€äº›å±æ€§ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š /// Defines a property attribute typedef struct { const char *name; /** è€Œattributesçš„å…·ä½“å†…å®¹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå…¶å®ï¼ŒåŒ…æ‹¬ï¼šç±»å‹ï¼ŒåŸå­æ€§ï¼Œå†…å­˜è¯­ä¹‰å’Œå¯¹åº”çš„å®ä¾‹å˜é‡ã€‚ ä¾‹å¦‚ï¼šæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªstringçš„property@property (nonatomicï¼Œ copy) NSString *string;ï¼Œé€šè¿‡ property_getAttributes(property)è·å–åˆ°attributeså¹¶æ‰“å°å‡ºæ¥ä¹‹åçš„ç»“æœä¸ºT@\"NSString\"ï¼ŒCï¼ŒNï¼ŒV_string å…¶ä¸­Tå°±ä»£è¡¨ç±»å‹ï¼Œå¯å‚é˜…Type Encodingsï¼ŒCå°±ä»£è¡¨Copyï¼ŒNä»£è¡¨nonatomicï¼ŒVå°±ä»£è¡¨å¯¹åº”çš„å®ä¾‹å˜é‡ã€‚ ivarã€getterã€setter æ˜¯å¦‚ä½•ç”Ÿæˆå¹¶æ·»åŠ åˆ°è¿™ä¸ªç±»ä¸­çš„? â€œè‡ªåŠ¨åˆæˆâ€( autosynthesis) å®Œæˆå±æ€§å®šä¹‰åï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç¼–å†™è®¿é—®è¿™äº›å±æ€§æ‰€éœ€çš„æ–¹æ³•ï¼Œæ­¤è¿‡ç¨‹å«åšâ€œè‡ªåŠ¨åˆæˆâ€(autosynthesis)ã€‚éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œè¿™ä¸ªè¿‡ç¨‹ç”±ç¼–è¯‘ å™¨åœ¨ç¼–è¯‘æœŸæ‰§è¡Œï¼Œæ‰€ä»¥ç¼–è¾‘å™¨é‡Œçœ‹ä¸åˆ°è¿™äº›â€œåˆæˆæ–¹æ³•â€(synthesized method)çš„æºä»£ç ã€‚é™¤äº†ç”Ÿæˆæ–¹æ³•ä»£ç  getterã€setter ä¹‹å¤–ï¼Œç¼–è¯‘å™¨è¿˜è¦è‡ªåŠ¨å‘ç±»ä¸­æ·»åŠ é€‚å½“ç±»å‹çš„å®ä¾‹å˜é‡ï¼Œå¹¶ä¸”åœ¨å±æ€§åå‰é¢åŠ ä¸‹åˆ’çº¿ï¼Œä»¥æ­¤ä½œä¸ºå®ä¾‹å˜é‡çš„åå­—ã€‚åœ¨å‰ä¾‹ä¸­ï¼Œä¼šç”Ÿæˆä¸¤ä¸ªå®ä¾‹å˜é‡ï¼Œå…¶åç§°åˆ†åˆ«ä¸º _firstName ä¸ _lastNameã€‚ä¹Ÿå¯ä»¥åœ¨ç±»çš„å®ç°ä»£ç é‡Œé€šè¿‡ @synthesize è¯­æ³•æ¥æŒ‡å®šå®ä¾‹å˜é‡çš„åå­—. @implementation Person @synthesize firstName = _myFirstName; @synthesize lastName = _myLastName; @end æˆ‘ä¸ºäº†ææ¸…å±æ€§æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œæ›¾ç»åç¼–è¯‘è¿‡ç›¸å…³çš„ä»£ç ï¼Œä»–å¤§è‡´ç”Ÿæˆäº†äº”ä¸ªä¸œè¥¿ OBJCIVAR$ç±»å$å±æ€§åç§° ï¼šè¯¥å±æ€§çš„â€œåç§»é‡â€ (offset)ï¼Œè¿™ä¸ªåç§»é‡æ˜¯â€œç¡¬ç¼–ç â€ (hardcode)ï¼Œè¡¨ç¤ºè¯¥å˜é‡è·ç¦»å­˜æ”¾å¯¹è±¡çš„å†…å­˜åŒºåŸŸçš„èµ·å§‹åœ°å€æœ‰å¤šè¿œã€‚ setter ä¸ getter æ–¹æ³•å¯¹åº”çš„å®ç°å‡½æ•° ivar_list ï¼šæˆå‘˜å˜é‡åˆ—è¡¨ method_list ï¼šæ–¹æ³•åˆ—è¡¨ prop_list ï¼šå±æ€§åˆ—è¡¨ ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ¯æ¬¡åœ¨å¢åŠ ä¸€ä¸ªå±æ€§ï¼Œç³»ç»Ÿéƒ½ä¼šåœ¨ ivar_list ä¸­æ·»åŠ ä¸€ä¸ªæˆå‘˜å˜é‡çš„æè¿°ï¼Œåœ¨ method_list ä¸­å¢åŠ  setter ä¸ getter æ–¹æ³•çš„æè¿°ï¼Œåœ¨å±æ€§åˆ—è¡¨ä¸­å¢åŠ ä¸€ä¸ªå±æ€§çš„æè¿°ï¼Œç„¶åè®¡ç®—è¯¥å±æ€§åœ¨å¯¹è±¡ä¸­çš„åç§»é‡ï¼Œç„¶åç»™å‡º setter ä¸ getter æ–¹æ³•å¯¹åº”çš„å®ç°ï¼Œåœ¨ setter æ–¹æ³•ä¸­ä»åç§»é‡çš„ä½ç½®å¼€å§‹èµ‹å€¼ï¼Œåœ¨ getter æ–¹æ³•ä¸­ä»åç§»é‡å¼€å§‹å–å€¼ï¼Œä¸ºäº†èƒ½å¤Ÿè¯»å–æ­£ç¡®å­—èŠ‚æ•°ï¼Œç³»ç»Ÿå¯¹è±¡åç§»é‡çš„æŒ‡é’ˆç±»å‹è¿›è¡Œäº†ç±»å‹å¼ºè½¬ã€‚ 7. @protocol å’Œ category ä¸­å¦‚ä½•ä½¿ç”¨ @property åœ¨ protocol ä¸­ä½¿ç”¨ property åªä¼šç”Ÿæˆ setter å’Œ getter æ–¹æ³•å£°æ˜,æˆ‘ä»¬ä½¿ç”¨å±æ€§çš„ç›®çš„,æ˜¯å¸Œæœ›éµå®ˆæˆ‘åè®®çš„å¯¹è±¡èƒ½å®ç°è¯¥å±æ€§ category ä½¿ç”¨ @property ä¹Ÿæ˜¯åªä¼šç”Ÿæˆ setter å’Œ getter æ–¹æ³•çš„å£°æ˜,å¦‚æœæˆ‘ä»¬çœŸçš„éœ€è¦ç»™ category å¢åŠ å±æ€§çš„å®ç°,éœ€è¦å€ŸåŠ©äºè¿è¡Œæ—¶çš„ä¸¤ä¸ªå‡½æ•°ï¼š objc_setAssociatedObject objc_getAssociatedObject 8. runtime å¦‚ä½•å®ç° weak å±æ€§ è¦å®ç° weak å±æ€§ï¼Œé¦–å…ˆè¦ææ¸…æ¥š weak å±æ€§çš„ç‰¹ç‚¹ï¼š weak æ­¤ç‰¹è´¨è¡¨æ˜è¯¥å±æ€§å®šä¹‰äº†ä¸€ç§â€œéæ‹¥æœ‰å…³ç³»â€ (nonowning relationship)ã€‚ä¸ºè¿™ç§å±æ€§è®¾ç½®æ–°å€¼æ—¶ï¼Œè®¾ç½®æ–¹æ³•æ—¢ä¸ä¿ç•™æ–°å€¼ï¼Œä¹Ÿä¸é‡Šæ”¾æ—§å€¼ã€‚æ­¤ç‰¹è´¨åŒ assign ç±»ä¼¼ï¼Œ ç„¶è€Œåœ¨å±æ€§æ‰€æŒ‡çš„å¯¹è±¡é­åˆ°æ‘§æ¯æ—¶ï¼Œå±æ€§å€¼ä¹Ÿä¼šæ¸…ç©º(nil out)ã€‚ é‚£ä¹ˆ runtime å¦‚ä½•å®ç° weak å˜é‡çš„è‡ªåŠ¨ç½®nilï¼Ÿ runtime å¯¹æ³¨å†Œçš„ç±»ï¼Œ ä¼šè¿›è¡Œå¸ƒå±€ï¼Œå¯¹äº weak å¯¹è±¡ä¼šæ”¾å…¥ä¸€ä¸ª hash è¡¨ä¸­ã€‚ ç”¨ weak æŒ‡å‘çš„å¯¹è±¡å†…å­˜åœ°å€ä½œä¸º keyï¼Œå½“æ­¤å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸º0çš„æ—¶å€™ä¼š deallocï¼Œå‡å¦‚ weak æŒ‡å‘çš„å¯¹è±¡å†…å­˜åœ°å€æ˜¯aï¼Œé‚£ä¹ˆå°±ä¼šä»¥aä¸ºé”®ï¼Œ åœ¨è¿™ä¸ª weak è¡¨ä¸­æœç´¢ï¼Œæ‰¾åˆ°æ‰€æœ‰ä»¥aä¸ºé”®çš„ weak å¯¹è±¡ï¼Œä»è€Œè®¾ç½®ä¸º nilã€‚ 9. @propertyä¸­æœ‰å“ªäº›å±æ€§å…³é”®å­—ï¼Ÿ/ @property åé¢å¯ä»¥æœ‰å“ªäº›ä¿®é¥°ç¬¦ï¼Ÿ åŸå­æ€§--- nonatomic ç‰¹è´¨ è¯»/å†™æƒé™---readwrite(è¯»å†™)ã€readonly (åªè¯») å†…å­˜ç®¡ç†è¯­ä¹‰---assignã€strongã€ weakã€unsafe_unretainedã€copy æ–¹æ³•å---getter= ã€setter= getter=çš„æ ·å¼ï¼š @property (nonatomic, getter=isOn) BOOL on; setter=ä¸€èˆ¬ç”¨åœ¨ç‰¹æ®Šçš„æƒ…å¢ƒä¸‹ï¼Œæ¯”å¦‚ï¼š åœ¨æ•°æ®ååºåˆ—åŒ–ã€è½¬æ¨¡å‹çš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨è¿”å›çš„å­—æ®µå¦‚æœä»¥ init å¼€å¤´ï¼Œæ‰€ä»¥ä½ éœ€è¦å®šä¹‰ä¸€ä¸ª init å¼€å¤´çš„å±æ€§ï¼Œä½†é»˜è®¤ç”Ÿæˆçš„ setter ä¸ getter æ–¹æ³•ä¹Ÿä¼šä»¥ init å¼€å¤´ï¼Œè€Œç¼–è¯‘å™¨ä¼šæŠŠæ‰€æœ‰ä»¥ init å¼€å¤´çš„æ–¹æ³•å½“æˆåˆå§‹åŒ–æ–¹æ³•ï¼Œè€Œåˆå§‹åŒ–æ–¹æ³•åªèƒ½è¿”å› self ç±»å‹ï¼Œå› æ­¤ç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚ è¿™æ—¶ä½ å°±å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼æ¥é¿å…ç¼–è¯‘å™¨æŠ¥é”™ï¼š @property(nonatomic, strong, getter=p_initBy, setter=setP_initBy:)NSString *initBy; å¦å¤–ä¹Ÿå¯ä»¥ç”¨å…³é”®å­—è¿›è¡Œç‰¹æ®Šè¯´æ˜ï¼Œæ¥é¿å…ç¼–è¯‘å™¨æŠ¥é”™ï¼š @property(nonatomic, readwrite, copy, null_resettable) NSString *initBy; - (NSString *)initBy __attribute__((objc_method_family(none))); ä¸å¸¸ç”¨çš„ï¼šnonnull,null_resettable,nullable 10. weakå±æ€§éœ€è¦åœ¨deallocä¸­ç½®nilä¹ˆï¼Ÿ ä¸éœ€è¦ã€‚ åœ¨ARCç¯å¢ƒæ— è®ºæ˜¯å¼ºæŒ‡é’ˆè¿˜æ˜¯å¼±æŒ‡é’ˆéƒ½æ— éœ€åœ¨ dealloc è®¾ç½®ä¸º nil ï¼Œ ARC ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å¤„ç† 11. @synthesizeå’Œ@dynamicåˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ @propertyæœ‰ä¸¤ä¸ªå¯¹åº”çš„è¯ï¼Œä¸€ä¸ªæ˜¯ @synthesizeï¼Œä¸€ä¸ªæ˜¯ @dynamicã€‚å¦‚æœ @synthesizeå’Œ @dynamicéƒ½æ²¡å†™ï¼Œé‚£ä¹ˆé»˜è®¤çš„å°±æ˜¯@syntheszie var = _var; @synthesize çš„è¯­ä¹‰æ˜¯å¦‚æœä½ æ²¡æœ‰æ‰‹åŠ¨å®ç° setter æ–¹æ³•å’Œ getter æ–¹æ³•ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºä½ åŠ ä¸Šè¿™ä¸¤ä¸ªæ–¹æ³•ã€‚ @dynamic å‘Šè¯‰ç¼–è¯‘å™¨ï¼šå±æ€§çš„ setter ä¸ getter æ–¹æ³•ç”±ç”¨æˆ·è‡ªå·±å®ç°ï¼Œä¸è‡ªåŠ¨ç”Ÿæˆã€‚ï¼ˆå½“ç„¶å¯¹äº readonly çš„å±æ€§åªéœ€æä¾› getter å³å¯ï¼‰ã€‚å‡å¦‚ä¸€ä¸ªå±æ€§è¢«å£°æ˜ä¸º @dynamic varï¼Œç„¶åä½ æ²¡æœ‰æä¾› @setteræ–¹æ³•å’Œ @getter æ–¹æ³•ï¼Œç¼–è¯‘çš„æ—¶å€™æ²¡é—®é¢˜ï¼Œä½†æ˜¯å½“ç¨‹åºè¿è¡Œåˆ° instance.var = someVarï¼Œç”±äºç¼º setter æ–¹æ³•ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼›æˆ–è€…å½“è¿è¡Œåˆ° someVar = var æ—¶ï¼Œç”±äºç¼º getter æ–¹æ³•åŒæ ·ä¼šå¯¼è‡´å´©æºƒã€‚ç¼–è¯‘æ—¶æ²¡é—®é¢˜ï¼Œè¿è¡Œæ—¶æ‰æ‰§è¡Œç›¸åº”çš„æ–¹æ³•ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„åŠ¨æ€ç»‘å®šã€‚ 12. ARCä¸‹ï¼Œä¸æ˜¾å¼æŒ‡å®šä»»ä½•å±æ€§å…³é”®å­—æ—¶ï¼Œé»˜è®¤çš„å…³é”®å­—éƒ½æœ‰å“ªäº›ï¼Ÿ å¯¹åº”åŸºæœ¬æ•°æ®ç±»å‹é»˜è®¤å…³é”®å­—æ˜¯ atomic readwrite assign å¯¹äºæ™®é€šçš„ Objective-C å¯¹è±¡ atomic readwrite strong 13. ç”¨@propertyå£°æ˜çš„NSStringï¼ˆæˆ–NSArrayï¼ŒNSDictionaryï¼‰ç»å¸¸ä½¿ç”¨copyå…³é”®å­—ï¼Œä¸ºä»€ä¹ˆï¼Ÿå¦‚æœæ”¹ç”¨strongå…³é”®å­—ï¼Œå¯èƒ½é€ æˆä»€ä¹ˆé—®é¢˜ï¼Ÿ å› ä¸ºçˆ¶ç±»æŒ‡é’ˆå¯ä»¥æŒ‡å‘å­ç±»å¯¹è±¡,ä½¿ç”¨ copy çš„ç›®çš„æ˜¯ä¸ºäº†è®©æœ¬å¯¹è±¡çš„å±æ€§ä¸å—å¤–ç•Œå½±å“,ä½¿ç”¨ copy æ— è®ºç»™æˆ‘ä¼ å…¥æ˜¯ä¸€ä¸ªå¯å˜å¯¹è±¡è¿˜æ˜¯ä¸å¯å¯¹è±¡,æˆ‘æœ¬èº«æŒæœ‰çš„å°±æ˜¯ä¸€ä¸ªä¸å¯å˜çš„å‰¯æœ¬. å¦‚æœæˆ‘ä»¬ä½¿ç”¨æ˜¯ strong ,é‚£ä¹ˆè¿™ä¸ªå±æ€§å°±æœ‰å¯èƒ½æŒ‡å‘ä¸€ä¸ªå¯å˜å¯¹è±¡,å¦‚æœè¿™ä¸ªå¯å˜å¯¹è±¡åœ¨å¤–éƒ¨è¢«ä¿®æ”¹äº†,é‚£ä¹ˆä¼šå½±å“è¯¥å±æ€§. copy æ­¤ç‰¹è´¨æ‰€è¡¨è¾¾çš„æ‰€å±å…³ç³»ä¸ strong ç±»ä¼¼ã€‚ç„¶è€Œè®¾ç½®æ–¹æ³•å¹¶ä¸ä¿ç•™æ–°å€¼ï¼Œè€Œæ˜¯å°†å…¶â€œæ‹·è´â€ (copy)ã€‚ å½“å±æ€§ç±»å‹ä¸º NSString æ—¶ï¼Œç»å¸¸ç”¨æ­¤ç‰¹è´¨æ¥ä¿æŠ¤å…¶å°è£…æ€§ï¼Œå› ä¸ºä¼ é€’ç»™è®¾ç½®æ–¹æ³•çš„æ–°å€¼æœ‰å¯èƒ½æŒ‡å‘ä¸€ä¸ª NSMutableString ç±»çš„å®ä¾‹ã€‚è¿™ä¸ªç±»æ˜¯ NSString çš„å­ç±»ï¼Œè¡¨ç¤ºä¸€ç§å¯ä¿®æ”¹å…¶å€¼çš„å­—ç¬¦ä¸²ï¼Œæ­¤æ—¶è‹¥æ˜¯ä¸æ‹·è´å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè®¾ç½®å®Œå±æ€§ä¹‹åï¼Œå­—ç¬¦ä¸²çš„å€¼å°±å¯èƒ½ä¼šåœ¨å¯¹è±¡ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹é­äººæ›´æ”¹ã€‚æ‰€ä»¥ï¼Œè¿™æ—¶å°±è¦æ‹·è´ä¸€ä»½â€œä¸å¯å˜â€ (immutable)çš„å­—ç¬¦ä¸²ï¼Œç¡®ä¿å¯¹è±¡ä¸­çš„å­—ç¬¦ä¸²å€¼ä¸ä¼šæ— æ„é—´å˜åŠ¨ æˆå®ä¾‹å˜é‡çš„è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿå‡å¦‚propertyåä¸ºfooï¼Œå­˜åœ¨ä¸€ä¸ªåä¸º_fooçš„å®ä¾‹å˜é‡ï¼Œé‚£ä¹ˆè¿˜ä¼šè‡ªåŠ¨åˆæˆæ–°å˜é‡ä¹ˆï¼Ÿ å¦‚æœæŒ‡å®šäº†æˆå‘˜å˜é‡çš„åç§°,ä¼šç”Ÿæˆä¸€ä¸ªæŒ‡å®šçš„åç§°çš„æˆå‘˜å˜é‡ å¦‚æœè¿™ä¸ªæˆå‘˜å·²ç»å­˜åœ¨äº†å°±ä¸å†ç”Ÿæˆäº† å¦‚æœæ˜¯ @synthesize foo; è¿˜ä¼šç”Ÿæˆä¸€ä¸ªåç§°ä¸ºfooçš„æˆå‘˜å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´ å¦‚æœæ²¡æœ‰æŒ‡å®šæˆå‘˜å˜é‡çš„åç§°ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå±æ€§åŒåçš„æˆå‘˜å˜é‡ å¦‚æœæ˜¯ @synthesize foo = _foo; å°±ä¸ä¼šç”Ÿæˆæˆå‘˜å˜é‡äº†ã€‚ 14. åœ¨æœ‰äº†è‡ªåŠ¨åˆæˆå±æ€§å®ä¾‹å˜é‡ä¹‹åï¼Œ@synthesizeè¿˜æœ‰å“ªäº›ä½¿ç”¨åœºæ™¯ï¼Ÿ å›ç­”è¿™ä¸ªé—®é¢˜å‰ï¼Œæˆ‘ä»¬è¦ææ¸…æ¥šä¸€ä¸ªé—®é¢˜ï¼Œä»€ä¹ˆæƒ…å†µä¸‹ä¸ä¼šautosynthesisï¼ˆè‡ªåŠ¨åˆæˆï¼‰ï¼Ÿ 1. åŒæ—¶é‡å†™äº† setter å’Œ getter æ—¶ 2. é‡å†™äº†åªè¯»å±æ€§çš„ getter æ—¶ 3. ä½¿ç”¨äº† @dynamic æ—¶ 4. åœ¨ @protocol ä¸­å®šä¹‰çš„æ‰€æœ‰å±æ€§ 5. åœ¨ category ä¸­å®šä¹‰çš„æ‰€æœ‰å±æ€§ 6. é‡å†™ï¼ˆoverriddenï¼‰çš„å±æ€§ å½“ä½ åœ¨å­ç±»ä¸­é‡å†™ï¼ˆoverriddenï¼‰äº†çˆ¶ç±»ä¸­çš„å±æ€§ï¼Œä½ å¿…é¡» ä½¿ç”¨ @synthesize æ¥æ‰‹åŠ¨åˆæˆivarã€‚ å½“ä½ åŒæ—¶é‡å†™äº† setter å’Œ getter æ—¶ï¼Œç³»ç»Ÿå°±ä¸ä¼šç”Ÿæˆ ivarï¼ˆå®ä¾‹å˜é‡/æˆå‘˜å˜é‡ï¼‰ã€‚è¿™æ—¶å€™æœ‰ä¸¤ç§é€‰æ‹©ï¼š æ‰‹åŠ¨åˆ›å»º ivar ä½¿ç”¨@synthesize foo = _foo; ï¼Œå…³è” @property ä¸ ivarã€‚ 15. objcä¸­å‘ä¸€ä¸ªnilå¯¹è±¡å‘é€æ¶ˆæ¯å°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ åœ¨ Objective-C ä¸­å‘ nil å‘é€æ¶ˆæ¯æ˜¯å®Œå…¨æœ‰æ•ˆçš„â€”â€”åªæ˜¯åœ¨è¿è¡Œæ—¶ä¸ä¼šæœ‰ä»»ä½•ä½œç”¨: å¦‚æœä¸€ä¸ªæ–¹æ³•è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå‘é€ç»™nilçš„æ¶ˆæ¯å°†è¿”å›0(nil)ã€‚ä¾‹å¦‚ï¼š Person * motherInlaw = [[aPerson spouse] mother]; å¦‚æœ spouse å¯¹è±¡ä¸º nilï¼Œé‚£ä¹ˆå‘é€ç»™ nil çš„æ¶ˆæ¯ mother ä¹Ÿå°†è¿”å› nilã€‚ å¦‚æœæ–¹æ³•è¿”å›å€¼ä¸ºæŒ‡é’ˆç±»å‹ï¼Œå…¶æŒ‡é’ˆå¤§å°ä¸ºå°äºæˆ–è€…ç­‰äºsizeof(void*)ï¼Œfloatï¼Œdoubleï¼Œlong double æˆ–è€… long long çš„æ•´å‹æ ‡é‡ï¼Œå‘é€ç»™ nil çš„æ¶ˆæ¯å°†è¿”å›0ã€‚ å¦‚æœæ–¹æ³•è¿”å›å€¼ä¸ºç»“æ„ä½“,å‘é€ç»™ nil çš„æ¶ˆæ¯å°†è¿”å›0ã€‚ç»“æ„ä½“ä¸­å„ä¸ªå­—æ®µçš„å€¼å°†éƒ½æ˜¯0ã€‚ å¦‚æœæ–¹æ³•çš„è¿”å›å€¼ä¸æ˜¯ä¸Šè¿°æåˆ°çš„å‡ ç§æƒ…å†µï¼Œé‚£ä¹ˆå‘é€ç»™ nil çš„æ¶ˆæ¯çš„è¿”å›å€¼å°†æ˜¯æœªå®šä¹‰çš„ã€‚ å…·ä½“åŸå› å¦‚ä¸‹ï¼š objcæ˜¯åŠ¨æ€è¯­è¨€ï¼Œæ¯ä¸ªæ–¹æ³•åœ¨è¿è¡Œæ—¶ä¼šè¢«åŠ¨æ€è½¬ä¸ºæ¶ˆæ¯å‘é€ï¼Œå³ï¼šobjc_msgSend(receiver, selector)ã€‚ objcåœ¨å‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯æ—¶ï¼Œruntimeåº“ä¼šæ ¹æ®å¯¹è±¡çš„isaæŒ‡é’ˆæ‰¾åˆ°è¯¥å¯¹è±¡å®é™…æ‰€å±çš„ç±»ï¼Œç„¶ååœ¨è¯¥ç±»ä¸­çš„æ–¹æ³•åˆ—è¡¨ä»¥åŠå…¶çˆ¶ç±»æ–¹æ³•åˆ—è¡¨ä¸­å¯»æ‰¾æ–¹æ³•è¿è¡Œï¼Œç„¶ååœ¨å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œobjc_msgSendæ–¹æ³•ä¸ä¼šè¿”å›å€¼ï¼Œæ‰€è°“çš„è¿”å›å†…å®¹éƒ½æ˜¯å…·ä½“è°ƒç”¨æ—¶æ‰§è¡Œçš„ã€‚ é‚£ä¹ˆï¼Œå›åˆ°æœ¬é¢˜ï¼Œå¦‚æœå‘ä¸€ä¸ªnilå¯¹è±¡å‘é€æ¶ˆæ¯ï¼Œé¦–å…ˆåœ¨å¯»æ‰¾å¯¹è±¡çš„isaæŒ‡é’ˆæ—¶å°±æ˜¯0åœ°å€è¿”å›äº†ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°ä»»ä½•é”™è¯¯ã€‚ 16. objcä¸­å‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯[obj foo]å’Œobjc_msgSend()å‡½æ•°ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ è¯¥æ–¹æ³•ç¼–è¯‘ä¹‹åå°±æ˜¯objc_msgSend()å‡½æ•°è°ƒç”¨. ((void ()(id, SEL))(void )objc_msgSend)((id)obj, sel_registerName(\"foo\")); 17. ä»€ä¹ˆæ—¶å€™ä¼šæŠ¥unrecognized selectorçš„å¼‚å¸¸ï¼Ÿ ç®€å•æ¥è¯´ï¼š å½“è°ƒç”¨è¯¥å¯¹è±¡ä¸ŠæŸä¸ªæ–¹æ³•,è€Œè¯¥å¯¹è±¡ä¸Šæ²¡æœ‰å®ç°è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œ å¯ä»¥é€šè¿‡â€œæ¶ˆæ¯è½¬å‘â€è¿›è¡Œè§£å†³ã€‚ ç®€å•çš„æµç¨‹å¦‚ä¸‹ï¼Œåœ¨ä¸Šä¸€é¢˜ä¸­ä¹Ÿæåˆ°è¿‡ï¼š objcæ˜¯åŠ¨æ€è¯­è¨€ï¼Œæ¯ä¸ªæ–¹æ³•åœ¨è¿è¡Œæ—¶ä¼šè¢«åŠ¨æ€è½¬ä¸ºæ¶ˆæ¯å‘é€ï¼Œå³ï¼šobjc_msgSend(receiver, selector)ã€‚ objcåœ¨å‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯æ—¶ï¼Œruntimeåº“ä¼šæ ¹æ®å¯¹è±¡çš„isaæŒ‡é’ˆæ‰¾åˆ°è¯¥å¯¹è±¡å®é™…æ‰€å±çš„ç±»ï¼Œç„¶ååœ¨è¯¥ç±»ä¸­çš„æ–¹æ³•åˆ—è¡¨ä»¥åŠå…¶çˆ¶ç±»æ–¹æ³•åˆ—è¡¨ä¸­å¯»æ‰¾æ–¹æ³•è¿è¡Œï¼Œå¦‚æœï¼Œåœ¨æœ€é¡¶å±‚çš„çˆ¶ç±»ä¸­ä¾ç„¶æ‰¾ä¸åˆ°ç›¸åº”çš„æ–¹æ³•æ—¶ï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶ä¼šæŒ‚æ‰å¹¶æŠ›å‡ºå¼‚å¸¸unrecognized selector sent to XXX ã€‚ä½†æ˜¯åœ¨è¿™ä¹‹å‰ï¼Œobjcçš„è¿è¡Œæ—¶ä¼šç»™å‡ºä¸‰æ¬¡æ‹¯æ•‘ç¨‹åºå´©æºƒçš„æœºä¼šï¼š Method resolution objcè¿è¡Œæ—¶ä¼šè°ƒç”¨+resolveInstanceMethod:æˆ–è€… +resolveClassMethod:ï¼Œè®©ä½ æœ‰æœºä¼šæä¾›ä¸€ä¸ªå‡½æ•°å®ç°ã€‚å¦‚æœä½ æ·»åŠ äº†å‡½æ•°ï¼Œé‚£è¿è¡Œæ—¶ç³»ç»Ÿå°±ä¼šé‡æ–°å¯åŠ¨ä¸€æ¬¡æ¶ˆæ¯å‘é€çš„è¿‡ç¨‹ï¼Œå¦åˆ™ ï¼Œè¿è¡Œæ—¶å°±ä¼šç§»åˆ°ä¸‹ä¸€æ­¥ï¼Œæ¶ˆæ¯è½¬å‘ï¼ˆMessage Forwardingï¼‰ã€‚ Fast forwarding å¦‚æœç›®æ ‡å¯¹è±¡å®ç°äº† -forwardingTargetForSelector:ï¼ŒRuntime è¿™æ—¶å°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œç»™ä½ æŠŠè¿™ä¸ªæ¶ˆæ¯è½¬å‘ç»™å…¶ä»–å¯¹è±¡çš„æœºä¼šã€‚ åªè¦è¿™ä¸ªæ–¹æ³•è¿”å›çš„ä¸æ˜¯nilå’Œselfï¼Œæ•´ä¸ªæ¶ˆæ¯å‘é€çš„è¿‡ç¨‹å°±ä¼šè¢«é‡å¯ï¼Œå½“ç„¶å‘é€çš„å¯¹è±¡ä¼šå˜æˆä½ è¿”å›çš„é‚£ä¸ªå¯¹è±¡ã€‚å¦åˆ™ï¼Œå°±ä¼šç»§ç»­Normal Fowardingã€‚ è¿™é‡Œå«Fastï¼Œåªæ˜¯ä¸ºäº†åŒºåˆ«ä¸‹ä¸€æ­¥çš„è½¬å‘æœºåˆ¶ã€‚å› ä¸ºè¿™ä¸€æ­¥ä¸ä¼šåˆ›å»ºä»»ä½•æ–°çš„å¯¹è±¡ï¼Œä½†ä¸‹ä¸€æ­¥è½¬å‘ä¼šåˆ›å»ºä¸€ä¸ªNSInvocationå¯¹è±¡ï¼Œæ‰€ä»¥ç›¸å¯¹æ›´å¿«ç‚¹ã€‚ Normal forwarding è¿™ä¸€æ­¥æ˜¯Runtimeæœ€åä¸€æ¬¡ç»™ä½ æŒ½æ•‘çš„æœºä¼šã€‚é¦–å…ˆå®ƒä¼šå‘é€ -methodSignatureForSelector: æ¶ˆæ¯è·å¾—å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹ã€‚å¦‚æœ -methodSignatureForSelector: è¿”å›nilï¼ŒRuntimeåˆ™ä¼šå‘å‡º -doesNotRecognizeSelector: æ¶ˆæ¯ï¼Œç¨‹åºè¿™æ—¶ä¹Ÿå°±æŒ‚æ‰äº†ã€‚å¦‚æœè¿”å›äº†ä¸€ä¸ªå‡½æ•°ç­¾åï¼ŒRuntimeå°±ä¼šåˆ›å»ºä¸€ä¸ªNSInvocationå¯¹è±¡å¹¶å‘é€ -forwardInvocation: æ¶ˆæ¯ç»™ç›®æ ‡å¯¹è±¡ã€‚ 18. ä¸€ä¸ªobjcå¯¹è±¡å¦‚ä½•è¿›è¡Œå†…å­˜å¸ƒå±€ï¼Ÿï¼ˆè€ƒè™‘æœ‰çˆ¶ç±»çš„æƒ…å†µï¼‰ æ‰€æœ‰çˆ¶ç±»çš„æˆå‘˜å˜é‡å’Œè‡ªå·±çš„æˆå‘˜å˜é‡éƒ½ä¼šå­˜æ”¾åœ¨è¯¥å¯¹è±¡æ‰€å¯¹åº”çš„å­˜å‚¨ç©ºé—´ä¸­. æ¯ä¸€ä¸ªå¯¹è±¡å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªisaæŒ‡é’ˆ,æŒ‡å‘ä»–çš„ç±»å¯¹è±¡,ç±»å¯¹è±¡ä¸­å­˜æ”¾ç€æœ¬å¯¹è±¡çš„ å¯¹è±¡æ–¹æ³•åˆ—è¡¨ï¼ˆå¯¹è±¡èƒ½å¤Ÿæ¥æ”¶çš„æ¶ˆæ¯åˆ—è¡¨ï¼Œä¿å­˜åœ¨å®ƒæ‰€å¯¹åº”çš„ç±»å¯¹è±¡ä¸­ï¼‰ æˆå‘˜å˜é‡çš„åˆ—è¡¨, å±æ€§åˆ—è¡¨ å®ƒå†…éƒ¨ä¹Ÿæœ‰ä¸€ä¸ªisaæŒ‡é’ˆæŒ‡å‘å…ƒå¯¹è±¡(meta class),å…ƒå¯¹è±¡å†…éƒ¨å­˜æ”¾çš„æ˜¯ç±»æ–¹æ³•åˆ—è¡¨,ç±»å¯¹è±¡å†…éƒ¨è¿˜æœ‰ä¸€ä¸ªsuperclassçš„æŒ‡é’ˆ,æŒ‡å‘ä»–çš„çˆ¶ç±»å¯¹è±¡ã€‚ 19. ä¸€ä¸ªobjcå¯¹è±¡çš„isaçš„æŒ‡é’ˆæŒ‡å‘ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ isa é¡¾åæ€ä¹‰ is a è¡¨ç¤ºå¯¹è±¡æ‰€å±çš„ç±»ã€‚ isa æŒ‡å‘ä»–çš„ç±»å¯¹è±¡ï¼Œä»è€Œå¯ä»¥æ‰¾åˆ°å¯¹è±¡ä¸Šçš„æ–¹æ³•ã€‚ åŒä¸€ä¸ªç±»çš„ä¸åŒå¯¹è±¡ï¼Œä»–ä»¬çš„ isa æŒ‡é’ˆæ˜¯ä¸€æ ·çš„ 20. ä¸‹é¢çš„ä»£ç è¾“å‡ºä»€ä¹ˆï¼Ÿ @implementation Son : Father - (id)init { self = [super init]; if (self) { NSLog(@\"%@\", NSStringFromClass([self class])); NSLog(@\"%@\", NSStringFromClass([super class])); } return self; } @end éƒ½è¾“å‡º Son 21. runtimeå¦‚ä½•é€šè¿‡selectoræ‰¾åˆ°å¯¹åº”çš„IMPåœ°å€ï¼Ÿï¼ˆåˆ†åˆ«è€ƒè™‘ç±»æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼‰ æ¯ä¸€ä¸ªç±»å¯¹è±¡ä¸­éƒ½ä¸€ä¸ªæ–¹æ³•åˆ—è¡¨ï¼Œæ–¹æ³•åˆ—è¡¨ä¸­è®°å½•ç€æ–¹æ³•çš„åç§°ã€æ–¹æ³•å®ç°ã€ä»¥åŠå‚æ•°ç±»å‹ï¼Œå…¶å®selector æœ¬è´¨å°±æ˜¯æ–¹æ³•åç§°ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•åç§°å°±å¯ä»¥åœ¨æ–¹æ³•åˆ—è¡¨ä¸­æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•å®ç°ã€‚ å‚è€ƒ NSObject ä¸Šé¢çš„æ–¹æ³•ï¼š - (IMP)methodForSelector:(SEL)aSelector; + (IMP)instanceMethodForSelector:(SEL)aSelector; 22. ä½¿ç”¨runtime Associateæ–¹æ³•å…³è”çš„å¯¹è±¡ï¼Œéœ€è¦åœ¨ä¸»å¯¹è±¡deallocçš„æ—¶å€™é‡Šæ”¾ä¹ˆï¼Ÿ æ— è®ºåœ¨MRCä¸‹è¿˜æ˜¯ARCä¸‹å‡ä¸éœ€è¦ã€‚ 23. objcä¸­çš„ç±»æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•æœ‰ä»€ä¹ˆæœ¬è´¨åŒºåˆ«å’Œè”ç³»ï¼Ÿ ç±»æ–¹æ³•ï¼š ç±»æ–¹æ³•æ˜¯å±äºç±»å¯¹è±¡çš„ ç±»æ–¹æ³•åªèƒ½é€šè¿‡ç±»å¯¹è±¡è°ƒç”¨ ç±»æ–¹æ³•ä¸­çš„selfæ˜¯ç±»å¯¹è±¡ ç±»æ–¹æ³•å¯ä»¥è°ƒç”¨å…¶ä»–çš„ç±»æ–¹æ³• ç±»æ–¹æ³•ä¸­ä¸èƒ½è®¿é—®æˆå‘˜å˜é‡ ç±»æ–¹æ³•ä¸­ä¸èƒ½ç›´æ¥è°ƒç”¨å¯¹è±¡æ–¹æ³• å®ä¾‹æ–¹æ³•ï¼š å®ä¾‹æ–¹æ³•æ˜¯å±äºå®ä¾‹å¯¹è±¡çš„ å®ä¾‹æ–¹æ³•åªèƒ½é€šè¿‡å®ä¾‹å¯¹è±¡è°ƒç”¨ å®ä¾‹æ–¹æ³•ä¸­çš„selfæ˜¯å®ä¾‹å¯¹è±¡ å®ä¾‹æ–¹æ³•ä¸­å¯ä»¥è®¿é—®æˆå‘˜å˜é‡ å®ä¾‹æ–¹æ³•ä¸­ç›´æ¥è°ƒç”¨å®ä¾‹æ–¹æ³• å®ä¾‹æ–¹æ³•ä¸­ä¹Ÿå¯ä»¥è°ƒç”¨ç±»æ–¹æ³•(é€šè¿‡ç±»å) "},"pages/é¢è¯•ç³»åˆ—/02_é¢è¯•é—®é¢˜é›†é”¦.html":{"url":"pages/é¢è¯•ç³»åˆ—/02_é¢è¯•é—®é¢˜é›†é”¦.html","title":"é¢è¯•é—®é¢˜é›†é”¦2","keywords":"","body":"1. _objc_msgForwardå‡½æ•°æ˜¯åšä»€ä¹ˆçš„ï¼Œç›´æ¥è°ƒç”¨å®ƒå°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ _objc_msgForwardæ˜¯ IMP ç±»å‹ï¼Œç”¨äºæ¶ˆæ¯è½¬å‘çš„ï¼šå½“å‘ä¸€ä¸ªå¯¹è±¡å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œä½†å®ƒå¹¶æ²¡æœ‰å®ç°çš„æ—¶å€™ï¼Œ_objc_msgForwardä¼šå°è¯•åšæ¶ˆæ¯è½¬å‘ã€‚ 2. èƒ½å¦å‘ç¼–è¯‘åå¾—åˆ°çš„ç±»ä¸­å¢åŠ å®ä¾‹å˜é‡ï¼Ÿèƒ½å¦å‘è¿è¡Œæ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ å®ä¾‹å˜é‡ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ ä¸èƒ½å‘ç¼–è¯‘åå¾—åˆ°çš„ç±»ä¸­å¢åŠ å®ä¾‹å˜é‡ï¼› èƒ½å‘è¿è¡Œæ—¶åˆ›å»ºçš„ç±»ä¸­æ·»åŠ å®ä¾‹å˜é‡ï¼› è§£é‡Šä¸‹ï¼š å› ä¸ºç¼–è¯‘åçš„ç±»å·²ç»æ³¨å†Œåœ¨ runtime ä¸­ï¼Œç±»ç»“æ„ä½“ä¸­çš„ objc_ivar_list å®ä¾‹å˜é‡çš„é“¾è¡¨ å’Œ instance_size å®ä¾‹å˜é‡çš„å†…å­˜å¤§å°å·²ç»ç¡®å®šï¼ŒåŒæ—¶runtime ä¼šè°ƒç”¨ class_setIvarLayout æˆ– class_setWeakIvarLayout æ¥å¤„ç† strong weak å¼•ç”¨ã€‚æ‰€ä»¥ä¸èƒ½å‘å­˜åœ¨çš„ç±»ä¸­æ·»åŠ å®ä¾‹å˜é‡ï¼› è¿è¡Œæ—¶åˆ›å»ºçš„ç±»æ˜¯å¯ä»¥æ·»åŠ å®ä¾‹å˜é‡ï¼Œè°ƒç”¨ class_addIvar å‡½æ•°ã€‚ä½†æ˜¯å¾—åœ¨è°ƒç”¨ objc_allocateClassPair ä¹‹åï¼Œobjc_registerClassPair ä¹‹å‰ï¼ŒåŸå› åŒä¸Šã€‚ 3. runloopå’Œçº¿ç¨‹æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ æ€»çš„è¯´æ¥ï¼ŒRun loopï¼Œæ­£å¦‚å…¶åï¼Œloopè¡¨ç¤ºæŸç§å¾ªç¯ï¼Œå’Œrunæ”¾åœ¨ä¸€èµ·å°±è¡¨ç¤ºä¸€ç›´åœ¨è¿è¡Œç€çš„å¾ªç¯ã€‚å®é™…ä¸Šï¼Œrun loopå’Œçº¿ç¨‹æ˜¯ç´§å¯†ç›¸è¿çš„ï¼Œå¯ä»¥è¿™æ ·è¯´run loopæ˜¯ä¸ºäº†çº¿ç¨‹è€Œç”Ÿï¼Œæ²¡æœ‰çº¿ç¨‹ï¼Œå®ƒå°±æ²¡æœ‰å­˜åœ¨çš„å¿…è¦ã€‚Run loopsæ˜¯çº¿ç¨‹çš„åŸºç¡€æ¶æ„éƒ¨åˆ†ï¼Œ Cocoa å’Œ CoreFundation éƒ½æä¾›äº† run loop å¯¹è±¡æ–¹ä¾¿é…ç½®å’Œç®¡ç†çº¿ç¨‹çš„ run loop ï¼ˆä»¥ä¸‹éƒ½ä»¥ Cocoa ä¸ºä¾‹ï¼‰ã€‚æ¯ä¸ªçº¿ç¨‹ï¼ŒåŒ…æ‹¬ç¨‹åºçš„ä¸»çº¿ç¨‹ï¼ˆ main thread ï¼‰éƒ½æœ‰ä¸ä¹‹ç›¸åº”çš„ run loop å¯¹è±¡ã€‚ ä¸»çº¿ç¨‹çš„run loopé»˜è®¤æ˜¯å¯åŠ¨çš„ã€‚ iOSçš„åº”ç”¨ç¨‹åºé‡Œé¢ï¼Œç¨‹åºå¯åŠ¨åä¼šæœ‰ä¸€ä¸ªå¦‚ä¸‹çš„main()å‡½æ•° int main(int argc, char * argv[]) { @autoreleasepool { return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class])); } } é‡ç‚¹æ˜¯UIApplicationMain()å‡½æ•°ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šä¸ºmain threadè®¾ç½®ä¸€ä¸ªNSRunLoopå¯¹è±¡ï¼Œè¿™å°±è§£é‡Šäº†ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬çš„åº”ç”¨å¯ä»¥åœ¨æ— äººæ“ä½œçš„æ—¶å€™ä¼‘æ¯ï¼Œéœ€è¦è®©å®ƒå¹²æ´»çš„æ—¶å€™åˆèƒ½ç«‹é©¬å“åº”ã€‚ å¯¹å…¶å®ƒçº¿ç¨‹æ¥è¯´ï¼Œrun loopé»˜è®¤æ˜¯æ²¡æœ‰å¯åŠ¨çš„ï¼Œå¦‚æœä½ éœ€è¦æ›´å¤šçš„çº¿ç¨‹äº¤äº’åˆ™å¯ä»¥æ‰‹åŠ¨é…ç½®å’Œå¯åŠ¨ï¼Œå¦‚æœçº¿ç¨‹åªæ˜¯å»æ‰§è¡Œä¸€ä¸ªé•¿æ—¶é—´çš„å·²ç¡®å®šçš„ä»»åŠ¡åˆ™ä¸éœ€è¦ã€‚ åœ¨ä»»ä½•ä¸€ä¸ª Cocoa ç¨‹åºçš„çº¿ç¨‹ä¸­ï¼Œéƒ½å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç æ¥è·å–åˆ°å½“å‰çº¿ç¨‹çš„ run loop NSRunLoop *runloop = [NSRunLoop currentRunLoop]; 4. runloopçš„modeä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ model ä¸»è¦æ˜¯ç”¨æ¥æŒ‡å®šäº‹ä»¶åœ¨è¿è¡Œå¾ªç¯ä¸­çš„ä¼˜å…ˆçº§çš„ï¼Œåˆ†ä¸ºï¼š NSDefaultRunLoopModeï¼ˆkCFRunLoopDefaultModeï¼‰ï¼šé»˜è®¤ï¼Œç©ºé—²çŠ¶æ€ UITrackingRunLoopModeï¼šScrollViewæ»‘åŠ¨æ—¶ UIInitializationRunLoopModeï¼šå¯åŠ¨æ—¶ NSRunLoopCommonModesï¼ˆkCFRunLoopCommonModesï¼‰ï¼šModeé›†åˆ è‹¹æœå…¬å¼€æä¾›çš„ Mode æœ‰ä¸¤ä¸ªï¼š NSDefaultRunLoopModeï¼ˆkCFRunLoopDefaultModeï¼‰ NSRunLoopCommonModesï¼ˆkCFRunLoopCommonModesï¼‰ 5. ä»¥+ scheduledTimerWithTimeInterval...çš„æ–¹å¼è§¦å‘çš„timerï¼Œåœ¨æ»‘åŠ¨é¡µé¢ä¸Šçš„åˆ—è¡¨æ—¶ï¼Œtimerä¼šæš‚å®šå›è°ƒï¼Œä¸ºä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ RunLoopåªèƒ½è¿è¡Œåœ¨ä¸€ç§modeä¸‹ï¼Œå¦‚æœè¦æ¢modeï¼Œå½“å‰çš„loopä¹Ÿéœ€è¦åœä¸‹é‡å¯æˆæ–°çš„ã€‚åˆ©ç”¨è¿™ä¸ªæœºåˆ¶ï¼ŒScrollViewæ»šåŠ¨è¿‡ç¨‹ä¸­NSDefaultRunLoopModeï¼ˆkCFRunLoopDefaultModeï¼‰çš„modeä¼šåˆ‡æ¢åˆ°UITrackingRunLoopModeæ¥ä¿è¯ScrollViewçš„æµç•…æ»‘åŠ¨ï¼šåªèƒ½åœ¨NSDefaultRunLoopModeæ¨¡å¼ä¸‹å¤„ç†çš„äº‹ä»¶ä¼šå½±å“ScrollViewçš„æ»‘åŠ¨ã€‚ å¦‚æœæˆ‘ä»¬æŠŠä¸€ä¸ªNSTimerå¯¹è±¡ä»¥NSDefaultRunLoopModeï¼ˆkCFRunLoopDefaultModeï¼‰æ·»åŠ åˆ°ä¸»è¿è¡Œå¾ªç¯ä¸­çš„æ—¶å€™, ScrollViewæ»šåŠ¨è¿‡ç¨‹ä¸­ä¼šå› ä¸ºmodeçš„åˆ‡æ¢ï¼Œè€Œå¯¼è‡´NSTimerå°†ä¸å†è¢«è°ƒåº¦ã€‚ åŒæ—¶å› ä¸ºmodeè¿˜æ˜¯å¯å®šåˆ¶çš„ï¼Œæ‰€ä»¥ï¼š Timerè®¡æ—¶ä¼šè¢«scrollViewçš„æ»‘åŠ¨å½±å“çš„é—®é¢˜å¯ä»¥é€šè¿‡å°†timeræ·»åŠ åˆ°NSRunLoopCommonModesï¼ˆkCFRunLoopCommonModesï¼‰æ¥è§£å†³ã€‚ä»£ç å¦‚ä¸‹ï¼š //å°†timeræ·»åŠ åˆ°NSDefaultRunLoopModeä¸­ [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(timerTick:) userInfo:nil repeats:YES]; //ç„¶åå†æ·»åŠ åˆ°NSRunLoopCommonModesé‡Œ NSTimer *timer = [NSTimer timerWithTimeInterval:1.0 target:self selector:@selector(timerTick:) userInfo:nil repeats:YES]; [[NSRunLoop currentRunLoop] addTimer:timer forMode:NSRunLoopCommonModes]; 6. çŒœæƒ³runloopå†…éƒ¨æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ ä¸€èˆ¬æ¥è®²ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œå®Œæˆåçº¿ç¨‹å°±ä¼šé€€å‡ºã€‚å¦‚æœæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæœºåˆ¶ï¼Œè®©çº¿ç¨‹èƒ½éšæ—¶å¤„ç†äº‹ä»¶ä½†å¹¶ä¸é€€å‡ºï¼Œé€šå¸¸çš„ä»£ç é€»è¾‘ æ˜¯è¿™æ ·çš„ï¼š function loop() { initialize(); do { var message = get_next_message(); process_message(message); } while (message != quit); } æˆ–ä½¿ç”¨ä¼ªä»£ç æ¥å±•ç¤ºä¸‹: int main(int argc, char * argv[]) { //ç¨‹åºä¸€ç›´è¿è¡ŒçŠ¶æ€ while (AppIsRunning) { //ç¡çœ çŠ¶æ€ï¼Œç­‰å¾…å”¤é†’äº‹ä»¶ id whoWakesMe = SleepForWakingUp(); //å¾—åˆ°å”¤é†’äº‹ä»¶ id event = GetEvent(whoWakesMe); //å¼€å§‹å¤„ç†äº‹ä»¶ HandleEvent(event); } return 0; } 7. objcä½¿ç”¨ä»€ä¹ˆæœºåˆ¶ç®¡ç†å¯¹è±¡å†…å­˜ï¼Ÿ é€šè¿‡ retainCount çš„æœºåˆ¶æ¥å†³å®šå¯¹è±¡æ˜¯å¦éœ€è¦é‡Šæ”¾ã€‚ æ¯æ¬¡ runloop çš„æ—¶å€™ï¼Œéƒ½ä¼šæ£€æŸ¥å¯¹è±¡çš„ retainCountï¼Œå¦‚æœ retainCount ä¸º 0ï¼Œè¯´æ˜è¯¥å¯¹è±¡æ²¡æœ‰åœ°æ–¹éœ€è¦ç»§ç»­ä½¿ç”¨äº†ï¼Œå¯ä»¥é‡Šæ”¾æ‰äº†ã€‚ 8. ARCé€šè¿‡ä»€ä¹ˆæ–¹å¼å¸®åŠ©å¼€å‘è€…ç®¡ç†å†…å­˜ï¼Ÿ ARCç›¸å¯¹äºMRCï¼Œä¸æ˜¯åœ¨ç¼–è¯‘æ—¶æ·»åŠ retain/release/autoreleaseè¿™ä¹ˆç®€å•ã€‚åº”è¯¥æ˜¯ç¼–è¯‘æœŸå’Œè¿è¡ŒæœŸä¸¤éƒ¨åˆ†å…±åŒå¸®åŠ©å¼€å‘è€…ç®¡ç†å†…å­˜ã€‚ åœ¨ç¼–è¯‘æœŸï¼ŒARCç”¨çš„æ˜¯æ›´åº•å±‚çš„Cæ¥å£å®ç°çš„retain/release/autoreleaseï¼Œè¿™æ ·åšæ€§èƒ½æ›´å¥½ï¼Œä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸èƒ½åœ¨ARCç¯å¢ƒä¸‹æ‰‹åŠ¨retain/release/autoreleaseï¼ŒåŒæ—¶å¯¹åŒä¸€ä¸Šä¸‹æ–‡çš„åŒä¸€å¯¹è±¡çš„æˆå¯¹retain/releaseæ“ä½œè¿›è¡Œä¼˜åŒ–ï¼ˆå³å¿½ç•¥æ‰ä¸å¿…è¦çš„æ“ä½œï¼‰ï¼›ARCä¹ŸåŒ…å«è¿è¡ŒæœŸç»„ä»¶ï¼Œè¿™ä¸ªåœ°æ–¹åšçš„ä¼˜åŒ–æ¯”è¾ƒå¤æ‚ï¼Œä½†ä¹Ÿä¸èƒ½è¢«å¿½ç•¥ã€‚ 8. ä¸æ‰‹åŠ¨æŒ‡å®šautoreleasepoolçš„å‰æä¸‹ï¼Œä¸€ä¸ªautorealeseå¯¹è±¡åœ¨ä»€ä¹ˆæ—¶åˆ»é‡Šæ”¾ï¼Ÿï¼ˆæ¯”å¦‚åœ¨ä¸€ä¸ªvcçš„viewDidLoadä¸­åˆ›å»ºï¼‰ æ‰‹åŠ¨å¹²é¢„é‡Šæ”¾æ—¶æœº--æŒ‡å®š autoreleasepool å°±æ˜¯æ‰€è°“çš„ï¼šå½“å‰ä½œç”¨åŸŸå¤§æ‹¬å·ç»“æŸæ—¶é‡Šæ”¾ã€‚ ç³»ç»Ÿè‡ªåŠ¨å»é‡Šæ”¾--ä¸æ‰‹åŠ¨æŒ‡å®š autoreleasepool Autoreleaseå¯¹è±¡å‡ºäº†ä½œç”¨åŸŸä¹‹åï¼Œä¼šè¢«æ·»åŠ åˆ°æœ€è¿‘ä¸€æ¬¡åˆ›å»ºçš„è‡ªåŠ¨é‡Šæ”¾æ± ä¸­ï¼Œå¹¶ä¼šåœ¨å½“å‰çš„ runloop è¿­ä»£ç»“æŸæ—¶é‡Šæ”¾ã€‚ å¦‚æœåœ¨ä¸€ä¸ªvcçš„viewDidLoadä¸­åˆ›å»ºä¸€ä¸ª Autoreleaseå¯¹è±¡ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡ä¼šåœ¨ viewDidAppear æ–¹æ³•æ‰§è¡Œå‰å°±è¢«é”€æ¯äº†ã€‚ 9. BAD_ACCESSåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å‡ºç°ï¼Ÿ è®¿é—®äº†æ‚¬å‚æŒ‡é’ˆï¼Œæ¯”å¦‚å¯¹ä¸€ä¸ªå·²ç»é‡Šæ”¾çš„å¯¹è±¡æ‰§è¡Œäº†releaseã€è®¿é—®å·²ç»é‡Šæ”¾å¯¹è±¡çš„æˆå‘˜å˜é‡æˆ–è€…å‘æ¶ˆæ¯ã€‚ æ­»å¾ªç¯ 10. è‹¹æœæ˜¯å¦‚ä½•å®ç°autoreleasepoolçš„ï¼Ÿ autoreleasepool ä»¥ä¸€ä¸ªé˜Ÿåˆ—æ•°ç»„çš„å½¢å¼å®ç°,ä¸»è¦é€šè¿‡ä¸‹åˆ—ä¸‰ä¸ªå‡½æ•°å®Œæˆ. objc_autoreleasepoolPush objc_autoreleasepoolPop objc_autorelease çœ‹å‡½æ•°åå°±å¯ä»¥çŸ¥é“ï¼Œå¯¹ autorelease åˆ†åˆ«æ‰§è¡Œ pushï¼Œå’Œ pop æ“ä½œã€‚é”€æ¯å¯¹è±¡æ—¶æ‰§è¡Œreleaseæ“ä½œã€‚ 11. ä½¿ç”¨blockæ—¶ä»€ä¹ˆæƒ…å†µä¼šå‘ç”Ÿå¼•ç”¨å¾ªç¯ï¼Œå¦‚ä½•è§£å†³ï¼Ÿ ä¸€ä¸ªå¯¹è±¡ä¸­å¼ºå¼•ç”¨äº† blockï¼Œåœ¨ block ä¸­åˆå¼ºå¼•ç”¨äº†è¯¥å¯¹è±¡ï¼Œå°±ä¼šå‘ç”Ÿå¾ªç¯å¼•ç”¨ã€‚ ARC ä¸‹çš„è§£å†³æ–¹æ³•æ˜¯ï¼š å°†è¯¥å¯¹è±¡ä½¿ç”¨ weak ä¿®é¥°ç¬¦ä¿®é¥°ä¹‹åå†åœ¨ block ä¸­ä½¿ç”¨ã€‚ id weak weakSelf = self; æˆ–è€… weak typeof(&*self)weakSelf = self è¯¥æ–¹æ³•å¯ä»¥è®¾ç½®å® __weak ï¼šä¸ä¼šäº§ç”Ÿå¼ºå¼•ç”¨ï¼ŒæŒ‡å‘çš„å¯¹è±¡é”€æ¯æ—¶ï¼Œä¼šè‡ªåŠ¨è®©æŒ‡é’ˆç½®ä¸º ni1 ä½¿ç”¨ unsafe_unretained å…³é”®å­—ï¼Œç”¨æ³•ä¸ __weak ä¸€è‡´ã€‚ unsafe_unretained ä¸ä¼šäº§ç”Ÿå¼ºå¼•ç”¨ï¼Œä¸å®‰å…¨ï¼ŒæŒ‡å‘çš„å¯¹è±¡é”€æ¯æ—¶ï¼ŒæŒ‡é’ˆå­˜å‚¨çš„åœ°å€å€¼ä¸å˜ã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨ block æ¥è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œç”¨æ³•ä¸ºï¼š block id weakSelf = self;ï¼Œä½†ä¸æ¨èä½¿ç”¨ã€‚å› ä¸ºå¿…é¡»è¦è°ƒç”¨è¯¥ block æ–¹æ¡ˆæ‰èƒ½ç”Ÿæ•ˆï¼Œå› ä¸ºéœ€è¦åŠæ—¶çš„å°† __block å˜é‡ç½®ä¸º niiã€‚ 12. åœ¨blockå†…å¦‚ä½•ä¿®æ”¹blockå¤–éƒ¨å˜é‡ï¼Ÿ å…ˆæè¿°ä¸‹é—®é¢˜ï¼š é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨blockä¸­è®¿é—®çš„å¤–éƒ¨å˜é‡æ˜¯å¤åˆ¶è¿‡å»çš„ï¼Œå³ï¼šå†™æ“ä½œä¸å¯¹åŸå˜é‡ç”Ÿæ•ˆã€‚ä½†æ˜¯ä½ å¯ä»¥åŠ ä¸Š __block æ¥è®©å…¶å†™æ“ä½œç”Ÿæ•ˆï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹: __block int a = 0; void (^foo)(void) = ^{ a = 1; }; foo(); //è¿™é‡Œï¼Œaçš„å€¼è¢«ä¿®æ”¹ä¸º1 \"å°† auto ä»æ ˆ copy åˆ°å †\" â€œå°† auto å˜é‡å°è£…ä¸ºç»“æ„ä½“(å¯¹è±¡)â€ 13. ä½¿ç”¨ç³»ç»Ÿçš„æŸäº›block apiï¼ˆå¦‚UIViewçš„blockç‰ˆæœ¬å†™åŠ¨ç”»æ—¶ï¼‰ï¼Œæ˜¯å¦ä¹Ÿè€ƒè™‘å¼•ç”¨å¾ªç¯é—®é¢˜ï¼Ÿ 14. GCDçš„é˜Ÿåˆ—ï¼ˆdispatch_queue_tï¼‰åˆ†å“ªä¸¤ç§ç±»å‹ ä¸²è¡Œé˜Ÿåˆ—Serial Dispatch Queue å¹¶å‘é˜Ÿåˆ—Concurrent Dispatch Queue 15. å¦‚ä½•ç”¨GCDåŒæ­¥è‹¥å¹²ä¸ªå¼‚æ­¥è°ƒç”¨ï¼Ÿï¼ˆå¦‚æ ¹æ®è‹¥å¹²ä¸ªurlå¼‚æ­¥åŠ è½½å¤šå¼ å›¾ç‰‡ï¼Œç„¶ååœ¨éƒ½ä¸‹è½½å®Œæˆååˆæˆä¸€å¼ æ•´å›¾ï¼‰ ä½¿ç”¨Dispatch Groupè¿½åŠ blockåˆ°Global Group Queue,è¿™äº›blockå¦‚æœå…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼Œå°±ä¼šæ‰§è¡ŒMain Dispatch Queueä¸­çš„ç»“æŸå¤„ç†çš„blockã€‚ 16. dispatch_barrier_asyncçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ åœ¨å¹¶å‘é˜Ÿåˆ—ä¸­ï¼Œä¸ºäº†ä¿æŒæŸäº›ä»»åŠ¡çš„é¡ºåºï¼Œéœ€è¦ç­‰å¾…ä¸€äº›ä»»åŠ¡å®Œæˆåæ‰èƒ½ç»§ç»­è¿›è¡Œï¼Œä½¿ç”¨ barrier æ¥ç­‰å¾…ä¹‹å‰ä»»åŠ¡å®Œæˆï¼Œé¿å…æ•°æ®ç«äº‰ç­‰é—®é¢˜ã€‚ dispatch_barrier_async å‡½æ•°ä¼šç­‰å¾…è¿½åŠ åˆ°Concurrent Dispatch Queueå¹¶å‘é˜Ÿåˆ—ä¸­çš„æ“ä½œå…¨éƒ¨æ‰§è¡Œå®Œä¹‹åï¼Œç„¶åå†æ‰§è¡Œ dispatch_barrier_async å‡½æ•°è¿½åŠ çš„å¤„ç†ï¼Œç­‰ dispatch_barrier_async è¿½åŠ çš„å¤„ç†æ‰§è¡Œç»“æŸä¹‹åï¼ŒConcurrent Dispatch Queueæ‰æ¢å¤ä¹‹å‰çš„åŠ¨ä½œç»§ç»­æ‰§è¡Œã€‚ æ‰“ä¸ªæ¯”æ–¹ï¼šæ¯”å¦‚ä½ ä»¬å…¬å¸å‘¨æœ«è·Ÿå›¢æ—…æ¸¸ï¼Œé«˜é€Ÿä¼‘æ¯ç«™ä¸Šï¼Œå¸æœºè¯´ï¼šå¤§å®¶éƒ½å»ä¸Šå•æ‰€ï¼Œé€Ÿæˆ˜é€Ÿå†³ï¼Œä¸Šå®Œå•æ‰€å°±ä¸Šé«˜é€Ÿã€‚è¶…å¤§çš„å…¬å…±å•æ‰€ï¼Œå¤§å®¶åŒæ—¶å»ï¼Œç¨‹åºçŒ¿å¾ˆå¿«å°±ç»“æŸäº†ï¼Œä½†ç¨‹åºåª›å°±å¯èƒ½ä¼šæ…¢ä¸€äº›ï¼Œå³ä½¿ä½ ç¬¬ä¸€ä¸ªå›æ¥ï¼Œå¸æœºä¹Ÿä¸ä¼šå‡ºå‘ï¼Œå¸æœºè¦ç­‰å¾…æ‰€æœ‰äººéƒ½å›æ¥åï¼Œæ‰èƒ½å‡ºå‘ã€‚ dispatch_barrier_async å‡½æ•°è¿½åŠ çš„å†…å®¹å°±å¦‚åŒ â€œä¸Šå®Œå•æ‰€å°±ä¸Šé«˜é€Ÿâ€è¿™ä¸ªåŠ¨ä½œã€‚ ï¼ˆæ³¨æ„ï¼šä½¿ç”¨ dispatch_barrier_async ï¼Œè¯¥å‡½æ•°åªèƒ½æ­é…è‡ªå®šä¹‰å¹¶å‘é˜Ÿåˆ— dispatch_queue_t ä½¿ç”¨ã€‚ä¸èƒ½ä½¿ç”¨ï¼š dispatch_get_global_queue ï¼Œå¦åˆ™ dispatch_barrier_async çš„ä½œç”¨ä¼šå’Œ dispatch_async çš„ä½œç”¨ä¸€æ¨¡ä¸€æ ·ã€‚ ï¼‰ 17. è‹¹æœä¸ºä»€ä¹ˆè¦åºŸå¼ƒdispatch_get_current_queueï¼Ÿ dispatch_get_current_queueå‡½æ•°çš„è¡Œä¸ºå¸¸å¸¸ä¸å¼€å‘è€…æ‰€é¢„æœŸçš„ä¸åŒã€‚ ç”±äºæ´¾å‘é˜Ÿåˆ—æ˜¯æŒ‰å±‚çº§æ¥ç»„ç»‡çš„ï¼Œè¿™æ„å‘³ç€æ’åœ¨æŸæ¡é˜Ÿåˆ—ä¸­çš„å—ä¼šåœ¨å…¶ä¸Šçº§é˜Ÿåˆ—é‡Œæ‰§è¡Œã€‚ é˜Ÿåˆ—é—´çš„å±‚çº§å…³ç³»ä¼šå¯¼è‡´æ£€æŸ¥å½“å‰é˜Ÿåˆ—æ˜¯å¦ä¸ºæ‰§è¡ŒåŒæ­¥æ´¾å‘æ‰€ç”¨çš„é˜Ÿåˆ—è¿™ç§æ–¹æ³•å¹¶ä¸æ€»æ˜¯å¥æ•ˆã€‚dispatch_get_current_queueå‡½æ•°é€šå¸¸ä¼šè¢«ç”¨äºè§£å†³ç”±ä¸å¯ä»¥é‡å…¥çš„ä»£ç æ‰€å¼•å‘çš„æ­»é”ï¼Œç„¶åèƒ½ç”¨æ­¤å‡½æ•°è§£å†³çš„é—®é¢˜ï¼Œé€šå¸¸ä¹Ÿå¯ä»¥ç”¨\"é˜Ÿåˆ—ç‰¹å®šæ•°æ®\"æ¥è§£å†³ã€‚ 18. ä»¥ä¸‹ä»£ç è¿è¡Œç»“æœå¦‚ä½•ï¼Ÿ - (void)viewDidLoad { [super viewDidLoad]; NSLog(@\"1\"); dispatch_sync(dispatch_get_main_queue(), ^{ NSLog(@\"2\"); }); NSLog(@\"3\"); } åªè¾“å‡ºï¼š1 ã€‚å‘ç”Ÿä¸»çº¿ç¨‹é”æ­»ã€‚ 19. å¦‚ä½•æ‰‹åŠ¨è§¦å‘ä¸€ä¸ªvalueçš„KVO æ‰€è°“çš„â€œæ‰‹åŠ¨è§¦å‘â€æ˜¯åŒºåˆ«äºâ€œè‡ªåŠ¨è§¦å‘â€ï¼š è‡ªåŠ¨è§¦å‘æ˜¯æŒ‡ç±»ä¼¼è¿™ç§åœºæ™¯ï¼šåœ¨æ³¨å†Œ KVO ä¹‹å‰è®¾ç½®ä¸€ä¸ªåˆå§‹å€¼ï¼Œæ³¨å†Œä¹‹åï¼Œè®¾ç½®ä¸€ä¸ªä¸ä¸€æ ·çš„å€¼ï¼Œå°±å¯ä»¥è§¦å‘äº†ã€‚ æƒ³çŸ¥é“å¦‚ä½•æ‰‹åŠ¨è§¦å‘ï¼Œå¿…é¡»çŸ¥é“è‡ªåŠ¨è§¦å‘ KVO çš„åŸç†ï¼š é”®å€¼è§‚å¯Ÿé€šçŸ¥ä¾èµ–äº NSObject çš„ä¸¤ä¸ªæ–¹æ³•: willChangeValueForKey: å’Œ didChangevlueForKey: ã€‚åœ¨ä¸€ä¸ªè¢«è§‚å¯Ÿå±æ€§å‘ç”Ÿæ”¹å˜ä¹‹å‰ï¼Œ willChangeValueForKey: ä¸€å®šä¼šè¢«è°ƒç”¨ï¼Œè¿™å°± ä¼šè®°å½•æ—§çš„å€¼ã€‚è€Œå½“æ”¹å˜å‘ç”Ÿåï¼Œ observeValueForKey:ofObject:change:context: ä¼šè¢«è°ƒç”¨ï¼Œç»§è€Œ didChangeValueForKey: ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚å¦‚æœå¯ä»¥æ‰‹åŠ¨å®ç°è¿™äº›è°ƒç”¨ï¼Œå°±å¯ä»¥å®ç°â€œæ‰‹åŠ¨è§¦å‘â€äº†ã€‚ é‚£ä¹ˆâ€œæ‰‹åŠ¨è§¦å‘â€çš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿä¸€èˆ¬æˆ‘ä»¬åªåœ¨å¸Œæœ›èƒ½æ§åˆ¶â€œå›è°ƒçš„è°ƒç”¨æ—¶æœºâ€æ—¶æ‰ä¼šè¿™ä¹ˆåšã€‚ 20. è‹¥ä¸€ä¸ªç±»æœ‰å®ä¾‹å˜é‡ NSString *_foo ï¼Œè°ƒç”¨setValue:forKey:æ—¶ï¼Œå¯ä»¥ä»¥fooè¿˜æ˜¯ _foo ä½œä¸ºkeyï¼Ÿ éƒ½å¯ä»¥ 21. KVCçš„keyPathä¸­çš„é›†åˆè¿ç®—ç¬¦å¦‚ä½•ä½¿ç”¨ï¼Ÿ å¿…é¡»ç”¨åœ¨é›†åˆå¯¹è±¡ä¸Šæˆ–æ™®é€šå¯¹è±¡çš„é›†åˆå±æ€§ä¸Š ç®€å•é›†åˆè¿ç®—ç¬¦æœ‰@avgï¼Œ @count ï¼Œ @max ï¼Œ @min ï¼Œ@sum æ ¼å¼ @\"@sum.age\"æˆ– @\"é›†åˆå±æ€§.@max.age\" 22. KVCå’ŒKVOçš„keyPathä¸€å®šæ˜¯å±æ€§ä¹ˆï¼Ÿ KVC æ”¯æŒå®ä¾‹å˜é‡ï¼ŒKVO åªèƒ½æ‰‹åŠ¨æ”¯æŒæ‰‹åŠ¨è®¾å®šå®ä¾‹å˜é‡çš„KVOå®ç°ç›‘å¬ 23. å¦‚ä½•å…³é—­é»˜è®¤çš„KVOçš„é»˜è®¤å®ç°ï¼Œå¹¶è¿›å…¥è‡ªå®šä¹‰çš„KVOå®ç°ï¼Ÿ ã€Šå¦‚ä½•è‡ªå·±åŠ¨æ‰‹å®ç° KVOã€‹ KVO for manually implemented properties 24. appleç”¨ä»€ä¹ˆæ–¹å¼å®ç°å¯¹ä¸€ä¸ªå¯¹è±¡çš„KVOï¼Ÿ å½“ä½ è§‚å¯Ÿä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä¸€ä¸ªæ–°çš„ç±»ä¼šè¢«åŠ¨æ€åˆ›å»ºã€‚è¿™ä¸ªç±»ç»§æ‰¿è‡ªè¯¥å¯¹è±¡çš„åŸæœ¬çš„ç±»ï¼Œå¹¶é‡å†™äº†è¢«è§‚å¯Ÿå±æ€§çš„ setter æ–¹æ³•ã€‚é‡å†™çš„ setter æ–¹æ³•ä¼šè´Ÿè´£åœ¨è°ƒç”¨åŸ setter æ–¹æ³•ä¹‹å‰å’Œä¹‹åï¼Œé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿå¯¹è±¡ï¼šå€¼çš„æ›´æ”¹ã€‚æœ€åé€šè¿‡ isa æ··å†™ï¼ˆisa-swizzlingï¼‰ æŠŠè¿™ä¸ªå¯¹è±¡çš„ isa æŒ‡é’ˆ ( isa æŒ‡é’ˆå‘Šè¯‰ Runtime ç³»ç»Ÿè¿™ä¸ªå¯¹è±¡çš„ç±»æ˜¯ä»€ä¹ˆ ) æŒ‡å‘è¿™ä¸ªæ–°åˆ›å»ºçš„å­ç±»ï¼Œå¯¹è±¡å°±ç¥å¥‡çš„å˜æˆäº†æ–°åˆ›å»ºçš„å­ç±»çš„å®ä¾‹ 25. IBOutletè¿å‡ºæ¥çš„è§†å›¾å±æ€§ä¸ºä»€ä¹ˆå¯ä»¥è¢«è®¾ç½®æˆweak? Should IBOutlets be strong or weak under ARC? æ–‡ç« å‘Šè¯‰æˆ‘ä»¬ï¼š å› ä¸ºæ—¢ç„¶æœ‰å¤–é“¾é‚£ä¹ˆè§†å›¾åœ¨xibæˆ–è€…storyboardä¸­è‚¯å®šå­˜åœ¨ï¼Œè§†å›¾å·²ç»å¯¹å®ƒæœ‰ä¸€ä¸ªå¼ºå¼•ç”¨äº†ã€‚ ä¸è¿‡è¿™ä¸ªå›ç­”æ¼äº†ä¸ªé‡è¦çŸ¥è¯†ï¼Œä½¿ç”¨storyboardï¼ˆxibä¸è¡Œï¼‰åˆ›å»ºçš„vcï¼Œä¼šæœ‰ä¸€ä¸ªå«_topLevelObjectsToKeepAliveFromStoryboard çš„ç§æœ‰æ•°ç»„å¼ºå¼•ç”¨æ‰€æœ‰ top level çš„å¯¹è±¡ï¼Œæ‰€ä»¥è¿™æ—¶å³ä¾¿outletå£°æ˜æˆweakä¹Ÿæ²¡å…³ç³» 26. IBä¸­User Defined Runtime Attributeså¦‚ä½•ä½¿ç”¨ï¼Ÿ å®ƒèƒ½å¤Ÿé€šè¿‡KVCçš„æ–¹å¼é…ç½®ä¸€äº›ä½ åœ¨interface builder ä¸­ä¸èƒ½é…ç½®çš„å±æ€§ã€‚å½“ä½ å¸Œæœ›åœ¨IBä¸­ä½œå°½å¯èƒ½å¤šå¾—äº‹æƒ…ï¼Œè¿™ä¸ªç‰¹æ€§èƒ½å¤Ÿå¸®åŠ©ä½ ç¼–å†™æ›´åŠ è½»é‡çº§çš„viewcontroller 27. å¦‚ä½•è°ƒè¯•BAD_ACCESSé”™è¯¯ é‡å†™objectçš„respondsToSelectoræ–¹æ³•ï¼Œç°å®å‡ºç°EXEC_BAD_ACCESSå‰è®¿é—®çš„æœ€åä¸€ä¸ªobject é€šè¿‡ Zombie è®¾ç½®å…¨å±€æ–­ç‚¹å¿«é€Ÿå®šä½é—®é¢˜ä»£ç æ‰€åœ¨è¡Œ Xcode 7 å·²ç»é›†æˆäº†BAD_ACCESSæ•è·åŠŸèƒ½ï¼šAddress Sanitizerã€‚ 28. lldbï¼ˆgdbï¼‰å¸¸ç”¨çš„è°ƒè¯•å‘½ä»¤ï¼Ÿ breakpoint è®¾ç½®æ–­ç‚¹å®šä½åˆ°æŸä¸€ä¸ªå‡½æ•° n æ–­ç‚¹æŒ‡é’ˆä¸‹ä¸€æ­¥ poæ‰“å°å¯¹è±¡ "},"pages/é¢è¯•ç³»åˆ—/å–ä¸œè¥¿.html":{"url":"pages/é¢è¯•ç³»åˆ—/å–ä¸œè¥¿.html","title":"å–ä¸œè¥¿","keywords":"","body":"å–ä¸œè¥¿ æµ‹è¯•ä¸€ä¸‹ // åˆå§‹åŒ–æ¯è¡Œæ•°é‡ var row1Count = 3; var row2Count = 5; var row3Count = 7; // è·å–è¡Œå‰©ä½™æ•°é‡ function getRemainCount(rowNum) { switch(parseInt(rowNum)) { case 1: return row1Count; case 2: return row2Count; case 3: return row3Count; default: return 0; } } // æ›´æ–°è¡Œæ•°é‡ // rowNum: ç¬¬å‡ è¡Œï¼ˆ1,2,3ï¼‰ // getCount: å–æ•°é‡ function updateRemainCount(rowNum, getCount) { switch(parseInt(rowNum)) { case 1: row1Count -= getCount; break; case 2: row2Count -= getCount; break; case 3: row3Count -= getCount; break; default: break; } }; // åˆ¤æ–­æ˜¯å¦å–å®Œæ‰€æœ‰ function judgeFinish() { return (row1Count + row2Count + row3Count) 0) { if (getCount > remainCount) { return -3;// ç¬¬xè¡Œæ•°é‡ä¸è¶³ } else { // æ›´æ–°è¡Œæ•°é‡ updateRemainCount(rowNum, getCount); // åˆ¤æ–­æ˜¯å¦å–å®Œ if (judgeFinish()) { return -1;// ä½ æ˜¯è¾“å®¶ } return 0;// æˆåŠŸå–å‡º } } else { return -2;// ç¬¬xè¡Œç©º } } // æ‰§è¡Œå›åˆ // getCount: å–æ•°é‡ // rowNum: ç¬¬å‡ è¡Œï¼ˆ1,2,3ï¼‰ function round(rowNum, getCount) { var result = getThing(rowNum, getCount); switch(result) { case 0: alert(\"æˆåŠŸå–å‡º\"); break; case -1: alert(\"ä½ æ˜¯è¾“å®¶\"); break; case -2: alert(\"ç¬¬\"+rowNum+\"è¡Œç©º\"); break; case -3: alert(\"ç¬¬\"+rowNum+\"è¡Œæ•°é‡ä¸è¶³\"); break; default: break; } }; // è¿è¡Œ function run() { var rowNum = prompt(\"å–ç¬¬å‡ è¡Œ:\",\"\"); var getCount = prompt(\"å–å¤šå°‘:\",\"\"); round(rowNum, getCount); } 15ä¸ªä»»æ„ç‰©å“ï¼ˆå¯ä»¥æ˜¯ç«æŸ´ç‰™ç­¾pokerï¼‰ ä»¥ä¸‹æŒ‰ç‰™ç­¾ä¸ºä¾‹ å°†15æ ¹ç‰™ç­¾ åˆ†æˆä¸‰è¡Œ æ¯è¡Œè‡ªä¸Šè€Œä¸‹ï¼ˆå…¶å®æ–¹å‘ä¸é™ï¼‰åˆ†åˆ«æ˜¯3ã€5ã€7æ ¹ å®‰æ’ä¸¤ä¸ªç©å®¶ï¼Œæ¯äººå¯ä»¥åœ¨ä¸€è½®å†…ï¼Œåœ¨ä»»æ„è¡Œæ‹¿ä»»æ„æ ¹ç‰™ç­¾ï¼Œä½†ä¸èƒ½è·¨è¡Œ æ‹¿æœ€åä¸€æ ¹ç‰™ç­¾çš„äººå³ä¸ºè¾“å®¶ é¢˜ç›® è¯·ç”¨ä½ æœ€æ“…é•¿çš„è¯­è¨€ï¼Œä»¥ä½ è§‰å¾—æœ€ä¼˜é›…çš„æ–¹å¼å†™ä¸€ä¸ªç¬¦åˆä»¥ä¸Šæ¸¸æˆè§„åˆ™çš„ç¨‹åºã€‚å®ŒæˆåæŠŠå†™å¥½çš„ä»£ç å’Œç®€å†åŒæ—¶å‘åˆ°ä»¥ä¸‹é‚®ç®±ï¼ˆå¤‡æ³¨å§“å+å²—ä½ï¼‰ï¼Œå¹¶åŠ ä¸Šä¸€æ®µç®€çŸ­çš„æ–‡å­—æè¿°ä¸€ä¸‹ä½ çš„æƒ³æ³• ï¼ˆè¯·ä½¿ç”¨javascriptï¼Œtypescriptæˆ–C#çš„å…¶ä¸­ä¸€ç§è¯­è¨€å®Œæˆæµ‹è¯•é¢˜ï¼‰ "},"pages/é¢è¯•ç³»åˆ—/sizeof.html":{"url":"pages/é¢è¯•ç³»åˆ—/sizeof.html","title":"sizeof","keywords":"","body":"sizeof é¢è¯•å®˜ï¼šå®šä¹‰ä¸€ä¸ªç©ºçš„ç±»å‹ï¼Œé‡Œé¢æ²¡æœ‰ä»»ä½•æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ã€‚å¯¹ è¯¥ç±»å‹æ±‚sizeofï¼Œå¾—åˆ°çš„ç»“æœæ˜¯å¤šå°‘ï¼Ÿåº”è˜è€…ï¼šç­”æ¡ˆæ˜¯1ã€‚ é¢è¯•å®˜ï¼šä¸ºä»€ä¹ˆä¸æ˜¯0ï¼Ÿåº”è˜è€…ï¼šç©ºç±»å‹çš„å®ä¾‹ä¸­ä¸åŒ…å«ä»»ä½•ä¿¡æ¯ï¼Œæœ¬æ¥æ±‚sizeofåº”è¯¥æ˜¯0ï¼Œä½†æ˜¯å½“æˆ‘ä»¬å£°æ˜è¯¥ç±»å‹çš„å®ä¾‹çš„æ—¶å€™ï¼Œå®ƒå¿…é¡»åœ¨å†…å­˜ä¸­å æœ‰ä¸€å®šçš„ç©ºé—´ï¼Œå¦åˆ™æ— æ³•ä½¿ç”¨è¿™äº›å®ä¾‹ã€‚è‡³äºå ç”¨å¤šå°‘å†…å­˜ï¼Œç”±ç¼–è¯‘å™¨å†³å®šã€‚åœ¨Visual Studioä¸­ï¼Œæ¯ä¸ªç©ºç±»å‹çš„å®ä¾‹å ç”¨1å­—èŠ‚çš„ç©ºé—´ã€‚ é¢è¯•å®˜ï¼šå¦‚æœåœ¨è¯¥ç±»å‹ä¸­æ·»åŠ ä¸€ä¸ªæ„é€ å‡½æ•°å’Œææ„å‡½æ•°ï¼Œå†å¯¹è¯¥ç±»å‹æ±‚sizeof,å¾—åˆ°çš„ç»“æœåˆæ˜¯å¤šå°‘ï¼Ÿåº”è˜è€…ï¼šå’Œå‰é¢ä¸€æ ·ï¼Œè¿˜æ˜¯1ã€‚è°ƒç”¨æ„é€ å‡½æ•°å’Œææ„å‡½æ•°åªéœ€è¦çŸ¥é“å‡½æ•°çš„åœ°å€å³å¯ï¼Œè€Œè¿™äº›å‡½æ•°çš„åœ°å€åªä¸ç±»å‹ç›¸å…³ï¼Œè€Œä¸ç±»å‹çš„å®ä¾‹æ— å…³ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ä¼šå› ä¸ºè¿™ä¸¤ä¸ªå‡½æ•°è€Œåœ¨å®ä¾‹å†…æ·»åŠ ä»»ä½•é¢å¤–çš„ä¿¡æ¯ã€‚ é¢è¯•å®˜ï¼šé‚£å¦‚æœæŠŠææ„å‡½æ•°æ ‡è®°ä¸ºè™šå‡½æ•°å‘¢ï¼Ÿåº”è˜è€…ï¼šC+çš„ç¼–è¯‘å™¨ä¸€æ—¦å‘ç°ä¸€ä¸ªç±»å‹ä¸­æœ‰è™šå‡½æ•°ï¼Œå°±ä¼šä¸ºè¯¥ç±»å‹ç”Ÿæˆè™šå‡½æ•°è¡¨ï¼Œå¹¶åœ¨è¯¥ç±»å‹çš„æ¯ä¸€ä¸ªå®ä¾‹ä¸­æ·»åŠ ä¸€ä¸ªæŒ‡å‘è™šå‡½æ•°è¡¨çš„æŒ‡é’ˆã€‚åœ¨32ä½çš„æœºå™¨ä¸Šï¼Œä¸€ä¸ªæŒ‡é’ˆå 4å­—èŠ‚çš„ç©ºé—´ï¼Œå› æ­¤æ±‚sizeofå¾—åˆ°4ï¼›å¦‚æœæ˜¯64ä½çš„æœºå™¨ï¼Œåˆ™ä¸€ä¸ªæŒ‡é’ˆå 8å­—èŠ‚çš„ç©ºé—´ï¼Œå› æ­¤æ±‚sizeofå¾—åˆ°8ã€‚ æµ‹è¯•ä»£ç ï¼š #include using namespace std; class X { }; class Y: public virtual X { }; class Z: public virtual X { }; class A: public Y, public Z { }; int main() { int x = 0; x = sizeof(X); cout åœ¨Xcodeä¸Šçš„æ‰§è¡Œç»“æœï¼š xï¼š1 yï¼š8 zï¼š8 aï¼š16 å‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/zhuiqiuzhuoyue583/article/details/92846054 "},"pages/é¢è¯•ç³»åˆ—/å¤åˆ¶æ„é€ å‡½æ•°.html":{"url":"pages/é¢è¯•ç³»åˆ—/å¤åˆ¶æ„é€ å‡½æ•°.html","title":"å¤åˆ¶æ„é€ å‡½æ•°","keywords":"","body":"å¤åˆ¶æ„é€ å‡½æ•° æ¯”å¦‚ï¼Œé¢è¯•å®˜é€’ç»™åº”è˜è€…ä¸€å¼ æœ‰å¦‚ä¸‹ä»£ç çš„A4æ‰“å°çº¸è¦æ±‚ä»–åˆ†æç¼–è¯‘è¿è¡Œçš„ç»“æœï¼Œå¹¶æä¾›3ä¸ªé€‰é¡¹ï¼šA.ç¼–è¯‘é”™è¯¯ï¼›B.ç¼–è¯‘æˆåŠŸï¼Œè¿è¡Œæ—¶ç¨‹åºå´©æºƒï¼›C.ç¼–è¯‘è¿è¡Œæ­£å¸¸ï¼Œè¾“å‡º10ã€‚ åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå¤åˆ¶æ„é€ å‡½æ•°A(A other)ä¼ å…¥çš„å‚æ•°æ˜¯Açš„ä¸€ä¸ªå®ä¾‹ã€‚ç”±äºæ˜¯ä¼ å€¼å‚æ•°ï¼Œæˆ‘ä»¬æŠŠå½¢å‚å¤åˆ¶åˆ°å®å‚ä¼šè°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°ã€‚å› æ­¤ï¼Œå¦‚æœå…è®¸å¤åˆ¶æ„é€ å‡½æ•°ä¼ å€¼ï¼Œå°±ä¼šåœ¨å¤åˆ¶æ„é€ å‡½æ•°å†…è°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°ï¼Œå°±ä¼šå½¢æˆæ°¸æ— ä¼‘æ­¢çš„é€’å½’è°ƒç”¨ä»è€Œå¯¼è‡´æ ˆæº¢å‡ºã€‚å› æ­¤ï¼ŒC+çš„æ ‡å‡†ä¸å…è®¸å¤åˆ¶æ„é€ å‡½æ•°ä¼ å€¼å‚æ•°ï¼Œåœ¨Visual Studioå’ŒGCCä¸­ï¼Œéƒ½å°†ç¼–è¯‘å‡ºé”™ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ„é€ å‡½æ•°ä¿®æ”¹ä¸ºA(const A&other),ä¹Ÿå°±æ˜¯æŠŠä¼ å€¼å‚æ•°æ”¹æˆå¸¸é‡å¼•ç”¨ã€‚ "},"pages/é¢è¯•ç³»åˆ—/èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°.html":{"url":"pages/é¢è¯•ç³»åˆ—/èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°.html","title":"èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°","keywords":"","body":"èµ‹å€¼è¿ç®—ç¬¦å‡½æ•° é¢˜ç›®ï¼šå¦‚ä¸‹ä¸ºç±»å‹CMyStringçš„å£°æ˜ï¼Œè¯·ä¸ºè¯¥ç±»å‹æ·»åŠ èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°ã€‚ class CMyString { public: CMyString(char* pData = nullptr); CMyString(const CMyString& str); ~CMyString(void); CMyString& operator = (const CMyString& str); void Print(); private: char* m_pData; }; å½“é¢è¯•å®˜è¦æ±‚åº”è˜è€…å®šä¹‰ä¸€ä¸ªèµ‹å€¼è¿ç®—ç¬¦å‡½æ•°æ—¶ï¼Œä»–ä¼šåœ¨æ£€æŸ¥åº”è˜è€…å†™å‡ºçš„ä»£ç æ—¶å…³æ³¨å¦‚ä¸‹å‡ ç‚¹ï¼š æ˜¯å¦æŠŠè¿”å›å€¼çš„ç±»å‹å£°æ˜ä¸ºè¯¥ç±»å‹çš„å¼•ç”¨ï¼Œå¹¶åœ¨å‡½æ•°ç»“æŸå‰è¿”å›å®ä¾‹è‡ªèº«çš„å¼•ç”¨(*this)ã€‚åªæœ‰è¿”å›ä¸€ä¸ªå¼•ç”¨ï¼Œæ‰å¯ä»¥å…è®¸è¿ç»­èµ‹å€¼ã€‚å¦åˆ™ï¼Œå¦‚æœå‡½æ•°çš„è¿”å›å€¼æ˜¯void,åˆ™åº”ç”¨è¯¥èµ‹å€¼è¿ç®—ç¬¦å°†ä¸èƒ½è¿›è¡Œè¿ç»­èµ‹å€¼ã€‚å‡è®¾æœ‰3ä¸ªCMyStringçš„å¯¹è±¡ï¼šstrlã€str2å’Œstr3,åœ¨ç¨‹åºä¸­è¯­å¥str1=str2=str3å°†ä¸èƒ½é€šè¿‡ç¼–è¯‘ã€‚ æ˜¯å¦æŠŠä¼ å…¥çš„å‚æ•°çš„ç±»å‹å£°æ˜ä¸ºå¸¸é‡å¼•ç”¨ã€‚å¦‚æœä¼ å…¥çš„å‚æ•°ä¸æ˜¯å¼•ç”¨è€Œæ˜¯å®ä¾‹ï¼Œé‚£ä¹ˆä»å½¢å‚åˆ°å®å‚ä¼šè°ƒç”¨ä¸€æ¬¡å¤åˆ¶æ„é€ å‡½æ•°ã€‚æŠŠå‚æ•°å£°æ˜ä¸ºå¼•ç”¨å¯ä»¥é¿å…è¿™æ ·çš„æ— è°“æ¶ˆè€—ï¼Œèƒ½æé«˜ä»£ç çš„æ•ˆç‡ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬åœ¨èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°å†…ä¸ä¼šæ”¹å˜ä¼ å…¥çš„å®ä¾‹çš„çŠ¶æ€ï¼Œå› æ­¤åº”è¯¥ä¸ºä¼ å…¥çš„å¼•ç”¨å‚æ•°åŠ ä¸Šconstå…³é”®å­—ã€‚ æ˜¯å¦é‡Šæ”¾å®ä¾‹è‡ªèº«å·²æœ‰çš„å†…å­˜ã€‚å¦‚æœæˆ‘ä»¬å¿˜è®°åœ¨åˆ†é…æ–°å†…å­˜ä¹‹å‰é‡Šæ”¾è‡ªèº«å·²æœ‰çš„ç©ºé—´ï¼Œåˆ™ç¨‹åºå°†å‡ºç°å†…å­˜æ³„æ¼ã€‚ åˆ¤æ–­ä¼ å…¥çš„å‚æ•°å’Œå½“å‰çš„å®ä¾‹(*this)æ˜¯ä¸æ˜¯åŒä¸€ä¸ªå®ä¾‹ã€‚å¦‚æœæ˜¯åŒä¸€ä¸ªï¼Œåˆ™ä¸è¿›è¡Œèµ‹å€¼æ“ä½œï¼Œç›´æ¥è¿”å›ã€‚å¦‚æœäº‹å…ˆä¸åˆ¤æ–­å°±è¿›è¡Œèµ‹å€¼ï¼Œé‚£ä¹ˆåœ¨é‡Šæ”¾å®ä¾‹è‡ªèº«å†…å­˜çš„æ—¶å€™å°±ä¼šå¯¼è‡´ä¸¥é‡çš„é—®é¢˜ï¼šå½“*thiså’Œä¼ å…¥çš„å‚æ•°æ˜¯åŒä¸€ä¸ªå®ä¾‹æ—¶ï¼Œä¸€æ—¦é‡Šæ”¾äº†è‡ªèº«çš„å†…å­˜ï¼Œä¼ å…¥çš„å‚æ•°çš„å†…å­˜ä¹ŸåŒæ—¶è¢«é‡Šæ”¾äº†ï¼Œå› æ­¤å†ä¹Ÿæ‰¾ä¸åˆ°éœ€è¦èµ‹å€¼çš„å†…å®¹äº†ã€‚ ç»å…¸çš„è§£æ³•ï¼Œé€‚ç”¨äºåˆçº§ç¨‹åºå‘˜ å½“æˆ‘ä»¬å®Œæ•´åœ°è€ƒè™‘äº†ä¸Šè¿°4ä¸ªæ–¹é¢ä¹‹åï¼Œå¯ä»¥å†™å‡ºå¦‚ä¸‹çš„ä»£ç ï¼š CMyString& CMyString::operator = (const CMyString& str) { if(this == &str) return *this; delete []m_pData; m_pData = nullptr; m_pData = new char[strlen(str.m_pData) + 1]; strcpy(m_pData, str.m_pData); return *this; } è€ƒè™‘å¼‚å¸¸å®‰å…¨æ€§çš„è§£æ³•ï¼Œé«˜çº§ç¨‹åºå‘˜å¿…å¤‡ åœ¨å‰é¢çš„å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åœ¨åˆ†é…å†…å­˜ä¹‹å‰å…ˆç”¨deleteé‡Šæ”¾äº†å®ä¾‹m_pDataçš„å†…å­˜ã€‚å¦‚æœæ­¤æ—¶å†…å­˜ä¸è¶³å¯¼è‡´new charæŠ›å‡ºå¼‚å¸¸ï¼Œåˆ™m_pDataå°†æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆï¼Œè¿™æ ·éå¸¸å®¹æ˜“å¯¼è‡´ç¨‹åºå´©æºƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦åœ¨èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°å†…éƒ¨æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼ŒCMyStringçš„å®ä¾‹ä¸å†ä¿æŒæœ‰æ•ˆçš„çŠ¶æ€ï¼Œè¿™å°±è¿èƒŒäº†å¼‚å¸¸å®‰å…¨æ€§(Exception Safety)åŸåˆ™ã€‚ è¦æƒ³åœ¨èµ‹å€¼è¿ç®—ç¬¦å‡½æ•°ä¸­å®ç°å¼‚å¸¸å®‰å…¨æ€§ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•ã€‚ä¸€ç§ç®€å•çš„åŠæ³•æ˜¯æˆ‘ä»¬å…ˆç”¨newåˆ†é…æ–°å†…å®¹ï¼Œå†ç”¨deleteé‡Šæ”¾å·²æœ‰çš„å†…å®¹ã€‚è¿™æ ·åªåœ¨åˆ†é…å†…å®¹æˆåŠŸä¹‹åå†é‡Šæ”¾åŸæ¥çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯å½“åˆ†é…å†…å­˜å¤±è´¥æ—¶æˆ‘ä»¬èƒ½ç¡®ä¿CMyStringçš„å®ä¾‹ä¸ä¼šè¢«ä¿®æ”¹ã€‚æˆ‘ä»¬è¿˜æœ‰ä¸€ç§æ›´å¥½çš„åŠæ³•ï¼Œå³å…ˆåˆ›å»ºä¸€ä¸ªä¸´æ—¶å®ä¾‹ï¼Œå†äº¤æ¢ä¸´æ—¶å®ä¾‹å’ŒåŸæ¥çš„å®ä¾‹ã€‚ä¸‹é¢æ˜¯è¿™ç§æ€è·¯çš„å‚è€ƒä»£ç ï¼š CMyString& CMyString::operator = (const CMyString& str) { if(this != &str) { CMyString strTemp(str); char*pTemp=strTemp.m_pData; strTemp.m_pData=m_pData; m_pData=pTemp; } return *this; } åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªä¸´æ—¶å®ä¾‹strTemp,æ¥ç€æŠŠstrTemp.m_pDataå’Œå®ä¾‹è‡ªèº«çš„m_pDataè¿›è¡Œäº¤æ¢ã€‚ç”±äºstrTempæ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œä½†ç¨‹åºè¿è¡Œåˆ°ifçš„å¤–é¢æ—¶ä¹Ÿå°±å‡ºäº†è¯¥å˜é‡çš„ä½œç”¨åŸŸï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨strTempçš„ææ„å‡½æ•°ï¼ŒæŠŠstrTemp.m_pDataæ‰€æŒ‡å‘çš„å†…å­˜é‡Šæ”¾æ‰ã€‚ç”±äºstrTemp.m_pDataæŒ‡å‘çš„å†…å­˜å°±æ˜¯å®ä¾‹ä¹‹å‰m_pDataçš„å†…å­˜ï¼Œè¿™å°±ç›¸å½“äºè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°é‡Šæ”¾å®ä¾‹çš„å†…å­˜ã€‚ åœ¨æ–°çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨CMyStringçš„æ„é€ å‡½æ•°é‡Œç”¨newåˆ†é…å†…å­˜ã€‚å¦‚æœç”±äºå†…å­˜ä¸è¶³æŠ›å‡ºè¯¸å¦‚bad allocç­‰å¼‚å¸¸ï¼Œä½†æˆ‘ä»¬è¿˜æ²¡æœ‰ä¿®æ”¹åŸæ¥å®ä¾‹çš„çŠ¶æ€ï¼Œå› æ­¤å®ä¾‹çš„çŠ¶æ€è¿˜æ˜¯æœ‰æ•ˆçš„ï¼Œè¿™ä¹Ÿå°±ä¿è¯äº†å¼‚å¸¸å®‰å…¨æ€§ã€‚ æºä»£ç ï¼šhttps://github.com/zhedahht/CodingInterviewChinese2/tree/master/01_AssignmentOperator "},"pages/é¢è¯•ç³»åˆ—/å®ç°Singletonæ¨¡å¼.html":{"url":"pages/é¢è¯•ç³»åˆ—/å®ç°Singletonæ¨¡å¼.html","title":"å®ç°Singletonæ¨¡å¼","keywords":"","body":"å®ç°Singletonæ¨¡å¼ é¢˜ç›®ï¼šè®¾è®¡ä¸€ä¸ªç±»ï¼Œæˆ‘ä»¬åªèƒ½ç”Ÿæˆè¯¥ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼š ä¸å¥½çš„è§£æ³•ä¸€ï¼šåªé€‚ç”¨äºå•çº¿ç¨‹ç¯å¢ƒ ç”±äºè¦æ±‚åªèƒ½ç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»æŠŠæ„é€ å‡½æ•°è®¾ä¸ºç§æœ‰å‡½æ•°ä»¥ç¦æ­¢ä»–äººåˆ›å»ºå®ä¾‹ã€‚æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªé™æ€çš„å®ä¾‹ï¼Œåœ¨éœ€è¦çš„æ—¶å€™åˆ›è¯¥å®ä¾‹ã€‚ä¸‹é¢å®šä¹‰ç±»å‹Singleton1å°±æ˜¯åŸºäºè¿™ä¸ªæ€è·¯çš„å®ç°ï¼š public sealed class Singleton1 { private Singleton1() { } private static Singleton1 instance = null; public static Singleton1 Instance { get { if (instance == null) instance = new Singleton1(); return instance; } } } ä¸Šè¿°ä»£ç åœ¨Singleton1çš„é™æ€å±æ€§instanceä¸­ï¼Œåªæœ‰åœ¨instanceä¸ºçš„æ—¶å€™æ‰åˆ›å»ºä¸ªå®ä¾‹ä»¥é¿å…é‡å¤åˆ›å»ºã€‚åŒæ—¶æˆ‘ä»¬æŠŠæ„é€ å‡½æ•°å®šä¹‰ä¸ºç§æœ‰å‡½æ•°ï¼Œè¿™æ ·å°±èƒ½ç¡®ä¿åªåˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚ ä¸å¥½çš„è§£æ³•äºŒï¼šè™½ç„¶åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­èƒ½å·¥ä½œï¼Œä½†æ•ˆç‡ä¸é«˜ è§£æ³•ä¸€ä¸­çš„ä»£ç åœ¨å•çº¿ç¨‹çš„æ—¶å€™å·¥ä½œæ­£å¸¸ï¼Œä½†åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹å°±æœ‰é—®é¢˜äº†ã€‚è®¾æƒ³å¦‚æœä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œåˆ°åˆ¤æ–­instanceæ˜¯å¦ä¸ºnullçš„ifè¯­å¥ï¼Œå¹¶ä¸”instanceçš„ç¡®æ²¡æœ‰åˆ›å»ºæ—¶ï¼Œé‚£ä¹ˆä¸¤ä¸ªçº¿ç¨‹éƒ½ä¼šåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œæ­¤æ—¶ç±»å‹Singleton1å°±ä¸å†æ»¡è¶³å•ä¾‹æ¨¡å¼çš„è¦æ±‚äº†ã€‚ä¸ºäº†ä¿è¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æˆ‘ä»¬è¿˜æ˜¯åªèƒ½å¾—åˆ°ç±»å‹çš„ä¸€ä¸ªå®ä¾‹ï¼Œéœ€è¦åŠ ä¸Šä¸€ä¸ªåŒæ­¥é”ã€‚æŠŠSingleton1ç¨ä½œä¿®æ”¹å¾—åˆ°äº†å¦‚ä¸‹ä»£ç ï¼š public sealed class Singleton2 { private Singleton2() { } private static readonly object syncObj = new object(); private static Singleton2 instance = null; public static Singleton2 Instance { get { lock (syncObj) { if (instance == null) instance = new Singleton2(); } return instance; } } } æˆ‘ä»¬è¿˜æ˜¯å‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æƒ³åˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚ç”±äºåœ¨ä¸€ä¸ªæ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¾—åˆ°åŒæ­¥é”ï¼Œå½“ç¬¬ä¸€ä¸ªçº¿ç¨‹åŠ ä¸Šé”æ—¶ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹åªèƒ½ç­‰å¾…ã€‚å½“ç¬¬ä¸€ä¸ªçº¿ç¨‹å‘ç°å®ä¾‹è¿˜æ²¡æœ‰åˆ›å»ºæ—¶ï¼Œå®ƒåˆ›å»ºå‡ºä¸€ä¸ªå®ä¾‹ã€‚æ¥ç€ç¬¬ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾åŒæ­¥é”ï¼Œæ­¤æ—¶ç¬¬äºŒä¸ªçº¿ç¨‹å¯ä»¥åŠ ä¸ŠåŒæ­¥é”ï¼Œå¹¶è¿è¡Œæ¥ä¸‹æ¥çš„ä»£ç ã€‚è¿™æ—¶å€™ç”±äºå®ä¾‹å·²ç»è¢«ç¬¬ä¸€ä¸ªçº¿ç¨‹åˆ›å»ºå‡ºæ¥äº†ï¼Œç¬¬äºŒä¸ªçº¿ç¨‹å°±ä¸ä¼šé‡å¤åˆ›å»ºå®ä¾‹äº†ï¼Œè¿™æ ·å°±ä¿è¯äº†æˆ‘ä»¬åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä¹Ÿåªèƒ½å¾—åˆ°ä¸€ä¸ªå®ä¾‹ã€‚ ä½†æ˜¯ç±»å‹Singleton2è¿˜ä¸æ˜¯å¾ˆå®Œç¾ã€‚æˆ‘ä»¬æ¯æ¬¡é€šè¿‡å±æ€§Instanceå¾—åˆ°Singleton2çš„å®ä¾‹ï¼Œéƒ½ä¼šè¯•å›¾åŠ ä¸Šä¸€ä¸ªåŒæ­¥é”ï¼Œè€ŒåŠ é”æ˜¯ä¸€ä¸ªéå¸¸è€—æ—¶çš„æ“ä½œï¼Œåœ¨æ²¡æœ‰å¿…è¦çš„æ—¶å€™æˆ‘ä»¬åº”è¯¥å°½é‡é¿å…ã€‚ å¯è¡Œçš„è§£æ³•ï¼šåŠ åŒæ­¥é”å‰åä¸¤æ¬¡åˆ¤æ–­å®ä¾‹æ˜¯å¦å·²å­˜åœ¨ æˆ‘ä»¬åªæ˜¯åœ¨å®ä¾‹è¿˜æ²¡æœ‰åˆ›å»ºä¹‹å‰éœ€è¦åŠ é”æ“ä½œï¼Œä»¥ä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹åˆ›å»ºå‡ºå®ä¾‹ã€‚è€Œå½“å®ä¾‹å·²ç»åˆ›å»ºä¹‹åï¼Œæˆ‘ä»¬å·²ç»ä¸éœ€è¦å†æ‰§è¡ŒåŠ é”æ“ä½œäº†ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥æŠŠè§£æ³•äºŒä¸­çš„ä»£ç å†åšè¿›ä¸€æ­¥çš„æ”¹è¿›ï¼š public sealed class Singleton3 { private Singleton3() { } private static object syncObj = new object(); private static Singleton3 instance = null; public static Singleton3 Instance { get { if (instance == null) { lock (syncObj) { if (instance == null) instance = new Singleton3(); } } return instance; } } } Singleton3ä¸­åªæœ‰å½“instanceä¸ºnullå³æ²¡æœ‰åˆ›å»ºæ—¶ï¼Œéœ€è¦åŠ é”æ“ä½œã€‚å½“instanceå·²ç»åˆ›å»ºå‡ºæ¥ä¹‹åï¼Œåˆ™æ— é¡»åŠ é”ã€‚å› ä¸ºåªåœ¨ç¬¬ä¸€æ¬¡çš„æ—¶å€™instanceä¸ºnullï¼Œå› æ­¤åªåœ¨ç¬¬ä¸€æ¬¡è¯•å›¾åˆ›å»ºå®ä¾‹çš„æ—¶å€™éœ€è¦åŠ é”ã€‚è¿™æ ·Singleton3çš„æ—¶é—´æ•ˆç‡æ¯”Singleton2è¦å¥½å¾ˆå¤šã€‚ Singleton3ç”¨åŠ é”æœºåˆ¶æ¥ç¡®ä¿åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹åªåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”ç”¨ä¸¤ä¸ªifåˆ¤æ–­æ¥æé«˜æ•ˆç‡ã€‚è¿™æ ·çš„ä»£ç å®ç°èµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œå®¹æ˜“å‡ºé”™ï¼Œæˆ‘ä»¬è¿˜æœ‰æ›´åŠ ä¼˜ç§€çš„è§£æ³•ã€‚ å¼ºçƒˆæ¨èçš„è§£æ³•ä¸€ï¼šåˆ©ç”¨é™æ€æ„é€ å‡½æ•° C#çš„è¯­æ³•ä¸­æœ‰ä¸€ä¸ªå‡½æ•°èƒ½å¤Ÿç¡®ä¿åªè°ƒç”¨ä¸€æ¬¡ï¼Œé‚£å°±æ˜¯é™æ€æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨C#çš„è¿™ä¸ªç‰¹æ€§å®ç°å•ä¾‹æ¨¡å¼ã€‚ public sealed class Singleton4 { private Singleton4() { Console.WriteLine(\"An instance of Singleton4 is created.\"); } public static void Print() { Console.WriteLine(\"Singleton4 Print\"); } private static Singleton4 instance = new Singleton4(); public static Singleton4 Instance { get { return instance; } } } Singleton4çš„å®ç°ä»£ç éå¸¸ç®€æ´ã€‚æˆ‘ä»¬åœ¨åˆå§‹åŒ–é™æ€å˜é‡instanceçš„æ—¶å€™åˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚ç”±äºC#æ˜¯åœ¨è°ƒç”¨é™æ€æ„é€ å‡½æ•°æ—¶åˆå§‹åŒ–é™æ€å˜é‡ï¼Œ.NETè¿è¡Œæ—¶èƒ½å¤Ÿç¡®ä¿åªè°ƒç”¨ä¸€æ¬¡é™æ€æ„é€ å‡½æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å¤Ÿä¿è¯åªåˆå§‹åŒ–ä¸€æ¬¡instanceã€‚ C#ä¸­è°ƒç”¨é™æ€æ„é€ å‡½æ•°çš„æ—¶æœºä¸æ˜¯ç”±ç¨‹åºå‘˜æŒæ§çš„ï¼Œè€Œæ˜¯å½“.NETè¿è¡Œæ—¶å‘ç°ç¬¬ä¸€æ¬¡ä½¿ç”¨ä¸€ä¸ªç±»å‹çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨è¯¥ç±»å‹çš„é™æ€æ„é€ å‡½æ•°ã€‚å› æ­¤åœ¨Singleton4ä¸­ï¼Œå®ä¾‹instanceå¹¶ä¸æ˜¯åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨å±æ€§Singleton4.Instanceçš„æ—¶å€™è¢«åˆ›å»ºçš„ï¼Œè€Œæ˜¯åœ¨ç¬¬ä¸€æ¬¡ç”¨åˆ°Singleton4çš„æ—¶å€™å°±ä¼šè¢«åˆ›å»ºã€‚å‡è®¾æˆ‘ä»¬åœ¨Singleton4ä¸­æ·»åŠ ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè°ƒç”¨è¯¥é™æ€å‡½æ•°æ˜¯ä¸éœ€è¦åˆ›å»ºä¸€ä¸ªå®ä¾‹çš„ï¼Œä½†å¦‚æœæŒ‰ç…§Singleton4çš„æ–¹å¼å®ç°å•ä¾‹æ¨¡å¼ï¼Œåˆ™ä»ç„¶ä¼šè¿‡æ—©åœ°åˆ›å»ºå® ä¾‹ï¼Œä»è€Œé™ä½å†…å­˜çš„ä½¿ç”¨æ•ˆç‡ã€‚ å¼ºçƒˆæ¨èçš„è§£æ³•äºŒï¼šå®ç°æŒ‰éœ€åˆ›å»ºå®ä¾‹ æœ€åä¸€ä¸ªå®ç°Singleton5åˆ™å¾ˆå¥½åœ°è§£å†³äº†Singleton4ä¸­çš„å®ä¾‹åˆ›å»ºæ—¶æœºè¿‡æ—©çš„é—®é¢˜ã€‚ public sealed class Singleton5 { Singleton5() { Console.WriteLine(\"An instance of Singleton5 is created.\"); } public static void Print() { Console.WriteLine(\"Singleton5 Print\"); } public static Singleton5 Instance { get { return Nested.instance; } } class Nested { static Nested() { } internal static readonly Singleton5 instance = new Singleton5(); } } åœ¨ä¸Šè¿°Singleton5çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨å†…éƒ¨å®šä¹‰äº†ä¸€ä¸ªç§æœ‰ç±»å‹Nestedã€‚å½“ç¬¬ä¸€æ¬¡ç”¨åˆ°è¿™ä¸ªåµŒå¥—ç±»å‹çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨é™æ€æ„é€ å‡½æ•°åˆ›å»ºSingleton5çš„å®ä¾‹instanceã€‚ç±»å‹Nestedåªåœ¨å±æ€§Singleton5.Instanceä¸­è¢«ç”¨åˆ°ï¼Œç”±äºå…¶ç§æœ‰å±æ€§ï¼Œä»–äººæ— æ³•ä½¿ç”¨Nestedç±»å‹ã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡è¯•å›¾é€šè¿‡å±æ€§Singleton5.Instanceå¾—åˆ°Singleton5çš„å®ä¾‹æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨Nestedçš„é™æ€æ„é€ å‡½æ•°åˆ›å»ºå®ä¾‹instanceã€‚å¦‚æœæˆ‘ä»¬ä¸è°ƒç”¨å±æ€§Singleton5.Instanceï¼Œå°±ä¸ä¼šè§¦å‘.NETè¿è¡Œæ—¶è°ƒç”¨Nestedï¼Œä¹Ÿä¸ä¼šåˆ›å»ºå®ä¾‹ï¼Œè¿™æ ·å°±çœŸæ­£åšåˆ°äº†æŒ‰éœ€åˆ›å»ºã€‚ è§£æ³•æ¯”è¾ƒ åœ¨å‰é¢çš„5ç§å®ç°å•ä¾‹æ¨¡å¼çš„æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€ç§æ–¹æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒèƒ½æ­£å¸¸å·¥ä½œï¼Œç¬¬äºŒç§æ¨¡å¼è™½ç„¶èƒ½åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­æ­£å¸¸å·¥ä½œï¼Œä½†æ—¶é—´æ•ˆç‡å¾ˆä½ï¼Œéƒ½ä¸æ˜¯é¢è¯•å®˜æœŸå¾…çš„è§£æ³•ã€‚åœ¨ç¬¬ä¸‰ç§æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¸¤æ¬¡åˆ¤æ–­ä¸€æ¬¡åŠ é”ç¡®ä¿åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­èƒ½é«˜æ•ˆç‡åœ°å·¥ä½œã€‚ç¬¬å››ç§æ–¹æ³•åˆ©ç”¨C#çš„é™æ€æ„é€ å‡½æ•°çš„ç‰¹æ€§ï¼Œç¡®ä¿åªåˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚ç¬¬äº”ç§æ–¹æ³•åˆ©ç”¨ç§æœ‰åµŒå¥—ç±»å‹çš„ç‰¹æ€§ï¼Œåšåˆ°åªåœ¨çœŸæ­£éœ€è¦çš„æ—¶å€™æ‰ä¼šåˆ›å»ºå®ä¾‹ï¼Œæé«˜ç©ºé—´ä½¿ç”¨æ•ˆç‡ã€‚å¦‚æœåœ¨é¢è¯•ä¸­ç»™å‡ºç¬¬å››ç§æˆ–è€…ç¬¬äº”ç§è§£æ³•ï¼Œåˆ™æ¯«æ— ç–‘é—®ä¼šå¾—åˆ°é¢è¯•å®˜çš„é’çã€‚ æºä»£ç ï¼šhttps://github.com/zhedahht/CodingInterviewChinese2/tree/master/02_Singleton "},"pages/é¢è¯•ç³»åˆ—/æ’åºç®—æ³•.html":{"url":"pages/é¢è¯•ç³»åˆ—/æ’åºç®—æ³•.html","title":"æ’åºç®—æ³•","keywords":"","body":"æ’åºç®—æ³• å†’æ³¡æ’åº import Foundation func bubbleSort (arr: inout [Int]) { for i in 0.. arr[j+1] { arr.swapAt(j, j+1) } } } } // æµ‹è¯•è°ƒç”¨ func testSort () { // ç”Ÿæˆéšæœºæ•°æ•°ç»„è¿›è¡Œæ’åºæ“ä½œ var list:[Int] = [] for _ in 0...99 { list.append(Int(arc4random_uniform(100))) } print(\"\\(list)\") bubbleSort(arr:&list) print(\"\\(list)\") } testSort() é€‰æ‹©æ’åº /// é€‰æ‹©æ’åº /// /// - Parameter list: éœ€è¦æ’åºçš„æ•°ç»„ func selectionSort(_ list: inout [Int]) -> Void { for j in 0.. list[i] { minIndex = i } } list.swapAt(j, minIndex) } } æ’å…¥æ’åº func insertSort(list: inout [Int]) { for i in 1.. temp { list.swapAt(j, j+1) } } } } å¸Œå°”æ’åº public func insertSort(_ list: inout[Int], start: Int, gap: Int) { for i in stride(from: (start + gap), to: list.count, by: gap) { let currentValue = list[i] var pos = i while pos >= gap && list[pos - gap] > currentValue { list[pos] = list[pos - gap] pos -= gap } list[pos] = currentValue } } public func shellSort(_ list: inout [Int]) { var sublistCount = list.count / 2 while sublistCount > 0 { for pos in 0.. å¿«é€Ÿæ’åº func quicksort(_ a: [T]) -> [T] { guard a.count > 1 else { return a } let pivot = a[a.count/2] let less = a.filter { $0 pivot } return quicksort(less) + equal + quicksort(greater) } å½’å¹¶æ’åº func mergeSort(_ array: [Int]) -> [Int] { guard array.count > 1 else { return array } // 1 let middleIndex = array.count / 2 // 2 let leftArray = mergeSort(Array(array[0.. å †æ’åº func heapSort(_ array : inout Array){ //1ã€æ„å»ºå¤§é¡¶å † //ä»äºŒå‰æ ‘çš„ä¸€è¾¹çš„æœ€åä¸€ä¸ªç»“ç‚¹å¼€å§‹ for i in (0...(array.count/2-1)).reversed() { //ä»ç¬¬ä¸€ä¸ªéå¶å­ç»“ç‚¹ä»ä¸‹è‡³ä¸Šï¼Œä»å³è‡³å·¦è°ƒæ•´ç»“æ„ SortSummary.adjustHeap(&array, i, array.count) } //2ã€è°ƒæ•´å †ç»“æ„+äº¤æ¢å †é¡¶å…ƒç´ ä¸æœ«å°¾å…ƒç´  for j in (1...(array.count-1)).reversed() { //å°†å †é¡¶å…ƒç´ ä¸æœ«å°¾å…ƒç´ è¿›è¡Œäº¤æ¢ array.swapAt(0, j) //é‡æ–°å¯¹å †è¿›è¡Œè°ƒæ•´ SortSummary.adjustHeap(&array, 0, j) } } //è°ƒæ•´å¤§é¡¶å †ï¼ˆä»…æ˜¯è°ƒæ•´è¿‡ç¨‹ï¼Œå»ºç«‹åœ¨å¤§é¡¶å †ä»¥æ„å»ºçš„åŸºç¡€ä¸Šï¼‰ func adjustHeap(_ array : inout Array, _ i : Int, _ length : Int){ var i = i //å–å‡ºå½“å‰å…ƒç´ i let tmp = array[i] var k = 2*i+1 //ä»iç»“ç‚¹çš„å·¦å­èŠ‚ç‚¹å¼€å§‹ï¼Œä¹Ÿå°±æ˜¯2i+1å¤„å¼€å§‹ while k tmp { array[i] = array[k] //è®°å½•å½“å‰ç»“ç‚¹ i = k }else{ break } //ä¸‹ä¸€ä¸ªç»“ç‚¹ k = k*2+1 } //å°†tmpå€¼æ”¾åˆ°æœ€ç»ˆçš„ä½ç½® array[i] = tmp } å‚è€ƒ Swiftç®—æ³•ä¿±ä¹éƒ¨-å¸Œå°”æ’åºSwiftç®—æ³•ä¿±ä¹éƒ¨-å½’å¹¶æ’åºswiftç®—æ³•ä¹‹æ’åºï¼šï¼ˆå››ï¼‰å †æ’åº åå¤§ç»å…¸æ’åºç®—æ³•å¸¸ç”¨ç®—æ³•é¢è¯•é¢˜Swiftç®—æ³•ä¿±ä¹éƒ¨-å¿«é€Ÿæ’åºSort "},"pages/é¢è¯•ç³»åˆ—/RSA.html":{"url":"pages/é¢è¯•ç³»åˆ—/RSA.html","title":"RSA","keywords":"","body":"RSA é¢è¯•å®˜ï¼šå¦‚ä½•ä¿è¯ç”¨æˆ·æ¨¡å—çš„æ•°æ®å®‰å…¨ï¼Ÿè¯´è¯´ä½ çš„è§£å†³æ–¹æ¡ˆRSAç®—æ³•ä»‹ç»å¦‚ä½•åŠ å¯†ä¼ è¾“å’Œå­˜å‚¨ç”¨æˆ·å¯†ç  "},"pages/é¢è¯•ç³»åˆ—/é¢è¯•é¢˜é“¾æ¥.html":{"url":"pages/é¢è¯•ç³»åˆ—/é¢è¯•é¢˜é“¾æ¥.html","title":"é¢è¯•é¢˜é“¾æ¥","keywords":"","body":"é¢è¯•é¢˜é“¾æ¥ iOSInterviewsAndDevNotes iOSå¼€å‘ä¸­ weakå’Œassignçš„åŒºåˆ« åšäº†å¿«5å¹´iOSï¼Œè¿™ä»½é¢è¯•é¢˜è®©æˆ‘ä»15Kå˜æˆäº†30K ã€Šæ‹›è˜ä¸€ä¸ªé è°±çš„iOSã€‹é¢è¯•é¢˜å‚è€ƒç­”æ¡ˆ iOSæ€§èƒ½ä¼˜åŒ– iOS]NSHashTableå’ŒNSMapTableç”¨æ³• Swiftä¸­çš„unownedå’Œweak "},"pages/é¢è¯•ç³»åˆ—/æ•°ç»„ä¸æŒ‡é’ˆ.html":{"url":"pages/é¢è¯•ç³»åˆ—/æ•°ç»„ä¸æŒ‡é’ˆ.html","title":"æ•°ç»„ä¸æŒ‡é’ˆ","keywords":"","body":"æ•°ç»„ä¸æŒ‡é’ˆ åœ¨C/C++ä¸­ï¼Œæ•°ç»„å’ŒæŒ‡é’ˆæ˜¯æ—¢ç›¸äº’å…³è”åˆæœ‰åŒºåˆ«çš„ä¸¤ä¸ªæ¦‚å¿µã€‚å½“æˆ‘ä»¬å£°æ˜ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œå…¶æ•°ç»„çš„åå­—ä¹Ÿæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæŒ‡é’ˆæ¥è®¿é—®æ•°ç»„ã€‚ä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒC/C++æ²¡æœ‰è®°å½•æ•°ç»„çš„å¤§å°ï¼Œå› æ­¤åœ¨ç”¨æŒ‡é’ˆè®¿é—®æ•°ç»„ä¸­çš„å…ƒç´ æ—¶ï¼Œç¨‹åºå‘˜è¦ç¡®ä¿æ²¡æœ‰è¶…å‡ºæ•°ç»„çš„è¾¹ç•Œã€‚ä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥äº†è§£æ•°ç»„å’ŒæŒ‡é’ˆçš„åŒºåˆ«ã€‚è¿è¡Œä¸‹é¢çš„ä»£ç ï¼Œè¯·é—®è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿ int GetSize(int data[]) { return sizeof(data); } int main(int argc, const char * argv[]) { int data1[] = {1,2,3,4,5}; int size1 = sizeof(data1); int* data2 = data1; int size2 = sizeof(data2); int size3 = GetSize(data1); printf(\"%d,%d,%d\",size1,size2,size3); return 0; } ç­”æ¡ˆæ˜¯è¾“å‡ºâ€œ20,4,4â€ã€‚data1æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œsizeof(data1)æ˜¯æ±‚æ•°ç»„çš„å¤§å°ã€‚è¿™ä¸ªæ•°ç»„åŒ…å«5ä¸ªæ•´æ•°ï¼Œæ¯ä¸ªæ•´æ•°å 4å­—èŠ‚ï¼Œå› æ­¤å…±å ç”¨20å­—èŠ‚ã€‚data2å£°æ˜ä¸ºæŒ‡é’ˆï¼Œå°½ç®¡å®ƒæŒ‡å‘äº†æ•°ç»„data1çš„ç¬¬ä¸€ä¸ªæ•°å­—ï¼Œä½†å®ƒçš„æœ¬è´¨ä»ç„¶æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚åœ¨32ä½ç³»ç»Ÿä¸Šï¼Œå¯¹ä»»æ„æŒ‡é’ˆæ±‚sizeofï¼Œå¾—åˆ°çš„ç»“æœéƒ½æ˜¯4ã€‚åœ¨C/C++ä¸­ï¼Œå½“æ•°ç»„ä½œä¸ºå‡½æ•°çš„å‚æ•°è¿›è¡Œä¼ é€’æ—¶ï¼Œæ•°ç»„å°±è‡ªåŠ¨é€€åŒ–ä¸ºåŒç±»å‹çš„æŒ‡é’ˆã€‚å› æ­¤ï¼Œå°½ç®¡å‡½æ•°GetSizeçš„å‚æ•°dataè¢«å£°æ˜ä¸ºæ•°ç»„ï¼Œä½†å®ƒä¼šé€€åŒ–ä¸ºæŒ‡é’ˆï¼Œsize3çš„ç»“æœä»ç„¶æ˜¯4ã€‚ å‰‘æŒ‡ Offer P38 "},"pages/é¢è¯•ç³»åˆ—/æ•°ç»„ä¸­é‡å¤çš„æ•°å­—.html":{"url":"pages/é¢è¯•ç³»åˆ—/æ•°ç»„ä¸­é‡å¤çš„æ•°å­—.html","title":"æ•°ç»„ä¸­é‡å¤çš„æ•°å­—","keywords":"","body":"æ•°ç»„ä¸­é‡å¤çš„æ•°å­— é¢˜ç›®ä¸€ï¼šæ‰¾å‡ºæ•°ç»„ä¸­é‡å¤çš„æ•°å­—ã€‚ åœ¨ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„é‡Œçš„æ‰€æœ‰æ•°å­—éƒ½åœ¨0~n-1çš„èŒƒå›´å†…ã€‚æ•°ç»„ä¸­æŸäº›æ•°å­—æ˜¯é‡å¤çš„ï¼Œä½†ä¸çŸ¥é“æœ‰å‡ ä¸ªæ•°å­—é‡å¤äº†ï¼Œä¹Ÿä¸çŸ¥é“æ¯ä¸ªæ•°å­—é‡å¤äº†å‡ æ¬¡ã€‚è¯·æ‰¾å‡ºæ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¾“å…¥é•¿åº¦ä¸º7çš„æ•°ç»„{2,3,1,0,2,5,3}ï¼Œé‚£ä¹ˆå¯¹åº”çš„è¾“å‡ºæ˜¯é‡å¤çš„æ•°å­—2æˆ–è€…3ã€‚ è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯å…ˆæŠŠè¾“å…¥çš„æ•°ç»„æ’åºã€‚ä»æ’åºçš„æ•°ç»„ä¸­æ‰¾å‡ºé‡å¤çš„æ•°å­—æ˜¯ä¸€ä»¶å¾ˆå®¹æ˜“çš„äº‹æƒ…ï¼Œåªéœ€è¦ä»å¤´åˆ°å°¾æ‰«ææ’åºåçš„æ•°ç»„å°±å¯ä»¥äº†ã€‚æ’åºä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„éœ€è¦O(nlogn)çš„æ—¶é—´ã€‚ è¿˜å¯ä»¥åˆ©ç”¨å“ˆå¸Œè¡¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä»å¤´åˆ°å°¾æŒ‰é¡ºåºæ‰«ææ•°ç»„çš„æ¯ä¸ªæ•°å­—ï¼Œæ¯æ‰«æåˆ°ä¸€ä¸ªæ•°å­—çš„æ—¶å€™ï¼Œéƒ½å¯ä»¥ç”¨O(1)çš„æ—¶é—´æ¥åˆ¤æ–­å“ˆå¸Œè¡¨é‡Œæ˜¯å¦å·²ç»åŒ…å«äº†è¯¥æ•°å­—ã€‚å¦‚æœå“ˆå¸Œè¡¨é‡Œè¿˜æ²¡æœ‰è¿™ä¸ªæ•°å­—ï¼Œå°±æŠŠå®ƒåŠ å…¥å“ˆå¸Œè¡¨ã€‚å¦‚æœå“ˆå¸Œè¡¨é‡Œå·²ç»å­˜åœ¨è¯¥æ•°å­—ï¼Œå°±æ‰¾åˆ°ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€‚è¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œä½†å®ƒæé«˜æ—¶é—´æ•ˆç‡æ˜¯ä»¥ä¸€ä¸ªå¤§å°ä¸ºO(n)çš„å“ˆå¸Œè¡¨ä¸ºä»£ä»·çš„ã€‚æˆ‘ä»¬å†çœ‹çœ‹æœ‰æ²¡æœ‰ç©ºé—´å¤æ‚åº¦æ˜¯O(1)çš„ç®—æ³•ã€‚ æˆ‘ä»¬æ³¨æ„åˆ°æ•°ç»„ä¸­çš„æ•°å­—éƒ½åœ¨0~n-1çš„èŒƒå›´å†…ã€‚å¦‚æœè¿™ä¸ªæ•°ç»„ä¸­æ²¡æœ‰é‡å¤çš„æ•°å­—ï¼Œé‚£ä¹ˆå½“æ•°ç»„æ’åºä¹‹åæ•°å­—iå°†å‡ºç°åœ¨ä¸‹æ ‡ä¸ºiçš„ä½ç½®ã€‚ç”±äºæ•°ç»„ä¸­æœ‰é‡å¤çš„æ•°å­—ï¼Œæœ‰äº›ä½ç½®å¯èƒ½å­˜åœ¨å¤šä¸ªæ•°å­—ï¼ŒåŒæ—¶æœ‰äº›ä½ç½®å¯èƒ½æ²¡æœ‰æ•°å­—ã€‚ ç°åœ¨è®©æˆ‘ä»¬é‡æ’è¿™ä¸ªæ•°ç»„ã€‚ä»å¤´åˆ°å°¾ä¾æ¬¡æ‰«æè¿™ä¸ªæ•°ç»„ä¸­çš„æ¯ä¸ªæ•°å­—ã€‚å½“æ‰«æåˆ°ä¸‹æ ‡ä¸ºiçš„æ•°å­—æ—¶ï¼Œé¦–å…ˆæ¯”è¾ƒè¿™ä¸ªæ•°å­—ï¼ˆç”¨mè¡¨ç¤ºï¼‰æ˜¯ä¸æ˜¯ç­‰äºiã€‚å¦‚æœæ˜¯ï¼Œåˆ™æ¥ç€æ‰«æä¸‹ä¸€ä¸ªæ•°å­—ï¼›å¦‚æœä¸æ˜¯ï¼Œåˆ™å†æ‹¿å®ƒå’Œç¬¬mä¸ªæ•°å­—è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœå®ƒå’Œç¬¬mä¸ªæ•°å­—ç›¸ç­‰ï¼Œå°±æ‰¾åˆ°äº†ä¸€ä¸ªé‡å¤çš„æ•°å­—ï¼ˆè¯¥æ•°å­—åœ¨ä¸‹æ ‡ä¸ºiå’Œmçš„ä½ç½®éƒ½å‡ºç°äº†)ï¼›å¦‚æœå®ƒå’Œç¬¬mä¸ªæ•°å­—ä¸ç›¸ç­‰ï¼Œå°±æŠŠç¬¬iä¸ªæ•°å­—å’Œç¬¬mä¸ªæ•°å­—äº¤æ¢ï¼ŒæŠŠmæ”¾åˆ°å±äºå®ƒçš„ä½ç½®ã€‚æ¥ä¸‹æ¥å†é‡å¤è¿™ä¸ªæ¯”è¾ƒã€äº¤æ¢çš„è¿‡ç¨‹ï¼Œç›´åˆ°æˆ‘ä»¬å‘ç°ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€‚ ä»¥æ•°ç»„{2,3,1,0,2,5,3}ä¸ºä¾‹æ¥åˆ†ææ‰¾åˆ°é‡å¤æ•°å­—çš„æ­¥éª¤ã€‚æ•°ç»„çš„ç¬¬0ä¸ªæ•°å­—ï¼ˆä»0å¼€å§‹è®¡æ•°ï¼Œå’Œæ•°ç»„çš„ä¸‹æ ‡ä¿æŒä¸€è‡´ï¼‰æ˜¯2ï¼Œä¸å®ƒçš„ä¸‹æ ‡ä¸ç›¸ç­‰ï¼Œäºæ˜¯æŠŠå®ƒå’Œä¸‹æ ‡ä¸º2çš„æ•°å­—1äº¤æ¢ã€‚äº¤æ¢ä¹‹åçš„æ•°ç»„æ˜¯{1,3,2,0,2,5,3}ã€‚æ­¤æ—¶ç¬¬0ä¸ªæ•°å­—æ˜¯1ï¼Œä»ç„¶ä¸å®ƒçš„ä¸‹æ ‡ä¸ç›¸ç­‰ï¼Œç»§ç»­æŠŠå®ƒå’Œä¸‹æ ‡ä¸º1çš„æ•°å­—3äº¤æ¢ï¼Œå¾—åˆ°æ•°ç»„{3,1,2,0,2,5,3}ã€‚æ¥ä¸‹æ¥ç»§ç»­äº¤æ¢ç¬¬0ä¸ªæ•°å­—3å’Œç¬¬3ä¸ªæ•°å­—0ï¼Œå¾—åˆ°æ•°ç»„{0,1,2,3,2,5,3}ã€‚æ­¤æ—¶ç¬¬0ä¸ªæ•°å­—çš„æ•°å€¼ä¸º0ï¼Œæ¥ç€æ‰«æä¸‹ä¸€ä¸ªæ•°å­—ã€‚åœ¨æ¥ä¸‹æ¥çš„å‡ ä¸ªæ•°å­—ä¸­ï¼Œä¸‹æ ‡ä¸º1ã€2ã€3çš„3ä¸ªæ•°å­—åˆ†åˆ«ä¸º1ã€2ã€3ï¼Œå®ƒä»¬çš„ä¸‹æ ‡å’Œæ•°å€¼éƒ½åˆ†åˆ«ç›¸ç­‰ï¼Œå› æ­¤ä¸éœ€è¦æ‰§è¡Œä»»ä½•æ“ä½œã€‚æ¥ä¸‹æ¥æ‰«æåˆ°ä¸‹æ ‡ä¸º4çš„æ•°å­—2ã€‚ç”±äºå®ƒçš„æ•°å€¼ä¸å®ƒçš„ä¸‹æ ‡ä¸ç›¸ç­‰ï¼Œå†æ¯”è¾ƒå®ƒå’Œä¸‹æ ‡ä¸º2çš„æ•°å­—ã€‚æ³¨æ„åˆ°æ­¤æ—¶æ•°ç»„ä¸­ä¸‹æ ‡ä¸º2çš„æ•°å­—ä¹Ÿæ˜¯2ï¼Œä¹Ÿå°±æ˜¯æ•°å­—2åœ¨ä¸‹æ ‡ä¸º2å’Œä¸‹æ ‡ä¸º4çš„ä¸¤ä¸ªä½ç½®éƒ½å‡ºç°äº†ï¼Œå› æ­¤æ‰¾åˆ°ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€‚ ä¸Šè¿°æ€è·¯å¯ä»¥ç”¨å¦‚ä¸‹ä»£ç å®ç°ï¼š // å‚æ•°: // numbers: ä¸€ä¸ªæ•´æ•°æ•°ç»„ // length: æ•°ç»„çš„é•¿åº¦ // duplication: (è¾“å‡º) æ•°ç»„ä¸­çš„ä¸€ä¸ªé‡å¤çš„æ•°å­— // è¿”å›å€¼: // true - è¾“å…¥æœ‰æ•ˆï¼Œå¹¶ä¸”æ•°ç»„ä¸­å­˜åœ¨é‡å¤çš„æ•°å­— // false - è¾“å…¥æ— æ•ˆï¼Œæˆ–è€…æ•°ç»„ä¸­æ²¡æœ‰é‡å¤çš„æ•°å­— bool duplicate(int numbers[], int length, int* duplication) { if(numbers == nullptr || length length - 1) return false; } for(int i = 0; i åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæ‰¾åˆ°çš„é‡å¤æ•°å­—é€šè¿‡å‚æ•°duplicationä¼ ç»™å‡½æ•°çš„è°ƒç”¨è€…ï¼Œè€Œå‡½æ•°çš„è¿”å›å€¼è¡¨ç¤ºæ•°ç»„ä¸­æ˜¯å¦æœ‰é‡å¤çš„æ•°å­—ã€‚å½“è¾“å…¥çš„æ•°ç»„ä¸­å­˜åœ¨ é‡å¤çš„æ•°å­—æ—¶ï¼Œè¿”å›trueï¼›å¦åˆ™è¿”å›falseã€‚ä»£ç ä¸­å°½ç®¡æœ‰ä¸€ä¸ªä¸¤é‡å¾ªç¯ï¼Œä½†æ¯ä¸ªæ•°å­—æœ€å¤šåªè¦äº¤æ¢ä¸¤æ¬¡å°±èƒ½æ‰¾åˆ°å±äºå®ƒè‡ªå·±çš„ä½ç½®ï¼Œå› æ­¤æ€»çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ã€‚å¦å¤–ï¼Œæ‰€æœ‰çš„æ“ä½œæ­¥éª¤éƒ½æ˜¯åœ¨è¾“å…¥æ•°ç»„ä¸Šè¿›è¡Œçš„ï¼Œä¸éœ€è¦é¢å¤–åˆ†é…å†…å­˜ï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦ä¸ºO(1)ã€‚ å‰‘æŒ‡ Offer P39ï¼Œæœ¬é¢˜å®Œæ•´çš„æºä»£ç ï¼šhttps://github.com/zhedahht/CodingInterviewChinese2/tree/master/03_01_DuplicationInArray "},"pages/é¢è¯•ç³»åˆ—/æ•°ç»„ä¸­é‡å¤çš„æ•°å­—2.html":{"url":"pages/é¢è¯•ç³»åˆ—/æ•°ç»„ä¸­é‡å¤çš„æ•°å­—2.html","title":"æ•°ç»„ä¸­é‡å¤çš„æ•°å­—2","keywords":"","body":"æ•°ç»„ä¸­é‡å¤çš„æ•°å­—2 é¢˜ç›®äºŒï¼Œä¸ä¿®æ”¹æ•°ç»„æ‰¾å‡ºé‡å¤çš„æ•°å­—ã€‚ åœ¨ä¸€ä¸ªé•¿åº¦ä¸ºn+1çš„æ•°ç»„é‡Œçš„æ‰€æœ‰æ•°å­—éƒ¨åœ¨1~nçš„èŒƒé¢å†…ï¼Œæ‰€ä»¥æ•°ç»„ä¸­è‡³å°‘æœ‰ä¸€ä¸ªæ•°å­—æ˜¯é‡å¤çš„ï¼Œè¯·æ‰¾å‡ºæ•°ç»„ä¸­ä»»æ„ä¸€ä¸ªé‡å¤çš„æ•°å­—ï¼Œä½†ä¸èƒ½ä¿®æ”¹è¾“å…¥çš„æ•°ç»„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¾“å…¥é•¿åº¦ä¸º8çš„æ•°ç»„{2,3,5,4,3,2,6,7}ï¼Œé‚£ä¹ˆå¯¹åº”çš„è¾“å‡ºæ˜¯é‡å¤çš„æ•°å­—2æˆ–è€…3ã€‚ è¿™ä¸€é¢˜çœ‹èµ·æ¥å’Œä¸Šé¢çš„é¢è¯•é¢˜ç±»ä¼¼ã€‚ç”±äºé¢˜ç›®è¦æ±‚ä¸èƒ½ä¿®æ”¹è¾“å…¥çš„æ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸ºn+1çš„è¾…åŠ©æ•°ç»„ï¼Œç„¶åé€ä¸€æŠŠåŸæ•°ç»„çš„æ¯ä¸ªæ•°å­—å¤åˆ¶åˆ°è¾…åŠ©æ•°ç»„ã€‚å¦‚æœåŸæ•°ç»„ä¸­è¢«å¤åˆ¶çš„æ•°å­—æ˜¯mï¼Œåˆ™æŠŠå®ƒå¤åˆ¶åˆ°è¾…åŠ©æ•°ç»„ä¸­ä¸‹æ ‡ä¸ºmçš„ä½ç½®ã€‚è¿™æ ·å¾ˆå®¹æ˜“å°±èƒ½å‘ç°å“ªä¸ªæ•°å­—æ˜¯é‡å¤çš„ã€‚ç”±äºéœ€è¦åˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ–¹æ¡ˆéœ€è¦O(n)çš„è¾…åŠ©ç©ºé—´ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬å°è¯•é¿å…ä½¿ç”¨O(n)çš„è¾…åŠ©ç©ºé—´ã€‚ä¸ºä»€ä¹ˆæ•°ç»„ä¸­ä¼šæœ‰é‡å¤çš„æ•°å­—ï¼Ÿå‡å¦‚æ²¡æœ‰é‡å¤çš„æ•°å­—ï¼Œé‚£ä¹ˆåœ¨ä»1~nçš„èŒƒå›´é‡Œåªæœ‰nä¸ªæ•°å­—ã€‚ç”±äºæ•°ç»„é‡ŒåŒ…å«è¶…è¿‡nä¸ªæ•°å­—ï¼Œæ‰€ä»¥ä¸€å®šåŒ…å«äº†é‡å¤çš„æ•°å­—ã€‚çœ‹èµ·æ¥åœ¨æŸèŒƒå›´é‡Œæ•°å­—çš„ä¸ªæ•°å¯¹è§£å†³è¿™ä¸ªé—®é¢˜å¾ˆé‡è¦ã€‚ æˆ‘ä»¬æŠŠä»1~nçš„æ•°å­—ä»ä¸­é—´çš„æ•°å­—måˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå‰é¢ä¸€åŠä¸º1~mï¼Œåé¢ä¸€åŠä¸ºm+1~nã€‚å¦‚æœ1~mçš„æ•°å­—çš„æ•°ç›®è¶…è¿‡m,é‚£ä¹ˆè¿™ä¸€åŠçš„åŒºé—´é‡Œä¸€å®šåŒ…å«é‡å¤çš„æ•°å­—ï¼›å¦åˆ™ï¼Œå¦ä¸€åŠm+1~nçš„åŒºé—´é‡Œä¸€å®šåŒ…å«é‡å¤çš„æ•°å­—ã€‚æˆ‘ä»¬å¯ä»¥ç»§ç»­æŠŠåŒ…å«é‡å¤æ•°å­—çš„åŒºé—´ä¸€åˆ†ä¸ºäºŒï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€‚è¿™ä¸ªè¿‡ç¨‹å’ŒäºŒåˆ†æŸ¥æ‰¾ç®—æ³•å¾ˆç±»ä¼¼ï¼Œåªæ˜¯å¤šäº†ä¸€æ­¥ç»Ÿè®¡åŒºé—´é‡Œæ•°å­—çš„æ•°ç›®ã€‚ æˆ‘ä»¬ä»¥é•¿åº¦ä¸º8çš„æ•°ç»„{2,3,5,4,3,2,6,7}ä¸ºä¾‹åˆ†ææŸ¥æ‰¾çš„è¿‡ç¨‹ã€‚æ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œè¿™ä¸ªé•¿åº¦ä¸º8çš„æ‰€æœ‰æ•°å­—éƒ½åœ¨1~7çš„èŒƒå›´å†…ã€‚ä¸­é—´çš„æ•°å­—4æŠŠ1~7çš„èŒƒå›´åˆ†ä¸ºä¸¤æ®µï¼Œä¸€æ®µæ˜¯1~4ï¼Œå¦ä¸€æ®µæ˜¯5~7ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç»Ÿè®¡1ï½4è¿™4ä¸ªæ•°å­—åœ¨æ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œå®ƒä»¬ä¸€å…±å‡ºç°äº†5æ¬¡ï¼Œå› æ­¤è¿™4ä¸ªæ•°å­—ä¸­ä¸€å®šæœ‰é‡å¤çš„æ•°å­—ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬å†æŠŠ1~4çš„èŒƒå›´ä¸€åˆ†ä¸ºäºŒï¼Œä¸€æ®µæ˜¯1ã€2ä¸¤ä¸ªæ•°å­—ï¼Œå¦ä¸€æ®µæ˜¯3ã€4ä¸¤ä¸ªæ•°å­—ã€‚æ•°å­—1æˆ–è€…2åœ¨æ•°ç»„ä¸­ä¸€å…±å‡ºç°äº†ä¸¤æ¬¡ã€‚æˆ‘ä»¬å†ç»Ÿè®¡æ•°å­—3æˆ–è€…4åœ¨æ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œå®ƒä»¬ä¸€å…±å‡ºç°äº†ä¸‰æ¬¡ã€‚è¿™æ„å‘³ç€3ã€4ä¸¤ä¸ªæ•°å­—ä¸­ä¸€å®šæœ‰ä¸€ä¸ªé‡å¤äº†ã€‚æˆ‘ä»¬å†åˆ†åˆ«ç»Ÿè®¡è¿™ä¸¤ä¸ªæ•°å­—åœ¨æ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚æ¥ç€æˆ‘ä»¬å‘ç°æ•°å­—3å‡ºç°äº†ä¸¤æ¬¡ï¼Œæ˜¯ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€‚ ä¸Šè¿°æ€è·¯å¯ä»¥ç”¨å¦‚ä¸‹ä»£ç å®ç°ï¼š int countRange(const int* numbers, int length, int start, int end); // å‚æ•°: // numbers: ä¸€ä¸ªæ•´æ•°æ•°ç»„ // length: æ•°ç»„çš„é•¿åº¦ // è¿”å›å€¼: // æ­£æ•° - è¾“å…¥æœ‰æ•ˆï¼Œå¹¶ä¸”æ•°ç»„ä¸­å­˜åœ¨é‡å¤çš„æ•°å­—ï¼Œè¿”å›å€¼ä¸ºé‡å¤çš„æ•°å­— // è´Ÿæ•° - è¾“å…¥æ— æ•ˆï¼Œæˆ–è€…æ•°ç»„ä¸­æ²¡æœ‰é‡å¤çš„æ•°å­— int getDuplication(const int* numbers, int length) { if(numbers == nullptr || length = start) { // 0000 0010 >> å·¦ç§»1ä½ 0000 0101 int middle = ((end - start) >> 1) + start; int count = countRange(numbers, length, start, middle);// æŸ¥æ‰¾è½åœ¨äºŒåˆ†å·¦åŒºé—´å†…ä¸ªæ•° //cout 1) return start; else break; } if(count > (middle - start + 1))// å¦‚æœè½åœ¨å·¦åŒºé—´çš„ä¸ªæ•°å¤§äºåŒºé—´èŒƒå›´ï¼Œåˆ™è¿™é‡Œé¢ä¸€å®šæœ‰é‡å¤ï¼Œå¦åˆ™å°±å»å³åŒºé—´çœ‹çœ‹ end = middle; else start = middle + 1; } return -1; } int countRange(const int* numbers, int length, int start, int end) { if(numbers == nullptr) return 0; int count = 0; for(int i = 0; i = start && numbers[i] ä¸Šè¿°ä»£ç æŒ‰ç…§äºŒåˆ†æŸ¥æ‰¾çš„æ€è·¯ï¼Œå¦‚æœè¾“å…¥é•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œé‚£ä¹ˆå‡½æ•°countRangeå°†è¢«è°ƒç”¨O(logn)æ¬¡ï¼Œæ¯æ¬¡éœ€è¦O(n)çš„æ—¶é—´ï¼Œå› æ­¤æ€»çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(nlogn)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)ã€‚å’Œæœ€å‰é¢æåˆ°çš„éœ€è¦O(n)çš„è¾…åŠ©ç©ºé—´çš„ç®—æ³•ç›¸æ¯”ï¼Œè¿™ç§ç®—æ³•ç›¸å½“äºä»¥æ—¶é—´æ¢ç©ºé—´ã€‚ éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œè¿™ç§ç®—æ³•ä¸èƒ½ä¿è¯æ‰¾å‡ºæ‰€æœ‰é‡å¤çš„æ•°å­—ã€‚ä¾‹å¦‚ï¼Œè¯¥ç®—æ³•ä¸èƒ½æ‰¾å‡ºæ•°ç»„{2,3,5,4,3,2,6,7}ä¸­é‡å¤çš„æ•°å­—2ã€‚è¿™æ˜¯å› ä¸ºåœ¨1~2çš„èŒƒå›´é‡Œæœ‰1å’Œ2ä¸¤ä¸ªæ•°å­—ï¼Œè¿™ä¸ªèŒƒå›´çš„æ•°å­—ä¹Ÿå‡ºç°2æ¬¡ï¼Œæ­¤æ—¶æˆ‘ä»¬ç”¨è¯¥ç®—æ³•ä¸èƒ½ç¡®å®šæ˜¯æ¯ä¸ªæ•°å­—å„å‡ºç°ä¸€æ¬¡è¿˜æ˜¯æŸä¸ªæ•°å­—å‡ºç°äº†ä¸¤æ¬¡ã€‚ ä»ä¸Šè¿°åˆ†æä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœé¢è¯•å®˜æå‡ºä¸åŒçš„åŠŸèƒ½è¦æ±‚ï¼ˆæ‰¾å‡ºä»»æ„ä¸€ä¸ªé‡å¤çš„æ•°å­—ã€æ‰¾å‡ºæ‰€æœ‰é‡å¤çš„æ•°å­—)æˆ–è€…æ€§èƒ½è¦æ±‚ï¼ˆæ—¶é—´æ•ˆç‡ä¼˜å…ˆã€ç©ºé—´æ•ˆç‡ä¼˜å…ˆ)ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€ç»ˆé€‰å–çš„ç®—æ³•ä¹Ÿå°†ä¸åŒã€‚è¿™ä¹Ÿè¯´æ˜åœ¨é¢è¯•ä¸­å’Œé¢è¯•å®˜äº¤æµçš„é‡è¦æ€§ï¼Œæˆ‘ä»¬ä¸€å®šè¦åœ¨åŠ¨æ‰‹å†™ä»£ç ä¹‹å‰å¼„æ¸…æ¥šé¢è¯•å®˜çš„éœ€æ±‚ã€‚ å‰‘æŒ‡ Offer P41ï¼Œæœ¬é¢˜å®Œæ•´çš„æºä»£ç ï¼šhttps://github.com/zhedahht/CodingInterviewChinese2/tree/master/03_02_DuplicationInArrayNoEdit "},"pages/é¢è¯•ç³»åˆ—/äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾.html":{"url":"pages/é¢è¯•ç³»åˆ—/äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾.html","title":"äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾","keywords":"","body":"äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾ é¢˜ç›®ï¼šåœ¨ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½æŒ‰ç…§ä»å·¦åˆ°å³é€’å¢çš„é¡ºåºæ’åºï¼Œæ¯ä¸€åˆ—éƒ½æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹é€’å¢çš„é¡ºåºæ’åºã€‚è¯·å®Œæˆä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥è¿™æ ·çš„ä¸ªäºŒç»´æ•°ç»„å’Œä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å«æœ‰è¯¥æ•´æ•°ã€‚ä¾‹å¦‚ä¸‹é¢çš„äºŒç»´æ•°ç»„å°±æ˜¯æ¯è¡Œã€æ¯åˆ—éƒ½é€’å¢æ’åºã€‚ å¦‚æœåœ¨è¿™ä¸ªæ•°ç»„ä¸­æŸ¥æ‰¾æ•°å­—7ï¼Œåˆ™è¿”å›true;å¦‚æœæŸ¥æ‰¾æ•°å­—5ï¼Œç”±äºæ•°ç»„ä¸å«æœ‰è¯¥æ•°å­—ï¼Œåˆ™è¿”å›falseã€‚ 1 2 8 9 2 4 9 1 4 7 9 12 6 8 11 15 åœ¨åˆ†æè¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œå¾ˆå¤šåº”è˜è€…éƒ½ä¼šæŠŠäºŒç»´æ•°ç»„ç”»æˆçŸ©å½¢ï¼Œç„¶åä»æ•°ç»„ä¸­é€‰å–ä¸€ä¸ªæ•°å­—ï¼Œåˆ†3ç§æƒ…å†µæ¥åˆ†ææŸ¥æ‰¾çš„è¿‡ç¨‹ã€‚å½“æ•°ç»„ä¸­é€‰å–çš„æ•°å­—åˆšå¥½å’Œè¦æŸ¥æ‰¾çš„æ•°å­—ç›¸ç­‰æ—¶ï¼Œå°±ç»“æŸæŸ¥æ‰¾è¿‡ç¨‹ã€‚å¦‚æœé€‰å–çš„æ•°å­—å°äºè¦æŸ¥æ‰¾çš„æ•°å­—ï¼Œé‚£ä¹ˆæ ¹æ®æ•°ç»„æ’åºçš„è§„åˆ™ï¼Œè¦æŸ¥æ‰¾çš„æ•°å­—åº”è¯¥åœ¨å½“å‰é€‰å–ä½ç½®çš„å³è¾¹æˆ–è€…ä¸‹è¾¹ï¼Œå¦‚å›¾2.1(a)æ‰€ç¤ºã€‚åŒæ ·ï¼Œå¦‚æœé€‰å–çš„æ•°å­—å¤§äºè¦æŸ¥æ‰¾çš„æ•°å­—ï¼Œé‚£ä¹ˆè¦æŸ¥æ‰¾çš„æ•°å­—åº”è¯¥åœ¨å½“å‰é€‰å–ä½ç½®çš„ä¸Šè¾¹æˆ–è€…å·¦è¾¹ï¼Œå¦‚å›¾2.1(b)æ‰€ç¤ºã€‚ å›¾2.1äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾ æ³¨ï¼šåœ¨æ•°ç»„ä¸­é—´é€‰æ‹©ä¸€ä¸ªæ•°ï¼ˆæ·±è‰²æ–¹æ ¼ï¼‰ï¼Œæ ¹æ®å®ƒçš„å¤§å°åˆ¤æ–­è¦æŸ¥æ‰¾çš„æ•°å­—å¯èƒ½å‡ºç°çš„åŒºåŸŸï¼ˆé˜´å½±éƒ¨åˆ†ï¼‰ã€‚ åœ¨ä¸Šé¢çš„åˆ†æä¸­ï¼Œç”±äºè¦æŸ¥æ‰¾çš„æ•°å­—ç›¸å¯¹äºå½“å‰é€‰å–çš„ä½ç½®æœ‰å¯èƒ½åœ¨ä¸¤ä¸ªåŒºåŸŸä¸­å‡ºç°ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªåŒºåŸŸè¿˜æœ‰é‡å ï¼Œè¿™é—®é¢˜çœ‹èµ·æ¥å°±å¤æ‚äº†ï¼Œäºæ˜¯å¾ˆå¤šäººå°±å¡åœ¨è¿™é‡ŒæŸæ‰‹æ— ç­–äº†ã€‚ å½“æˆ‘ä»¬éœ€è¦è§£å†³ä¸€ä¸ªå¤æ‚çš„é—®é¢˜æ—¶ï¼Œä¸€ä¸ªå¾ˆæœ‰æ•ˆçš„åŠæ³•å°±æ˜¯ä»ä¸€ä¸ªå…·ä½“çš„é—®é¢˜å…¥æ‰‹ï¼Œé€šè¿‡åˆ†æç®€å•å…·ä½“çš„ä¾‹å­ï¼Œè¯•å›¾å¯»æ‰¾æ™®éçš„è§„å¾‹ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¸å¦¨ä¹Ÿä»ä¸€ä¸ªå…·ä½“çš„ä¾‹å­å…¥æ‰‹ã€‚ä¸‹é¢æˆ‘ä»¬ä»¥åœ¨é¢˜ç›®ä¸­ç»™å‡ºçš„æ•°ç»„ä¸­æŸ¥æ‰¾æ•°å­—7ä¸ºä¾‹æ¥ä¸€æ­¥æ­¥åˆ†ææŸ¥æ‰¾çš„è¿‡ç¨‹ã€‚ å‰é¢æˆ‘ä»¬ä¹‹æ‰€ä»¥é‡åˆ°éš¾é¢˜ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åœ¨äºŒç»´æ•°ç»„çš„ä¸­é—´é€‰å–ä¸€ä¸ªæ•°å­—æ¥å’Œè¦æŸ¥æ‰¾çš„æ•°å­—è¿›è¡Œæ¯”è¾ƒï¼Œè¿™å°±å¯¼è‡´ä¸‹ä¸€æ¬¡è¦æŸ¥æ‰¾çš„æ˜¯ä¸¤ä¸ªç›¸äº’é‡å çš„åŒºåŸŸã€‚å¦‚æœæˆ‘ä»¬ä»æ•°ç»„çš„ä¸€ä¸ªè§’ä¸Šé€‰å–æ•°å­—æ¥å’Œè¦æŸ¥æ‰¾çš„æ•°å­—è¿›è¡Œæ¯”è¾ƒï¼Œé‚£ä¹ˆæƒ…å†µä¼šä¸ä¼šå˜ç®€å•å‘¢ï¼Ÿ é¦–å…ˆæˆ‘ä»¬é€‰å–æ•°ç»„å³ä¸Šè§’çš„æ•°å­—9ã€‚ç”±äº9å¤§äº7ï¼Œå¹¶ä¸”9è¿˜æ˜¯ç¬¬4åˆ—çš„ç¬¬ä¸€ä¸ªï¼ˆä¹Ÿæ˜¯æœ€å°çš„ï¼‰æ•°å­—ï¼Œå› æ­¤7ä¸å¯èƒ½å‡ºç°åœ¨æ•°å­—9æ‰€åœ¨çš„åˆ—ã€‚äºæ˜¯æˆ‘ä»¬æŠŠè¿™ä¸€åˆ—ä»éœ€è¦è€ƒè™‘çš„åŒºåŸŸå†…å‰”é™¤ï¼Œä¹‹ååªéœ€è¦åˆ†æå‰©ä¸‹çš„3åˆ—ï¼Œå¦‚å›¾2.2(a)æ‰€ç¤ºã€‚åœ¨å‰©ä¸‹çš„çŸ©é˜µä¸­ï¼Œä½äºå³ä¸Šè§’çš„æ•°å­—æ˜¯8ã€‚åŒæ ·8å¤§äº7ï¼Œå› æ­¤8æ‰€åœ¨çš„åˆ—æˆ‘ä»¬ä¹Ÿå¯ä»¥å‰”é™¤ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åªè¦åˆ†æå‰©ä¸‹çš„ä¸¤åˆ—å³å¯ï¼Œå¦‚å›¾2.2(b)æ‰€ç¤ºã€‚ åœ¨ç”±å‰©ä½™çš„ä¸¤åˆ—ç»„æˆçš„æ•°ç»„ä¸­ï¼Œæ•°å­—2ä½äºæ•°ç»„çš„å³ä¸Šè§’ã€‚2å°äº7ï¼Œé‚£ä¹ˆè¦æŸ¥æ‰¾çš„7å¯èƒ½åœ¨2çš„å³è¾¹ï¼Œä¹Ÿå¯èƒ½åœ¨2çš„ä¸‹è¾¹ã€‚åœ¨å‰é¢çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å·²ç»å‘ç°2å³è¾¹çš„åˆ—éƒ½å·²ç»è¢«å‰”é™¤äº†ï¼Œä¹Ÿå°±æ˜¯è¯´7ä¸å¯èƒ½å‡ºç°åœ¨2çš„å³è¾¹ï¼Œå› æ­¤7åªæœ‰å¯èƒ½å‡ºç°åœ¨2çš„ä¸‹è¾¹ã€‚äºæ˜¯æˆ‘ä»¬æŠŠæ•°å­—2æ‰€åœ¨çš„è¡Œä¹Ÿå‰”é™¤ï¼Œåªåˆ†æå‰©ä¸‹çš„ä¸‰è¡Œä¸¤åˆ—æ•°å­—ï¼Œå¦‚å›¾2.2(c)æ‰€ç¤ºã€‚åœ¨å‰©ä¸‹çš„æ•°å­—ä¸­ï¼Œæ•°å­—4ä½äºå³ä¸Šè§’ï¼Œå’Œå‰é¢ä¸€æ ·ï¼Œæˆ‘ä»¬æŠŠæ•°å­—4æ‰€åœ¨çš„è¡Œä¹Ÿåˆ é™¤ï¼Œæœ€åå‰©ä¸‹ä¸¤è¡Œä¸¤åˆ—æ•°å­—ï¼Œå¦‚å›¾2.2ï¼ˆd)æ‰€ç¤ºã€‚ åœ¨å‰©ä¸‹çš„ä¸¤è¡Œä¸¤åˆ—4ä¸ªæ•°å­—ä¸­ï¼Œä½äºå³ä¸Šè§’çš„åˆšå¥½å°±æ˜¯æˆ‘ä»¬è¦æŸ¥æ‰¾çš„æ•°å­—7ï¼Œäºæ˜¯æŸ¥æ‰¾è¿‡ç¨‹å°±å¯ä»¥ç»“æŸäº†ã€‚ æ³¨ï¼šçŸ©é˜µä¸­åŠ é˜´å½±çš„åŒºåŸŸæ˜¯ä¸‹ä¸€æ­¥æŸ¥æ‰¾çš„èŒƒå›´ã€‚ æ€»ç»“ä¸Šè¿°ææ‰¾çš„è®¨ç¨‹ï¼Œæˆ‘ä»¬å‘ç°å¦‚ä¸‹è§„å¾‹ï¼šé¦–å…ˆé€‰å–æ•°ç»„ä¸­å³ä¸Šè§’çš„æ•°å­—ã€‚å¦‚æœè¯¥æ•°å­—ç­‰äºè¦æŸ¥æ‰¾çš„æ•°å­—ï¼Œåˆ™æŸ¥æ‰¾è¿‡ç¨‹ç»“æŸï¼›å¦‚æœè¯¥æ•°å­—å¤§äºè¦æŸ¥æ‰¾çš„æ•°å­—ï¼Œåˆ™å‰”é™¤è¿™ä¸ªæ•°å­—æ‰€åœ¨çš„åˆ—ï¼›å¦‚æœè¯¥æ•°å­—å°äºè¦æŸ¥æ‰¾çš„æ•°å­—ï¼Œåˆ™å‰”é™¤è¿™ä¸ªæ•°å­—æ‰€åœ¨çš„è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¦æŸ¥æ‰¾çš„æ•°å­—ä¸åœ¨æ•°ç»„çš„å³ä¸Šè§’ï¼Œåˆ™æ¯ä¸€æ¬¡éƒ½åœ¨æ•°ç»„çš„æŸ¥æ‰¾èŒƒå›´ä¸­å‰”é™¤ä¸€è¡Œæˆ–è€…ä¸€åˆ—ï¼Œè¿™æ ·æ¯ä¸€æ­¥éƒ½å¯ä»¥ç¼©å°æŸ¥æ‰¾çš„èŒƒå›´ï¼Œç›´åˆ°æ‰¾åˆ°è¦æŸ¥æ‰¾çš„æ•°å­—ï¼Œæˆ–è€…æŸ¥æ‰¾èŒƒå›´ä¸ºç©ºã€‚ æŠŠæ•´ä¸ªæŸ¥æ‰¾è¿‡ç¨‹åˆ†ææ¸…æ¥šä¹‹åï¼Œæˆ‘ä»¬å†å†™ä»£ç å°±ä¸æ˜¯ä¸€ä»¶å¾ˆéš¾çš„äº‹æƒ…äº†ã€‚ä¸‹é¢æ˜¯ä¸Šè¿°æ€è·¯å¯¹åº”çš„å‚è€ƒä»£ç ï¼š bool Find(int* matrix, int rows, int columns, int number) { bool found = false; if(matrix != nullptr && rows > 0 && columns > 0) { int row = 0; int column = columns - 1; while(row =0) { if(matrix[row * columns + column] == number) { found = true; break; } else if(matrix[row * columns + column] > number) -- column; else ++ row; } } return found; } åœ¨å‰é¢çš„åˆ†æä¸­ï¼Œæˆ‘ä»¬æ¯æ¬¡éƒ½é€‰å–æ•°ç»„æŸ¥æ‰¾èŒƒå›´å†…çš„å³ä¸Šè§’æ•°å­—ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰å–å·¦ä¸‹è§’çš„æ•°å­—ã€‚æ„Ÿå…´è¶£çš„è¯»è€…ä¸å¦¨è‡ªå·±åˆ†æä¸€ä¸‹æ¯æ¬¡éƒ½é€‰å–å·¦ä¸‹è§’æ•°å­—çš„æŸ¥æ‰¾è¿‡ç¨‹ã€‚ä½†æˆ‘ä»¬ä¸èƒ½é€‰æ‹©å·¦ä¸Šè§’æ•°å­—æˆ–è€…å³ä¸‹è§’æ•°å­—ã€‚ä»¥å·¦ä¸Šè§’æ•°å­—ä¸ºä¾‹ï¼Œæœ€åˆæ•°å­—1ä½äºåˆå§‹æ•°ç»„çš„å·¦ä¸Šè§’ï¼Œç”±äº1å°äº7ï¼Œé‚£ä¹ˆ7åº”è¯¥ä½äº1çš„å³è¾¹æˆ–è€…ä¸‹è¾¹ã€‚æ­¤æ—¶æˆ‘ä»¬æ—¢ä¸èƒ½ä»æŸ¥æ‰¾èŒƒå›´å†…å‰”é™¤1æ‰€åœ¨çš„è¡Œï¼Œä¹Ÿä¸èƒ½å‰”é™¤1æ‰€åœ¨çš„åˆ—ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ— æ³•ç¼©å°æŸ¥æ‰¾çš„èŒƒå›´ã€‚ å‰‘æŒ‡ Offer P44ï¼Œæœ¬é¢˜å®Œæ•´çš„æºä»£ç ï¼šhttps://github.com/zhedahht/CodingInterviewChinese2/tree/master/04_FindInPartiallySortedMatrix "},"pages/é¢è¯•ç³»åˆ—/æ›¿æ¢ç©ºæ ¼.html":{"url":"pages/é¢è¯•ç³»åˆ—/æ›¿æ¢ç©ºæ ¼.html","title":"æ›¿æ¢ç©ºæ ¼","keywords":"","body":"æ›¿æ¢ç©ºæ ¼ é¢˜ç›®ï¼šè¯·å®ç°ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠå­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªç©ºæ ¼æ›¿æ¢æˆ\"%20\"ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥â€œWe are happy.â€ï¼Œåˆ™è¾“å‡ºâ€œWe%20are%20happy.â€ã€‚ åœ¨ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œå¦‚æœURLå‚æ•°ä¸­å«æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œå¦‚ç©ºæ ¼ã€'#'ç­‰ï¼Œåˆ™å¯èƒ½å¯¼è‡´æœåŠ¡å™¨ç«¯æ— æ³•è·å¾—æ­£ç¡®çš„å‚æ•°å€¼ã€‚æˆ‘ä»¬éœ€è¦å°†è¿™äº›ç‰¹æ®Šç¬¦å·è½¬æ¢æˆæœåŠ¡å™¨å¯ä»¥è¯†åˆ«çš„å­—ç¬¦ã€‚è½¬æ¢çš„è§„åˆ™æ˜¯åœ¨'%'åé¢è·Ÿä¸ŠASCIIç çš„ä¸¤ä½åå…­è¿›åˆ¶çš„è¡¨ç¤ºã€‚æ¯”å¦‚ç©ºæ ¼çš„ASCIç æ˜¯32ï¼Œå³åå…­è¿›åˆ¶çš„0x20,å› æ­¤ç©ºæ ¼è¢«æ›¿æ¢æˆ\"%20\"ã€‚å†æ¯”å¦‚'#'çš„ASCâ…¡ç ä¸º35ï¼Œå³åå…­è¿›åˆ¶çš„0x23ï¼Œå®ƒåœ¨URLä¸­è¢«æ›¿æ¢ä¸º\"%23\"ã€‚ çœ‹åˆ°è¿™ä¸ªé¢˜ç›®ï¼Œæˆ‘ä»¬é¦–å…ˆåº”è¯¥æƒ³åˆ°çš„æ˜¯åŸæ¥ä¸€ä¸ªç©ºæ ¼å­—ç¬¦ï¼Œæ›¿æ¢ä¹‹åå˜æˆ'%'ã€'2'å’Œ'0'è¿™3ä¸ªå­—ç¬¦ï¼Œå› æ­¤å­—ç¬¦ä¸²ä¼šå˜é•¿ã€‚å¦‚æœæ˜¯åœ¨åŸæ¥çš„å­—ç¬¦ä¸²ä¸Šè¿›è¡Œæ›¿æ¢ï¼Œå°±æœ‰å¯èƒ½è¦†ç›–ä¿®æ”¹åœ¨è¯¥å­—ç¬¦ä¸²åé¢çš„å†…å­˜ã€‚å¦‚æœæ˜¯åˆ›å»ºæ–°çš„å­—ç¬¦ä¸²å¹¶åœ¨æ–°çš„å­—ç¬¦ä¸²ä¸Šè¿›è¡Œæ›¿æ¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è‡ªå·±åˆ†é…è¶³å¤Ÿå¤šçš„å†…å­˜ã€‚ç”±äºæœ‰ä¸¤ç§ä¸åŒçš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬åº”è¯¥å‘é¢è¯•å®˜é—®æ¸…æ¥šï¼Œè®©ä»–æ˜ç¡®å‘Šè¯‰æˆ‘ä»¬ä»–çš„éœ€æ±‚ã€‚å‡è®¾é¢è¯•å®˜è®©æˆ‘ä»¬åœ¨åŸæ¥çš„å­—ç¬¦ä¸²ä¸Šè¿›è¡Œæ›¿æ¢ï¼Œå¹¶ä¸”ä¿è¯è¾“å…¥çš„å­—ç¬¦ä¸²åé¢æœ‰è¶³å¤Ÿå¤šçš„ç©ºä½™å†…å­˜ã€‚ æ—¶é—´å¤æ‚åº¦ä¸ºO(nÂ²)çš„è§£æ³•ï¼Œä¸è¶³ä»¥æ‹¿åˆ°Offer ç°åœ¨æˆ‘ä»¬è€ƒè™‘æ€ä¹ˆæ‰§è¡Œæ›¿æ¢æ“ä½œã€‚æœ€ç›´è§‚çš„åšæ³•æ˜¯ä»å¤´åˆ°å°¾æ‰«æå­—ç¬¦ä¸²ï¼Œæ¯æ¬¡ç¢°åˆ°ç©ºæ ¼å­—ç¬¦çš„æ—¶å€™è¿›è¡Œæ›¿æ¢ã€‚ç”±äºæ˜¯æŠŠ1ä¸ªå­—ç¬¦æ›¿æ¢æˆ3ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬å¿…é¡»è¦æŠŠç©ºæ ¼åé¢æ‰€æœ‰çš„å­—ç¬¦éƒ½åç§»2å­—èŠ‚ï¼Œå¦åˆ™å°±æœ‰ä¸¤ä¸ªå­—ç¬¦è¢«è¦†ç›–äº†ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä»å¤´åˆ°å°¾æŠŠ\"We are happy.\"ä¸­çš„æ¯ä¸ªç©ºæ ¼æ›¿æ¢æˆ\"%20\"ã€‚ä¸ºäº†å½¢è±¡èµ·è§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªè¡¨æ ¼æ¥è¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œè¡¨æ ¼ä¸­çš„æ¯ä¸ªæ ¼å­è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå¦‚å›¾2.3(a)æ‰€ç¤ºã€‚ æ³¨ï¼š(a)å­—ç¬¦ä¸²\"We are happy.\"ã€‚(b)æŠŠå­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªç©ºæ ¼æ›¿æ¢æˆ%20ã€‚ç°è‰²èƒŒæ™¯è¡¨ç¤ºéœ€è¦ç§»åŠ¨çš„å­—ç¬¦ã€‚(c)æŠŠå­—ç¬¦ä¸²ä¸­çš„ç¬¬äºŒä¸ªç©ºæ ¼æ›¿æ¢æˆ%20ã€‚æµ…ç°è‰²èƒŒæ™¯è¡¨ç¤ºéœ€è¦ç§»åŠ¨ä¸€æ¬¡çš„å­—ç¬¦ï¼Œæ·±ç°è‰²èƒŒæ™¯è¡¨ç¤ºéœ€è¦ç§»åŠ¨ä¸¤æ¬¡çš„å­—ç¬¦ã€‚ æˆ‘ä»¬æ›¿æ¢ç¬¬ä¸€ä¸ªç©ºæ ¼ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å˜æˆå›¾2.3ï¼ˆbï¼‰ä¸­çš„å†…å®¹ï¼Œè¡¨æ ¼ä¸­ç°è‰²èƒŒæ™¯çš„æ ¼å­è¡¨ç¤ºéœ€è¦è¿›è¡Œç§»åŠ¨çš„åŒºåŸŸã€‚æ¥ç€æˆ‘ä»¬æ›¿æ¢ç¬¬äºŒä¸ªç©ºæ ¼ï¼Œæ›¿æ¢ä¹‹åçš„å†…å®¹å¦‚å›¾2.3ï¼ˆcï¼‰æ‰€ç¤ºã€‚åŒæ—¶ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ç”¨æ·±ç°è‰²èƒŒæ™¯æ ‡æ³¨çš„â€œhappyâ€éƒ¨åˆ†è¢«ç§»åŠ¨äº†ä¸¤æ¬¡ã€‚ å‡è®¾å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯nã€‚å¯¹æ¯ä¸ªç©ºæ ¼å­—ç¬¦ï¼Œéœ€è¦ç§»åŠ¨åé¢O(n)ä¸ªå­—ç¬¦ï¼Œå› æ­¤å¯¹äºå«æœ‰O(n)ä¸ªç©ºæ ¼å­—ç¬¦çš„å­—ç¬¦ä¸²è€Œè¨€ï¼Œæ€»çš„æ—¶é—´æ•ˆç‡æ˜¯O(nÂ²)ã€‚ å½“æˆ‘ä»¬æŠŠè¿™ç§æ€è·¯é˜è¿°ç»™é¢è¯•å®˜åï¼Œä»–ä¸ä¼šå°±æ­¤æ»¡æ„ï¼Œä»–å°†è®©æˆ‘ä»¬å¯»æ‰¾æ›´å¿«çš„æ–¹æ³•ã€‚åœ¨å‰é¢çš„åˆ†æä¸­ï¼Œæˆ‘ä»¬å‘ç°æ•°ç»„ä¸­å¾ˆå¤šå­—ç¬¦éƒ½ç§»åŠ¨äº†å¾ˆå¤šæ¬¡ï¼Œèƒ½ä¸èƒ½å‡å°‘ç§»åŠ¨æ¬¡æ•°å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚æˆ‘ä»¬æ¢ä¸€ç§æ€è·¯ï¼ŒæŠŠä»å‰å‘åæ›¿æ¢æ”¹æˆä»åå‘å‰æ›¿æ¢ã€‚ æ—¶é—´å¤æ‚åº¦ä¸ºO(n)çš„è§£æ³•ï¼Œæå®šOfferå°±é å®ƒäº† æˆ‘ä»¬å¯ä»¥å…ˆéå†ä¸€æ¬¡å­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±èƒ½ç»Ÿè®¡å‡ºå­—ç¬¦ä¸²ä¸­ç©ºæ ¼çš„æ€»å¹¶å¯ä»¥ç”±æ­¤è®¡ç®—å‡ºæ›¿æ¢ä¹‹åçš„å­—ç¬¦ä¸²çš„æ€»é•¿åº¦ã€‚æ¯æ›¿æ¢ä¸€ä¸ªç©ºæ ¼ï¼Œé•¿åº¦å¢åŠ 2ï¼Œå› æ­¤æ›¿æ¢ä»¥åå­—ç¬¦ä¸²çš„é•¿åº¦ç­‰äºåŸæ¥çš„é•¿åº¦åŠ ä¸Š2ä¹˜ä»¥ç©ºæ ¼æ•°ç›®ã€‚æˆ‘ä»¬è¿˜æ˜¯ä»¥å‰é¢çš„å­—ç¬¦ä¸²\"We are happy.\"ä¸ºä¾‹ã€‚\"We are happy.\"è¿™ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯14ï¼ˆåŒ…æ‹¬ç»“å°¾ç¬¦å·0ï¼‰ï¼Œé‡Œé¢æœ‰ä¸¤ä¸ªç©ºæ ¼ï¼Œå› æ­¤æ›¿æ¢ä¹‹åå­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯18ã€‚ æˆ‘ä»¬ä»å­—ç¬¦ä¸²çš„åé¢å¼€å§‹å¤åˆ¶å’Œæ›¿æ¢ã€‚é¦–å…ˆå‡†å¤‡ä¸¤ä¸ªæŒ‡é’ˆï¼šP1å’ŒP2ã€‚P1æŒ‡å‘åŸå§‹å­—ç¬¦ä¸²çš„æœ«å°¾ï¼Œè€ŒP2æŒ‡å‘æ›¿æ¢ä¹‹åçš„å­—ç¬¦ä¸²çš„æœ«å°¾ï¼Œå¦‚å›¾2.4(a)æ‰€ç¤ºã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å‘å‰ç§»åŠ¨æŒ‡é’ˆP1ï¼Œé€ä¸ªæŠŠå®ƒæŒ‡å‘çš„å­—ç¬¦å¤åˆ¶åˆ°P2æŒ‡å‘çš„ä½ç½®ï¼Œç›´åˆ°ç¢°åˆ°ç¬¬ä¸€ä¸ªç©ºæ ¼ä¸ºæ­¢ã€‚æ­¤æ—¶å­—ç¬¦ä¸²å¦‚å›¾2.4(b)æ‰€ç¤ºï¼Œç°è‰²èƒŒæ™¯çš„åŒºåŸŸæ˜¯è¿›è¡Œäº†å­—ç¬¦å¤åˆ¶ï¼ˆç§»åŠ¨ï¼‰çš„åŒºåŸŸã€‚ç¢°åˆ°ç¬¬ä¸€ä¸ªç©ºæ ¼ä¹‹åï¼ŒæŠŠP1å‘å‰ç§»åŠ¨1æ ¼ï¼Œåœ¨P2ä¹‹å‰æ’å…¥å­—ç¬¦ä¸²\"%20\"ã€‚ç”±äº\"%20\"çš„é•¿åº¦ä¸º3ï¼ŒåŒæ—¶ä¹Ÿè¦æŠŠP2å‘å‰ç§»åŠ¨3æ ¼ï¼Œå¦‚å›¾2.4(c)æ‰€ç¤ºã€‚ æˆ‘ä»¬æ¥ç€å‘å‰å¤åˆ¶ï¼Œç›´åˆ°ç¢°åˆ°ç¬¬äºŒä¸ªç©ºæ ¼ï¼Œå¦‚å›¾2.4(d)æ‰€ç¤ºã€‚å’Œä¸Šä¸€æ¬¡ä¸€æ ·ï¼Œæˆ‘ä»¬å†æŠŠP1å‘å‰ç§»åŠ¨1æ ¼ï¼Œå¹¶æŠŠP2å‘å‰ç§»åŠ¨3æ ¼æ’å…¥\"%20â€ï¼Œå¦‚å›¾2.4ï¼ˆeï¼‰æ‰€ç¤ºã€‚æ­¤æ—¶P1å’ŒP2æŒ‡å‘åŒä¸€ä½ç½®ï¼Œè¡¨æ˜æ‰€æœ‰ç©ºæ ¼éƒ½å·²ç»æ›¿æ¢å®Œæ¯•ã€‚ ä»ä¸Šé¢çš„åˆ†æä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ‰€æœ‰çš„å­—ç¬¦éƒ½åªå¤åˆ¶ï¼ˆç§»åŠ¨ï¼‰ä¸€æ¬¡ï¼Œå› æ­¤è¿™ä¸ªç®—æ³•çš„æ—¶é—´æ•ˆç‡æ˜¯O(n)ï¼Œæ¯”ç¬¬ä¸€ä¸ªæ€è·¯è¦å¿«ã€‚ æ³¨ï¼šå›¾ä¸­å¸¦æœ‰é˜´å½±çš„åŒºåŸŸè¡¨ç¤ºè¢«ç§»åŠ¨çš„å­—ç¬¦ã€‚(a)æŠŠç¬¬ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å­—ç¬¦ä¸²çš„æœ«å°¾ï¼ŒæŠŠç¬¬äºŒä¸ªæŒ‡é’ˆæŒ‡å‘æ›¿æ¢ä¹‹åçš„å­—ç¬¦ä¸²çš„æœ«å°¾ã€‚(b)ä¾æ¬¡å¤åˆ¶å­—ç¬¦ä¸²çš„å†…å®¹ï¼Œç›´è‡³ç¬¬ä¸€ä¸ªæŒ‡é’ˆç¢°åˆ°ç¬¬ä¸€ä¸ªç©ºæ ¼ã€‚(c)æŠŠç¬¬ä¸€ä¸ªç©ºæ ¼æ›¿æ¢æˆ\"%20â€ï¼ŒæŠŠç¬¬ä¸€ä¸ªæŒ‡é’ˆå‘å‰ç§»åŠ¨1æ ¼ï¼ŒæŠŠç¬¬äºŒä¸ªæŒ‡é’ˆå‘å‰ç§»åŠ¨3æ ¼ã€‚(d)ä¾æ¬¡å‘å‰å¤åˆ¶å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ï¼Œç›´è‡³ç¢°åˆ°ç©ºæ ¼ã€‚ï¼ˆeï¼‰æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„å€’æ•°ç¬¬äºŒä¸ªç©ºæ ¼ï¼ŒæŠŠç¬¬ä¸€ä¸ªæŒ‡é’ˆå‘å‰ç§»åŠ¨1æ ¼ï¼ŒæŠŠç¬¬äºŒä¸ªæŒ‡é’ˆå‘å‰ç§»åŠ¨3æ ¼ã€‚ åœ¨é¢è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å’Œå‰é¢çš„åˆ†æä¸€æ ·ç”»ä¸€ä¸¤ä¸ªç¤ºæ„å›¾è§£é‡Šè‡ªå·±çš„æ€è·¯ï¼Œè¿™æ ·æ—¢èƒ½å¸®åŠ©æˆ‘ä»¬å˜æ¸…æ€è·¯ï¼Œä¹Ÿèƒ½ä½¿æˆ‘ä»¬å’Œé¢è¯•å®˜çš„äº¤æµå˜å¾—æ›´åŠ é«˜æ•ˆã€‚åœ¨é¢è¯•å®˜è‚¯å®šæˆ‘ä»¬çš„æ€è·¯ä¹‹åï¼Œå°±å¯ä»¥å¼€å§‹å†™ä»£ç äº†ã€‚ä¸‹é¢æ˜¯å‚è€ƒä»£ç ï¼š /*length ä¸ºå­—ç¬¦æ•°ç»„strçš„æ€»å®¹é‡ï¼Œå¤§äºæˆ–ç­‰äºå­—ç¬¦ä¸²strçš„å®é™…é•¿åº¦*/ void ReplaceBlank(char str[], int length) { if(str == nullptr && length length) return; int indexOfOriginal = originalLength; int indexOfNew = newLength; while(indexOfOriginal >= 0 && indexOfNew > indexOfOriginal) { if(str[indexOfOriginal] == ' ') { str[indexOfNew --] = '0'; str[indexOfNew --] = '2'; str[indexOfNew --] = '%'; } else { str[indexOfNew --] = str[indexOfOriginal]; } -- indexOfOriginal; } } å‰‘æŒ‡ Offer P51ï¼Œæœ¬é¢˜å®Œæ•´çš„æºä»£ç ï¼šhttps://github.com/zhedahht/CodingInterviewChinese2/tree/master/05_ReplaceSpaces "},"pages/é¢è¯•ç³»åˆ—/é“¾è¡¨.html":{"url":"pages/é¢è¯•ç³»åˆ—/é“¾è¡¨.html","title":"é“¾è¡¨","keywords":"","body":"é“¾è¡¨ é“¾è¡¨åº”è¯¥æ˜¯é¢è¯•æ—¶è¢«æåŠæœ€é¢‘ç¹çš„æ•°æ®ç»“æ„ã€‚é“¾è¡¨çš„ç»“æ„å¾ˆç®€å•ï¼Œå®ƒç”±æŒ‡é’ˆæŠŠè‹¥å¹²ä¸ªèŠ‚ç‚¹è¿æ¥æˆé“¾çŠ¶ç»“æ„ã€‚é“¾è¡¨çš„åˆ›å»ºã€æ’å…¥èŠ‚ç‚¹ã€åˆ é™¤èŠ‚ç‚¹ç­‰æ“ä½œéƒ½åªéœ€è¦20è¡Œå·¦å³çš„ä»£ç å°±èƒ½å®ç°ï¼Œå…¶ä»£ç é‡æ¯”è¾ƒé€‚åˆé¢è¯•ã€‚è€Œåƒå“ˆå¸Œè¡¨ã€æœ‰å‘å›¾ç­‰å¤æ‚æ•°æ®ç»“æ„ï¼Œå®ç°å®ƒä»¬çš„ä¸€ä¸ªæ“ä½œéœ€è¦çš„ä»£ç é‡éƒ½è¾ƒå¤§ï¼Œå¾ˆéš¾åœ¨å‡ ååˆ†é’Ÿçš„é¢è¯•ä¸­å®Œæˆã€‚å¦å¤–ï¼Œç”±äºé“¾è¡¨æ˜¯ä¸€ç§åŠ¨æ€çš„æ•°æ®ç»“æ„ï¼Œå…¶éœ€è¦å¯¹æŒ‡é’ˆè¿›è¡Œæ“ä½œï¼Œå› æ­¤åº”è˜è€…éœ€è¦æœ‰è¾ƒå¥½çš„ç¼–ç¨‹åŠŸåº•æ‰èƒ½å†™å‡ºå®Œæ•´çš„æ“ä½œé“¾è¡¨çš„ä»£ç ã€‚è€Œä¸”é“¾è¡¨è¿™ç§æ•°æ®ç»“æ„å¾ˆçµæ´»ï¼Œé¢è¯•å®˜å¯ä»¥ç”¨é“¾è¡¨æ¥è®¾è®¡å…·æœ‰æŒ‘æˆ˜æ€§çš„é¢è¯•é¢˜ã€‚åŸºäºä¸Šè¿°å‡ ä¸ªåŸå› ï¼Œå¾ˆå¤šé¢è¯•å®˜éƒ½ç‰¹åˆ«é’çä¸é“¾è¡¨ç›¸å…³çš„é¢˜ç›®ã€‚ æˆ‘ä»¬è¯´é“¾è¡¨æ˜¯ä¸€ç§åŠ¨æ€æ•°æ®ç»“æ„ï¼Œæ˜¯å› ä¸ºåœ¨åˆ›å»ºé“¾è¡¨æ—¶ï¼Œæ— é¡»çŸ¥é“é“¾è¡¨çš„é•¿åº¦ã€‚å½“æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸ºæ–°èŠ‚ç‚¹åˆ†é…å†…å­˜ï¼Œç„¶åè°ƒæ•´æŒ‡é’ˆçš„æŒ‡å‘æ¥ç¡®ä¿æ–°èŠ‚ç‚¹è¢«é“¾æ¥åˆ°é“¾è¡¨å½“ä¸­ã€‚å†…å­˜åˆ†é…ä¸æ˜¯åœ¨åˆ›å»ºé“¾è¡¨æ—¶ä¸€æ¬¡æ€§å®Œæˆçš„ï¼Œè€Œæ˜¯æ¯æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹åˆ†é…ä¸€æ¬¡å†…å­˜ã€‚ç”±äºæ²¡æœ‰é—²ç½®çš„å†…å­˜ï¼Œé“¾è¡¨çš„ç©ºé—´æ•ˆç‡æ¯”æ•°ç»„é«˜ã€‚å¦‚æœå•å‘é“¾è¡¨çš„èŠ‚ç‚¹å®šä¹‰å¦‚ä¸‹ï¼š struct ListNode { int m_nValue; ListNode* m_pNext; }; é‚£ä¹ˆå¾€è¯¥é“¾è¡¨çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹çš„C++ä»£ç å¦‚ä¸‹ï¼š void AddToTail(ListNode**pHead, int value) { ListNode* pNew = new ListNode(); pNew->m_nValue = value; pNew->m_pNext = nullptr; if(*pHead == nullptr) { *pHead = pNew; } else { ListNode* pNode = *pHead; while(pNode->m_pNext != nullptr) pNode = pNode->m_pNext; pNode->m_pNext = pNew; } } åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬è¦ç‰¹åˆ«æ³¨æ„å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°pHeadæ˜¯ä¸€ä¸ªæŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆã€‚å½“æˆ‘ä»¬å¾€ä¸€ä¸ªç©ºé“¾è¡¨ä¸­æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œæ–°æ’å…¥çš„èŠ‚ç‚¹å°±æ˜¯é“¾è¡¨çš„å¤´æŒ‡é’ˆã€‚ç”±äºæ­¤æ—¶ä¼šæ”¹åŠ¨å¤´æŒ‡é’ˆï¼Œå› æ­¤å¿…é¡»æŠŠpHeadå‚æ•°è®¾ä¸ºæŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆï¼Œå¦åˆ™å‡ºäº†è¿™ä¸ªå‡½æ•°pHeadä»ç„¶æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆã€‚ ç”±äºé“¾è¡¨ä¸­çš„å†…å­˜ä¸æ˜¯ä¸€æ¬¡æ€§åˆ†é…çš„ï¼Œå› è€Œæˆ‘ä»¬æ— æ³•ä¿è¯é“¾è¡¨çš„å†…å­˜å’Œæ•°ç»„ä¸€æ ·æ˜¯è¿ç»­çš„ã€‚å› æ­¤ï¼Œå¦‚æœæƒ³åœ¨é“¾è¡¨ä¸­æ‰¾åˆ°å®ƒçš„ç¬¬iä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªèƒ½ä»å¤´èŠ‚ç‚¹å¼€å§‹ï¼Œæ²¿ç€æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆéå†é“¾è¡¨ï¼Œå®ƒçš„æ—¶é—´æ•ˆç‡ä¸ºO(n)ã€‚è€Œåœ¨æ•°ç»„ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸‹æ ‡åœ¨O(1)æ—¶é—´å†…æ‰¾åˆ°ç¬¬iä¸ªå…ƒç´ ã€‚ä¸‹é¢æ˜¯åœ¨é“¾è¡¨ä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ªå«æœ‰æŸå€¼çš„èŠ‚ç‚¹å¹¶åˆ é™¤è¯¥èŠ‚ç‚¹çš„ä»£ç ï¼š void RemoveNode(ListNode** pHead, int value) { if(pHead == nullptr || *pHead == nullptr) return; ListNode* pToBeDeleted == nullptr; if((*pHead)->m_nValue == value) { pToBeDeleted = *pHead; *pHead = (*pHead)->m_pNext; } else { ListNode* pNode = *pHead; while(pNode->m_pNext != nullptr && pNode->m_pNext->m_nValue != value) pNode = pNode->m_pNext; if(pNode->m_pNext != nullptr && pNode->m_pNext->m_nValue == value) { pToBeDeleted = pNode->m_pNext; pNode->m_pNext = pNode->m_pNext->m_pNext; } } if(pToBeDeleted != nullptr) { delete pToBeDeleted; pToBeDeleted = nullptr; } } å‰‘æŒ‡ Offer P56 "},"pages/é¢è¯•ç³»åˆ—/ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨.html":{"url":"pages/é¢è¯•ç³»åˆ—/ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨.html","title":"ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨","keywords":"","body":"ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨ é¢˜ç›®ï¼šè¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œä»å°¾åˆ°å¤´åè¿‡æ¥æ‰“å°å‡ºæ¯ä¸ªèŠ‚ç‚¹çš„å€¼é“¾è¡¨èŠ‚ç‚¹å®šä¹‰å¦‚ä¸‹ï¼š struct ListNode { int m_nKey; ListNode* m_pNext; }; çœ‹åˆ°è¿™é“é¢˜åï¼Œå¾ˆå¤šäººçš„ç¬¬ä¸€ååº”æ˜¯ä»å¤´åˆ°å°¾è¾“å‡ºå°†ä¼šæ¯”è¾ƒç®€å•ï¼Œäºæ˜¯æˆ‘ä»¬å¾ˆè‡ªç„¶åœ°æƒ³åˆ°æŠŠé“¾è¡¨ä¸­é“¾æ¥èŠ‚ç‚¹çš„æŒ‡é’ˆåè½¬è¿‡æ¥ï¼Œæ”¹å˜é“¾è¡¨çš„æ–¹å‘ï¼Œç„¶åå°±å¯ä»¥ä»å¤´åˆ°å°¾è¾“å‡ºäº†ã€‚ä½†è¯¥æ–¹æ³•ä¼šæ”¹å˜åŸæ¥é“¾è¡¨çš„ç»“æ„ã€‚æ˜¯å¦å…è®¸åœ¨æ‰“å°é“¾è¡¨çš„æ—¶å€™ä¿®æ”¹é“¾è¡¨çš„ç»“æ„ï¼Ÿè¿™å–å†³äºé¢è¯•å®˜çš„è¦æ±‚ï¼Œå› æ­¤åœ¨é¢è¯•çš„æ—¶å€™æˆ‘ä»¬è¦è¯¢é—®æ¸…æ¥šé¢è¯•å®˜çš„è¦æ±‚ã€‚ é¢è¯•å°æç¤ºï¼šåœ¨é¢è¯•ä¸­ï¼Œå¦‚æœæˆ‘ä»¬æ‰“ç®—ä¿®æ”¹è¾“å…¥çš„æ•°æ®ï¼Œåˆ™æœ€å¥½å…ˆé—®é¢è¯•å®˜æ˜¯ä¸æ˜¯å…è®¸ä¿®æ”¹ã€‚ é€šå¸¸æ‰“å°æ˜¯ä¸€ä¸ªåªè¯»æ“ä½œï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æ‰“å°æ—¶ä¿®æ”¹å†…å®¹ã€‚å‡è®¾é¢è¯•å®˜ä¹Ÿè¦æ±‚è¿™ä¸ªé¢˜ç›®ä¸èƒ½æ”¹å˜é“¾è¡¨çš„ç»“æ„ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æƒ³åˆ°è§£å†³è¿™ä¸ªé—®é¢˜è‚¯å®šè¦éå†é“¾è¡¨ã€‚éå†çš„é¡ºåºæ˜¯ä»å¤´åˆ°å°¾ï¼Œå¯è¾“å‡ºçš„é¡ºåºå´æ˜¯ä»å°¾åˆ°å¤´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬ä¸€ä¸ªéå†åˆ°çš„èŠ‚ç‚¹æœ€åä¸€ä¸ªè¾“å‡ºï¼Œè€Œæœ€åä¸€ä¸ªéå†åˆ°çš„èŠ‚ç‚¹ç¬¬ä¸€ä¸ªè¾“å‡ºã€‚è¿™å°±æ˜¯å…¸å‹çš„â€œåè¿›å…ˆå‡ºâ€ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ ˆå®ç°è¿™ç§é¡ºåºã€‚æ¯ç»è¿‡ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼ŒæŠŠè¯¥èŠ‚ç‚¹æ”¾åˆ°ä¸€ä¸ªæ ˆä¸­ã€‚å½“éå†å®Œæ•´ä¸ªé“¾è¡¨åï¼Œå†ä»æ ˆé¡¶å¼€å§‹é€ä¸ªè¾“å‡ºèŠ‚ç‚¹çš„å€¼ï¼Œæ­¤æ—¶è¾“å‡ºçš„èŠ‚ç‚¹çš„é¡ºåºå·±ç»åè½¬è¿‡æ¥äº†ã€‚è¿™ç§æ€è·¯çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š #include \"..\\Utilities\\List.h\" #include void PrintListReversingly_Iteratively(ListNode* pHead) { std::stack nodes; ListNode* pNode = pHead; while(pNode != nullptr) { nodes.push(pNode); pNode = pNode->m_pNext; } while(!nodes.empty()) { pNode = nodes.top(); printf(\"%d\\t\", pNode->m_nValue); nodes.pop(); } } æ—¢ç„¶æƒ³åˆ°äº†ç”¨æ ˆæ¥å®ç°è¿™ä¸ªå‡½æ•°ï¼Œè€Œé€’å½’åœ¨æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ ˆç»“æ„ï¼Œäºæ˜¯å¾ˆè‡ªç„¶åœ°åˆæƒ³åˆ°äº†ç”¨é€’å½’æ¥å®ç°ã€‚è¦å®ç°åè¿‡æ¥è¾“å‡ºé“¾è¡¨ï¼Œæˆ‘ä»¬æ¯è®¿é—®åˆ°ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œå…ˆé€’å½’è¾“å‡ºå®ƒåé¢çš„èŠ‚ç‚¹ï¼Œå†è¾“å‡ºè¯¥èŠ‚ç‚¹è‡ªèº«ï¼Œè¿™æ ·é“¾è¡¨çš„è¾“å‡ºç»“æœå°±åè¿‡æ¥äº†ã€‚ åŸºäºè¿™æ ·çš„æ€è·¯ï¼Œä¸éš¾å†™å‡ºå¦‚ä¸‹ä»£ç ï¼š void PrintListReversingly_Recursively(ListNode* pHead) { if(pHead != nullptr) { if (pHead->m_pNext != nullptr) { PrintListReversingly_Recursively(pHead->m_pNext); } printf(\"%d\\t\", pHead->m_nValue); } } ä¸Šé¢çš„åŸºäºé€’å½’çš„ä»£ç çœ‹èµ·æ¥å¾ˆç®€æ´ï¼Œä½†æœ‰ä¸€ä¸ªé—®é¢˜ï¼šå½“é“¾è¡¨éå¸¸é•¿çš„æ—¶å€™ï¼Œå°±ä¼šå¯¼è‡´å‡½æ•°è°ƒç”¨çš„å±‚çº§å¾ˆæ·±ï¼Œä»è€Œæœ‰å¯èƒ½å¯¼è‡´å‡½æ•°è°ƒç”¨æ ˆæº¢å‡ºã€‚æ˜¾ç„¶ç”¨æ ˆåŸºäºå¾ªç¯å®ç°çš„ä»£ç çš„é²æ£’æ€§è¦å¥½ä¸€äº›ã€‚æ›´å¤šå…³äºå¾ªç¯å’Œé€’å½’çš„è®¨è®ºï¼Œè¯¦è§æœ¬ä¹¦çš„2.4.1èŠ‚ã€‚ å‰‘æŒ‡ Offer P58ï¼Œæœ¬é¢˜å®Œæ•´çš„æºä»£ç ï¼šhttps://github.com/zhedahht/CodingInterviewChinese2/tree/master/06_PrintListInReversedOrder "},"pages/é¢è¯•ç³»åˆ—/é¢è¯•å‡†å¤‡.html":{"url":"pages/é¢è¯•ç³»åˆ—/é¢è¯•å‡†å¤‡.html","title":"é¢è¯•å‡†å¤‡","keywords":"","body":"é¢è¯•å‡†å¤‡ è‡ªæˆ‘ä»‹ç» è°¢è°¢æ‚¨ä»Šå¤©ç»™æˆ‘çš„è¿™æ¬¡æœºä¼šï¼Œæˆ‘æ˜¯Greenï¼Œæˆ‘çš„ä¸“ä¸šæ˜¯è®¡ç®—æœºé€šä¿¡ï¼Œ9å¹´iOSå¼€å‘ç»éªŒï¼Œ3å¹´Javaå¼€å‘ç»éªŒï¼Œæ‹…ä»»è¿‡iOSå›¢é˜Ÿè´Ÿè´£äººï¼Œæœ‰å›¢é˜Ÿç®¡ç†ç»éªŒï¼Œæœ‰ç»„ä»¶åŒ–å¼€å‘ç»éªŒï¼Œå…·å¤‡ç‹¬ç«‹å¼€å‘èƒ½åŠ›ï¼Œå…·å¤‡æ–‡æ¡£ç¼–å†™èƒ½åŠ›ï¼Œæœ‰è‰¯å¥½çš„ä»£ç ä¹ æƒ¯ã€‚ Thank you for giving me the opportunity to be interviewed for this position today. I'm Green. My major is computer communication. I have 9 years of experience in iOS development, 3 years of experience in Java development, and served as the leader of the iOS team. I have experience in team management, component development, independent development, document writing, and good code habits. æˆ‘å¤§å­¦çš„ä¸“ä¸šæ˜¯è®¡ç®—æœºé€šä¿¡ï¼Œ10å¹´æ¥åˆ°ä¸Šæµ·ä»äº‹Javaåç«¯æ–¹é¢çš„å·¥ä½œï¼Œåšäº†å‡ ä¸ªOAåŠŸèƒ½çš„ç³»ç»Ÿï¼Œä¸»è¦ä½¿ç”¨çš„æŠ€æœ¯æœ‰JavaWebç›¸å…³çš„æŠ€æœ¯ï¼ŒåƒJAVAã€SpringMVCã€HTMlã€JSç­‰ã€‚ä»äº‹Javaå¤§æ¦‚3å¹´å¤šï¼Œæˆ‘è‡ªå­¦è¿›å…¥åˆ°äº†iOSè¡Œä¸šï¼ŒæœŸé—´åšè¿‡å¤šåª’ä½“æ‹æ‘„é¡¹ç›®ï¼ŒRTCç›´æ’­é¡¹ç›®ï¼Œå¯¹è‡ªç ”æ’­æ”¾å™¨æœ‰æ‰€äº†è§£ã€‚æˆ‘æŒæ¡çš„æŠ€æœ¯ç« æœ‰OCã€Swiftï¼Œç†Ÿæ‚‰Cã€C++ç¼–ç¨‹ï¼ŒæŒæ¡ç»„ä»¶åŒ–ç¼–ç¨‹ï¼Œèƒ½å¤Ÿç‹¬ç«‹å¼€å‘iOSé¡¹ç›®ã€‚æœ€è¿‘ä¹Ÿå­¦ä¹ äº†Flutterç›¸å…³çŸ¥è¯†ï¼Œé€šè¿‡é˜…è¯»å¼€æºé¡¹ç›®ï¼Œå¯¹FlutteræŠ€æœ¯æ ˆäº†è§£ã€‚ æ“…é•¿æŠ€æœ¯ ç†Ÿç»ƒOCã€Swiftã€Javaã€RxSwiftã€MVVMã€MVCã€Cocoapodsã€GCDã€Git Flowã€‚ç†Ÿæ‚‰Cã€C++ã€Mavenã€HTMLã€JSã€CSSã€SQLã€Mysqlã€Tomcatã€JDBCã€SSHã€‚äº†è§£Androidã€Flutterã€ReactNativeã€libRTMPã€OpenGLESã€FFmpegã€‚ è§†é¢‘æ’­æ”¾å™¨ ç»„ä»¶åŒ–å¼€å‘ è®¾è®¡æ¨¡å¼ æ’åºç®—æ³• æ•°æ®ç»“æ„ RSA CICD SwiftUI æ•æ·å¼€å‘ å¦‚ä½•å­¦ä¹  åœ¨å·¥ä½œä¸­ï¼Œå¦‚æœé‡åˆ°è‡ªå·±ä¸ä¼šçš„é—®é¢˜ï¼Œé€šè¿‡Googleã€ç™¾åº¦ç›¸å…³èµ„æ–™ï¼Œç„¶åæ€»ç»“è®°å½•ã€‚å­¦ä¹ ä¸€é—¨æ–°æŠ€æœ¯ï¼Œæˆ‘ä¼šé€šè¿‡æŸ¥çœ‹å…¶å®˜æ–¹æ•™ç¨‹æˆ–æ‰¾å­¦ä¹ è§†é¢‘ï¼ŒåŒæ—¶ä¹°ä¸€æœ¬ä¹¦ç±é˜…è¯»ï¼Œç„¶åå®è·µï¼Œå†æ ¹æ®è‡ªå·±çš„ç†è§£æ€»ç»“å†™æ–‡ç« è®°å½•ã€‚ èŒä¸šè§„åˆ’ ç»“åˆè‡ªèº«è¿˜æœ‰ç›®å‰çš„èŒä¸šç¯å¢ƒï¼Œæˆ‘æœ‰è®¤çœŸæƒ³è¿‡è¿™ä¸ªé—®é¢˜ã€‚åœ¨å·¥ä½œæ–¹é¢ï¼Œæˆ‘æƒ³é€šè¿‡ç§¯æå®Œæˆå·¥ä½œä»»åŠ¡ï¼Œç§¯ç´¯å„æ–¹é¢ç»éªŒï¼Œè®©è‡ªå·±æˆä¸ºè¿™ä¸ªé¢†åŸŸçš„ä¸“ä¸šäººå£«ï¼Œä¹Ÿå¸Œæœ›æœ‰æœºä¼šèƒ½å¤Ÿå¸¦é¢†å›¢é˜Ÿï¼Œæˆä¸ºä¼˜ç§€çš„ç®¡ç†è€…ï¼Œä¸ºå•ä½ä½œå‡ºæ›´å¤§çš„è´¡çŒ®ï¼Œå®ç°åŒèµ¢ã€‚åœ¨å­¦ä¹ æ–¹é¢ï¼Œæ‰“ç®—åœ¨iOSä¸“ä¸šé¢†åŸŸåšè¿›ä¸€æ­¥å­¦ä¹ å’Œç ”ç©¶ï¼ŒåŒæ—¶ä¹Ÿå­¦ä¹ Androidã€H5ç­‰æŠ€æœ¯ï¼Œä¸ºä»¥åè‡ªå·±æˆä¸ºç®¡ç†è€…åšä¸‹é“ºå«ã€‚ æé—®ç¯èŠ‚ é¡¹ç›®ä¸­ä¼šä½¿ç”¨SwiftUIå—ï¼Ÿ é¡¹ç›®æ˜¯é’ˆå¯¹æµ·å¤–å®¢æˆ·å—ï¼Ÿ ä¸€ä¸ªåŠŸèƒ½éœ€æ±‚ä¸‹æ¥ï¼Œåœ¨å¼€å‘äººå‘˜å¼€å‘ç€å‰ï¼Œæ‚¨æœ€å¸Œæœ›å®ƒåšå¥½å“ªäº›å¼€å‘å‡†å¤‡ï¼Ÿ é¡¹ç›®ä¸­éš¾å…å­˜åœ¨ä¸€äº›ä¸å¾—ä¸è¿›è¡Œé‡æ„ä¼˜åŒ–çš„ä»£ç ï¼Œæ‚¨æ˜¯å¦‚ä½•çœ‹å¾…è¿™ä¸ªé—®é¢˜çš„ï¼Ÿ é¢è¯•é—®é¢˜ å‡½æ•°å¼ç¼–ç¨‹ï¼šå‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯ï¼Œå…è®¸æŠŠå‡½æ•°æœ¬èº«ä½œä¸ºå‚æ•°ä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°ï¼Œè¿˜å…è®¸è¿”å›ä¸€ä¸ªå‡½æ•°ï¼ çº¿ç¨‹é—´é€šä¿¡ï¼šå†…å­˜å…±äº«ã€é€šçŸ¥ã€ç­‰å¾…ã€é”ã€‚ swiftç‰¹æ€§ï¼šå…ƒç»„ã€å¯é€‰ã€è§£åŒ…ã€æ‰©å±•ã€æ³›å‹ã€æšä¸¾ã€æ³›å‹å…³è”ã€å‘½åç©ºé—´ã€æƒé™å…³é”®å­—ã€åè®®ã€é—­åŒ…ã€‚ å†…å­˜ç®¡ç†ï¼šSwiftä½¿ç”¨è‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼ˆARCï¼‰æ¥ç®€åŒ–å†…å­˜ç®¡ç†ï¼Œä¸OCä¸€è‡´ã€‚ swiftè¯­è¨€ã€æ¶æ„èƒ½åŠ›ã€blockåŸç†ã€swiftç‰¹æ€§ã€é¡¹ç›®ç®¡ç†ã€ä»£ç è§„èŒƒã€‚ å†…å­˜ç®¡ç† OC å’Œ Swift çš„å¼±å¼•ç”¨æºç åˆ†æiOSå†…å­˜åˆ†é…-æ ˆå’Œå † å¤šçº¿ç¨‹ å…³äºiOSå¤šçº¿ç¨‹ï¼Œä½ çœ‹æˆ‘å°±å¤Ÿäº† å‚è€ƒé“¾æ¥ Swift è¯­è¨€çš„ä¸€äº›åŠŸèƒ½ç‰¹æ€§ä¸ºä½•é¢è¯•æ—¶éƒ½ä¼šé—®ä½ çš„èŒä¸šè§„åˆ’å‘¢ï¼Ÿè¯¥å¦‚ä½•å›ç­”å‘¢ï¼ŸIOSé¢è¯•é¢˜(å…¶ä»–) --- è‹±æ–‡è‡ªæˆ‘ä»‹ç» å‡¯æ· ä»£ç åŠ å›º** https://zhuanlan.zhihu.com/p/33109826 1.å­—ç¬¦ä¸²æ··æ·† å¯¹åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨åˆ°çš„å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†ï¼Œä¿è¯æºç è¢«é€†å‘åä¸èƒ½çœ‹å‡ºå­—ç¬¦ä¸²çš„ç›´è§‚å«ä¹‰ã€‚ 2.ç±»åã€æ–¹æ³•åæ··æ·† å¯¹åº”ç”¨ç¨‹åºçš„æ–¹æ³•åå’Œæ–¹æ³•ä½“è¿›è¡Œæ··æ·†ï¼Œä¿è¯æºç è¢«é€†å‘åå¾ˆéš¾æ˜ç™½å®ƒçš„çœŸæ­£åŠŸèƒ½ã€‚ 3.ç¨‹åºç»“æ„æ··æ·†åŠ å¯† å¯¹åº”ç”¨ç¨‹åºé€»è¾‘ç»“æ„è¿›è¡Œæ‰“ä¹±æ··æ’ï¼Œä¿è¯æºç å¯è¯»æ€§é™åˆ°æœ€ä½ã€‚ 4.åè°ƒè¯•ã€åæ³¨å…¥ç­‰ä¸€äº›ä¸»åŠ¨ä¿æŠ¤ç­–ç•¥ è¿™æ˜¯ä¸€äº›ä¸»åŠ¨ä¿æŠ¤ç­–ç•¥ï¼Œå¢å¤§ç ´è§£è€…è°ƒè¯•ã€åˆ†æAppçš„é—¨æ§›ã€‚ æ–‡ä»¶åé‡å¤ä¼šæœ‰ä»€ä¹ˆå½±å“ https://blog.csdn.net/weixin_33994429/article/details/93696758 duplicate symbolé—®é¢˜ swiftå’Œocçš„åŒºåˆ« 1.Swiftå’ŒObjective-Cå…±ç”¨ä¸€å¥—è¿è¡Œæ—¶ç¯å¢ƒï¼ŒSwiftçš„ç±»å‹å¯ä»¥æ¡¥æ¥åˆ°Objective-Cã€‚ 2.swiftæ˜¯é™æ€è¯­è¨€ï¼Œæœ‰ç±»å‹æ¨æ–­ï¼Œæ›´åŠ å®‰å…¨ï¼ŒOCæ˜¯åŠ¨æ€è¯­è¨€ã€‚ 3.swiftæ”¯æŒæ³›å‹ï¼ŒOCåªæ”¯æŒè½»é‡æ³›å‹ 4.Swifté€Ÿåº¦æ›´å¿«ï¼Œè¿ç®—æ€§èƒ½æ›´é«˜ã€‚ 5.Swiftçš„è®¿é—®æƒé™å˜æ›´ã€‚ 7.Swiftä¾¿æ·çš„å‡½æ•°å¼ç¼–ç¨‹ã€‚ 8.swiftæœ‰å…ƒç»„ç±»å‹ã€æ”¯æŒè¿ç®—ç¬¦é‡è½½ 9.swiftå¼•å…¥äº†å‘½åç©ºé—´ã€‚ 10.swiftæ”¯æŒé»˜è®¤å‚æ•°ã€‚ 11.swiftæ¯”ocä»£ç æ›´åŠ ç®€æ´ã€‚ structå’Œclassçš„åŒºåˆ« https://blog.csdn.net/baidu_40537062/article/details/108349757 1.structæ˜¯å€¼ç±»å‹ï¼ˆValue Typeï¼‰,æ·±æ‹·è´ã€‚classæ˜¯å¼•ç”¨ç±»å‹ï¼ˆReference Typeï¼‰ï¼Œæµ…æ‹·è´ã€‚ 2.ç±»å…è®¸è¢«ç»§æ‰¿ï¼Œç»“æ„ä½“ä¸å…è®¸è¢«ç»§æ‰¿ã€‚ 3.ç±»ä¸­çš„æ¯ä¸€ä¸ªæˆå‘˜å˜é‡éƒ½å¿…é¡»è¢«åˆå§‹åŒ–ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œè€Œç»“æ„ä½“ä¸éœ€è¦ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆinitå‡½æ•°ï¼Œç»™å˜é‡èµ‹ä¸€ä¸ªé»˜è®¤å€¼ã€‚ 4.NSUserDefaultsï¼šStruct ä¸èƒ½è¢«åºåˆ—åŒ–æˆ NSData å¯¹è±¡,æ— æ³•å½’è§£æ¡£ã€‚ 5.å½“ä½ çš„é¡¹ç›®çš„ä»£ç æ˜¯ Swift å’Œ Objective-C æ··åˆå¼€å‘æ—¶ï¼Œä½ ä¼šå‘ç°åœ¨ Objective-C çš„ä»£ç é‡Œæ— æ³•è°ƒç”¨ Swift çš„ Structã€‚å› ä¸ºè¦åœ¨ Objective-C é‡Œè°ƒç”¨ Swift ä»£ç çš„è¯ï¼Œå¯¹è±¡éœ€è¦ç»§æ‰¿äº NSObjectã€‚ 6.classåƒocçš„ç±»ä¸€æ ·ï¼Œå¯ä»¥ç”¨kvo,kvc,runtimeçš„ç›¸å…³æ–¹æ³•ï¼Œé€‚ç”¨runtimeç³»ç»Ÿã€‚è¿™äº›structéƒ½ä¸å…·å¤‡ã€‚ 7.å†…å­˜åˆ†é…ï¼šstructåˆ†é…åœ¨æ ˆä¸­ï¼Œclassåˆ†é…åœ¨å †ä¸­ã€‚structæ¯”classæ›´â€œè½»é‡çº§â€ï¼ˆstructæ˜¯è·‘è½¦è·‘å¾—å¿«ï¼Œclassæ˜¯SUVå¯ä»¥è½½æ›´å¤šçš„äººå’Œè´§ç‰©ï¼‰ã€‚ éªŒè¯HTTPSè¯ä¹¦ å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€æ”¯æŒçš„SSL/TSLçš„åè®®ç‰ˆæœ¬å·ï¼Œä»¥åŠå®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†æ–¹æ³•ï¼Œå’Œä¸€ä¸ªå®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºæ•°ã€‚ æœåŠ¡å™¨ç¡®è®¤åè®®ç‰ˆæœ¬å’ŒåŠ å¯†æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªç”±æœåŠ¡å™¨ç”Ÿæˆçš„éšæœºæ•°ï¼Œä»¥åŠæ•°å­—è¯ä¹¦ã€‚ å®¢æˆ·ç«¯éªŒè¯è¯ä¹¦æ˜¯å¦æœ‰æ•ˆï¼Œæœ‰æ•ˆåˆ™ä»è¯ä¹¦ä¸­å–å‡ºå…¬é’¥ï¼Œç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œç„¶åç”¨å…¬é’¥åŠ å¯†è¿™ä¸ªéšæœºæ•°ï¼Œå‘ç»™æœåŠ¡å™¨ã€‚ æœåŠ¡å™¨ç”¨ç§é’¥è§£å¯†ï¼Œè·å–å‘æ¥çš„éšæœºæ•°ã€‚ å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ ¹æ®çº¦å®šå¥½çš„åŠ å¯†æ–¹æ³•ï¼Œä½¿ç”¨å‰é¢ç”Ÿæˆçš„ä¸‰ä¸ªéšæœºæ•°ï¼Œç”Ÿæˆå¯¹è¯å¯†é’¥ï¼Œç”¨æ¥åŠ å¯†æ¥ä¸‹æ¥çš„æ•´ä¸ªå¯¹è¯è¿‡ç¨‹ã€‚ ä½œè€…ï¼šé˜¿æ‹‰æ–¯åŠ å¤§ç‹— é“¾æ¥ï¼šhttps://juejin.cn/post/6844903892765900814 æ¥æºï¼šç¨€åœŸæ˜é‡‘ è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ H5ä¿¡æ¯å­˜å‚¨åœ¨å“ª localStorageä¸ï¼ŸåŒºåˆ« cookie å›¾ç‰‡å®½é«˜æœªçŸ¥çš„æƒ…å†µä¸‹æ€ä¹ˆè‡ªé€‚åº”é«˜åº¦ Modelå±‚å¼‚æ­¥ä¸‹è½½å›¾ç‰‡ï¼Œç„¶åç¼“å­˜å›¾ç‰‡åŠå›¾ç‰‡å®½é«˜ã€‚ å›¾ç‰‡æ˜¾ç¤ºå…ˆå ä½ï¼ŒæŒ‰éœ€åŠ åœ¨å›¾ç‰‡ï¼Œç¼“å­˜å›¾ç‰‡åŠå›¾ç‰‡å®½é«˜ï¼ŒreloadæŒ‡å®šCellã€‚ ä¸Šä¼ å›¾ç‰‡å‘Šè¯‰æœåŠ¡å™¨å›¾ç‰‡å°ºå¯¸ã€‚ é€šè¿‡çº¦æŸè®©Cellé«˜åº¦éšå›¾ç‰‡è‡ªé€‚åº”ã€‚ pushå¾ˆå¤šé¡µé¢åæ€ä¹ˆæ§åˆ¶å¯¼èˆªæ é‡Œé¢çš„å­æ§åˆ¶å™¨ pushåˆ°ç›¸åŒé¡µé¢äº§ç”Ÿé€’å½’ã€‚ å†…å­˜å›æ”¶å¤„ç†ã€‚ çµåŠ¨å²› https://www.51cto.com/article/742613.html å±•ç¤ºï¼š ç´§å‡‘(Compact)ã€æœ€å°åŒ–(Minimal)ã€æ‰©å±•(Expanded) å¼€å‘æ¡†æ¶ï¼šActivityKitï¼ˆå®æ—¶æ´»åŠ¨ï¼‰ã€SwiftUIï¼ˆUIï¼‰ã€WidgetKitï¼ˆå°ç»„ä»¶ï¼‰ å®æ—¶æ´»åŠ¨æƒé™ é™æ€åº“åˆ¶ä½œ https://www.jianshu.com/p/8ea45370a20d XCFramework H5çš„httpæ‹¦æˆª RSA 1024 2048åŒºåˆ« Gitåˆ†ä¹‹ç®¡ç† æ”¯ä»˜ "},"pages/é¢è¯•ç³»åˆ—/è§†é¢‘æ’­æ”¾å™¨.html":{"url":"pages/é¢è¯•ç³»åˆ—/è§†é¢‘æ’­æ”¾å™¨.html","title":"è§†é¢‘æ’­æ”¾å™¨","keywords":"","body":"è§†é¢‘æ’­æ”¾å™¨ å®ç°ä¸€ä¸ªæ’­æ”¾å™¨SDKï¼Œè¦æ±‚æ’­æ”¾æ§åˆ¶ç•Œé¢å¯å®šåˆ¶ï¼Œæä¾›æ’­æ”¾ã€æš‚åœã€åœæ­¢ã€Seekç­‰åŠŸèƒ½ã€‚ Iå¸§ã€På¸§ã€Bå¸§ Iå¸§è¡¨ç¤ºå…³é”®å¸§ï¼Œå¸§ç”»é¢çš„å®Œæ•´ä¿ç•™ï¼Œè§£ç æ—¶åªéœ€è¦æœ¬å¸§æ•°æ®å°±å¯ä»¥å®Œæˆã€‚ På¸§è¡¨ç¤ºçš„æ˜¯è¿™ä¸€å¸§è·Ÿä¹‹å‰çš„ä¸€ä¸ªå…³é”®å¸§ï¼ˆæˆ–På¸§ï¼‰çš„å·®åˆ«ï¼Œè§£ç æ—¶éœ€è¦ç”¨ä¹‹å‰ç¼“å­˜çš„ç”»é¢å åŠ ä¸Šæœ¬å¸§å®šä¹‰çš„å·®åˆ«ï¼Œç”Ÿæˆæœ€ç»ˆç”»é¢ã€‚ Bå¸§æ˜¯åŒå‘å·®åˆ«å¸§ï¼Œä¹Ÿå°±æ˜¯Bå¸§è®°å½•çš„æ˜¯æœ¬å¸§ä¸å‰åå¸§çš„å·®åˆ«ï¼Œæ¢è¨€ä¹‹ï¼Œè¦è§£ç Bå¸§ï¼Œä¸ä»…è¦å–å¾—ä¹‹å‰çš„ç¼“å­˜ç”»é¢ï¼Œè¿˜è¦è§£ç ä¹‹åçš„ç”»é¢ï¼Œé€šè¿‡å‰åç”»é¢çš„ä¸æœ¬å¸§æ•°æ®çš„å åŠ å–å¾—æœ€ç»ˆçš„ç”»é¢ï¼ŒBå¸§å‹ç¼©ç‡é«˜ï¼Œä½†æ˜¯è§£ç æ—¶CPUä¼šæ¯”è¾ƒç´¯ã€‚ è§†é¢‘å¦‚ä½•æ’­æ”¾ï¼Ÿ è§†é¢‘ç”»é¢å…¶å®æ˜¯ç”±è§†é¢‘å¸§ç»„æˆï¼Œåˆ†åˆ«ä¸ºIå¸§ã€På¸§ã€Bå¸§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜¾ç¤ºè§†é¢‘ç”»é¢éœ€è¦å¯¹è§†é¢‘å‹ç¼©æ ¼å¼è¿›è¡Œéå†è§£ç å¸§æ•°æ®ï¼Œéå†çš„åŒæ—¶å¯¹æ¯ä¸€å¸§æ•°æ®æŒ‰ç…§æ’­æ”¾æ—¶é—´è¿›è¡Œæ˜¾ç¤ºï¼Œæ¯ä¸€å¸§å¯ä»¥ç†è§£ä¸ºä¸€å¼ å›¾ç‰‡ï¼Œå…¶å®å°±æ˜¯å¯¹å›¾ç‰‡æ•°æ®çš„æ˜¾ç¤ºã€‚ è§†é¢‘å¦‚ä½•æ˜¾ç¤ºï¼Ÿ ä¸ä»…æ˜¯è§†é¢‘ï¼Œæ˜¾ç¤ºé—®é¢˜æ— å¤„ä¸åœ¨ï¼Œæˆ‘ä»¬æ‰€æœ‰åœ¨æ‰‹æœºç«¯çœ‹åˆ°çš„ç”»é¢éƒ½å’Œè§†é¢‘ä¸€æ ·ï¼Œæ˜¯ä¸€ä¸ªä¸æ–­åˆ·æ–°ç»˜åˆ¶çš„è¿‡ç¨‹ï¼Œåº•å±‚éƒ½æ˜¯é€šè¿‡ä½¿ç”¨OpenGLçš„APIï¼Œå¯¹GPUç¡¬ä»¶å‘å‡ºæŒ‡ä»¤ï¼Œé€šè¿‡å›¾å½¢æ¸²æŸ“ç®¡çº¿ç¨‹åºï¼Œæœ€ç»ˆåœ¨å±å¹•çš„æ¯ä¸ªåƒç´ ç‚¹æ˜¾ç¤ºã€‚OpenGLæ˜¯è·¨å¹³å°çš„ï¼ŒiOSä¸Šæ˜¯é€šè¿‡GLKViewè¿›è¡Œæ¸²æŸ“æ˜¾ç¤ºã€‚ ä»€ä¹ˆæ˜¯å›¾å½¢æ¸²æŸ“ç®¡çº¿ï¼Ÿ é¡¶ç‚¹ç€è‰²å™¨ â€”â€” å›¾å…ƒè£…é… â€”â€” å‡ ä½•ç€è‰²å™¨ â€”â€” å…‰æ …åŒ– â€”â€” ç‰‡æ®µç€è‰²å™¨ â€”â€” æµ‹è¯•ä¸æ··åˆã€‚ ç€è‰²å™¨æ˜¯ä¸€æ®µè¿è¡Œåœ¨GPUä¸­çš„ç¨‹åºï¼›é¡¶ç‚¹ç€è‰²å™¨ç¡®å®šç»˜åˆ¶å›¾å½¢çš„å½¢çŠ¶ï¼›å›¾å…ƒè£…é…æ˜¯å°†é¡¶ç‚¹ç€è‰²å™¨ä¼ æ¥çš„é¡¶ç‚¹æ•°æ®ç»„è£…ä¸ºå›¾å…ƒï¼›å…‰æ …åŒ–æ˜¯å°†ä¸€ä¸ªå›¾å…ƒè½¬åŒ–ä¸ºä¸€å¼ äºŒç»´çš„å›¾ç‰‡ï¼Œè€Œè¿™å¼ å›¾ç‰‡ç”±è‹¥å¹²ä¸ªç‰‡æ®µï¼ˆfragmentï¼‰ç»„æˆï¼›ç‰‡æ®µç€è‰²å™¨è®¡ç®—ç‰‡æ®µçš„é¢œè‰²ï¼›æµ‹è¯•å’Œæ··åˆä¸¢å¼ƒä¸€äº›ä¸éœ€è¦æ˜¾ç¤ºçš„ç‰‡æ®µã€‚ å¦‚ä½•æ’­æ”¾å…¨æ™¯è§†é¢‘ï¼Ÿ åœ¨å›¾å½¢æ¸²æŸ“ç®¡çº¿ä¸­ï¼Œé¡¶ç‚¹ç€è‰²å™¨å’Œç‰‡å…ƒç€è‰²å™¨æ˜¯å¯ç¼–ç¨‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡é¡¶ç‚¹ç€è‰²å™¨æ„å»ºä»»æ„äº‹ç‰©æ¨¡å‹é¡¶ç‚¹ï¼Œç„¶åé€šè¿‡è¿‡GPUè¿›è¡Œç»˜åˆ¶ï¼Œå†é€šè¿‡ç‰‡å…ƒç€è‰²å™¨ç»™äº‹ç‰©ä¸Šè‰²ï¼ˆçº¹ç†è´´å›¾ï¼‰ã€‚æ™®é€šçš„è§†é¢‘æ’­æ”¾å¯ä»¥ç†è§£ä¸ºå°±æ˜¯åœ¨ä¸€ä¸ªäºŒç»´çš„é¢æ˜¾ç¤ºè§†é¢‘ç”»é¢ï¼ŒäºŒç»´çš„é¢å°±æ˜¯é¡¶ç‚¹ç€è‰²å™¨æ„å»ºçš„ï¼Œè€Œç”»é¢çš„æ˜¾ç¤ºåˆ™äº¤ç»™äº†ç‰‡å…ƒç€è‰²å™¨ï¼Œé‚£ä¹ˆå…¨æ™¯è§†é¢‘çš„æ˜¾ç¤ºï¼Œå…¶å®å°±æ˜¯åœ¨é¡¶ç‚¹ç€è‰²å™¨ç¯èŠ‚æ„å»ºä¸€ä¸ªçƒé¢å³å¯å®ç°æ’­æ”¾å…¨æ™¯è§†é¢‘ã€‚ iOSä¸Šå¦‚ä½•å¯¹MP4æ–‡ä»¶æ’­æ”¾ï¼Ÿ AVFoundationä¸­çš„AVPlayeræä¾›å¯¹è§†é¢‘å‹ç¼©æ–‡ä»¶çš„æ’­æ”¾ã€‚ä»¥ä¸‹æ˜¯æ’­æ”¾æ­¥éª¤ï¼š 1ï¼‰æ„å»ºAVPlayerItemå®ä¾‹ã€‚2ï¼‰é€šè¿‡KVOç›‘å¬AVPlayerItemå®ä¾‹åŠ è½½çš„çŠ¶æ€ï¼ŒåŠ è½½æˆåŠŸï¼Œå¦åˆ™æ’­æ”¾å¤±è´¥ï¼Œæœ€åç§»é™¤ç›‘å¬ã€‚3ï¼‰æ„å»ºæ’­æ”¾å™¨AVPlayerå®ä¾‹ã€‚4ï¼‰ä¸ºAVPlayerItemå®ä¾‹å¢åŠ AVPlayerItemVideoOutputå®ä¾‹ï¼ŒåŠ å…¥å¼‚æ­¥é˜Ÿåˆ—ã€‚5ï¼‰æ„å»ºå±å¹•å®šæ—¶å™¨ï¼Œé€šè¿‡AVPlayerItemVideoOutputå®ä¾‹è·å–å½“å‰è§†é¢‘å¸§æ•°æ®ï¼Œäº¤ç»™OpengGLæ¸²æŸ“ã€‚6ï¼‰ç›‘å¬æ’­æ”¾è¿›åº¦ï¼Œæ’­æ”¾ç»“æŸã€‚7ï¼‰å¼€å§‹æ’­æ”¾ã€‚ å¦‚ä½•ä½¿ç”¨FFmpegå¯¹MP4æ–‡ä»¶æ’­æ”¾ï¼Ÿ FFmpegæä¾›ffplayå‘½ä»¤å¯ä»¥å¯¹å‡ ä¹æ‰€æœ‰çš„è§†é¢‘å‹ç¼©æ ¼å¼è¿›è¡Œæ’­æ”¾ï¼ŒåŒ…æ‹¬yuvæ ¼å¼ã€‚ æ’­æ”¾å™¨è®¾è®¡ æ’­å‘å™¨ç±»ï¼šCPVideoPlayerï¼Œæä¾›æ’­æ”¾ã€æš‚åœã€åœæ­¢ã€Seekç­‰æ–¹æ³•ã€‚åè®®ä¸€ï¼šCPVideoPlayerDelegateï¼Œå›è°ƒæ’­æ”¾çŠ¶æ€åŠè§†é¢‘æ•°æ®ã€‚åè®®äºŒï¼šCPVideoPlayerDataSourceï¼Œè·å–è§†é¢‘åœ°å€ã€‚åè®®ä¸‰ï¼šCPVideoControlViewProtocolï¼Œæ’­æ”¾æ§åˆ¶ç•Œé¢ã€‚ æ’­æ”¾å™¨weakå¼•ç”¨ä¸Šé¢ä¸‰ä¸ªåè®®ã€‚ å‚è€ƒé“¾æ¥ ä¸€çœ‹å°±æ‡‚çš„OpenGL ESæ•™ç¨‹â€”â€”å›¾å½¢æ¸²æŸ“ç®¡çº¿çš„é‚£äº›äº‹YUVå›¾è§£Iå¸§ã€På¸§ã€Bå¸§ã€GOPã€IDR å’ŒPTS, DTSä¹‹é—´çš„å…³ç³» "},"pages/é¢è¯•ç³»åˆ—/ç»„ä»¶åŒ–å¼€å‘.html":{"url":"pages/é¢è¯•ç³»åˆ—/ç»„ä»¶åŒ–å¼€å‘.html","title":"ç»„ä»¶åŒ–å¼€å‘","keywords":"","body":"ç»„ä»¶åŒ–å¼€å‘ å¦‚ä½•ä¼˜é›…çš„ä½¿ç”¨CTMeditorï¼Ÿ æˆ‘ä»¬é¡¹ç›®ä¼šæœ‰å¤šä¸ªç»„ä»¶ï¼Œæ¯”å¦‚ï¼šä¸ªäººä¸­å¿ƒï¼ˆMeï¼‰ï¼Œç™»å½•ï¼ˆLoginï¼‰ç­‰ï¼Œç°åœ¨æˆ‘æƒ³å®ç°å¦‚ä¸‹çš„å†™æ³•ï¼š Mediator.shared.me Mediator.shared.login ä»¥meä¸ºä¾‹å­ï¼Œå»ºç«‹Meçš„ç»“æ„ä½“ï¼Œä¸ºMeå¢åŠ æ‰©å±•ï¼Œå¦‚æœBaseä¸ºMediatorç±»å‹ï¼Œé‚£ä¹ˆå¯ä»¥æ‹¥æœ‰debugEnvironmentæ–¹æ³•ã€‚ public struct Me { public let base: Base public init(_ base: Base) { self.base = base } } extension Me where Base: Mediator { public func debugEnvironment(_ env: String) -> Bool { var deliverParams: [String: Any] = [\"env\": env] let result = base.performTarget(\"Me\", action: \"DebugEnvironment\", params: deliverParams) as? [String: Any] return (result?[\"result\"] as? Bool) ?? false } } æ‰©å±•Mediatorï¼Œä¸ºMediatorå¢åŠ meçš„å®ä¾‹ public protocol MeProtocol {} extension Mediator: MeProtocol {} extension MeProtocol { public var me: Me { return Me(self) } public static var me: Me.Type { return Me.self } } é€šè¿‡ä»¥ä¸Šæ“ä½œå°±å¯ä»¥å®ç°Mediator.shared.me.debugEnvironment(\"dev\")çš„è°ƒç”¨ã€‚ CTMeditorå®ç°åŸç†ï¼Ÿ ä»¥Mediator.shared.me.debugEnvironment(\"dev\")ä¸ºä¾‹åˆ†æï¼Œé€šè¿‡è¿™æ®µä»£ç Mediatorå¯ä»¥æ‰¾åˆ°Targetæ˜¯ç±»åä¸ºTarget_Meçš„å®ä¾‹ï¼Œæ–¹æ³•åæ˜¯debugEnvironmentï¼Œå‚æ•°\"dev\"å°è£…æˆäº†å­—å…¸ï¼Œé€šè¿‡Runtimeçš„performæ–¹æ³•å°±å¯ä»¥è°ƒç”¨åˆ°ç›®æ ‡é€»è¾‘ã€‚ è˜‘è‡è¡—ç»„ä»¶åŒ–æ–¹æ¡ˆé—®é¢˜ï¼Ÿ 1ï¼‰è˜‘è‡è¡—æ²¡æœ‰æ‹†åˆ†è¿œç¨‹è°ƒç”¨å’Œæœ¬åœ°é—´è°ƒç”¨ã€‚2ï¼‰è˜‘è‡è¡—ä»¥è¿œç¨‹è°ƒç”¨çš„æ–¹å¼ä¸ºæœ¬åœ°é—´è°ƒç”¨æä¾›æœåŠ¡ã€‚3ï¼‰è˜‘è‡è¡—çš„æœ¬åœ°é—´è°ƒç”¨æ— æ³•ä¼ é€’éå¸¸è§„å‚æ•°ï¼Œå¤æ‚å‚æ•°çš„ä¼ é€’æ–¹å¼éå¸¸ä¸‘é™‹ã€‚4ï¼‰è˜‘è‡è¡—å¿…é¡»è¦åœ¨appå¯åŠ¨æ—¶æ³¨å†ŒURLå“åº”è€…ã€‚5ï¼‰æ–°å¢ç»„ä»¶åŒ–çš„è°ƒç”¨è·¯å¾„æ—¶ï¼Œè˜‘è‡è¡—çš„æ“ä½œç›¸å¯¹å¤æ‚ã€‚6ï¼‰è˜‘è‡è¡—æ²¡æœ‰é’ˆå¯¹targetå±‚åšå°è£…ã€‚ ç»„å»ºåŒ–æ–¹æ¡ˆå¦‚ä½•åŠ è½½xibåŠå…¶ä»–èµ„æºæ–‡ä»¶ï¼Ÿ é€šè¿‡Classæ‰¾åˆ°Bundleï¼Œç„¶åæ„å»ºNibçš„æ—¶å€™ä¼ å…¥åˆ¶å®šçš„bundleã€‚ å‚è€ƒé“¾æ¥ iOSåº”ç”¨æ¶æ„è°ˆ ç»„ä»¶åŒ–æ–¹æ¡ˆ "},"pages/é¢è¯•ç³»åˆ—/è®¾è®¡æ¨¡å¼.html":{"url":"pages/é¢è¯•ç³»åˆ—/è®¾è®¡æ¨¡å¼.html","title":"è®¾è®¡æ¨¡å¼","keywords":"","body":"è®¾è®¡æ¨¡å¼ 1) çŠ¶æ€æ¨¡å¼ åœ¨çŠ¶æ€æ¨¡å¼ï¼ˆState Patternï¼‰ä¸­ï¼Œç±»çš„è¡Œä¸ºæ˜¯åŸºäºå®ƒçš„çŠ¶æ€æ”¹å˜çš„ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚ public class StatePatternDemo { public static void main(String[] args) { Context context = new Context(); StartState startState = new StartState(); startState.doAction(context); System.out.println(context.getState().toString()); StopState stopState = new StopState(); stopState.doAction(context); System.out.println(context.getState().toString()); } } å‚è€ƒé“¾æ¥ èœé¸ŸÂ·è®¾è®¡æ¨¡å¼[è¯‘] ä½¿ç”¨ Swift çš„ iOS è®¾è®¡æ¨¡å¼ï¼ˆç¬¬ä¸€éƒ¨åˆ†ï¼‰MVCï¼ŒMVP å’Œ MVVM çš„å›¾ç¤º "},"pages/é¢è¯•ç³»åˆ—/æ•°æ®ç»“æ„.html":{"url":"pages/é¢è¯•ç³»åˆ—/æ•°æ®ç»“æ„.html","title":"æ•°æ®ç»“æ„","keywords":"","body":"æ•°æ®ç»“æ„ "},"pages/é¢è¯•ç³»åˆ—/SwiftUI.html":{"url":"pages/é¢è¯•ç³»åˆ—/SwiftUI.html","title":"SwiftUI","keywords":"","body":"SwiftUI è‹¹æœå®˜æ–¹æ•™ç¨‹swiftui SwiftUI-api SwiftUI-tutorials SwiftUI-äº’åŠ¨æ•™ç¨‹ SwiftUI åŸºç¡€ä¹‹05 list å’Œ searchbar (2020) SwiftUIæ•™ç¨‹ä¸æºç  SwiftUI Search Bar in the Navigation Bar UISearchController Tutorial å¼„æ¸… SwiftUIï¼Œæ‰çœ‹å¾—æ‡‚è‹¹æœçš„å¼ºå¤§ "},"pages/é¢è¯•ç³»åˆ—/æ•æ·å¼€å‘.html":{"url":"pages/é¢è¯•ç³»åˆ—/æ•æ·å¼€å‘.html","title":"æ•æ·å¼€å‘","keywords":"","body":"æ•æ·å¼€å‘ åœ¨ä¼ ç»Ÿå¼€å‘ä¸­ï¼Œå¦‚æœå˜æ›´éœ€æ±‚ï¼Œéœ€æœ‰èµ°éœ€æ±‚å˜æ›´æµç¨‹ï¼Œå½“é¢‘ç¹å‡ºç°éœ€æ±‚æ—¶ï¼Œè¿™ä¸ªæµç¨‹èµ°èµ·æ¥æ—¶éå¸¸è¾›è‹¦ï¼Œå¾ˆæœ‰å¯èƒ½å¯¼è‡´å˜æ›´ä¸æ§åˆ¶ï¼Œé¡¹ç›®å°±å®¹æ˜“å¤±æ§ï¼Œè¿™æ ·æ˜¯è°éƒ½ä¸æ„¿æ„çœ‹åˆ°çš„ï¼Œæ–°äº§å“å¼€å‘æµç¨‹--æ•æ·å¼€å‘å°±è¿™æ ·äº§ç”Ÿäº†ã€‚ æ•æ·æ–¹æ³•Vsä¼ ç»Ÿæ–¹æ³• ä¼ ç»Ÿçš„å†™ä½œæ–¹å¼ æ•æ·çš„å†™ä½œæ–¹å¼ ç¡®å®šä¸»é¢˜ ä¸è¯»è€…å¾®åšã€è®ºå›äº’åŠ¨ æ•´ç†å¤§çº²ã€æ­å»ºæ¡†æ¶ ç¡®å®šä¸»é¢˜ ä¹¦å†™å†…å®¹ ä¸è¯»è€…äº’åŠ¨ã€æ”¶é›†åé¦ˆ è®¾è®¡ã€æ’ç‰ˆã€æ ¡å¯¹ è¯•å†™ç¬¬ä¸€ç«  å‡ºç‰ˆ ä¸è¯»è€…äº’åŠ¨ã€æ”¶é›†åé¦ˆ ä¸è¯»è€…è§é¢ è¯•å†™ç¬¬äºŒç«  æ”¶é›†åé¦ˆï¼Œåœ¨ç‰ˆæœ¬ ... åˆæ­¥è®¾è®¡ã€æ’ç‰ˆ ä¸è¯»è€…äº’åŠ¨ã€æ”¶é›†åé¦ˆ å‡ºç‰ˆ ä¼ ç»Ÿæ–¹æ³•çš„é—®é¢˜ï¼šéœ€æ±‚ä¸æ˜¯ä¸€å°˜ä¸å˜çš„ï¼Œç­‰åšå®Œäº†å‘ç°ä¸æ˜¯äº§å“æƒ³è¦çš„ã€‚ æ•æ·æ–¹æ³•çš„å¥½å¤„ï¼šæ—©æœŸäº¤ä»˜ï¼Œè¾ƒä½æˆæœ¬ï¼›å¢åŠ ä¸å®¢æˆ·çš„äº¤äº’ï¼Œé™ä½äº§å“ä¸é€‚ç”¨çš„é£é™©ï¼›ä¼ ç»Ÿæ–¹æ³•å¼€å‘åˆ°ä¸€åŠçš„æ—¶å€™ï¼Œä»£ç ä¸å¯ç”¨ï¼Œè€Œæ•æ·å·²äº¤ä»˜çš„å¯ç”¨ã€‚ ç”Ÿå‘½å‘¨æœŸç±»å‹ æ•æ·å‹ï¼šäº¤ä»˜é¢‘ç‡é«˜ã€å˜æ›´ç¨‹åº¦é«˜ã€‚æŠ€æœ¯ä¸ç¡®å®šã€éœ€æ±‚ç¡®å®šæˆ–è€…æŠ€æœ¯ç¡®å®šã€éœ€æ±‚ä¸ç¡®å®šçš„é¡¹ç›®é€‚ç”¨äºæ•æ·å¼€å‘ã€‚ æ•æ·æ€ç»´ 4å¤§ä»·å€¼è§‚ï¼Œ12å¤§åŸåˆ™ï¼Œ2000å¤šå®è·µã€‚ æ•æ·æ€ç»´æ¨¡å¼ç”±ä»·å€¼è§‚å®šä¹‰ï¼Œä»¥åŸåˆ™ä¸ºæŒ‡å¯¼ï¼Œå¹¶åœ¨è®¸å¤šä¸åŒçš„å®è·µä¸­æ¥ä½“ç°ã€‚æ•æ·å®è·µè€…æ ¹æ®è‡ªèº«éœ€æ±‚é€‰æ‹©ä¸åŒçš„å®è·µã€‚ æ•æ·å®£è¨€ é€šè¿‡è¿ç”¨æ­¤æ³•åŠå¸®åŠ©ä»–äººè¿ç”¨æ­¤æ³•ï¼Œæˆ‘ä»¬æ­£åœ¨æ¢å¯»æ›´å¥½çš„è½¯ä»¶å¼€å‘æ–¹æ³•ã€‚åœ¨è¿™é¡¹å·¥ä½œä¸­ï¼Œæˆ‘ä»¬çœ‹é‡â€œä¸ªä½“ä»¥åŠäº’åŠ¨â€èƒœè¿‡â€œæµç¨‹å’Œå·¥å…·â€ï¼Œâ€œå¯å·¥ä½œçš„è½¯ä»¶â€èƒœè¿‡â€œå®Œæ•´çš„æ–‡æ¡£â€ï¼Œâ€œå®¢æˆ·åˆä½œâ€èƒœè¿‡â€œåˆåŒè°ˆåˆ¤â€ï¼Œâ€œå“åº”å˜åŒ–â€èƒœè¿‡â€œéµå¾ªè®¡åˆ’â€ã€‚ 4å¤§ä»·å€¼è§‚ ä»¥äººä¸ºæœ¬ï¼ˆä¸ªä½“ä»¥åŠäº’åŠ¨ï¼‰ã€ä»¥ä»·å€¼ä¸ºå¯¼å‘ï¼ˆå¯å·¥ä½œçš„è½¯ä»¶ï¼‰ã€åˆä½œå…±èµ¢ï¼ˆå®¢æˆ·åˆä½œï¼‰ã€æ‹¥æŠ±å˜åŒ–ï¼ˆå“åº”å˜åŒ–ï¼‰ã€‚ 12æ¡åŸåˆ™ 1.é€šè¿‡æ—©æœŸå’ŒæŒç»­äº¤ä»˜æœ‰ä»·å€¼çš„è½¯ä»¶ï¼Œå®ç°å®¢æˆ·æ»¡æ„åº¦ã€‚2.æ¬¢è¿ä¸æ–­å˜åŒ–çš„éœ€æ±‚ï¼Œå³ä½¿æ˜¯åœ¨é¡¹ç›®å¼€å‘çš„åæœŸã€‚è¦å–„äºåˆ©ç”¨éœ€æ±‚å˜æ›´ï¼Œå¸®åŠ©å®¢æˆ·è·å¾—ç«äº‰ä¼˜åŠ¿ã€‚3.ä¸æ–­äº¤ä»˜å¯ç”¨çš„è½¯ä»¶ï¼Œå‘¨æœŸé€šå¸¸æ˜¯å‡ å‘¨ï¼Œè¶ŠçŸ­è¶Šå¥½ã€‚4.é¡¹ç›®è¿‡ç¨‹ä¸­ï¼Œä¸šåŠ¡äººå‘˜ä¸å¼€å‘äººå‘˜å¿…é¡»åœ¨ä¸€èµ·å·¥ä½œã€‚5.é¡¹ç›®å¿…é¡»å›´ç»•é‚£äº›æœ‰å†…åœ¨åŠ¨åŠ›çš„ä¸ªäººè€Œå»ºç«‹ï¼Œä»–ä»¬åº”è¯¥å—åˆ°ä¿¡ä»»ã€‚6.é¢å¯¹é¢äº¤è°ˆæ˜¯æœ€å¥½çš„æ²Ÿé€šæ–¹å¼ã€‚7.å¯ç”¨æ€§æ˜¯è¡¡é‡è¿›åº¦çš„ä¸»è¦æŒ‡æ ‡ã€‚8.æå€¡å¯æŒç»­çš„å¼€å‘ï¼Œä¿æŒç¨³å®šçš„è¿›å±•é€Ÿåº¦ã€‚9.ä¸æ–­å…³æ³¨æŠ€æœ¯æ˜¯å¦ä¼˜ç§€ï¼Œè®¾è®¡æ˜¯å¦è‰¯å¥½ã€‚10.ç®€å•æ€§è‡³å…³é‡è¦ï¼Œå°½æœ€å¤§å¯èƒ½å‡å°‘ä¸å¿…è¦çš„å·¥ä½œã€‚11.æœ€å¥½çš„æ¶æ„ã€è¦æ±‚å’Œè®¾è®¡ï¼Œæ¥è‡ªå›¢é˜Ÿå†…éƒ¨è‡ªå‘çš„è®¤è¯†ã€‚12.å›¢é˜Ÿè¦å®šæœŸåæ€å¦‚ä½•æ›´æœ‰æ•ˆï¼Œå¹¶ç›¸åº”åœ°è¿›è¡Œè°ƒæ•´ã€‚ Scrum 3ä¸ªæ”¯æŸ±ï¼šé€æ˜æ€§ã€æ£€éªŒã€é€‚åº”ã€‚3ä¸ªè§’è‰²ï¼šäº§å“è´Ÿè´£äººã€æ•æ·æ•™ç»ƒã€æ•æ·å›¢é˜Ÿã€‚ 3ä¸ªå·¥ä»¶ï¼šäº§å“ä»£åŠäº‹é¡¹åˆ—è¡¨ã€å†²åˆºå¾…åŠäº‹é¡¹åˆ—è¡¨ã€å¯äº¤ä»˜äº§å“å¢é‡ã€‚5ä¸ªäº‹ä»¶ï¼šå†²åˆºã€å†²åˆºè§„åˆ’ä¼šè®®ã€æ¯æ—¥ç«™ä¼šã€è¿­ä»£è¯„å®¡ä¼šè®®ã€è¿­ä»£å›é¡¾ä¼šè®®ã€‚ å‚è€ƒé“¾æ¥ æ•æ·å¼€å‘å…¥é—¨æ•™ç¨‹æŠ–éŸ³@å¸Œèµ›é¡¹ç›®ç®¡ç† "},"pages/é¢è¯•ç³»åˆ—/é‡å»ºäºŒå‰æ ‘.html":{"url":"pages/é¢è¯•ç³»åˆ—/é‡å»ºäºŒå‰æ ‘.html","title":"é‡å»ºäºŒå‰æ ‘","keywords":"","body":"é‡å»ºäºŒå‰æ ‘ é¢˜ç›®ï¼šè¾“å…¥æŸäºŒå‰æ ‘çš„å‰åºéå†å’Œä¸­åºéå†çš„ç»“æœï¼Œè¯·é‡å»ºè¯¥äºŒåˆæ ‘ã€‚å‡è®¾è¾“å…¥çš„å‰åºéå†å’Œä¸­åºéå†çš„ç»“æœä¸­éƒ½ä¸å«é‡å¤çš„æ•°å­—ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥å‰åºéå†åºåˆ—{1,2,4,7,3,5,6,8}å’Œä¸­åºéå†åºåˆ—{4,7,2,1,5,3,8,6}ï¼Œåˆ™é‡å»ºå¦‚å›¾2.6æ‰€ç¤ºçš„äºŒå‰æ ‘å¹¶è¾“å‡ºå®ƒçš„å¤´èŠ‚ç‚¹ã€‚äºŒå‰æ ‘èŠ‚ç‚¹çš„å®šä¹‰å¦‚ä¸‹ï¼š struct BinaryTreeNode { int m_nValue; BinaryTreeNode* m_pLeft; BinaryTreeNode* m_pRight; }; åœ¨äºŒå‰æ ‘çš„å‰åºéå†åºåˆ—ä¸­ï¼Œç¬¬ä¸€ä¸ªæ•°å­—æ€»æ˜¯æ ‘çš„æ ¹èŠ‚ç‚¹çš„å€¼ã€‚ä½†åœ¨ä¸­åºéå†åºåˆ—ä¸­ï¼Œæ ¹èŠ‚ç‚¹çš„å€¼åœ¨åºåˆ—çš„ä¸­é—´ï¼Œå·¦å­æ ‘çš„èŠ‚ç‚¹çš„å€¼ä½äºæ ¹èŠ‚ç‚¹çš„å€¼çš„å·¦è¾¹ï¼Œè€Œå³å­æ ‘çš„èŠ‚ç‚¹çš„å€¼ä½äºæ ¹èŠ‚ç‚¹çš„å€¼çš„å³è¾¹ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ‰«æä¸­åºéå†åºåˆ—ï¼Œæ‰èƒ½æ‰¾åˆ°æ ¹èŠ‚ç‚¹çš„å€¼ã€‚ å›¾2.6 æ ¹æ®å‰åºéå†åºåˆ—(1,2,4,7,3,5,6,8}å’Œä¸­åºéå†åºåˆ—4,7,2,1,5,3,8,6}é‡å»ºçš„äºŒå‰æ ‘ å¦‚å›¾2.7æ‰€ç¤ºï¼Œå‰åºéå†åºåˆ—çš„ç¬¬ä¸€ä¸ªæ•°å­—1å°±æ˜¯æ ¹èŠ‚ç‚¹çš„å€¼ã€‚æ‰«æä¸­åºéå†åºåˆ—ï¼Œå°±èƒ½ç¡®å®šæ ¹èŠ‚ç‚¹çš„å€¼çš„ä½ç½®ã€‚æ ¹æ®ä¸­åºéå†çš„ç‰¹ç‚¹ï¼Œåœ¨æ ¹èŠ‚ç‚¹çš„å€¼1å‰é¢çš„3ä¸ªæ•°å­—éƒ½æ˜¯å·¦å­æ ‘èŠ‚ç‚¹çš„å€¼ï¼Œä½äº1åé¢çš„æ•°å­—éƒ½æ˜¯å³å­æ ‘èŠ‚ç‚¹çš„å€¼ã€‚ ç”±äºåœ¨ä¸­åºéå†åºåˆ—ä¸­ï¼Œæœ‰3ä¸ªæ•°å­—æ˜¯å·¦å­æ ‘èŠ‚ç‚¹çš„å€¼ï¼Œå› æ­¤å·¦å­æ ‘å…±æœ‰3ä¸ªå·¦å­èŠ‚ç‚¹ã€‚åŒæ ·ï¼Œåœ¨å‰åºéå†åºåˆ—ä¸­ï¼Œæ ¹èŠ‚ç‚¹åé¢çš„3ä¸ªæ•°å­—å°±æ˜¯3ä¸ªå·¦å­æ ‘èŠ‚ç‚¹çš„å€¼ï¼Œå†åé¢çš„æ‰€æœ‰æ•°å­—éƒ½æ˜¯å³å­æ ‘èŠ‚ç‚¹çš„å€¼ã€‚è¿™æ ·æˆ‘ä»¬å°±åœ¨å‰åºéå†å’Œä¸­åºéå†ä¸¤ä¸ªåºåˆ—ä¸­åˆ†åˆ«æ‰¾åˆ°äº†å·¦ã€å³å­æ ‘å¯¹åº”çš„å­åºåˆ—ã€‚ å›¾2.7 åœ¨äºŒå‰æ ‘çš„å‰åºéå†å’Œä¸­åºéå†åºåˆ—ä¸­ç¡®å®šæ ¹èŠ‚ç‚¹çš„å€¼ã€å·¦å­æ ‘èŠ‚ç‚¹çš„å€¼å’Œå³å­æ ‘èŠ‚ç‚¹çš„å€¼ æ—¢ç„¶æˆ‘ä»¬å·²ç»åˆ†åˆ«æ‰¾åˆ°äº†å·¦ã€å³å­æ ‘çš„å‰åºéå†åºåˆ—å’Œä¸­åºéå†åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•åˆ†åˆ«æ„å»ºå·¦ã€å³å­æ ‘ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¥ä¸‹æ¥çš„äº‹æƒ…å¯ä»¥ç”¨é€’å½’çš„æ–¹æ³•å»å®Œæˆã€‚ åœ¨æƒ³æ¸…æ¥šå¦‚ä½•åœ¨å‰åºéå†å’Œä¸­åºéå†åºåˆ—ä¸­ç¡®å®šå·¦ã€å³å­æ ‘çš„å­åºåˆ—ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºå¦‚ä¸‹çš„é€’å½’ä»£ç ï¼š BinaryTreeNode* ConstructCore(int* startPreorder, int* endPreorder, int* startInorder, int* endInorder); BinaryTreeNode* Construct(int* preorder, int* inorder, int length) { if(preorder == nullptr || inorder == nullptr || length m_nValue = rootValue; root->m_pLeft = root->m_pRight = nullptr; if(startPreorder == endPreorder) { if(startInorder == endInorder && *startPreorder == *startInorder) return root; else throw std::exception(\"Invalid input.\"); } // åœ¨ä¸­åºéå†ä¸­æ‰¾åˆ°æ ¹ç»“ç‚¹çš„å€¼ int* rootInorder = startInorder; while(rootInorder 0) { // æ„å»ºå·¦å­æ ‘ root->m_pLeft = ConstructCore(startPreorder + 1, leftPreorderEnd, startInorder, rootInorder - 1); } if(leftLength m_pRight = ConstructCore(leftPreorderEnd + 1, endPreorder, rootInorder + 1, endInorder); } return root; } åœ¨å‡½æ•°ConstructCoreä¸­ï¼Œæˆ‘ä»¬å…ˆæ ¹æ®å‰åºéå†åºåˆ—çš„ç¬¬ä¸€ä¸ªæ•°å­—åˆ›å»ºæ ¹èŠ‚ç‚¹ï¼Œæ¥ä¸‹æ¥åœ¨ä¸­åºéå†åºåˆ—ä¸­æ‰¾åˆ°æ ¹èŠ‚ç‚¹çš„ä½ç½®ï¼Œè¿™æ ·å°±èƒ½ç¡®å®šå·¦ã€å³å­æ ‘èŠ‚ç‚¹çš„æ•°é‡ã€‚åœ¨å‰åºéå†å’Œä¸­åºéå†åºåˆ—ä¸­åˆ’åˆ†äº†å·¦ã€å³å­æ ‘èŠ‚ç‚¹çš„å€¼ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€’å½’åœ°è°ƒç”¨å‡½æ•°ConstructCoreå»åˆ†åˆ«æ„å»ºå®ƒçš„å·¦ã€å³å­æ ‘ã€‚ å‰‘æŒ‡ Offer P62ï¼Œæœ¬é¢˜å®Œæ•´çš„æºä»£ç ï¼š https://github.com/zhedahht/CodingInterviewChinese2/tree/master/07_ConstructBinaryTree "},"pages/é¢è¯•ç³»åˆ—/äºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹.html":{"url":"pages/é¢è¯•ç³»åˆ—/äºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹.html","title":"äºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹","keywords":"","body":"äºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ é¢˜ç›®ï¼šç»™å®šä¸€æ£µäºŒå‰æ ‘å’Œå…¶ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚ä½•æ‰¾å‡ºä¸­åºéå†åºåˆ—çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Ÿæ ‘ä¸­çš„èŠ‚ç‚¹é™¤äº†æœ‰ä¸¤ä¸ªåˆ†åˆ«æŒ‡å‘å·¦ã€å³å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œè¿˜æœ‰ä¸€ä¸ªæŒ‡å‘çˆ¶èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚ åœ¨å›¾2.8ä¸­çš„äºŒå‰æ ‘çš„ä¸­åºéå†åºåˆ—æ˜¯{d,b,h,e,i,a,f,c,g}ã€‚æˆ‘ä»¬å°†ä»¥è¿™æ£µæ ‘ä¸ºä¾‹æ¥åˆ†æå¦‚ä½•æ‰¾å‡ºäºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚ å›¾2.8 ä¸€æ£µæœ‰9ä¸ªèŠ‚ç‚¹çš„äºŒå‰æ ‘ã€‚æ ‘ä¸­ä»çˆ¶èŠ‚ç‚¹æŒ‡å‘å­èŠ‚ç‚¹çš„æŒ‡é’ˆç”¨å®çº¿è¡¨ç¤ºï¼Œä»å­èŠ‚ç‚¹æŒ‡å‘çˆ¶èŠ‚ç‚¹çš„æŒ‡é’ˆç”¨è™šçº¿è¡¨ç¤º å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æœ‰å³å­æ ‘ï¼Œé‚£ä¹ˆå®ƒçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯å®ƒçš„å³å­æ ‘ä¸­çš„æœ€å·¦å­èŠ‚ç‚¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»å³å­èŠ‚ç‚¹å‡ºå‘ä¸€ç›´æ²¿ç€æŒ‡å‘å·¦å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬å°±èƒ½æ‰¾åˆ°å®ƒçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œå›¾2.8ä¸­èŠ‚ç‚¹bçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯hï¼ŒèŠ‚ç‚¹açš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯fã€‚ æ¥ç€æˆ‘ä»¬åˆ†æä¸€ä¸ªèŠ‚ç‚¹æ²¡æœ‰å³å­æ ‘çš„æƒ…å½¢ã€‚å¦‚æœèŠ‚ç‚¹æ˜¯å®ƒçˆ¶èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå®ƒçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯å®ƒçš„çˆ¶èŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œå›¾2.8ä¸­èŠ‚ç‚¹dçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯bï¼ŒèŠ‚ç‚¹fçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯cã€‚ å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ—¢æ²¡æœ‰å³å­æ ‘ï¼Œå¹¶ä¸”å®ƒè¿˜æ˜¯å®ƒçˆ¶èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å½¢å°±æ¯”è¾ƒå¤æ‚ã€‚æˆ‘ä»¬å¯ä»¥æ²¿ç€æŒ‡å‘çˆ¶èŠ‚ç‚¹çš„æŒ‡é’ˆä¸€ç›´å‘ä¸Šéå†ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ˜¯å®ƒçˆ¶èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚å¦‚æœè¿™æ ·çš„èŠ‚ç‚¹å­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚ ä¸ºäº†æ‰¾åˆ°å›¾2.8ä¸­èŠ‚ç‚¹içš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬æ²¿ç€æŒ‡å‘çˆ¶èŠ‚ç‚¹çš„æŒ‡é’ˆå‘ä¸Šéå†ï¼Œå…ˆåˆ°è¾¾èŠ‚ç‚¹eã€‚ç”±äºèŠ‚ç‚¹eæ˜¯å®ƒçˆ¶èŠ‚ç‚¹bçš„å³èŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç»§ç»­å‘ä¸Šéå†åˆ°è¾¾èŠ‚ç‚¹bã€‚èŠ‚ç‚¹bæ˜¯å®ƒçˆ¶èŠ‚ç‚¹açš„å·¦å­èŠ‚ç‚¹ï¼Œå› æ­¤èŠ‚ç‚¹bçš„çˆ¶èŠ‚ç‚¹aå°±æ˜¯èŠ‚ç‚¹içš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚ æ‰¾å‡ºèŠ‚ç‚¹gçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æ­¥éª¤ç±»ä¼¼ã€‚æˆ‘ä»¬å…ˆæ²¿ç€æŒ‡å‘çˆ¶èŠ‚ç‚¹çš„æŒ‡é’ˆåˆ°è¾¾èŠ‚ç‚¹cã€‚ç”±äºèŠ‚ç‚¹cæ˜¯å®ƒçˆ¶èŠ‚ç‚¹açš„å³å­èŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç»§ç»­å‘ä¸Šéå†åˆ°è¾¾èŠ‚ç‚¹aã€‚ç”±äºèŠ‚ç‚¹aæ˜¯æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œå®ƒæ²¡æœ‰çˆ¶èŠ‚ç‚¹ï¼Œå› æ­¤èŠ‚ç‚¹gæ²¡æœ‰ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚ æˆ‘ä»¬ç”¨å¦‚ä¸‹çš„C++ä»£ç ä»äºŒå‰æ ‘ä¸­æ‰¾å‡ºä¸€ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼š BinaryTreeNode* GetNext(BinaryTreeNode* pNode) { if(pNode == nullptr) return nullptr; BinaryTreeNode* pNext = nullptr; if(pNode->m_pRight != nullptr) { BinaryTreeNode* pRight = pNode->m_pRight; while(pRight->m_pLeft != nullptr) pRight = pRight->m_pLeft; pNext = pRight; } else if(pNode->m_pParent != nullptr) { BinaryTreeNode* pCurrent = pNode; BinaryTreeNode* pParent = pNode->m_pParent; while(pParent != nullptr && pCurrent == pParent->m_pRight) { pCurrent = pParent; pParent = pParent->m_pParent; } pNext = pParent; } return pNext; } å‰‘æŒ‡ Offer P65ï¼Œæœ¬é¢˜å®Œæ•´çš„æºä»£ç ï¼šhttps://github.com/zhedahht/CodingInterviewChinese2/tree/master/08_NextNodeInBinaryTrees "},"pages/é¢è¯•ç³»åˆ—/ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—.html":{"url":"pages/é¢è¯•ç³»åˆ—/ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—.html","title":"ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—","keywords":"","body":"ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ— é¢˜ç›®ï¼šç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—çš„å£°æ˜å¦‚ä¸‹ï¼Œè¯·å®ç°å®ƒçš„ä¸¤ä¸ªå‡½æ•°appendTailå’ŒdeleteHeadï¼Œåˆ†åˆ«å®Œæˆåœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥èŠ‚ç‚¹å’Œåœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤èŠ‚ç‚¹çš„åŠŸèƒ½ã€‚ template class CQueue { public: CQueue(void); ~CQueue(void); void appendTail(const T& node); T deleteHead(); private: stackstack1; stackstack2; }; ä»ä¸Šè¿°é˜Ÿåˆ—çš„å£°æ˜ä¸­å¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ªé˜Ÿåˆ—åŒ…å«äº†ä¸¤ä¸ªæ ˆstack1å’Œstack2ï¼Œå› æ­¤è¿™é“é¢˜çš„æ„å›¾æ˜¯è¦æ±‚æˆ‘ä»¬æ“ä½œè¿™ä¸¤ä¸ªâ€œå…ˆè¿›åå‡ºâ€çš„æ ˆå®ç°ä¸€ä¸ªâ€œå…ˆè¿›å…ˆå‡ºâ€çš„é˜Ÿåˆ—CQueueã€‚ æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ¥åˆ†æå¾€è¯¥é˜Ÿåˆ—æ’å…¥å’Œåˆ é™¤å…ƒç´ çš„è¿‡ç¨‹ã€‚é¦–å…ˆæ’å…¥ä¸€ä¸ªå…ƒç´ aï¼Œä¸å¦¨å…ˆæŠŠå®ƒæ’å…¥stack1ï¼Œæ­¤æ—¶stack1ä¸­çš„å…ƒç´ æœ‰{a}ï¼Œstack2ä¸ºç©ºã€‚å†å‹å…¥ä¸¤ä¸ªå…ƒç´ bå’Œcï¼Œè¿˜æ˜¯æ’å…¥stack1ï¼Œæ­¤æ—¶stack1ä¸­çš„å…ƒç´ æœ‰{a,b,c}ï¼Œå…¶ä¸­cä½äºæ ˆé¡¶ï¼Œè€Œstack2ä»ç„¶æ˜¯ç©ºçš„ï¼Œå¦‚å›¾2.9(a)æ‰€ç¤ºã€‚ è¿™æ—¶å€™æˆ‘ä»¬è¯•ç€ä»é˜Ÿåˆ—ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚æŒ‰ç…§é˜Ÿåˆ—å…ˆå…¥å…ˆå‡ºçš„è§„åˆ™ï¼Œç”±äºaæ¯”bã€cå…ˆæ’å…¥é˜Ÿåˆ—ä¸­ï¼Œæœ€å…ˆè¢«åˆ é™¤çš„å…ƒç´ åº”è¯¥æ˜¯aã€‚å…ƒç´ aå­˜å‚¨åœ¨stack1ä¸­ï¼Œä½†å¹¶ä¸åœ¨æ ˆé¡¶ä¸Šï¼Œå› æ­¤ä¸èƒ½ç›´æ¥è¿›è¡Œåˆ é™¤ã€‚æ³¨æ„åˆ°stack2ä¸€ç›´æ²¡æœ‰è¢«ä½¿ç”¨è¿‡ï¼Œç°åœ¨æ˜¯è®©stack2å‘æŒ¥ä½œç”¨çš„æ—¶å€™äº†ã€‚å¦‚æœæˆ‘ä»¬æŠŠstack1ä¸­çš„å…ƒç´ é€ä¸ªå¼¹å‡ºå¹¶å‹å…¥stack2ï¼Œåˆ™å…ƒç´ åœ¨stack2ä¸­çš„é¡ºåºæ­£å¥½å’ŒåŸæ¥åœ¨stack1ä¸­çš„é¡ºåºç›¸åã€‚å› æ­¤ç»è¿‡3æ¬¡å¼¹å‡ºstack1å’Œå‹å…¥stack2çš„æ“ä½œä¹‹åï¼Œstack1ä¸ºç©ºï¼Œè€Œstack2ä¸­çš„å…ƒç´ æ˜¯{c,b,a}ï¼Œè¿™æ—¶å€™å°±å¯ä»¥å¼¹å‡ºstack2çš„æ ˆé¡¶aäº†ã€‚æ­¤æ—¶çš„stack1ä¸ºç©ºï¼Œè€Œstack2çš„å…ƒç´ ä¸º{c,b}ï¼Œå…¶ä¸­båœ¨æ ˆé¡¶ï¼Œå¦‚å›¾2.9(b)æ‰€ç¤ºã€‚ å¦‚æœæˆ‘ä»¬è¿˜æƒ³ç»§ç»­åˆ é™¤é˜Ÿåˆ—çš„å¤´éƒ¨åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå‰©ä¸‹çš„ä¸¤ä¸ªå…ƒç´ æ˜¯bå’Œcï¼Œbæ¯”cæ—©è¿›å…¥é˜Ÿåˆ—ï¼Œå› æ­¤båº”è¯¥å…ˆåˆ é™¤ã€‚è€Œæ­¤æ—¶bæ°å¥½åˆåœ¨æ ˆé¡¶ä¸Šï¼Œå› æ­¤ç›´æ¥å¼¹å‡ºstack2çš„æ ˆé¡¶å³å¯ã€‚åœ¨è¿™æ¬¡å¼¹å‡ºæ“ä½œä¹‹åï¼Œstacklä»ç„¶ä¸ºç©ºï¼Œè€Œstack2ä¸­çš„å…ƒç´ ä¸º{c}ï¼Œå¦‚å›¾2.9(c)æ‰€ç¤ºã€‚ ä»ä¸Šé¢çš„åˆ†æä¸­æˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºåˆ é™¤ä¸€ä¸ªå…ƒç´ çš„æ­¥éª¤ï¼šå½“stack2ä¸ä¸ºç©ºæ—¶ï¼Œåœ¨stack2ä¸­çš„æ ˆé¡¶å…ƒç´ æ˜¯æœ€å…ˆè¿›å…¥é˜Ÿåˆ—çš„å…ƒç´ ï¼Œå¯ä»¥å¼¹å‡ºã€‚å½“stack2ä¸ºç©ºæ—¶ï¼Œæˆ‘ä»¬æŠŠstack1ä¸­çš„å…ƒç´ é€ä¸ªå¼¹å‡ºå¹¶å‹å…¥stack2ã€‚ç”±äºå…ˆè¿›å…¥é˜Ÿåˆ—çš„å…ƒç´ è¢«å‹åˆ°stack1çš„åº•ç«¯ï¼Œç»è¿‡å¼¹å‡ºå’Œå‹å…¥æ“ä½œä¹‹åå°±å¤„äºstack2çš„é¡¶ç«¯ï¼Œåˆå¯ä»¥ç›´æ¥å¼¹å‡ºã€‚ æ¥ä¸‹æ¥å†æ’å…¥ä¸€ä¸ªå…ƒç´ dã€‚æˆ‘ä»¬è¿˜æ˜¯æŠŠå®ƒå‹å…¥stack1,å¦‚å›¾2.9(d)æ‰€ç¤ºï¼Œè¿™æ ·ä¼šä¸ä¼šæœ‰é—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬è€ƒè™‘ä¸‹ä¸€æ¬¡åˆ é™¤é˜Ÿåˆ—çš„å¤´éƒ¨stack2ä¸ä¸ºç©ºï¼Œç›´æ¥å¼¹å‡ºå®ƒçš„æ ˆé¡¶å…ƒç´ cï¼Œå¦‚å›¾2.9(e)æ‰€ç¤ºã€‚è€Œcçš„ç¡®æ¯”då…ˆè¿›å…¥é˜Ÿåˆ—ï¼Œåº”è¯¥åœ¨dä¹‹å‰ä»é˜Ÿåˆ—ä¸­åˆ é™¤ï¼Œå› æ­¤ä¸ä¼šå‡ºç°ä»»ä½•çŸ›ç›¾ã€‚ æ€»ç»“å®Œæ¯ä¸€æ¬¡åœ¨é˜Ÿåˆ—ä¸­æ’å…¥å’Œåˆ é™¤æ“ä½œçš„è¿‡ç¨‹ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹åŠ¨æ‰‹å†™ä»£ç äº†ã€‚å‚è€ƒä»£ç å¦‚ä¸‹ï¼š template void CQueue::appendTail(const T& element) { stack1.push(element); } template T CQueue::deleteHead() { if(stack2.size()0) { T& data = stack1.top(); stack1.pop(); stack2.push(data); } } if(stack2.size() == 0) throw new exception(\"queue is empty\"); T head = stack2.top(); stack2.pop(); return head; } å‰‘æŒ‡ Offer P68ï¼Œæœ¬é¢˜å®Œæ•´çš„æºä»£ç ï¼šhttps://github.com/zhedahht/CodingInterviewChinese2/tree/master/09_QueueWithTwoStacks "},"pages/æ•°æ®ç»“æ„å¯¼è®º/ç¬¬äºŒç« _çº¿æ€§è¡¨.html":{"url":"pages/æ•°æ®ç»“æ„å¯¼è®º/ç¬¬äºŒç« _çº¿æ€§è¡¨.html","title":"ç¬¬äºŒç«  çº¿æ€§è¡¨","keywords":"","body":"ç¬¬äºŒç«  çº¿æ€§è¡¨ é¡ºåºè¡¨å®ç°ç®—æ³•çš„åˆ†æ æ’å…¥ æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç§»åŠ¨æ¬¡æ•°ï¼šn-i+1 å¹³å‡ç§»åŠ¨æ¬¡æ•°ï¼šn/2 åˆ é™¤ æ—¶é—´å¤æ‚åº¦ï¼šO(n) ç§»åŠ¨æ¬¡æ•°ï¼šn-iï¼Œæœ€åç§»åŠ¨æ¬¡æ•°ï¼šn-1 å¹³å‡ç§»åŠ¨æ¬¡æ•°ï¼š(n-1)/2 å®šä½ æ—¶é—´å¤æ‚åº¦ï¼šO(n) è¯»è¡¨é•¿å’Œè¯»å…ƒç´  æ—¶é—´å¤æ‚åº¦ï¼šO(1) é¡ºåºè¡¨çš„æ’å…¥ã€åˆ é™¤ç®—æ³•åœ¨æ—¶é—´æ€§èƒ½æ–¹é¢æ˜¯ä¸ç†æƒ³çš„ã€‚ æ‰‹æŠŠæ‰‹æ•™ä½ æ•°æ®ç»“æ„cè¯­è¨€å®ç° æ•°æ®ç»“æ„ Cè¯­è¨€æ•°æ®ç»“æ„-é¡ºåºæ ˆ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬ä¸€ç« _æ“ä½œç³»ç»Ÿç®€ä»‹.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬ä¸€ç« _æ“ä½œç³»ç»Ÿç®€ä»‹.html","title":"ç¬¬ä¸€ç«  æ“ä½œç³»ç»Ÿç®€ä»‹","keywords":"","body":"ç¬¬ä¸€ç«  æ“ä½œç³»ç»Ÿç®€ä»‹ ç¬¬ä¸€èŠ‚ ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿ æ“ä½œç³»ç»Ÿï¼ˆOperating Systemï¼ŒOSï¼‰æ˜¯ä¸€ç§å¤æ‚çš„ç³»ç»Ÿè½¯ä»¶ï¼Œæ˜¯ä¸åŒç¨‹åºä»£ç ã€æ•°æ®ç»“æ„ã€æ•°æ®åˆå§‹åŒ–æ–‡ä»¶çš„é›†åˆï¼Œå¯æ‰§è¡Œã€‚ æ“ä½œç³»ç»Ÿæä¾›è®¡ç®—æœºç”¨æˆ·ä¸è®¡ç®—æœºç¡¬ä»¶ä¹‹é—´çš„æ¥å£ï¼Œå¹¶ç®¡ç†è®¡ç®—æœºè½¯ä»¶å’Œç¡¬ä»¶èµ„æºã€‚ æ“ä½œç³»ç»Ÿæ˜¯è¦†ç›–åœ¨è£¸æœºä¸Šçš„ç¬¬ä¸€å±‚è½¯ä»¶ï¼Œç¼–è¯‘ç¨‹åºã€æ•°æ®åº“ç®¡ç†ç³»ç»ŸåŠå…¶ä»–åº”ç”¨ç¨‹åºéƒ½è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šï¼Œæ“ä½œç³»ç»Ÿä¸ºè¿™äº›è½¯ä»¶æä¾›è¿è¡Œç¯å¢ƒã€‚ ä¸€ã€ç”¨æˆ·ä¸ç¡¬ä»¶ä¹‹é—´çš„æ¥å£ æ¥å£æ˜¯ä¸¤ä¸ªä¸åŒç»„æˆéƒ¨åˆ†çš„äº¤æ¥é¢ï¼Œåˆ†ä¸ºç¡¬ä»¶æ¥å£å’Œè½¯ä»¶æ¥å£ã€‚ è®¡ç®—æœºçš„æ‰€æœ‰åŠŸèƒ½æœ€ç»ˆéƒ½æ˜¯ç”±ç¡¬ä»¶çš„æ“ä½œå®ç°çš„ã€‚ åº”ç”¨ç¨‹åºæ˜¯åœ¨æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œçš„ï¼Œè€Œå¯¹ç¡¬ä»¶çš„æ§åˆ¶è¿‡ç¨‹éƒ½å°è£…åœ¨æ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒç¨‹åºä¸­äº†ã€‚ æœ‰æ“ä½œç³»ç»Ÿå¯¹ç¡¬ä»¶çš„æŠ½è±¡ï¼Œè€Œä¸”æ“ä½œç³»ç»Ÿä¸ºåº”ç”¨ç¨‹åºæä¾›äº†è¿è¡Œç¯å¢ƒï¼Œæ‰€ä»¥åœ¨æ“ä½œç³»ç»Ÿä¸Šç¼–å†™å’Œè¿è¡Œåº”ç”¨ç¨‹åºå°±ç®€å•å¤šäº†ã€‚ æ“ä½œç³»ç»Ÿå±è”½äº†å¯¹ç¡¬ä»¶æ“ä½œçš„ç»†èŠ‚ï¼Œæä¾›äº†è®¡ç®—æœºç”¨æˆ·ä¸è®¡ç®—æœºç¡¬ä»¶ä¹‹é—´çš„æ¥å£ï¼Œå¹¶ä¸”é€šè¿‡è¿™ä¸ªæ¥å£ä½¿åº”ç”¨ç¨‹åºçš„å¼€å‘å˜å¾—ç®€å•ã€é«˜æ•ˆã€‚ æ“ä½œç³»ç»Ÿå¿…é¡»å®Œæˆçš„ä¸¤ä¸ªä¸»è¦ç›®æ ‡å¦‚ä¸‹ï¼š ä¸ç¡¬ä»¶éƒ¨åˆ†ç›¸äº’ä½œç”¨ï¼Œä¸ºåŒ…å«åœ¨ç¡¬ä»¶å¹³å°ä¸Šçš„æ‰€æœ‰åº•å±‚å¯ç¼–ç¨‹éƒ¨åˆ†æä¾›æœåŠ¡ã€‚ ä¸ºè¿è¡Œåœ¨è®¡ç®—æœºç³»ç»Ÿä¸Šçš„åº”ç”¨ç¨‹åºï¼ˆå³æ‰€è°“ç”¨æˆ·ç¨‹åºï¼‰æä¾›æ‰§è¡Œç¯å¢ƒã€‚ äºŒã€èµ„æºçš„ç®¡ç†è€… ç°ä»£è®¡ç®—æœºç³»ç»Ÿçš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯æ”¯æŒå¤šä»»åŠ¡ï¼Œå³å…è®¸åœ¨åŒä¸€ä¸ªç³»ç»Ÿå†…åŒæ—¶é©»ç•™å¤šä¸ªåº”ç”¨ç¨‹åºã€‚ å¤šä¸ªåº”ç”¨ç¨‹åºå…±åŒä½¿ç”¨è®¡ç®—æœºç¡¬ä»¶å’Œè½¯ä»¶èµ„æºæ—¶ï¼Œå°±éœ€è¦æ“ä½œç³»ç»Ÿå¯¹è¿™äº›èµ„æºè¿›è¡Œæœ‰æ•ˆçš„ç®¡ç†ã€‚ æ“ä½œç³»ç»Ÿçš„ä¸»è¦åŠŸèƒ½ï¼š 1. å¤„ç†æœºç®¡ç† ç¨‹åºçš„æ‰§è¡Œå¿…é¡»ä¾é å¤„ç†æœºï¼Œä»»æ„æ—¶åˆ»å¤„ç†æœºéƒ½åªèƒ½æ‰§è¡Œä¸€ä¸ªç¨‹åºæµã€‚ åœ¨å•å¤„ç†æœºç³»ç»Ÿä¸­æ‰§è¡Œå¤šä¸ªç¨‹åºæµï¼Œå¿…é¡»ç”±æ“ä½œç³»ç»Ÿçš„å¤„ç†æœºè°ƒåº¦ç¨‹åºæ¥ç®¡ç†å¤„ç†æœºçš„åˆ†é…ï¼Œä»¥ä½¿å¤šä¸ªç¨‹åºå…±äº«å¤„ç†æœºï¼Œä»å®è§‚ä¸Šçœ‹å¤šä¸ªç¨‹åºèƒ½åŒæ—¶é¡ºåˆ©æ‰§è¡Œã€‚ 2. å†…å­˜ç®¡ç† åœ¨å¤šä»»åŠ¡ç³»ç»Ÿä¸­ï¼Œå†…å­˜ä¸å†æ˜¯ç‹¬å èµ„æºï¼Œè€Œæ˜¯å¯èƒ½è¢«å¤šä¸ªåº”ç”¨ç¨‹åºå…±åŒå ç”¨ã€‚å¦‚ä½•ä¸ºåº”ç”¨ç¨‹åºåˆ†é…å†…å­˜å¹¶ä½¿ä¸åŒåº”ç”¨ç¨‹åºçš„åœ°å€ç©ºé—´äº’ä¸å¹²æ‰°ï¼Œå¦‚ä½•åœ¨ç¨‹åºæ‰§è¡Œå®Œæˆåå›æ”¶å…¶æ‰€å å†…å­˜ï¼Œä»¥åŠå®Œæˆé€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢ï¼Œéƒ½æ˜¯æ“ä½œç³»ç»Ÿå†…å­˜ç®¡ç†ç¨‹åºè¦å®Œæˆçš„åŠŸèƒ½ã€‚ 3. è®¾å¤‡ç®¡ç† è®¾å¤‡ç®¡ç†ä¸»è¦å®Œæˆæ¥å—ç”¨æˆ·çš„I/Oè¯·æ±‚ã€ä¸ºç”¨æˆ·åˆ†é…I/Oè®¾å¤‡ã€ç®¡ç†I/Oç¼“å­˜å’Œé©±åŠ¨I/Oè®¾å¤‡ç­‰åŠŸèƒ½ã€‚ 4. æ–‡ä»¶ç®¡ç† è®¡ç®—æœºç³»ç»ŸæŠŠå¤§é‡éœ€è¦é•¿æ—¶é—´ä¿ç•™çš„æ•°æ®ä¿¡æ¯ä»¥æ–‡ä»¶çš„å½¢å¼å­˜æ”¾åœ¨å¤–å­˜å‚¨è®¾å¤‡ä¸­ï¼ˆå¦‚ç¡¬ç›˜ã€å…‰ç›˜ã€ç£å¸¦å’ŒUç›˜ï¼‰ï¼Œæ“ä½œç³»ç»Ÿé€šè¿‡è‡ªå·±çš„æ–‡ä»¶ç®¡ç†ç¨‹åºå®Œæˆå¤–å­˜ç©ºé—´çš„åˆ†é…ã€å›æ”¶ã€æ–‡ä»¶çš„æŒ‰åå­˜å–ã€æ–‡ä»¶çš„ç»„ç»‡ã€å…±äº«ä¸ä¿æŠ¤ç­‰åŠŸèƒ½ã€‚ ç¬¬äºŒèŠ‚ æ“ä½œç³»ç»Ÿçš„å‘å±• æ“ä½œç³»ç»Ÿçš„å‘å±•ä»æ—¶é—´é¡ºåºä¸Šç»å†äº†ä»æ— æ“ä½œç³»ç»Ÿåˆ°å•é“æ‰¹å¤„ç†ç³»ç»Ÿã€å¤šé“ç¨‹åºç³»ç»Ÿï¼ˆå¤šé“æ‰¹å¤„ç†ç³»ç»Ÿã€åˆ†æ—¶ç³»ç»Ÿï¼‰çš„å‘å±•è¿‡ç¨‹ã€‚ ä¸€ã€æ— æ“ä½œç³»ç»Ÿ ç¬¬ä¸€ä»£è®¡ç®—æœºï¼ˆ1945ï½1955å¹´ï¼‰ä½¿ç”¨ç”µå­ç®¡ä½œä¸ºä¸»è¦çš„ç”µå­å™¨ä»¶ï¼Œç”¨æ’ä»¶æ¿ä¸Šçš„ç¡¬è¿çº¿æˆ–ç©¿å­”å¡ç‰‡è¡¨ç¤ºç¨‹åºï¼Œæ²¡æœ‰ç”¨æ¥å­˜å‚¨ç¨‹åºçš„å†…å­˜ï¼Œæ— æ“ä½œç³»ç»Ÿã€‚ äºŒã€å•é“æ‰¹å¤„ç†ç³»ç»Ÿ ç¬¬äºŒä»£è®¡ç®—æœºï¼ˆ1955ï½1965å¹´ï¼‰ä½¿ç”¨çš„ä¸»è¦ç”µå­å™¨ä»¶æ˜¯æ™¶ä½“ç®¡ï¼Œå¼€å§‹ä½¿ç”¨ç£æ€§å­˜å‚¨è®¾å¤‡ï¼Œå†…å¤–å­˜å®¹é‡å¢åŠ ï¼Œè®¡ç®—æœºè¿è¡Œé€Ÿåº¦æé«˜ï¼Œå‡ºç°äº†æ—©èµ·çš„å•é“æ‰¹å¤„ç†ç³»ç»Ÿã€‚ ä¸‰ã€å¤šé“ç¨‹åºç³»ç»Ÿ æ—©æœŸå¤šé“ç¨‹åºç³»ç»Ÿä¸å…·æœ‰äº¤äº’åŠŸèƒ½ï¼Œè¢«ç§°ä¸ºå¤šé“æ‰¹å¤„ç†ç³»ç»Ÿã€‚ç¨‹åºå‘˜æäº¤ä½œä¸šåï¼Œåœ¨ä½œä¸šè¿è¡Œç»“æŸã€è¾“å‡ºç»“æœä¹‹å‰ï¼Œæ— æ³•è§‚å¯Ÿå’Œæ§åˆ¶ä½œä¸šçš„è¿è¡Œã€‚ è§£å†³è¿™ä¸€é—®é¢˜çš„éœ€æ±‚éå¸¸è¿«åˆ‡ï¼Œäºæ˜¯å‡ºç°äº†åˆ†æ—¶æ“ä½œç³»ç»Ÿã€‚ åœ¨åˆ†æ—¶æ“ä½œç³»ç»Ÿçš„æ”¯æŒä¸‹ï¼Œå¤šä¸ªç”¨æˆ·å¯ä»¥åŒæ—¶é€šè¿‡ä¸åŒçš„ç»ˆç«¯ä½¿ç”¨ä¸»æœºï¼Œä¸»æœºå¯ä»¥å¿«é€Ÿå“åº”å¸¸ç”¨å‘½ä»¤ã€‚ ä½¿ç»ˆç«¯ç”¨æˆ·æ„Ÿè§‰è‡ªå·±ç‹¬å è®¡ç®—æœºèµ„æºï¼Œå¹¶ä¸”å®ç°ç”¨æˆ·ä¸ä¸»æœºçš„åŠæ—¶äº¤äº’ã€‚ åœ¨åˆ†æ—¶æ“ä½œç³»ç»Ÿä¸­åŒæ—¶ç™»å½•ç³»ç»Ÿçš„å¤šä¸ªç”¨æˆ·æäº¤çš„ä½œä¸šè½®æµæ‰§è¡Œï¼Œæ¯ä¸ªä½œä¸šéƒ½æ˜¯è¿è¡Œä¸€å°æ®µæ—¶é—´å°±æŠŠä¸»æœºèµ„æºè®©ç»™å¦ä¸€ä¸ªä½œä¸šè¿è¡Œä¸€æ®µæ—¶é—´ï¼Œå¤šä¸ªä½œä¸šäº¤æ›¿æ‰§è¡Œï¼Œåˆ†æ—¶ä½¿ç”¨ä¸»æœºèµ„æºã€‚ å››ã€å¾®æœºæ“ä½œç³»ç»Ÿ éšç€ä¸ªäººè®¡ç®—æœºçš„å‡ºç°ï¼Œå¾®æœºæ“ä½œç³»ç»Ÿåº”è¿è€Œç”Ÿã€‚ç¬¬ä¸€ä¸ªå¾®æœºæ“ä½œç³»ç»Ÿæ˜¯Intelå…¬å¸çš„CP/Mç³»ç»Ÿï¼Œç”¨äºIntel 8080ã€‚ 20ä¸–çºª80å¹´ä»£å½¢æˆäº†æ–°DOSç‰ˆæœ¬MS-DOSã€‚ 1985å¹´å¾®è½¯å¼€å§‹æ„å»ºWindowsæ“ä½œç³»ç»Ÿã€‚ å¦ï¼Œè¿˜æœ‰Linuxã€Mac OSç­‰ä¸€äº›æ”¯æŒä¸ªäººè®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿã€‚ äº”ã€å®æ—¶æ“ä½œç³»ç»Ÿ éšç€è®¡ç®—æœºçš„å¹¿æ³›åº”ç”¨ï¼Œå‡ºç°äº†å„ç§å®æ—¶æ“ä½œç³»ç»Ÿã€‚å®æ—¶æ“ä½œç³»ç»Ÿæ˜¯æ”¯æŒå®æ—¶è®¡ç®—çš„ç³»ç»Ÿã€‚ å®æ—¶æ“ä½œç³»ç»Ÿä¸ä»…è¦æ±‚ç³»ç»Ÿæ­£ç¡®åœ°è®¡ç®—å‡ºç»“æœï¼Œè€Œä¸”è¦æ±‚å¿…é¡»åœ¨è§„å®šçš„æ—¶é—´å†…è®¡ç®—å‡ºæ­£ç¡®ç»“æœã€‚ å¦‚æœè®¡ç®—ç»“æœæ­£ç¡®ï¼Œä½†æ—¶é—´è¶…è¿‡äº†è§„å®šæ—¶é—´ï¼Œä¾ç„¶è¢«è®¤ä¸ºè®¡ç®—å‡ºé”™ã€‚ å…­ã€æ‰¹å¤„ç†ç³»ç»Ÿã€åˆ†æ—¶ç³»ç»Ÿã€å®æ—¶ç³»ç»Ÿçš„ç‰¹ç‚¹ 1. å•é“æ‰¹å¤„ç†ç³»ç»Ÿçš„ç‰¹ç‚¹ 1ï¼‰è‡ªåŠ¨æ€§ å•é“æ‰¹å¤„ç†ç³»ç»Ÿæ˜¯è®¡ç®—æœºèƒ½å¤Ÿåœ¨æ“ä½œç³»ç»Ÿæ§åˆ¶ä¸‹ï¼Œè‡ªåŠ¨åœ°å°†ä½œä¸šä»å¤–å­˜è£…å…¥å†…å­˜è¿è¡Œã€‚å½“ä½œä¸šè¿è¡Œå®Œæ¯•åï¼Œè‡ªåŠ¨æ’¤é”€å·²è¿è¡Œå®Œæ¯•çš„ä½œä¸šï¼Œå¹¶ä¾æ¬¡ä»å¤–å­˜è£…å…¥ä¸‹ä¸€ä¸ªä½œä¸šï¼Œä½¿ä¹‹è¿è¡Œã€‚ 2ï¼‰é¡ºåºæ€§ å­˜æ”¾åœ¨å¤–å­˜ä¸­çš„ä½œä¸šæŒ‰é¡ºåºä¾æ¬¡è£…å…¥å†…å­˜è¿è¡Œï¼Œå…ˆè¿›å…¥å†…å­˜çš„ä½œä¸šå…ˆè¿è¡Œå®Œæ¯•ã€‚ 3ï¼‰å•é“æ€§ ä»»ä½•æ—¶åˆ»å†…å­˜ä¸­åªæœ‰ä¸€é“ä½œä¸šã€‚ 2. å¤šé“æ‰¹å¤„ç†ç³»ç»Ÿçš„ç‰¹ç‚¹ åœ¨å¤šé“æ‰¹å¤„ç†ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·æ‰€æäº¤çš„ä½œä¸šéƒ½å…ˆå­˜æ”¾åœ¨å¤–å­˜ä¸­å¹¶æ’æˆä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—è¢«ç§°ä¸ºâ€œåå¤‡ä½œä¸šé˜Ÿåˆ—â€ã€‚ç”±æ“ä½œç³»ç»Ÿçš„ä½œä¸šè°ƒåº¦ç¨‹åºæŒ‰ä¸€å®šç­–ç•¥ä»åå¤‡ä½œä¸šé˜Ÿåˆ—ä¸­é€‰æ‹©è‹¥å¹²ä¸ªä½œä¸šè°ƒå…¥å†…å­˜ï¼Œä½¿å®ƒä»¬å…±äº«CPUå’Œç³»ç»Ÿä¸­çš„å„ç§èµ„æºï¼Œä»¥è¾¾åˆ°æé«˜èµ„æºåˆ©ç”¨ç‡å’Œç³»ç»Ÿååé‡çš„ç›®çš„ã€‚ 1ï¼‰å¤šé“æ€§ åœ¨å†…å­˜ä¸­å¯ä»¥åŒæ—¶é©»ç•™å¤šé“ç¨‹åºï¼Œå½“åœ¨CPUä¸Šè¿è¡Œçš„ä½œä¸šæå‡ºI/Oè¯·æ±‚åï¼Œè¯¥CPUå¯ä»¥æ‰§è¡Œå…¶ä»–ä½œä¸šï¼Œä»è€Œæœ‰æ•ˆåœ°æé«˜ç³»ç»Ÿèµ„æºçš„åˆ©ç”¨ç‡å’Œååé‡ã€‚ 2ï¼‰æ— åºæ€§ å¤šä¸ªä½œä¸šå®Œæˆçš„å…ˆåé¡ºåºä¸å®ƒä»¬è¿›å…¥å†…å­˜çš„é¡ºåºä¹‹é—´æ²¡æœ‰ä¸¥æ ¼çš„å¯¹åº”å…³ç³»ã€‚å…ˆè¿›å…¥å†…å­˜çš„ä½œä¸šä¸ä¸€å®šè¢«è°ƒåº¦ï¼Œä¹Ÿä¸ä¸€å®šå…ˆè¢«æ‰§è¡Œå®Œã€‚ 3ï¼‰è°ƒåº¦æ€§ å¤šé“ç¨‹åºç³»ç»Ÿå¿…é¡»å…·æœ‰ä½œä¸šè°ƒåº¦å’Œè¿›ç¨‹è°ƒåº¦åŠŸèƒ½ã€‚ä½œä¸šè°ƒåº¦ç”¨æ¥ä»åå¤‡ä½œä¸šé˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªè¦è¢«è£…å…¥å†…å­˜çš„ä½œä¸šã€‚è¿›ç¨‹è°ƒåº¦ç¨‹åºç”¨æ¥ä»å†…å­˜ä¸­é€‰æ‹©ä¸€ä¸ªï¼ˆå•CPUç³»ç»Ÿï¼‰æˆ–å¤šä¸ªï¼ˆå¤šCPUç³»ç»Ÿï¼‰è¿›ç¨‹ï¼Œä½¿å…¶åœ¨CPUä¸Šè¿è¡Œã€‚ 4ï¼‰å¤æ‚æ€§ 3. åˆ†æ—¶ç³»ç»Ÿçš„ç‰¹ç‚¹ åˆ†æ—¶æ“ä½œç³»ç»Ÿå…è®¸å¤šä¸ªç”¨æˆ·é€šè¿‡ç»ˆç«¯åŒæ—¶ä½¿ç”¨è®¡ç®—æœºã€‚ åˆ†æ—¶æ“ä½œç³»ç»Ÿæ˜¯å¤šé“ç¨‹åºç³»ç»Ÿçš„è‡ªç„¶å»¶ä¼¸ï¼Œæ”¯æŒå¤šç”¨ç”¨æˆ·ä»»åŠ¡åŒæ—¶é©»ç•™å†…å­˜ï¼Œæ¯ä¸ªç”¨æˆ·é€šè¿‡ç»ˆç«¯ä¸ä¸»æœºäº¤äº’æ—¶éƒ½èƒ½å¾—åˆ°å¿«é€Ÿå“åº”ã€‚ åˆ†æ—¶ç³»ç»Ÿçš„ç‰¹ç‚¹æ˜¯å¤šè·¯è¡Œã€ç‹¬ç«‹æ€§ã€åŠæ—¶æ€§å’Œäº¤äº’æ€§ã€‚ åˆ†æ—¶ç³»ç»Ÿçš„ä¼˜ç‚¹æ˜¯å‘ç”¨æˆ·æä¾›äº†äººæœºäº¤äº’çš„æ–¹ä¾¿æ€§ï¼Œä½¿å¤šä¸ªç”¨æˆ·å¯ä»¥é€šè¿‡ä¸åŒçš„ç»ˆç«¯å…±äº«ä¸»æœºã€‚ 4. å®æ—¶ç³»ç»Ÿçš„ç‰¹ç‚¹ å®æ—¶ç³»ç»Ÿä¸»è¦ç”¨äºå®æ—¶æ§åˆ¶å’Œå®æ—¶ä¿¡æ¯å¤„ç†é¢†åŸŸã€‚ å®æ—¶ç³»ç»Ÿå¿…é¡»èƒ½åŠæ—¶å“åº”å¤–éƒ¨äº‹ä»¶çš„è¯·æ±‚ï¼Œåœ¨è§„å®šæ—¶é—´å†…å®Œæˆå¯¹è¯¥äº‹ä»¶çš„å¤„ç†ï¼Œå¹¶æ§åˆ¶æ‰€æœ‰å®æ—¶ä»»åŠ¡åè°ƒä¸€è‡´åœ°è¿è¡Œã€‚ 1ï¼‰å¤šè·¯æ€§ 2ï¼‰ç‹¬ç«‹æ€§ æ¯ä¸ªç»ˆç«¯ç”¨æˆ·åœ¨å‘å®æ—¶ç³»ç»Ÿæå‡ºæœåŠ¡è¯·æ±‚æ—¶ï¼Œæ˜¯å½¼æ­¤ç‹¬ç«‹æ“ä½œï¼Œäº’ä¸å¹²æ‰°ã€‚ 3ï¼‰åŠæ—¶æ€§ å®æ—¶ä¿¡æ¯å¤„ç†ç³»ç»Ÿå¯¹å®æ—¶æ€§çš„è¦æ±‚æ˜¯ä»¥äººæ‰€èƒ½å¤Ÿæ¥å—çš„ç­‰å¾…æ—¶é—´æ¥ç¡®å®šçš„ã€‚ 4ï¼‰äº¤äº’æ€§ 5ï¼‰å¯é æ€§ ä¸ƒã€æ“ä½œç³»ç»Ÿäº§å“ç°çŠ¶ ä¸»æœºæ“ä½œç³»ç»Ÿ æœåŠ¡å™¨æ“ä½œç³»ç»Ÿ å¾®æœºæ“ä½œç³»ç»Ÿ åµŒå…¥å¼æ“ä½œç³»ç»Ÿ ç¬¬ä¸‰èŠ‚ æ“ä½œç³»ç»Ÿçš„ç‰¹å¾ ç°ä»£æ“ä½œç³»ç»Ÿéƒ½æ”¯æŒå¤šä»»åŠ¡ï¼Œå…·æœ‰å¹¶å‘ã€å…±äº«ã€è™šæ‹Ÿå’Œå¼‚æ­¥æ€§ç‰¹å¾ã€‚ 1. å¹¶å‘ å¹¶å‘æ˜¯æŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶é—´é—´éš”å†…å‘ç”Ÿã€‚å¹¶å‘å¼ºè°ƒâ€œåŒä¸€æ—¶é—´é—´éš”â€ï¼Œä¸å¹¶è¡Œæ˜¯æœ‰åŒºåˆ«çš„ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µï¼Œå¹¶è¡Œæ˜¯æŒ‡å¤šä¸ªäº‹ä»¶åŒæ—¶å‘ç”Ÿã€‚ 2. å…±äº« å…±äº«æ˜¯æŒ‡ç³»ç»Ÿä¸­çš„èµ„æºå¯ä¾›å†…å­˜ä¸­å¤šä¸ªå¹¶å‘æ‰§è¡Œçš„è¿›ç¨‹å…±åŒä½¿ç”¨ã€‚èµ„æºå…±äº«æœ‰ä¸¤ç§æ–¹å¼ï¼Œå³äº’æ–¥å…±äº«å’ŒåŒæ—¶å…±äº«ã€‚ 3. è™šæ‹Ÿ è™šæ‹Ÿæ˜¯æŒ‡é€šè¿‡æŸç§æŠ€æœ¯æŠŠä¸€ä¸ªç‰©ç†å®ä½“å˜æˆè‹¥å¹²é€»è¾‘ä¸Šçš„å¯¹åº”ç‰©ã€‚ 4. å¼‚æ­¥æ€§ è¿›ç¨‹ä»¥ä¸å¯é¢„çŸ¥çš„é€Ÿåº¦å‘å‰æ¨è¿›ã€‚å†…å­˜ä¸­çš„æ¯ä¸ªç¨‹åºä½•æ—¶æ‰§è¡Œã€ä½•æ—¶æš‚åœã€ä»¥æ€æ ·çš„é€Ÿåº¦å‘å‰æ¨è¿›ï¼Œä»¥åŠæ¯é“ç¨‹åºæ€»å…±éœ€è¦å¤šå°‘æ—¶é—´æ‰èƒ½å®Œæˆç­‰ï¼Œéƒ½æ˜¯ä¸å¯é¢„çŸ¥çš„ã€‚ ç¬¬å››èŠ‚ æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½ ä¸€ã€å†…å­˜ç®¡ç† å†…å­˜ç®¡ç†çš„ä¸»è¦ä»»åŠ¡æ˜¯ä¸ºå¤šé“ç¨‹åºçš„è¿è¡Œæä¾›è‰¯å¥½çš„ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨å†…å­˜ï¼Œæé«˜å†…å­˜çš„åˆ©ç”¨ç‡ï¼Œä»¥åŠä»é€»è¾‘ä¸Šæ‰©å……å†…å­˜ä»¥å®ç°è™šæ‹Ÿå­˜å‚¨ã€‚ 1. å†…å­˜åˆ†é… å†…å­˜åˆ†é…çš„ä¸»è¦ä»»åŠ¡æ˜¯ä¸ºæ¯é“ç¨‹åºåˆ†é…å†…å­˜ç©ºé—´ã€‚ æœ‰é™æ€åˆ†é…å’ŒåŠ¨æ€åˆ†é…ä¸¤ç§æ–¹å¼ï¼š é™æ€æ–¹å¼ï¼šå†…å­˜åˆ’åˆ†æˆå›ºå®šå¤§å°å’Œæ•°é‡ä¸€å®šçš„åŒºåŸŸï¼Œå†ç³»ç»Ÿè¿è¡Œè¿‡ç¨‹ä¸­å„åˆ†åŒºçš„å¤§å°å’Œæ•°é‡ä¸å†å˜åŒ–ã€‚ åŠ¨æ€æ–¹å¼ï¼šæ ¹æ®è¿›ç¨‹çš„è¯·æ±‚åˆ†é…å†…å­˜ï¼Œå†…å­˜ä¸­åˆ†åŒºçš„å¤§å°å’Œæ•°é‡éƒ½æ˜¯åŠ¨æ€å˜åŒ–çš„ã€‚ 2. å†…å­˜ä¿æŠ¤ ä¸€æ˜¯æ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸çš„ç©ºé—´ä¸ä¼šè¢«ç”¨æˆ·éšæ„è®¿é—®ï¼Œä»¥ä¿è¯ç³»ç»Ÿçš„å®‰å…¨å’Œç¨³å®šï¼› äºŒæ˜¯ç¡®ä¿æ¯é“ç”¨æˆ·ç¨‹åºéƒ½åœ¨è‡ªå·±çš„å†…å­˜ç©ºé—´ä¸­è¿è¡Œï¼Œäº’ä¸å¹²æ‰°ã€‚ 3. åœ°å€æ˜ å°„ CPUæ‰§è¡Œç¨‹åºè¿‡ç¨‹ä¸­è®¿é—®å†…å­˜æ—¶ï¼Œéœ€è¦æŠŠç¨‹åºçš„é€»è¾‘åœ°å€è½¬å˜ä¸ºç‰©ç†åœ°å€ï¼Œè¿™ä¸ªè½¬æ¢çš„è¿‡ç¨‹ç§°ä¸ºåœ°å€æ˜ å°„ã€‚ 1ï¼‰é€»è¾‘åœ°å€ä¸ç‰©ç†åœ°å€ ç›®æ ‡ç¨‹åºä¸­çš„åœ°å€ç§°ä¸ºé€»è¾‘åœ°å€ï¼Œä»0å¼€å§‹ï¼›å†…å­˜ä¸­çš„å•å…ƒåœ°å€ç§°ä¸ºç‰©ç†åœ°å€ã€‚ CPUè®¿é—®å†…å­˜éœ€è¦å°†ç‰©ç†åœ°å€é€å…¥åœ°å€æ€»çº¿ï¼Œä»¥é€‰ä¸­è¦è®¿é—®çš„å†…å­˜å•å…ƒã€‚ 2ï¼‰åœ°å€æ˜ å°„ å°†é€»è¾‘åœ°å€è½¬æ¢ä¸ºå¯¹åº”çš„ç‰©ç†åœ°å€ã€‚ 4. å†…å­˜æ‰©å…… å†…å­˜æ‰©å……çš„ä»»åŠ¡æ—¶å€ŸåŠ©äºè™šæ‹Ÿå­˜å‚¨æŠ€æœ¯ï¼Œä»é€»è¾‘ä¸Šæ‰©å……å†…å­˜å®¹é‡ï¼Œä½¿ç³»ç»Ÿèƒ½å¤Ÿå‘ç”¨æˆ·æä¾›æ¯”ç‰©ç†å†…å­˜å¤§çš„å­˜å‚¨å®¹é‡ã€‚ 1ï¼‰è¯·æ±‚è°ƒå…¥åŠŸèƒ½ 2ï¼‰ç½®æ¢åŠŸèƒ½ äºŒã€è¿›ç¨‹ç®¡ç† è¿›ç¨‹å¯ä»¥è¢«è®¤ä¸ºæ˜¯ç¨‹åºçš„æ‰§è¡Œå®ä½“ã€‚ ä¸‰ã€è®¾å¤‡ç®¡ç† ä¸»è¦å®Œæˆç”¨æˆ·çš„I/Oè¯·æ±‚ï¼Œä¸ºç”¨æˆ·åˆ†é…I/Oè®¾å¤‡ã€‚ è®¾å¤‡ç®¡ç†çš„åŠŸèƒ½ï¼š 1ï¼‰ç¼“å†²ç®¡ç† 2ï¼‰è®¾å¤‡åˆ†é… 3ï¼‰è®¾å¤‡å¤„ç† ç”±è®¾å¤‡é©±åŠ¨ç¨‹åºæ¥å®ç°CPUä¸è®¾å¤‡æ§åˆ¶å™¨ä¹‹é—´çš„é€šä¿¡ã€‚ 4ï¼‰è®¾å¤‡ç‹¬ç«‹æ€§å’Œè™šæ‹Ÿè®¾å¤‡ è®¾å¤‡ç‹¬ç«‹æ€§åŠŸèƒ½ä½¿åº”ç”¨ç¨‹åºç‹¬ç«‹äºç‰©ç†è®¾å¤‡ã€‚ è™šæ‹Ÿè®¾å¤‡çš„åŠŸèƒ½æ˜¯æŠŠä¸€ä¸ªç‰©ç†è®¾å¤‡å˜æ¢ä¸ºå¤šä¸ªå¯¹åº”çš„é€»è¾‘è®¾å¤‡ï¼Œä½¿ä¸€ä¸ªç‰©ç†è®¾å¤‡èƒ½ä¾›å¤šä¸ªç”¨æˆ·å…±äº«ã€‚ å››ã€æ–‡ä»¶ç®¡ç† 1. æ–‡ä»¶å­˜å‚¨ç©ºé—´çš„ç®¡ç† ä¸ºæ¯ä¸ªæ–‡ä»¶åˆ†é…å¿…è¦çš„å¤–å­˜ç©ºé—´ï¼Œæé«˜å¤–å­˜åˆ©ç”¨ç‡ï¼Œå¹¶èƒ½æœ‰åŠ©äºæé«˜è®¿é—®æ–‡ä»¶çš„é€Ÿåº¦ã€‚ 2. ç›®å½•ç®¡ç† ä¸ºæ¯ä¸ªæ–‡ä»¶å»ºç«‹ç›®å½•é¡¹å¹¶å¯¹ä¼—å¤šç›®å½•é¡¹è¿›è¡Œæœ‰æ•ˆç»„ç»‡ã€‚ 3. æ–‡ä»¶çš„è¯»ã€å†™ç®¡ç†å’Œå­˜å–æ§åˆ¶ æ ¹æ®ç”¨æˆ·çš„è¯·æ±‚ï¼Œä»å¤–å­˜ä¸­è¯»å–æ•°æ®æˆ–å°†æ•°æ®å†™å…¥å¤–å­˜ã€‚é˜²æ­¢æœªç»æ ¸å‡†çš„ç”¨æˆ·å­˜å–æ–‡ä»¶ï¼Œé˜²æ­¢å†’åé¡¶æ›¿å­˜å–æ–‡ä»¶ï¼Œé˜²æ­¢ä»¥ä¸æ­£ç¡®çš„æ–¹å¼ä½¿ç”¨æ–‡ä»¶ã€‚ äº”ã€æä¾›ç”¨æˆ·æ¥å£ ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨æ“ä½œç³»ç»Ÿï¼Œæ“ä½œç³»ç»Ÿå‘ç”¨æˆ·æä¾›äº†ç”¨æˆ·ä¸æ“ä½œç³»ç»Ÿä¹‹é—´çš„æ¥å£ã€‚ 1. å‘½ä»¤æ¥å£ ä¸ºäº†ä¾¿äºç”¨æˆ·ä¸è®¡ç®—æœºç³»ç»Ÿçš„äº¤äº’ 1ï¼‰è”æœºç”¨æˆ·æ¥å£ è¿™æ˜¯ä¸ºè”æœºç”¨æˆ·è®¾è®¡çš„æ¥å£ï¼Œå®ƒç”±ä¸€ç»„é”®ç›˜æ“ä½œå‘½ä»¤å’Œå‘½ä»¤è§£é‡Šç¨‹åºç»„æˆã€‚ 2ï¼‰è„±æœºç”¨æˆ·æ¥å£ è„±æœºç”¨æˆ·æ¥å£æ˜¯ä¸ºæ‰¹å¤„ç†ä½œä¸šçš„ç”¨æˆ·æä¾›çš„ï¼Œä¹Ÿç§°ä¸ºæ‰¹å¤„ç†ç”¨æˆ·æ¥å£ã€‚ 2. å›¾å½¢ç”¨æˆ·æ¥å£ 20ä¸–çºª90å¹´ä»£ï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­å¼€å§‹å¼•å…¥å›¾å½¢åŒ–ç”¨æˆ·æ¥å£ã€‚ 3. ç¨‹åºæ¥å£ æ“ä½œç³»ç»Ÿæä¾›ç»™ç¨‹åºå‘˜çš„æ¥å£æ˜¯ç³»ç»Ÿè°ƒç”¨ã€‚ ç¬¬äº”èŠ‚ æ“ä½œç³»ç»Ÿçš„ä½“ç³»ç»“æ„ ä¸€ã€è½¯ä»¶ä½“ç³»ç»“æ„ç®€ä»‹ è½¯ä»¶ä½“ç³»ç»“æ„æ˜¯ä¸€ä¸ªå¤æ‚è½¯ä»¶ç³»ç»Ÿçš„é«˜å±‚ç»“æ„ï¼Œä¸ºè½¯ä»¶ç³»ç»Ÿæä¾›äº†ä¸€ä¸ªç»“æ„ã€è¡Œä¸ºå’Œå±æ€§çš„é«˜çº§æŠ½è±¡ã€‚ æ˜ç¡®æ¸…æ™°çš„è½¯ä»¶ä½“ç³»ç»“æ„æ˜¯ä¸€æ¡è´¯ç©¿è½¯ä»¶ç³»ç»Ÿæ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„ä¸»çº¿ï¼Œæ˜¯è½¯ä»¶è®¾è®¡æˆåŠŸçš„åŸºç¡€å’Œå…³é”®ï¼Œä¹Ÿæ˜¯å¯¹è½¯ä»¶å¤§å‹åŒ–ã€å¤æ‚åŒ–è¶‹åŠ¿çš„ä¸€ç§å¾ˆå¥½çš„åº”å¯¹å†³ç­–ã€‚ 1. ç®€å•çš„ç›‘æ§ç¨‹åºæ¨¡å‹ ä»»æ„æ—¶åˆ»ç³»ç»Ÿä¸­åªèƒ½è¿è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œè¿™æ ·ä¿è¯äº†å¯¹ç³»ç»Ÿä¿¡æ¯çš„äº’æ–¥è®¿é—®ï¼Œä¿æŠ¤äº†ç³»ç»Ÿæ•°æ®çš„å®‰å…¨ã€‚ 2. å•ä½“ç»“æ„æ¨¡å‹ å•ä½“ç»“æ„æ¨¡å‹æ˜¯è½¯ä»¶å·¥ç¨‹å‡ºç°ä»¥å‰çš„æ—©æœŸæ“ä½œç³»ç»ŸåŠç›®å‰ä¸€äº›å°å‹æ“ä½œç³»ç»Ÿé‡‡ç”¨çš„ä½“ç³»ç»“æ„ã€‚åœ¨å•ä½“ç»“æ„æ¨¡å‹ï¼Œæ‰€æœ‰çš„è½¯ä»¶å’Œæ•°æ®ç»“æ„éƒ½æ”¾ç½®åœ¨ä¸€ä¸ªé€»è¾‘æ¨¡å—ä¸­ï¼Œå¯¹å¤–å±‚çš„ç”¨æˆ·ç¨‹åºæä¾›ä¸€ä¸ªå®Œæ•´çš„å†…æ ¸ç•Œé¢-ç³»ç»Ÿè°ƒç”¨ã€‚ å…·æœ‰å•ä½“å†…æ ¸ç»“æ„çš„å…¸å‹æ“ä½œç³»ç»Ÿç”±UNIXç³»ç»Ÿã€MS-DOSã€Linuxã€Mac OS X å’Œ BSDç­‰ç³»ç»Ÿã€‚ 3. å±‚æ¬¡ç»“æ„æ¨¡å‹ å±‚æ¬¡ç»“æ„çš„åŸºæœ¬æ€æƒ³æ˜¯å°†æ“ä½œç³»ç»Ÿåˆ†è§£ä¸ºå¤šä¸ªå°çš„ã€å®¹æ˜“ç†è§£çš„å±‚ï¼Œç³»ç»ŸåŠŸèƒ½è¢«éš”ç¦»åœ¨ä¸åŒå±‚ä¸­ï¼Œæ¯ä¸€å±‚æä¾›å¯¹ç³»ç»ŸåŠŸèƒ½çš„éƒ¨åˆ†æŠ½è±¡ï¼Œç„¶åé‡‡ç”¨å•å‘è°ƒç”¨çš„é¡ºåºï¼Œå½¢æˆä¸€è¿ä¸²å½¼æ­¤è¿ç»­çš„å¯¹ç³»ç»ŸåŠŸèƒ½çš„â€œæŠ½è±¡ä¸²â€ï¼Œæœ€ç»ˆå½¢æˆå¯¹æ•´ä¸ªç³»ç»Ÿçš„å®ŒæˆæŠ½è±¡ã€‚ 4. å®¢æˆ·/æœåŠ¡å™¨æ¨¡å‹ä¸å¾®å†…æ ¸ç»“æ„ æŠŠä¼ ç»Ÿæ“ä½œç³»ç»Ÿå†…æ ¸ä¸­çš„ä¸€äº›ç»„æˆéƒ¨åˆ†æ”¾åˆ°å†…æ ¸ä¹‹å¤–ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡å™¨è¿›ç¨‹æ¥å®ç°ï¼Œåœ¨å¾®å†…æ ¸ä¸­åªä¿ç•™äº†æ“ä½œç³»ç»Ÿæœ€åŸºæœ¬çš„åŠŸèƒ½ã€‚ ç›®å‰å¾®å†…æ ¸çš„æ“ä½œç³»ç»Ÿä¸€ä¸ªæ˜¯æƒ³é€šç”¨æ“ä½œç³»ç»Ÿçš„æ–¹å‘å‘å±•ï¼Œå¦‚Windows NTï¼›å¦ä¸€ä¸ªå°±æ˜¯åµŒå…¥å¼æ“ä½œç³»ç»Ÿã€‚ 5. åŠ¨æ€å¯æ‰©å±•ç»“æ„æ¨¡å‹ åŠ¨æ€å¯æ‰©å±•ç»“æ„æ¨¡å‹çš„åŸºæœ¬æ€æƒ³æ˜¯åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œèƒ½å¤ŸåŠ¨æ€å®ç°ç³»ç»Ÿè¡Œä¸ºæ‰©å±•çš„ç»“æ„ï¼Œä¹Ÿå¯ç§°ä¸ºå¼¹æ€§ç»“æ„ã€‚ ç¬¬å…­èŠ‚ æŒ‡ä»¤çš„æ‰§è¡Œ ç¨‹åºæ˜¯æŒ‡ä»¤çš„é›†åˆï¼Œç¨‹åºçš„æ‰§è¡Œå°±æ˜¯æŒ‰ç…§æŸç§æ§åˆ¶æµæ‰§è¡ŒæŒ‡ä»¤çš„è¿‡ç¨‹ã€‚ 1. æŒ‡ä»¤å‘¨æœŸ ä¸€ä¸ªå•ä¸€æŒ‡ä»¤éœ€è¦çš„å¤„ç†ç§°ä¸ºæŒ‡ä»¤å‘¨æœŸï¼Œä¸€ä¸ªæŒ‡ä»¤å‘¨æœŸå¯ä»¥åˆ’åˆ†æˆä¸¤ä¸ªæ­¥éª¤ï¼Œåˆ†åˆ«æ˜¯å–æŒ‡å‘¨æœŸå’Œæ‰§è¡Œå‘¨æœŸã€‚ 2. å–æŒ‡ä»¤å’Œæ‰§è¡ŒæŒ‡ä»¤ 1ï¼‰å–æŒ‡ä»¤ åœ¨æ¯ä¸ªæŒ‡ä»¤å‘¨æœŸå¼€å§‹æ—¶ï¼Œå¤„ç†å™¨ä»å­˜å‚¨å™¨ä¸­å–ä¸€æ¡æŒ‡ä»¤ã€‚ 2ï¼‰æ‰§è¡ŒæŒ‡ä»¤ å–åˆ°çš„æŒ‡ä»¤è¢«æ”¾ç½®åœ¨å¤„ç†å™¨çš„æŒ‡ä»¤å¯„å­˜å™¨IRä¸­ã€‚ 3. ä¸€ä¸ªå®ä¾‹ 1ï¼‰ç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰ï¼Œå­˜æŒ‡ä»¤åœ°å€ã€‚ 2ï¼‰æŒ‡ä»¤å¯„å­˜å™¨ï¼ˆIRï¼‰ï¼Œå­˜æ­£åœ¨æ‰§è¡Œçš„æŒ‡ä»¤ã€‚ 3ï¼‰ç´¯åŠ å™¨ï¼ˆACï¼‰ï¼Œä¸´æ—¶å­˜å‚¨ä½“å’Œç´¯åŠ æ“ä½œã€‚ éƒ¨åˆ†æ“ä½œç çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸å…¶å¯¹åº”çš„æ“ä½œå¦‚ä¸‹ã€‚ 1ï¼‰0001:ä»å†…å­˜ä¸­è¯»å–æ•°æ®å¹¶é€å…¥ACã€‚ 2ï¼‰0010:æŠŠACçš„å†…å®¹å­˜å‚¨åˆ°å†…å­˜ä¸­ã€‚ 3ï¼‰0101:æŠŠä»å†…å­˜ä¸­å–å¾—çš„å€¼ä¸ACä¸­çš„å€¼ç›¸åŠ ï¼Œç»“æœä»å­˜æ”¾åœ¨ACä¸­ã€‚ ç¨‹åºåŠŸèƒ½ æŠŠå†…å­˜940å•å…ƒçš„å†…å®¹ä¸941å•å…ƒçš„å†…å®¹ç›¸åŠ ï¼Œç»“æœé€å…¥941å•å…ƒã€‚ç¨‹åºçš„3æ¡æŒ‡ä»¤ï¼š move AC,(940); 1940 add AC,(941); 5941 move(941),AC; 2941 å…¶ä¸­ï¼Œmoveè¡¨ç¤ºä¼ é€ï¼Œmove AC,(940)æŒ‡ä»¤çš„åŠŸèƒ½æ˜¯å°†(940)å†…å­˜å•å…ƒçš„å€¼ä¼ å…¥ç´¯åŠ å™¨ACã€‚å¯¹åº”çš„æ“ä½œç ä¸º0001ã€‚ â€œ;â€åé¢å†…å®¹ä¸ºæ³¨é‡Šä¿¡æ¯ï¼Œ1940æ˜¯move AC,(940)æŒ‡ä»¤å¯¹åº”çš„æœºå™¨ç ã€‚ add AC,(941)æŒ‡ä»¤çš„åŠŸèƒ½æ˜¯å°†(941)å­˜å‚¨å•å…ƒçš„å†…å®¹ä¸ç´¯åŠ å™¨ACä¸­çš„å†…å®¹ç›¸åŠ ï¼Œå†é€å…¥ACï¼›å¯¹åº”çš„æ“ä½œç ä¸º0101. move(941),ACæŒ‡ä»¤çš„åŠŸèƒ½æ˜¯å°†ACç´¯åŠ å™¨çš„å†…å®¹ä¼ é€åˆ°941å·å­˜å‚¨å•å…ƒã€‚å¯¹åº”çš„æ“ä½œç ä¸º0010ã€‚ åˆ†æï¼šç¬¬ä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹ 1ï¼‰ç¨‹åºå¼€å§‹æ‰§è¡Œæ—¶ï¼Œç¨‹åºè®¡æ•°å™¨PCçš„å€¼ä¸ºmove AC,(940)æŒ‡ä»¤å¯¹åº”çš„æœºå™¨ç 1940æ‰€åœ¨çš„å­˜å‚¨å•å…ƒçš„åœ°å€300ã€‚ 2ï¼‰CPUå°†1940é€å…¥æŒ‡ä»¤å¯„å­˜å™¨IRï¼ŒPCå€¼è‡ªåŠ¨åŠ 1ï¼Œå˜ä¸º301ã€‚ 3ï¼‰CPUå¯¹1940è¿›è¡Œè¯‘ç ã€‚ 4ï¼‰æ“ä½œç ä¸º0001æ—¶ï¼Œæ‰§è¡Œä»å†…å­˜940å•å…ƒå–æ•°é€å…¥ACã€‚ 5ï¼‰æŒ‡ä»¤æ‰§è¡Œç»“æœæ˜¯æŠŠåœ°å€ä¸º940çš„å†…å­˜å•å…ƒçš„å€¼3é€å…¥ACã€‚ ä¾‹é¢˜ å°†å†…å­˜100å•å…ƒçš„å†…å®¹ä¸101å•å…ƒçš„å†…å®¹ç›¸åŠ ï¼Œå¹¶å°†ç›¸åŠ çš„ç»“æœä¼ å…¥101å•å…ƒï¼Œè¯·æ ¹æ®ç¨‹åºçš„åŠŸèƒ½å†™å‡ºç¨‹åºå¯¹åº”çš„æŒ‡ä»¤ã€‚ï¼ˆæç¤ºï¼šæœŸé—´éœ€è¦ç”¨åˆ°ç´¯åŠ å™¨ACï¼‰ move AC,(100) add AC,(101) move (101),AC è§£æï¼šæœ¬é¢˜é€šè¿‡ç´¯åŠ å™¨ACæ±‚å’Œï¼Œå¹¶å°†ç»“æœé€å…¥æŒ‡å®šçš„å•å…ƒã€‚ 4. æŒ‡ä»¤çš„æ‰§è¡Œå°ç»“ ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹æ˜¯åå¤å–æŒ‡ä»¤å’Œæ‰§è¡ŒæŒ‡ä»¤çš„è¿‡ç¨‹ã€‚ æœ¬ç« å°èŠ‚ ç¬¬ä¸€ç« ä¸»è¦ä»‹ç»äº†æ“ä½œç³»ç»Ÿçš„åŸºç¡€çŸ¥è¯†ï¼Œä»æ“ä½œç³»ç»Ÿçš„æ¦‚å¿µã€ä½œç”¨ã€åŠŸèƒ½ã€ç‰¹å¾ã€å‘å±•åŠè½¯ä»¶ä½“ç³»ç»“æ„ç­‰æ–¹é¢å¯¹æ“ä½œç³»ç»Ÿè¿›è¡Œäº†ä»‹ç»ï¼Œæœ€åä¸€èŠ‚ä»‹ç»äº†æŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äºŒç« _è¿›ç¨‹ç®¡ç†/ç¬¬ä¸€èŠ‚_è¿›ç¨‹çš„æè¿°.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äºŒç« _è¿›ç¨‹ç®¡ç†/ç¬¬ä¸€èŠ‚_è¿›ç¨‹çš„æè¿°.html","title":"ç¬¬ä¸€èŠ‚ è¿›ç¨‹çš„æè¿°","keywords":"","body":"ç¬¬ä¸€èŠ‚ è¿›ç¨‹çš„æè¿° ä¸€ã€ç¨‹åºçš„å¹¶å‘æ‰§è¡Œ 1. ç¨‹åºçš„é¡ºåºæ‰§è¡Œ æ—©æœŸæ— æ“ä½œç³»ç»ŸåŠå•é“æ‰¹å¤„ç†ç³»ç»Ÿçš„è®¡ç®—æœºä¸­ï¼Œç¨‹åºçš„æ‰§è¡Œæ–¹å¼éƒ½æ˜¯ç»å…¸çš„é¡ºåºæ‰§è¡Œã€‚ 1ï¼‰é¡ºåºæ€§ å¤„ç†æœºçš„æ“ä½œï¼Œä¸¥æ ¼æŒ‰ç…§ç¨‹åºæ‰€è§„å®šçš„é¡ºåºæ‰§è¡Œï¼Œå³åªæœ‰å‰ä¸€ä¸ªæ“ä½œç»“æŸåï¼Œæ‰èƒ½æ‰§è¡Œåç»§æ“ä½œã€‚ 2ï¼‰å°é—­æ€§ ç¨‹åºæ˜¯åœ¨å°é—­çš„ç¯å¢ƒä¸‹è¿è¡Œçš„ã€‚å³ç¨‹åºè¿è¡Œæ—¶ç‹¬å å…¨æœºèµ„æºï¼Œå› è€Œå„èµ„æºçš„çŠ¶æ€ï¼ˆé™¤åˆå§‹çŠ¶æ€å¤–ï¼‰åªæœ‰æœ¬ç¨‹åºæ‰èƒ½æ”¹å˜ã€‚ 3ï¼‰å¯å†ç°æ€§ åªè¦ç¨‹åºæ‰§è¡Œæ—¶çš„ç¯å¢ƒå’Œåˆå§‹æ¡ä»¶ç›¸åŒï¼Œå½“ç¨‹åºå¤šæ¬¡é‡å¤æ‰§è¡Œæ—¶ï¼Œå…¶æ‰§è¡Œç»“æœç›¸åŒã€‚ 2. ç¨‹åºçš„å¹¶å‘æ‰§è¡Œ ç¨‹åºå¹¶å‘æ‰§è¡Œæ˜¯æŒ‡åœ¨åŒä¸€æ—¶é—´é—´éš”å†…è¿è¡Œå¤šä¸ªç¨‹åºã€‚ä¸€ä¸ªç¨‹åºæ‰§è¡Œç»“æŸä¹‹å‰ï¼Œå¯ä»¥è¿è¡Œå…¶ä»–ç¨‹åºã€‚ ç¨‹åºå¹¶å‘æ‰§è¡Œçš„ç¡®åˆ‡å«ä¹‰æ˜¯ä»å®è§‚ä¸Šï¼Œç”¨æˆ·çœ‹åˆ°å¤šä¸ªç¨‹åºåŒæ—¶å‘å‰ä¸é—´æ–­åœ°æ¨è¿›ã€‚è€Œä»å¾®è§‚ä¸Šï¼Œä»»æ„æ—¶åˆ»ä¸€ä¸ªCPUä¸Šåªæœ‰ä¸€ä¸ªç¨‹åºåœ¨æ‰§è¡Œã€‚ 1ï¼‰é—´æ–­æ€§ ç¨‹åºåœ¨å¹¶å‘æ‰§è¡Œæ—¶ï¼Œç”±äºå®ƒä»¬å…±äº«èµ„æºï¼Œè€Œèµ„æºæ•°é‡åˆå¾€å¾€å°‘äºå¹¶å‘æ‰§è¡Œçš„ç¨‹åºæ•°é‡ï¼Œç³»ç»Ÿä¸èƒ½ä¿è¯æ¯ä¸ªç¨‹åºä¸å—é™åˆ¶åœ°å ç”¨èµ„æºã€‚å› è€Œï¼Œæ¯ä¸ªç¨‹åºåœ¨CPUä¸Šè¿è¡Œï¼Œéƒ½æ˜¯æ—¶æ–­æ—¶ç»­çš„ã€‚ å½“è¯·æ±‚æŸä¸ªèµ„æºçš„ç¨‹åºæ•°é‡å¤§äºè¢«è¯·æ±‚çš„èµ„æºæ•°é‡æ—¶ï¼Œå°±å¿…ç„¶æœ‰å› ç”³è¯·ä¸åˆ°èµ„æºè€Œæš‚åœæ‰§è¡Œçš„ç¨‹åºã€‚ å½“å…¶ä»–ç¨‹åºé‡Šæ”¾èµ„æºåï¼Œè¯¥ç¨‹åºæ‰å¯èƒ½ç»§ç»­æ‰§è¡Œã€‚èµ„æºçš„æœ‰é™ä½¿å¹¶å‘æ‰§è¡Œçš„ç¨‹åºå‘ˆç°æ‰§è¡Œè¿‡ç¨‹çš„é—´æ–­æ€§ã€‚ 2ï¼‰å¤±å»å°é—­æ€§ ç¨‹åºåœ¨å¹¶å‘æ‰§è¡Œæ—¶ï¼Œç”±äºå®ƒä»¬å…±äº«èµ„æºæˆ–è€…åˆä½œå®ŒæˆåŒä¸€é¡¹ä»»åŠ¡ï¼Œç³»ç»Ÿçš„çŠ¶æ€ä¸å†æ˜¯æœ‰æ­£åœ¨æ‰§è¡Œçš„æŸä¸€ä¸ªç¨‹åºå¯ä»¥â€œçœ‹è§â€å’Œæ”¹å˜ã€‚ 3ï¼‰ä¸å¯å†ç°æ€§ ç¨‹åºåœ¨å¹¶å‘æ‰§è¡Œæ—¶ï¼Œç”±äºå¤±å»äº†å°é—­æ€§ï¼Œä¹Ÿå°†å¯¼è‡´å…¶å¤±å»æ‰§è¡Œç»“æœçš„å¯å†ç°æ€§ã€‚åŒä¸€ä¸ªç¨‹åºåœ¨è¾“å…¥å®Œå…¨ç›¸åŒçš„æƒ…å†µä¸‹å¤šæ¬¡è¿è¡Œï¼Œå¯èƒ½å‡ºç°ä¸åŒçš„è¿è¡Œç»“æœã€‚ äºŒã€è¿›ç¨‹çš„æ¦‚å¿µ å½“æ“ä½œç³»ç»Ÿæ”¯æŒç¨‹åºå¹¶å‘æ‰§è¡Œæ—¶ï¼Œå¹¶å‘æ‰§è¡Œçš„ç¨‹åºå¯èƒ½æ˜¯åŒä¸€ä¸ªç¨‹åºåœ¨ä¸åŒæ•°æ®é›†åˆä¸Šçš„æ‰§è¡Œï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸åŒçš„ç¨‹åºåœ¨ä¸åŒæ•°æ®é›†åˆä¸Šçš„æ‰§è¡Œï¼Œå®ƒä»¬å…±äº«ç³»ç»Ÿèµ„æºã€‚ç”¨ç¨‹åºå·²ä¸èƒ½æè¿°ç¨‹åºçš„å¹¶å‘æ‰§è¡Œï¼Œæ‰€ä»¥å¼•å…¥äº†è¿›ç¨‹çš„æ¦‚å¿µã€‚ 1. è¿›ç¨‹çš„å®šä¹‰ å®šä¹‰1ï¼šè¿›ç¨‹æ˜¯å…è®¸å¹¶å‘æ‰§è¡Œçš„ç¨‹åºåœ¨æŸä¸ªæ•°æ®é›†åˆä¸Šçš„è¿è¡Œè¿‡ç¨‹ã€‚ å®šä¹‰2ï¼šè¿›ç¨‹æ˜¯ç”±æ­£æ–‡æ®µã€ç”¨æˆ·æ•°æ®æ®µåŠè¿›ç¨‹æ§åˆ¶å—å…±åŒç»„æˆçš„æ‰§è¡Œç¯å¢ƒã€‚æ­£æ–‡æ®µå­˜æ”¾è¢«æ‰§è¡Œçš„æœºå™¨æŒ‡ä»¤ï¼Œç”¨æˆ·æ•°æ®æ®µå­˜æ”¾è¿›ç¨‹åœ¨æ‰§è¡Œæ—¶ç›´æ¥è¿›è¡Œæ“ä½œçš„ç”¨æˆ·æ•°æ®ã€‚è¿›ç¨‹æ§åˆ¶å—å­˜æ”¾ç¨‹åºçš„è¿è¡Œç¯å¢ƒï¼Œæ“ä½œç³»ç»Ÿé€šè¿‡è¿™äº›æ•°æ®æè¿°å’Œç®¡ç†è¿›ç¨‹ã€‚ ç¨‹åºè£…å…¥å†…å­˜åå°±å¯ä»¥è¿è¡Œäº†ï¼Œæ ¹æ®æŒ‡ä»¤è®¡æ•°å™¨PCçš„å€¼ï¼Œä¸æ–­å°†æŒ‡ä»¤ä»å†…å­˜å–åˆ°CPUçš„æŒ‡ä»¤å¯„å­˜å™¨ä¸­ï¼Œç»è¿‡è¯‘ç åå®Œæˆå„ç§æ“ä½œã€‚è¿™äº›æŒ‡ä»¤æ§åˆ¶çš„å¯¹è±¡ä¸å¤–ä¹å„ç§å­˜å‚¨å™¨ï¼ˆå†…å­˜ã€å¤–å­˜å’Œå„ç§CPUå¯„å­˜å™¨ï¼‰ï¼Œè¿™äº›å­˜å‚¨å™¨ä¸­æœ‰å¾…è¿è¡Œçš„æŒ‡ä»¤å’Œå¾…å¤„ç†çš„æ•°æ®ï¼ŒæŒ‡ä»¤åªæœ‰å¾—åˆ°CPUæ‰èƒ½å‘æŒ¥ä½œç”¨ã€‚ å¯è§ï¼Œåœ¨è®¡ç®—æœºå†…éƒ¨ï¼Œç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹å®é™…å¯¹åº”äº†ä¸€ä¸ªæ‰§è¡Œç¯å¢ƒçš„æ€»å’Œã€‚è¿™ä¸ªæ‰§è¡Œç¯å¢ƒåŒ…æ‹¬ç¨‹åºä¸­çš„å„ç§æŒ‡ä»¤å’Œæ•°æ®ï¼Œè¿˜æœ‰ä¸€äº›é¢å¤–æ•°æ®ï¼Œå¦‚å¯„å­˜å™¨çš„å€¼ã€ç”¨æ¥ä¿å­˜ä¸´æ—¶æ•°æ®çš„å †æ ˆã€è¢«æ‰“å¼€æ–‡ä»¶çš„æ•°é‡åŠè¾“å…¥/è¾“å‡ºè®¾å¤‡çš„çŠ¶æ€ç­‰ã€‚è¿™ä¸ªæ‰§è¡Œç¯å¢ƒçš„åŠ¨æ€å˜åŒ–è¡¨å¾ç¨‹åºçš„è¿è¡Œï¼Œä¸€ä¸ªè¿›ç¨‹å¯¹åº”äº†ä¸€ä¸ªè¿™æ ·çš„ç¯å¢ƒã€‚ è¿›ç¨‹ä»£è¡¨äº†ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæ˜¯ä¸€ä¸ªåŠ¨æ€çš„å®ä½“ï¼Œå®ƒéšç€ç¨‹åºä¸­æŒ‡ä»¤çš„æ‰§è¡Œè€Œä¸æ–­å˜åŒ–ï¼Œåœ¨æŸä¸ªç‰¹å®šæ—¶åˆ»çš„è¿›ç¨‹å†…å®¹è¢«ç§°ä¸ºè¿›ç¨‹æ˜ åƒã€‚ 2. è¿›ç¨‹çš„ç‰¹å¾ 1ï¼‰å¹¶å‘æ€§ å¤šä¸ªè¿›ç¨‹å®ä½“èƒ½åœ¨ä¸€æ®µæ—¶é—´é—´éš”å†…åŒæ—¶è¿è¡Œã€‚ 2ï¼‰åŠ¨æ€æ€§ è¿›ç¨‹æ˜¯è¿›ç¨‹å®ä½“çš„æ‰§è¡Œè¿‡ç¨‹ã€‚ 3ï¼‰ç‹¬ç«‹æ€§ åœ¨æ²¡æœ‰å¼•å…¥çº¿ç¨‹æ¦‚å¿µçš„æ“ä½œç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹æ˜¯ç‹¬ç«‹è¿è¡Œå’Œèµ„æºè°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚ 4ï¼‰å¼‚æ­¥æ€§ æ˜¯æŒ‡è¿›ç¨‹çš„æ‰§è¡Œæ—¶æ–­æ—¶ç»­ï¼Œè¿›ç¨‹ä»€ä¹ˆæ—¶å€™æ‰§è¡Œã€ä»€ä¹ˆæ—¶å€™æš‚åœéƒ½æ— æ³•é¢„çŸ¥ï¼Œå‘ˆç°ä¸€ç§éšæœºçš„ç‰¹å¾ã€‚ 5ï¼‰ç»“æ„ç‰¹å¾ è¿›ç¨‹å®ä½“åŒ…æ‹¬ç”¨æˆ·æ­£æ–‡æ®µï¼Œç”¨æˆ·æ•°æ®æ®µå’Œè¿›ç¨‹æ§åˆ¶å—ã€‚ 3. è¿›ç¨‹ä¸ç¨‹åºçš„æ¯”è¾ƒ 1ï¼‰è¿›ç¨‹ä¸ç¨‹åºçš„åŒºåˆ« ç¨‹åºæ˜¯é™æ€çš„ï¼Œè¿›ç¨‹æ˜¯åŠ¨æ€çš„ã€‚ç¨‹åºæ˜¯å­˜å‚¨åœ¨æŸç§ä»‹è´¨ä¸Šçš„äºŒè¿›åˆ¶ä»£ç ï¼Œè¿›ç¨‹å¯¹åº”äº†ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ã€‚ ç¨‹åºæ˜¯æ°¸ä¹…çš„ï¼Œè¿›ç¨‹æ˜¯æš‚æ—¶å­˜åœ¨çš„ã€‚ è¿›ç¨‹å› ç¨‹åºçš„æ‰§è¡Œè€Œè¢«åˆ›å»ºï¼Œå› ç¨‹åºæ‰§è¡Œçš„ç»“æœè€Œè¢«æ’¤å›ï¼Œæœ‰ä¸€ä¸ªç›¸å¯¹çŸ­æš‚çš„ç”Ÿå‘½æœŸã€‚ 2ï¼‰è¿›ç¨‹ä¸ç¨‹åºçš„è”ç³» è¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œï¼Œè¿›ç¨‹æ€»æ˜¯å¯¹åº”è‡³å°‘ä¸€ä¸ªç‰¹å®šçš„ç¨‹åºï¼Œæ‰§è¡Œç¨‹åºçš„ä»£ç ã€‚ ä¸€ä¸ªç¨‹åºå¯ä»¥å¯¹åº”å¤šä¸ªè¿›ç¨‹ã€‚åŒä¸€ä¸ªè¿›ç¨‹å¯ä»¥åœ¨ä¸åŒçš„æ•°æ®é›†åˆä¸Šè¿è¡Œï¼Œå› è€Œæ„æˆè‹¥å¹²ä¸ªä¸åŒçš„è¿›ç¨‹ã€‚å‡ ä¸ªè¿›ç¨‹èƒ½å¹¶å‘åœ°æ‰§è¡Œç›¸åŒçš„ç¨‹åºä»£ç ï¼Œè€ŒåŒä¸€ä¸ªè¿›ç¨‹èƒ½é¡ºåºåœ°æ‰§è¡Œå‡ ä¸ªç¨‹åºã€‚ ä¾‹é¢˜ è¯·è§£é‡Šè¿›ç¨‹çš„æ¦‚å¿µï¼Œå¹¶è¯´æ˜è¿›ç¨‹å’Œç¨‹åºçš„åŒºåˆ«å’Œè”ç³»ã€‚ è¿›ç¨‹æ˜¯å…è®¸å¹¶å‘æ‰§è¡Œçš„ç¨‹åºåœ¨æŸä¸ªæ•°æ®é›†åˆçš„è¿è¡Œè¿‡ç¨‹ï¼›æ˜¯ç”±æ­£æ–‡æ®µã€ç”¨æˆ·æ•°æ®æ®µåŠè¿›ç¨‹æ§åˆ¶å—å…±åŒç»„æˆçš„æ‰§è¡Œç¯å¢ƒã€‚ è¿›ç¨‹å’Œç¨‹åºçš„åŒºåˆ«ï¼š ç¨‹åºæ˜¯é™æ€çš„ï¼Œè¿›ç¨‹æ˜¯åŠ¨æ€ã€‚ ç¨‹åºæ˜¯æ°¸ä¹…çš„ï¼Œè¿›ç¨‹æ˜¯æš‚æ—¶å­˜åœ¨çš„ã€‚ è¿›ç¨‹å’Œç¨‹åºçš„è”ç³»ï¼š è¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œï¼Œæ‰§è¡Œç¨‹åºçš„ä»£ç ã€‚ ä¸€ä¸ªç¨‹åºå¯ä»¥å¯¹åº”å¤šä¸ªè¿›ç¨‹ã€‚ ä¸‰ã€è¿›ç¨‹æ§åˆ¶å— è¿›ç¨‹å®ä½“å­˜åœ¨çš„æ ‡å¿—æ˜¯æ“ä½œç³»ç»Ÿç®¡ç†è¿›ç¨‹æ‰€ä½¿ç”¨çš„æ•°æ®ç»“æ„--è¿›ç¨‹æ§åˆ¶å—ã€‚ 1. ä»€ä¹ˆæ˜¯è¿›ç¨‹æ§åˆ¶å— è¿›ç¨‹æ§åˆ¶å—æ˜¯è¿›ç¨‹å®ä½“çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯æ“ä½œç³»ç»Ÿä¸­æœ€é‡è¦çš„æ•°æ®ç»“æ„ã€‚ æ“ä½œç³»ç»Ÿåœ¨åˆ›å»ºè¿›ç¨‹æ—¶ï¼Œé¦–å…ˆè¦ä¸ºè¿›ç¨‹åˆ›å»ºè¿›ç¨‹æ§åˆ¶å—ï¼Œä¹Ÿå°±æ˜¯ç”Ÿæˆä¸€ä¸ªè¿›ç¨‹æ§åˆ¶å—ç±»å‹çš„å˜é‡ï¼Œä»¥å­˜å‚¨æ‰€åˆ›å»ºè¿›ç¨‹çš„æè¿°ä¿¡æ¯ã€‚æ¯ä¸ªè¿›ç¨‹ç”±å”¯ä¸€çš„è¿›ç¨‹æ§åˆ¶å—ï¼Œè¿›ç¨‹æ§åˆ¶å—æ—¶æ“ä½œç³»ç»Ÿæ„ŸçŸ¥è¿›ç¨‹å­˜åœ¨çš„å”¯ä¸€æ ‡å¿—ã€‚ 2. è¿›ç¨‹æ§åˆ¶å—ä¸­çš„ä¿¡æ¯ ä¸€èˆ¬æ“ä½œç³»ç»Ÿä¸­çš„è¿›ç¨‹æ§åˆ¶å—ä¸­é€šå¸¸åŒ…å«ä¸€ä¸‹ä¿¡æ¯ï¼š 1ï¼‰è¿›ç¨‹æ ‡è¯†ç¬¦ä¿¡æ¯ è¿›ç¨‹æ ‡è¯†ç¬¦ç”¨æˆ·å”¯ä¸€æ ‡è¯†ä¸€ä¸ªè¿›ç¨‹ã€‚ 2ï¼‰å¤„ç†æœºçŠ¶æ€ä¿¡æ¯ 1ï¼‰é€šç”¨å¯„å­˜å™¨ã€‚ç”¨æˆ·ç¨‹åºå¯ä»¥è®¿é—®çš„å¯„å­˜å™¨ï¼Œç”¨äºæš‚å­˜ä¿¡æ¯ã€‚ 2ï¼‰æŒ‡ä»¤è®¡æ•°å™¨ã€‚å…¶ä¸­å­˜æ”¾äº†CPUè¦è®¿é—®çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€‚ 3ï¼‰ç¨‹åºçŠ¶æ€å­—PSWã€‚å…¶ä¸­åŒ…å«çŠ¶æ€ä¿¡æ¯ï¼Œå¦‚æ¡ä»¶ç ã€æ‰§è¡Œæ–¹å¼å’Œä¸­æ–­å±è”½æ ‡å¿—ç­‰ã€‚ 4ï¼‰ç”¨æˆ·æ ˆæŒ‡é’ˆã€‚æ¯ä¸ªç”¨æˆ·è¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹ç›¸å…³çš„ç³»ç»Ÿæ ˆï¼Œç”¨äºå­˜æ”¾è¿‡ç¨‹å’Œç³»ç»Ÿè°ƒç”¨å‚æ•°åŠè°ƒç”¨åœ°å€ï¼Œæ ˆæŒ‡é’ˆæŒ‡å‘è¯¥æ ˆçš„æ ˆé¡¶ã€‚ 3ï¼‰è¿›ç¨‹è°ƒåº¦ä¿¡æ¯ è¿›ç¨‹è°ƒåº¦ä¿¡æ¯åŒ…æ‹¬è¿›ç¨‹çŠ¶æ€ä¿¡æ¯ã€è¿›ç¨‹ä¼˜å…ˆçº§å’Œè¿›ç¨‹è°ƒåº¦æ‰€éœ€çš„å…¶ä»–ä¿¡æ¯ã€‚ 4ï¼‰è¿›ç¨‹æ§åˆ¶ä¿¡æ¯ è¿›ç¨‹æ§åˆ¶ä¿¡æ¯åŒ…æ‹¬ç¨‹åºå’Œæ•°æ®çš„åœ°å€ã€è¿›ç¨‹åŒæ­¥å’Œé€šä¿¡æœºåˆ¶ã€èµ„æºæ¸…å•ï¼Œä»¥åŠé“¾æ¥æŒ‡é’ˆã€‚ æœ¬ä¹¦ä¸­çš„æ•°æ®ç»“æ„å°±æ˜¯ä¸ºç¨‹åºçš„éœ€è¦è€Œå®šä¹‰çš„ç®€å•ç±»å‹æˆ–å¤æ‚ç±»å‹çš„å˜é‡ï¼Œå˜é‡ç”¨æ¥å­˜æ”¾éšç€ç¨‹åºçš„æ‰§è¡Œä¸æ–­å‘ç”Ÿå˜åŒ–çš„æ•°æ®ã€‚è¿›ç¨‹æ§åˆ¶å—å°±æ˜¯å¤æ‚ç±»å‹çš„å˜é‡ã€‚ å››ã€è¿›ç¨‹çš„çŠ¶æ€ è¿›ç¨‹æ§åˆ¶å—çš„çŠ¶æ€å­—çŸ­æè¿°äº†è¿›ç¨‹å½“å‰æ‰€å¤„çš„çŠ¶æ€ã€‚ 1. è¿›ç¨‹çš„3ä¸­åŸºæœ¬çŠ¶æ€ 1ï¼‰å°±ç»ªæ€ å°±ç»ªæ€æ—¶è¿›ç¨‹ä¸€æ—¦è·å¾—CPUå°±å¯ä»¥æŠ•å…¥è¿è¡Œçš„çŠ¶æ€ã€‚åœ¨å¤šä»»åŠ¡ç³»ç»Ÿä¸­ï¼Œå¯ä»¥æœ‰å¤šä¸ªå¤„äºå°±ç»ªæ€çš„è¿›ç¨‹ï¼Œè¿™äº›è¿›ç¨‹è¢«ç»„æˆæˆä¸€ä¸ªæˆ–å¤šä¸ªå°±ç»ªè¿›ç¨‹é˜Ÿåˆ—ã€‚ 2ï¼‰æ‰§è¡Œæ€ æ‰§è¡Œæ€æ˜¯è¿›ç¨‹è·å¾—CPUæ­£åœ¨è¿è¡Œçš„çŠ¶æ€ã€‚ 3ï¼‰é˜»å¡æ€ é˜»å¡æ€æ˜¯è¿›ç¨‹ç”±äºç­‰å¾…èµ„æºæˆ–æŸä¸ªäº‹ä»¶çš„å‘ç”Ÿè€Œæš‚åœæ‰§è¡Œçš„çŠ¶æ€ï¼Œç³»ç»Ÿä¸ä¼šä¸ºé˜»å¡æ€çš„è¿›ç¨‹åˆ†é…CPUã€‚é˜»å¡æ€è¿›ç¨‹åœ¨è·å¾—å…¶ç­‰å¾…çš„èµ„æºæˆ–å…¶ç­‰å¾…çš„äº‹ä»¶å‘ç”Ÿä¹‹åï¼Œè½¬å˜ä¸ºå°±ç»ªçŠ¶æ€ã€‚ 2. è¿›ç¨‹çŠ¶æ€çš„è½¬æ¢ æ–°åˆ›å»ºè¿›ç¨‹çš„çŠ¶æ€ä¸€èˆ¬è¢«è®¾ç½®ä¸ºå°±ç»ªæ€ï¼Œå½“æ“ä½œç³»ç»Ÿä¸ºå¤„äºå°±ç»ªæ€çš„è¿›ç¨‹åˆ†é…CPUæ—¶ï¼Œè¿›ç¨‹å¼€å§‹åœ¨CPUä¸Šè¿è¡Œï¼Œè¿›ç¨‹çš„çŠ¶æ€ç”±å°±ç»ªæ€å˜ä¸ºæ‰§è¡Œæ€ã€‚ åœ¨å¤šä»»åŠ¡ç³»ç»Ÿä¸­ï¼ŒCPUè¢«å¤šä¸ªè¿›ç¨‹å…±äº«çš„èµ„æºï¼Œæ“ä½œç³»ç»Ÿé€šå¸¸ä¼šä¸ºæ™®é€šè¿›ç¨‹è§„å®šä¸€ä¸ªåœ¨CPUä¸Šè¿ç»­è¿è¡Œçš„æ—¶é—´é•¿åº¦ï¼Œç§°è¿™ä¸ªæ—¶é—´é•¿åº¦ä¸ºæ—¶é—´ç‰‡ã€‚å½“è¿›ç¨‹åœ¨CPUä¸Šè¿è¡Œçš„æ—¶é—´ç‰‡é•¿åº¦é€’å‡ä¸º0æ—¶ï¼Œç³»ç»ŸæŠŠCPUåˆ†é…ç»™å…¶ä»–å°±ç»ªæ€è¿›ç¨‹ã€‚å¦‚æœè¿›ç¨‹åœ¨CPUä¸Šè¿è¡Œçš„æ—¶é—´é€’å‡ä¸º0ï¼Œç³»ç»Ÿå°†è¯¥è¿›ç¨‹çš„çŠ¶æ€ç”±æ‰§è¡Œæ€å˜ä¸ºå°±ç»ªæ€ã€‚ å¦‚æœæ‰§è¡Œæ€è¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å› ä¸ºç”³è¯·æŸç§èµ„æºæˆ–ç­‰å¾…æŸæ—¶é—´çš„å‘ç”Ÿè€Œä¸å®œç»§ç»­å ç”¨CPUï¼Œç³»ç»Ÿå°†æŠŠè¯¥è¿›ç¨‹çš„çŠ¶æ€æ”¹å˜ä¸ºé˜»å¡æ€ï¼Œå¹¶æš‚åœè¯¥è¿›ç¨‹çš„æ‰§è¡Œï¼Œå°†CPUåˆ†é…ç»™å°±ç»ªæ€è¿›ç¨‹ã€‚é˜»å¡æ€è¿›ç¨‹åœ¨å…¶ç­‰å¾…çš„æ—¶é—´å‘ç”Ÿæˆ–ç”³è¯·åˆ°æ‰€éœ€èµ„æºåï¼Œç³»ç»Ÿå°†å…¶çŠ¶æ€è½¬å˜ä¸ºå°±ç»ªæ€ã€‚ äº”ã€è¿›ç¨‹çš„ç»„ç»‡ åœ¨æ“ä½œç³»ç»Ÿä¸­ä»»æ„æ—¶åˆ»éƒ½å¯èƒ½å­˜åœ¨å¾ˆå¤šè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹å¯¹åº”ä¸€ä¸ªè¿›ç¨‹æ§åˆ¶å—ï¼Œæ“ä½œç³»ç»Ÿç»„ç»‡å’Œç®¡ç†è¿›ç¨‹æ˜¯é€šè¿‡ç®¡ç†å’Œç»„ç»‡è¿›ç¨‹æ§åˆ¶å—æ¥å®ç°çš„ã€‚ å®é™…ä¸Šå¯¹è¿›ç¨‹çš„ç»„ç»‡æ˜¯é€šè¿‡å®šä¹‰æ•°æ®ç»“æ„æ¥å®ç°çš„ã€‚ 1. é“¾æ¥æ–¹å¼ æŠŠç³»ç»Ÿä¸­å…·æœ‰ç›¸åŒçŠ¶æ€çš„è¿›ç¨‹çš„è¿›ç¨‹æ§åˆ¶å—ï¼ˆPCBï¼‰ç”¨å…¶ä¸­çš„é“¾æ¥å­—é“¾æ¥æˆä¸€ä¸ªé˜Ÿåˆ—ã€‚ 2. ç´¢å¼•æ–¹å¼ ç³»ç»Ÿæ ¹æ®æ‰€æœ‰è¿›ç¨‹çš„çŠ¶æ€ï¼Œå»ºç«‹å‡ å¼ ç´¢å¼•è¡¨ï¼Œç´¢å¼•è¡¨çš„æ¯ä¸€ä¸ªè¡¨é¡¹æŒ‡å‘ä¸€ä¸ªPCBçš„ç‰©ç†å—ã€‚ 3. è¿›ç¨‹é˜Ÿåˆ— å½“ç³»ç»Ÿä¸­æœ‰å¾ˆå¤šè¿›ç¨‹æ—¶ï¼Œå¯ä»¥æŠŠè¿›ç¨‹æ§åˆ¶å—ç”¨é˜Ÿåˆ—ç»„ç»‡èµ·æ¥ï¼Œå½¢æˆè¿›ç¨‹é˜Ÿåˆ—ã€‚æŠŠå…·æœ‰ç›¸åŒçŠ¶æ€çš„è¿›ç¨‹æ”¾åœ¨åŒä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå…·æœ‰ä¸åŒçŠ¶æ€çš„è¿›ç¨‹å°±å½¢æˆäº†ä¸åŒçš„è¿›ç¨‹é˜Ÿåˆ—ã€‚ å¤„äºå°±ç»ªæ€çš„è¿›ç¨‹æ„æˆçš„è¿›ç¨‹é˜Ÿåˆ—ç§°ä¸ºå°±ç»ªé˜Ÿåˆ—ï¼Œå¤„äºé˜»å¡æ€çš„è¿›ç¨‹æ„æˆçš„è¿›ç¨‹é˜Ÿåˆ—ç§°ä¸ºé˜»å¡é˜Ÿåˆ—ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äºŒç« _è¿›ç¨‹ç®¡ç†/ç¬¬äºŒèŠ‚_è¿›ç¨‹çš„æ§åˆ¶.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äºŒç« _è¿›ç¨‹ç®¡ç†/ç¬¬äºŒèŠ‚_è¿›ç¨‹çš„æ§åˆ¶.html","title":"ç¬¬äºŒèŠ‚ è¿›ç¨‹çš„æ§åˆ¶","keywords":"","body":"ç¬¬äºŒèŠ‚ è¿›ç¨‹çš„æ§åˆ¶ ä¸€ã€è¿›ç¨‹çš„åˆ›å»º åˆ›å»ºè¿›ç¨‹åŒ…æ‹¬ä¸ºä¸ºè¿›ç¨‹åˆ†é…å¿…è¦çš„èµ„æºï¼Œå»ºç«‹æ“ä½œç³»ç»Ÿç”¨äºç®¡ç†è¿›ç¨‹çš„æ•°æ®ç»“æ„ï¼ˆå¦‚è¿›ç¨‹æ§åˆ¶å—ï¼‰ç­‰æ“ä½œã€‚é€šå¸¸åœ¨ä¸‹åˆ—æƒ…å†µä¸‹éœ€è¦åˆ›å»ºæ–°è¿›ç¨‹ã€‚ 1ï¼‰ç”¨æˆ·ç™»å½•ã€‚ 2ï¼‰ä½œä¸šè°ƒåº¦ã€‚ 3ï¼‰æä¾›æœåŠ¡ã€‚ 4ï¼‰åº”ç”¨è¯·æ±‚ã€‚ åœ¨Linuxç³»ç»Ÿä¸­ï¼Œé™¤äº†0å·ï¼ˆswapper è¿›ç¨‹ï¼‰è¿›ç¨‹å¤–çš„å…¶ä»–è¿›ç¨‹éƒ½æ˜¯ç”±çˆ¶è¿›ç¨‹åˆ›å»ºçš„ã€‚åœ¨æ“ä½œç³»ç»Ÿå¯åŠ¨å¹¶æ­£å¸¸å·¥ä½œåï¼Œç³»ç»Ÿä¸­çš„å·²æœ‰è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­éƒ½å¯ä»¥é€šè¿‡ç³»ç»Ÿè°ƒç”¨åˆ›å»ºæ–°è¿›ç¨‹ã€‚è¢«åˆ›å»ºçš„æ–°è¿›ç¨‹æˆä¸ºåˆ›å»ºè¯¥æ–°è¿›ç¨‹çš„è¿›ç¨‹çš„å­è¿›ç¨‹ï¼Œåˆ›å»ºè€…è¿›ç¨‹å’Œè¢«åˆ›å»ºæ–°è¿›ç¨‹æˆä¸ºçˆ¶å­è¿›ç¨‹ã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥åˆ›å»ºå¤šä¸ªå­è¿›ç¨‹ï¼Œç”±åŒä¸€ä¸ªè¿›ç¨‹åˆ›å»ºçš„å¤šä¸ªå­è¿›ç¨‹ä¹‹é—´çš„å…³ç³»æˆä¸ºå…„å¼Ÿè¿›ç¨‹ã€‚ åœ¨ä¸€ä¸ªè¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹æ—¶ï¼Œå­è¿›ç¨‹å¯ä»¥ä»æ“ä½œç³»ç»Ÿå“ªé‡Œç›´æ¥è·å¾—èµ„æºï¼Œä¹Ÿå¯èƒ½ä»çˆ¶è¿›ç¨‹èµ„æºå­é›†é‚£é‡Œè·å¾—èµ„æºã€‚ å½“æ–°è¿›ç¨‹è¢«åˆ›å»ºæ—¶ï¼Œæœ‰ä¸¤ç§æ‰§è¡Œçš„å¯èƒ½ã€‚ 1ï¼‰çˆ¶è¿›ç¨‹ä¸å­è¿›ç¨‹å¹¶å‘æ‰§è¡Œã€‚ 2ï¼‰çˆ¶è¿›ç¨‹ç­‰å¾…ï¼Œç›´åˆ°æŸä¸ªæˆ–å…¨éƒ¨å­è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ã€‚ æ–°è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¹Ÿæœ‰ä¸¤ç§å¯èƒ½ã€‚ 1ï¼‰å­è¿›ç¨‹å…±äº«çˆ¶è¿›ç¨‹çš„åœ°å€ç©ºé—´ã€‚ 2ï¼‰å­è¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ã€‚ è°ƒç”¨åˆ›å»ºæ–°è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨æ¥åˆ›å»ºè¿›ç¨‹çš„ä¸€èˆ¬æ­¥éª¤å¦‚ä¸‹ã€‚ 1ï¼‰ç”³è¯·ç©ºç™½PCBã€‚ 2ï¼‰ä¸ºæ–°è¿›ç¨‹åˆ†é…èµ„æºã€‚ 3ï¼‰åˆå§‹åŒ–è¿›ç¨‹æ§åˆ¶å—ã€‚ 4ï¼‰å°†æ–°è¿›ç¨‹æ’å…¥å°±ç»ªé˜Ÿåˆ—ã€‚ äºŒã€è¿›ç¨‹çš„é˜»å¡ æ“ä½œç³»ç»Ÿåœ¨ä¸‹åˆ—æƒ…å†µä¸‹å¯èƒ½è¿›è¡Œè¿›ç¨‹çš„é˜»å¡å’Œå”¤é†’æ“ä½œã€‚ 1ï¼‰è¯·æ±‚ç³»ç»ŸæœåŠ¡ã€‚ 2ï¼‰å¯åŠ¨æŸç§æ“ä½œã€‚ 3ï¼‰æ–°æ•°æ®å°šæœªåˆ°è¾¾ã€‚ 4ï¼‰æ— å¿ƒå·¥ä½œå¯åšã€‚ å®Œæˆè¿›ç¨‹é˜»å¡çš„ç®€åŒ–è¿‡ç¨‹å¦‚ä¸‹ã€‚ 1ï¼‰å°†è¿›ç¨‹çŠ¶æ€æ”¹ä¸ºé˜»å¡æ€ã€‚ 2ï¼‰å°†è¿›ç¨‹æ’å…¥ç›¸åº”çš„é˜»å¡é˜Ÿåˆ—ã€‚ 3ï¼‰è½¬è¿›ç¨‹è°ƒåº¦ç¨‹åºï¼Œä»å°±ç»ªè¿›ç¨‹ä¸­é€‰æ‹©è¿›ç¨‹ä¸ºå…¶åˆ†é…CPUã€‚ å¤„äºæ‰§è¡Œæ€çš„è¿›ç¨‹è¢«é˜»å¡åï¼ŒCPUç©ºé—²ï¼Œéœ€è¦æ‰§è¡Œè¿›ç¨‹è°ƒåº¦ç¨‹åºï¼Œä»å°±ç»ªè¿›ç¨‹ä¸­ä¸ºCPUé€‰æ‹©ä¸€ä¸ªè¿›ç¨‹è¿è¡Œã€‚ ä¸‰ã€è¿›ç¨‹çš„å”¤é†’ æ“ä½œç³»ç»Ÿé€šè¿‡ä¸‹åˆ—è¿‡ç¨‹å°†é˜»å¡æ€è¿›ç¨‹å”¤é†’ï¼Œä½¿å…¶å˜æˆå°±ç»ªæ€è¿›ç¨‹ã€‚è¿›ç¨‹å”¤é†’çš„è¿‡ç¨‹å¦‚ä¸‹ã€‚ 1ï¼‰å°†è¿›ç¨‹ä»é˜»å¡é˜Ÿåˆ—ä¸­ç§»é™¤ã€‚ 2ï¼‰å°†è¿›ç¨‹çŠ¶æ€ç”±é˜»å¡æ€æ”¹ä¸ºå°±ç»ªæ€ã€‚ 3ï¼‰å°†è¿›ç¨‹æ’å…¥å°±ç»ªé˜Ÿåˆ—ã€‚ å››ã€è¿›ç¨‹çš„ç»ˆæ­¢ è¿›ç¨‹çš„ç»ˆæ­¢ä¹Ÿç§°ä¸ºè¿›ç¨‹çš„æ’¤é”€ï¼Œåœ¨ä¸‹åˆ—æƒ…å†µä¸‹ï¼Œè¿›ç¨‹ä¼šè¢«ç»ˆæ­¢ã€‚ 1ï¼‰å½“è¿›ç¨‹æ­£å¸¸æ‰§è¡Œå®Œæ¯•ï¼Œè°ƒç”¨ç»ˆæ­¢è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ï¼Œè¯·æ±‚æ“ä½œç³»ç»Ÿåˆ é™¤è¯¥è¿›ç¨‹ã€‚ 2ï¼‰ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨é€‚å½“çš„ç³»ç»Ÿè°ƒç”¨ï¼Œç»ˆæ­¢å¦å¤–ä¸€ä¸ªè¿›ç¨‹ã€‚ çˆ¶è¿›ç¨‹ç»ˆæ­¢å…¶å­è¿›ç¨‹çš„åŸå› å¯èƒ½æœ‰ä»¥ä¸‹å‡ ä¸ªã€‚ 1ï¼‰å­è¿›ç¨‹ä½¿ç”¨äº†è¶…è¿‡å®ƒæ‰€åˆ†é…åˆ°çš„ä¸€äº›èµ„æºã€‚ 2ï¼‰åˆ†é…ç»™å­è¿›ç¨‹çš„ä»»åŠ¡ä¸å†éœ€è¦ã€‚ 3ï¼‰çˆ¶è¿›ç¨‹é€€å‡ºï¼Œå¦‚æœçˆ¶è¿›ç¨‹ç»ˆæ­¢ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿä¸å…è®¸å­è¿›ç¨‹ç»§ç»­ã€‚ æ“ä½œç³»ç»Ÿé€šè¿‡ç³»ç»Ÿè°ƒç”¨ç»ˆæ­¢è¿›ç¨‹çš„ä¸€èˆ¬è¿‡ç¨‹å¦‚ä¸‹ã€‚ 1ï¼‰ä»è¿›ç¨‹PCBä¸­è¯»å–è¿›ç¨‹çŠ¶æ€ã€‚ 2ï¼‰è‹¥è¿›ç¨‹æ­£åœ¨æ‰§è¡Œï¼Œåˆ™ç»ˆæ­¢è¿›ç¨‹çš„æ‰§è¡Œã€‚ 3ï¼‰è‹¥è¿›ç¨‹æœ‰å­å­™è¿›ç¨‹ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éœ€è¦ç»ˆæ­¢å­å­™è¿›ç¨‹ã€‚ 4ï¼‰é‡Šæ”¾èµ„æºã€‚ 5ï¼‰å°†ç»ˆæ­¢è¿›ç¨‹çš„PCBç§»å‡ºã€‚ äº”ã€æ“ä½œç³»ç»Ÿçš„å¯åŠ¨å’Œç³»ç»Ÿä¸­è¿›ç¨‹çš„å‡ºç° å½“æ‰“å¼€è®¡ç®—æœºç”µæºåï¼Œè®¡ç®—æœºä¼šå…ˆè¿›è¡ŒåŠ ç”µè‡ªæ£€ï¼Œç„¶åå¯»æ‰¾å¯åŠ¨ç›˜ã€‚å¦‚æœé€‰æ‹©ç¡¬ç›˜å¯åŠ¨ï¼Œè®¡ç®—æœºä¼šæ£€æŸ¥ç¡¬ç›˜çš„0æŸ±é¢0ç£é“1æ‰‡åŒºã€‚ å½“ç¡¬ç›˜è¢«åˆ’åˆ†ä¸ºå¤šä¸ªåˆ†åŒºï¼ŒåŒæ—¶å®‰è£…äº†å¤šä¸ªæ“ä½œç³»ç»Ÿï¼Œæ¯ä¸ªåˆ†åŒºéƒ½æœ‰è‡ªå·±çš„å¼•å¯¼æ‰‡åŒºï¼Œä½†æ•´ä¸ªç¡¬ç›˜æœ‰ä¸€ä¸ªä¸»å¼•å¯¼æ‰‡åŒºï¼Œä¸»å¼•å¯¼æ‰‡åŒºå°±æ˜¯ç¡¬ç›˜çš„0æŸ±é¢0ç£é“1æ‰‡åŒºã€‚é€šè¿‡æ‰§è¡Œä¸»å¼•å¯¼æ‰‡åŒºçš„ä»£ç ï¼Œåˆ¤æ–­å½“å‰è¢«æ¿€æ´»çš„åˆ†åŒºï¼Œç„¶ååŠ è½½è¢«æ¿€æ´»åˆ†åŒºçš„å¼•å¯¼æ‰‡åŒºï¼Œé€šè¿‡è¯¥å¼•å¯¼æ‰‡åŒºä»£ç çš„æ‰§è¡ŒåŠ è½½è¯¥æ¿€æ´»åˆ†åŒºçš„æ“ä½œç³»ç»Ÿç³»ç»Ÿã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äºŒç« _è¿›ç¨‹ç®¡ç†/ç¬¬ä¸‰èŠ‚_æ“ä½œç³»ç»Ÿå†…æ ¸.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äºŒç« _è¿›ç¨‹ç®¡ç†/ç¬¬ä¸‰èŠ‚_æ“ä½œç³»ç»Ÿå†…æ ¸.html","title":"ç¬¬ä¸‰èŠ‚ æ“ä½œç³»ç»Ÿå†…æ ¸","keywords":"","body":"ç¬¬ä¸‰èŠ‚ æ“ä½œç³»ç»Ÿå†…æ ¸ æ“¦æ“ä½œç³»ç»Ÿå†…æ ¸æ˜¯è®¡ç®—æœºç¡¬ä»¶çš„ç¬¬ä¸€æ¬¡æ‰©å……ï¼Œå†…æ ¸æ‰§è¡Œæ“ä½œç³»ç»Ÿä¸ç¡¬ä»¶å…³ç³»å¯†åˆ‡ï¼Œæ‰§è¡Œé¢‘ç‡é«˜çš„æ¨¡å—ï¼Œå¸¸é©»å†…å­˜ã€‚ 1. æ”¯æ’‘åŠŸèƒ½ æ”¯æ’‘åŠŸèƒ½åŒ…æ‹¬ä¸­æ–­å¤„ç†ã€æ—¶é’Ÿç®¡ç†å’ŒåŸè¯­æ“ä½œã€‚åŸè¯­æ“ä½œä¹Ÿç§°åŸå­æ“ä½œï¼Œæ˜¯ä¸€ç»„åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸èƒ½è¢«ä¸­æ–­çš„æ“ä½œã€‚ 2. èµ„æºç®¡ç†åŠŸèƒ½ èµ„æºç®¡ç†åŒ…æ‹¬è¿›ç¨‹ç®¡ç†ã€å­˜å‚¨å™¨ç®¡ç†å’Œè®¾å¤‡ç®¡ç†ã€‚ ä¸€ã€ä¸­æ–­ 1. ä»€ä¹ˆæ˜¯ä¸­æ–­ ä¸­æ–­æ˜¯æ”¹å˜è®¡ç®—æœºæ‰§è¡ŒæŒ‡ä»¤é¡ºåºçš„ä¸€ç§äº‹ä»¶ï¼Œè¿™æ ·çš„äº‹ä»¶ä¸CPUèŠ¯ç‰‡å†…å¤–éƒ¨ç¡¬ä»¶ç”µè·¯äº§ç”Ÿçš„ç”µä¿¡å·ç›¸å¯¹åº”ã€‚ è®¡ç®—æœºåœ¨æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œå½“å‡ºç°ä¸­æ–­æ—¶ï¼Œè®¡ç®—æœºåœæ­¢ç°è¡Œç¨‹åºçš„è¿è¡Œï¼Œè½¬å‘å¯¹è¿™äº›ä¸­æ–­äº‹ä»¶çš„å¤„ç†ï¼Œå¤„ç†ç»“æŸåå†è¿”å›åˆ°ç°è¡Œç¨‹åºçš„é—´æ–­å¤„ã€‚ 2. ä¸ºä»€ä¹ˆè¦ä¸­æ–­ å¼•å…¥ä¸­æ–­æœºåˆ¶åï¼Œä½¿CPUå¯ä»¥ä¸å…¶ä»–è®¾å¤‡å¹¶è¡Œå·¥ä½œï¼Œèƒ½æœ‰æ•ˆå¾—æé«˜CPUçš„åˆ©ç”¨ç‡ï¼Œæ”¹å–„ç³»ç»Ÿæ€§èƒ½ï¼Œæ”¯æŒç³»ç»Ÿçš„å¼‚æ­¥æ€§ã€‚ 3. ä¸­æ–­çš„ç±»å‹ ä¸­æ–­åˆ†ä¸ºåŒæ­¥ä¸­æ–­ï¼ˆä¹Ÿç§°å†…éƒ¨ä¸­æ–­æˆ–å¼‚å¸¸ï¼‰å’Œå¼‚æ­¥ä¸­æ–­ï¼ˆä¹Ÿç§°å¤–éƒ¨ä¸­æ–­ï¼‰ä¸¤ç§ã€‚ 1ï¼‰åŒæ­¥ä¸­æ–­ï¼ˆå†…éƒ¨ä¸­æ–­æˆ–å¼‚å¸¸ï¼‰ åŒæ­¥ä¸­æ–­æ˜¯æŒ‡æŒ‡ä»¤æ‰§è¡Œæ—¶ç”±CPUæ§åˆ¶å•å…ƒäº§ç”Ÿçš„ï¼Œä¹‹æ‰€ä»¥ç§°ä¸ºåŒæ­¥ï¼Œæ˜¯å› ä¸ºåªæœ‰åœ¨ä¸€æ¡æŒ‡ä»¤ç»ˆæ­¢æ‰§è¡Œï¼ˆæ³¨æ„ï¼šæ­¤æ—¶æŒ‡ä»¤ä¸ä¸€å®šæ‰§è¡Œå®Œæ¯•ï¼‰åCPUæ‰ä¼šå‘å‡ºä¸­æ–­ï¼Œå¦‚é™¤æ³•å‡ºé”™ã€è°ƒè¯•ã€æº¢å‡ºå’Œæµ®ç‚¹å‡ºé”™ç­‰ã€‚ 2ï¼‰å¼‚æ­¥ä¸­æ–­ï¼ˆå¤–éƒ¨ä¸­æ–­ï¼‰ å¼‚æ­¥ä¸­æ–­æ˜¯ç”±å…¶ä»–ç¡¬ä»¶è®¾å¤‡éšæœºäº§ç”Ÿçš„ã€‚ å¤–éƒ¨ä¸­æ–­åˆå¯åˆ†ä¸ºå¤–éƒ¨å¯å±è”½ä¸­æ–­å’Œå¤–éƒ¨ä¸å¯å±è”½ä¸­æ–­ã€‚ 1ï¼‰å¤–éƒ¨å¯å±è”½ä¸­æ–­ã€‚å¤–éƒ¨å¯å±è”½ä¸­æ–­æ˜¯ç”±I/Oè®¾å¤‡äº§ç”Ÿçš„ä¸­æ–­ï¼Œæœ‰ä¸¤ç§æ–¹å¼å¯å±è”½ä¸­æ–­ã€‚ ä¸€æ˜¯å¦‚åœ¨ Intel 80x86 çš„CPUä¸Šï¼ŒæŠŠ EFLAGS å¯„å­˜å™¨çš„ IF æ ‡å¿—ç½®0ï¼Œè¡¨ç¤ºå…³ä¸­æ–­ã€‚æ­¤æ—¶CPUå¿½ç•¥æ‰€æœ‰çš„å¯å±è”½ä¸­æ–­ã€‚ äºŒæ˜¯å¯ä»¥å¯¹å¯ç¼–ç¨‹ä¸­æ–­æ§åˆ¶å™¨ï¼ˆProgrammable Interrupt Controllerï¼ŒPICï¼‰ç¼–ç¨‹æ¥ç¦æ­¢ä¸­æ–­è¯·æ±‚ï¼ˆInterrupt Requestï¼ŒIRQï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥å‘Šè¯‰PICåœæ­¢å¯¹ç»™å®šçš„IRQçº¿å‘å¸ƒä¸­æ–­ã€‚ 2ï¼‰å¤–éƒ¨ä¸å¯å±è”½ä¸­æ–­ã€‚å¤–éƒ¨ä¸å¯å±è”½ä¸­æ–­æ˜¯ç”±ç´§æ€¥äº‹ä»¶å¼•èµ·çš„ä¸­æ–­ï¼Œå¦‚ç¡¬ä»¶æ•…éšœã€‚ 4. å¼•èµ·ä¸­æ–­çš„åŸå›  1ï¼‰äººä¸ºè®¾ç½®ä¸­æ–­ã€‚åœ¨ç¨‹åºä¸­äººä¸ºè®¾ç½®ä¸­æ–­ã€‚ 2ï¼‰ç¨‹åºæ€§äº‹æ•…ã€‚ä¾‹å¦‚ï¼Œè®¡ç®—æœºå‡ºç°é™¤æ•°ä¸º0. 3ï¼‰ç¡¬ä»¶æ•…éšœã€‚æ’ä»¶æ¥è§¦ä¸è‰¯ã€ç”µæºæ‰ç”µç­‰ã€‚ 4ï¼‰I/Oè®¾å¤‡ã€‚I/Oè®¾å¤‡è¢«å¯åŠ¨ä»¥åï¼Œä¸€æ—¦å…¶å‡†å¤‡å°±ç»ªæˆ–å®Œæˆä¸€æ¬¡è¾“å…¥/è¾“å‡ºï¼Œä¾¿å‘CPUå‘å‡ºä¸­æ–­è¯·æ±‚ã€‚ 5ï¼‰å¤–éƒ¨äº‹ä»¶ã€‚å¦‚ç”¨æˆ·é€šè¿‡é”®ç›˜å’Œé¼ æ ‡æ¥ä¸­æ–­ç°è¡Œç¨‹åºã€‚ 5. ä¸­æ–­å“åº” 1ï¼‰å“åº”ä¸­æ–­çš„æ¡ä»¶ å¯¹äºå¯å±è”½ä¸­æ–­ï¼Œå¼€ä¸­æ–­æ˜¯å“åº”ä¸­æ–­çš„å‰æã€‚ä¾‹å¦‚ï¼Œåœ¨ Intel 80x86 CPU ä¸Šï¼Œå½“EFLAGSå¯„å­˜å™¨çš„IFæ ‡å¿—ä¸º1è¡¨ç¤ºå¼€ä¸­æ–­ã€‚ 2ï¼‰å“åº”ä¸­æ–­çš„æ—¶æœº å¯¹äºå¤–éƒ¨ä¸­æ–­ï¼ŒCPUæ¯æ‰§è¡Œå®Œä¸€æ¡æŒ‡ä»¤éƒ½ä¼šæ£€æµ‹æ˜¯å¦æœ‰å¤–éƒ¨ä¸­æ–­ä¿¡å·çš„åˆ°æ¥ã€‚è‹¥æœ‰ï¼Œåˆ™è½¬ä¸­æ–­å¤„ç†è¿‡ç¨‹ã€‚ 6. å•é‡ä¸­æ–­çš„å¤„ç†è¿‡ç¨‹ CPUåœ¨åå¤æ‰§è¡ŒæŒ‡ä»¤çš„è¿‡ç¨‹ä¸­ï¼Œæ¯æ‰§è¡Œå®Œä¸€æ¡æŒ‡ä»¤ï¼Œéƒ½ä¼šæ£€æµ‹æ˜¯å¦æœ‰å¤–éƒ¨ä¸­æ–­ä¿¡å·çš„åˆ°æ¥ã€‚å¦‚æœæ£€æµ‹åˆ°æœ‰ä¸­æ–­ä¿¡å·ï¼Œåˆ™è½¬ä¸­æ–­å¤„ç†è¿‡ç¨‹ã€‚ 1ï¼‰ç³»ç»Ÿå…³é—­ä¸­æ–­ï¼Œä¿æŠ¤æ–­ç‚¹ï¼ŒæŠŠå½“å‰è¦æ‰§è¡Œçš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œä»¥ä¾¿ä¸­æ–­è¿”å›æ—¶ï¼Œèƒ½æŠŠè¿™ä¸ªåœ°å€æ¢å¤åˆ°ç¨‹åºè®¡æ•°å™¨PCä¸­ï¼Œä½¿è¢«ä¸­æ–­çš„ç¨‹åºä»æ–­ç‚¹å¤„å¼€å§‹ç»§ç»­æ‰§è¡Œã€‚ 2ï¼‰è½¬ä¸­æ–­å¤„ç†ç¨‹åºã€‚åœ¨ä¸­æ–­å¤„ç†ç¨‹åºä¸­å®Œæˆä¿æŠ¤ç°åœºçš„å·¥ä½œï¼Œå°±æ˜¯æŠŠç›¸å…³çš„ç¡¬ä»¶ä¸Šä¸‹æ–‡ä¿¡æ¯ä¿å­˜åˆ°å†…å­˜ä¸­ã€‚ç¡¬ä»¶ä¸Šä¸‹æ–‡å°±æ˜¯ä¸­æ–­è¿”å›æ¢å¤è¢«ä¸­æ–­ç¨‹åºçš„æ‰§è¡Œæ—¶ï¼Œéœ€è¦å†™å›CPUå¯„å­˜å™¨çš„å€¼ã€‚ 3ï¼‰ä¿æŠ¤ç°åœºåï¼Œè¦æ ¹æ®ä¸­æ–­å‘é‡åˆ°ä¸­æ–­å‘é‡è¡¨ä¸­ï¼ˆåœ¨ Linux ä¸­æ˜¯åˆ°ä¸­æ–­æè¿°ç¬¦è¡¨ä¸­ï¼‰æ‰¾åˆ°ä¸ä¸­æ–­å¤„ç†å­ä¾‹ç¨‹å…¥å£åœ°å€ç›¸å…³çš„ä¿¡æ¯ï¼Œç”±è¿™äº›ä¿¡æ¯å¾—åˆ°ä¸­æ–­å¤„ç†å­ä¾‹ç¨‹çš„å…¥å£åœ°å€ï¼Œä»¥æ‰§è¡Œä¸­æ–­å¤„ç†å­ä¾‹ç¨‹ï¼Œå®Œæˆæœ¬æ¬¡ä¸­æ–­å¤„ç†çš„ç‰¹æ®Šå¤„ç†å·¥ä½œã€‚ 4ï¼‰æœ€åï¼Œæ¢å¤ç°åœºï¼Œå¼€ä¸­æ–­ï¼ŒCPUè¿”å›æ–­ç‚¹å¤„ç»§ç»­æ‰§è¡Œè¢«ä¸­æ–­çš„ç¨‹åºã€‚ 7. å¦‚ä½•æ‰¾åˆ°ä¸­æ–­æœåŠ¡å­ç¨‹åº 1ï¼‰ä¸­æ–­å‘é‡ã€‚ä¸­æ–­å‘é‡æ˜¯å¯¹ä¸åŒä¸­æ–­æºåˆ°æ¥çš„ä¿¡å·ç¼–å·ï¼Œè¯¥ç¼–å·æ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ï¼ˆ0ï½255ï¼‰ï¼Œæˆä¸ºä¸­æ–­å‘é‡ã€‚ 2ï¼‰ä¸­æ–­æè¿°ç¬¦è¡¨ï¼ˆInterrupt Descriptor Tableï¼ŒIDTï¼‰æ˜¯ä¸€ä¸ªç³»ç»Ÿè¡¨ï¼Œæ¯ä¸€ä¸ªä¸­æ–­æˆ–å¼‚å¸¸ä¸å‘é‡ç›¸è”ç³»ã€‚æ¯ä¸ªå‘é‡åœ¨è¡¨ä¸­æœ‰å”¯ä¸€å¯¹åº”çš„è¡¨é¡¹ï¼Œå…¶ä¸­å­˜æœ‰ä¸ä¸­æ–­æˆ–å¼‚å¸¸å¤„ç†å­ä¾‹ç¨‹å…¥å£åœ°å€ç›¸å…³çš„ä¿¡æ¯ã€‚ å½“å‘ç”Ÿä¸­æ–­æ—¶ï¼ŒCPUæ ¹æ®ä¸­æ–­å·è·å–ä¸­æ–­å‘é‡å€¼ï¼Œå†æ ¹æ®ä¸­æ–­æè¿°ç¬¦è¡¨çš„èµ·å§‹åœ°å€å’Œä¸­æ–­å‘é‡å€¼ï¼Œå¾—åˆ°å½¢æˆä¸­æ–­æœåŠ¡å­ç¨‹åºï¼ˆä¸­æ–­æœåŠ¡ä¾‹ç¨‹ï¼‰å…¥å£åœ°å€çš„ç›¸å…³ä¿¡æ¯ã€‚ äºŒã€æ—¶é’Ÿç®¡ç† 1. æ—¶é’Ÿçš„é‡è¦æ€§ æ“ä½œç³»ç»Ÿçš„å†…æ ¸å¯ä»¥åˆ©ç”¨æ—¶é’Ÿæœºåˆ¶é˜²æ­¢ä¸€ä¸ªè¿›ç¨‹å„æ–­CPUæˆ–å…¶ä»–èµ„æºã€‚ç³»ç»Ÿå¯ä»¥åˆ©ç”¨æ—¶é’Ÿæœºåˆ¶é™åˆ¶ä¸€ä¸ªç”¨æˆ·è¿›ç¨‹åœ¨CPUä¸Šçš„è¿ç»­æ‰§è¡Œçš„æ—¶é—´ï¼Œå½“è¿›ç¨‹ä¸€æ¬¡è¿ç»­è¿è¡Œçš„æ—¶é—´è¶…è¿‡é™å®šçš„æ—¶é—´æ—¶ï¼Œç”±ç³»ç»Ÿå°†CPUåˆ†é…ç»™å…¶ä»–è¿›ç¨‹ã€‚ 2. è®¡ç®—æœºç³»ç»Ÿä¸­çš„æ—¶é’Ÿ å¤§éƒ¨åˆ†PCä¸­æœ‰ä¸¤ä¸ªæ—¶é’Ÿæºï¼Œåˆ†åˆ«ç§°ä¸ºå®æ—¶æ—¶é’Ÿï¼ˆReal Timer Clockerï¼ŒRTCï¼‰å’Œ OS æ—¶é’Ÿã€‚RTCæ—¶é’Ÿä¹Ÿç§°ä¸º CMOSæ—¶é’Ÿï¼Œæ˜¯ä¸€å—æ—¶é’ŸèŠ¯ç‰‡ï¼Œé ç”µæ± ä¾›ç”µï¼Œä¸ºè®¡ç®—æœºæä¾›è®¡æ—¶æ ‡å‡†ï¼Œæ˜¯æœ€åŸå§‹ã€æœ€åº•å±‚çš„æ•°æ®ã€‚OSæ—¶é’Ÿäº§ç”ŸäºPCä¸»æ¿ä¸Šçš„å®šæ—¶/è®¡æ•°èŠ¯ç‰‡ï¼Œåœ¨å¼€æœºæ—¶æœ‰æ•ˆï¼Œç”±ç³»ç»Ÿæ§åˆ¶ã€‚ 3. æ“ä½œç³»ç»Ÿçš„æ—¶é’Ÿæœºåˆ¶ æ“ä½œç³»ç»Ÿéœ€è¦å®Œæˆçš„ä¸¤ç§ç³»ç»Ÿæµ‹é‡ï¼Œä¸€æ˜¯ä¿å­˜å½“å‰çš„æ—¥æœŸå’Œæ—¶é—´ï¼Œä»¥ä¾¿èƒ½é€šè¿‡ç³»ç»Ÿè°ƒç”¨æŠŠå®ƒä»¬è¿”å›ç»™ç”¨æˆ·ç¨‹åºï¼Œè®©ç”¨æˆ·ç¨‹åºè·å¾—å½“å‰çš„æ—¥æœŸå’Œæ—¶é—´ï¼Œä¹Ÿå¯ä»¥ç”±å†…æ ¸æœ¬èº«æŠŠå½“å‰æ—¶é—´ä½œä¸ºæ–‡ä»¶å’Œç½‘ç»œåŒ…çš„æ—¶é—´æˆ³ã€‚äºŒæ˜¯ç»´æŒå®šæ—¶å™¨ï¼Œè¿™ç§æœºåˆ¶èƒ½å¤Ÿå‘Šè¯‰å†…æ ¸æˆ–ç”¨æˆ·ç¨‹åºæŸä¸€æ—¶é—´é—´éš”å·²ç»è¿‡å»äº†ã€‚ æ“ä½œç³»ç»Ÿä¾é æ—¶é’Ÿç¡¬ä»¶ï¼ˆå¯ç¼–ç¨‹é—´éš”å®šæ—¶å™¨PITï¼‰å’Œæ—¶é’Ÿé©±åŠ¨ç¨‹åºå®Œæˆä¸Šè¿°ä¸¤ç§å®šæ—¶æµ‹é‡åŠŸèƒ½ã€‚ 1ï¼‰OS æ—¶é’Ÿç®¡ç†ç¡¬ä»¶ï¼ˆå¯ç¼–ç¨‹é—´éš”å®šæ—¶å™¨PITï¼‰ã€‚ 2ï¼‰æ—¶é’Ÿè½¯ä»¶--æ—¶é’Ÿé©±åŠ¨ç¨‹åº æ—¶é’Ÿé©±åŠ¨ç¨‹åºä¹Ÿç§°ä¸ºæ—¶é’Ÿä¸­æ–­å¤„ç†ç¨‹åºï¼Œæ¯äº§ç”Ÿä¸€æ¬¡æ—¶é’Ÿä¸­æ–­ä¿¡å·ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸è¦æ‰§è¡Œæ—¶é’Ÿé©±åŠ¨ç¨‹åºï¼Œæ—¶é’Ÿé©±åŠ¨ç¨‹åºå®Œæˆä¸‹åˆ—åŠŸèƒ½ã€‚ 1ï¼‰ç»´æŠ¤æ—¥æœŸå’Œæ—¶é—´ã€‚ 2ï¼‰é€’å‡å½“å‰è¿›ç¨‹åœ¨ä¸€ä¸ªæ—¶é—´ç‰‡å†…å‰©ä½™æ‰§è¡Œæ—¶é—´ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦ä¸ºé›¶ï¼Œé˜²æ­¢è¿›ç¨‹è¿è¡Œè¶…æ—¶ã€‚ 3ï¼‰å¯¹CPUçš„ä½¿ç”¨æƒ…å†µè®°è´¦ã€‚ 4ï¼‰é€’å‡æŠ¥è­¦è®¡æ•°å™¨ã€‚ ä¸‰ã€ç³»ç»Ÿè°ƒç”¨ 1. ä»€ä¹ˆæ˜¯ç³»ç»Ÿè°ƒç”¨ ç³»ç»Ÿè°ƒç”¨æ˜¯ä¸€ç¾¤é¢„å…ˆå®šä¹‰å¥½çš„æ¨¡å—ï¼Œå®ƒä»¬æä¾›ä¸€æ¡ç®¡é“è®©åº”ç”¨ç¨‹åºæˆ–ä¸€èˆ¬ç”¨æˆ·èƒ½ç”±æ­¤å¾—åˆ°æ ¸å¿ƒç¨‹åºçš„æœåŠ¡ã€‚ ç³»ç»Ÿè°ƒç”¨æ˜¯ç³»ç»Ÿç¨‹åºä¸ç”¨æˆ·ç¨‹åºä¹‹é—´çš„æ¥å£ã€‚ 2. ç³»ç»Ÿè°ƒç”¨ä¸ä¸€èˆ¬å‡½æ•°çš„åŒºåˆ« 1ï¼‰ç”¨æˆ·æ€æ‰§è¡Œ ç”¨æˆ·ç©ºé—´æ˜¯æŒ‡ç”¨æˆ·è¿›ç¨‹æ‰€å¤„çš„åœ°å€ç©ºé—´ã€‚ä¸€ä¸ªç”¨æˆ·è¿›ç¨‹ä¸èƒ½è®¿é—®å…¶ä»–ç”¨æˆ·è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œåªæœ‰ç³»ç»Ÿè¿›ç¨‹æ‰èƒ½è®¿é—®å…¶ä»–ç”¨æˆ·åœ°å€ç©ºé—´ã€‚å½“CPUæ‰§è¡Œç”¨æˆ·ç©ºé—´çš„ä»£ç æ—¶ï¼Œç§°è¯¥è¿›ç¨‹åœ¨ç”¨æˆ·æ€æ‰§è¡Œã€‚ 2ï¼‰ç³»ç»Ÿæ€æ‰§è¡Œ ç³»ç»Ÿç©ºé—´æ˜¯æŒ‡å«æœ‰ä¸€åˆ‡ç³»ç»Ÿæ ¸å¿ƒä»£ç çš„åœ°å€ç©ºé—´ï¼Œå½“CPUæ‰§è¡Œç³»ç»Ÿæ ¸å¿ƒä»£ç æ—¶ï¼Œç§°è¿›ç¨‹å¤„äºç³»ç»Ÿæ€æ‰§è¡Œã€‚ ç³»ç»Ÿè°ƒç”¨ä¸ä¸€èˆ¬å‡½æ•°è°ƒç”¨çš„åŒºåˆ«å¦‚ä¸‹ã€‚ 1ï¼‰ç³»ç»Ÿè°ƒç”¨è¿è¡Œåœ¨ç³»ç»Ÿæ€ï¼ˆæ ¸å¿ƒæ€ï¼‰ï¼Œè€Œä¸€èˆ¬å‡½æ•°è¿è¡Œåœ¨ç”¨æˆ·æ€ã€‚ 2ï¼‰ç³»ç»Ÿè°ƒç”¨ä¸ä¸€èˆ¬å‡½æ•°è°ƒç”¨çš„æ‰§è¡Œè¿‡ç¨‹ä¸åŒã€‚ç³»ç»Ÿè°ƒç”¨æ‰§è¡Œæ—¶ï¼Œå½“å‰è¿›ç¨‹è¢«ä¸­æ–­ï¼Œç”±ç³»ç»Ÿæ‰¾ç›¸åº”çš„ç³»ç»Ÿè°ƒç”¨å­ç¨‹åºï¼Œå¹¶åœ¨ç³»ç»Ÿæ€ä¸‹æ‰§è¡Œï¼Œæ‰§è¡Œç»“æœè¿”å›è¿›ç¨‹ã€‚ 3ï¼‰ç³»ç»Ÿè°ƒç”¨è¦è¿›è¡Œâ€œä¸­æ–­å¤„ç†â€ï¼Œæ¯”ä¸€èˆ¬å‡½æ•°è°ƒç”¨å¤šäº†ä¸€äº›ç³»ç»Ÿå¼€é”€ã€‚ 5. ç³»ç»Ÿè°ƒç”¨çš„ç±»å‹ æ ¹æ®ç³»ç»Ÿè°ƒç”¨çš„åŠŸèƒ½æŠŠç³»ç»Ÿæ€»ç»“ä¸ºä»¥ä¸‹å‡ ç§ç±»å‹ã€‚ 1ï¼‰è¿›ç¨‹æ§åˆ¶ç±»ç³»ç»Ÿè°ƒç”¨ã€‚åˆ›å»ºã€æ’¤é”€è¿›ç¨‹ï¼›è·å¾—ã€æ”¹å˜è¿›ç¨‹å±æ€§ã€‚ 2ï¼‰æ–‡ä»¶æ“ä½œç±»ç³»ç»Ÿè°ƒç”¨ã€‚åˆ›å»ºæ–‡ä»¶ã€åˆ é™¤æ–‡ä»¶ã€æ‰“å¼€æ–‡ä»¶ã€å…³é—­æ–‡ä»¶å’Œè¯»/å†™æ–‡ä»¶ã€‚ 3ï¼‰è®¾å¤‡ç®¡ç†ç±»ç³»ç»Ÿè°ƒç”¨ã€‚è¯·æ±‚ã€é‡Šæ”¾è®¾å¤‡ã€‚ 4ï¼‰é€šä¿¡ç±»ç³»ç»Ÿè°ƒç”¨ã€‚æ‰“å¼€ã€å…³é—­è¿æ¥ï¼Œäº¤æ¢ä¿¡æ¯ã€‚ 5ï¼‰ä¿¡æ¯ç»´æŠ¤ç±»ç³»ç»Ÿè°ƒç”¨ã€‚è¿”å›ç³»ç»Ÿå½“å‰æ—¥æœŸã€æ—¶é—´ã€ç‰ˆæœ¬å·ã€ç”¨æˆ·æ•°ã€ç©ºé—²å†…å­˜å’Œç£ç›˜ç©ºé—´å¤§å°ç­‰ä¿¡æ¯ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äºŒç« _è¿›ç¨‹ç®¡ç†/ç¬¬å››èŠ‚_è¿›ç¨‹åŒæ­¥.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äºŒç« _è¿›ç¨‹ç®¡ç†/ç¬¬å››èŠ‚_è¿›ç¨‹åŒæ­¥.html","title":"ç¬¬å››ã€äº”èŠ‚ è¿›ç¨‹åŒæ­¥ã€é€šä¿¡","keywords":"","body":"ç¬¬å››èŠ‚ è¿›ç¨‹åŒæ­¥ å¤šä»»åŠ¡æ“ä½œç³»ç»Ÿæ”¯æŒå¤šä¸ªè¿›ç¨‹å¹¶å‘æ‰§è¡Œï¼Œå¹¶å‘æ‰§è¡Œçš„è¿›ç¨‹å…±äº«ç³»ç»Ÿçš„è½¯ä»¶å’Œç¡¬ä»¶èµ„æºã€‚ æ“ä½œç³»ç»ŸåŒæ­¥æœºåˆ¶çš„ä¸»è¦ä»»åŠ¡å°±æ˜¯è¦ä¿è¯å¤šä»»åŠ¡å…±äº«ç³»ç»Ÿèµ„æºçš„æƒ…å†µä¸‹ï¼Œç¨‹åºæ‰§è¡Œèƒ½å¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚ ä¸€ã€è¿›ç¨‹åŒæ­¥çš„åŸºæœ¬æ¦‚å¿µ è¿›ç¨‹åŒæ­¥æœ‰ä¸¤ä¸ªä»»åŠ¡ï¼š ä¸€æ˜¯å¯¹å…·æœ‰èµ„æºå…±äº«å…³ç³»çš„è¿›ç¨‹ï¼Œä¿è¯è¯¸è¿›ç¨‹ä»¥äº’æ–¥çš„æ–¹å¼è®¿é—®ä¸´ç•Œèµ„æºã€‚ä¸´ç•Œèµ„æºæ˜¯å¿…é¡»ä»¥äº’æ–¥æ–¹å¼è®¿é—®çš„å…±äº«èµ„æºã€‚ äºŒæ˜¯å¯¹å…·æœ‰ç›¸äº’åˆä½œå…³ç³»çš„è¿›ç¨‹ï¼Œä¿è¯äº’ç›¸åˆä½œçš„è¯¸è¿›ç¨‹åè°ƒæ‰§è¡Œã€‚ç›¸äº’åˆä½œçš„è¿›ç¨‹å¯èƒ½åŒæ—¶å­˜åœ¨èµ„æºå…±äº«çš„å…³ç³»ã€‚ ä¸ºäº†è¯´æ˜ä»€ä¹ˆæ˜¯ä¸´ç•Œèµ„æºï¼Œå…ˆå›å¿†å‰é¢p1ã€p2ä¸¤ä¸ªè¿›ç¨‹å¹¶å‘æ‰§è¡Œï¼Œcounteræ˜¯å…¨å±€å˜é‡ï¼Œåˆå§‹å€¼ä¸º0ï¼Œp1ã€p2ä¸¤ä¸ªè¿›ç¨‹åˆ†åˆ«å¯¹counteråšåŠ 1æ“ä½œï¼Œä»£ç å¦‚ä¸‹ã€‚ p1 { ... counter = counter + 1 ... } p2 { ... counter = counter + 1 ... } è‹¥å½“å‰counter=0ï¼Œp1å’Œp2å„æ‰§è¡Œä¸€æ¬¡åï¼Œcounterçš„æ­£ç¡®å€¼åº”è¯¥æ˜¯2ï¼Œä½†æ˜¯å½“p1å’Œp2åœ¨ç»è¿‡ç¼–è¯‘åï¼Œå¿…é¡»åˆ†åˆ«ç»è¿‡ä¸‹åˆ—æŒ‡ä»¤çš„æ‰§è¡Œï¼Œæ‰èƒ½å®Œæˆcounter=counter+1çš„åŠŸèƒ½ã€‚ p1 { ... register1 = counter; register1 = register1 + 1; counter = register1; ... } p2 { ... register2 = counter; register2 = register2 + 1; counter = register2; ... } p1ã€p2å¹¶å‘æ‰§è¡Œæ—¶ï¼ŒæŒ‡ä»¤çš„æ‰§è¡Œåºåˆ—å¯èƒ½å‡ºç°å„ç§ç»„åˆï¼Œå½“æŒ‰ä¸‹åˆ—é¡ºåºæ‰§è¡Œæ—¶ï¼Œä¼šå‘ç”Ÿcounterè®¡æ•°é”™è¯¯ã€‚ register1 = counter; // æ‰§è¡Œç»“æœï¼šregister1 = 0 register1 = register1 + 1; // æ‰§è¡Œç»“æœï¼šregister1 = 1 register2 = counter; // æ‰§è¡Œç»“æœï¼šregister2 = 0 register2 = register2 + 1; // æ‰§è¡Œç»“æœï¼šregister2 = 1 counter = register1; // æ‰§è¡Œç»“æœï¼šcounter = 1 counter = register2; // æ‰§è¡Œç»“æœï¼šcounter = 1 æ‰§è¡Œç»“æœæ˜¯counter=1ï¼Œè€Œæ­£ç¡®ç»“æœåº”è¯¥æ˜¯counter=2ã€‚ å¦‚æœp1å’Œp2ä»¥äº’æ–¥çš„æ–¹å¼å»è®¿é—®counterï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœp1å…ˆå¼€å§‹å¯¹counterçš„è®¿é—®ï¼Œp2å°±å¿…é¡»ç­‰å¾…p1å¯¹counterçš„è®¿é—®å®Œå…¨ç»“æŸï¼Œå†å¼€å§‹å¯¹counterçš„è®¿é—®ã€‚åä¹‹ï¼Œå¦‚æœp2å…ˆå¼€å§‹å¯¹counterçš„è®¿é—®ï¼Œp1å°±å¿…é¡»ç­‰å¾…p2å¯¹counterçš„è®¿é—®å®Œå…¨ç»“æŸï¼Œå†å¼€å§‹å¯¹counterçš„è®¿é—®ã€‚é‚£ä¹ˆp1å’Œp2å¯¹counterè®¿é—®æŒ‡ä»¤çš„äº¤é”™æ‰§è¡Œçš„æƒ…å†µå°±ä¸ä¼šå‡ºç°ï¼Œè®¡ç®—ç»“æœçš„é”™è¯¯ä¹Ÿå°±ä¸ä¼šå‡ºç°äº†ã€‚p1å’Œp2ä»¥äº’æ–¥çš„æ–¹å¼å»è®¿é—®counterçš„å«ä¹‰æ˜¯åœ¨p1å’Œp2ä¸­çš„ä»»æ„ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œcounter+1æ“ä½œçš„ä¸€ç³»åˆ—æŒ‡ä»¤çš„è¿‡ç¨‹ä¸­ï¼Œä¸å…è®¸å¦ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œè®¿é—®counterçš„æ“ä½œã€‚ç±»ä¼¼counterè¿™æ ·å¿…é¡»ä»¥äº’æ–¥æ–¹å¼è®¿é—®çš„å…±äº«èµ„æºç§°ä¸ºä¸´ç•Œèµ„æºã€‚ åœ¨è®¾è®¡æ“ä½œç³»ç»Ÿæ—¶ï¼Œè®¾è®¡äººå‘˜å¿…é¡»ä¸¥æ ¼ç•Œå®šç³»ç»Ÿä¸­çš„å“ªäº›èµ„æºæ˜¯ä¸´ç•Œèµ„æºï¼Œé€šè¿‡åŒæ­¥æœº åˆ¶ä¿è¯ç³»ç»Ÿè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯¹ä¸´ç•Œèµ„æºçš„è®¿é—®è¿›è¡Œæœ‰æ•ˆæ§åˆ¶ã€‚ ä¸´ç•ŒåŒºæ˜¯è¿›ç¨‹ä¸­è®¿é—®ä¸´ç•Œèµ„æºçš„é‚£æ®µä»£ç ã€‚è®¿é—®ä¸´ç•Œèµ„æºæ˜¯é€šè¿‡æ‰§è¡Œä¸´ç•ŒåŒºä»£ç æ¥å®ç°çš„ï¼Œå¦‚æœèƒ½ä½¿ç¨‹åºä»¥äº’æ–¥çš„æ–¹å¼è¿›å…¥ä¸´ç•ŒåŒºï¼Œå°±èƒ½å¤Ÿå®ç°å¯¹ä¸´ç•Œèµ„æºçš„äº’æ–¥è®¿é—®ã€‚è¿™ä¸€ç‚¹å¯ä»¥é€šè¿‡åœ¨ä¸´ç•ŒåŒºå‰é¢åŠ è¿›å…¥åŒºä»£ç ï¼Œåœ¨ä¸´ç•ŒåŒºåé¢åŠ é€€å‡ºåŒºä»£ç æ¥å®ç°ã€‚è¿›å…¥åŒºä»£ç åœ¨ä¸´ç•ŒåŒºä»£ç ä¹‹å‰æ‰§è¡Œï¼Œæ£€æŸ¥è¿›ç¨‹æ˜¯å¦å¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºå¹¶å¯¹ä¸´ç•ŒåŒºâ€œåŠ é”â€ã€‚é€€å‡ºåŒºä»£ç åœ¨ä¸´ç•ŒåŒºä»£ç ä¹‹åæ‰§è¡Œï¼Œå®Œæˆé‡Šæ”¾ä¸´ç•ŒåŒºè®¿é—®æƒçš„åŠŸèƒ½ã€‚ åœ¨è¿›ç¨‹ä¸­ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹åˆ—æ¨¡å¼çš„ä»£ç æ¥å®ç°å¯¹ä¸´ç•Œèµ„æºçš„äº’æ–¥è®¿é—®ã€‚ { ... è¿›å…¥åŒºï¼ˆEntry Sectionï¼‰ï¼› ä¸´ç•ŒåŒºï¼ˆCritical Sectionï¼‰ï¼› é€€å‡ºåŒºï¼ˆExit Sectionï¼‰ï¼› } äºŒã€åŒæ­¥æœºåˆ¶åº”éµå¾ªçš„å‡†åˆ™ å½“å­˜åœ¨å¤šç§å¯é€‰çš„åŒæ­¥æ–¹æ¡ˆæ—¶ï¼Œå¯èƒ½æ˜¯ç¡¬ä»¶æˆ–è½¯ä»¶çš„ä¸åŒï¼Œä¹Ÿå¯èƒ½æ˜¯ç®—æ³•çš„ä¸åŒï¼Œæ ¹æ®ä»€ä¹ˆæ¥æƒè¡¡åˆ©å¼Šï¼Œåšå‡ºæ€¡å½“çš„é€‰æ‹©å‘¢ï¼Ÿå¯¹äºä¸€ç§åŒæ­¥æŠ€æœ¯ï¼Œå¦‚ä½•å¯¹å®ƒæ”¶ç¡®æ€§å’Œæ€§èƒ½åšå‡ºè¯„ ä»·å‘¢ï¼ŸåŒæ­¥æœºåˆ¶åº”éµå¾ªçš„å‡†åˆ™å¯ä»¥ä¸ºäººä»¬æä¾›åˆ¤æ–­ã€é€‰æ‹©å’Œè¯„ä»·çš„å‚è€ƒä¾æ®ã€‚ 1. ç©ºé—²è®©è¿› å½“æ²¡æœ‰è¿›ç¨‹å¤„äºä¸´ç•ŒåŒºæ—¶ï¼Œè¡¨æ˜ä¸´ç•Œèµ„æºå¤„äºç©ºé—²çŠ¶æ€ï¼Œåº”å…è®¸ä¸€ä¸ªè¯·æ±‚è¿›å…¥ä¸´ç•ŒåŒºçš„è¿›ç¨‹ç«‹å³è¿›å…¥è‡ªå·±çš„ä¸´ç•ŒåŒºï¼Œä»¥æœ‰æ•ˆåœ°åˆ©ç”¨ä¸´ç•Œèµ„æºã€‚ 2. å¿™åˆ™ç­‰å¾… å½“å·²æœ‰è¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºæ—¶ï¼Œè¡¨æ˜ä¸´ç•Œèµ„æºæ­£åœ¨è¢«è®¿é—®ï¼Œå› è€Œå…¶ä»–è¯•å›¾è¿›å…¥ä¸´ç•ŒåŒºçš„è¿›ç¨‹ å¿…é¡»ç­‰å¾…ï¼Œä»¥ä¿è¯å¯¹ä¸´ç•Œèµ„æºçš„äº’æ–¥è®¿é—®ã€‚ 3. æœ‰é™ç­‰å¾… å¯¹è¦æ±‚è®¿é—®ä¸´ç•Œèµ„æºçš„è¿›ç¨‹ï¼Œåº”ä¿è¯åœ¨æœ‰é™æ—¶é—´å†…èƒ½è¿›äººè‡ªå·±çš„ä¸´ç•ŒåŒºï¼Œä»¥å…è¿›ç¨‹é™·äºº æ— é™ç­‰å¾…çš„çŠ¶æ€ã€‚ 4. è®©æƒç­‰å¾… å½“è¿›ç¨‹ç”³è¯·ä¸åˆ°å…±äº«èµ„æºçš„è®¿å›æƒæ—¶ï¼Œåº”ç«‹å³é‡Šæ”¾å¤„ç†æœºï¼Œä»¥å…è¿›ç¨‹å“ˆäººâ€œå¿™ç­‰â€çŠ¶æ€ï¼Œ æµªè´¹CPUèµ„æºã€‚ ä¸‰ã€ä¿¡å·é‡æœºåˆ¶ åœ¨ä¿¡å·é‡æœºåˆ¶ä¸­ï¼Œç”¨æŸç§ç±»å‹çš„å˜é‡ï¼Œå³ä¿¡å·é‡çš„å–å€¼æ¥è¡¨ç¤ºèµ„æºçš„ä½¿ç”¨çŠ¶å†µï¼Œæˆ–æŸç§äº‹ä»¶æ˜¯å¦å‘ç”Ÿï¼Œä»¥æ­¤ä¸ºåŸºç¡€å®ç°è¿›ç¨‹çš„åŒæ­¥ã€‚æœ¬èŠ‚å°†ä»‹ç»æ•´å‹ä¿¡å·é‡æœºåˆ¶ã€è®°å½•å‹ä¿¡å·é‡æœº åˆ¶ã€ANDå‹ä¿¡å·é‡æœºåˆ¶ã€‚ äº¤é€šä¿¡å·ç¯çš„ä½œç”¨æ˜¯é€šè¿‡ç¯çš„ä¸åŒé¢œè‰²å‘ŠçŸ¥è½¦è¾†åº”å¦‚ä½•è¡Œé©¶ï¼Œä¿¡å·é‡æœºåˆ¶ç±»ä¼¼è¿™ç§ä¿¡å·ç¯çš„ä½œç”¨ã€‚å¯¹ä¸åŒçš„å…±äº«èµ„æºè®¾ç½®è¢«ç§°ä¸ºä¿¡å·é‡çš„å˜é‡ï¼Œç”¨ä¿¡å·é‡çš„å–å€¼æ¥è¡¨ç¤ºèµ„æºçš„ä½¿ç”¨ çŠ¶å†µï¼Œæˆ–æŸç§äº‹ä»¶æ˜¯å¦å‘ç”Ÿã€‚é€šè¿‡ä¿¡å·é‡çš„å–å€¼æ¥åˆ¤æ–­è¿›ç¨‹æ˜¯å¦èƒ½è®¿é—®ä¸ä¿¡å·é‡å¯¹åº”çš„å…±äº«èµ„æºã€‚ 1. æ•´å‹ä¿¡å·é‡æœºåˆ¶ æ•´å‹ä¿¡å·é‡æ˜¯è¡¨ç¤ºå…±äº«èµ„æºçŠ¶æ€ä¸”åªèƒ½ç”±ç‰¹æ®Šçš„åŸå­æ“ä½œæ”¹å˜çš„æ•´å‹é‡ã€‚å…¶å®ŒæˆåŒæ­¥åŠŸèƒ½çš„åŸç†æ˜¯å®šä¹‰ä¸€ä¸ªæ•´å‹å˜é‡ï¼Œç”¨æ•´å‹å˜é‡å€¼æ¥æ ‡è®°èµ„æºçš„ä½¿ç”¨æƒ…å†µã€‚å¦‚æœæ•´å‹é‡>0ï¼Œè¯´æ˜æœ‰å¯ç”¨èµ„æºï¼šå¦‚æœæ•´å‹é‡â‰¤0ï¼Œè¯´æ˜èµ„æºå¿™ï¼Œè¿›ç¨‹å¿…é¡»ç­‰å¾…ã€‚å¯¹äºä¸€æ¬¡åªå…è®¸ä¸€ä¸ªè¿›ç¨‹è®¿é—®çš„ä¸´ç•Œèµ„æºï¼Œå¯å®šä¹‰ä¸€ä¸ªç”¨äºäº’æ–¥çš„æ•´å‹ä¿¡å·é‡ï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ä¸º1ã€‚æ•´å‹ä¿¡å·é‡çš„å€¼åªèƒ½é€šè¿‡ä¸¤ä¸ªç‰¹å®šçš„åŸå­æ“ä½œwaitå’Œsignalæ¥æ”¹å˜ã€‚ (1) æ•´å‹ä¿¡å·é‡çš„waitå’Œsignalæ“ä½œ så®šä¹‰ä¸ºæ•´å‹ä¿¡å·é‡ã€‚ Var s integer; wait(s)//ç”¨äºç”³è¯·èµ„æº { while sâ‰¤0 do no-op; //æ•´å‹ä¿¡å·é‡å€¼â‰¤0æ—¶å¾ªç¯æ‰§è¡Œç©ºæ“ä½œ s=s-1 } signal(s)//ç”¨äºé‡Šæ”¾èµ„æº { s=s+1; } (2) ç”¨æ•´å‹ä¿¡å·é‡å®ç°è¿›ç¨‹äº’æ–¥ ç”¨æ•´å‹ä¿¡å·é‡å®ç°è¿›ç¨‹äº’æ–¥çš„æ€æƒ³æ˜¯ï¼šä¸ºå¿…é¡»äº’æ–¥è®¿é—®çš„ä¸´ç•Œèµ„æºCSå®šä¹‰ä¸€ä¸ªäº’æ–¥ä¿¡å·é‡mutex,å°†åˆå§‹å€¼ç½®ä¸º1ï¼Œç„¶åå°†CSæ”¾å…¥wait(mutex)å’Œsignal(mutex)ä¹‹é—´ã€‚å½“CSå¯è®¿é—®æ—¶ï¼Œwait(mutex)æ‰èƒ½æ­£å¸¸ç»“æŸä½¿è¿›ç¨‹è¿›å…¥CSã€‚ (3) ç”¨æ•´å‹ä¿¡å·é‡å®ç°è¿›ç¨‹çš„åè°ƒ (4) Linuxä¸­çš„æ•´å‹ä¿¡å·é‡ (5) å¯¹æ•´å‹ä¿¡å·é‡æœºåˆ¶çš„æ€»ç»“ 1ï¼‰æ•´å‹ä¿¡å·é‡çš„å€¼åªèƒ½ç”±waitå’Œsignalæ“ä½œæ”¹å˜ã€‚ 2ï¼‰waitå’Œsignalæ“ä½œéƒ½æ˜¯åŸå­æ“ä½œï¼Œå³åœ¨è¿™ä¸¤ä¸ªæ“ä½œä¸­å¯¹ä¿¡å·é‡çš„è®¿é—®æ˜¯ä¸èƒ½è¢«ä¸­æ–­çš„ã€‚ 3ï¼‰åŸå­æ“ä½œå¯ä»¥é€šè¿‡å…³ä¸­æ–­æ¥å®ç°ã€‚ 4ï¼‰æ•´å‹ä¿¡å·é‡æœºåˆ¶çš„å®ä¾‹ï¼šLinuxä¸­çš„è‡ªæ—‹é”Spin Lockã€‚ 5ï¼‰ä¸åŒçš„èµ„æºå¯¹åº”ä¸åŒçš„ä¿¡å·é‡ï¼Œå¹¶ä¸æ˜¯ç³»ç»Ÿä¸­æ‰€æœ‰çš„èµ„æºéƒ½ç”¨åŒä¸€ä¸ªä¿¡å·é‡è¡¨ç¤ºã€‚ 2. è®°å½•å‹ä¿¡å·é‡æœºåˆ¶ (1) è®°å½•å‹ä¿¡å·é‡çš„æ•°æ®ç±»å‹ Type semaphore = record Value: integer; // èµ„æºæ•°é‡ L: list of process; // é˜»å¡é˜Ÿåˆ— end (2) è®°å½•å‹ä¿¡å·é‡çš„wait(s)å’Œsignal(s)æ“ä½œ procedure wait(s) var s: semaphore; begin s.value = s.value -1; if s.value (3) å¯¹è®°å½•å‹ä¿¡å·é‡wait(s)å’Œsignal(s)çš„è¯´æ˜ 1) å½“s.value>=0æ—¶ï¼Œs.valueçš„å€¼è¡¨ç¤ºèµ„æºæ•°é‡ã€‚å½“s.value 2) æ¯æ¬¡çš„wait(s)æ“ä½œï¼Œæ„å‘³ç€è¿›ç¨‹è¯·æ±‚ä¸€ä¸ªå•ä½çš„èµ„æºï¼Œæè¿°ä¸ºs.value=s.value-1ã€‚å½“s.value 3) æ¯æ¬¡çš„signal(s)æ“ä½œï¼Œæ„å‘³ç€è¿›ç¨‹é‡Šæ”¾ä¸€ä¸ªèµ„æºï¼Œæ•…s.value=s.value+1æ“ä½œè¡¨ç¤ºç³»ç»Ÿå¯ç”¨çš„èµ„æºæ•°ç›®åŠ 1.è‹¥åŠ 1ås.value 4) å¦‚æœs.valueçš„åˆå€¼ä¸º1ï¼Œè¡¨ç¤ºåªå…è®¸ä¸€ä¸ªè¿›ç¨‹è®¿é—®ä¸´ç•Œèµ„æºï¼Œæ­¤æ—¶çš„ä¿¡å·é‡è½¬åŒ–ä¸ºäº’æ–¥ä¿¡å·é‡ã€‚ 5) è®°å½•å‹ä¿¡å·é‡æœºåˆ¶çš„ä¼˜ç‚¹æ˜¯ä¸å­˜åœ¨â€œå¿™ç­‰â€ï¼Œé‡‡å–äº†â€œè®©æƒç­‰å¾…â€çš„ç­–ç•¥ã€‚ (4) åˆ©ç”¨è®°å½•å‹ä¿¡å·é‡å®ç°äº’æ–¥ åˆ©ç”¨è®°å½•å‹ä¿¡å·é‡å®ç°äº’æ–¥çš„æ¨¡å‹ä»å®ç°äº’æ–¥çš„ä»£ç ç‰‡æ®µä¸Šçœ‹ä¸æ•´å‹ä¿¡å·é‡ä¸€è‡´ï¼Œéƒ½æ˜¯åœ¨è®¿é—®ä¸´ç•Œèµ„æºçš„è¿›ç¨‹ä¸­å®šä½ä¸´ç•ŒåŒºã€‚åœ¨ä¸´ç•ŒåŒºå‰é¢åŠ wait(s)ï¼Œåœ¨ä¸´ç•ŒåŒºåé¢åŠ signal(s)ï¼Œä¸åŒçš„æ˜¯ä¿¡å·é‡çš„ç±»å‹å’Œwait(s)ã€signal(s)å®ç°ä»£ç ä¸åŒã€‚å®ç°è¿›ç¨‹äº’æ–¥çš„ä»£ç æ¨¡å‹æè¿°å¦‚ä¸‹ã€‚ var s: semaphore; s.value = 1; Begin Repeat wait(s); Critical Section; signal(s); Remainder section; Until false; End (5) åˆ©ç”¨è®°å½•å‹ä¿¡å·é‡å®ç°â€œåè°ƒâ€çš„åº”ç”¨ä¸¾ä¾‹ 3. ANDå‹ä¿¡å·é‡æœºåˆ¶ (1) ANDå‹ä¿¡å·é‡æœºåˆ¶çš„å¼•å…¥ ANDä¿¡å·é‡æœºåˆ¶çš„åŸºæœ¬æ€æƒ³æ˜¯å°†è¿›ç¨‹åœ¨æ•´ä¸ªè¿è¡Œè¿‡ç¨‹ä¸­æ‰€éœ€è¦çš„æ‰€æœ‰èµ„æºä¸€æ¬¡æ€§åœ°å…¨éƒ¨åˆ†é…ç»™è¿›ç¨‹ï¼Œå¾…è¯¥è¿›ç¨‹ä½¿ç”¨å®Œåå†ä¸€èµ·é‡Šæ”¾ã€‚åªè¦è¿˜æœ‰ä¸€ä¸ªèµ„æºä¸èƒ½åˆ†é…ç»™è¯¥è¿›ç¨‹ï¼Œå…¶ä»–æ‰€æœ‰å¯èƒ½ä¸ºä¹‹åˆ†é…çš„èµ„æºä¹Ÿä¸åˆ†é…ç»™å®ƒã€‚ (2) ANDå‹ä¿¡å·é‡æœºåˆ¶çš„å®ç° å››ã€ç»å…¸çš„è¿›ç¨‹åŒæ­¥é—®é¢˜ æœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•ç”¨è®°å½•å‹ä¿¡å·é‡æœºåˆ¶è§£å†³ä¸¤ä¸ªç»å…¸çš„è¿›ç¨‹åŒæ­¥é—®é¢˜ã€‚ 1. ç”Ÿäº§è€…ä¸€æ¶ˆè´¹è€…é—®é¢˜çš„æè¿° ç”Ÿäº§è€…ä¸€æ¶ˆè´¹è€…é—®é¢˜æ˜¯ç›¸äº’åˆä½œè¿›ç¨‹å…³ç³»çš„ä¸€ç§æŠ½è±¡ã€‚ä¾‹å¦‚ï¼Œè¾“äººè¿›ç¨‹å’Œè®¡ç®—è¿›ç¨‹çš„å…³ç³»ä¸­ï¼Œè¾“å…¥è¿›ç¨‹æ˜¯ç”Ÿäº§è€…è¿›ç¨‹ï¼Œè®¡ç®—è¿›ç¨‹æ˜¯æ¶ˆè´¹è€…è¿›ç¨‹ã€‚è®¡ç®—è¿›ç¨‹å’Œè¾“å‡ºè¿›ç¨‹çš„å…³ç³»ä¸­ï¼Œè®¡ç®—è¿›ç¨‹æ˜¯ç”Ÿäº§è€…è¿›ç¨‹ï¼Œè¾“å‡ºè¿›ç¨‹æ˜¯æ¶ˆè´¹è€…è¿›ç¨‹ã€‚ (1) é—®é¢˜æè¿° ç”Ÿäº§è€…è¿›ç¨‹ç”Ÿäº§æ¶ˆæ¯ï¼Œå¹¶å°†æ¶ˆæ¯æä¾›ç»™æ¶ˆè´¹è€…è¿›ç¨‹æ¶ˆè´¹ã€‚åœ¨ç”Ÿäº§è€…è¿›ç¨‹å’Œæ¶ˆè´¹è€…è¿›ç¨‹ä¹‹é—´è®¾ç½®äº†ä¸€ä¸ªå…·æœ‰ä¸ªç¼“å†²åŒºçš„ç¼“å†²æ± ï¼Œç”Ÿäº§è€…è¿›ç¨‹å¯ä»¥å°†å®ƒæ‰€ç”Ÿäº§çš„æ¶ˆæ¯æ”¾äººç¼“å†²æ± çš„ä¸€ä¸ªç¼“å†²åŒºä¸­ï¼Œæ¶ˆè´¹è€…è¿›ç¨‹å¯ä»¥ä»ä¸€ä¸ªç¼“å†²åŒºä¸­å–å¾—ä¸€ä¸ªæ¶ˆæ¯æ¶ˆè´¹ã€‚ä»»æ„ä¸¤ä¸ªè¿›ç¨‹å¿…é¡»ä»¥äº’æ–¥çš„æ–¹å¼è¾¹é—®å…¬å…±ç¼“å†²æ± ã€‚å½“ç¼“å†²æ± ç©ºï¼Œæ²¡æœ‰å¯ä¾›æ¶ˆè´¹çš„æ¶ˆæ¯æ—¶ï¼Œæ¶ˆè´¹è€…è¿›ç¨‹å¿…é¡»é˜»å¡ç­‰å¾…ã€‚å½“ç¼“å†²æ± è£…æ»¡æ¶ˆæ¯ï¼Œæ²¡æœ‰ç©ºé—²ç¼“å†²åŒºæ—¶ï¼Œç”Ÿäº§è€…è¿›ç¨‹å¿…é¡»é˜»å¡ç­‰å¾…ã€‚ å¦‚å›¾2-18æ‰€ç¤ºï¼ŒoutæŒ‡é’ˆæŒ‡å‘è£…æœ‰æ¶ˆæ¯çš„ç¼“å†²åŒºï¼Œæ¶ˆè´¹è€…è¿›ç¨‹ä»outæŒ‡å‘çš„ç¼“å†²åŒºä¸­å– æ¶ˆæ¯ã€‚næŒ‡é’ˆæŒ‡å‘ç©ºç¼“å†²åŒºï¼Œç”Ÿäº§è€…è¿›ç¨‹æ€»æ˜¯æŠŠæ–°ç”Ÿäº§çš„æ¶ˆæ¯æ”¾å…¥inæŒ‡å‘çš„ç©ºç¼“å†²åŒºã€‚ (2) éœ€è¦è§£å†³çš„é—®é¢˜ 1) å®ç°ä»»æ„ä¸¤ä¸ªè¿›ç¨‹å¯¹ç¼“å†²æ± çš„äº’æ–¥è®¿é—®ã€‚ 2) å®ç°å¯¹ç”Ÿäº§è€…è¿›ç¨‹å’Œæ¶ˆè´¹è€…è¿›ç¨‹çš„â€œåè°ƒâ€ï¼Œå³ç¼“å†²æ± ä¸­æœ‰æ¶ˆæ¯æ—¶æ¶ˆè´¹è€…è¿›ç¨‹æ‰èƒ½æ‰§è¡Œå–æ¶ˆæ¯çš„æ“ä½œã€‚æ— æ¶ˆæ¯æ—¶ï¼Œé˜»å¡æ¶ˆè´¹è€…è¿›ç¨‹ã€‚ç¼“å†²æ± ä¸­æœ‰ç©ºé—²ç¼“å†²åŒºæ—¶ï¼Œç”Ÿäº§è€…è¿›ç¨‹æ‰èƒ½æ‰§è¡Œæ”¾æ¶ˆæ¯çš„æ“ä½œã€‚æ— ç©ºé—´ç¼“å†²åŒºæ—¶ï¼Œé˜»å¡ç”Ÿäº§è€…è¿›ç¨‹ã€‚ (3) ä¿¡å·é‡çš„è®¾ç½® 1) è®¾ç½®ä¸€ä¸ªäº’æ–¥ä¿¡å·é‡mutex,ç”¨äºå®ç°å¯¹å…¬å…±ç¼“å†²æ± çš„äº’æ–¥è®¿é—®ï¼Œåˆå€¼ä¸º1ã€‚ 2) è®¾ç½®ä¸¤ä¸ªèµ„æºä¿¡å·é‡ï¼Œåˆ†åˆ«è¡¨ç¤ºå¯ç”¨èµ„æºæ•° emptyï¼šè¡¨ç¤ºç¼“å†²æ± ä¸­çš„ç©ºç¼“å†²åŒºæ•°ï¼Œåˆå€¼ä¸ºnã€‚ fullï¼šè¡¨ç¤ºè£…æœ‰æ¶ˆæ¯çš„ç¼“å†²åŒºæ•°ï¼Œåˆå€¼ä¸º0ï¼ˆä¸€ä¸ªç¼“å†²åŒºä¸­æ”¾ä¸€ä¸ªæ¶ˆæ¯ï¼‰ (4) åŒæ­¥ç¨‹åº åˆ©ç”¨è®°å½•å‹ä¿¡å·é‡æœºåˆ¶å®ç°ç”Ÿäº§è€…ä¸€æ¶ˆè´¹è€…é—®é¢˜çš„åŒæ­¥ä»£ç æè¿°å¦‚ä¸‹ã€‚ 1) ç”Ÿäº§è€…è¿›ç¨‹åŒæ­¥ä»£ç çš„æè¿°ã€‚ Producer: begin repeat ... produce an item in nextp; wait(empty); //ç”³è¯·ç©ºç¼“å†²åŒº wait(mutex); //ç”³è¯·å…¬å…±ç¼“å†²æ± çš„äº’æ–¥è®¿é—®æƒ buffer(in)=nextp; //å°†æ¶ˆæ¯æ”¾å…¥inæŒ‡é’ˆæŒ‡å‘çš„ç¼“å†²åŒº in (in +1)mod n; //inæŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªç©ºç¼“å†²åŒº signal(mutex); //é‡Šæ”¾å¯¹å…¬å…±ç¼“å†²æ± çš„äº’æ–¥è®¿é—®æƒ signal(full); //é‡Šæ”¾æ¶ˆæ¯èµ„æº until false; end 2) æ¶ˆè´¹è€…è¿›ç¨‹åŒæ­¥ä»£ç çš„æè¿°ã€‚ Consumer: begin repeat â€¦ wait(full); //ç”³è¯·æ¶ˆæ¯ wait(mutex); //ç”³è¯·å…¬å…±ç¼“å†²æ± çš„äº’æ–¥è®¿é—®æƒ nexte buffer(out); //ä»outæŒ‡é’ˆæŒ‡å‘çš„ç¼“å†²åŒºä¸­å–æ¶ˆæ¯ out (out +1)mod n; //outæŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªè£…æœ‰æ¶ˆæ¯çš„ç¼“å†²åŒº signal(mutex); //é‡Šæ”¾å¯¹å…¬å…±ç¼“å†²æ± çš„äº’æ–¥è®¿é—®æƒ signal(empty); //é‡Šæ”¾ç©ºç¼“å†²åŒº consume item in nextc; until false; end (5) è¯´æ˜ 1) waitå’Œsignalæ“ä½œå¿…é¡»æˆå¯¹å‡ºç°ã€‚ 2) waitæ“ä½œçš„é¡ºåºä¸èƒ½é¢ å€’ã€‚å¿…é¡»å…ˆå¯¹èµ„æºä¿¡å·é‡ï¼ˆå³emptyå’Œfull)è¿›è¡Œwaitæ“ä½œï¼Œç„¶ åå†å¯¹äº’æ–¥ä¿¡å·é‡è¿›è¡Œwaitæ“ä½œã€‚ 3) ç”¨è®°å½•å‹ä¿¡å·é‡æœºåˆ¶è§£å†³ç”Ÿäº§è€…ä¸€æ¶ˆè´¹è€…é—®é¢˜ï¼Œå¯¹å…·æœ‰ç›¸äº’åˆä½œå…³ç³»çš„è¿›ç¨‹ï¼Œæä¾› äº†è§£å†³é—®é¢˜çš„æ¨¡å‹ã€‚ 2. è¯»è€…ä¸€å†™è€…é—®é¢˜ (1) é—®é¢˜æè¿° Dæ˜¯å¤šä¸ªè¿›ç¨‹å…±äº«çš„æ•°æ®åŒºï¼Œå…è®¸å¤šä¸ªè¿›ç¨‹åŒæ—¶è¯»DåŒºï¼Œä»…å…è®¸ä¸€ä¸ªè¿›ç¨‹å†™DåŒºï¼Œä¸”æœ‰è¿›ç¨‹å†™DåŒºæ—¶ï¼Œä¸èƒ½æœ‰ä»»ä½•å…¶ä»–è¿›ç¨‹è¯»æˆ–å†™DåŒºã€‚ æ•°æ®åº“ç®¡ç†ä¸­å­˜åœ¨è¿™ç§åŒæ­¥é—®é¢˜çš„å®ä¾‹ï¼Œç³»ç»Ÿå…è®¸å¤šä¸ªç”¨æˆ·åŒæ—¶è¯»ä¸€ä¸ªæ•°æ®åº“è¡¨ï¼Œä½†æ˜¯ä»»æ„æ—¶åˆ»åªå…è®¸ä¸€ä¸ªç”¨æˆ·ä¿®æ”¹å®ƒï¼Œå½“æ•°æ®åº“è¡¨è¢«ç”¨æˆ·ï¼ˆé€šå¸¸æ˜¯æœ‰ç‰¹æ®Šæƒé™çš„æ•°æ®åº“ç®¡ç†å‘˜ï¼‰ä¿®æ”¹æ—¶ï¼Œä»»ä½•å…¶ä»–ç”¨æˆ·ä¸èƒ½è¯»æˆ–è€…å†™è¿™ä¸€æ•°æ®åº“è¡¨ã€‚ (2) ä¿¡å·é‡çš„è®¾ç½® 1) å…¨å±€å˜é‡readcountç”¨äºå¯¹è¿›å…¥å…±äº«åŒºçš„è¯»è¿›ç¨‹è®¡æ•°ã€‚ 2) äº’æ–¥ä¿¡å·é‡mutexç”¨äºå¯¹å¤šä¸ªè¿›ç¨‹å…±äº«çš„å…¨å±€å˜é‡readcountçš„äº’æ–¥è®¿é—®ã€‚ 3) äº’æ–¥ä¿¡å·é‡wmutexç”¨äºå®ç°è¯»æ“ä½œä¸å†™æ“ä½œçš„äº’æ–¥ï¼Œä»¥åŠå†™æ“ä½œä¸å†™æ“ä½œçš„äº’æ–¥ã€‚ (3) åŒæ­¥ç¨‹åº 1) å†™è¿›ç¨‹åŒæ­¥ä»£ç çš„æè¿°ã€‚ writer; begin: wait(wmutex); â€¦ writing operation; â€¦ signal(wmutex); end; 2) è¯»è¿›ç¨‹åŒæ­¥ä»£ç çš„æè¿°ã€‚ reader: begin: wait(rmutex); if readcount =0 then wait(wmutex); readcount++; signal(rmutex); â€¦ reading file from D: wait(rmutex); readcount--; if readcount =0 then signal(wmutex); signal(rmutex) end; äº”ã€ç®¡ç¨‹ ä¿¡å·é‡æœºåˆ¶çš„ç¼ºé™·æ˜¯æ¯ä¸ªè®¿é—®å…±äº«èµ„æºçš„è¿›ç¨‹éƒ½å¿…é¡»è‡ªå¤‡åŒæ­¥æ“ä½œwait(s)å’Œsignal(s)ã€‚è¿™å°±ä½¿å¤§é‡çš„åŒæ­¥æ“ä½œåˆ†æ•£åœ¨å„ä¸ªè¿›ç¨‹ä¸­ï¼Œè¿™ä¸ä»…ç»™ç³»ç»Ÿçš„ç®¡ç†å¸¦æ¥éº»çƒ¦ï¼Œè€Œä¸”è¿˜ä¼šå› åŒæ­¥æ“ä½œçš„ä½¿ç”¨ä¸å½“è€Œå¯¼è‡´ç³»ç»Ÿå‡ºé”™ï¼Œå› æ­¤å¼•å…¥äº†ç®¡ç¨‹çš„æ¦‚å¿µã€‚ 1. ç®¡ç¨‹çš„åŸºæœ¬æ¦‚å¿µ (1) ç®¡ç¨‹çš„å®šä¹‰ ç®¡ç¨‹æ˜¯æè¿°å…±äº«èµ„æºçš„æ•°æ®ç»“æ„å’Œåœ¨æ•°æ®ç»“æ„ä¸Šçš„å…±äº«èµ„æºç®¡ç†ç¨‹åºçš„é›†åˆã€‚å…¶ä¸­åŒ…æ‹¬å˜é‡çš„å®šä¹‰ã€å˜é‡çš„åˆå§‹åŒ–ä»£ç ï¼Œä»¥åŠç®¡ç†å…±äº«èµ„æºçš„è¿‡ç¨‹ã€‚ç®¡ç¨‹çš„è¯­æ³•æè¿°å¦‚ä¸‹ã€‚ type moniter-name=moniter variable declarations; procedure entrypl(â€¦) beginâ€¦end; â€¦ procedure entrypn(â€¦) beginâ€¦end; begin initialization code; end (2) å¯¹ç®¡ç¨‹çš„è¯´æ˜ 1) ç®¡ç¨‹æ˜¯å¯ä¾›ç¨‹åºçŒ¿è°ƒç”¨çš„è½¯ä»¶åŒ…ã€‚ 2) æ¯æ¬¡åªæœ‰ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨ç®¡ç¨‹æ‰§è¡Œï¼Œä»»æ„æ—¶åˆ»ç®¡ç¨‹ä¸­åªèƒ½æœ‰ä¸€ä¸ªæ´»è·ƒè¿›ç¨‹ã€‚ 3) ç®¡ç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€çš„æ„å»ºï¼Œæ‰€æœ‰ç¼–è¯‘å™¨çŸ¥é“å®ƒä»¬å¾ˆç‰¹æ®Šï¼Œå¹¶å¯ä»¥è°ƒç”¨ä¸å…¶ä»–è¿‡ç¨‹ä¸åŒçš„æ–¹æ³•å¤„ç†å®ƒä»¬ã€‚ (3) æ¡ä»¶å˜é‡ ç¬¬äº”èŠ‚ è¿›ç¨‹é€šä¿¡ æ“ä½œç³»ç»Ÿæä¾›è¿›ç¨‹é€šä¿¡åŠŸèƒ½ï¼Œä»¥æ”¯æŒè¿›ç¨‹ä¹‹é—´çš„ä¿¡æ¯äº¤æ¢ã€‚è¿›ç¨‹ä¹‹é—´çš„é«˜çº§é€šä¿¡æœºåˆ¶åˆ†ä¸ºå…±äº«å­˜å‚¨å™¨ç³»ç»Ÿã€æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿå’Œç®¡é“é€šä¿¡ç³»ç»Ÿã€‚ 1. å…±äº«å­˜å‚¨å™¨ç³»ç»Ÿ åœ¨å…±äº«å­˜å‚¨å™¨ç³»ç»Ÿä¸­ï¼Œç›¸äº’é€šä¿¡çš„è¿›ç¨‹å…±äº«å…¶äº›æ•°æ®ç»“æ„æˆ–å…±äº«å­˜å‚¨åŒºï¼Œè¿›ç¨‹ä¹‹é—´èƒ½é€šè¿‡è¿™äº›ç©ºé—´è¿›è¡Œé€šä¿¡ã€‚å…±äº«å­˜å‚¨ç³»ç»Ÿå¯åˆ†ä¸ºä¸¤ç§ç±»å‹ã€‚ 1) åŸºäºå…±äº«æ•°æ®ç»“æ„çš„é€šä¿¡æ–¹å¼ã€‚åœ¨è¿™ç§é€šä¿¡æ–¹å¼ä¸­ï¼Œè¦æ±‚è¯¸è¿›ç¨‹å…¬ç”¨æŸäº›æ•°æ®ç»“æ„ï¼Œä»¥å®ç°è¿›ç¨‹é—´çš„ä¿¡æ¯äº¤æ¢ã€‚ä¾‹å¦‚åœ¨ç”Ÿäº§è€…ä¸€æ¶ˆè´¹è€…é—®é¢˜ä¸­ï¼Œä½¿ç”¨æœ‰ç•Œç¼“å†²åŒºè¿™ç§æ•°æ®ç»“æ„æ¥å®ç°è¿›ç¨‹é—´çš„é€šä¿¡ã€‚ 2) åŸºäºå…±äº«å­˜å‚¨åŒºçš„é€šä¿¡æ–¹å¼ã€‚ä¸ºäº†ä¼ è¾“å¤§é‡æ•°æ®ï¼Œåœ¨å­˜å‚¨å™¨ä¸­åˆ’å‡ºä¸€å—å…±äº«å­˜å‚¨åŒºï¼Œ è¿›ç¨‹å¯ä»¥é€šè¿‡å¯¹å…±äº«å­˜å‚¨åŒºä¸­çš„æ•°æ®çš„è¯»æˆ–å†™æ¥å®ç°é€šä¿¡ã€‚ 2. æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿ åœ¨æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹é—´é€šè¿‡æ“ä½œç³»ç»Ÿæä¾›çš„ä¸€ç»„é€šä¿¡ç¨‹åºä¼ é€’æ ¼å¼åŒ–çš„æ¶ˆæ¯ã€‚è¿™ç§æ–¹å¼å¯¹åº”ç”¨ç¨‹åºéšè—äº†é€šä¿¡å®ç°çš„ç»†èŠ‚ï¼Œä½¿é€šä¿¡è¿‡ç¨‹å¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ã€‚ æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿä¸­ï¼Œæ ¹æ®æºè¿›ç¨‹å‘ç›®æ ‡è¿›ç¨‹ä¼ é€’æ¶ˆæ¯æ–¹å¼çš„ä¸åŒï¼Œå¯åˆ†ä¸ºç›´æ¥é€šä¿¡æ–¹å¼å’Œé—´æ¥é€šä¿¡æ–¹å¼ã€‚ 1) ç›´æ¥é€šä¿¡æ–¹å¼ã€‚æ“ä½œç³»ç»Ÿåˆ©ç”¨å‘é€ç¨‹åºç›´æ¥æŠŠæ¶ˆæ¯å‘é€ç»™ç›®æ ‡è¿›ç¨‹ã€‚ 2) é—´æ¥é€šä¿¡æ–¹å¼ã€‚è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡éœ€è¦é€šè¿‡ç”¨äºæš‚å­˜æ¶ˆæ¯çš„å…±äº«æ•°æ®ç»“æ„æ¥å®ç°ï¼Œå¦‚ä¿¡ç®±ã€‚è¯¥æ–¹å¼æ—¢å¯ä»¥å®ç°å®æ—¶é€šä¿¡ï¼Œåˆå¯ä»¥å®ç°éå®æ—¶é€šä¿¡ã€‚ 3. ç®¡é“é€šä¿¡ ç®¡é“(Pipeline)æ˜¯è¿æ¥è¯»å†™è¿›ç¨‹çš„ä¸€ä¸ªç‰¹æ®Šæ–‡ä»¶ï¼Œä¹Ÿè¢«ç§°ä¸ºç®¡é“æ–‡ä»¶ã€‚ç®¡é“æ–‡ä»¶å­˜åœ¨äºå¤–å­˜ä¸­ï¼Œå…¶ä¸­çš„æ¶ˆæ¯æ²¡æœ‰å›ºå®šé•¿åº¦ï¼Œèƒ½ç”¨äºè¿›ç¨‹é—´å¤§é‡çš„ä¿¡æ¯é€šä¿¡ã€‚å‘ç®¡é“æä¾›è¾“äººçš„å‘é€è¿›ç¨‹ä»¥å­—ç¬¦æµçš„å½¢å¼å°†å¤§é‡çš„æ•°æ®é€å…¥ç®¡é“ï¼ˆå†™ï¼‰ã€‚æ¥å—ç®¡é“è¾“å‡ºçš„æ¥æ”¶è¿›ç¨‹ï¼Œä»ç®¡é“ä¸­æ¥æ”¶æ•°æ®ï¼ˆè¯»ï¼‰ã€‚ 4. æ¶ˆæ¯ç¼“å†²é˜Ÿåˆ— æ¶ˆæ¯ç¼“å†²é˜Ÿåˆ—æœºåˆ¶å¹¿æ³›ç”¨äºæœ¬åœ°è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚è¯¥æœºåˆ¶åŒ…æ‹¬æ•°æ®ç»“æ„ã€å‘é€åŸè¯­å’Œæ¥æ”¶åŸè¯­ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„æ¶ˆæ¯ç¼“å†²é˜Ÿåˆ—å’Œæ¶ˆæ¯ç¼“å†²åŒºã€‚å‘é€è¿›ç¨‹å‘é€æ¶ˆæ¯æ—¶ï¼Œå…ˆç”³æ¸…ä¸€ä¸ªæ¶ˆæ¯ç¼“å†²åŒºå°†è¦å‘é€çš„æ¶ˆæ¯ä»å‘é€è¿›ç¨‹çš„å‘é€åŒºæ”¾å…¥æ¶ˆæ¯ç¼“å†²åŒºã€‚ç„¶åï¼Œè°ƒç”¨å‘é€åŸè¯­å°†æ¶ˆæ¯å‘é€ç»™æ¥æ”¶è¿›ç¨‹ï¼Œå‘é€åŸè¯­å°†å‘é€ç¼“å†²åŒºæ’å…¥æ¥æ”¶è¿›ç¨‹çš„æ¶ˆæ¯ç¼“å†²é˜Ÿåˆ—ã€‚æ¥æ”¶æ¶ˆæ¯çš„è¿›ç¨‹é€šè¿‡è°ƒç”¨æ¥æ”¶åŸè¯­å°†è¯¥è¿›ç¨‹æ¶ˆæ¯ç¼“å†²é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å¤åˆ¶åˆ°è‡ªå·±çš„æ¶ˆæ¯æ¥æ”¶åŒºã€‚ æ¶ˆæ¯ç¼“å†²åŒºæ˜¯ä¸€ä¸ªç»“æ„å‹æ•°æ®ç»“æ„ã€‚é€šå¸¸åŒ…æ‹¬å‘é€è¿›ç¨‹æ ‡å¿—ç¬¦ã€æ¶ˆæ¯é•¿åº¦ã€æ¶ˆæ¯æ­£æ–‡å’ŒæŒ‡å‘ä¸‹ä¸€ä¸ªæ¶ˆæ¯ç¼“å†²åŒºçš„æŒ‡é’ˆã€‚åœ¨é‡‡ç”¨æ¶ˆæ¯ç¼“å†²é˜Ÿåˆ—çš„ç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹æ§åˆ¶å—ä¸­è¦å¢åŠ æŒ‡å‘æ¶ˆæ¯ç¼“å†²é˜Ÿåˆ—çš„æŒ‡é’ˆã€æ¶ˆæ¯é˜Ÿåˆ—çš„äº’æ–¥ä¿¡å·é‡å’Œæ¶ˆæ¯é˜Ÿåˆ—çš„èµ„æºä¿¡å·é‡ç­‰å­—æ®µã€‚æ¶ˆæ¯ç¼“å†²é˜Ÿåˆ—éœ€è¦è¢«å½“ä½œä¸´ç•Œèµ„æºï¼Œåœ¨å‘é€åŸè¯­å’Œæ¥æ”¶åŸè¯­ä¸­å¯¹æ¶ˆæ¯ç¼“å†²é˜Ÿåˆ—çš„è®¿é—®éœ€è¦è¿›è¡Œäº’æ–¥ä¸åŒæ­¥ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äºŒç« _è¿›ç¨‹ç®¡ç†/ç¬¬å…­èŠ‚_çº¿ç¨‹.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äºŒç« _è¿›ç¨‹ç®¡ç†/ç¬¬å…­èŠ‚_çº¿ç¨‹.html","title":"ç¬¬å…­èŠ‚ çº¿ç¨‹","keywords":"","body":"ç¬¬å…­èŠ‚ çº¿ç¨‹ åœ¨ä¼ ç»Ÿçš„æ“ä½œç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹æ˜¯è¿›è¡Œèµ„æºåˆ†é…å’Œç‹¬ç«‹æ‰§è¡Œçš„åŸºæœ¬å•ä½ã€‚ä¸ºäº†è¿›ä¸€æ­¥æé«˜ç¨‹åºçš„å¹¶å‘æ€§ï¼Œå‡å°‘ç³»ç»Ÿå¼€é”€ï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­å¼•äººäº†çº¿ç¨‹çš„æ¦‚å¿µã€‚ ç”±äºè¿›ç¨‹æ—¢æ˜¯ç‹¬ç«‹æ‰§è¡Œçš„åŸºæœ¬å•ä½ï¼Œåˆæ˜¯èµ„æºæ‹¥æœ‰è€…ï¼Œåœ¨è¿›ç¨‹åˆ›å»ºã€æ’¤é”€å’Œåˆ‡æ¢æ—¶éœ€è¦è¾ƒå¤§çš„æ—¶ç©ºå¼€é”€ã€‚æ‰€ä»¥ï¼Œç³»ç»Ÿä¸­æ‰€è®¾ç½®çš„è¿›ç¨‹æ•°å’Œè¿›ç¨‹åˆ‡æ¢çš„é¢‘ç‡éƒ½å—åˆ°äº†é™åˆ¶ï¼Œå½±å“äº†æ“ä½œç³»ç»Ÿå¹¶å‘ç¨‹åº¦çš„æé«˜ã€‚å¼•å…¥çº¿ç¨‹ä½œä¸ºç‹¬ç«‹è°ƒåº¦å’Œåˆ†æ´¾çš„å•ä½ï¼Œä¸ç‹¬ç«‹æ‹¥æœ‰èµ„æºï¼ˆä»…æœ‰å°‘é‡åŸºæœ¬èµ„æº)ï¼Œè€Œä¸å…¶ä»–çº¿ç¨‹å…±äº«åŒä¸€è¿›ç¨‹çš„èµ„æºï¼Œå‡å°äº†ç³»ç»Ÿçš„æ—¶ç©ºå¼€é”€ã€‚ çº¿ç¨‹çš„å®è´¨æ˜¯æŠŠè¿›ç¨‹çš„ä»»åŠ¡åˆ’åˆ†æˆæ›´å°ã€å…·æœ‰ç‹¬ç«‹åŠŸèƒ½çš„å•ä½ï¼Œä»¥çº¿ç¨‹çš„å½¢å¼æ¥å¹¶å‘æ‰§è¡Œï¼Œä»¥æé«˜ç¨‹åºå¹¶å‘æ‰§è¡Œçš„ç¨‹åº¦ã€‚ ä¸€ã€çº¿ç¨‹çš„æè¿° 1. çº¿ç¨‹çš„æ¦‚å¿µå’Œåˆ†ç±» (1) çº¿ç¨‹çš„æ¦‚å¿µ çº¿ç¨‹æ˜¯è¿›ç¨‹ä¸­çš„ä¸€ä¸ªå®ä½“ï¼Œæ˜¯è¢«ç³»ç»Ÿç‹¬ç«‹è°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½ã€‚çº¿ç¨‹åªæ‹¥æœ‰åœ¨è¿è¡Œä¸­å¿…éœ€çš„èµ„æºï¼ŒåŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨ã€ä¸€ç»„å¯„å­˜å™¨å’Œæ ˆï¼Œä½†å®ƒå¯ä¸åŒå±ä¸€ä¸ªè¿›ç¨‹çš„å…¶ä»–çº¿ç¨‹å…±äº«è¿›ç¨‹æ‰€æ‹¥æœ‰çš„å…¨éƒ¨èµ„æºã€‚ä¸€ä¸ªçº¿ç¨‹å¯ä»¥åˆ›å»ºå’Œæ’¤é”€å¦ä¸€ä¸ªçº¿ç¨‹ã€‚åŒä¸€è¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹å¯ä»¥å¹¶å‘æ‰§è¡Œã€‚çº¿ç¨‹åœ¨è¿è¡Œä¸­å‘ˆç°é—´æ–­æ€§ï¼Œä¹Ÿæœ‰å°±ç»ªã€é˜»å¡å’Œæ‰§è¡Œ3ç§åŸºæœ¬çŠ¶æ€ã€‚ (2)çº¿ç¨‹çš„åˆ†ç±» çº¿ç¨‹çš„å®ç°å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼Œå³ç”¨æˆ·çº§çº¿ç¨‹å’Œå†…æ ¸çº§çº¿ç¨‹ã€‚å†…æ ¸çº§çº¿ç¨‹ä¾èµ–äºå†…æ ¸ï¼Œç”¨æˆ·è¿›ç¨‹å’Œç³»ç»Ÿè¿›ç¨‹ä¸­çš„çº¿ç¨‹ï¼Œå®ƒä»¬çš„åˆ›å»ºã€æ’¤é”€å’Œåˆ‡æ¢éƒ½ç”±å†…æ ¸å®ç°ã€‚åœ¨å†…æ ¸ä¸­ä¸ºçº¿ç¨‹åˆ›å»ºçº¿ç¨‹æ§åˆ¶å—ï¼Œå†…æ ¸æ ¹æ®è¯¥æ§åˆ¶å—æ„ŸçŸ¥çº¿ç¨‹çš„å­˜åœ¨å¹¶å¯¹çº¿ç¨‹è¿›è¡Œæ§åˆ¶ã€‚ ç”¨æˆ·çº§çº¿ç¨‹ä¸ä¾èµ–äºå†…æ ¸ï¼Œç”¨æˆ·çº§çº¿ç¨‹çš„åˆ›å»ºã€æ’¤é”€å’Œåˆ‡æ¢éƒ½ä¸å†…æ ¸æ— å…³ã€‚ ä¸‹é¢ä»ä¸åŒæ–¹é¢å¯¹å†…æ ¸çº§çº¿ç¨‹å’Œç”¨æˆ·çº§çº¿ç¨‹è¿›è¡Œæ¯”è¾ƒã€‚ 1) çº¿ç¨‹çš„è°ƒåº¦ä¸åˆ‡æ¢é€Ÿåº¦ã€‚ å†…æ ¸çº§çº¿ç¨‹çš„è°ƒåº¦ç”±å†…æ ¸çš„çº¿ç¨‹è°ƒåº¦ç¨‹åºå®Œæˆï¼Œç”¨æˆ·çº§çº¿ç¨‹çš„è°ƒåº¦åˆ™ç”±ç”¨æˆ·çº¿ç¨‹åŒ…ä¸­çš„ä¸€ä¸ªè¿‡ç¨‹æ¥å®Œæˆã€‚å†…æ ¸çº§çº¿ç¨‹çš„è°ƒåº¦ç¨‹åºè¿è¡Œåœ¨ç³»ç»Ÿæ€ï¼Œç”¨æˆ·çº§çº¿ç¨‹çš„è°ƒåº¦ç¨‹åºè¿è¡Œåœ¨ç”¨æˆ·æ€ã€‚ å†…æ ¸çº§çº¿ç¨‹çš„è°ƒåº¦è§„åˆ™ä¸è¿›ç¨‹è°ƒåº¦ç›¸ä¼¼ï¼Œç”¨æˆ·çº§çº¿ç¨‹çš„è°ƒåº¦è§„åˆ™ç›¸å¯¹ç®€å•ã€‚å†…æ ¸çº§çº¿ç¨‹ åˆ‡æ¢æ…¢ï¼Œç”¨æˆ·çº§çº¿ç¨‹åˆ‡æ¢å¿«ã€‚ 2) ç³»ç»Ÿè°ƒç”¨ã€‚ å†…æ ¸çº§çº¿ç¨‹è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œåªé˜»å¡è¯¥çº¿ç¨‹ã€‚ç”¨æˆ·çº§çº¿ç¨‹çš„ç³»ç»Ÿè°ƒç”¨ï¼Œè¦é˜»å¡çº¿ç¨‹æ‰€å±çš„ è¿›ç¨‹ã€‚ 3) çº¿ç¨‹æ‰§è¡Œæ—¶é—´çš„åˆ†é…ã€‚ å†…æ ¸çº§çº¿ç¨‹çš„CPUæ—¶é—´ä»¥çº¿ç¨‹ä¸ºå•ä½åˆ†é…ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½å¯ä»¥ç‹¬äº«ä¸€ä¸ªCPUæ—¶é—´ç‰‡ã€‚ç”¨æˆ·çº§çº¿ç¨‹çš„CPUæ—¶é—´ä»¥è¿›ç¨‹ä¸ºå•ä½ï¼ŒåŒä¸€è¿›ç¨‹çš„å¤šä¸ªçº¿ç¨‹å…±äº«ä¸€ä¸ªCPUæ—¶é—´ç‰‡ã€‚ 2. çº¿ç¨‹çš„3ç§åŸºæœ¬çŠ¶æ€ ä¸è¿›ç¨‹ä¸€æ ·ï¼Œçº¿ç¨‹çš„ä¸»è¦çŠ¶æ€æœ‰å°±ç»ªã€è¿è¡Œå’Œé˜»å¡3ç§ã€‚å°±ç»ªæ€æ˜¯çº¿ç¨‹ä¸€æ—¦è·å¾—CPUå°±å¯ä»¥æŠ•å…¥è¿è¡Œçš„çŠ¶æ€ã€‚è¿è¡Œæ€æ˜¯çº¿ç¨‹è·å¾—CPUæ­£åœ¨è¿è¡Œçš„çŠ¶æ€ã€‚é˜»å¡æ€æ˜¯çº¿ç¨‹ç”±äºç­‰å¾…æŸä¸ªäº‹ä»¶çš„å‘ç”Ÿè€Œæš‚åœæ‰§è¡Œçš„çŠ¶æ€ã€‚ çº¿ç¨‹çš„3ç§çŠ¶æ€è½¬æ¢å¦‚å›¾2-19æ‰€ç¤ºã€‚ 3. çº¿ç¨‹æ§åˆ¶å— (1) çº¿ç¨‹æ§åˆ¶å—çš„å®šä¹‰ æ¯ä¸ªçº¿ç¨‹éƒ½ç”±ä¸€ä¸ªæ•°æ®ç»“æ„è¡¨ç¤ºï¼ŒåŒ…æ‹¬å®ƒçš„åŸºæœ¬çŠ¶æ€ã€æ ‡è¯†åŠè®°è´¦ä¿¡æ¯ã€‚è¿™ä¸ªæ•°æ®ç»“æ„å°±æ˜¯çº¿ç¨‹æ§åˆ¶å—(Thread Control Block,TCB)ã€‚TCBè®°å½•äº†æ“ä½œç³»ç»Ÿæ‰€éœ€è¦çš„ã€ç”¨äºæè¿°çº¿ç¨‹æƒ…å†µåŠæ§åˆ¶çº¿ç¨‹è¿è¡Œæ‰€éœ€çš„å…¨éƒ¨ä¿¡æ¯ã€‚ (2) çº¿ç¨‹æ§åˆ¶å—ä¸­çš„ä¿¡æ¯ çº¿ç¨‹æ§åˆ¶å—ä¸­åŒ…å«çš„ä¿¡æ¯æœ‰çº¿ç¨‹æ ‡è¯†ç¬¦ä¿¡æ¯ã€å¤„ç†æœºçŠ¶æ€ä¿¡æ¯ã€çº¿ç¨‹è°ƒåº¦ä¿¡æ¯å’Œçº¿ç¨‹æ§åˆ¶ä¿¡æ¯ã€‚ (3) çº¿ç¨‹æ§åˆ¶å—çš„ç»„ç»‡æ–¹å¼ çº¿ç¨‹æ§åˆ¶å—é€šå¸¸é‡‡ç”¨é“¾æ¥æ–¹å¼æ¥ç»„ç»‡ï¼ŒæŠŠåŒä¸€è¿›ç¨‹ä¸­å…·æœ‰ç›¸åŒçŠ¶æ€çš„TCBç”¨æŒ‡é’ˆé“¾æ¥ æˆé˜Ÿåˆ—ï¼Œå¦‚å›¾2-20æ‰€ç¤ºã€‚ 4. çº¿ç¨‹ä¸è¿›ç¨‹çš„å…³ç³» ç”±äºçº¿ç¨‹ä¸è¿›ç¨‹å¯†åˆ‡ç›¸å…³ï¼Œå¯ä»ä»¥ä¸‹å‡ ä¸ªè§’åº¦æ¥è¯´æ˜çº¿ç¨‹ä¸è¿›ç¨‹çš„å…³ç³»ã€‚ 1) èµ„æºå’Œè°ƒåº¦ã€‚çº¿ç¨‹æ˜¯ç¨‹åºæ‰§è¡Œçš„åŸºæœ¬å•ä½ï¼Œè¿›ç¨‹æ˜¯æ‹¥æœ‰èµ„æºçš„åŸºæœ¬å•ä½ã€‚ 2) åœ°å€ç©ºé—´èµ„æºã€‚ä¸åŒè¿›ç¨‹çš„åœ°å€ç©ºé—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œè€ŒåŒä¸€è¿›ç¨‹ä¸­çš„å„çº¿ç¨‹å…±äº«åŒä¸€åœ°å€ç©ºé—´ã€‚ 3) é€šä¿¡å…³ç³»ã€‚è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡å¿…é¡»ä½¿ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ã€è€ŒåŒä¸€è¿›ç¨‹ä¸­çš„å„çº¿ç¨‹é—´å¯ä»¥é€šè¿‡ç›´æ¥è¯»æˆ–å†™å…¨å±€å˜é‡æ¥è¿›è¡Œé€šä¿¡ï¼Œå…¶è‡³æ— éœ€æ“ä½œç³»ç»Ÿçš„å‚ä¸ã€‚ 4) å¹¶å‘æ€§ã€‚å¤šè¿›ç¨‹ä¹‹é—´å¯ä»¥å¹¶å‘æ‰§è¡Œï¼Œå¤šçº¿ç¨‹ä¹‹é—´ä¹Ÿå¯ä»¥å¹¶å‘æ‰§è¡Œï¼Œè€Œä¸”åŒä¸€è¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹ä¹‹é—´ä¹Ÿå¯å¹¶å‘æ‰§è¡Œã€‚ 5) ç³»ç»Ÿå¼€é”€ã€‚ç”±äºåˆ›å»ºè¿›ç¨‹æˆ–æ’¤é”€è¿›ç¨‹æ—¶ï¼Œç³»ç»Ÿéƒ½è¦ä¸ºä¹‹åˆ†é…æˆ–å›æ”¶èµ„æºï¼Œæ“ä½œç³»ç»Ÿæ‰€ä»˜å‡º çš„å¼€é”€è¿œå¤§äºåˆ›å»ºæˆ–æ’¤é”€çº¿ç¨‹æ—¶çš„å¼€é”€ã€‚åœ¨è¿›è¡Œè¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ï¼Œæ¶‰åŠæ•´ä¸ªå½“å‰è¿›ç¨‹çš„CPUç¯å¢ƒçš„ä¿å­˜åŠæ–°è°ƒåº¦åˆ°è¿›ç¨‹çš„CPUç¯å¢ƒçš„è®¾ç½®ã€‚è€Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ï¼Œåªéœ€ä¿å­˜å’Œè®¾ç½®å°‘é‡å¯„å­˜å™¨å†…å®¹ï¼Œå› æ­¤å¼€é”€å¾ˆå°ã€‚å¦å¤–ï¼Œç”±äºåŒä¸€è¿›ç¨‹å†…çš„å¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œå› æ­¤ï¼ŒåŒä¸€è¿›ç¨‹ä¸­çš„çº¿ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢è¦æ›´å¿«ã€‚ å›¾2-21å’Œå›¾2-22åˆ†åˆ«ä»æ‰§è¡Œçš„è§’åº¦å’Œè¿›ç¨‹ç®¡ç†çš„è§’åº¦æ¥æè¿°çº¿ç¨‹å’Œè¿›ç¨‹çš„å…³ç³»ã€‚ äºŒã€çº¿ç¨‹çš„æ§åˆ¶ çº¿ç¨‹æ§åˆ¶æ˜¯çº¿ç¨‹å®ç°ä¸­æœ€åŸºæœ¬çš„åŠŸèƒ½ã€‚å®ƒåŒ…æ‹¬åˆ›å»ºæ–°çº¿ç¨‹ã€ç»ˆæ­¢çº¿ç¨‹ã€çº¿ç¨‹è°ƒåº¦å’Œçº¿ç¨‹åˆ‡æ¢ï¼Œä»¥åŠçº¿ç¨‹ç”±äºç­‰å¾…æŸä¸ªäº‹ä»¶çš„å‘ç”Ÿè€Œè¢«é˜»å¡ä¸è¯¥äº‹ä»¶å‘ç”Ÿåçº¿ç¨‹è¢«å”¤é†’ã€‚ 1. çº¿ç¨‹åˆ›å»º (1) ç”¨æˆ·çº¿ç¨‹çš„åˆ›å»º ç”¨æˆ·çº¿ç¨‹çš„åˆ›å»ºæ˜¯é€šè¿‡è°ƒç”¨çº¿ç¨‹åº“ä¸­çš„å®ç”¨ç¨‹åºå®Œæˆçš„ã€‚åˆ›å»ºçº¿ç¨‹çš„å®ç”¨ç¨‹åºä¸ºæ–°çº¿ç¨‹ç”³è¯·ç©ºç™½çº¿ç¨‹æ§åˆ¶å—ï¼Œå¹¶åˆå§‹åŒ–çº¿ç¨‹æ§åˆ¶å—ï¼Œç„¶åå°†æ–°çº¿ç¨‹æ’å…¥å…¶æ‰€å±è¿›ç¨‹çš„å°±ç»ªçº¿ç¨‹é˜Ÿåˆ—ã€‚ (2) å†…æ ¸çº¿ç¨‹çš„åˆ›å»º å†…æ ¸çº¿ç¨‹çš„åˆ›å»ºæ˜¯ç”±å†…æ ¸å®Œæˆçš„ã€‚å†…æ ¸ä¸ºæ–°çº¿ç¨‹ç”³è¯·ç©ºç™½çº¿ç¨‹æ§åˆ¶å—ï¼Œå¹¶åˆå§‹åŒ–çº¿ç¨‹æ§åˆ¶å—ï¼Œç„¶åå°†æ–°çº¿ç¨‹æ’å…¥å…¶æ‰€å±è¿›ç¨‹çš„å°±ç»ªçº¿ç¨‹é˜Ÿåˆ—ã€‚ 2.çº¿ç¨‹çš„ç»ˆæ­¢ (1) å¼•èµ·çº¿ç¨‹ç»ˆæ­¢çš„åŸå›  1) æ­£å¸¸ç»“æŸã€‚ 2) å¼‚å¸¸ç»“æŸã€‚ 3) å¤–ç•Œå¹²é¢„ (2)çº¿ç¨‹çš„ç»ˆæ­¢è¿‡ç¨‹ å¦‚æœç³»ç»Ÿå‘ç”Ÿäº†ä¸Šè¿°è¦æ±‚ç»ˆæ­¢çº¿ç¨‹çš„äº‹ä»¶ï¼Œç”¨æˆ·çº¿ç¨‹ç”±çº¿ç¨‹åº“çš„å®ç”¨ç¨‹åºæ¥è°ƒç”¨çº¿ç¨‹ç»ˆæ­¢åŸè¯­ï¼Œè€Œå†…æ ¸çº¿ç¨‹ç”±å†…æ ¸æ¥è°ƒç”¨çº¿ç¨‹ç»ˆæ­¢åŸè¯­ï¼Œç„¶åæŒ‰ä¸‹åˆ—è¿‡ç¨‹ç»ˆæ­¢æŒ‡å®šçš„çº¿ç¨‹ã€‚ 1) æ ¹æ®è¢«ç»ˆæ­¢çº¿ç¨‹çš„æ ‡è¯†ç¬¦ï¼Œä»TCBé›†åˆä¸­æ£€ç´¢å‡ºè¯¥çº¿ç¨‹çš„TCB,ä»ä¸­è¯»å‡ºè¯¥çº¿ç¨‹çš„çŠ¶æ€ã€‚ 2) è‹¥è¢«ç»ˆæ­¢çº¿ç¨‹æ­£å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œåº”ç«‹å³ç»ˆæ­¢è¯¥çº¿ç¨‹çš„æ‰§è¡Œï¼Œå¹¶ç½®è°ƒåº¦æ ‡å¿—ä¸ºçœŸï¼Œç”¨äºæŒ‡ç¤ºè¯¥çº¿ç¨‹è¢«ç»ˆæ­¢ååº”é‡æ–°æ‰§è¡Œçº¿ç¨‹è°ƒåº¦ç¨‹åºã€‚ 3) å°†è¢«ç»ˆæ­¢çº¿ç¨‹çš„TCBä»æ‰€åœ¨é˜Ÿåˆ—ï¼ˆæˆ–é“¾è¡¨ï¼‰ä¸­ç§»å‡ºï¼Œç­‰å¾…å…¶ä»–ç¨‹åºæ¥æœé›†ä¿¡æ¯ã€‚ 3. çº¿ç¨‹çš„è°ƒåº¦ä¸åˆ‡æ¢ (1) ç”¨æˆ·çº¿ç¨‹çš„è°ƒåº¦ä¸åˆ‡æ¢ ç”±äºå†…æ ¸æ²¡æœ‰æ„è¯†åˆ°ç”¨æˆ·çº¿ç¨‹çš„å­˜åœ¨ï¼Œæ‰€ä»¥å†…æ ¸ç»§ç»­ä»¥è¿›ç¨‹ä¸ºå•ä½è¿›è¡Œè°ƒåº¦ï¼Œå¹¶ä¸”ç»™è¯¥è¿›ç¨‹æŒ‡å®šä¸€ä¸ªçŠ¶æ€ï¼ˆå°±ç»ªã€è¿è¡Œæˆ–é˜»å¡ç­‰ï¼‰ã€‚ç”¨æˆ·çº¿ç¨‹çš„è°ƒåº¦åœ¨åº”ç”¨ç¨‹åºå†…éƒ¨è¿›è¡Œï¼Œé€šå¸¸é‡‡ç”¨éæŠ¢å å¼å’Œæ›´ç®€å•çš„è§„åˆ™ï¼Œå¦‚æ—¶é—´ç‰‡è½®è½¬è§„åˆ™ï¼Œä¹Ÿæ— éœ€ç”¨æˆ·æ¨¡å¼å’Œå†…æ ¸æ¨¡å¼ä¹‹é—´çš„åˆ‡æ¢ï¼Œæ‰€ä»¥é€Ÿåº¦ç‰¹åˆ«å¿«ã€‚è°ƒåº¦ç®—æ³•å¯ä»¥æ˜¯åº”ç”¨ç¨‹åºä¸“ç”¨çš„ï¼Œå¯ä»¥å»é€‚åº”åº”ç”¨ç¨‹åºè€Œä¸ä¼šæ‰°ä¹±åº•å±‚çš„æ“ä½œç³»ç»Ÿè°ƒåº¦ç¨‹åºã€‚CPUæ—¶é—´ç‰‡åˆ†é…ç»™è¿›ç¨‹ï¼Œå½“è¿›ç¨‹å†…æœ‰å¤šä¸ªçº¿ç¨‹æ—¶ï¼Œæ¯ä¸ªçº¿ç¨‹çš„æ‰§è¡Œæ—¶é—´ç›¸å¯¹è¾ƒå°‘ã€‚ ä¸€ä¸ªå¤šç”¨æˆ·çº¿ç¨‹çš„åº”ç”¨ç¨‹åºä¸èƒ½å……åˆ†åˆ©ç”¨å¤šCPUæŠ€æœ¯ã€‚å†…æ ¸ä¸€æ¬¡åªæŠŠä¸€ä¸ªCPUåˆ†é…ç»™ä¸€ä¸ªè¿›ç¨‹ï¼Œå› æ­¤ä¸€ä¸ªè¿›ç¨‹ä¸­åªæœ‰ä¸€ä¸ªç”¨æˆ·çº¿ç¨‹å¯ä»¥æ‰§è¡Œï¼Œæ— æ³•äº«ç”¨å¤šCPUå¸¦æ¥çš„å¥½å¤„ã€‚ ç”±äºæ‰€æœ‰çº¿ç¨‹ç®¡ç†æ•°æ®ç»“æ„éƒ½åœ¨ä¸€ä¸ªè¿›ç¨‹çš„ç”¨æˆ·åœ°å€ç©ºé—´ä¸­ï¼Œçº¿ç¨‹åˆ‡æ¢ä¸éœ€è¦å†…æ ¸æ¨¡å¼ç‰¹æƒï¼Œæ‰€ä»¥ä¹Ÿä¸éœ€è¦ç”¨æˆ·æ¨¡å¼å’Œå†…æ ¸æ¨¡å¼ä¹‹é—´çš„åˆ‡æ¢ï¼ŒèŠ‚çœäº†ä¸¤ç§æ¨¡å¼é—´åˆ‡æ¢çš„å¼€é”€ã€‚ (2)å†…æ ¸çº¿ç¨‹çš„è°ƒåº¦ä¸åˆ‡æ¢ å†…æ ¸çº¿ç¨‹ç”±å†…æ ¸æ¥ç»´æŠ¤å…¶ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè°ƒåº¦æ˜¯ç”±å†…æ ¸ä»¥çº¿ç¨‹ä¸ºå•ä½è¿›è¡Œçš„ã€‚å†…æ ¸çº¿ç¨‹çš„è°ƒåº¦å’Œåˆ‡æ¢éƒ½éœ€è¦ç”¨æˆ·æ¨¡å¼å’Œå†…æ ¸æ¨¡å¼ä¹‹é—´çš„åˆ‡æ¢ã€‚ è°ƒåº¦å¯ä»¥ä¸ºä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¤šä¸ªå†…æ ¸çº¿ç¨‹åˆ†é…å¤šä¸ªCPU,ä½¿å¤šä¸ªå†…æ ¸çº¿ç¨‹è¾¾åˆ°å¹¶è¡Œã€‚ 4. çº¿ç¨‹çš„é˜»å¡ä¸å”¤é†’ (1) å¼•èµ·çº¿ç¨‹é˜»å¡çš„äº‹ä»¶ 1) è¯·æ±‚ç³»ç»ŸæœåŠ¡ã€‚å½“è¿è¡Œæ€çº¿ç¨‹è¯·æ±‚æ“ä½œç³»ç»Ÿæä¾›æœåŠ¡æ—¶ï¼Œç”±äºæŸç§åŸå› ï¼Œæ“ä½œç³»ç»Ÿå¹¶ä¸ç«‹å³æ»¡è¶³è¯¥çº¿ç¨‹çš„è¦æ±‚ï¼Œè¯¥çº¿ç¨‹åªèƒ½è¢«é˜»å¡ã€‚ 2) å¯åŠ¨æŸç§æ“ä½œã€‚å½“çº¿ç¨‹å¯åŠ¨æŸç§æ“ä½œåï¼Œå¦‚æœè¯¥çº¿ç¨‹å¿…é¡»åœ¨è¯¥æ“ä½œå®Œæˆä¹‹åæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œåˆ™å¿…é¡»å…ˆå°†è¯¥çº¿ç¨‹é˜»å¡ï¼Œä»¥ç­‰å¾…è¯¥æ“ä½œå®Œæˆã€‚ 3) æ–°æ•°æ®å°šæœªåˆ°è¾¾ã€‚å¯¹äºç›¸äº’åˆä½œçš„çº¿ç¨‹ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹å…ˆè·å¾—å¦ä¸€ä¸ªçº¿ç¨‹æä¾› çš„æ•°æ®æ‰èƒ½è¿è¡Œä»¥å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œåˆ™åªè¦å…¶æ‰€éœ€æ•°æ®å°šæœªåˆ°è¾¾ï¼Œè¯¥çº¿ç¨‹åªèƒ½è¢«é˜»å¡ã€‚ (2) ç”¨æˆ·çº¿ç¨‹çš„é˜»å¡ä¸å”¤é†’ å¦‚æœè¿›ç¨‹ä¸­çš„ä¸€ä¸ªç”¨æˆ·çº¿ç¨‹è¢«é˜»å¡ï¼Œåˆ™æ•´ä¸ªè¿›ç¨‹éƒ½å¿…é¡»ç­‰å¾…ï¼Œå³ä½¿è¿˜æœ‰å…¶ä»–ç”¨æˆ·çº¿ç¨‹å¯ ä»¥åœ¨åº”ç”¨ç¨‹åºå†…è¿è¡Œã€‚ æ­£åœ¨æ‰§è¡Œçš„ç”¨æˆ·çº¿ç¨‹ï¼Œå½“éœ€è¦ç­‰å¾…æŸäº‹ä»¶çš„å‘ç”Ÿæ—¶ï¼Œè¯¥çº¿ç¨‹ä¾¿è°ƒç”¨çº¿ç¨‹é˜»å¡åŸè¯­æŠŠè‡ªå·± é˜»å¡ï¼Œè¯¥çº¿ç¨‹æ‰€å±çš„è¿›ç¨‹ä¹Ÿè°ƒç”¨è¿›ç¨‹é˜»å¡åŸè¯­æŠŠè‡ªå·±é˜»å¡ã€‚ç”¨æˆ·çº¿ç¨‹çš„é˜»å¡è¿‡ç¨‹å¦‚ä¸‹ã€‚ 1) åœæ­¢è¯¥çº¿ç¨‹çš„æ‰§è¡Œï¼Œå°†è¯¥çº¿ç¨‹çš„çŠ¶æ€æ”¹ä¸ºé˜»å¡æ€ã€‚ 2) å°†è¯¥çº¿ç¨‹æ§åˆ¶å—æ’å…¥ç›¸åº”çš„çº¿ç¨‹é˜»å¡é˜Ÿåˆ—ã€‚ 3) å°†è¯¥çº¿ç¨‹æ‰€å±è¿›ç¨‹çš„çŠ¶æ€æ”¹ä¸ºé˜»å¡æ€ã€‚ 4) å°†è¯¥çº¿ç¨‹æ‰€å±è¿›ç¨‹çš„è¿›ç¨‹æ§åˆ¶å—æ’å…¥ç›¸åº”çš„è¿›ç¨‹é˜»å¡é˜Ÿåˆ—ã€‚ 5) å°†æ§åˆ¶ä¼ é€’ç»™è¿›ç¨‹è°ƒåº¦ç¨‹åºï¼Œé‡æ–°è¿›è¡Œè¿›ç¨‹è°ƒåº¦ã€‚ å½“è¢«é˜»å¡çš„çº¿ç¨‹æ‰€ç­‰å¾…çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œåˆ™ç”±æœ‰å…³è¿›ç¨‹å”¤é†’åŸè¯­å°†è¯¥çº¿ç¨‹æ‰€å±çš„è¿›ç¨‹å”¤ é†’ï¼Œç„¶åç”±æœ‰å…³çº¿ç¨‹å”¤é†’åŸè¯­å°†è¯¥çº¿ç¨‹å”¤é†’ã€‚ç”¨æˆ·çº¿ç¨‹çš„å”¤é†’è¿‡ç¨‹å¦‚ä¸‹ã€‚ 1) å°†è¯¥çº¿ç¨‹æ‰€å±è¿›ç¨‹çš„çŠ¶æ€ç”±é˜»å¡æ”¹ä¸ºå°±ç»ªã€‚ 2) å°†è¯¥çº¿ç¨‹æ‰€å±è¿›ç¨‹çš„è¿›ç¨‹æ§åˆ¶å—ä»è¿›ç¨‹é˜»å¡é˜Ÿåˆ—ä¸­ç§»å‡ºã€‚ 3) å°†è¯¥çº¿ç¨‹æ‰€å±è¿›ç¨‹çš„è¿›ç¨‹æ§åˆ¶å—æ’å…¥è¿›ç¨‹å°±ç»ªé˜Ÿåˆ—ã€‚ 4) å°†è¯¥çº¿ç¨‹çŠ¶æ€ç”±é˜»å¡æ”¹ä¸ºå°±ç»ªã€‚ 5) å°†è¯¥çº¿ç¨‹çš„çº¿ç¨‹æ§åˆ¶å—ä»çº¿ç¨‹é˜»å¡é˜Ÿåˆ—ä¸­ç§»å‡ºã€‚ 6) å°†è¯¥çº¿ç¨‹çš„çº¿ç¨‹æ§åˆ¶å—æ’äººçº¿ç¨‹å°±ç»ªé˜Ÿåˆ—ã€‚ (3) å†…æ ¸çº¿ç¨‹çš„é˜»å¡ä¸å”¤é†’ å¦‚æœè¿›ç¨‹ä¸­çš„ä¸€ä¸ªå†…æ ¸çº¿ç¨‹è¢«é˜»å¡ï¼Œå†…æ ¸å¯ä»¥è°ƒåº¦åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„å¦ä¸€ä¸ªå†…æ ¸çº¿ç¨‹è¿è¡Œã€‚ æ­£åœ¨æ‰§è¡Œçš„å†…æ ¸çº¿ç¨‹ï¼Œå½“éœ€è¦ç­‰å¾…æŸäº‹ä»¶çš„å‘ç”Ÿæ—¶ï¼Œè¯¥çº¿ç¨‹ä¾¿è°ƒç”¨çº¿ç¨‹é˜»å¡åŸè¯­è¿›è¡Œè‡ªæˆ‘é˜»å¡ã€‚å†…æ ¸çº¿ç¨‹çš„é˜»å¡è¿‡ç¨‹å¦‚ä¸‹ã€‚ 1) åœæ­¢è¯¥çº¿ç¨‹çš„æ‰§è¡Œï¼Œå°†è¯¥çº¿ç¨‹çš„çŠ¶æ€æ”¹ä¸ºé˜»å¡æ€ã€‚ 2) å°†è¯¥çº¿ç¨‹æ§åˆ¶å—æ’å…¥ç›¸åº”çš„çº¿ç¨‹é˜»å¡é˜Ÿåˆ—ã€‚ 3) å°†æ§åˆ¶ä¼ é€’ç»™çº¿ç¨‹è°ƒåº¦ç¨‹åºï¼Œé‡æ–°è¿›è¡Œçº¿ç¨‹è°ƒåº¦ã€‚ å½“è¢«é˜»å¡çš„çº¿ç¨‹æ‰€ç­‰å¾…çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œåˆ™ç”±æœ‰å…³çº¿ç¨‹å”¤é†’åŸè¯­å°†è¯¥çº¿ç¨‹å”¤é†’ã€‚å†…æ ¸çº¿ç¨‹ çš„å”¤é†’è¿‡ç¨‹å¦‚ä¸‹ã€‚ 1) å°†è¯¥çº¿ç¨‹çŠ¶æ€ç”±é˜»å¡æ€æ”¹ä¸ºå°±ç»ªæ€ã€‚ 2) å°†è¯¥çº¿ç¨‹çš„çº¿ç¨‹æ§åˆ¶å—ä»çº¿ç¨‹é˜»å¡é˜Ÿåˆ—ä¸­ç§»å‡ºã€‚ 3) å°†è¯¥çº¿ç¨‹çš„çº¿ç¨‹æ§åˆ¶å—æ’äººçº¿ç¨‹å°±ç»ªé˜Ÿåˆ—ã€‚ é˜»å¡å’Œå”¤é†’æ˜¯ä¸€å¯¹ä½œç”¨ç›¸åçš„åŸè¯­ï¼Œå› æ­¤ï¼Œå¦‚æœåœ¨æŸçº¿ç¨‹ä¸­è°ƒç”¨äº†é˜»å¡åŸè¯­ï¼Œåˆ™å¿…é¡»åœ¨ä¸ä¹‹ç›¸åˆä½œçš„å¦ä¸€ä¸ªçº¿ç¨‹æˆ–å…¶ä»–ç›¸å…³çš„çº¿ç¨‹ä¸­å®‰æ’å”¤é†’åŸè¯­ï¼Œç”¨äºå”¤é†’é˜»å¡çº¿ç¨‹ã€‚ ä¸‰ã€çº¿ç¨‹çš„åŒæ­¥ ä¸€ä¸ªè¿›ç¨‹ä¸­çš„æ‰€æœ‰çº¿ç¨‹å…±äº«åŒä¸€ä¸ªåœ°å€ç©ºé—´å’Œè¯¸å¦‚æ‰“å¼€çš„æ–‡ä»¶ä¹‹ç±»çš„å…¶ä»–èµ„æºã€‚ä¸€ä¸ªçº¿ç¨‹å¯¹èµ„æºçš„ä»»ä½•ä¿®æ”¹éƒ½ä¼šå½±å“åŒä¸€ä¸ªè¿›ç¨‹ä¸­å…¶ä»–çº¿ç¨‹çš„ç¯å¢ƒã€‚å› æ­¤ï¼Œéœ€è¦å¯¹å„ç§çº¿ç¨‹çš„æ´»åŠ¨è¿›è¡ŒåŒæ­¥ï¼Œä¿è¯è¯¸çº¿ç¨‹ä»¥äº’æ–¥çš„æ–¹å¼è®¿é—®ä¸´ç•Œèµ„æºï¼Œä»¥ä¾¿å®ƒä»¬äº’ä¸å¹²æ‰°ä¸”ä¸ç ´åæ•°æ®ç»“æ„ã€çº¿ç¨‹åŒæ­¥çš„æœºåˆ¶æœ‰åŸè¯­æ“ä½œå’Œä¿¡å·é‡æœºåˆ¶ã€‚ å››ã€çº¿ç¨‹é€šä¿¡ çº¿ç¨‹é€šä¿¡æ˜¯æŒ‡çº¿ç¨‹ä¹‹é—´çš„ä¿¡æ¯äº¤æ¢ã€‚ç”±äºåŒä¸€è¿›ç¨‹ä¸­çº¿ç¨‹é—´å…±äº«å†…å­˜å’Œæ–‡ä»¶èµ„æºï¼Œå„çº¿ç¨‹é—´å¯ä»¥é€šè¿‡ç›´æ¥è¯»/å†™å…¨å±€å˜é‡æ¥è¿›è¡Œé€šä¿¡ï¼Œç”šè‡³æ— éœ€æ“ä½œç³»ç»Ÿå†…æ ¸çš„å‚ä¸ã€‚å¯¹äºä¸åŒè¿›ç¨‹çš„çº¿ç¨‹é—´é€šä¿¡ï¼Œåˆ™å¿…é¡»ä½¿ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„çº¿ç¨‹é—´é€šä¿¡æœºåˆ¶ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬ä¸‰ç« _è¿›ç¨‹è°ƒåº¦ä¸æ­»é”/ç¬¬ä¸€èŠ‚_è¿›ç¨‹è°ƒåº¦çš„åŠŸèƒ½ä¸æ—¶æœº.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬ä¸‰ç« _è¿›ç¨‹è°ƒåº¦ä¸æ­»é”/ç¬¬ä¸€èŠ‚_è¿›ç¨‹è°ƒåº¦çš„åŠŸèƒ½ä¸æ—¶æœº.html","title":"ç¬¬ä¸€ã€äºŒèŠ‚ è¿›ç¨‹è°ƒåº¦çš„åŠŸèƒ½ä¸æ—¶æœºã€ç®—æ³•","keywords":"","body":"ç¬¬ä¸‰ç«  è¿›ç¨‹è°ƒåº¦ä¸æ­»é” å½“å¤šä¸ªè¿›ç¨‹åœ¨ç³»ç»Ÿä¸­å¹¶å‘æ‰§è¡Œæ—¶ï¼Œæ‰€æœ‰è¿›ç¨‹å…±äº«CPUã€‚å½“æŸä¸€CPUä¸Šè¿è¡Œçš„è¿›ç¨‹å› é˜»å¡æˆ–è¿›ç¨‹è¿è¡Œç»“æŸè€Œä½¿CPUå¯ä»¥åˆ†é…ç»™å…¶ä»–è¿›ç¨‹ä½¿ç”¨æ—¶ï¼Œå¦‚ä½•ä»ä¼—å¤šå°±ç»ªçš„å¯è¿è¡Œè¿›ç¨‹ä¸­é€‰æ‹©ä¸€ä¸ªè¿›ç¨‹ï¼Œå°†C PUåˆ†é…ç»™è¯¥è¿›ç¨‹ï¼Œä½¿ç³»ç»Ÿæœ‰æ•ˆè¿è¡Œï¼Œæ˜¯å¤šä»»åŠ¡æ“ä½œç³»ç»Ÿå¿…é¡»è§£å†³çš„é—®é¢˜ä¹‹ä¸€ã€‚æœ¬ç« ä»‹ç»è¿›ç¨‹è°ƒåº¦çš„ç®—æ³•ï¼Œä»¥åŠé€‰æ‹©è¿›ç¨‹è°ƒåº¦ç®—æ³•çš„åŸåˆ™ã€‚ åœ¨å¤šä»»åŠ¡ç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹å…±äº«ç³»ç»Ÿèµ„æºï¼Œå½“å¤šä¸ªè¿›ç¨‹ç«äº‰æœ‰é™çš„å…±äº«èµ„æºæ—¶ä¼šå‘ç”Ÿè¿›ç¨‹æ— é™é˜»å¡ï¼Œä¸èƒ½ç»§ç»­è¿è¡Œçš„åƒµæ­»çŠ¶æ€ï¼Œå³æœ¬ç« æ‰€è¿°çš„è¿›ç¨‹æ­»é”é—®é¢˜ã€‚æ­»é”å‘ç”Ÿçš„åŸå› å’Œè§£å†³æ­»é”çš„æ–¹å¼æ˜¯æœ¬ç« é˜è¿°çš„å¦ä¸€ä¸ªé‡è¦çŸ¥è¯†ç‚¹ã€‚ ç¬¬ä¸€èŠ‚ è¿›ç¨‹è°ƒåº¦çš„åŠŸèƒ½ä¸æ—¶æœº ä¸€ã€è¿›ç¨‹è°ƒåº¦çš„åŠŸèƒ½ è¿›ç¨‹è°ƒåº¦åŠŸèƒ½ç”±æ“ä½œç³»ç»Ÿå†…æ ¸çš„è¿›ç¨‹è°ƒåº¦ç¨‹åºå®Œæˆï¼Œåœ¨Liuxå†…æ ¸ä¸­ï¼Œè¿›ç¨‹è°ƒåº¦åŠŸèƒ½çš„ å®ç°ä»è°ƒç”¨å†…æ ¸å‡½æ•°schedule()å¼€å§‹ã€‚è¿›ç¨‹è°ƒåº¦çš„åŠŸèƒ½æ˜¯æŒ‰ç…§æŸç§ç­–ç•¥å’Œç®—æ³•ä»å°±ç»ªæ€è¿›ç¨‹ (åœ¨Linuxä¸­æ˜¯å¯æ‰§è¡Œè¿›ç¨‹)ä¸­ä¸ºå½“å‰ç©ºé—²çš„CPUé€‰æ‹©åœ¨å…¶ä¸Šè¿è¡Œçš„æ–°è¿›ç¨‹ã€‚åœ¨åç»­ç« èŠ‚ä¸­å°†é˜è¿°è¿›ç¨‹è°ƒåº¦çš„ç­–ç•¥å’Œç®—æ³•ã€‚ äºŒã€è¿›ç¨‹è°ƒåº¦çš„æ—¶æœº å½“ä¸€ä¸ªè¿›ç¨‹è¿è¡Œç»“æŸï¼ˆåŒ…æ‹¬æ­£å¸¸ç»“æŸå’Œå¼‚å¸¸ç»“æŸï¼‰ã€è¿›ç¨‹é˜»å¡ã€ä¸­æ–­è¿”å›ã€åœ¨æ”¯æŒæŠ¢å å¼è°ƒåº¦çš„ç³»ç»Ÿä¸­æœ‰æ¯”å½“å‰è¿è¡Œè¿›ç¨‹ä¼˜å…ˆçº§æ›´é«˜çš„è¿›ç¨‹åˆ°æ¥ã€å½“å‰è¿è¡Œè¿›ç¨‹çš„æ—¶é—´ç‰‡ç”¨å®Œæ—¶ï¼Œç³»ç»Ÿéƒ½ä¼šé€šè¿‡æ‰§è¡Œè¿›ç¨‹è°ƒåº¦ç¨‹åºé‡æ–°è¿›è¡Œè¿›ç¨‹è°ƒåº¦ã€‚ ç¬¬äºŒèŠ‚ è¿›ç¨‹è°ƒåº¦ç®—æ³• è¿›ç¨‹è°ƒåº¦ç®—æ³•æ˜¯æŒ‡ä»å°±ç»ªæ€è¿›ç¨‹ä¸­é€‰æ‹©ä¸€ä¸ªæˆ–å‡ ä¸ªè¿›ç¨‹ä¸ºå…¶åˆ†é…CPUï¼Œä½¿å…¶è¿›äººæ‰§è¡Œæ€çš„ç®—æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´è¿›ç¨‹è°ƒåº¦ç®—æ³•è¦â€œå†³å®šâ€æŠŠCPUåˆ†é…ç»™å°±ç»ªé˜Ÿåˆ—ä¸­çš„å“ªä¸ªè¿›ç¨‹ã€‚è¿›ç¨‹è°ƒåº¦ç”±æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­çš„è¿›ç¨‹è°ƒåº¦ç¨‹åºå®Œæˆã€‚ ä¸€ã€é€‰æ‹©è°ƒåº¦æ–¹å¼å’Œç®—æ³•çš„è‹¥å¹²å‡†åˆ™ ä¸åŒçš„è°ƒåº¦ç®—æ³•æœ‰ä¸åŒçš„ç‰¹ç‚¹ï¼Œä¸ºäº†æ ¹æ®ç‰¹æ®Šåº”ç”¨é¢†åŸŸçš„è¦æ±‚é€‰æ‹©åˆé€‚çš„è°ƒåº¦ç®—æ³•ï¼Œå¯ä»¥ä¸‹é¢çš„å‡†åˆ™ä½œä¸ºé€‰æ‹©ä¾æ®ã€‚ 1. å‘¨è½¬æ—¶é—´çŸ­ å‘¨è½¬æ—¶é—´æ˜¯æŒ‡ä»ä½œä¸šè¢«æäº¤ç»™ç³»ç»Ÿå¼€å§‹åˆ°ä½œä¸šå®Œæˆä¸ºæ­¢çš„è¿™æ®µæ—¶å›é—´éš”ã€‚å®ƒåŒ…æ‹¬4éƒ¨åˆ†æ—¶é—´ï¼šä½œä¸šåœ¨å¤–å­˜åå¤‡é˜Ÿåˆ—ä¸Šç­‰å¾…è°ƒåº¦çš„æ—¶é—´ï¼Œè¿›ç¨‹åœ¨å°±ç»ªé˜Ÿåˆ—ä¸Šç­‰å¾…è¿›ç¨‹è°ƒåº¦çš„æ—¶é—´ï¼Œè¿›ç¨‹åœ¨CPUä¸Šæ‰§è¡Œçš„æ—¶é—´ï¼Œä»¥åŠè¿›ç¨‹ç­‰å¾…I/Oæ“ä½œå®Œæˆçš„æ—¶é—´ã€‚ å¯¹æ¯ä¸ªç”¨æˆ·è€Œè¨€ï¼Œéƒ½å¸Œæœ›è‡ªå·±çš„ä½œä¸šå‘¨è½¬æ—¶é—´å°½å¯èƒ½çŸ­ã€‚è€Œè®¡ç®—æœºç³»ç»Ÿçš„è®¾è®¡è€…å’Œç®¡ç†è€…ä½¿ç”¨å¹³å‡å‘¨è½¬æ—¶é—´å’Œå¸¦æƒå¹³å‡å‘¨è½¬æ—¶é—´æ¥è¡¡é‡ç³»ç»Ÿçš„æ—¶é—´æ€§èƒ½ã€‚ å¦‚æœç³»ç»Ÿä¸­æœ‰nä¸ªä½œä¸šï¼Œç³»ç»Ÿçš„å¹³å‡å‘¨è½¬æ—¶é—´Tç­‰äºnä¸ªä½œä¸šçš„å‘¨è½¬æ—¶é—´ä¹‹å’Œé™¤ä»¥nã€‚å…¶è¡¨è¾¾å¼å¦‚å¼(3-1)æ‰€ç¤ºã€‚ ä½œä¸šçš„å‘¨è½¬æ—¶é—´Tä¸ç³»ç»Ÿä¸ºå®ƒæä¾›çš„æœåŠ¡æ—¶é—´Tsä¹‹æ¯”ä¸ºWï¼ŒW=T/Tsï¼Œè¢«ç§°ä¸ºå¸¦æƒå‘¨è½¬æ—¶é—´ï¼Œnä¸ªä½œä¸šçš„å¹³å‡å¸¦æƒå‘¨è½¬æ—¶é—´è¡¨è¾¾å¼å¦‚å¼(3-2)æ‰€ç¤ºã€‚ æœåŠ¡æ—¶é—´Ts,æ˜¯ä¸€ä¸ªä½œä¸šåœ¨CPUä¸Šæ‰§è¡Œçš„æ€»æ—¶é—´ã€‚ 2. å“åº”æ—¶é—´å¿« å“åº”æ—¶é—´æ˜¯æŒ‡ä»ç”¨æˆ·æäº¤ä¸€ä¸ªè¯·æ±‚å¼€å§‹ç›´è‡³ç³»ç»Ÿé¦–æ¬¡äº§ç”Ÿå“åº”çš„æ—¶é—´ä¸ºæ­¢çš„ä¸€æ®µæ—¶é—´ï¼Œå®ƒåŒ…æ‹¬3éƒ¨åˆ†æ—¶é—´ï¼šä»è¾“å…¥è®¾å¤‡ï¼ˆå¦‚é”®ç›˜ã€é¼ æ ‡ç­‰ï¼‰è¾“å…¥çš„è¯·æ±‚ä¿¡æ¯ä¼ é€åˆ°å¤„ç†æœºçš„æ—¶é—´ã€å¤„ç†æœºå¯¹è¯·æ±‚ä¿¡æ¯è¿›è¡Œå¤„ç†çš„æ—¶é—´ï¼Œä»¥åŠå°†æ‰€å½¢æˆçš„å“åº”ä¿¡æ¯å›é€åˆ°ç»ˆç«¯æ˜¾ç¤ºå™¨çš„æ—¶é—´ã€‚å¯¹äºäº¤äº’å¼ç³»ç»Ÿï¼Œå“åº”æ—¶é—´æ˜¯è¡¡é‡ç³»ç»Ÿæ—¶é—´æ€§èƒ½çš„é‡è¦æŒ‡æ ‡ã€‚è¿›ç¨‹è°ƒåº¦ç®—æ³•å’Œè¾“å…¥/è¾“å‡ºè®¾å¤‡çš„é€Ÿåº¦éƒ½ä¼šå½±å“ç³»ç»Ÿçš„å“åº”æ—¶é—´ã€‚ 3. æˆªæ­¢æ—¶é—´çš„ä¿è¯ æˆªæ­¢æ—¶é—´æ˜¯æŒ‡æŸä¸ªä»»åŠ¡å¿…é¡»å¼€å§‹æ‰§è¡Œçš„æœ€è¿Ÿæ—¶é—´ï¼Œæˆ–å¿…é¡»å®Œæˆçš„æœ€è¿Ÿæ—¶é—´ã€‚æˆªæ­¢æ—¶é—´æ˜¯è¯„ä»·å®æ—¶ç³»ç»Ÿæ€§èƒ½çš„é‡è¦æŒ‡æ ‡ã€‚åœ¨å®æ—¶ç³»ç»Ÿä¸­ï¼Œè‹¥å®æ—¶ä»»åŠ¡çš„å¼€å§‹æˆªæ­¢æ—¶é—´æˆ–å®Œæˆæˆªæ­¢æ—¶é—´ä¸èƒ½å¾—åˆ°ä¿éšœï¼Œå®æ—¶ç³»ç»Ÿçš„å¯é æ€§å°±æ— æ³•ä¿è¯ã€‚å› ä¸ºå®æ—¶ç³»ç»Ÿè®¡ç®—çš„æ­£ç¡®æ€§ä¸ä»…å–å†³äºè®¡ç®—çš„é€»è¾‘ç»“æœçš„æ­£ç¡®æ€§ï¼Œè€Œä¸”å–å†³äºå¾—åˆ°è®¡ç®—ç»“æœçš„æ—¶é—´ã€‚å®æ—¶ç³»ç»Ÿå¿…é¡»é‡‡å–ç‰¹æ®Šçš„è°ƒåº¦ç­–ç•¥å’Œè°ƒåº¦ç®—æ³•æ¥æ»¡è¶³å¯¹æˆªæ­¢æ—¶é—´çš„è¦æ±‚ã€‚ 4. ç³»ç»Ÿååé‡é«˜ ååé‡æ˜¯æŒ‡å•ä½æ—¶é—´å†…å®Œæˆçš„ä½œä¸šæ•°ã€‚ç³»ç»Ÿçš„ååé‡æ˜¯è¯„ä»·ç³»ç»Ÿæ€§èƒ½çš„é‡è¦æŒ‡æ ‡ä¹‹ä¸€ï¼šè°ƒåº¦ç®—æ³•å½±å“ç³»ç»Ÿçš„ååé‡ã€‚ 5. å¤„ç†æœºåˆ©ç”¨ç‡å¥½ CPUæ˜¯è®¡ç®—æœºç³»ç»Ÿä¸­å½±å“æ—¶é—´æ€§èƒ½çš„æœ€é‡è¦çš„ç¡¬ä»¶èµ„æºï¼Œåœ¨å¤šä»»åŠ¡ç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹è°ƒåº¦ç®—æ³•å¯¹CPUçš„åˆ©ç”¨ç‡æœ‰å¾ˆå¤§å½±å“ã€‚å› æ­¤ï¼Œåœ¨é€‰æ‹©å’Œè®¾è®¡è¿›ç¨‹è°ƒåº¦ç®—æ³•æ—¶åº”è¯¥è€ƒè™‘ä½¿CPUçš„åˆ©ç”¨ç‡å°½å¯èƒ½é«˜ã€‚ äºŒã€è°ƒåº¦ç®—æ³• 1. å…ˆæ¥å…ˆæœåŠ¡è°ƒåº¦ç®—æ³•(First-Come,First-Served,FCFS) (1) è°ƒåº¦ç®—æ³• åœ¨è¿›ç¨‹è°ƒåº¦ä¸­ï¼ŒFCFSå°±æ˜¯ä»å°±ç»ªé˜Ÿåˆ—çš„é˜Ÿé¦–é€‰æ‹©æœ€å…ˆåˆ°è¾¾å°±ç»ªé˜Ÿåˆ—çš„è¿›ç¨‹ï¼Œä¸ºè¯¥è¿›ç¨‹åˆ†é…CPUã€‚ (2) æ€§èƒ½åˆ†æ FCFSé€‚åˆé•¿è¿›ç¨‹ï¼Œä¸åˆ©äºçŸ­è¿›ç¨‹ï¼ŒçŸ­è¿›ç¨‹ç­‰å¾…æ—¶é—´ç›¸å¯¹è¿è¡Œæ—¶é—´è€Œè¨€å¤ªé•¿ã€‚FCFSä½¿çŸ­è¿›ç¨‹çš„å‘¨è½¬æ—¶é—´è¿‡é•¿ï¼Œç³»ç»Ÿçš„å¹³å‡å‘¨è½¬æ—¶é—´ä¹Ÿæ¯”è¾ƒé•¿ã€‚FCFSæœ‰åˆ©æ‰‹CPUç¹å¿™å‹è¿›ç¨‹(å¦‚ç§‘å­¦è®¡ç®—)ï¼Œä¸åˆ©äºI/Oç¹å¿™å‹è¿›ç¨‹ï¼ˆå¦‚å¤šæ•°çš„äº‹åŠ¡å¤„ç†ï¼‰ï¼Œè€ƒè™‘ä»¥ä¸‹å®ä¾‹ã€‚ æœ‰3ä¸ªè¿›ç¨‹p1ã€p2å’Œp3ï¼Œåˆ†åˆ«åœ¨0ã€1ã€2æ—¶åˆ»è¿›å…¥ç³»ç»Ÿï¼Œéœ€è¦çš„è¿è¡Œæ—¶é—´é•¿åº¦åˆ†åˆ«ä¸º24ã€3ã€3ï¼Œå¦‚æœæŒ‰FCFSè°ƒåº¦ç®—æ³•ï¼Œ3ä¸ªè¿›ç¨‹çš„ç­‰å¾…æ—¶é—´å’Œå‘¨è½¬æ—¶é—´å¦‚è¡¨3-1æ‰€ç¤ºã€‚ è¿›ç¨‹å è¿›å…¥ç³»ç»Ÿæ—¶é—´ å¼€å§‹è¿è¡Œæ—¶é—´ æœåŠ¡æ—¶é—´ ç­‰å¾…æ—¶é—´ å‘¨è½¬æ—¶é—´ p1 0 0 24 0 24 p2 1 24 3 23 26 p3 2 27 3 23 28 ç³»ç»Ÿçš„å¹³å‡å‘¨è½¬æ—¶é—´T=(24+26+28)/3=26ã€‚ å¹³å‡å¸¦æƒå‘¨è½¬æ—¶é—´W=(24/24+26/3+28/3)/3â‰ˆ6.33ã€‚ å¦‚æœè¿›ç¨‹è¿›å…¥ç³»ç»Ÿçš„é¡ºåºæ˜¯p3ã€p2å’Œp1ï¼Œ3ä¸ªè¿›ç¨‹è¿›å…¥ç³»ç»Ÿçš„æ—¶é—´åˆ†åˆ«æ˜¯0ã€1ã€2ï¼Œé‚£ä¹ˆ3ä¸ªè¿›ç¨‹çš„ç­‰å¾…æ—¶é—´å’Œå‘¨è½¬æ—¶é—´åˆ™å¦‚è¡¨3-2æ‰€ç¤ºã€‚ è¿›ç¨‹å è¿›å…¥ç³»ç»Ÿæ—¶é—´ å¼€å§‹è¿è¡Œæ—¶é—´ æœåŠ¡æ—¶é—´ ç­‰å¾…æ—¶é—´ å‘¨è½¬æ—¶é—´ p1 2 6 24 4 28 p2 1 3 3 2 5 p3 0 0 3 0 3 æ­¤ç§æƒ…å†µä¸‹ç³»ç»Ÿçš„å¹³å‡å‘¨è½¬æ—¶é—´ä¸ºT=(28+5+3)/3=12ã€‚ å¹³å‡å¸¦æƒå‘¨è½¬æ—¶é—´W=(28/24+5/3+33)/3â‰ˆ1.28ã€‚ å¯¹æ¯”å¯è§ï¼Œè®©çŸ­è¿›ç¨‹å…ˆè¿è¡Œèƒ½æ˜¾è‘—é™ä½ç³»ç»Ÿçš„å¹³å‡å‘¨è½¬æ—¶é—´å’Œå¹³å‡å¸¦æƒå‘¨è½¬æ—¶é—´ã€‚ 2. çŸ­è¿›ç¨‹ä¼˜å…ˆè°ƒåº¦ç®—æ³•(Shortest-Process-First,.SPF) (1) è°ƒåº¦ç®—æ³• çŸ­è¿›ç¨‹ä¼˜å…ˆ(SPF)çš„è°ƒåº¦ç®—æ³•æ˜¯ä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰æ‹©ä¼°è®¡è¿è¡Œæ—¶é—´æœ€çŸ­çš„è¿›ç¨‹ï¼Œå°†å¤„ç†æœºåˆ†é…ç»™å®ƒï¼Œä½¿å®ƒç«‹å³æ‰§è¡Œå¹¶ä¸€ç›´æ‰§è¡Œå®Œæˆï¼Œæˆ–å‘ç”ŸæŸäº‹ä»¶è€Œè¢«é˜»å¡æ”¾å¼ƒå¤„ç†æœºæ—¶ï¼Œå†é‡æ–° è°ƒåº¦ã€‚ (2) ç®—æ³•ä¼˜ç‚¹ ä¸FCFSç®—æ³•ç›¸æ¯”ï¼ŒçŸ­è¿›ç¨‹ä¼˜å…ˆçš„ç®—æ³•èƒ½æœ‰æ•ˆé™ä½è¿›ç¨‹çš„å¹³å‡ç­‰å¾…æ—¶é—´ï¼Œæé«˜ç³»ç»Ÿçš„ååé‡ã€‚ (3) ç®—æ³•çš„ç¼ºé™· 1) å¯¹é•¿è¿›ç¨‹ä¸åˆ©ã€‚å¦‚æœç³»ç»Ÿä¸­ä¸æ–­æœ‰çŸ­è¿›ç¨‹åˆ°æ¥ï¼Œé•¿è¿›ç¨‹å¯èƒ½é•¿æ—¶é—´å¾—ä¸åˆ°è°ƒåº¦ã€‚ 2) ä¸èƒ½ä¿è¯ç´§è¿«è¿›ç¨‹çš„åŠæ—¶å¤„ç†ï¼Œå› ä¸ºè¯¥ç®—æ³•ä¸è€ƒè™‘è¿›ç¨‹çš„ç´§è¿«ç¨‹åº¦ã€‚ 3) è¿›ç¨‹çš„é•¿çŸ­æ ¹æ®ç”¨æˆ·çš„ä¼°è®¡è€Œå®šï¼Œå¹¶ä¸ä¸€å®šèƒ½çœŸæ­£åšåˆ°çŸ­è¿›ç¨‹ä¼˜å…ˆã€‚ (4) æ€§èƒ½åˆ†æ ä»è¡¨3-1å’Œè¡¨3-2çš„æ¯”è¾ƒä¸­å¯ä»¥çœ‹å‡ºçŸ­è¿›ç¨‹ä¼˜å…ˆçš„è°ƒåº¦ç®—æ³•ä¸å…ˆæ¥å…ˆæœåŠ¡è°ƒåº¦ç®—æ³•ç›¸æ¯”ï¼Œèƒ½é™ä½ç³»ç»Ÿçš„å¹³å‡å‘¨è½¬æ—¶é—´å’Œå¸¦æƒå¹³å‡å‘¨è½¬æ—¶é—´ã€‚ 3. ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•(Priority-Scheduling Lgorithm) (1) è°ƒåº¦ç®—æ³• åœ¨ä½¿ç”¨ä¼˜å…ˆæƒè°ƒåº¦çš„ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„ä¼˜å…ˆæƒã€‚ä¼˜å…ˆæƒå€¼é€šå¸¸æ˜¯å›ºå®šåŒºé—´çš„æ•°å­—ï¼Œå¦‚0~127ä¸­çš„ä¸€ä¸ªæ•°ã€‚ç³»ç»Ÿå¯èƒ½è®¾è®¡ä¸ºä¼˜å…ˆæƒå€¼è¶Šå¤§ï¼Œä¼˜å…ˆæƒè¶Šé«˜ï¼›ä¹Ÿå¯èƒ½è®¾è®¡ä¸ºä¼˜å…ˆæƒå€¼è¶Šå°ï¼Œä¼˜å…ˆæƒè¶Šä½ã€‚ä¼˜å…ˆæƒå¯ä»¥é€šè¿‡å†…éƒ¨æˆ–è€…å¤–éƒ¨æ–¹å¼æ¥å®šä¹‰ã€‚å†…éƒ¨å®šä¹‰ä¼˜å…ˆæƒå¯ä½¿ç”¨ä¸€äº›å¯æµ‹é‡æ•°æ®ä»¥è®¡ç®—è¿›ç¨‹çš„ä¼˜å…ˆæƒå€¼ã€‚ä¾‹å¦‚ï¼Œæ—¶é—´æé™ã€å†…å­˜è¦æ±‚ã€æ‰“å¼€æ–‡ä»¶çš„æ•°é‡ã€å¹³å‡I/OæœåŠ¡æ—¶é—´ä¸å¹³å‡CPUæœåŠ¡æ—¶é—´ä¹‹æ¯”éƒ½å¯ä»¥ç”¨äºè®¡ç®—ä¼˜å…ˆæƒã€‚å¤–éƒ¨ä¼˜å…ˆæƒæ˜¯é€šè¿‡æ“ä½œç³»ç»Ÿä¹‹å¤–çš„å‡†åˆ™æ¥è®¾ç½®çš„ï¼Œå¦‚è¿›ç¨‹çš„é‡è¦æ€§ã€ç”¨äºæ”¯ä»˜ä½¿ç”¨è®¡ç®—æœºçš„è´¹ç”¨å’Œæ•°é‡ç­‰ã€‚ å½“ä½¿ç”¨ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•è¿›è¡Œè¿›ç¨‹è°ƒåº¦æ—¶ï¼Œç³»ç»Ÿå°†CPUåˆ†é…ç»™å°±ç»ªé˜Ÿåˆ—ä¸­ä¼˜å…ˆæƒå€¼æœ€é«˜çš„è¿›ç¨‹ã€‚ (2) ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•çš„ç±»å‹ ç”¨äºè¿›ç¨‹è°ƒåº¦çš„ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•å¯ä»¥åˆ†ä¸ºä¸‹åˆ—ä¸¤ç§ç±»å‹ã€‚ 1) éæŠ¢å å¼(Nonpreemptive)ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•ã€‚ åœ¨æ”¯æŒéæŠ¢å å¼è°ƒåº¦çš„ç³»ç»Ÿä¸­ï¼Œé«˜ä¼˜å…ˆæƒè¿›ç¨‹ä¸€æ—¦å¾—åˆ°å¤„ç†æœºï¼Œåˆ™è¯¥è¿›ç¨‹ä¾¿ä¸€ç›´è¿è¡Œä¸‹å»ï¼Œç›´åˆ°å®Œæˆæˆ–ç”±äºæŸäº‹ä»¶ä½¿è¯¥è¿›ç¨‹ä¸»åŠ¨æ”¾å¼ƒå¤„ç†æœºã€‚åœ¨è¿›ç¨‹è¿è¡ŒæœŸé—´ï¼Œå³ä½¿æœ‰é«˜ä¼˜å…ˆæƒè¿›ç¨‹åˆ°æ¥ï¼Œç³»ç»Ÿä¹Ÿä¸èƒ½å‰¥å¤ºå½“å‰è¿›ç¨‹ï¼ˆå³æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼‰çš„CPUä½¿ç”¨æƒã€‚é«˜ä¼˜å…ˆæƒè¿›ç¨‹åˆ°æ¥æ—¶å¦‚æœæœ‰åˆ«çš„è¿›ç¨‹æ­£åœ¨è¿è¡Œï¼Œé«˜ä¼˜å…ˆæƒè¿›ç¨‹åªèƒ½å…ˆè¿›å…¥å°±ç»ªé˜Ÿåˆ—ã€‚åœ¨å¯¹æˆªæ­¢æ—¶é—´è¦æ±‚ä¸¥æ ¼çš„å®æ—¶ç³»ç»Ÿä¸­ï¼ŒéæŠ¢å å¼è°ƒåº¦éš¾ä»¥ä¿è¯é«˜ä¼˜å…ˆæƒè¿›ç¨‹å¾—åˆ°åŠæ—¶è°ƒåº¦ã€‚ 2) æŠ¢å å¼(Preemptive)ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•ã€‚ åœ¨æ”¯æŒæŠ¢å å¼è°ƒåº¦çš„ç³»ç»Ÿä¸­ï¼Œå¦‚æœæ–°åˆ°è¾¾è¿›ç¨‹çš„ä¼˜å…ˆæƒé«˜äºå½“å‰æ­£åœ¨è¿è¡Œè¿›ç¨‹çš„ä¼˜å…ˆ æƒï¼Œé‚£ä¹ˆç³»ç»Ÿä¼šæŠ¢å CPUï¼ŒæŠŠå®ƒåˆ†é…ç»™æ–°åˆ°è¾¾çš„é«˜ä¼˜å…ˆæƒè¿›ç¨‹ï¼Œè€Œæ­£åœ¨æ‰§è¡Œçš„ä½ä¼˜å…ˆæƒè¿›ç¨‹æš‚åœæ‰§è¡Œã€‚åœ¨æŠ¢å å¼è°ƒåº¦ç®—æ³•ä¸­ï¼Œæ¯å½“ç³»ç»Ÿä¸­å‡ºç°ä¸€ä¸ªæ–°çš„å°±ç»ªè¿›ç¨‹ï¼Œå°±å°†å…¶ä¼˜å…ˆæƒä¸æ­£ åœ¨æ‰§è¡Œçš„è¿›ç¨‹çš„ä¼˜å…ˆæƒç›¸æ¯”è¾ƒï¼Œå¦‚æœå…¶ä¼˜å…ˆæƒå¤§äºæ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹çš„ä¼˜å…ˆæƒï¼Œå¯é‡‡ç”¨ç«‹å³æŠ¢å ç­–ç•¥ï¼Œç«‹åˆ»è¿›è¡Œè¿›ç¨‹åˆ‡æ¢ï¼Œä½¿å…¶æŠ•å…¥è¿è¡Œã€‚ä¹Ÿå¯ä»¥é‡‡ç”¨åŸºäºæ—¶é’Ÿä¸­æ–­çš„æŠ¢å ç­–ç•¥ï¼Œåœ¨æœ€è¿‘ä¸€æ¬¡æ—¶é’Ÿä¸­æ–­åˆ°æ¥æ—¶è¿›è¡Œè¿›ç¨‹åˆ‡æ¢ã€‚ (3) ä¼˜å…ˆæƒçš„ç±»å‹ å¦‚ä½•ç¡®å®šè¿›ç¨‹çš„ä¼˜å…ˆæƒæ˜¯å®ç°ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•çš„ä¸€ä¸ªå…³é”®é—®é¢˜ï¼Œä¼˜å…ˆæƒçš„è®¡ç®—æ–¹æ³•å¯¹ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•çš„æ€§èƒ½æœ‰å¾ˆå¤§çš„å½±å“ã€‚æ ¹æ®ä¼˜å…ˆæƒçš„å˜åŒ–ç‰¹ç‚¹å¯ä»¥å°†ä¼˜å…ˆæƒçš„ç±»å‹åˆ†ä¸ºé™æ€ä¼˜å…ˆæƒå’ŒåŠ¨æ€ä¼˜å…ˆæƒã€‚ 1) é™æ€ä¼˜å…ˆæƒã€‚é™æ€ä¼˜å…ˆæƒåœ¨åˆ›å»ºæ—¶ç¡®å®šï¼Œåœ¨è¿›ç¨‹çš„æ•´ä¸ªè¿è¡ŒæœŸé—´ä¿æŒä¸å˜ã€‚é™æ€ä¼˜ å…ˆæƒå€¼é€šå¸¸å¯ä»¥æ ¹æ®è¿›ç¨‹çš„ç±»å‹ã€è¿›ç¨‹éœ€è¦çš„èµ„æºæ•°é‡å’Œç”¨æˆ·çš„è¦æ±‚æ¥è®¾å®šã€‚ 2) åŠ¨æ€ä¼˜å…ˆæƒã€‚è¿›ç¨‹åˆ›å»ºæ—¶è¢«èµ‹äºˆçš„ä¼˜å…ˆæƒï¼Œéšè¿›ç¨‹çš„æ¨è¿›æˆ–éšå…¶ç­‰å¾…æ—¶é—´çš„å¢åŠ è€Œ æ”¹å˜ã€‚åŠ¨æ€ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•å¯ä»¥ä½¿ç³»ç»Ÿè·å¾—æ›´å¥½çš„è°ƒåº¦æ€§èƒ½ã€‚ (4) ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•å­˜åœ¨çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ 1) é—®é¢˜ã€‚ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•çš„ä¸€ä¸ªä¸»è¦é—®é¢˜æ˜¯æ— ç©·é˜»å¡ï¼Œæˆ–ç§°é¥¥é¥¿(Starving)é—®é¢˜ã€‚è¿™é‡Œçš„é˜»å¡æ˜¯æŒ‡å°±ç»ªæ€è¿›ç¨‹å› å¾—ä¸åˆ°CPUè€Œç­‰å¾…çš„çŠ¶æ€ã€‚ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•ä¼šä½¿æŸä¸ªä½ä¼˜å…ˆæƒè¿›ç¨‹æ— ç©·ç­‰å¾…CPUï¼Œåœ¨ä¸€ä¸ªé‡è´Ÿè½½çš„è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œå¹³ç¨³çš„é«˜ä¼˜å…ˆæƒè¿›ç¨‹æµå¯ä»¥é˜»æ­¢ä½ä¼˜å…ˆæƒæƒè¿›ç¨‹è·å¾—CPUã€‚æ®è¯´ï¼ŒM ITåœ¨1973å¹´å…³é—­ IBM 7094 æ—¶ï¼Œå‘ç°æœ‰ä¸€ä¸ªä½ä¼˜å…ˆæƒè¿›ç¨‹æ˜¯äº1967å¹´æäº¤ä½†ä¸€ç›´æœªè¿è¡Œçš„ã€‚ 2) è§£å†³æ–¹æ¡ˆã€‚ä½ä¼˜å…ˆæƒè¿›ç¨‹æ— ç©·ç­‰å¾…é—´é¢˜çš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€æ˜¯è€åŒ–(Aging)æŠ€æœ¯ã€‚è€åŒ–æŠ€æœ¯ä»¥é€æ¸å¢åŠ è½¦ç³»ç»Ÿä¸­ç­‰å¾…æ—¶é—´å¾ˆé•¿çš„è¿›ç¨‹çš„ä¼˜å…ˆæƒï¼Œä½¿ä½ä¼˜å…ˆæƒè¿›ç¨‹åœ¨ç­‰å¾…æ—¶é—´å¾ˆé•¿çš„æƒ…å†µä¸‹ï¼Œä¼˜å…ˆæƒå˜é«˜è€Œè·å¾—CPUæ‰§è¡Œã€‚ 4. æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•(Round--Robin,RR) æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•æ˜¯åœ¨ç°ä»£åˆ†æ—¶ç³»ç»Ÿä¸­å¹¿æ³›ä½¿ç”¨çš„è¿›ç¨‹è°ƒåº¦ç®—æ³•ï¼ŒUNIXã€Liuxå’ŒWindowsæ“ä½œç³»ç»Ÿéƒ‘é‡‡ç”¨åŸºäºæ—¶é—´ç‰‡è½®è½¬ã€æ”¯æŒä¼˜å…ˆæƒå’ŒæŠ¢å å¼è°ƒåº¦çš„æ··åˆå¼è¿›ç¨‹è°ƒåº¦ç®—æ³•ã€‚ (1) æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³• åœ¨æ—©æœŸçš„æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•ä¸­ï¼Œç³»ç»Ÿå°†æ‰€æœ‰çš„å°±ç»ªè¿›ç¨‹æŒ‰å…ˆæ¥å…ˆæœåŠ¡çš„åŸåˆ™ï¼Œæ’æˆä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ¯æ¬¡è°ƒåº¦æ—¶æŠŠCPUåˆ†é…ç»™é˜Ÿé¦–è¿›ç¨‹ï¼Œå¹¶ä»¤å…¶æ‰§è¡Œä¸€ä¸ªæ—¶é—´ç‰‡ã€‚å½“æ—¶é—´ç‰‡ç”¨å®Œæ—¶ï¼Œè°ƒåº¦ç¨‹åºç»ˆæ­¢å½“å‰è¿›ç¨‹çš„æ‰§è¡Œï¼Œå¹¶å°†å®ƒé€åˆ°å°±ç»ªé˜Ÿåˆ—çš„é˜Ÿå°¾ã€‚æ—¶é—´ç‰‡æ˜¯ä¸€ä¸ªè¾ƒå°çš„æ—¶é—´å•å…ƒï¼Œé€šå¸¸ä¸º10~100msã€‚Linux2.4å†…æ ¸ç»™ç”¨æˆ·è¿›ç¨‹åˆ†é…çš„æ—¶é—´ç‰‡å¤§å°ä¸€èˆ¬ä¸º50msã€‚ åœ¨é‡‡ç”¨æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•çš„ç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹éœ€è¦åœ¨CPUä¸Šè¿è¡Œçš„æ—¶é—´æ€»æ•°ï¼ˆè¿™é‡Œç§°ä¹‹ä¸ºæ—¶é—´åŒºé—´)å¯èƒ½å°äºä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œä¹Ÿå¯èƒ½å¤§äºä¸€ä¸ªæ—¶é—´ç‰‡ã€‚å¯¹äºè¿›ç¨‹çš„æ—¶é—´åŒºé—´å°äºä¸€ä¸ªæ—¶é—´ç‰‡çš„æƒ…å†µï¼Œè¿›ç¨‹åœ¨CPUä¸Šè¿è¡Œç»“æŸåï¼Œè¿›ç¨‹æœ¬èº«ä¼šè‡ªåŠ¨é‡Šæ”¾CPUã€‚ç„¶åï¼Œç”±æ“ä½œç³»ç»Ÿæ‰§è¡Œè¿›ç¨‹è°ƒåº¦ç¨‹åºä¸ºå¦ä¸€ä¸ªå°±ç»ªè¿›ç¨‹åˆ†é…CPUã€‚å¯¹äºè¿›ç¨‹çš„æ—¶é—´åŒºé—´å¤§äºä¸€ä¸ªæ—¶é—´ç‰‡çš„æƒ…å†µï¼Œè¿›ç¨‹å¯èƒ½éœ€è¦æ‰§è¡Œè‹¥å¹²ä¸ªæ—¶é—´ç‰‡ã€‚æ¯å½“è¿›ç¨‹åœ¨CPUä¸Šè¿ç»­è¿è¡Œçš„æ—¶é—´ç­‰äºä¸€ä¸ªæ—¶é—´ç‰‡é•¿åº¦æ—¶ï¼Œæ“ä½œç³»ç»Ÿåœ¨æ—¶é’Ÿä¸­æ–­å¤„ç†è¿‡ç¨‹ä¸­ä¼šæŠ¢å CPUï¼Œè¿›è¡Œè¿›ç¨‹åˆ‡æ¢ï¼Œç”¨æ–°çš„å°±ç»ªè¿›ç¨‹æ›¿ä»£å½“å‰è¿›ç¨‹ï¼Œè¢«æ›¿æ¢çš„å½“å‰è¿›ç¨‹é‡æ–°å›åˆ°å°±ç»ªé˜Ÿåˆ—ä¸­ã€‚ (2) æ—¶é—´ç‰‡å¤§å°çš„ç¡®å®š åœ¨è®¾è®¡æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•æ—¶ï¼Œæ—¶é—´ç‰‡å¤§å°çš„ç¡®å®šæ˜¯ä¸€ä¸ªé‡è¦çš„ç¯èŠ‚ã€‚æ—¶é—´ç‰‡å¤ªé•¿ï¼Œå¯ä»¥ä½¿å¤šæ•°è¿›ç¨‹åœ¨ä¸€ä¸ªæ—¶é—´ç‰‡å†…å¤„ç†å®Œï¼Œèƒ½å¤Ÿé™ä½è¿›ç¨‹çš„å‘¨è½¬æ—¶é—´ï¼Œä½†æ˜¯å¯èƒ½é€ æˆäº¤äº’ç”¨æˆ·çš„å“åº”æ—¶é—´è¿‡é•¿ã€‚æ—¶é—´ç‰‡å¤ªçŸ­ï¼Œä¸€ä¸ªè¿›ç¨‹è¦ç»è¿‡å¤šæ¬¡è°ƒåº¦è¿è¡Œæ‰èƒ½æ‰§è¡Œå®Œæ¯•ï¼Œè¿›ç¨‹åˆ‡æ¢å’Œè¿›ç¨‹è°ƒåº¦çš„å¼€é”€ä¼šå¢åŠ ï¼Œç³»ç»Ÿçš„å¹³å‡å‘¨è½¬æ—¶é—´ä¹Ÿä¼šæ¯”è¾ƒé•¿ã€‚ä¾‹å¦‚ï¼Œå‡å®šè¿›ç¨‹åˆ‡æ¢éœ€è¦10sï¼Œå¦‚æœæ—¶é—´ç‰‡ä¹Ÿæ˜¯10sï¼Œé‚£ä¹ˆï¼ŒCPUè‡³å°‘æŠŠ50%çš„æ—¶é—´èŠ±è´¹åœ¨è¿›ç¨‹åˆ‡æ¢ä¸Šã€‚å› æ­¤ï¼Œè¦æ ¹æ®ç”¨æˆ·å’Œç³»ç»Ÿçš„éœ€è¦é€‰æ‹©å¤§å°åˆé€‚çš„æ—¶é—´ç‰‡ã€‚é€‰æ‹©æ—¶é—´ç‰‡æ—¶æ—¢è¦è€ƒè™‘äº¤äº’ç”¨æˆ·çš„éœ€æ±‚ï¼Œä¹Ÿè¦å¹³è¡¡ç³»ç»Ÿçš„æ•ˆç‡ã€‚åœ¨ä¸ºè°ƒåº¦ç¨‹åºç¡®å®šæ—¶é—´ç‰‡çš„å¤§å°æ—¶ï¼Œé€šå¸¸è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªå› ç´ ã€‚ 1) ç³»ç»Ÿå¯¹å“åº”æ—¶é—´çš„è¦æ±‚ã€‚å“åº”æ—¶é—´æ˜¯åˆ†æ—¶ç³»ç»Ÿæ€§èƒ½çš„é‡è¦æŒ‡æ ‡ï¼Œè®¾è®¡æ—¶é—´ç‰‡å¤§å°æ—¶é¦–å…ˆè¦è€ƒè™‘å…¶å¯¹å“åº”æ—¶é—´çš„å½±å“å’Œç³»ç»Ÿå¯¹å“åº”æ—¶é—´çš„è¦æ±‚ã€‚ç³»ç»Ÿå“åº”æ—¶é—´ä¸ºT,è¿›ç¨‹æ•°ç›®ä¸ºN,æ—¶é—´ç‰‡ä¸ºqï¼Œæœ‰T=Nq,ä¹Ÿå°±æ˜¯è¯´å“åº”æ—¶é—´ä¸è¿›ç¨‹æ•°å’Œæ—¶é—´ç‰‡æˆæ¯”ä¾‹ã€‚å› æ­¤åœ¨ç³»ç»Ÿå…è®¸çš„æœ€å¤§è¿›ç¨‹æ•°ä¸€å®šçš„æƒ…å†µä¸‹ï¼Œæ—¶é—´ç‰‡çš„é•¿çŸ­å–å†³ç‹ç³»ç»Ÿè¦æ±‚çš„å“åº”æ—¶é—´ã€‚å“åº”æ—¶é—´è¶ŠçŸ­ï¼Œæ—¶é—´ç‰‡å–å€¼åº”è¯¥è¶Šå°ã€‚ 2) å°±ç»ªé˜Ÿåˆ—ä¸­è¿›ç¨‹çš„æ•°ç›®ã€‚åœ¨åˆ†æ—¶ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿå…è®¸çš„æœ€å¤§è¿›ç¨‹æ•°å¾€å¾€æ˜¯ç»™å®šçš„ï¼Œç³»ç»Ÿä¸­çš„è¿›ç¨‹æ•°ä¼šå½±å“ç³»ç»Ÿçš„å“åº”æ—¶é—´ï¼Œè¿›ç¨‹è¶Šå¤šï¼Œå“åº”æ—¶é—´è¶Šé•¿ã€‚ä½†æ˜¯ï¼Œæ“ä½œç³»ç»Ÿçš„è®¾è®¡è€…å¸Œæœ›ç³»ç»Ÿçš„å“åº”æ—¶é—´æœ‰ä¸€ä¸ªä¸Šé™å€¼ï¼Œä¸èƒ½å‡ºç°å› ä¸ºè¿›ç¨‹å¤šè€Œä½¿ç³»ç»Ÿå“åº”æ—¶é—´å¾ˆé•¿çš„æƒ…å†µã€‚å½“è®¾å®šäº†ç³»ç»Ÿçš„æœ€é•¿å“åº”æ—¶é—´å€¼åï¼Œä¸€æ—¶é—´ç‰‡çš„å¤§å°å°±ä¸ç³»ç»Ÿå…è®¸çš„æœ€å¤§è¿›ç¨‹æ•°æˆåæ¯”ã€‚ 3) ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›ã€‚ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›æ˜¯å¿…é¡»ä¿è¯ç³»ç»Ÿæ”¯æŒçš„åŸºæœ¬å‘½ä»¤èƒ½åœ¨ä¸€ä¸ªæ—¶é—´ç‰‡å†…æ‰§è¡Œå®Œï¼Œå¦åˆ™å°†æ— æ³•ä¿è¯å¾—åˆ°æ»¡æ„çš„å“åº”æ—¶é—´ï¼Œè€Œä¸”ä¼šä½¿å¹³å‡å‘¨è½¬æ—¶é—´åŠå¸¦æƒå‘¨è½¬æ—¶é—´éƒ½å¾ˆé•¿ã€‚ (3) æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•çš„æ€§èƒ½è¯„ä»· æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•çš„æ€§èƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºæ—¶é—´ç‰‡çš„å¤§å°ã€‚åœ¨æç«¯æƒ…å†µä¸‹ï¼Œå¦‚æœæ—¶é—´ç‰‡å¾ˆå¤§ï¼Œé‚£ä¹ˆæ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•å°±ä¸å…ˆæ¥å…ˆæœåŠ¡ç®—æ³•ä¸€æ ·ï¼ˆå¦‚æœå°±ç»ªé˜Ÿåˆ—æŒ‰å…ˆè¿›å…ˆå‡ºå¯¹è¿›ç¨‹æ’åº)ã€‚å¦‚æœæ—¶é—´ç‰‡å¾ˆå°ï¼Œè¿›ç¨‹éœ€è¦ç»è¿‡å¤šæ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œè¿›ç¨‹è°ƒåº¦ï¼Œä¼šå¤§å¤§å¢åŠ CPUç”¨äºè¿›ç¨‹åˆ‡æ¢å’Œè¿›ç¨‹è°ƒåº¦çš„å¼€é”€ã€‚ 5. å¤šçº§é˜Ÿåˆ—è°ƒåº¦ åœ¨ç°ä»£æ“ä½œç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹å¯ä»¥æ ¹æ®ä¸åŒçš„ç‰¹ç‚¹è¿›è¡Œåˆ†ç±»ï¼Œæ¯ä¸€ç±»è¿›ç¨‹å±äºä¸€ä¸ªå°±ç»ªé˜Ÿåˆ—ã€‚å› æ­¤ï¼Œç³»ç»Ÿä¸­çš„å°±ç»ªé˜Ÿåˆ—å¾€å¾€ä¸æ­¢ä¸€ä¸ªè€Œæ˜¯å¤šä¸ªï¼Œè¿™ç§ç³»ç»Ÿé€šå¸¸æ ¹æ®ä¸åŒè¿›ç¨‹å¯¹å“åº”æ—¶é—´è¦æ±‚çš„ä¸åŒï¼Œé‡‡ç”¨å¤šçº§é˜Ÿåˆ—è°ƒåº¦ç®—æ³•ã€‚ (1) å¤šçº§é˜Ÿåˆ—è°ƒåº¦ç®—æ³•(Multilevel Queue-Scheduling Algorithm) å°†å°±ç»ªé˜Ÿåˆ—åˆ†æˆå¤šä¸ªç‹¬ç«‹é˜Ÿåˆ—ï¼Œæ ¹æ®è¿›ç¨‹çš„æŸäº›å±æ€§ï¼Œå¦‚éœ€è¦å ç”¨çš„å†…å­˜å¤§å°ã€è¿›ç¨‹ä¼˜å…ˆæƒæˆ–è¿›ç¨‹ç±»å‹ï¼Œè¿›ç¨‹ä¼šè¢«æ°¸ä¹…åœ°åˆ†é…åˆ°ä¸€ä¸ªé˜Ÿåˆ—ã€‚æ¯ä¸ªé˜Ÿåˆ—æœ‰è‡ªå·±çš„è°ƒåº¦ç®—æ³•ã€‚ä¸åŒçš„é˜Ÿåˆ—ä¼˜å…ˆæƒä¸åŒï¼Œè°ƒåº¦ç®—æ³•ä¹Ÿå¯èƒ½ä¸åŒã€‚ (2) å¤šçº§é˜Ÿåˆ—è°ƒåº¦ç®—æ³•åº”ç”¨ä¸¾ä¾‹ å¤šçº§é˜Ÿåˆ—è°ƒåº¦ä¸¾ä¾‹ï¼šMinâ…¸æ“ä½œç³»ç»Ÿçš„è¿›ç¨‹è°ƒåº¦ã€‚ MinxæŠŠè¿›ç¨‹æŒ‰ç±»å‹ä¸åŒåˆ†ä¸º3ç±»ï¼Œåˆ†åˆ«å¯¹åº”3ä¸ªä¼˜å…ˆæƒä¸åŒçš„å°±ç»ªé˜Ÿåˆ—ï¼šä¼˜å…ˆæƒæœ€é«˜çš„ä»»åŠ¡è¿›ç¨‹é˜Ÿåˆ—ã€ä¼˜å…ˆæƒæ¬¡ä¹‹çš„æœåŠ¡è¿›ç¨‹é˜Ÿåˆ—å’Œä¼˜å…ˆæƒæœ€ä½çš„ç”¨æˆ·è¿›ç¨‹é˜Ÿåˆ—ã€‚å¯¹ä»»åŠ¡è¿›ç¨‹å’ŒæœåŠ¡è¿›ç¨‹é‡‡ç”¨åŸºäºä¼˜å…ˆæƒçš„éæŠ¢å å¼è°ƒåº¦ï¼Œä¼˜å…ˆæƒé«˜çš„è¿›ç¨‹ä¸€æ—¦è·å¾—å¤„ç†æœºå°†ä¸€ç›´è¿è¡Œä¸‹å»ï¼Œç›´åˆ°é˜»å¡ã€‚å¯¹ä¼˜å…ˆæƒæœ€ä½çš„ç”¨æˆ·è¿›ç¨‹é‡‡ç”¨æ—¶é—´ç‰‡è½®è½¬çš„æŠ¢å å¼è°ƒåº¦ã€‚ è°ƒåº¦ç¨‹åºæŒ‰å¦‚å›¾3-1æ‰€ç¤ºçš„æµç¨‹å®Œæˆè¿›ç¨‹è°ƒåº¦ã€‚ 6. å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ é‡‡ç”¨å¤šçº§é˜Ÿåˆ—è°ƒåº¦ï¼Œä¸€æ—¦è¿›ç¨‹è¿›å…¥ç³»ç»Ÿï¼Œå°±è¢«å›ºå®šåœ°åˆ†é…åˆ°ä¸€ä¸ªå°±ç»ªé˜Ÿåˆ—ä¸­ï¼Œè¿›ç¨‹åœ¨è¢«æ’¤é”€å‰ä¸ä¼šåœ¨ä¸åŒé˜Ÿåˆ—ä¹‹é—´ç§»åŠ¨ã€‚è¿™ç§ç®—æ³•çš„ä¼˜ç‚¹æ˜¯é™ä½äº†è¿›ç¨‹è°ƒåº¦çš„å¼€é”€ï¼Œä½†æ˜¯ä¸å¤Ÿçµæ´»ï¼Œå¯¹ä½ä¼˜å…ˆæƒè¿›ç¨‹ä¼šå­˜åœ¨æ— ç©·é˜»å¡ï¼ˆé¥¥é¥¿ï¼‰é—®é¢˜ã€‚è€Œå¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•(Ml-tilevel Feedback Queue Scheduling)å¯ä»¥å¼¥è¡¥è¿™äº›ä¸è¶³ã€‚ åœ¨é‡‡ç”¨å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦çš„ç³»ç»Ÿä¸­å»ºç«‹å¤šä¸ªä¼˜å…ˆæƒä¸åŒçš„å°±ç»ªé˜Ÿåˆ—ï¼Œä¸ºæ¯ä¸ªé˜Ÿåˆ—èµ‹äºˆå¤§å°ä¸åŒçš„æ—¶é—´ç‰‡ã€‚æœ‰ä¸€ç§åé¦ˆç­–ç•¥å¯ä»¥è§„å®šï¼šé˜Ÿåˆ—ä¼˜å…ˆæƒè¶Šé«˜ï¼Œæ—¶é—´ç‰‡è¶ŠçŸ­ï¼Œæ—¶é—´ç‰‡é€šå¸¸æˆå€å¢é•¿ã€‚æ–°è¿›ç¨‹è¢«åˆ›å»ºåï¼Œå…ˆæ’äººä¼˜å…ˆæƒæœ€é«˜çš„é˜Ÿåˆ—ï¼Œä»…å½“é«˜ä¼˜å…ˆæƒé˜Ÿåˆ—ç©ºæ—¶ï¼Œæ‰è°ƒåº¦ä¼˜å…ˆæƒæ¬¡ä¹‹çš„é˜Ÿåˆ—ã€‚åŒä¸€é˜Ÿåˆ—ä¸­ï¼Œé‡‡ç”¨æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•ã€‚ä½¿ç”¨CPUæ—¶é—´è¿‡å¤šçš„è¿›ç¨‹ä¼šè¢«ç§»åˆ°ä¼˜å…ˆæƒè¾ƒä½çš„é˜Ÿåˆ—ä¸­ï¼Œåœ¨è¾ƒä½ä¼˜å…ˆæƒé˜Ÿåˆ—ä¸­ç­‰å¾…æ—¶é—´è¿‡é•¿çš„è¿›ç¨‹ä¼šè¢«è½¬ç§»åˆ°è¾ƒé«˜çš„ä¼˜å…ˆæƒé˜Ÿåˆ—ä¸­ã€‚è¿™æ ·å°±é€šè¿‡ä½¿ç”¨è€åŒ–æŠ€æœ¯é˜»æ­¢äº†é¥¥é¥¿çš„å‘ç”Ÿã€‚ä½†æ˜¯ï¼Œä¸å¯çš„æ“ä½œç³»ç»Ÿåœ¨è®¾è®¡å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦æ—¶é‡‡å–çš„ç­–ç•¥å¯èƒ½æ˜¯ä¸åŒçš„ã€‚å¤šçº§åé¦ˆé˜Ÿåˆ—ç®—æ³•çš„è®¾è®¡è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„é—®é¢˜ã€‚ 1) å°±ç»ªé˜Ÿåˆ—çš„æ•°é‡ã€‚ 2) æ ¹æ®è¿›ç¨‹ä¼˜å…ˆæƒç¡®å®šè¿›ç¨‹åº”è¯¥è¿›å…¥å“ªä¸ªå°±ç»ªé˜Ÿåˆ—çš„ç®—æ³•ã€‚ 3) ç”¨ä»¥ç¡®å®šè¿›ç¨‹ä½•æ—¶è½¬ç§»åˆ°è¾ƒé«˜ä¼˜å…ˆæƒé˜Ÿåˆ—çš„ç®—æ³•ã€‚ 4) ç”¨ä»¥ç¡®å®šè¿›ç¨‹ä½•æ—¶è½¬ç§»åˆ°è¾ƒä½ä¼˜å…ˆæƒé˜Ÿåˆ—çš„ç®—æ³•ã€‚ 5) ç”¨ä»¥ç¡®å®šè¿›ç¨‹åœ¨éœ€è¦çœ¼åŠ¡æ—¶åº”è¯¥è¿›äººå“ªä¸ªé˜Ÿåˆ—çš„ç®—æ³•ã€‚ å¤šçº§åé¦ˆè®¤åˆ—è°ƒåº¦ç®—æ³•çš„ä¸€ä¸ªå…¸å‹å®ä¾‹æ˜¯Linux 2.6.11 å†…æ ¸çš„è¿›ç¨‹è°ƒåº¦ç®—æ³•ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬ä¸‰ç« _è¿›ç¨‹è°ƒåº¦ä¸æ­»é”/ç¬¬ä¸‰èŠ‚_å®æ—¶ç³»ç»Ÿä¸­çš„è°ƒåº¦.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬ä¸‰ç« _è¿›ç¨‹è°ƒåº¦ä¸æ­»é”/ç¬¬ä¸‰èŠ‚_å®æ—¶ç³»ç»Ÿä¸­çš„è°ƒåº¦.html","title":"ç¬¬ä¸‰ã€å››ã€äº”èŠ‚ å®æ—¶ç³»ç»Ÿä¸­çš„è°ƒåº¦ã€è¿›ç¨‹åˆ‡æ¢ã€å¤šå¤„ç†å™¨è°ƒåº¦","keywords":"","body":"ç¬¬ä¸‰èŠ‚ å®æ—¶ç³»ç»Ÿä¸­çš„è°ƒåº¦ åœ¨ç¬¬ä¸€ç« ä»‹ç»äº†å®æ—¶ç³»ç»Ÿçš„ç‰¹ç‚¹ï¼Œå®æ—¶ç³»ç»Ÿå¯¹å¤„ç†å™¨æ“ä½œæˆ–è€…æ•°æ®æµåŠ¨æœ‰ç€ä¸¥æ ¼çš„æ—¶é—´é™åˆ¶ï¼Œå®æ—¶ç³»ç»Ÿçš„è¿›ç¨‹è°ƒåº¦å¯¹ä¿è¯æ—¶é—´çš„è¦æ±‚å…·æœ‰é‡è¦ä½œç”¨ã€‚ ä¸€ã€å®ç°å®æ—¶è°ƒåº¦çš„åŸºæœ¬æ¡ä»¶ ä¸ºäº†æ»¡è¶³å®æ—¶ç³»ç»Ÿå¯¹æˆªæ­¢æ—¶é—´çš„è¦æ±‚ï¼Œå®ç°å®æ—¶è°ƒåº¦åº”å…·å¤‡ä¸‹åˆ—å‡ ä¸ªæ¡ä»¶ã€‚ 1. æä¾›å¿…è¦çš„è°ƒåº¦ä¿¡æ¯ ä¸ºäº†å®ç°å®æ—¶è°ƒåº¦ï¼Œç³»ç»Ÿå¯èƒ½éœ€è¦ä¸ºè°ƒåº¦ç¨‹åºæä¾›ä¸‹åˆ—ä¸€äº›ä¿¡æ¯ã€‚ 1) å°±ç»ªæ—¶é—´ã€‚æ˜¯ä¸€ä¸ªå®æ—¶ä»»åŠ¡æˆä¸ºå°±ç»ªæ€çš„èµ·å§‹æ—¶é—´ã€‚ 2) å¼€å§‹æˆªæ­¢æ—¶é—´å’Œå®Œæˆæˆªæ­¢æ—¶é—´ã€‚ 3) å¤„ç†æ—¶é—´ã€‚æŒ‡ä¸€ä¸ªå®æ—¶ä»»åŠ¡ä»å¼€å§‹æ‰§è¡Œç›´è‡³å®Œæˆæ‰€éœ€è¦çš„æ—¶é—´ã€‚ 4) èµ„æºè¦æ±‚ã€‚å…³äºä»»åŠ¡æ‰§è¡Œæ‰€éœ€è¦çš„èµ„æºä¿¡æ¯ã€‚ 5) ä¼˜å…ˆçº§ã€‚æ ¹æ®å®æ—¶ä»»åŠ¡ç´§è¿«ç¨‹åº¦çš„ä¸åŒï¼Œå¯ä»¥ç»™å®æ—¶ä»»åŠ¡èµ‹äºˆä¸åŒçš„ä¼˜å…ˆæƒï¼Œä½¿é«˜ä¼˜å…ˆæƒä»»åŠ¡èƒ½ä¼˜å…ˆè·å¾—ç³»ç»Ÿèµ„æºï¼Œå°½å¿«å¾—åˆ°æ‰§è¡Œã€‚ç³»ç»Ÿä¸­å®æ—¶è¿›ç¨‹çš„ä¼˜å…ˆæƒä¸èƒ½åŠ¨æ€é™ä½ã€‚ 2. ç³»ç»Ÿå¤„ç†èƒ½åŠ›å¼º åœ¨å®æ—¶ç³»ç»Ÿä¸­ï¼Œé€šå¸¸æœ‰å¤šä¸ªå®æ—¶è¿›ç¨‹ï¼ˆé€šå¸¸ä¹Ÿç§°å…¶ä¸ºå®æ—¶ä»»åŠ¡ï¼‰ï¼Œè‹¥å¤„ç†æœºçš„å¤„ç†èƒ½åŠ›ä¸å¤Ÿå¼ºï¼Œå¤„ç†é€Ÿåº¦ä¸å¤Ÿå¿«ï¼Œä»è€Œä½¿æŸäº›å®æ—¶è¿›ç¨‹ä¸èƒ½å¾—åˆ°åŠæ—¶å¤„ç†ï¼Œå¯èƒ½å‘ç”Ÿéš¾ä»¥é¢„æ–™çš„ åæœã€‚ (1) å•å¤„ç†æœºæƒ…å†µä¸‹å¿…é¡»æ»¡è¶³çš„é™åˆ¶æ¡ä»¶ å‡å®šç³»ç»Ÿä¸­æœ‰mä¸ªå‘¨æœŸæ€§çš„ç¡¬å®æ—¶è¿›ç¨‹ï¼Œå®ƒä»¬çš„å¤„ç†æ—¶é—´å¯è¡¨ç¤ºä¸ºCiï¼Œå‘¨æœŸæ—¶é—´è¡¨ç¤ºä¸ºPi,åˆ™åœ¨å•å¤„ç†æœºæƒ…å†µä¸‹ï¼Œå¿…é¡»æ»¡è¶³å¦‚å¼(3-3)æ‰€ç¤ºçš„é™åˆ¶æ¡ä»¶ã€‚ ä¾‹å¦‚ï¼Œæœ‰6ä¸ªå®æ—¶è¿›ç¨‹ï¼Œå®ƒä»¬çš„å‘¨æœŸæ—¶é—´éƒ½æ˜¯50msï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªè¿›ç¨‹éƒ½å¿…é¡»æ¯éš”50mså®Œæˆä¸€æ¬¡è¿è¡Œã€‚å¤„ç†æœºçš„å¤„ç†èƒ½åŠ›ä¸ºå¤„ç†ä¸ªè¿›ç¨‹çš„æ—¶é—´å…·10msï¼Œæ‰€ä»¥è¯¥ç³»ç»Ÿæ˜¯æ— æ³•ä¿è¯æ‰€æœ‰çš„6ä¸ªå®æ—¶è¿›ç¨‹éƒ½èƒ½åœ¨æˆªæ­¢æ—¶é—´å†…å®Œæˆçš„ï¼Œè¿™ç§æƒ…å†µç§°ä¸ºç³»ç»Ÿä¸å¯è°ƒåº¦ã€‚è¦ä¿è¯è¯¥ç³»ç»Ÿæ˜¯å¯è°ƒåº¦çš„ï¼Œå¯ä»¥æé«˜å¤„ç†æœºçš„å¤„ç†èƒ½æ–¹ä»¥ç¼©çŸ­æ¯ä¸ªå®æ—¶è¿›ç¨‹çš„å¤„ç†æ—¶é—´ï¼Œä¹Ÿå¯ä»¥å¢åŠ å¤„ç†æœºæ•°é‡ã€‚ (2) nä¸ªå¤„ç†æœºæƒ…å†µä¸‹å¿…é¡»æ»¡è¶³çš„é™åˆ¶æ¡ä»¶ é‡‡ç”¨å¤šå¤„ç†æœºç³»ç»Ÿå¯ä»¥æé«˜å®æ—¶ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›ï¼Œè‹¥ç³»ç»Ÿçš„å¤„ç†æœºä¸ªæ•°ä¸ºnï¼Œå¤„ç†èƒ½åŠ›çš„é™åˆ¶æ¡ä»¶æ”¹å˜å¦‚å¼(3-4)æ‰€ç¤ºã€‚ æ“ä½œç³»ç»Ÿåœ¨æé«˜å¤„ç†èƒ½åŠ›æ–¹é¢æ˜¯å¯ä»¥æœ‰æ‰€ä½œä¸ºçš„ï¼Œæ¯”å¦‚ï¼Œè®¾è®¡é€‚åˆç‰¹å®šå®æ—¶åº”ç”¨çš„è¿›ç¨‹è°ƒåº¦ç®—æ³•ï¼Œè§„å®šå®æ—¶è¿›ç¨‹å…·æœ‰æœ€é«˜çš„ä¼˜å…ˆæƒï¼Œä»¥åŠä½¿è°ƒåº¦ç¨‹åºå’Œè¿›ç¨‹åˆ‡æ¢çš„å»¶è¿Ÿæ—¶é—´å°½å¯èƒ½çŸ­ã€‚ 3. é‡‡ç”¨æŠ¢å å¼è°ƒåº¦æœºåˆ¶ åœ¨å®æ—¶ç³»ç»Ÿä¸­å¹¿æ³›é‡‡ç”¨æŠ¢å å¼è°ƒåº¦ã€‚å½“ä¸€ä¸ªä¼˜å…ˆæƒæ›´é«˜çš„è¿›ç¨‹åˆ°è¾¾æ—¶ï¼Œå…è®¸å°†å½“å‰è¿›ç¨‹æš‚æ—¶æŒ‚èµ·ï¼Œè€Œä»¤é«˜ä¼˜å…ˆæƒè¿›ç¨‹ç«‹å³æŠ•äººè¿è¡Œã€‚è¿™æ ·å¯ä»¥æ»¡è¶³å®æ—¶è¿›ç¨‹å¯¹æˆªæ­¢æ—¶é—´çš„è¦æ±‚ã€‚ ä¸ºäº†ä½¿è°ƒåº¦è¿‡ç¨‹æ›´ç®€å•ï¼Œè°ƒåº¦å¼€é”€æ›´å°ï¼Œå¯¹äºæ”¯æŒéœ€è¦æœåŠ¡æ—¶é—´å¾ˆçŸ­çš„å°å®æ—¶è¿›ç¨‹çš„ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨éæŠ¢å å¼è°ƒåº¦ã€‚ æŠ¢å å¼è°ƒåº¦ç®—æ³•æ ¹æ®æŠ¢å CPUçš„æ—¶æœºä¸åŒï¼Œå¯ä»¥åˆ†ä¸ºåŸºäºæ—¶é’Ÿä¸­æ–­çš„æŠ¢å å’Œç«‹å³æŠ¢å ã€‚ (1) åŸºäºæ—¶é’Ÿä¸­æ–­çš„æŠ¢å å¼ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³• åœ¨é«˜ä¼˜å…ˆæƒçš„å®æ—¶è¿›ç¨‹åˆ°è¾¾åï¼Œè™½ç„¶è¯¥è¿›ç¨‹çš„ä¼˜å…ˆæƒå¤§äºæ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ï¼Œç³»ç»Ÿä¹Ÿå¹¶ä¸ç«‹å³æŠ¢å å½“å‰è¿›ç¨‹çš„å¤„ç†æœºï¼Œè€Œæ˜¯ç­‰åˆ°æœ€è¿‘ä¸€æ¬¡æ—¶é’Ÿä¸­æ–­åˆ°æ¥æ—¶ï¼Œç³»ç»Ÿæ‰å‰¥å¤ºå½“å‰è¿›ç¨‹çš„CPUï¼Œå°†CPUåˆ†é…ç»™æ–°åˆ°æ¥çš„ä¼˜å…ˆæƒæ›´é«˜çš„å®æ—¶è¿›ç¨‹ã€‚ (2) ç«‹å³æŠ¢å çš„ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³• åœ¨è¿™ç§è°ƒåº¦ç­–ç•¥ä¸­ï¼Œä¸€æ—¦æ¥æ”¶åˆ°è§¦å‘å®æ—¶è¿›ç¨‹è¿è¡Œçš„ä¿¡å·ï¼Œè¿™é€šå¸¸æ˜¯ä¸€ä¸ªå¤–éƒ¨ä¸­æ–­ä¿¡å·ï¼Œç³»ç»Ÿç«‹å³å‰¥å¤ºå½“å‰è¿›ç¨‹çš„CPUï¼ŒæŠŠå®ƒåˆ†é…ç»™è¯·æ±‚ä¸­æ–­çš„æ–°çš„å®æ—¶è¿›ç¨‹ã€‚è¿™ç§ç®—æ³•èƒ½è·å¾—æ¯”åŸºäºæ—¶é’Ÿä¸­æ–­çš„æŠ¢å å¼ä¼˜å…ˆç®—æ³•æ›´å¿«çš„å“åº”é€Ÿåº¦ã€‚ 4. å…·æœ‰å¿«é€Ÿåˆ‡æ¢æœºåˆ¶ ä¸ºä¿è¯å¯¹æˆªæ­¢æ—¶é—´è¦æ±‚è¾ƒé«˜çš„å®æ—¶è¿›ç¨‹èƒ½åŠæ—¶è¿è¡Œï¼Œåœ¨å®æ—¶ç³»ç»Ÿä¸­è¿˜åº”å…·æœ‰å¿«é€Ÿåˆ‡æ¢æœºåˆ¶ï¼Œä»¥ä¿è¯è¿›ç¨‹çš„å¿«é€Ÿåˆ‡æ¢ã€‚è¯¥æœºåˆ¶åº”å…·æœ‰ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢çš„èƒ½åŠ›ã€‚ (1) å¯¹å¤–éƒ¨ä¸­æ–­çš„å¿«é€Ÿå“åº”èƒ½åŠ› ä¸ºä½¿åœ¨ç´§è¿«çš„å¤–éƒ¨äº‹ä»¶è¯·æ±‚ä¸­æ–­æ—¶ç³»ç»Ÿèƒ½åŠæ—¶å“åº”ï¼Œè¦æ±‚ç³»ç»Ÿå…·æœ‰å¿«é€Ÿçš„ç¡¬ä»¶ä¸­æ–­æœºæ„ï¼Œè¿˜åº”ä½¿ç¦æ­¢ä¸­æ–­çš„æ—¶é—´é—´éš”å°½å¯èƒ½çŸ­ã€‚ (2) å¿«é€Ÿçš„è¿›ç¨‹åˆ‡æ¢èƒ½åŠ› åœ¨å®Œæˆè¿›ç¨‹è°ƒåº¦åè¿›è¡Œè¿›ç¨‹åˆ‡æ¢ã€‚ä¸ºäº†æé«˜è¿›ç¨‹åˆ‡æ¢æ—¶çš„é€Ÿåº¦ï¼Œåº”ä½¿ç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿è¡ŒåŠŸèƒ½å•ä½é€‚å½“åœ°å°ï¼Œä»¥å‡å°‘è¿›ç¨‹åˆ‡æ¢çš„æ—¶é—´å¼€é”€ã€‚ äºŒã€å¸¸ç”¨çš„å‡ ç§å®æ—¶è°ƒåº¦ç®—æ³• 1. æœ€æ—©æˆªæ­¢æ—¶é—´ä¼˜å…ˆEDF(Earliest Deadline First,EDF)ç®—æ³• è¯¥ç®—æ³•æ˜¯æ ¹æ®è¿›ç¨‹çš„å¼€å§‹æˆªæ­¢æ—¶é—´ç¡®å®šè¿›ç¨‹çš„ä¼˜å…ˆçº§ã€‚æˆªæ­¢æ—¶é—´è¶Šæ—©ï¼Œè¿›ç¨‹çš„ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šä¼˜å…ˆè·å¾—å¤„ç†æœºã€‚è¯¥ç®—æ³•è¦æ±‚åœ¨ç³»ç»Ÿä¸­ä¿æŒä¸€ä¸ªå®æ—¶è¿›ç¨‹çš„å°±ç»ªé˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—æŒ‰å„è¿›ç¨‹æˆªæ­¢æ—¶é—´çš„æ—©æ™šæ’åºï¼Œå…·æœ‰æœ€æ—©æˆªæ­¢æ—¶é—´çš„è¿›ç¨‹æ’åœ¨é˜Ÿåˆ—çš„æœ€å‰é¢ã€‚è°ƒåº¦ç¨‹åºåœ¨é€‰æ‹©è¿›ç¨‹æ—¶ï¼Œæ€»æ˜¯é€‰æ‹©å°±ç»ªé˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸ºä¹‹åˆ†é…å¤„ç†æœºï¼Œä½¿ä¹‹æŠ•å…¥è¿è¡Œã€‚æœ€æ—©æˆªæ­¢æ—¶é—´ä¼˜å…ˆçš„ç®—æ³•æ—¢å¯ç”¨äºæŠ¢å å¼è°ƒåº¦ï¼Œä¹Ÿå¯ç”¨äºéæŠ¢å å¼è°ƒåº¦ã€‚ 2. æœ€ä½æ¾å¼›åº¦ä¼˜å…ˆLLF(Least Laxity First,LLF)ç®—æ³• æ¾å¼›åº¦ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªå®æ—¶è¿›ç¨‹çš„ç´§è¿«ç¨‹åº¦ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹çš„å®Œæˆæˆªæ­¢æ—¶é—´ä¸ºT,å½“å‰æ—¶é—´ä¸ºTcï¼Œå¤„ç†å®Œè¯¥ä»»åŠ¡è¿˜éœ€è¦çš„æ—¶é—´ä¸ºTsï¼Œåˆ™æ¾é©°åº¦Lçš„è®¡ç®—å¼è¡¨ç¤ºä¸º L=T-Tc-Ts åœ¨ä½¿ç”¨æœ€ä½æ¾å¼›åº¦ä¼˜å…ˆç®—æ³•æ—¶ï¼Œè°ƒåº¦ç¨‹åºåœ¨è°ƒåº¦æ—¶æœºåˆ°æ¥æ—¶ï¼Œæ¯æ¬¡é€‰æ‹©æ¾å¼›åº¦Læœ€å°çš„è¿›ç¨‹ï¼ŒæŠŠCPUåˆ†é…ç»™è¯¥è¿›ç¨‹ã€‚è¯¥ç®—æ³•åœ¨å®ç°æ—¶ï¼ŒæŠŠè¿›ç¨‹æŒ‰æ¾å¼›åº¦æ’åºï¼Œè®©æ¾é©°åº¦æœ€å°çš„è¿›ç¨‹å¤„äºå°±ç»ªé˜Ÿåˆ—é˜Ÿé¦–ï¼Œè¿™æ ·è°ƒåº¦ç¨‹åºæ‰§è¡Œæ—¶åªéœ€é€‰æ‹©å°±ç»ªé˜Ÿåˆ—é˜Ÿé¦–çš„è¿›ç¨‹æ‰§è¡Œå³å¯ã€‚ ç¬¬å››èŠ‚ è¿›ç¨‹åˆ‡æ¢ å½“è¿›ç¨‹è°ƒåº¦ç¨‹åºé€‰æ‹©åˆ°ä¸€ä¸ªæ–°çš„è¿›ç¨‹åï¼Œè¦è¿›è¡Œè¿›ç¨‹åˆ‡æ¢ï¼Œç”¨æ–°é€‰æ‹©çš„è¿›ç¨‹æ›¿æ¢åŸæ¥çš„æ‰§è¡Œè¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯æŠŠCPUçš„æ§åˆ¶æƒäº¤ç»™ç”±è°ƒåº¦ç¨‹åºæ‰€é€‰æ‹©çš„è¿›ç¨‹ã€‚ è¿›ç¨‹åˆ‡æ¢ä½¿å½“å‰æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹æˆä¸ºè¢«æ›¿æ¢è¿›ç¨‹ï¼Œå‡ºè®©å…¶æ‰€ä½¿ç”¨çš„CPUï¼Œä»¥è¿è¡Œè¢«è¿›ç¨‹è°ƒåº¦ç¨‹åºé€‰ä¸­çš„æ–°è¿›ç¨‹ã€‚è¿›ç¨‹åˆ‡æ¢é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ã€‚ 1) ä¿å­˜åŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨å’Œå…¶ä»–å¯„å­˜å™¨åœ¨å†…çš„CPUä¸Šä¸‹æ–‡ç¯å¢ƒã€‚ 2) æ›´æ–°è¢«æ›¿æ¢è¿›ç¨‹çš„è¿›ç¨‹æ§åˆ¶å—ã€‚ 3) ä¿®æ”¹è¿›ç¨‹çŠ¶æ€ï¼ŒæŠŠæ‰§è¡Œæ€æ”¹ä¸ºå°±ç»ªæ€æˆ–è€…é˜»å¡æ€ã€‚ 4) å°†è¢«æ›¿æ¢è¿›ç¨‹çš„è¿›ç¨‹æ§åˆ¶å—ç§»åˆ°å°±ç»ªé˜Ÿåˆ—æˆ–é˜»å¡é˜Ÿåˆ—ã€‚ 5) æ‰§è¡Œé€šè¿‡è¿›ç¨‹è°ƒåº¦ç¨‹åºé€‰æ‹©çš„æ–°è¿›ç¨‹ï¼Œå¹¶æ›´æ–°è¯¥è¿›ç¨‹çš„è¿›ç¨‹æ§åˆ¶å—ã€‚ 6) æ›´æ–°å†…å­˜ç®¡ç†çš„æ•°æ®ç»“æ„ã€‚ 7) æ¢å¤è¢«è°ƒåº¦ç¨‹åºé€‰ä¸­çš„è¿›ç¨‹çš„ç¡¬ä»¶ä¸Šä¸‹æ–‡ã€‚ ç¬¬äº”èŠ‚ å¤šå¤„ç†å™¨è°ƒåº¦ éšç€å¯¹è®¡ç®—æœºæ€§èƒ½çš„è¦æ±‚ï¼Œå°¤å…¶æ˜¯å¯¹è®¡ç®—é€Ÿåº¦ã€å¤„ç†èƒ½åŠ›çš„è¦æ±‚è¶Šæ¥è¶Šé«˜ï¼Œå¤šå¤„ç†å™¨ç³»ç»Ÿå¾—åˆ°æ›´åŠ å¹¿æ³›çš„åº”ç”¨ï¼Œå„ç±»å¤§ã€ä¸­ã€å°å‹ä¸»æœºç³»ç»Ÿï¼Œç½‘ç»œæœåŠ¡å™¨ï¼Œä»¥åŠé«˜ç«¯çš„å·¥ä½œç«™éƒ½é‡‡ç”¨å¤šå¤„ç†å™¨ç»“æ„ï¼Œç”šè‡³ä¸ªäººå¾®æœºéƒ½ä½¿ç”¨åŒCPUã€‚æ“ä½œç³»ç»Ÿä¸è®¡ç®—æœºä½“ç³»ç»“æ„æœ‰ç€å¤©ç„¶çš„è”ç³»ï¼Œé¢å¯¹å¤šå¤„ç†å™¨ç³»ç»Ÿï¼Œå¿…é¡»è§£å†³å¤šå¤„ç†å™¨çš„è¿›ç¨‹è°ƒåº¦é—®é¢˜ã€‚ ä¸€ã€å¤šå¤„ç†å™¨ç³»ç»Ÿ(MultiProcessor Systems,MPS)çš„ç±»å‹ å¯¹å¤„ç†å™¨ç³»ç»Ÿæœ‰å¤šç§ä¸åŒçš„åˆ†ç±»æ–¹å¼ï¼Œæ ¹æ®å¤„ç†å™¨çš„è€¦åˆç¨‹åº¦ï¼Œå¯ä»¥æŠŠå¤šå¤„ç†å™¨ç³»ç»Ÿåˆ†ä¸ºç´§å¯†è€¦åˆå¤šå¤„ç†å™¨ç³»ç»Ÿå’Œæ¾å¼›è€¦åˆå¤šå¤„ç†å™¨ç³»ç»Ÿï¼›æ ¹æ®å¤„ç†å™¨ç»“æ„æ˜¯å¦ç›¸åŒï¼Œå¯ä»¥æŠŠå¤šå¤„ç†å™¨ç³»ç»Ÿåˆ†ä¸ºå¯¹ç§°å¤šå¤„ç†å™¨ç³»ç»Ÿå’Œéå¯¹ç§°å¤šå¤„ç†å™¨ç³»ç»Ÿã€‚ 1. ç´§å¯†è€¦åˆçš„å¤šå¤„ç†å™¨ç³»ç»Ÿå’Œæ¾å¼›è€¦åˆçš„å¤šå¤„ç†å™¨ç³»ç»Ÿ (1) ç´§å¯†è€¦åˆçš„å¤šå¤„ç†å™¨ç³»ç»Ÿ ç´§å¯†è€¦åˆçš„å¤šå¤„ç†å™¨ç³»ç»Ÿé€šå¸¸é€šè¿‡é«˜é€Ÿæ€»çº¿æˆ–é«˜é€Ÿäº¤å‰å¼€å…³å®ç°å¤šä¸ªå¤„ç†å™¨ä¹‹é—´çš„äº’è¿ï¼Œå®ƒä»¬å…±äº«ä¸»å­˜å‚¨å™¨ç³»ç»Ÿå’ŒI/Oè®¾å¤‡ï¼Œå¹¶è¦æ±‚å°†ä¸»å­˜å‚¨å™¨åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªç‹¬ç«‹è®¿é—®çš„å­˜å‚¨å™¨æ¨¡å—ï¼Œä»¥ä¾¿å¤šä¸ªå¤„ç†å™¨èƒ½åŒæ—¶å¯¹ä¸»å­˜è¿›è¡Œè®¿é—®ã€‚ç³»ç»Ÿä¸­çš„æ‰€æœ‰èµ„æºå’Œè¿›ç¨‹éƒ½ç”±æ“ä½œç³»ç»Ÿå®æ–½ç»Ÿä¸€çš„æ§åˆ¶å’Œç®¡ç†ã€‚ (2) æ¾å¼›è€¦åˆçš„å¤šå¤„ç†å™¨ç³»ç»Ÿ æ¾å¼›è€¦åˆçš„å¤šå¤„ç†å™¨ç³»ç»Ÿé€šå¸¸é€šè¿‡é€šé“æˆ–é€šä¿¡çº¿è·¯æ¥å®ç°å¤šå°è®¡ç®—æœºä¹‹é—´çš„äº’è¿ã€‚æ¯å°è®¡ç®—æœºéƒ½æœ‰è‡ªå·±çš„å­˜å‚¨å™¨å’ŒI/Oè®¾å¤‡ï¼Œå¹¶é…ç½®äº†æ“ä½œç³»ç»Ÿæ¥ç®¡ç†æœ¬åœ°èµ„æºå’Œåœ¨æœ¬åœ°è¿è¡Œçš„è¿›ç¨‹ã€‚å› æ­¤ï¼Œæ¯ä¸€å°è®¡ç®—æœºéƒ½èƒ½ç‹¬ç«‹å·¥ä½œï¼Œå¿…è¦æ—¶å¯é€šè¿‡é€šä¿¡çº¿è·¯ä¸å…¶ä»–è®¡ç®—æœºäº¤æ¢ä¿¡æ¯ï¼Œä»¥åŠåè°ƒå®ƒä»¬ä¹‹é—´çš„å·¥ä½œã€‚ 2. å¯¹ç§°å¤šå¤„ç†å™¨ç³»ç»Ÿå’Œéå¯¹ç§°å¤šå¤„ç†å™¨ç³»ç»Ÿ å¯¹ç§°å¤šå¤„ç†å™¨ç³»ç»Ÿå±äºåŒæ„çš„å¤šå¤„ç†å™¨ç³»ç»Ÿï¼Œå…¶ä¸­æ‰€åŒ…å«çš„å„å¤„ç†å•å…ƒï¼Œåœ¨åŠŸèƒ½å’Œç»“æ„ä¸Šéƒ½æ˜¯ç›¸åŒçš„ï¼Œå½“å‰çš„ç»å¤§å¤šæ•°å¤šå¤„ç†å™¨ç³»ç»Ÿéƒ½æ˜¯å¯¹ç§°å¤šå¤„ç†å™¨ç³»ç»Ÿ éå¯¹ç§°å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­æœ‰å¤šç§ç±»å‹çš„å¤„ç†å•å…ƒï¼Œå®ƒä»¬çš„åŠŸèƒ½å’Œç»“æ„å„ä¸ç›¸åŒã€‚å…¶ä¸­åªæœ‰ä¸€ä¸ªä¸»å¤„ç†å™¨ï¼Œæœ‰å¤šä¸ªä»å¤„ç†å™¨ã€‚ äºŒã€å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­çš„è¿›ç¨‹åˆ†é…æ–¹å¼ 1. å¯¹ç§°å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­çš„è¿›ç¨‹åˆ†é…æ–¹å¼ åœ¨å¯¹ç§°å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹åˆ°å¤„ç†å™¨çš„åˆ†é…å¯ä»¥é‡‡ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹å¼ã€‚ (1) é™æ€åˆ†é… åœ¨é‡‡ç”¨è¿™ç§åˆ†é…æ–¹å¼æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªå¤„ç†å™¨å»ºç«‹ä¸€ä¸ªä¸“é—¨çš„å°±ç»ªé˜Ÿåˆ—ï¼Œè¯¥å°±ç»ªé˜Ÿåˆ—çš„æ¯ä¸ªè¿›ç¨‹éƒ½åªèƒ½åœ¨ä¸å°±ç»ªé˜Ÿåˆ—å¯¹åº”çš„å¤„ç†å™¨ä¸Šè¿è¡Œã€‚ä¸€ä¸ªè¿›ç¨‹æ— è®ºç»è¿‡å¤šå°‘æ¬¡è°ƒåº¦ï¼Œæ“ä½œç³»ç»Ÿéƒ½æŠŠåŒä¸€ä¸ªå¤„ç†å™¨åˆ†é…ç»™è¯¥è¿›ç¨‹ã€‚é™æ€åˆ†é…æ–¹å¼çš„ä¼˜ç‚¹æ˜¯è¿›ç¨‹è°ƒåº¦çš„å¼€é”€å°ï¼Œç¼ºç‚¹æ˜¯ä¸ èƒ½åŠ¨æ€åœ°å¹³è¡¡å„å¤„ç†å™¨çš„è´Ÿè½½ï¼Œä½¿ç³»ç»Ÿå­˜åœ¨å„å¤„ç†å™¨å¿™é—²ä¸å‡çš„æƒ…å†µã€‚ (2) åŠ¨æ€åˆ†é… åŠ¨æ€åˆ†é…çš„åŸºæœ¬ç‰¹å¾å°±æ˜¯æ¯ä¸ªè¿›ç¨‹ç»è¿‡å¤šæ¬¡è°ƒåº¦ï¼Œæ¯æ¬¡è·å¾—çš„ä¸ä¸€å®šæ˜¯åŒä¸€ä¸ªå¤„ç†å™¨ã€‚ä¸ºå®ç°åŠ¨æ€åˆ†é…ï¼Œå¯ä»¥åœ¨ç³»ç»Ÿä¸­è®¾ç½®ä¸€ä¸ªå…¬å…±çš„å°±ç»ªé˜Ÿåˆ—ï¼Œç³»ç»Ÿä¸­çš„æ‰€æœ‰å°±ç»ªè¿›ç¨‹éƒ½è¢«æ”¾åœ¨ è¯¥é˜Ÿåˆ—ä¸­ã€‚å¯å°†è¿›ç¨‹åˆ†é…åˆ°ä»»ä½•ä¸€ä¸ªå¤„ç†å™¨ä¸Šï¼Œè¿™æ ·ï¼Œå¯¹ä¸€ä¸ªè¿›ç¨‹çš„æ•´ä¸ªè¿è¡Œè¿‡ç¨‹è€Œè¨€ï¼Œåœ¨æ¯æ¬¡è¢«è°ƒåº¦æ‰§è¡Œæ—¶ï¼Œéƒ½æ˜¯éšæœºåœ°è¢«åˆ†é…åˆ°å½“æ—¶å¤„äºç©ºé—²çŠ¶æ€çš„æŸä¸€å¤„ç†å™¨ä¸Šå»æ‰§è¡Œã€‚ä¾‹å¦‚ï¼ŒæŸè¿›ç¨‹ä¸€å¼€å§‹è¢«åˆ†é…åˆ°å¤„ç†å™¨Aä¸Šæ‰§è¡Œï¼Œåæ¥å› ä¸ºé˜»å¡æˆ–æ—¶é—´ç‰‡ç”¨å®Œè€Œæš‚åœæ‰§è¡Œï¼Œå½“å†æ¬¡å›åˆ°å…¬å…±å°±ç»ªé˜Ÿåˆ—ä¸­ï¼Œé‡æ–°è¢«è°ƒåº¦æ—¶ï¼Œè¯¥è¿›ç¨‹å¯èƒ½è¢«åˆ†é…åˆ°Bå¤„ç†å™¨æˆ–Cå¤„ç†å™¨ä¸Šè¿è¡Œã€‚åŠ¨æ€åˆ†é…çš„ä¼˜ç‚¹æ˜¯å¯ä»¥åœ¨æ¯æ¬¡è°ƒåº¦æ—¶è€ƒè™‘å¤„ç†å™¨çš„è´Ÿè½½å¹³è¡¡é—®é¢˜ï¼Œæ€»æ˜¯æŠŠè¿›ç¨‹åˆ†é…ç»™å½“å‰ç©º é—²çš„å¤„ç†å™¨ã€‚æ­¤å¤–ï¼Œå¯¹äºå…±äº«å­˜å‚¨å™¨çš„ç´§å¯†è€¦åˆç³»ç»Ÿï¼Œæ‰€æœ‰çš„å¤„ç†å™¨å¯ä»¥å…±äº«ä¿å­˜åœ¨å†…å­˜ä¸­ çš„è¿›ç¨‹ä¿¡æ¯ã€‚ 2. éå¯¹ç§°å¤šå¤„ç†å™¨ç³»ç»Ÿ(MPS)ä¸­çš„è¿›ç¨‹åˆ†é…æ–¹å¼ å¯¹äºéå¯¹ç§°å¤šå¤„ç†å™¨ç³»ç»Ÿï¼Œå¤§å¤šé‡‡ç”¨ä¸»ä¸€ä»å¼æ“ä½œç³»ç»Ÿï¼Œå³æ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒéƒ¨åˆ†é©»ç•™åœ¨ä¸€å°ä¸»æœºä¸Šï¼Œè€Œä»æœºä¸Šåªè¿è¡Œç”¨æˆ·ç¨‹åºï¼Œåªæœ‰ä¸»æœºæ‰§è¡Œè°ƒåº¦ç¨‹åºï¼Œæ‰€æœ‰ä¸›æœºçš„è¿›ç¨‹éƒ½æ˜¯ç”±ä¸»æœºåˆ†é…çš„ã€‚æ¯å½“ä»æœºç©ºé—²æ—¶ï¼Œä¾¿å‘ä¸»æœºå‘é€ä¸€ä¸ªè¯·æ±‚åˆ†é…è¿›ç¨‹çš„ä¿¡å·ï¼Œç„¶åä¾¿ç­‰å¾…ä¸»æœºä¸ºå®ƒåˆ†é…è¿›ç¨‹ã€‚åœ¨ä¸»æœºä¸­ä¿æŒæœ‰ä¸€ä¸ªå°±ç»ªé˜Ÿåˆ—ï¼Œåªè¦å°±ç»ªé˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œä¸»æœºä¾¿ä»å…¶é˜Ÿé¦–æ‘˜ä¸‹ä¸€ä¸ªè¿›ç¨‹åˆ†é…ç»™è¯·æ±‚åˆ†é…è¿›ç¨‹çš„ä»æœºã€‚ä»æœºæ¥æ”¶åˆ°åˆ†é…çš„è¿›ç¨‹åä¾¿è¿è¡Œè¯¥è¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹ç»“æŸåä»æœºåˆå‘ä¸»æœºå‘å‡ºè¯·æ±‚ã€‚ åœ¨éå¯¹ç§°å¤šå¤„ç†ç³»ç»Ÿä¸­ï¼Œä¸»ã€ä»å¼çš„è¿›ç¨‹åˆ†é…æ–¹å¼çš„ä¸»è¦ä¼˜ç‚¹æ˜¯ç³»ç»Ÿå¤„ç†æ¯”è¾ƒç®€å•ã€‚è¿™æ˜¯å› ä¸ºæ‰€æœ‰çš„è¿›ç¨‹åˆ†é…éƒ½ç”±ä¸€å°ä¸»æœºç‹¬è‡ªå¤„ç†ï¼Œä½¿è¿›ç¨‹é—´çš„åŒæ­¥é—®é¢˜å¾—ä»¥ç®€åŒ–ï¼Œå¹¶ä¸”è¿›ç¨‹è°ƒåº¦ç¨‹åºä¹Ÿå¾ˆæ˜“äºä»å•å¤„ç†å™¨çš„è¿›ç¨‹è°ƒåº¦ç¨‹åºæ¼”åŒ–è€Œæ¥ã€‚ä½†ç”±ä¸€å°ä¸»æœºæ§åˆ¶ä¸€åˆ‡ï¼Œä¹Ÿå­˜åœ¨ç€ä¸å¯é æ€§ï¼Œä¸»æœºä¸€æ—¦å‡ºç°æ•…éšœï¼Œä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿç˜«ç—ªï¼Œè€Œä¸”ä¹Ÿå®¹æ˜“å› ä¸»æœºå¤ªå¿™è€Œå½¢æˆç³»ç»Ÿç“¶ é¢ˆã€‚å…‹æœè¿™äº›ç¼ºç‚¹çš„æœ‰æ•ˆæ–¹æ³•æ˜¯åˆ©ç”¨å¤šå°å¤„ç†å™¨æ¥ç®¡ç†æ•´ä¸ªç³»ç»Ÿã€‚è¿™æ ·ï¼Œå½“å…¶ä¸­ä¸€å°å¤„ç†å™¨å‡ºç°æ•…éšœæ—¶ï¼Œå¯ç”±å…¶ä»–å¤„ç†å™¨æ¥æ¥æ›¿å…¶å®Œæˆä»»åŠ¡ï¼Œä¸å½±å“ç³»ç»Ÿæ­£å¸¸è¿è¡Œã€‚è€Œä¸”ç”¨å¤šåˆå¤„ç†å™¨è¿˜å…·æœ‰æ›´å¼ºçš„æ‰§è¡Œç®¡ç†ä»»åŠ¡çš„èƒ½åŠ›ï¼Œä¹Ÿä¸å®¹æ˜“å½¢æˆç³»ç»Ÿç“¶é¢ˆã€‚ ä¸‰ã€è¿›ç¨‹ï¼ˆçº¿ç¨‹ï¼‰è°ƒåº¦æ–¹å¼ å¤šå¤„ç†å™¨çš„è°ƒåº¦æ¯”å•å¤„ç†å™¨è°ƒåº¦æœºåˆ¶è¦å¤æ‚ï¼Œä¸‹é¢ç®€è¦ä»‹ç»å‡ ç§æ¯”è¾ƒå…¸å‹çš„å¤šå¤„ç†å™¨è°ƒåº¦æ–¹å¼ã€‚ 1. è‡ªè°ƒåº¦ è‡ªè°ƒåº¦ç®—æ³•æ˜¯å½“å‰å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­æœ€å¸¸ç”¨çš„è°ƒåº¦æ–¹å¼ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„ä¸€ç§è°ƒåº¦æ–¹å¼ã€‚é‡‡ç”¨è‡ªè°ƒåº¦çš„ç³»ç»Ÿä¸­è®¾ç½®æœ‰ä¸€ä¸ªå…¬å…±çš„å°±ç»ªé˜Ÿåˆ—ï¼Œä»»ä½•ä¸€ä¸ªç©ºé—²çš„å¤„ç†å™¨éƒ½å¯ä»¥è‡ªè¡Œä»è¯¥å°±ç»ªé˜Ÿåˆ—ä¸­é€‰å–ä¸€ä¸ªè¿›ç¨‹æˆ–è€…ä¸€ä¸ªçº¿ç¨‹è¿è¡Œã€‚åœ¨è‡ªè°ƒåº¦æ–¹å¼ä¸­ï¼Œå¯é‡‡ç”¨åœ¨å•å¤„ç†å™¨ç¯å¢ƒä¸‹æ‰€ç”¨çš„è°ƒåº¦ç®—æ³•ï¼Œå¦‚å…ˆæ¥å…ˆæœåŠ¡(First-Come,First-Service,FCFS)è°ƒåº¦ç®—æ³•ã€æœ€é«˜ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•ç­‰ã€‚åœ¨å¤šå¤„ç†å™¨ç¯å¢ƒä¸‹ï¼ŒFCFSæ˜¯ä¸€ç§è¾ƒå¥½çš„è‡ªè°ƒåº¦ç®—æ³•ï¼Œç®—æ³•ç®€å•ï¼Œå¼€é”€å°ã€‚ (1) è‡ªè°ƒåº¦ç®—æ³•çš„ä¼˜ç‚¹ 1) æ˜“ç§»æ¤ã€‚åœ¨é‡‡ç”¨è‡ªè°ƒåº¦æ–¹å¼çš„ç³»ç»Ÿä¸­ï¼Œå…¬å…±å°±ç»ªé˜Ÿåˆ—å¯æŒ‰ç…§å•å¤„ç†å™¨ç³»ç»Ÿä¸­æ‰€é‡‡ç”¨çš„å„ç§ç»„ç»‡æ–¹å¼åŠ ä»¥ç»„ç»‡ï¼Œå…¶è°ƒåº¦ç®—æ³•ä¹Ÿå¯æ²¿ç”¨å•å¤„ç†å™¨ç³»ç»Ÿæ‰€ç”¨çš„ç®—æ³•ï¼Œå› æ­¤ï¼Œå¾ˆå®¹æ˜“å°†å•å¤„ç†å™¨ç¯å¢ƒä¸‹çš„è°ƒåº¦æœºåˆ¶ç§»æ¤åˆ°å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ã€‚ 2) æœ‰åˆ©äºæé«˜CPUçš„åˆ©ç”¨ç‡ã€‚åªè¦ç³»ç»Ÿä¸­æœ‰ä»»åŠ¡ï¼Œæˆ–è€…è¯´åªè¦å…¬å…±å°±ç»ªé˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œå°±ä¸ä¼šå‡ºç°å¤„ç†å™¨ç©ºé—²çš„æƒ…å†µï¼Œä¹Ÿä¸ä¼šå‘ç”Ÿå¤„ç†å™¨å¿™é—²ä¸å‡çš„ç°è±¡ï¼Œå› è€Œæœ‰åˆ©äºæé«˜å¤„ç†å™¨ çš„åˆ©ç”¨ç‡ã€‚ (2) è‡ªè°ƒåº¦æ–¹å¼çš„ç¼ºç‚¹ 1) ç“¶é¢ˆé—®é¢˜ã€‚é‡‡ç”¨è‡ªè°ƒåº¦ï¼Œåœ¨æ•´ä¸ªç³»ç»Ÿä¸­åªæœ‰ä¸€ä¸ªå¿…é¡»äº’æ–¥è®¿é—®çš„å…¬å…±å°±ç»ªé˜Ÿåˆ—ã€‚åœ¨ç³»ç»Ÿä¸­æœ‰å¤šä¸ªå¤„ç†å™¨çš„æƒ…å†µä¸‹ï¼Œå¯¹å…¬å…±å°±ç»ªé˜Ÿåˆ—çš„è®¿é—®å¾ˆå®¹æ˜“å½¢æˆç“¶é¢ˆã€‚å½“ç³»ç»Ÿä¸­å¤„ç†å™¨çš„æ•°ç›®åœ¨æ•°åä¸ªï¼Œç”šè‡³æ•°ç™¾ä¸ªæ—¶ï¼Œé‡‡ç”¨è‡ªè°ƒåº¦ç®—æ³•ç“¶é¢ˆé—®é¢˜ä¼šéå¸¸ä¸¥é‡ã€‚ 2) ä½æ•ˆæ€§ã€‚é‡‡ç”¨è‡ªè°ƒåº¦ç®—æ³•ï¼ŒCPUä¸Šçš„é«˜é€Ÿç¼“å­˜çš„å‘½ä¸­ç‡è¾ƒä½ã€‚å½“è¿›ç¨‹é˜»å¡åå†é‡æ–°å°±ç»ªæ—¶ï¼Œå®ƒåªèƒ½è¿›å…¥å”¯ä¸€çš„å…¬å…±å°±ç»ªé˜Ÿåˆ—ï¼Œç»è¿‡è¿›ç¨‹è°ƒåº¦åï¼Œä¸ä¸€å®šèƒ½åœ¨é˜»å¡å‰çš„å¤„ç†å™¨ä¸Šè¿è¡Œã€‚å¦‚æœåœ¨æ¯å°å¤„ç†å™¨ä¸Šéƒ½é…æœ‰é«˜é€Ÿç¼“å­˜ï¼Œåˆ™è¿™æ—¶åœ¨å…¶ä¸­ä¿ç•™çš„è¯¥è¿›ç¨‹çš„æ•°æ®å·²ç»å¤±æ•ˆï¼Œè€Œåœ¨è¯¥è¿›ç¨‹æ–°è·å¾—çš„å¤„ç†å™¨ä¸Šåˆéœ€è¦é‡æ–°å»ºç«‹è¿™äº›æ•°æ®çš„å¤‡ä»½ã€‚ç”±äºä¸€ä¸ªè¿›ç¨‹çš„æ•´ä¸ªç”Ÿå‘½æœŸä¸­ï¼Œå¯èƒ½è¦å¤šæ¬¡æ›´æ¢å¤„ç†å™¨ï¼Œå› è€Œä½¿é«˜é€Ÿç¼“å­˜çš„å‘½ä¸­ç‡å¾ˆä½ã€‚ 3) çº¿ç¨‹åˆ‡æ¢é¢‘ç¹ã€‚åœ¨å¤šçº¿ç¨‹ç³»ç»Ÿä¸­ï¼Œé€šå¸¸ä¸€ä¸ªåº”ç”¨ä¸­çš„å¤šä¸ªçº¿ç¨‹æ˜¯ç›¸äº’åˆä½œçš„å…³ç³»ã€‚è€Œé‡‡ç”¨è‡ªè°ƒåº¦æ—¶ï¼Œç›¸äº’åˆä½œçš„çº¿ç¨‹å¾ˆéš¾åŒæ—¶è·å¾—å¤„ç†å™¨è¿è¡Œï¼Œè¿™å°†ä¼šä½¿æŸäº›çº¿ç¨‹å› å…¶åˆä½œçº¿ç¨‹æœªè·å¾—å¤„ç†å™¨è¿è¡Œè€Œé˜»å¡ï¼Œè¿›è€Œè¢«åˆ‡æ¢ä¸‹æ¥ã€‚ 2. æˆç»„è°ƒåº¦ æˆç»„è°ƒåº¦æ–¹å¼æ˜¯ç”±ç³»ç»Ÿå°†ä¸€ç»„ç›¸äº’åˆä½œçš„è¿›ç¨‹æˆ–çº¿ç¨‹åŒæ—¶åˆ†é…åˆ°ä¸€ç»„å¤„ç†å™¨ä¸Šè¿è¡Œï¼Œè¿› ç¨‹æˆ–çº¿ç¨‹ä¸å¤„ç†å™¨ä¸€ä¸€å¯¹åº”ã€‚ (1) æˆç»„è°ƒåº¦çš„ä¼˜ç‚¹ 1) å‡å°‘çº¿ç¨‹åˆ‡æ¢ï¼Œæ”¹å–„ç³»ç»Ÿæ€§èƒ½ã€‚å¦‚æœä¸€ç»„ç›¸äº’åˆä½œçš„çº¿ç¨‹æˆ–è¿›ç¨‹èƒ½å¹¶è¡Œæ‰§è¡Œï¼Œåˆ™èƒ½ æœ‰æ•ˆå‡å°‘è¿›ç¨‹ï¼ˆçº¿ç¨‹ï¼‰é˜»å¡æƒ…å†µçš„å‘ç”Ÿï¼Œä»è€Œå‡å°‘çº¿ç¨‹çš„åˆ‡æ¢ï¼Œä½¿ç³»ç»Ÿæ€§èƒ½å¾—åˆ°æ”¹å–„ã€‚ 2) å‡å°‘è°ƒåº¦å¼€é”€ã€‚å› ä¸ºæ¯æ¬¡è°ƒåº¦éƒ½å¯ä»¥è§£å†³ä¸€ç»„çº¿ç¨‹çš„å¤„ç†å™¨åˆ†é…é—®é¢˜ï¼Œå› è€Œå¯ä»¥æ˜¾ è‘—å‡å°‘è°ƒåº¦é¢‘ç‡ï¼Œä»è€Œå‡å°‘è°ƒåº¦å¼€é”€ã€‚ (2) æˆç»„è°ƒåº¦ä¸­çš„æ—¶é—´åˆ†é… åœ¨æˆç»„è°ƒåº¦ä¸­å¯ä»¥é‡‡ç”¨ä¸¤ç§æ–¹å¼ä¸ºåº”ç”¨ç¨‹åºåˆ†é…å¤„ç†å™¨æ—¶é—´ï¼šä¸€æ˜¯é¢å‘æ‰€æœ‰çš„åº”ç”¨ç¨‹åºå¹³å‡åˆ†é…å¤„ç†å™¨æ—¶é—´ï¼›äºŒæ˜¯é¢å‘æ‰€æœ‰çš„çº¿ç¨‹å¹³å‡åˆ†é…å¤„ç†å™¨æ—¶é—´ã€‚ 3. ä¸“ç”¨å¤„ç†å™¨åˆ†é… 1989å¹´ç”±Tuckeræå‡ºäº†ä¸“ç”¨å¤„ç†å™¨åˆ†é…æ–¹å¼ã€‚è¯¥æ–¹å¼æ˜¯åœ¨ä¸€ä¸ªåº”ç”¨ç¨‹åºæ‰§è¡ŒæœŸé—´ï¼Œä¸“é—¨ä¸ºè¯¥åº”ç”¨ç¨‹åºåˆ†é…ä¸€ç»„å¤„ç†å™¨ï¼Œæ¯ä¸ªçº¿ç¨‹ä¸€ä¸ªï¼Œè¿™ç»„å¤„ç†å™¨ä¾›è¯¥åº”ç”¨ç¨‹åºä¸“ç”¨ï¼Œç›´è‡³åº”ç”¨ ç¨‹åºå®Œæˆã€‚è¿™ç§æ–¹å¼ä¼šé€ æˆå¤„ç†å™¨èµ„æºçš„ä¸¥é‡æµªè´¹ã€‚å› ä¸ºå½“ä¸€ä¸ªå¤„ç†å™¨ä¸Šçš„çº¿ç¨‹è¢«é˜»å¡æ—¶ï¼Œå¤„ç†å™¨ä¸èƒ½åˆ†é…ç»™åˆ«çš„çº¿ç¨‹ä½¿ç”¨ï¼Œåªèƒ½ç©ºç­‰ã€‚ä¾‹å¦‚ï¼Œæœ‰ä¸€ä¸ªçº¿ç¨‹ä¸ºäº†ä¸å¦ä¸€ä¸ªçº¿ç¨‹åŒæ­¥è€Œè¢« é˜»å¡èµ·æ¥ï¼Œåˆ™è¯¥çº¿ç¨‹æ‰€åˆ†é…åˆ°çš„å¤„ç†å™¨å°±ä¼šç©ºé—²ã€‚ ä¹‹æ‰€ä»¥å¯ä»¥å°†è¿™ç§ä¸“ç”¨å¤„ç†å™¨è°ƒåº¦æ–¹å¼ç”¨äºå¹¶å‘ç¨‹åº¦é«˜å¾—å¤šçš„å¤„ç†å™¨ç¯å¢ƒï¼Œæ˜¯å› ä¸ºåœ¨å…·æœ‰æ•°åä¸ªä¹ƒè‡³ä¸Šç™¾ä¸ªå¤„ç†å™¨çš„å¹¶è¡Œç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªå¤„ç†å™¨çš„æŠ•èµ„è´¹ç”¨åœ¨æ•´ä¸ªç³»ç»Ÿä¸­ä»…å å¾ˆå°çš„æ¯”é‡ã€‚å¯¹æ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½å’Œæ•ˆç‡è€Œè¨€ï¼Œå•ä¸ªå¤„ç†å™¨çš„ä½¿ç”¨æ•ˆç‡å¹¶ä¸åƒåœ¨å•å¤„ç†å™¨ç³»ç»Ÿä¸­é‚£ä¹ˆé‡è¦ã€‚å…¶æ¬¡ï¼Œåœ¨ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„æ•´ä¸ªè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œç”±äºæ¯ä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹ä¸“ç”¨ä¸€å°å¤„ç†å™¨ï¼Œå› æ­¤å¯ä»¥å®Œå…¨é¿å…è¿›ç¨‹æˆ–çº¿ç¨‹çš„åˆ‡æ¢ï¼Œä»è€Œå¯ä»¥å¤§å¤§åŠ é€Ÿç¨‹åºçš„å®Œæˆã€‚æ€»çš„æ¥è¯´ï¼Œä¸“ç”¨å¤„ç†å™¨çš„ä¼˜ç‚¹ä¸€æ˜¯åŠ é€Ÿäº†åº”ç”¨ç¨‹åºçš„è¿è¡Œé€Ÿåº¦ï¼ŒäºŒæ˜¯é¿å…äº†è¿›ç¨‹åˆ‡æ¢ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬ä¸‰ç« _è¿›ç¨‹è°ƒåº¦ä¸æ­»é”/ç¬¬å…­èŠ‚_æ­»é”.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬ä¸‰ç« _è¿›ç¨‹è°ƒåº¦ä¸æ­»é”/ç¬¬å…­èŠ‚_æ­»é”.html","title":"ç¬¬å…­èŠ‚ æ­»é”","keywords":"","body":"ç¬¬å…­èŠ‚ æ­»é” ä¸€ã€äº§ç”Ÿæ­»é”çš„åŸå› å’Œå¿…è¦æ¡ä»¶ åœ¨å¤šé“ç¨‹åºç³»ç»Ÿä¸­ï¼Œå¤šä¸ªè¿›ç¨‹å¯èƒ½ç«äº‰æ•°é‡æœ‰é™çš„èµ„æºã€‚å¦‚æœä¸€ä¸ªè¿›ç¨‹æ‰€ç”³è¯·çš„èµ„æºè¢«å…¶ä»–å¤„äºé˜»å¡çŠ¶æ€çš„è¿›ç¨‹å æœ‰ï¼Œè¯¥è¿›ç¨‹å°±ä¼šå› ä¸ºä¸èƒ½è·å¾—æ‰€ç”³è¯·çš„èµ„æºè€Œè¢«é˜»å¡ã€‚è‹¥æ­¤æ—¶è¯¥è¿›ç¨‹æ°å¥½åˆå æœ‰äº†å‰è¿°å…¶ä»–è¿›ç¨‹æ‰€éœ€è¦çš„èµ„æºï¼Œé‚£ä¹ˆè¿™ä¸€ç»„è¿›ç¨‹å°±å¯èƒ½å› ä¸ºç­‰å¾…é‡Šæ”¾è‡ªå·±æ‰€éœ€è¦ä½†è¢«å…¶ä»–è¿›ç¨‹å·²å æœ‰çš„èµ„æºè€Œæ— æ³•å‘å‰æ¨è¿›ã€‚è¿™ç§ç”±äºå¤šä¸ªè¿›ç¨‹ç«äº‰å…±äº«èµ„æºè€Œå¼•èµ·çš„è¿›ç¨‹ä¸èƒ½å‘å‰æ¨è¿›çš„åƒµæ­»çŠ¶æ€ç§°ä¸ºæ­»é”ã€‚ 1. äº§ç”Ÿæ­»é”çš„åŸå›  è¿›ç¨‹è®¿é—®èµ„æºæ˜¯é€šè¿‡æ‰§è¡Œç¨‹åºå®ç°çš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿›ç¨‹æŒ‰ç…§ç”³è¯·èµ„æºã€è®¿é—®èµ„æºå’Œé‡Šæ”¾èµ„æºçš„é¡ºåºä½¿ç”¨èµ„æºã€‚äº§ç”Ÿæ­»é”çš„åŸå› ä¸ºï¼šç«äº‰å…±äº«èµ„æºä¸”åˆ†é…èµ„æºçš„é¡ºåºä¸å½“ã€‚ 2. äº§ç”Ÿæ­»é”çš„å¿…è¦æ¡ä»¶ æ­»é”äº§ç”Ÿæ—¶ï¼Œå¿…é¡»åŒæ—¶æ»¡è¶³ä¸‹åˆ—4ä¸ªæ¡ä»¶ã€‚ (1) äº’æ–¥æ¡ä»¶ æŒ‡ä¸€ä¸ªè¿›ç¨‹åœ¨è®¿é—®èµ„æºçš„è¿‡ç¨‹ä¸­ï¼Œå…¶ä»–è¿›ç¨‹ä¸èƒ½è®¿é—®è¯¥èµ„æºã€‚å¦‚æœä¸€ä¸ªèµ„æºæ­£åœ¨è¢«è®¿é—®æ—¶ï¼Œæœ‰å…¶ä»–è¿›ç¨‹ä¹Ÿæå‡ºå¯¹è¯¥èµ„æºçš„è®¿é—®è¯·æ±‚ï¼Œå¿…é¡»æŠŠè¯·æ±‚è¯¥èµ„æºçš„è¿›ç¨‹é˜»å¡èµ·æ¥ï¼Œç›´åˆ°èµ„æºè¢«è¿›ç¨‹é‡Šæ”¾ã€‚ (2) è¯·æ±‚å’Œä¿æŒæ¡ä»¶ è¿›ç¨‹å·²ç»ä¿æŒäº†è‡³å°‘ä¸€ä¸ªèµ„æºï¼Œåˆæå‡ºäº†æ–°çš„èµ„æºè¦æ±‚ï¼Œè€Œæ–°è¯·æ±‚çš„èµ„æºå·²ç»è¢«å…¶ä»–è¿›ç¨‹å æœ‰ï¼Œæ­¤æ—¶è¿›ç¨‹é˜»å¡ï¼Œä½†åˆå¯¹å·²ç»è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ï¼Œä½¿å¾—å…¶ä»–è¿›ç¨‹æ— æ³•ä½¿ç”¨è¢«ä¿æŒçš„èµ„æºã€‚ä¸¾ä¾‹è¯´æ˜ï¼šè¿›ç¨‹P1è·å¾—äº†èµ„æºAçš„è®¿é—´æƒï¼Œç„¶ååˆè¯·æ±‚èµ„æºBã€‚ä½†æ˜¯èµ„æºBå› ä¸ºè¢«åˆ«çš„è¿›ç¨‹å ç”¨è€Œæ— æ³•åˆ†é…ç»™è¿›ç¨‹p1ã€‚é€šå¸¸ï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠpé˜»å¡èµ·æ¥ï¼Œæ’å…¥èµ„æºBçš„ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚p1è¢«é˜»å¡å´æ²¡æœ‰é‡Šæ”¾å¯¹èµ„æºAçš„è®¿é—®æƒã€‚è¿™æ—¶å°±å‡ºç°äº†p1è¯·æ±‚èµ„æºBè€Œä¿æŒèµ„æºAçš„æ¡ä»¶ã€‚ (3) ä¸å‰¥å¤ºæ¡ä»¶ è¿›ç¨‹å·²ç»è·å¾—çš„èµ„æºä¸èƒ½è¢«å‰¥å¤ºï¼Œåªèƒ½ç”±è¿›ç¨‹è‡ªå·±é‡Šæ”¾ã€‚ä¾‹å¦‚ï¼Œè¿›ç¨‹p1è·å¾—äº†èµ„æºAçš„è®¿é—®æƒï¼Œè¿›ç¨‹p2å†ç”³è¯·è®¿é—´èµ„æºAï¼Œå³ä½¿è¿›ç¨‹p1å› ä¸ºæŸç§åŸå› è¢«é˜»å¡ï¼Œæš‚æ—¶ä¸éœ€è¦ä½¿ç”¨èµ„æºA,è¿›ç¨‹p2ä¹Ÿä¸èƒ½é€šè¿‡ç³»ç»Ÿå‰¥å¤ºèµ„æºAçš„è®¿é—®æƒï¼Œåªèƒ½ç­‰å¾…è¿›ç¨‹p1é‡Šæ”¾å¯¹èµ„æºAçš„è®¿é—®æƒã€‚ (4) ç¯è·¯ç­‰å¾…æ¡ä»¶ åœ¨å‘ç”Ÿæ­»é”æ—¶ï¼Œå¿…ç„¶å­˜åœ¨ä¸€ä¸ªè¿›ç¨‹ç”³è¯·èµ„æºçš„ç¯å½¢é“¾ã€‚å³è¿›ç¨‹é›†åˆp0,p1,p2Â·Â·Â·ï¼Œpnä¸­çš„pOæ­£åœ¨ç­‰å¾…ä¸€ä¸ªp1å ç”¨çš„èµ„æºï¼›p1æ­£åœ¨ç­‰å¾…p2å ç”¨çš„èµ„æºï¼ŒÂ·Â·Â·ï¼Œpnæ­£åœ¨ç­‰å¾…å·²ç»è¢«pOå ç”¨çš„èµ„æºã€‚ æ³¨æ„ï¼šåªæœ‰å½“ä¸Šè¿°4ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³æ—¶æ‰ä¼šå‘ç”Ÿæ­»é”ã€‚ 3. å®ä¾‹ ä¸‹é¢ä»¥ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é—®é¢˜ä¸ºä¾‹ï¼Œè¯´æ˜äº§ç”Ÿæ­»é”çš„å¿…è¦æ¡ä»¶ï¼Œå¦‚å›¾3-4æ‰€ç¤ºã€‚ å¦‚æœç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…è¿›ç¨‹éƒ½å…ˆé€šè¿‡æ‰§è¡Œwait(mutex)ç”³è¯·å…¬å…±ç¼“å†²æ± çš„äº’æ–¥è®¿é—®æƒï¼Œå½“ç¼“å†²æ± æ»¡ä¸”ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…è¿›ç¨‹å‡ ä¹åŒæ—¶è®¿é—®å…¬å…±ç¼“å†²æ± æ—¶ï¼Œå¯èƒ½å‘ç”Ÿæ­»é”ï¼Œå‡ºç°4ä¸ªå¿…è¦æ¡ä»¶åŒæ—¶æ»¡è¶³çš„æƒ…å†µã€‚ 1) äº’æ–¥æ¡ä»¶ã€‚è‹¥ç”Ÿäº§è€…è¿›ç¨‹å…ˆå ç”¨å…¬å…±ç¼“å†²æ± è®¿é—®æƒï¼Œæ¶ˆè´¹è€…è¯·æ±‚ç¼“å†²æ± è®¿é—®æƒæ—¶ä¼šè¢«é˜»å¡ã€‚å³ç¼“å†²æ± è®¿é—®æƒåªèƒ½è¢«ä»»æ„ä¸¤ä¸ªè¿›ç¨‹ä¸­çš„ä¸€ä¸ªæ‰€å æœ‰ã€‚æ‰€æœ‰çš„ç”Ÿäº§è€…è¿›ç¨‹å’Œæ¶ˆè´¹è€…è¿›ç¨‹å¯¹å…¬å…±ç¼“å†²æ± çš„è®¿é—®æ˜¯äº’æ–¥çš„ã€‚ 2) è¯·æ±‚å’Œä¿æŒæ¡ä»¶ã€‚ç”Ÿäº§è€…è¿›ç¨‹è·å¾—ç¼“å†²æ± ä½¿ç”¨æƒåï¼Œåˆæå‡ºç”³è¯·ç©ºç¼“å†²åŒºçš„è¯·æ±‚ã€‚å› ä¸ºç¼“å†²æ± è£…æ»¡äº†æ¶ˆæ¯ï¼Œæ²¡æœ‰ç©ºç¼“å†²åŒºã€‚å› æ­¤ï¼Œç”Ÿäº§è€…è¿›ç¨‹æ— æ³•è·å¾—ç©ºç¼“å†²åŒºèµ„æºè€Œè¢«é˜»å¡ï¼Œä½†ç”Ÿäº§è€…è¿›ç¨‹ä»ä¿æŒç¼“å†²æ± çš„è®¿é—®æƒã€‚ 3) ä¸å‰¥å¤ºæ¡ä»¶ã€‚è™½ç„¶ç¼“å†²æ± ä¸­æœ‰æ¶ˆè´¹è€…è¿›ç¨‹éœ€è¦çš„æ¶ˆæ¯èµ„æºï¼Œåªè¦æ¶ˆè´¹è€…è¿›ç¨‹èƒ½å¤Ÿè·å¾—ç¼“å†²æ± çš„äº’æ–¥è®¿é—®æƒå°±å¯ä»¥æ‰§è¡Œå–æ¶ˆæ¯çš„æ“ä½œï¼Œä½†æ¶ˆè´¹è€…è¿›ç¨‹ä¸èƒ½å‰¥å¤ºç”Ÿäº§è€…å·²è·å¾—çš„ç¼“å†²æ± è®¿é—®æƒã€‚ 4) ç¯è·¯ç­‰å¾…ã€‚å­˜åœ¨ç”Ÿäº§è¿›ç¨‹ç­‰å¾…æ¶ˆè´¹è€…è¿›ç¨‹é‡Šæ”¾ç©ºç¼“å†²åŒºï¼Œæ¶ˆè´¹è€…è¿›ç¨‹ç­‰å¾…ç”Ÿäº§è€…è¿› ç¨‹é‡Šæ”¾å…¬å…±ç¼“å†²æ± äº’æ–¥è®¿é—®æƒçš„èµ„æºç”³è¯·ç¯è·¯ï¼Œå¦‚å›¾3-5æ‰€ç¤ºã€‚ äºŒã€å¤„ç†æ­»é”çš„åŸºæœ¬æ–¹æ³• å¤„ç†æ­»é”çš„åŸºæœ¬æ–¹æ³•æœ‰é¢„é˜²æ­»é”ã€é¿å…æ­»é”ã€æ£€æµ‹å¹¶è§£é™¤æ­»é”å’Œå¿½ç•¥æ­»é”é—®é¢˜ï¼ˆå³å‡å®šæ­»é”ä¸å¯èƒ½åœ¨ç³»ç»Ÿå†…å‘ç”Ÿè€Œå¿½ç•¥æ­»é”)ã€‚ ä¸ºç¡®ä¿ä¸å‘ç”Ÿæ­»é”ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥é‡‡ç”¨æ­»é”é¢„é˜²æˆ–æ­»é”é¿å…æ–¹æ¡ˆã€‚ 1. æ­»é”çš„é¢„é˜² æ­»é”é¢„é˜²æ˜¯æ ¹æ®å‰é¢è®¨è®ºçš„æ­»é”å¿…è¦æ¡ä»¶ï¼Œé€šè¿‡ä¿è¯è‡³å°‘å…¶ä¸­ä¸€ä¸ªæ¡ä»¶ä¸æˆç«‹æ¥è¾¾åˆ°é¢„é˜²å‘ç”Ÿæ­»é”çš„ç›®çš„ã€‚ ç”±äºæœ‰äº›å…±äº«èµ„æºå¿…é¡»è¢«å®šä¹‰ä¸ºä¸´ç•Œèµ„æºï¼Œå¯¹äºè¿™äº›èµ„æºçš„è®¿é—®å¿…é¡»æ˜¯äº’ä¹çš„ã€‚å› æ­¤ï¼Œå¯¹è¿™ç±»èµ„æºçš„è®¿é—®ä¸èƒ½é€šè¿‡æ‘’å¼ƒäº’æ–¥æ¡ä»¶æ¥é¢„é˜²æ­»é”çš„å‘ç”Ÿï¼Œå¦‚å¯¹æ‰“å°æœºçš„è®¿é—®ã€‚ä½†æ˜¯ï¼Œæœ‰äº›å…±äº«èµ„æºæ˜¯å…è®¸è¿›ç¨‹åŒæ—¶è®¿é—®çš„ï¼Œ å¦‚å…è®¸è¿›ç¨‹åŒæ—¶è¯»ä¸€ä¸ªå…±äº«æ–‡ä»¶ã€‚å¦‚æœè¿›ç¨‹è®¿é—®çš„éƒ½æ˜¯è¿™äº›èµ„æºï¼Œæ˜¯ä¸ä¼šå‡ºç°æ­»é”é—®é¢˜çš„ã€‚åœ¨æ“ä½œç³»ç»Ÿä¸­æ— æ³•é¢„çŸ¥è¿›ç¨‹æ˜¯å¦ä¸€å®šä¸è®¿é—®ä¸´ç•Œèµ„æºï¼Œæ‰€ä»¥é€šå¸¸ä¸èƒ½é‡‡ç”¨æ‘’å¼ƒäº’æ–¥æ¡ä»¶æ¥é¢„é˜²æ­»é”çš„å‘ç”Ÿã€‚ é¢„é˜²æ­»é”å¯ä»¥é€šè¿‡æ‘’å¼ƒä¸‹åˆ—ä¸‰ä¸ªå¿…è¦æ¡ä»¶ä¹‹ä¸€æ¥å®ç° (1) æ‘’å¼ƒè¯·æ±‚å’Œä¿æŒæ¡ä»¶ å¯ä»¥é€šè¿‡æ‘’å¼ƒè¯·æ±‚å’Œä¿æŒæ¡ä»¶æ¥é¢„é˜²æ­»é”çš„å‘ç”Ÿã€‚æ‘’å¼ƒè¯·æ±‚å’Œä¿æŒæ¡ä»¶çš„ä¸€ç§æ–¹æ³•æ˜¯ç³»ç»Ÿè¦æ±‚æ‰€æœ‰è¿›ç¨‹æ‰§è¡Œå‰è¦ä¸€æ¬¡æ€§åœ°ç”³è¯·åœ¨æ•´ä¸ªè¿è¡Œè¿‡ç¨‹ä¸­æ‰€éœ€è¦çš„å…¨éƒ¨èµ„æºï¼Œåªè¦æœ‰ä¸€ä¸ªèµ„ æºç”³è¯·ä¸æˆåŠŸï¼Œå…¶ä»–æ‰€æœ‰èµ„æºä¹Ÿä¸åˆ†é…ç»™è¯¥è¿›ç¨‹ã€å¹¶é˜»å¡è¯¥è¿›ç¨‹ã€‚ä¾‹å¦‚ç”Ÿäº§è€…ä¸€æ¶ˆè´¹è€…é—®é¢˜ä¸­ï¼Œç”Ÿäº§è€…è¿›ç¨‹æ‰§è¡Œå‰å¿…é¡»ç”³è¯·åˆ°å…¬å…±ç¼“å†²æ± çš„äº’æ–¥è®¿é—®æƒå’Œç©ºç¼“å†²åŒºèµ„æºï¼Œåªè¦æœ‰ä¸€ç§èµ„æºç”³è¯·ä¸åˆ°ï¼Œå°±é˜»å¡ç”Ÿäº§è€…è¿›ç¨‹ã€‚è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯å¯¹æŸäº›è¿›ç¨‹åœ¨ç”³è¯·å…¶ä»–èµ„æºå‰è¦æ±‚è¯¥è¿›ç¨‹å¿…é¡»é‡Šæ”¾å·²ç»åˆ†é…ç»™å®ƒçš„æ‰€æœ‰å…¶ä»–èµ„æºã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªè¿›ç¨‹è¦ä»ç£ç›˜è¯»æ•°æ®é€æ‰“å°æœºï¼Œå¯ä»¥è§„å®šï¼Œå¿…é¡»åœ¨è¿›ç¨‹é‡Šæ”¾ç£ç›˜é©±åŠ¨å™¨ä¹‹åï¼Œæ‰èƒ½ç”³è¯·å¹¶è·å¾—æ‰“å°æœºã€‚ (2) æ‘’å¼ƒä¸å‰¥å¤ºæ¡ä»¶ æ‘’å¼ƒä¸å‰¥å¤ºæ¡ä»¶çš„æ–¹æ³•æ˜¯ä¸€ä¸ªå·²ä¿æŒäº†æŸäº›èµ„æºçš„è¿›ç¨‹ï¼Œå½“å®ƒå†æå‡ºæ–°çš„èµ„æºè¦æ±‚è€Œä¸èƒ½ç«‹å³å¾—åˆ°æ»¡è¶³æ—¶ï¼Œå¿…é¡»é‡Šæ”¾å®ƒå·²ç»ä¿æŒçš„æ‰€æœ‰èµ„æºã€‚å…·ä½“å®ç°æ—¶å¯ä»¥é‡‡å–è¿™æ ·çš„ç­–ç•¥ï¼šå½“ä¸€ä¸ªè¿›ç¨‹p1ç”³è¯·æŸèµ„æºR1æ—¶ï¼Œå¦‚æœR1å¯ç”¨ï¼Œå°±å°†R1åˆ†é…ç»™p1ã€‚å¦‚æœR1ä¸å¯ç”¨ï¼Œç³»ç»Ÿå°±æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–è¿›ç¨‹å ç”¨äº†R1ï¼Œè€Œåˆç”³è¯·å…¶ä»–èµ„æºä¸æˆåŠŸè€Œè¢«é˜»å¡ã€‚å¦‚æœæœ‰è¿™æ ·çš„é˜»å¡è¿›ç¨‹ï¼Œç³»ç»ŸæŠ¢å è¢«è¯¥è¿›ç¨‹å ç”¨çš„R1èµ„æºåˆ†é…ç»™p1è¿›ç¨‹ã€‚è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯å®ç°å¤æ‚è€Œä¸”ä»£ä»·é«˜ã€‚ (3) æ‘’å¼ƒç¯è·¯ç­‰å¾…æ¡ä»¶ æ‘’å¼ƒç¯è·¯ç­‰å¾…çš„æ–¹æ³•æ˜¯æŒ‡è¿›ç¨‹å¿…é¡»æŒ‰è§„å®šçš„é¡ºåºç”³è¯·èµ„æºã€‚å¯¹æ‰€æœ‰ä¸åŒç±»å‹çš„èµ„æºæ’åºï¼Œè¦æ±‚æ¯ä¸ªè¿›ç¨‹æŒ‰è§„å®šçš„é¡ºåºç”³è¯·èµ„æºã€‚ æ‰“å°æœºå’Œç£ç›˜é©±åŠ¨å™¨æ˜¯ä¸¤ç§ä¸åŒç±»å‹çš„èµ„æºï¼Œä¸€ä¸ªç³»ç»Ÿä¸­å¯èƒ½å­˜åœ¨å¤šä¸ªæ‰“å°æœºå’Œå¤šä¸ªç£ç›˜é©±åŠ¨å™¨ã€‚æŠŠæŸå°æ‰“å°æœºç§°ä¸ºæ‰“å°æœºè¿™ç§ç±»å‹èµ„æºçš„ä¸€ä¸ªå®ä¾‹ï¼ŒæŠŠæŸä¸ªç£ç›˜é©±åŠ¨å™¨ç§°ä¸ºç£ç›˜é©±åŠ¨å™¨ç±»å‹èµ„æºçš„ä¸€ä¸ªå®ä¾‹ã€‚ è®¾R={R1,R2,â€¦,Rnä¸ºèµ„æºç±»å‹çš„é›†åˆã€‚ä¸ºæ¯ä¸ªèµ„æºç±»å‹åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„æ•´æ•°ï¼Œä»¥æ¯”è¾ƒèµ„æºçš„å…ˆåé¡ºåºã€‚å¯å®šä¹‰ä¸€ä¸ªå‡½æ•°F:R->Nï¼Œå…¶ä¸­Næ˜¯è‡ªç„¶æ•°é›†åˆã€‚ä¾‹å¦‚ï¼ŒRçš„é›†åˆåŒ…æ‹¬æ‰“å°æœºå’Œç£ç›˜é©±åŠ¨å™¨ï¼Œé‚£ä¹ˆå‡½æ•°Få¯ä»¥æŒ‰ä»¥ä¸‹æ¥å®šä¹‰ã€‚ F(disk drive)=1 F(printer)=2 ç”¨è¿™æ ·çš„æ–¹æ³•æ¥æ‘’å¼ƒç¯è·¯ç­‰å¾…çš„ç­–ç•¥æ˜¯ï¼šæ¯ä¸ªè¿›ç¨‹æŒ‰èµ„æºæ’åºçš„é€’å¢é¡ºåºç”³è¯·èµ„æºã€‚å³ä¸€ä¸ªè¿›ç¨‹å¼€å§‹å¯ç”³è¯·ä»»ä½•æ•°é‡çš„èµ„æºç±»å‹Rçš„å®ä¾‹ã€‚ä¹‹åï¼Œå½“ä¸”ä»…å½“F(Rj)>F(Ri)æ—¶ï¼Œè¯¥è¿›ç¨‹å¯ä»¥ç”³è¯·èµ„æºç±»å‹ä¸ºRjçš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä»¥ä¸Šç»™å®šçš„å‡½æ•°ï¼Œä¸€ä¸ªè¿›ç¨‹éœ€è¦åŒæ—¶ä½¿ç”¨ç£ç›˜é©±åŠ¨å™¨å’Œæ‰“å°æœºï¼Œé‚£ä¹ˆå°±å¿…é¡»å…ˆç”³è¯·ç£ç›˜é©±åŠ¨å™¨ï¼Œåç”³è¯·æ‰“å°æœºï¼Œå› ä¸ºF(printer))>F(disk drive)ã€‚æ¢è€Œè¨€ä¹‹ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹ç”³è¯·èµ„æºç±»å‹Rjçš„å®ä¾‹æ—¶ï¼Œå®ƒå¿…é¡»å…ˆé‡Šæ”¾æ‰€æœ‰èµ„æºRiï¼Œå…¶ä¸­Riä½¿F(Ri) 1) é™åˆ¶äº†æ–°è®¾å¤‡çš„å¢åŠ ã€‚ 2) ç³»ç»Ÿä¸ºèµ„æºåˆ†é…çš„åºå·ä¸è¿›ç¨‹å®é™…ä½¿ç”¨èµ„æºçš„é¡ºåºä¸åŒï¼Œé€ æˆèµ„æºæµªè´¹ã€‚ 3) ç»™ç”¨æˆ·ç¼–ç¨‹å¸¦æ¥äº†éº»çƒ¦ã€‚ 2. æ­»é”çš„é¿å… é¿å…æ­»é”çš„æ–¹æ³•æ˜¯æŠŠç³»ç»Ÿçš„èµ„æºåˆ†é…çŠ¶æ€åˆ†ä¸ºå®‰å…¨çŠ¶æ€å’Œä¸å®‰å…¨çŠ¶æ€ï¼Œåªè¦èµ„æºåˆ†é…ä½¿ç³»ç»Ÿèµ„æºåˆ†é…çŠ¶æ€å¤„äºå®‰å…¨çŠ¶æ€ï¼Œæ­»é”å°±ä¸ä¼šå‘ç”Ÿã€‚åœ¨é¿å…æ­»é”çš„æ–¹æ³•ä¸­ï¼Œå…è®¸è¿›ç¨‹åŠ¨æ€åœ°ç”³è¯·èµ„æºã€‚ç³»ç»Ÿåœ¨èµ„æºåˆ†é…ä¹‹å‰ï¼Œå…ˆè®¡ç®—èµ„æºåˆ†é…çš„å®‰å…¨æ€§ã€‚è‹¥æœ¬æ¬¡èµ„æºåˆ†é…ä¸ä¼šå¯¼è‡´ç³»ç»Ÿè¿›å…¥ä¸å®‰å…¨çŠ¶æ€ï¼Œä¾¿å°†èµ„æºåˆ†é…ç»™è¿›ç¨‹ã€‚å¦åˆ™æ‹’ç»è¿›ç¨‹çš„èµ„æºè¯·æ±‚ï¼Œå°†è¿›ç¨‹é˜»å¡èµ·æ¥ã€‚ (1) ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€ å½“ç³»ç»Ÿèƒ½æ‰¾åˆ°ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œåºåˆ—ï¼Œä½¿ç³»ç»Ÿåªè¦æŒ‰æ­¤åºåˆ—ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…èµ„æºï¼Œå°±å¯ä»¥ä¿è¯è¿›ç¨‹çš„èµ„æºåˆ†é…å’Œæ‰§è¡Œé¡ºåˆ©å®Œæˆï¼Œä¸ä¼šå‘ç”Ÿæ­»é”æ—¶ï¼Œç§°ç³»ç»Ÿå¤„äºå®‰å…¨çŠ¶æ€ã€‚è‹¥ç³»ç»Ÿä¸å­˜åœ¨è¿™æ ·çš„å®‰å…¨åºåˆ—ï¼Œåˆ™ç§°ç³»ç»Ÿå¤„äºä¸å®‰å…¨çŠ¶æ€ã€‚ ä¸å®‰å…¨çŠ¶æ€ä¸ä¸€å®šæ˜¯æ­»é”çŠ¶æ€ï¼Œä½†å½“ç³»ç»Ÿè¿›å…¥ä¸å®‰å…¨çŠ¶æ€ä¹‹åï¼Œä¾¿å¯èƒ½è¿›äººæ­»é”çŠ¶æ€ã€‚åä¹‹ï¼Œåªè¦ç³»ç»Ÿå¤„äºå®‰å…¨çŠ¶æ€ï¼Œç³»ç»Ÿå¯é¿å…è¿›å…¥æ­»é”çŠ¶æ€ã€‚å› æ­¤ï¼Œé¿å…è¿›ç¨‹æ­»é”çš„å®è´¨åœ¨äºä½¿ç³»ç»Ÿå¤„äºå®‰å…¨çŠ¶æ€ã€‚ (2) å®‰å…¨çŠ¶æ€ä¸¾ä¾‹ å‡å®šç³»ç»Ÿæœ‰3ä¸ªè¿›ç¨‹p1ã€p2ã€p3ï¼Œå…±æœ‰12ä¸ªæŸç±»èµ„æºRã€‚è¿›ç¨‹p1æ€»å…±è¦æ±‚10ä¸ªRç±»èµ„æºï¼Œp2å’Œp3åˆ†åˆ«è¦æ±‚4ä¸ªå’Œ9ä¸ªRç±»èµ„æºã€‚è®¾åœ¨T0æ—¶åˆ»ï¼Œç³»ç»Ÿåˆ†é…èµ„æºæƒ…å†µå¦‚è¡¨3-3æ‰€ç¤ºã€‚ ç»åˆ†æå¯ä»¥å‘ç°åœ¨T0æ—¶åˆ»ç³»ç»Ÿæ˜¯å®‰å…¨çš„ã€‚å› ä¸ºT0æ—¶åˆ»å­˜åœ¨ä¸€ä¸ªå®‰å…¨åºåˆ—ï¼Œå³åªè¦ç³»ç»ŸæŒ‰æ­¤è¿›ç¨‹åºåˆ—åˆ†é…èµ„æºï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½å¯ä»¥é¡ºåˆ©å®Œæˆã€‚T0æ—¶åˆ»ç³»ç»Ÿèµ„æºRçš„å¯ç”¨æ•°é‡ä¸º3ï¼Œå¦‚æœå…ˆå°†å…¶ä¸­çš„2ä¸ªèµ„æºåˆ†é…ç»™è¿›ç¨‹p2ï¼Œp2å°±å¯ä»¥é¡ºåˆ©æ‰§è¡Œå®Œï¼Œç„¶åé‡Šæ”¾p2å·²ç»å ç”¨çš„å…¨éƒ¨4ä¸ªèµ„æºã€‚æ­¤æ—¶ï¼Œç³»ç»Ÿçš„å¯ç”¨èµ„æºæ•°é‡å˜ä¸º5ã€‚æŠŠ5ä¸ªRç±»èµ„æºå…¨éƒ¨åˆ†é…ç»™è¿› ç¨‹p1ï¼Œp1ä¹Ÿå¯ä»¥é¡ºåˆ©æ‰§è¡Œå®Œæ¯•ã€‚ç„¶åé‡Šæ”¾p1å ç”¨çš„å…¨éƒ¨èµ„æºï¼Œä½¿ç³»ç»Ÿå¯åˆ†é…çš„èµ„æºæ•°é‡è¾¾ åˆ°10ä¸ªã€‚å°†å…¶ä¸­çš„7ä¸ªåˆ†é…ç»™è¿›ç¨‹p3ï¼Œp3å³å¯é¡ºåˆ©æ‰§è¡Œå®Œæ¯•ã€‚ (3) ä¸å®‰å…¨çŠ¶æ€ä¸¾ä¾‹ è®¾åœ¨T1,æ—¶åˆ»ï¼Œç³»ç»Ÿåˆ†é…èµ„æºæƒ…å†µå¦‚è¡¨3-4æ‰€ç¤ºï¼Œåˆ™ç³»ç»Ÿå¤„äºä¸å®‰å…¨çŠ¶æ€ï¼Œå› ä¸ºå½“ç³»ç»Ÿå¤„äºè¡¨3-4æ‰€ç¤ºçš„çŠ¶æ€æ—¶ï¼Œä¸å­˜åœ¨å®‰å…¨åºåˆ—ï¼Œæ— è®ºè¿›ç¨‹æŒ‰ä»€ä¹ˆé¡ºåºæ¨è¿›ï¼Œéƒ½æ— æ³•é¿å…æ­»é”ã€‚ (4) å®‰å…¨çŠ¶æ€å¯ä»¥å‘ä¸å®‰å…¨çŠ¶æ€è½¬æ¢ å¤„äºå®‰å…¨çŠ¶æ€çš„ç³»ç»Ÿï¼Œå¯èƒ½ç”±äºä¸€æ¬¡èµ„æºåˆ†é…ï¼Œç”±å®‰å…¨çŠ¶æ€è¿›äººä¸å®‰å…¨çŠ¶æ€ã€‚ å®‰å…¨çŠ¶æ€å‘ä¸å®‰å…¨çŠ¶æ€è½¬æ¢ä¸¾ä¾‹å¦‚è¡¨3-5æ‰€ç¤ºã€‚ T0æ—¶åˆ»å¤„äºå®‰å…¨çŠ¶æ€çš„ç³»ç»Ÿï¼Œåœ¨è¿›ç¨‹p3æå‡ºç”³è¯·ä¸€ä¸ªRç±»èµ„æºåï¼ŒæŠŠç³»ç»Ÿå¯ç”¨çš„3ä¸ªèµ„æºä¸­çš„1ä¸ªåˆ†é…ç»™äº†p3ï¼Œç³»ç»ŸçŠ¶æ€ç”±T0æ—¶åˆ»çš„å®‰å…¨çŠ¶æ€è½¬æ¢ä¸ºT1æ—¶åˆ»çš„ä¸å®‰å…¨çŠ¶æ€ã€‚ ä¸‰ã€é“¶è¡Œå®¶ç®—æ³• 1965å¹´Dijkstraæå‡ºäº†ä¸€ç§èƒ½å¤Ÿé¿å…æ­»é”çš„èµ„æºåˆ†é…ç®—æ³•ã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯ä¸€ä¸ªè¿›ç¨‹æå‡ºèµ„æºè¯·æ±‚åï¼Œç³»ç»Ÿå…ˆè¿›è¡Œèµ„æºçš„è¯•åˆ†é…ã€‚ç„¶åæ£€æµ‹æœ¬æ¬¡çš„è¯•åˆ†é…æ˜¯å¦ä½¿ç³»ç»Ÿå¤„äºå®‰å…¨çŠ¶æ€ï¼Œè‹¥å®‰å…¨åˆ™æŒ‰è¯•åˆ†é…æ–¹æ¡ˆåˆ†é…èµ„æºï¼Œå¦åˆ™ä¸åˆ†é…èµ„æºã€‚ 1. æ•°æ®ç»“æ„ ä¸ºäº†å®ç°é“¶è¡Œå®¶ç®—æ³•ï¼Œéœ€è¦æ•°æ®ç»“æ„çš„æ”¯æŒï¼Œç”¨mè¡¨ç¤ºç³»ç»Ÿä¸­èµ„æºçš„ç§ç±»æ•°ï¼Œnè¡¨ç¤ºç³»ç»Ÿä¸­çš„è¿›ç¨‹æ•°ã€‚éœ€è¦çš„æ•°æ®ç»“æ„å¦‚ä¸‹ã€‚ 1) available[]æ˜¯ä¸€ä¸ªä¸€ç»´æ•°ç»„ã€‚è¡¨ç¤ºç³»ç»Ÿä¸­æŸç§èµ„æºçš„å¯ç”¨æ•°é‡ï¼Œä¹Ÿå°±æ˜¯è¿™ç§èµ„æºå¯åˆ†é…çš„æ•°é‡ï¼Œavailable[j]=kè¡¨ç¤ºjç±»èµ„æºçš„å¯ç”¨æ•°é‡ä¸ºkï¼Œç³»ç»Ÿè¿˜å¯ä»¥ä¸ºè¿›ç¨‹åˆ†é…çš„jç±»èµ„æºä¸ºkä¸ªã€‚ 2) max[]æ˜¯ä¸ªnè¡Œmåˆ—çš„äºŒç»´æ•°ç»„ã€‚è¡¨ç¤ºå„è¿›ç¨‹éœ€è¦å„ç±»èµ„æºçš„æœ€å¤§æ•°é‡ã€‚max[i,j]=kè¡¨ç¤ºè¿›ç¨‹piéœ€è¦jç±»èµ„æºçš„æœ€å¤§æ•°é‡ä¸ºkä¸ªã€‚ 3) allocation[]æ˜¯äºŒç»´æ•°ç»„ï¼Œè¡¨ç¤ºæŸæ—¶åˆ»å·²åˆ†é…ç»™è¿›ç¨‹çš„æŸç±»èµ„æºæ•°ã€‚allocation[i,j]=kè¡¨ç¤ºè¿›ç¨‹piå·²ç»å æœ‰iç±»èµ„æºkä¸ªã€‚ 4) need[]æ˜¯äºŒç»´æ•°ç»„ï¼Œè¡¨ç¤ºæŸä¸ªè¿›ç¨‹è¿˜éœ€è¦æŸç±»èµ„æºçš„æ•°é‡ã€‚eed[i,j]=kè¡¨ç¤ºè¿›ç¨‹piè¿˜éœ€è¦iç±»èµ„æºkä¸ªã€‚ 2. é“¶è¡Œå®¶ç®—æ³•çš„è¯´æ˜ é“¶è¡Œå®¶ç®—æ³•åˆ†ä¸ºä¸¤ä¸ªè¿‡ç¨‹ï¼Œä¸€æ˜¯è¿›è¡Œèµ„æºè¯•åˆ†é…çš„è¿‡ç¨‹ï¼›äºŒæ˜¯å¯¹è¯•åˆ†é…åç³»ç»Ÿçš„çŠ¶æ€åšå®‰å…¨æ€§æ£€æµ‹çš„è¿‡ç¨‹ã€‚ç»å®‰å…¨æ€§æ£€æµ‹ï¼Œè‹¥è¯•åˆ†é…åç³»ç»ŸçŠ¶æ€æ˜¯å®‰å…¨çš„ï¼Œåˆ™åˆ†é…èµ„æºã€‚è‹¥ä¸å®‰å…¨ï¼Œåˆ™é˜»å¡ç”³è¯·èµ„æºçš„è¿›ç¨‹ï¼Œæš‚ä¸ä¸ºå®ƒåˆ†é…èµ„æºã€‚ å››ã€æ­»é”çš„æ£€æµ‹å’Œè§£é™¤ æ“ä½œç³»ç»Ÿå¯ä»¥ä¸é‡‡å–äº‹å…ˆé¢„é˜²å’Œé¿å…çš„æ–¹æ³•æ¥è§£å†³æ­»é”é—®é¢˜ï¼Œè€Œæ˜¯æ£€æµ‹æ˜¯å¦æœ‰æ­»é”å‘ç”Ÿã€‚å¦‚æœæ£€æµ‹åˆ°ç³»ç»Ÿä¸­æœ‰æ­»é”çš„è¿›ç¨‹ï¼Œåˆ™è§£é™¤æ­»é”ã€‚ åº”ç”¨æ£€æµ‹æ­»é”ç®—æ³•å¿…é¡»é¢å¯¹çš„é—®é¢˜æ˜¯ï¼šä½•æ—¶è°ƒç”¨æ£€æµ‹ç®—æ³•ï¼Ÿå¦‚ä½•æ£€æµ‹æ­»é”ï¼Ÿä¸‹é¢å…ˆå¯¹ç¬¬ä¸€ä¸ªé—®é¢˜è¿›è¡Œè¯´æ˜ï¼Œç„¶åä»‹ç»ç”¨äºæ£€æµ‹å’Œè§£é™¤æ­»é”çš„èµ„æºåˆ†é…å›¾åŠæ­»é”å®šç†ã€‚ 1. ä½•æ—¶è°ƒç”¨æ£€æµ‹ç®—æ³• å…³äºä½•æ—¶è°ƒç”¨æ£€æµ‹ç®—æ³•ï¼Ÿç­”æ¡ˆå–å†³äºä¸¤ä¸ªå› ç´ ï¼šä¸€æ˜¯æ­»é”å¯èƒ½å‘ç”Ÿçš„é¢‘ç‡ï¼ŒäºŒæ˜¯å½“æ­»é”å‘ç”Ÿæ—¶å—å½±å“çš„è¿›ç¨‹æ•°é‡ã€‚å¦‚æœæ­»é”ç»å¸¸å‘ç”Ÿï¼Œå°±åº”è¯¥ç»å¸¸è°ƒç”¨æ£€æµ‹ç®—æ³•ã€‚åªæœ‰å½“æŸä¸ªè¿›ç¨‹æå‡ºèµ„æºè¯·æ±‚ä¸”å¾—ä¸åˆ°æ»¡è¶³æ—¶ï¼Œæ‰ä¼šå‡ºç°æ­»é”ã€‚åœ¨æç«¯æƒ…å†µä¸‹ï¼Œå½“è¿›ç¨‹è¯·æ±‚èµ„æºåˆ†é…è€Œä¸èƒ½ç«‹å³è¢«æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œå°±è°ƒç”¨æ­»é”æ£€æµ‹ç®—æ³•ã€‚ä½†æ˜¯ï¼Œå¯¹äºæ¯ä¸ªè¯·æ±‚éƒ½è°ƒç”¨æ­»é”æ£€æµ‹ç®—æ³•ä¼šå¼•èµ·ç›¸å½“å¤§çš„è®¡ç®—å¼€é”€ã€‚å¦ä¸€ç§å¼€é”€ç›¸å¯¹è¾ƒå°çš„æ–¹æ³•æ˜¯åªåœ¨ä¸€ä¸ªä¸é¢‘ç¹çš„æ—¶é—´é—´éš”é‡Œè°ƒç”¨æ£€æµ‹ç®—æ³•ï¼Œå¦‚æ¯å°æ—¶ä¸€æ¬¡ï¼Œæˆ–å½“CPUä½¿ç”¨ç‡ä½äº40%æ—¶ã€‚å› ä¸ºæ­»é”æœ€ç»ˆä¼šä½¿ç³»ç»Ÿæ€§èƒ½ä¸‹é™ï¼Œå¹¶é€ æˆCPUä½¿ç”¨ç‡ä¸‹é™ã€‚ 2. èµ„æºåˆ†é…å›¾ ç³»ç»Ÿæ­»é”å¯åˆ©ç”¨èµ„æºåˆ†é…å›¾æ¥æè¿°ï¼Œè¯¥å›¾ç”±ä¸€ç»„ç»“ç‚¹å’Œä¸€ç»„è¾¹ç»„æˆã€‚å¦‚å›¾3-8æ‰€ç¤ºï¼Œç”¨åœ†åœˆä»£è¡¨ä¸€ä¸ªè¿›ç¨‹ï¼Œç”¨æ–¹æ¡†ä»£è¡¨ä¸€ç±»èµ„æºã€‚ç”±äºä¸€ç§ç±»å‹çš„èµ„æºå¯èƒ½æœ‰å¤šä¸ªï¼Œç”¨æ–¹æ¡†ä¸­çš„ä¸€ä¸ªå°åœ†åœˆä»£è¡¨æŸä¸€ç±»èµ„æºä¸­çš„ä¸€ä¸ªèµ„æºã€‚æ­¤å›¾3-8èµ„æºåˆ†é…å›¾ç¤ºä¾‹æ—¶ï¼Œè¯·æ±‚è¾¹ç”±è¿›ç¨‹æŒ‡å‘æ–¹æ¡†ä¸­çš„Rã€‚è€Œåˆ†é…è¾¹åˆ™åº”å§‹äºæ–¹æ¡†ä¸­çš„ä¸€ä¸ªç‚¹ã€‚å›¾3-8æ‰€ç¤ºçš„èµ„æºåˆ†é…å›¾ä¸­ï¼Œp1è¿›ç¨‹å·²åˆ†å¾—äº†ä¸¤ä¸ªR1èµ„æºï¼Œå¹¶åˆè¯·æ±‚ä¸€ä¸ªR2èµ„æºã€‚p2è¿›ç¨‹åˆ†å¾—äº†ä¸€ä¸ªR1å’Œä¸€ä¸ªR2èµ„æºï¼Œå¹¶è¯·æ±‚ä¸€ä¸ªR1èµ„æºã€‚ 3. æ­»é”å®šç† æ­»é”å®šç†ç”¨äºæ£€æµ‹ç³»ç»Ÿæ‰€å¤„çš„èµ„æºåˆ†é…çŠ¶æ€Sæ˜¯å¦ä¸ºæ­»é”çŠ¶æ€ã€‚ æ­»é”å®šç†ä¸ºï¼šSä¸ºæ­»é”çŠ¶æ€çš„å……åˆ†æ¡ä»¶æ˜¯å½“ä¸”ä»…å½“SçŠ¶æ€çš„èµ„æºåˆ†é…å›¾æ˜¯ä¸å¯å®Œå…¨ç®€åŒ–çš„ã€‚ ä¸‹é¢ç”¨ä¸€ä¸ªå®ä¾‹é˜è¿°èµ„æºåˆ†é…å›¾çš„ç®€åŒ–é—®é¢˜ï¼Œè¯´æ˜ä»€ä¹ˆæ˜¯ä¸å¯å®Œå…¨ç®€åŒ–çš„ã€‚ å®ä¾‹å›¾å¦‚3-9aæ‰€ç¤ºï¼Œä¸ºäº†åˆ¤æ–­è¯¥å›¾æ‰€è¡¨ç¤ºçš„èµ„æºåˆ†é…çŠ¶æ€æ˜¯å¦æ˜¯æ­»é”çŠ¶æ€ï¼Œå¯¹è¯¥å›¾è¿›è¡Œç®€åŒ–ï¼Œç®€åŒ–æ–¹æ³•å¦‚ä¸‹ã€‚ åœ¨èµ„æºåˆ†é…å›¾ä¸­ï¼Œæ‰¾å‡ºä¸€ä¸ªæ—¢ä¸é˜»å¡åˆéç‹¬ç«‹çš„è¿›ç¨‹ç»“ç‚¹piã€‚åœ¨é¡ºåˆ©çš„æƒ…å†µä¸‹ï¼Œpiå¯è·å¾—æ‰€éœ€èµ„æºè€Œç»§ç»­æ‰§è¡Œï¼Œç›´è‡³è¿è¡Œå®Œæ¯•ï¼Œå†é‡Šæ”¾å…¶æ‰€å æœ‰çš„å…¨éƒ¨èµ„æºã€‚è¿™ç›¸å½“äºæ¶ˆå»piæ‰€æœ‰çš„è¯·æ±‚è¾¹å’Œåˆ†é…è¾¹ï¼Œä½¿ä¹‹æˆä¸ºå­¤ç«‹çš„ç»“ç‚¹ã€‚åœ¨å›¾3-9aä¸­ï¼Œå°†p1çš„ä¸¤ä¸ªåˆ†é…è¾¹å’Œä¸€ä¸ªè¯·æ±‚è¾¹æ¶ˆå»ï¼Œä¾¿å½¢æˆå¦‚å›¾3-9bæ‰€ç¤ºçš„æƒ…å†µã€‚ p1é‡Šæ”¾èµ„æºåï¼Œä¾¿å¯ä»¥ä½¿p2è·å¾—èµ„æºè€Œç»§ç»­è¿è¡Œï¼Œç›´åˆ°p2å®Œæˆååˆé‡Šæ”¾å®ƒæ‰€å æœ‰çš„å…¨éƒ¨èµ„æºï¼Œè€Œå½¢æˆå¦‚å›¾3-9cæ‰€ç¤ºçš„æƒ…å†µã€‚ åœ¨è¿›è¡Œä¸€ç³»åˆ—çš„ç®€åŒ–åï¼Œè‹¥èƒ½æ¶ˆå»å›¾ä¸­æ‰€æœ‰çš„è¾¹ï¼Œä½¿æ‰€æœ‰çš„è¿›ç¨‹éƒ½æˆä¸ºå­¤ç«‹ç»“ç‚¹ï¼Œåˆ™ç§°è¯¥å›¾æ˜¯å¯å®Œå…¨ç®€åŒ–çš„ã€‚è‹¥ä¸èƒ½é€šè¿‡ä»»ä½•è¿‡ç¨‹ä½¿è¯¥å›¾å®Œå…¨ç®€åŒ–ï¼Œåˆ™ç§°è¯¥å›¾æ˜¯ä¸å¯å®Œå…¨ç®€åŒ–çš„ã€‚ å¯¹äºè¾ƒå¤æ‚çš„èµ„æºåˆ†é…å›¾ï¼Œå¯èƒ½æœ‰å¤šä¸ªæ—¢æœªé˜»å¡åˆéå­¤ç«‹çš„è¿›ç¨‹ç»“ç‚¹ï¼Œä¸åŒçš„ç®€åŒ–é¡ºåºæ˜¯å¦ä¼šå¾—åˆ°ä¸åŒçš„ç®€åŒ–å›¾å‘¢ï¼Ÿæœ‰å…³æ–‡çŒ®å·²ç»è¯æ˜ï¼Œæ‰€æœ‰çš„ç®€åŒ–é¡ºåºéƒ½å°†å¾—åˆ°ç›¸åŒçš„ä¸å¯ç®€åŒ–å›¾ã€‚ 4. æ­»é”çš„è§£é™¤ æ£€æµ‹åˆ°ç³»ç»Ÿå‡ºç°æ­»é”åï¼Œå¯ä»¥ç”±ç³»ç»Ÿç®¡ç†å‘˜äººå·¥å¤„ç†æ­»é”ï¼Œä¹Ÿå¯ä»¥è®©ç³»ç»Ÿè‡ªåŠ¨è§£é™¤æ­»é”ã€‚è§£é™¤æ­»é”çš„é€”å¾„æœ‰ä¸¤ä¸ªï¼šä¸€æ˜¯ç»ˆæ­¢å¤„äºæ­»é”çŠ¶æ€çš„è¿›ç¨‹ï¼ŒäºŒæ˜¯æŠ¢å æ­»é”è¿›ç¨‹å æœ‰èµ„æºã€‚ (1) è¿›ç¨‹ç»ˆæ­¢ ç»ˆæ­¢æ­»é”çš„è¿›ç¨‹åï¼Œç³»ç»Ÿå›æ”¶è¿›ç¨‹å æœ‰çš„èµ„æºã€‚å¯ä»¥é‡‡ç”¨ä¸‹é¢ä¸¤ç§æ–¹å¼ç»ˆæ­¢è¿›ç¨‹ã€‚ 1) ç»ˆæ­¢æ‰€æœ‰æ­»é”è¿›ç¨‹ã€‚ 2) ä¸€æ¬¡åªç»ˆæ­¢ä¸€ä¸ªå¤„äºæ­»é”çš„è¿›ç¨‹ï¼Œç›´åˆ°æ­»é”è§£é™¤ã€‚ åœ¨é‡‡ç”¨ç»ˆæ­¢éƒ¨åˆ†è¿›ç¨‹çš„æ–¹æ³•æ—¶ï¼Œæ¯æ¬¡åº”é€‰æ‹©ç»ˆæ­¢å“ªä¸ªè¿›ç¨‹å‘¢ï¼ŸåŸåˆ™ä¸Šåº”è¯¥é€‰æ‹©ç»ˆæ­¢ä»£ä»·æœ€å°çš„è¿›ç¨‹ã€‚éœ€è¦è€ƒè™‘çš„å› ç´ åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªã€‚ 1) è¿›ç¨‹çš„ä¼˜å…ˆçº§æ˜¯ä»€ä¹ˆï¼Ÿ 2) è¿›ç¨‹å·²æ‰§è¡Œäº†å¤šä¹…ï¼Ÿè¿›ç¨‹åœ¨å®Œæˆå…¶æŒ‡å®šä»»åŠ¡ä¹‹å‰è¿˜éœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ 3) è¿›ç¨‹ä½¿ç”¨äº†å¤šå°‘èµ„æºï¼Ÿåˆ†åˆ«æ˜¯ä»€ä¹ˆç±»å‹çš„èµ„æºï¼Ÿè¿™äº›èµ„æºæ˜¯å¦å®¹æ˜“æŠ¢å ï¼Ÿ 4) è¿›ç¨‹éœ€è¦å¤šå°‘èµ„æºæ‰èƒ½å®Œæˆï¼Ÿ 5) éœ€è¦ç»ˆæ­¢å¤šå°‘è¿›ç¨‹æ‰èƒ½è§£é™¤æ­»é”ï¼Ÿ 6) è¿›ç¨‹æ˜¯äº¤äº’çš„è¿˜æ˜¯æ‰¹å¤„ç†çš„ï¼Ÿ (2) èµ„æºæŠ¢å  é€æ­¥ä»è¿›ç¨‹ä¸­æŠ¢å èµ„æºç»™å…¶ä»–è¿›ç¨‹ä½¿ç”¨ï¼Œç›´åˆ°æ­»é”ç¯è¢«æ‰“ç ´ä¸ºæ­¢ã€‚å¦‚æœè¦æ±‚ä½¿ç”¨æŠ¢å æ¥å¤„ç†æ­»é”ï¼Œé‚£ä¹ˆæœ‰3ä¸ªé—®é¢˜éœ€è¦å¤„ç†ã€‚ 1) æŠ¢å å“ªä¸ªè¿›ç¨‹å’Œå“ªäº›èµ„æºï¼Ÿå¿…é¡»ç¡®å®šæŠ¢å çš„é¡ºåºä»¥ä½¿ä»£ä»·æœ€å°ã€‚å½±å“å› ç´ æœ‰ï¼šæ­»é”è¿›ç¨‹æ‰€æ‹¥æœ‰çš„èµ„æºæ•°é‡ã€æ­»é”è¿›ç¨‹åˆ°ç›®å‰ä¸ºæ­¢å·²ç»æ¶ˆè€—çš„æ‰§è¡Œæ—¶é—´ç­‰ã€‚ 2) å›æ»šã€‚å¦‚æœä»ä¸€ä¸ªè¿›ç¨‹é‚£é‡ŒæŠ¢å ä¸€ä¸ªèµ„æºï¼Œé‚£ä¹ˆè¯¥è¿›ç¨‹å› ç¼ºå°‘èµ„æºä¸èƒ½ä»æŠ¢å ç‚¹æ­£å¸¸æ‰§è¡Œï¼Œå¿…é¡»å°†è¿›ç¨‹å›æ»šåˆ°æŸä¸ªå®‰å…¨çŠ¶æ€ï¼Œä»¥ä¾¿ä»è¯¥çŠ¶æ€é‡å¯è¿›ç¨‹ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯å®Œå…¨å›æ»šï¼Œå°±æ˜¯ç»ˆæ­¢è¿›ç¨‹å¹¶é‡å¯è¿›ç¨‹ã€‚ 3) é¥¥é¥¿ã€‚é¥¥é¥¿æ˜¯è¿›ç¨‹å› é•¿æ—¶é—´ä¸èƒ½è·å¾—æ‰€éœ€è¦çš„èµ„æºè€Œæ— é™ç­‰å¾…çš„çŠ¶æ€ã€‚æ¯”å¦‚ç³»ç»Ÿé‡‡å–åŸºäºé™æ€ä¼˜å…ˆæƒçš„è¿›ç¨‹è°ƒåº¦ç®—æ³•ï¼Œå½“ç³»ç»Ÿä¸æ–­æœ‰é«˜ä¼˜å…ˆæƒè¿›ç¨‹åˆ°æ¥æ—¶ï¼Œä¼˜å…ˆæƒä½çš„è¿›ç¨‹å°±å¯èƒ½é•¿æ—¶é—´å¾—ä¸åˆ°CPUï¼Œä¹Ÿå°±ä¸èƒ½è¿è¡Œï¼Œè¿™ç§çŠ¶æ€è¢«ç§°ä¸ºé¥¥é¥¿çŠ¶æ€ã€‚ å¤„äºé¥¥é¥¿çŠ¶æ€çš„è¿›ç¨‹ä¸å½±å“å…¶ä»–è¿›ç¨‹è·å¾—èµ„æºï¼Œæ­»é”çš„è¿›ç¨‹ä¸é¥¥é¥¿è¿›ç¨‹ä¸€æ ·æ— æ³•ç»§ç»­è·å¾—èµ„æºã€‚ä½†æ˜¯æ­»é”ä¸€ä¸”å‘ç”Ÿï¼Œä¾¿æ¶‰åŠç«äº‰èµ„æºçš„ä¸€ç»„è¿›ç¨‹ã€‚ç³»ç»Ÿä¸­ä¸ä¼šå‡ºç°å•ä¸ªè¿›ç¨‹æ­»é”çš„ç°è±¡ï¼Œä½†æ˜¯å¯èƒ½ä¼šåªæœ‰ä¸€ä¸ªè¿›ç¨‹é¥¥é¥¿ã€‚ åœ¨æŠ¢å èµ„æºçš„è¿‡ç¨‹ä¸­å¦‚ä½•ä¿è¯ä¸ä¼šæ€»æ˜¯ä»åŒä¸€ä¸ªè¿›ç¨‹æŠ¢å èµ„æºè€Œä½¿è¯¥è¿›ç¨‹å¤„äºé¥¥é¥¿çŠ¶æ€ï¼Ÿä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯é™åˆ¶å¯¹åŒä¸€è¿›ç¨‹è¿›è¡Œèµ„æºæŠ¢å çš„æ¬¡æ•°ã€‚æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯åœ¨å½±å“ä»£ä»·çš„å› ç´ ä¸­åŠ ä¸Šå›æ»šæ¬¡æ•°ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å››ç« _å†…å­˜ç®¡ç†/ç¬¬ä¸€_äºŒ_ä¸‰èŠ‚_å­˜å‚¨å™¨çš„å±‚æ¬¡ç»“æ„.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å››ç« _å†…å­˜ç®¡ç†/ç¬¬ä¸€_äºŒ_ä¸‰èŠ‚_å­˜å‚¨å™¨çš„å±‚æ¬¡ç»“æ„.html","title":"ç¬¬ä¸€ã€äºŒã€ä¸‰èŠ‚ å­˜å‚¨å™¨çš„å±‚æ¬¡ç»“æ„","keywords":"","body":"ç¬¬å››ç«  å†…å­˜ç®¡ç† å†…å­˜æ˜¯è®¡ç®—æœºç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€å½“æ“ä½œç³»ç»Ÿæ¥æ”¶åˆ°è¿è¡ŒæŸç¨‹åºçš„å‘½ä»¤åï¼Œè¦ä¸ºè¯¥ç¨‹åºçš„è¿è¡Œåˆ†é…å†…å­˜èµ„æºï¼Œåˆ›å»ºè¿›ç¨‹ï¼Œå¹¶æŠŠè¿›ç¨‹çš„å…¨éƒ¨æˆ–éƒ¨åˆ†è°ƒå…¥å†…å­˜ã€‚è¿›ç¨‹è¿è¡Œç»“æŸï¼Œç³»ç»Ÿè¦å›æ”¶è¢«æ’¤é”€è¿›ç¨‹çš„å†…å­˜ç©ºé—´ã€‚å†…å­˜ç®¡ç†çš„ç›®æ ‡ä¸€æ–¹é¢æ˜¯å®ç°å†…å­˜åˆ†é…ã€å†…å­˜å›æ”¶ç­‰åŸºæœ¬å†…å­˜ç®¡ç†åŠŸèƒ½ï¼Œå¦ä¸€æ–¹é¢æ˜¯è¦æé«˜å†…å­˜ç©ºé—´çš„åˆ©ç”¨ç‡å’Œå†…å­˜çš„è®¿é—®é€Ÿåº¦ã€‚æ¯ä¸ªç¨‹åºå‘˜éƒ½å¸Œæœ›è‡ªå·±çš„ç¨‹åºèƒ½è¿è¡Œåœ¨ä¸€ä¸ªç‹¬å çš„ã€å®¹é‡å……åˆ†å¤§ã€è®¿é—®é€Ÿåº¦è¶³å¤Ÿå¿«çš„å­˜å‚¨å™¨ä¸Šã€‚ç„¶è€Œï¼Œäº‹å®ä¸Šè®¡ç®—æœºçš„å†…å­˜æ˜¯æœ‰é™çš„ï¼Œè€Œä¸”æ˜¯è¢«è®¸å¤šåº”ç”¨ç¨‹åºå…±äº«çš„ã€‚å¤„äºåŒä¸€å†…å­˜ä¸­çš„ä¸åŒè¿›ç¨‹ä¹‹é—´å¿…ç„¶ä¼šå­˜åœ¨ç«äº‰ä¸ç›¸äº’å½±å“ã€‚æ“ä½œç³»ç»Ÿçš„å†…å­˜ç®¡ç†æ­£æ˜¯è§£å†³è¿™ä¸€é—®é¢˜çš„ï¼Œå…¶ç›®æ ‡æ˜¯å……åˆ†åˆ©ç”¨ç°æœ‰çš„å†…å­˜èµ„æºï¼Œä¸ºåº”ç”¨ç¨‹åºæä¾›æ–¹ä¾¿çš„å†…å­˜ä½¿ç”¨æ–¹å¼å’Œä¸€ä¸ªå¿«é€Ÿã€å®‰å…¨ä¸”å……åˆ†å¤§çš„å­˜å‚¨å™¨ã€‚ å…³äºå†…å­˜ç®¡ç†ï¼Œéœ€è¦æŒæ¡ï¼šâ‘ è®¡ç®—æœºç¡¬ä»¶ä¸ºç¨‹åºçš„è¿è¡Œæä¾›äº†ä»€ä¹ˆæ ·çš„å­˜å‚¨å™¨ä½¿ç”¨æ–¹å¼ã€‚â‘¡æ“ä½œç³»ç»Ÿä¸ºåº”ç”¨ç¨‹åºçš„è¿è¡Œæä¾›äº†ä»€ä¹ˆæ ·çš„å­˜å‚¨æœåŠ¡ã€‚â‘¢æ“ä½œç³»ç»Ÿæ€æ ·å°†å¤šä¸ªä¸åŒçš„ç”¨æˆ·è¿›ç¨‹æ”¾åœ¨ä¸€ä¸ªå†…å­˜ä¸­ï¼Œå¹¶ä½¿å®ƒä»¬ä¸ç›¸äº’å¹²æ‰°åœ°å¹¶å‘æ‰§è¡Œã€‚â‘£æ“ä½œç³»ç»Ÿå¦‚ä½•ä¸ºè¿›ç¨‹æä¾›è¿œæ¯”ç‰©ç†å†…å­˜å¤§å¾—å¤šçš„è™šæ‹Ÿå†…å­˜ç©ºé—´ã€‚å¸¦ç€è¿™äº›é—®é¢˜æ¥å­¦ä¹ å†…å­˜ç®¡ç†ï¼Œå°±ä¼šç†è§£è®¡ç®—æœºç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºåœ¨å†…å­˜çš„ä½¿ç”¨ä¸Šå„è‡ªçš„è§’è‰²ï¼Œä»¥åŠå¦‚ä½•ç›¸äº’åˆä½œï¼Œä»è€Œæœ‰ä¸€ä¸ªå†…å­˜ç®¡ç†çš„å¤§å±€è§‚ã€‚æœ¬ç« å°†è¯¦ç»†ä»‹ç»å†…å­˜ç®¡ç†çš„åŸºæœ¬åŸç†å’Œå®ç°æŠ€æœ¯ã€‚ ç¬¬ä¸€èŠ‚ å­˜å‚¨å™¨çš„å±‚æ¬¡ç»“æ„ å†…å­˜æ˜¯è®¡ç®—æœºå­˜å‚¨ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œä¸ºäº†æ›´å¥½åœ°ç†è§£åç»­ç« èŠ‚çš„å†…å®¹ï¼Œæœ‰å¿…è¦å…ˆäº†è§£å­˜å‚¨å™¨ç³»ç»Ÿçš„å±‚æ¬¡ç»“æ„ã€‚ å­˜å‚¨å™¨ç³»ç»Ÿæ˜¯ä¸€ä¸ªå…·æœ‰ä¸åŒå®¹é‡ã€æˆæœ¬å’Œè®¿é—®æ—¶é—´çš„å­˜å‚¨è®¾å¤‡çš„å±‚æ¬¡ç»“æ„ï¼Œå¦‚å›¾4-1æ‰€ç¤ºã€‚ åœ¨è¿™ä¸ªå±‚æ¬¡ç³»ç»Ÿä¸­ï¼Œä»é«˜å±‚åˆ°ä½å±‚(L0~L5),è¾ƒä½å±‚çš„å­˜å‚¨è®¾å¤‡é€Ÿåº¦æ›´æ…¢ã€å®¹é‡æ›´å¤§ã€ä»·æ ¼æ›´ä¾¿å®œã€‚åœ¨æœ€é«˜å±‚(L0å±‚)ï¼Œæ˜¯å°‘é‡çš„å¿«é€ŸCPUå¯„å­˜å™¨ï¼ŒCPUå¯ä»¥åœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…è®¿é—®å®ƒä»¬ã€‚æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªå°å‹æˆ–ä¸­å‹çš„åŸºäºSRAMçš„é«˜é€Ÿç¼“å­˜å­˜å‚¨å™¨ï¼Œå¯ä»¥åœ¨å‡ ä¸ªCPUæ—¶é’Ÿå‘¨æœŸå†…è®¿é—®å®ƒä»¬ã€‚ç„¶åL3å±‚æ˜¯ä¸€ä¸ªå¤§çš„åŸºäºDRAMçš„ä¸»å­˜ï¼Œå¯ä»¥åœ¨å‡ åæˆ–å‡ ç™¾ä¸ªæ—¶é’Ÿå‘¨æœŸå†…è®¿é—®å®ƒä»¬ã€‚L3çš„ä¸‹å±‚L4æ˜¯æ…¢é€Ÿä½†å®¹é‡å¾ˆå¤§çš„æœ¬åœ°ç£ç›˜ã€‚L5è¡¨ç¤ºæœ‰äº›ç³»ç»Ÿå¯èƒ½è¿˜åŒ…æ‹¬ä¸€å±‚é™„åŠ çš„è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ç£ç›˜ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œæ¥è®¿é—®å®ƒä»¬ã€‚ä¾‹å¦‚NTFç½‘ç»œæ–‡ä»¶ç³»ç»Ÿè¿™æ ·çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œå…è®¸ç¨‹åºè®¿é—®å­˜å‚¨åœ¨è¿œç¨‹ç½‘ç»œæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚ CPUå¯„å­˜å™¨ä¿å­˜æœ€å¸¸ç”¨çš„æ•°æ®ã€‚é è¿‘CPUçš„å®¹é‡å°ã€é€Ÿåº¦å¿«çš„é«˜é€Ÿç¼“å­˜å­˜å‚¨å™¨ä½œä¸ºé€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ã€å®¹é‡è¾ƒå¤§çš„ä¸»å­˜ä¸­æ•°æ®å’ŒæŒ‡ä»¤å­é›†çš„ç¼“å†²åŒºã€‚ä¸»å­˜æš‚æ—¶å­˜æ”¾å­˜å‚¨å®¹é‡æ›´å¤§ã€é€Ÿåº¦æ›´æ…¢çš„ç£ç›˜ä¸Šçš„æ•°æ®ã€‚è€Œè¿™äº›ç£ç›˜å¸¸å¸¸åˆä½œä¸ºå­˜å‚¨åœ¨é€šè¿‡ç½‘ç»œè¿æ¥çš„å…¶ä»–æœºå™¨çš„ç£ç›˜æˆ–ç£å¸¦ä¸Šçš„æ•°æ®çš„ç¼“å†²åŒºã€‚ å¦‚æœç¨‹åºéœ€è¦çš„æ•°æ®æ˜¯å­˜æ”¾åœ¨CPUå¯„å­˜å™¨ä¸­çš„ï¼Œç¨‹åºæ‰§è¡ŒæœŸé—´åœ¨é›¶ä¸ªå‘¨æœŸå†…å°±å¯ä»¥è®¿é—®åˆ°å®ƒä»¬ã€‚å¦‚æœå­˜å‚¨åœ¨é«˜é€Ÿç¼“å­˜ä¸­ã€éœ€è¦1~10ä¸ªå‘¨æœŸï¼Œå¦‚æœè¿™äº›æ•°æ®å­˜æ”¾åœ¨ä¸»å­˜ä¸­ï¼Œè®¿é—®å®ƒä»¬å°±éœ€è¦50~100ä¸ªå‘¨æœŸã€‚è€Œå¦‚æœè¿™äº›æ•°æ®æ˜¯å­˜æ”¾åœ¨ç£ç›˜ä¸­çš„ï¼Œè¦è®¿é—®å®ƒä»¬éœ€è¦å¤§çº¦2000ä¸‡ä¸ªå‘¨æœŸã€‚å› æ­¤ï¼Œåœ¨ç¼–å†™ç¨‹åºã€è®¾è®¡ç®—æ³•æ—¶è¦å°½å¯èƒ½æŠŠæœ€è¿‘å°†è¦è®¿é—®çš„æŒ‡ä»¤æˆ–æ•°æ®å­˜å‚¨åœ¨å±‚æ¬¡è¾ƒé«˜çš„åœ°æ–¹ï¼Œä»¥ä¾¿è®©CPUæ›´å¿«åœ°è®¿é—®åˆ°å®ƒä»¬ã€‚ ç¨‹åºçš„æ‰§è¡Œéµå¾ªå±€éƒ¨æ€§åŸç†ã€‚ç¨‹åºæ‰§è¡Œçš„å±€éƒ¨æ€§åŸç†æŒ‡å‡ºï¼Œç¨‹åºåœ¨æ‰§è¡Œæ—¶å‘ˆç°å‡ºå±€éƒ¨æ€§è§„å¾‹ï¼Œå³åœ¨ä¸€æ®µè¾ƒçŸ­çš„æ—¶é—´å†…ï¼Œç¨‹åºçš„æ‰§è¡Œä»…å±€é™äºæŸä¸ªéƒ¨åˆ†ï¼Œç›¸åº”åœ°ï¼Œå®ƒæ‰€è®¿é—®çš„å­˜å‚¨ç©ºé—´ä¹Ÿå±€é™äºæŸä¸ªåŒºåŸŸã€‚å…³äºç¨‹åºæ‰§è¡Œçš„å±€éƒ¨æ€§åŸç†æœ‰ä»¥ä¸‹å‡ ä¸ªè®ºç‚¹ã€‚ 1) ç¨‹åºåœ¨æ‰§è¡Œæ—¶ï¼Œé™¤äº†å°‘éƒ¨åˆ†çš„è½¬ç§»å’Œè¿‡ç¨‹è°ƒç”¨æŒ‡ä»¤ä»¥å¤–ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯é¡ºåºæ‰§è¡Œçš„ã€‚ 2) è¿‡ç¨‹è°ƒç”¨å°†ä¼šä½¿ç¨‹åºçš„æ‰§è¡Œè½¨è¿¹ç”±ä¸€éƒ¨åˆ†å†…å­˜åŒºåŸŸè½¬åˆ°å¦ä¸€éƒ¨åˆ†å†…å­˜åŒºåŸŸã€‚ä½†ç ”ç©¶è¡¨æ˜ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿‡ç¨‹è°ƒç”¨çš„æ·±åº¦éƒ½ä¸è¶…è¿‡5ã€‚è¿™å°±æ˜¯è¯´ï¼Œç¨‹åºå°†ä¼šåœ¨ä¸€æ®µæ—¶é—´å†…å±€é™åœ¨è¿™äº›è¿‡ç¨‹çš„èŒƒå›´å†…è¿è¡Œã€‚ 3) ç¨‹åºä¸­å­˜åœ¨å¾ˆå¤šå¾ªç¯ç»“æ„ï¼Œå®ƒä»¬è™½ç„¶ç”±å°‘æ•°æŒ‡ä»¤æ„æˆï¼Œä½†å¤šæ¬¡æ‰§è¡Œã€‚ 4) ç¨‹åºä¸­å¾€å¾€åŒ…æ‹¬è®¸å¤šå¯¹æ•°æ®ç»“æ„çš„å¤„ç†ã€‚ä¾‹å¦‚å¯¹æ•°ç»„è¿›è¡Œæ“ä½œï¼Œå®ƒä»¬å¾€å¾€éƒ½å±€é™åœ¨ å¾ˆå°çš„èŒƒå›´å†…ã€‚ æ€»çš„æ¥è¯´ï¼Œå±€éƒ¨æ€§åŸç†è¡¨ç°ä¸ºæ—¶é—´å’Œç©ºé—´çš„å±€éƒ¨æ€§ã€‚ 1) æ—¶é—´å±€éƒ¨æ€§ã€‚å¦‚æœç¨‹åºä¸­çš„æŸæ¡æŒ‡ä»¤ä¸€æ—¦æ‰§è¡Œï¼Œåˆ™ä¸ä¹…åè¯¥æŒ‡ä»¤å¯èƒ½å†æ¬¡æ‰§è¡Œã€‚å¦‚ æœæŸä¸ªæ•°æ®ç»“æ„è¢«è®¿å›ï¼Œä¸ä¹…ä»¥åè¯¥æ•°æ®ç»“æ„å¯èƒ½è¢«å†æ¬¡è®¿ã€‚ 2) ç©ºé—´å±€éƒ¨æ€§ã€‚ä¸€æ—¦ç¨‹åºè®¿é—®äº†æŸä¸ªå•å…ƒï¼Œåœ¨ä¸ä¹…ä¹‹åï¼Œå…¶é™„è¿‘çš„å­˜å‚¨å•å…ƒä¹Ÿå°†è¢«è®¿é—®ã€‚ å…·æœ‰è‰¯å¥½å±€éƒ¨æ€§çš„ç¨‹åºä¼šç»å¸¸è®¿é—®ç›¸åŒçš„æ•°æ®é›†åˆæˆ–ç›¸é‚»çš„æ•°æ®é›†åˆã€‚å…·æœ‰è‰¯å¥½å±€éƒ¨æ€§çš„ç¨‹åºæ¯”å±€éƒ¨æ€§å·®çš„ç¨‹åºèƒ½æ›´å¥½åœ°åˆ©ç”¨å¤„äºé«˜å±‚æ¬¡çš„å­˜å‚¨å™¨ï¼Œå› æ­¤è¿è¡Œé€Ÿåº¦æ›´å¿«ã€‚ä¾‹å¦‚ï¼Œä¸åŒçš„çŸ©é˜µåˆå§‹åŒ–ç¨‹åºï¼Œæ‰§è¡Œç›¸åŒæ•°é‡çš„èµ‹å€¼æ“ä½œï¼Œç”±äºç¨‹åºçš„ä¸åŒï¼Œå…·æœ‰ä¸åŒçš„å±€éƒ¨æ€§ï¼Œå…¶è¿è¡Œé€Ÿåº¦å¯èƒ½ç›¸å·®å¾ˆå¤§ã€‚ ç¬¬äºŒèŠ‚ ç¨‹åºçš„é“¾æ¥å’Œè£…å…¥ é«˜çº§è¯­è¨€ç¨‹åºå¿…é¡»ç»è¿‡ç¼–è¯‘ã€é“¾æ¥æ‰èƒ½æˆä¸ºå¯æ‰§è¡Œç¨‹åºï¼Œæ“ä½œç³»ç»Ÿéœ€è¦ä¸ºç¨‹åºçš„æ‰§è¡Œåˆ†é…å†…å­˜ç©ºé—´ã€‚ä¸‹é¢ä»‹ç»é“¾æ¥ç¨‹åºçš„åŠŸèƒ½å’Œç¨‹åºè¢«è£…äººå†…å­˜çš„å‡ ç§æ–¹å¼ã€‚ ä¸€ã€ç¨‹åºçš„é“¾æ¥ é“¾æ¥ç¨‹åºä¸å±äºæ“ä½œç³»ç»Ÿçš„æ„æˆéƒ¨åˆ†ï¼Œä½†æ˜¯å®ƒä¸ºæ“ä½œç³»ç»Ÿæä¾›å¯è£…å…¥çš„ç¨‹åºæ¨¡å—ã€‚é“¾æ¥ç¨‹åºè¦è§£å†³çš„é—®é¢˜æ˜¯å°†ç¼–è¯‘åçš„ç›®æ ‡æ¨¡å—è£…é…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„ç¨‹åºã€‚æ ¹æ®é“¾æ¥è¿›è¡Œçš„æ—¶é—´å’Œå®ç°æ–¹å¼çš„ä¸åŒï¼Œå¯ä»¥æŠŠé“¾æ¥åˆ†ä¸ºé™æ€é“¾æ¥å’ŒåŠ¨æ€é“¾æ¥ã€‚ 1. é™æ€é“¾æ¥ é™æ€é“¾æ¥(Static Linking)æ˜¯åœ¨ç¨‹åºè¿è¡Œå‰ï¼Œç”¨é“¾æ¥ç¨‹åºå°†ç›®æ ‡æ¨¡å—é“¾æ¥æˆä¸€ä¸ªå®Œæ•´çš„è£…å…¥æ¨¡å—ã€‚é™æ€é“¾æ¥ç¨‹åºçš„ä»»åŠ¡ä¸€æ˜¯å¯¹é€»è¾‘åœ°å€è¿›è¡Œä¿®æ”¹ï¼ŒäºŒæ˜¯å˜æ¢å¤–éƒ¨è°ƒç”¨ç¬¦å·ã€‚ (1) å¯¹é€»è¾‘åœ°å€è¿›è¡Œä¿®æ”¹ å¦‚å›¾4-2æ‰€ç¤ºï¼Œé“¾æ¥å‰æ¨¡å—Aã€Bã€Cçš„ç›¸å¯¹åœ°å€èŒƒå›´åˆ†åˆ«æ˜¯0~L-1ã€0~M-1ã€0~N -1ï¼Œé€šè¿‡é“¾æ¥ç¨‹åºæŠŠä¸‰ä¸ªç›®æ ‡æ¨¡å—é“¾æ¥æˆä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºåï¼Œæ¨¡å—Bå’ŒCçš„é€»è¾‘åœ°å€èŒƒå›´å˜æˆäº†L~L+M-1ã€L+M~L+M+N-1ã€‚ä¸‰ä¸ªç‹¬ç«‹ç›®æ ‡æ¨¡å—çš„é€»è¾‘åœ°å€ç©ºé—´é“¾æ¥æˆäº†ä¸€ä¸ªè¿ç»­çš„åœ°å€ç©ºé—´ã€‚ (2) å˜æ¢å¤–éƒ¨è°ƒç”¨ç¬¦å· å°†æ¯ä¸ªæ¨¡å—ä¸­æ‰€ç”¨çš„å¤–éƒ¨è°ƒç”¨ç¬¦å·éƒ½å˜æ¢ä¸ºé€»è¾‘åœ°å€ã€‚åœ¨å›¾4-2ä¸­ï¼Œç»è¿‡é“¾æ¥åï¼Œjå°†æ¨¡å—Bçš„å¤–éƒ¨è°ƒç”¨CALL Bå˜æˆäº†ä¸€æ¡è·³è½¬åˆ°æ¨¡å—Båœ¨ç›¸å¯¹åœ°å€ç©ºé—´ä¸­çš„èµ·å§‹åœ°å€Lå¤„çš„æŒ‡ä»¤JSRâ€L\"ã€‚å¯¹æ¨¡å—Bçš„å¤–éƒ¨è°ƒç”¨CALL Cå˜æˆäº†ä¸€æ¡è·³è½¬åˆ°æ¨¡å—Cåœ¨é€»è¾‘åœ°å€ç©ºé—´ä¸­çš„èµ·å§‹åœ°å€L+Må¤„çš„æŒ‡ä»¤JSR\" L+M\"ã€‚ é™æ€é“¾æ¥ç›¸å¯¹äºåŠ¨æ€é“¾æ¥è€Œè¨€ï¼Œç¨‹åºè¿è¡Œé€Ÿåº¦è¾ƒå¿«ã€‚ä½†æ˜¯æ— è®ºç¨‹åºåœ¨æœ¬æ¬¡è¿è¡Œä¸­ä¼šä¸ä¼šè¢«æ‰§è¡Œï¼Œéƒ½å°†å…¨éƒ¨è¢«é“¾æ¥åˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œä½¿å¯æ‰§è¡Œæ–‡ä»¶æ¯”è¾ƒå¤§ï¼Œå ç”¨çš„å†…å¤–å­˜ç©ºé—´è¾ƒå¤§ï¼Œä½¿å­˜å‚¨å¼€é”€è¾ƒå¤§ã€‚å¦å¤–ï¼Œä½¿ç”¨é™æ€é“¾æ¥çš„æ–¹å¼ï¼Œç¨‹åºå¼€å‘ä¸å¤Ÿçµæ´»ã€æ–¹ä¾¿ï¼Œä¿®æ”¹æŸä¸€ä¸ªæ¨¡å—ä¼šå¯¼è‡´æ•´ä¸ªç¨‹åºçš„é‡æ–°é“¾æ¥ã€‚ 2. åŠ¨æ€é“¾æ¥ é‡‡ç”¨åŠ¨æ€é“¾æ¥(Run--time Dynamic Linking)ï¼Œå¯å°†æŸäº›ç›®æ ‡æ¨¡å—çš„é“¾æ¥æ¨è¿Ÿåˆ°è¿™äº›æ¨¡å—ä¸­çš„å‡½æ•°è¢«è°ƒç”¨æ‰§è¡Œæ—¶æ‰è¿›è¡Œã€‚å³åœ¨ç¨‹åºæ‰§è¡Œæ—¶ï¼Œè‹¥å‘ç°ä¸€ä¸ªè¢«è°ƒç”¨æ¨¡å—å°šæœªé“¾æ¥ï¼Œå†æŠŠå®ƒé“¾æ¥åˆ°è°ƒç”¨è€…æ¨¡å—ä¸Šã€‚é‡‡ç”¨åŠ¨æ€é“¾æ¥çš„ä¼˜ç‚¹æ˜¯èŠ‚çœå†…å­˜å’Œå¤–å­˜ç©ºé—´ï¼Œæ–¹ä¾¿äº†ç¨‹åºå¼€å‘ã€‚ä¾‹å¦‚å¼€å‘ä¸€ä¸ªå›¾å½¢æ§ä»¶ï¼Œè‹¥è®©å›¾å½¢æ§ä»¶ä»¥åŠ¨æ€é“¾æ¥åº“çš„å½¢å¼å­˜åœ¨ï¼Œè¿™ä¸ªæ§ä»¶å°±å¯ä»¥ç‹¬ç«‹å¼€å‘ã€ç‹¬ç«‹ç¼–è¯‘å’Œé“¾æ¥ã€‚ä½†ç”±äºåŠ¨æ€é“¾æ¥æ˜¯åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä»å¤–å­˜å°†è¢«è°ƒç”¨çš„æ¨¡å—è°ƒå…¥å†…å­˜å¹¶é“¾æ¥åˆ°è°ƒç”¨è€…æ¨¡å—ä¸Šï¼Œè¿™éœ€è¦è¿è¡Œæ—¶çš„æ—¶é—´å¼€é”€ï¼Œä¼šä½¿ç¨‹åºè¿è¡Œæ—¶çš„é€Ÿåº¦å˜æ…¢ã€‚ äºŒã€ç¨‹åºçš„è£…å…¥ åœ¨å¤šé“ç¨‹åºç¯å¢ƒä¸‹ï¼Œç¨‹åºè¦è¿è¡Œå¿…é¡»ä¸ºä¹‹åˆ›å»ºè¿›ç¨‹ï¼Œè€Œåˆ›å»ºè¿›ç¨‹åï¼Œä¸å¯é¿å…åœ°è¦ä¸ºè¿›ç¨‹åˆ†é…å†…å­˜ï¼Œå¹¶å°†è¿›ç¨‹çš„ç¨‹åºå’Œæ•°æ®è£…äººå†…å­˜ã€‚å°†ä¸€ä¸ªç”¨æˆ·çš„æºç¨‹åºå˜ä¸ºä¸€ä¸ªå¯åœ¨å†…å­˜ä¸­æ‰§è¡Œçš„ç¨‹åºï¼Œé€šå¸¸è¦ç»è¿‡ç¼–è¯‘ã€é“¾æ¥å’Œè£…äºº3ä¸ªé˜¶æ®µã€‚ é€šå¸¸ï¼Œå¯æ‰§è¡Œç¨‹åºä»¥äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶çš„å½¢å¼å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œä¸ºæ‰§è¡Œç¨‹åºï¼Œæ“ä½œç³»ç»Ÿéœ€è¦æŠŠç¨‹åºè°ƒäººå†…å­˜ã€‚ å¤šæ•°ç³»ç»Ÿå…è®¸æ“ä½œç³»ç»Ÿå°†ç”¨æˆ·è¿›ç¨‹æ”¾åœ¨ç‰©ç†å†…å­˜çš„ä»»æ„ä½ç½®ã€‚å› æ­¤ï¼Œè™½ç„¶è®¡ç®—æœºçš„åœ°å€ç©ºé—´ä»0å¼€å§‹ï¼Œä½†ç”¨æˆ·è¿›ç¨‹çš„èµ·å§‹åœ°å€ä¸ä¸€å®šæ˜¯0ã€‚åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæºç¨‹åºéœ€è¦ç»è¿‡ç¼–è¯‘ã€é“¾æ¥å’Œè£…å…¥å‡ ä¸ªé˜¶æ®µæ‰èƒ½æ‰§è¡Œã€‚åœ¨ä¸åŒé˜¶æ®µï¼Œç¨‹åºåœ°å€æœ‰ä¸åŒçš„è¡¨ç¤ºå½¢å¼ã€‚æºç¨‹åºä¸­çš„åœ°å€é€šå¸¸æ˜¯ç¬¦å·è¡¨ç¤ºï¼Œå¦‚ä¸€ä¸ªæ•´å‹å˜é‡counterã€‚ç¼–è¯‘å™¨å°†è¿™äº›ç¬¦å·åœ°å€å˜æˆå¯é‡å®šä½åœ°å€ï¼Œé€šå¸¸æ˜¯ç›¸å¯¹äºæœ¬æ¨¡å—å¼€å§‹ä½ç½®çš„åœ°å€ã€‚ä¾‹å¦‚ï¼Œè¢«ç¼–è¯‘æ¨¡å—çš„èµ·å§‹åœ°å€ä¸º0ï¼Œæ‰€æœ‰ç¬¦å·åœ°å€éƒ½è½¬å˜æˆç›¸å¯¹äº0å¼€å§‹çš„ä¸€ä¸ªé€»è¾‘åœ°å€ã€‚é“¾æ¥ç¨‹åºæŠŠå‡ ä¸ªç›®æ ‡æ¨¡å—çš„é€»è¾‘åœ°å€è½¬å˜ä¸ºç›¸å¯¹äºæ•´ä¸ªå¯æ‰§è¡Œç¨‹åºçš„èµ·å§‹åœ°å€çš„é€»è¾‘åœ°å€ã€‚æ¯ä¸€æ¬¡çš„åœ°å€å˜åŒ–éƒ½æ˜¯ä»ä¸€ä¸ªåœ°å€ç©ºé—´åˆ°å¦ä¸€ä¸ªåœ°å€ ç©ºé—´çš„æ˜ å°„ã€‚æ ¹æ®å½¢æˆåœ¨å†…å­˜ä¸­ç‰©ç†åœ°å€çš„æ—¶æœºä¸åŒï¼ŒæŠŠç¨‹åºçš„è£…å…¥æ–¹å¼åˆ†ä¸ºç»å¯¹è£…å…¥æ–¹å¼ã€å¯é‡å®šä½è£…å…¥æ–¹å¼ï¼ˆé™æ€é‡å®šä½ï¼‰å’ŒåŠ¨æ€è¿è¡Œæ—¶è£…å…¥æ–¹å¼ã€‚ 1. ç»å¯¹è£…å…¥æ–¹å¼ ç¼–è¯‘ç¨‹åºäº‹å…ˆå·²çŸ¥ç¨‹åºåœ¨å†…å­˜ä¸­çš„é©»ç•™ä½ç½®ï¼Œç¼–è¯‘æ—¶äº§ç”Ÿç‰©ç†åœ°å€çš„ç›®æ ‡ä»£ç ï¼Œç»å¯¹è£…å…¥ç¨‹åºæŒ‰ç…§è£…å…¥æ¨¡å—çš„ç‰©ç†åœ°å€å°†ç¨‹åºå’Œæ•°æ®è£…å…¥å†…å­˜ã€‚å› æ­¤è£…å…¥æ¨¡å—è¢«è£…å…¥å†…å­˜åï¼Œæ— éœ€å¯¹ç¨‹åºå’Œæ•°æ®çš„åœ°å€è¿›è¡Œä¿®æ”¹ã€‚ 2. å¯é‡å®šä½è£…å…¥æ–¹å¼ï¼ˆé™æ€é‡å®šä½ï¼‰ åœ¨å¤šé“ç¨‹åºç³»ç»Ÿä¸­ï¼Œä¼—å¤šç”¨æˆ·è¿›ç¨‹å…±äº«å†…å­˜ç©ºé—´ï¼Œä»€ä¹ˆæ—¶å€™ç©ºé—²ã€å†…å­˜çš„å“ªä¸€å—åŒºåŸŸç©ºé—²ï¼Œå¯ä»¥è®©æ“ä½œç³»ç»Ÿåœ¨æ­¤è£…å…¥ä¸€ä¸ªæ–°è¿›ç¨‹æ˜¯æ— æ³•é¢„çŸ¥çš„ã€‚å› æ­¤ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘ç¨‹åºæ—¶æ— æ³•å½¢æˆç¨‹åºçš„ç‰©ç†åœ°å€ã€‚å¦‚æœç¼–è¯‘æ—¶ä¸çŸ¥é“ç›®æ ‡ç¨‹åºå°†é©»ç•™åœ¨å†…å­˜çš„ä»€ä¹ˆä½ç½®ï¼Œé‚£ä¹ˆç¼–è¯‘æ—¶å°±å¿…é¡»ç”Ÿæˆå¯é‡å®šä½çš„ä»£ç ï¼Œå…¶ä¸­çš„åœ°å€éƒ½æ˜¯é€»è¾‘åœ°å€ï¼Œåœ¨ç¨‹åºè¢«è£…å…¥å†…å­˜æ—¶ï¼Œå†æŠŠè¿™äº›é€»è¾‘åœ°å€æ˜ å°„ä¸ºç‰©ç†åœ°å€ã€‚åœ¨ç¨‹åºè£…å…¥æ—¶å¯¹ç›®æ ‡ç¨‹åºä¸­çš„æŒ‡ä»¤å’Œæ•°æ®åœ°å€çš„ä¿®æ”¹è¿‡ç¨‹ç§°ä¸ºé‡å®šä½ã€‚ å¯é‡å®šä½æ–¹å¼çš„ä¸¤ä¸ªç‰¹ç‚¹å¦‚ä¸‹ã€‚ 1) ç¼–è¯‘ç¨‹åºä½¿ç›®æ ‡æ¨¡å—çš„èµ·å§‹åœ°å€ä»0å¼€å§‹ã€‚ 2) ç¨‹åºè£…å…¥æ—¶ï¼Œè£…å…¥ç¨‹åºæ ¹æ®å†…å­˜çš„ä½¿ç”¨æƒ…å†µå°†è£…å…¥æ¨¡å—è£…å…¥åˆ°å†…å­˜çš„æŸä¸ªä½ç½®ï¼Œå¹¶å¯¹æ¨¡å—è¿›è¡Œé‡å®šä½ã€‚ ç‰©ç†åœ°å€=æœ‰æ•ˆé€»è¾‘åœ°å€+ç¨‹åºåœ¨å†…å­˜ä¸­çš„èµ·å§‹åœ°å€ã€‚ åœ¨é‡‡ç”¨å¯é‡å®šä½è£…å…¥æ–¹å¼å°†ç¨‹åºè£…å…¥å†…å­˜åï¼Œç¨‹åºåœ¨å†…å­˜ä¸­çš„å®é™…ç‰©ç†åœ°å€ä¸é€»è¾‘åœ°å€é€šå¸¸æ˜¯ä¸ç›¸åŒçš„ã€‚å¦‚å›¾4-3æ‰€ç¤ºï¼Œç¨‹åºåœ¨é€»è¾‘åœ°å€ï¼ˆç›¸å¯¹åœ°å€ï¼‰ä¸º1000çš„å•å…ƒä¸­æœ‰ä¸€æ¡æŒ‡ ä»¤LOAD 1ï¼Œ2500ã€‚è¯¥æŒ‡ä»¤çš„è¯­ä¹‰æ˜¯å°†é€»è¾‘åœ°å€ä¸º2500å¤„çš„å†…å®¹å–å‡ºè£…å…¥1å·å¯„å­˜å™¨ï¼Œé€»è¾‘åœ°å€ä¸º2500çš„å•å…ƒè£…æœ‰æ•°æ®365ã€‚è‹¥é‡‡ç”¨é‡å®šä½è£…äººæ–¹å¼å°†è¯¥ç”¨æˆ·ç¨‹åºè£…å…¥å†…å­˜å®é™…ç‰©ç†åœ°å€ä»10000å¼€å§‹çš„å†…å­˜å•å…ƒï¼Œå°±å¿…é¡»æ ¹æ®é€»è¾‘åœ°å€å’Œç”¨æˆ·ç¨‹åºåœ¨å†…å­˜ä¸­çš„èµ·å§‹åœ°å€è®¡ç®—å¹¶ä¿®æ”¹ç”¨æˆ·ç¨‹åºåœ¨ç‰©ç†å†…å­˜ä¸­çš„å®é™…åœ°å€ã€‚æŒ‡ä»¤LOAD 1ï¼Œ2500çš„å®é™…ç‰©ç†åœ°å€æ”¹ä¸º1000+10000ï¼Œå³11000ã€‚æ•°æ®365æ‰€åœ¨çš„å®é™…ç‰©ç†å†…å­˜å•å…ƒåœ°å€æ”¹ä¸º2500+10000ï¼Œå³12500ã€‚ç”¨æˆ·ç¨‹åºè£…å…¥å†…å­˜åï¼ŒæŒ‡ä»¤ä¸­çš„é€»è¾‘åœ°å€ä¹Ÿéœ€è¦ä¿®æ”¹ä¸ºå®é™…ç‰©ç†åœ°å€ï¼ŒæŒ‡ä»¤L OAD 1ï¼Œ2500è¦ä¿®æ”¹ä¸ºLOAD1ï¼Œ12500ã€‚ 3. åŠ¨æ€è¿è¡Œæ—¶è£…å…¥ï¼ˆåŠ¨æ€é‡å®šä½ï¼‰ è¿›ç¨‹åœ¨è£…å…¥å†…å­˜åï¼Œè¿˜å¯èƒ½ä»å†…å­˜çš„ä¸€ä¸ªåŒºåŸŸç§»åŠ¨åˆ°å¦ä¸€ä¸ªåŒºåŸŸï¼Œè¿™ç§æƒ…å†µå¯èƒ½å‘ç”Ÿåœ¨æ”¯æŒè™šæ‹Ÿå­˜å‚¨çš„ç³»ç»Ÿä¸­ã€‚ä¸€ä¸ªè¿›ç¨‹åœ¨è¢«æ¢å‡ºä¹‹å‰æ‰€åœ¨çš„å†…å­˜ä½ç½®ä¸åæ¥è¢«ä»å¤–å­˜é‡æ–°è°ƒå…¥å†…å­˜æ—¶æ‰€åœ¨çš„å†…å­˜ä½ç½®ä¸åŒï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåœ°å€æ˜ å°„å¿…é¡»å»¶è¿Ÿåˆ°è¿›ç¨‹æ‰§è¡Œæ—¶å†è¿›è¡Œï¼ŒæŠŠè¿™ç§è£…äººæ–¹å¼ç§°ä¸ºåŠ¨æ€è¿è¡Œæ—¶è£…å…¥ã€‚ åœ¨é‡‡ç”¨åŠ¨æ€è¿è¡Œæ—¶è£…å…¥æ–¹å¼çš„ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿå°†è¿›ç¨‹è£…å…¥å†…å­˜åï¼Œç”±äºè¿›ç¨‹åœ¨å†…å­˜ä¸­çš„ä½ç½®å¯èƒ½å‘ç”Ÿç§»åŠ¨ï¼Œæ‰€ä»¥æ­¤æ—¶å¹¶ä¸è®¡ç®—ç‰©ç†åœ°å€ï¼Œè€Œæ˜¯åœ¨è¿›ç¨‹è¿è¡Œè®¿å­˜çš„è¿‡ç¨‹ä¸­æ‰è¿›è¡Œåœ°å€è½¬æ¢ï¼Œè¿™ç§æ–¹å¼éœ€è¦é‡å®šä½å¯„å­˜å™¨çš„æ”¯æŒã€‚å½“è¿›ç¨‹è·å¾—CPUè¿è¡Œæ—¶ï¼Œç³»ç»ŸæŠŠè¯¥è¿›ç¨‹åœ¨å†…å­˜çš„èµ·å§‹åœ°å€å­˜å…¥é‡å®šä½å¯„å­˜å™¨ï¼Œè¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­è®¿å­˜æ—¶ï¼Œé€šè¿‡é‡å®šä½å¯„å­˜å™¨ä¸è¢«è®¿é—®å•å…ƒçš„é€»è¾‘åœ°å€è®¡ç®—å‡ºè¢«è®¿é—®å•å…ƒçš„ç‰©ç†åœ°å€ï¼Œå¦‚å›¾4-4æ‰€ç¤ºã€‚ è¿›ç¨‹è·å¾—CPUè¿è¡Œæ—¶ï¼Œæ“ä½œç³»ç»Ÿå°†è¿›ç¨‹åœ¨å†…å­˜ä¸­çš„èµ·å§‹åœ°å€10000å­˜å…¥é‡å®šä½å¯„å­˜å™¨ï¼Œä½œä¸šè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå½“è¦æ‰§è¡Œé€»è¾‘åœ°å€ä¸º1000çš„å•å…ƒä¸­çš„æŒ‡ä»¤æ—¶ï¼Œç”¨é€»è¾‘åœ°å€1000ä¸é‡å®šä½å¯„å­˜å™¨ä¸­çš„åœ°å€10000ç›¸åŠ ï¼Œå¾—åˆ°å®é™…ç‰©ç†å†…å­˜åœ°å€11000ã€‚CPUä»11000ç‰©ç†å•å…ƒå–åˆ°æŒ‡ä»¤LOAD 1ï¼Œ2500ã€‚å½“æ‰§è¡Œè¯¥æŒ‡ä»¤è®¿é—®é€»è¾‘åœ°å€ä¸º2500çš„å•å…ƒå–365æ—¶ï¼Œå…ˆå°†2500ä¸é‡å®šä½å¯„å­˜å™¨çš„å€¼10000ç›¸åŠ ï¼Œå¾—åˆ°365æ‰€åœ¨çš„ç‰©ç†å•å…ƒåœ°å€12500ï¼Œç„¶åä»12500ç‰©ç†å•å…ƒè¯»å–æ•°æ®365 é‡å®šä½å¯„å­˜å™¨æ˜¯æ¯CPUä¸€ä¸ªçš„ï¼Œå½“å‘ç”Ÿè¿›ç¨‹åˆ‡æ¢æ—¶ï¼Œè¦ç”¨è·å¾—CPUçš„è¿›ç¨‹åœ¨å†…å­˜çš„èµ·å§‹åœ°å€æ›´æ–°é‡å®šä½å¯„å­˜å™¨ã€‚ ç¬¬ä¸‰èŠ‚ è¿ç»­åˆ†é…å­˜å‚¨ç®¡ç†æ–¹å¼ è¿ç»­åˆ†é…æ˜¯æŒ‡æ“ä½œç³»ç»Ÿåˆ†é…å†…å­˜æ—¶ï¼Œä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€å—ç‰©ç†åœ°å€è¿ç»­çš„å†…å­˜ç©ºé—´ã€‚è¿ ç»­åˆ†é…æ–¹å¼æœ‰3ç§ç±»å‹ã€‚ 1. å•ä¸€è¿ç»­åŒºåˆ†é…æ–¹å¼ å†…å­˜ä¸­åªæœ‰ä¸€ä¸ªç”¨æˆ·åŒºï¼Œä»»æ„æ—¶åˆ»å†…å­˜ä¸­åªèƒ½è£…äººä¸€é“ç¨‹åºï¼Œè¿™ç§åˆ†é…æ–¹å¼ä»…é€‚ç”¨äºå•ç”¨æˆ·ã€å•ä»»åŠ¡çš„ç³»ç»Ÿã€‚ 2. å›ºå®šåˆ†åŒºåˆ†é…æ–¹å¼ å°†å†…å­˜ç”¨æˆ·åŒºåˆ’åˆ†æˆè‹¥å¹²ä¸ªå›ºå®šå¤§å°çš„åŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸä¸­é©»ç•™ä¸€é“ç¨‹åºã€‚ 3. åŠ¨æ€åˆ†åŒºåˆ†é…æ–¹å¼ ç³»ç»ŸåŠ¨æ€åœ°å¯¹å†…å­˜è¿›è¡Œåˆ’åˆ†ï¼Œæ ¹æ®è¿›ç¨‹éœ€è¦çš„ç©ºé—´å¤§å°åˆ†é…å†…å­˜ã€‚å†…å­˜ä¸­åˆ†åŒºçš„å¤§å°å’Œæ•°é‡æ˜¯å˜åŒ–çš„ã€‚åŠ¨æ€åˆ†åŒºæ–¹å¼æ¯”å›ºå®šåˆ†åŒºæ–¹å¼æ˜¾è‘—åœ°æé«˜äº†å†…å­˜åˆ©ç”¨ç‡ã€‚ ä¸€ã€å•ä¸€è¿ç»­åˆ†é… å•ä¸€è¿ç»­åˆ†é…æ–¹å¼é€‚ç”¨äºå•ç”¨æˆ·ã€å•ä»»åŠ¡çš„æ“ä½œç³»ç»Ÿï¼Œå®ƒæŠŠå†…å­˜åˆ†ä¸ºç³»ç»ŸåŒºå’Œç”¨æˆ·åŒºï¼Œç³»ç»ŸåŒºä»…ä¾›æ“ä½œç³»ç»Ÿä½¿ç”¨ï¼Œç”¨æˆ·åŒºä¾›ç”¨æˆ·ä½¿ç”¨ï¼Œå¦‚å›¾4-5æ‰€ç¤ºã€‚ ç³»ç»ŸåŒºç”¨äºé©»ç•™æ“ä½œç³»ç»Ÿï¼Œç”¨æˆ·åŒºç”¨äºåˆ†é…ç»™ç”¨æˆ·è¿›ç¨‹ä½¿ç”¨ã€‚ä¸ºäº†é˜²æ­¢ç”¨æˆ·ç¨‹åºå¯¹æ“ä½œç³»ç»Ÿçš„ç ´åï¼Œä¿è¯ç³»ç»Ÿçš„å®‰å…¨å¯é ï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­åº”è¯¥è€ƒè™‘è®¾ç½®å­˜å‚¨å™¨ä¿æŠ¤æœºåˆ¶ã€‚åœ¨å•ç”¨æˆ·å•ä»»åŠ¡æ“ä½œç³»ç»Ÿä¸­è¾ƒå¸¸ç”¨çš„æ–¹æ³•æ˜¯è®¾ç½®ä¸€ä¸ªåŸºå€å¯„å­˜å™¨å’Œä¸€ä¸ª ç•Œé™å¯„å­˜å™¨ã€‚åŸºå€å¯„å­˜å™¨ä¸­å­˜æ”¾ç¨‹åºåœ¨ç‰©ç†å†…å­˜ä¸­çš„æœ€å°åœ°å€ï¼Œç•Œé™å¯„å­˜å™¨ä¸­å­˜æ”¾è£…å…¥ç”¨æˆ·åŒºç¨‹åºçš„åœ°å€èŒƒå›´ã€‚åœ¨CPUè®¿é—®å†…å­˜æ—¶ï¼Œæ£€æŸ¥CPUè¦è®¿é—®çš„å†…å­˜å•å…ƒçš„åœ°å€æ˜¯å¦å¤§äºç•Œé™å¯„å­˜å™¨çš„å€¼ã€‚å¦‚æœå¤§äºç•Œé™å¯„å­˜å™¨ä¸­çš„åœ°å€èŒƒå›´ï¼Œåˆ™æ˜¯éæ³•åœ°å€ï¼Œè¡¨ ç¤ºç”¨æˆ·è¿›ç¨‹è®¿å­˜è¶Šç•Œï¼Œç¨‹åºæ‰§è¡Œä¼šè¢«ä¸­æ–­ã€‚ åœ¨æœ‰äº›å•ç”¨æˆ·ã€å•ä»»åŠ¡çš„æ“ä½œç³»ç»Ÿï¼Œå¦‚CP/Må’ŒMS-DOSä¸­ï¼Œæ²¡æœ‰è®¾ç½®å­˜å‚¨å™¨ä¿æŠ¤æœºåˆ¶ã€‚å…¶ç†ç”±ä¸ºï¼šä¸€æ˜¯èŠ‚çœç¡¬ä»¶ï¼›äºŒæ˜¯å•ä»»åŠ¡å•ç”¨æˆ·ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·ç‹¬å æœºå™¨ï¼Œå¯¹ç³»ç»Ÿçš„ç ´ååªå¯èƒ½æ˜¯ç”¨æˆ·è‡ªå·±é€ æˆçš„ï¼Œåæœä¹Ÿä¸ä¸¥é‡ï¼Œä¸ä¼šå½±å“å…¶ä»–ç”¨æˆ·ç¨‹åºçš„æ‰§è¡Œï¼Œè€Œä¸”æ“ä½œç³»ç»Ÿå¾ˆå®¹æ˜“é‡è£…å’Œå†æ¬¡å¯åŠ¨ã€‚ äºŒã€å›ºå®šåˆ†åŒºåˆ†é… å›ºå®šåˆ†åŒºåˆ†é…å°†ç”¨æˆ·å†…å­˜ç©ºé—´åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªå›ºå®šå¤§å°çš„åŒºåŸŸï¼Œåœ¨æ¯ä¸ªç”¨æˆ·åŒºä¸­å¯ä»¥è£…å…¥ä¸€é“ç”¨æˆ·ç¨‹åºï¼Œå¦‚å›¾4-6æ‰€ç¤ºã€‚ å†…å­˜çš„ç”¨æˆ·åŒºè¢«åˆ’åˆ†æˆå‡ ä¸ªåˆ†åŒºï¼Œä¾¿å…è®¸å‡ ä¸ªè¿›ç¨‹å¹¶å‘è¿è¡Œã€‚å½“æœ‰ä¸€ä¸ªç©ºé—²åˆ†åŒºæ—¶ï¼Œå¯ä»å¤–å­˜çš„åå¤‡é˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªå¤§å°é€‚å½“çš„ä½œä¸šè£…å…¥è¯¥åˆ†åŒºã€‚å½“è¯¥ä½œä¸šç»“æŸæ—¶ï¼Œé‡Šæ”¾æ‰€å ç”¨çš„åˆ†åŒºï¼Œç³»ç»Ÿåˆå¯ä»åå¤‡ä½œä¸šé˜Ÿåˆ—ä¸­æ‰¾å‡ºå¦ä¸€ä¸ªä½œä¸šè°ƒäººè¯¥åˆ†åŒºã€‚ 1. åˆ’åˆ†åˆ†åŒºçš„æ–¹æ³• å›ºå®šåˆ†åŒºåˆ†é…çš„ç”¨æˆ·åˆ†åŒºæ•°é‡æ˜¯å›ºå®šçš„ï¼Œæ¯ä¸ªåˆ†åŒºçš„å¤§å°ä¹Ÿæ˜¯å›ºå®šçš„ã€‚ä½†æ˜¯æ¯ä¸ªåˆ†åŒºçš„å¤§å°å¯ä»¥ç›¸ç­‰ã€ä¹Ÿå¯ä»¥ä¸ç›¸ç­‰ã€‚ (1) åˆ†åŒºå¤§å°ç›¸ç­‰ åœ¨è¿™ç§è®¾è®¡ä¸­ï¼ŒæŠŠç”¨æˆ·åŒºåˆ’åˆ†æˆå¤§å°ç›¸ç­‰çš„è‹¥å¹²ä¸ªåˆ†åŒºã€‚è¿™ç§è®¾è®¡çš„ç¼ºç‚¹æ˜¯å†…å­˜åˆ©ç”¨ç‡æ¯”è¾ƒä½ã€‚å½“ç¨‹åºå¤ªå°æ—¶ï¼Œè¯¥ç¨‹åºæ‰€å ç”¨çš„åˆ†åŒºæœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†ç©ºé—´æ˜¯ç©ºé—²çš„ã€‚è€Œç¨‹åºè¾ƒå¤§æ—¶ï¼Œå¯èƒ½æ‰¾ä¸åˆ°ä¸€ä¸ªåˆ†åŒºè¶³ä»¥è£…ä¸‹è¯¥ç¨‹åºã€‚è¿™ç§è®¾è®¡ä¸»è¦ç”¨äºåˆ©ç”¨ä¸€å°è®¡ç®—æœºå»æ§åˆ¶å¤šä¸ªç›¸åŒå¯¹è±¡çš„åœºåˆï¼Œå› ä¸ºè¿™ç§æƒ…å†µä¸‹ï¼Œå„ç”¨æˆ·è¿›ç¨‹éœ€è¦çš„ç©ºé—´å¤§å°ç›¸åŒï¼Œä¾‹å¦‚ï¼Œç”¨ä¸€å°è®¡ç®—æœºæ§åˆ¶å¤šå°ç›¸åŒçš„å†¶ç‚¼ç‚‰ã€‚ (2) åˆ†åŒºå¤§å°ä¸ç­‰ ä¸ºäº†æ›´å¥½åœ°åˆ©ç”¨å†…å­˜ï¼Œå¯ä»¥å°†ç”¨æˆ·åŒºåˆ’åˆ†æˆå¤§å°ä¸åŒã€æ•°é‡å›ºå®šçš„è‹¥å¹²ä¸ªåˆ†åŒºã€‚ä¸ºç”¨æˆ·è¿›ç¨‹åˆ†é…ç©ºé—´æ—¶ï¼ŒæŠŠå¤§å°æœ€æ¥è¿‘è¿›ç¨‹å¤§å°çš„ç©ºé—²åˆ†åŒºåˆ†é…ç»™ç”³è¯·å†…å­˜ç©ºé—´çš„è¿›ç¨‹ã€‚ä½¿å°è¿›ç¨‹å å°åˆ†åŒºï¼Œå¤§è¿›ç¨‹å å¤§åˆ†åŒºï¼Œå‡å°‘å†…å­˜æµªè´¹ã€‚ 2. æ”¯æŒå›ºå®šåˆ†åŒºåˆ†é…çš„æ•°æ®ç»“æ„ æ“ä½œç³»ç»Ÿä¸ºäº†å®Œæˆå¯¹å›ºå®šåˆ†åŒºçš„ç®¡ç†ï¼Œå¿…é¡»å®šä¹‰ä¸€ä¸ªè®°å½•ç”¨æˆ·åˆ†åŒºå¤§å°å’Œä½¿ç”¨æƒ…å†µçš„æ•° æ®ç»“æ„ã€‚å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¦‚è¡¨4-1æ‰€ç¤ºçš„è®°å½•å†…å­˜çŠ¶å†µçš„å†…å­˜åˆ†åŒºè¯´æ˜è¡¨æ¥ç®¡ç†å†…å­˜åˆ†é…ã€‚ ç”¨Cè¯­è¨€æ¥æè¿°è¿™ä¸ªåˆ†åŒºè¡¨ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªæœ‰4ä¸ªå…ƒç´ çš„ç»“æ„æ•°ç»„ã€‚æ¯ä¸ªå…ƒç´ å¯¹åº”ä¸€ä¸ªåˆ†åŒºã€‚ç»“æ„ä½“åŒ…æ‹¬4ä¸ªå­—æ®µï¼šåˆ†åŒºç¼–å·ã€åˆ†åŒºå¤§å°ã€åˆ†åŒºèµ·å§‹åœ°å€å’Œåˆ†åŒºçŠ¶æ€ã€‚æ•°æ®ç»“æ„å®šä¹‰ç¤ºä¾‹å¦‚ä¸‹ã€‚ struct { int num;//åˆ†åŒºç¼–å· int length;//åˆ†åŒºå¤§å° int addr;//åˆ†åŒºèµ·å§‹åœ°å€ int state;//åˆ†åŒºçŠ¶æ€ï¼Œè¯¥å€¼ä¸º0è¡¨ç¤ºåˆ†åŒºç©ºé—²ï¼›è¯¥å€¼ä¸º1è¡¨ç¤ºåˆ†åŒºè¢«å ç”¨ } mem_block[4]; å†™ç¨‹åºæ—¶æ•°æ®ç»“æ„çš„å®šä¹‰æ ¹æ®å…·ä½“ç³»ç»Ÿçš„éœ€è¦å’Œç®—æ³•çš„éœ€è¦æ¥è°ƒæ•´ã€‚ 3. å›ºå®šåˆ†åŒºåˆ†é…çš„è¿‡ç¨‹ éœ€è¦ä¸ºè¿›ç¨‹åˆ†é…å†…å­˜æ—¶ï¼Œæ“ä½œç³»ç»Ÿæ‰§è¡Œå†…å­˜åˆ†é…ç¨‹åºï¼Œæœç´¢å†…å­˜åˆ†åŒºä½¿ç”¨è¡¨ã€‚å½“æ‰¾åˆ°ä¸ªå¤§å°å¤§äºæˆ–ç­‰äºè¿›ç¨‹éœ€è¦çš„å†…å­˜ç©ºé—´è€Œä¸”å¤„äºå®¤é—²çŠ¶æ€çš„ç”¨æˆ·åˆ†åŒºæ—¶ï¼Œå°†è¯¥åˆ†åŒºåˆ†é…ç»™è¿›ç¨‹ï¼Œå¹¶å°†è¯¥åˆ†åŒºçŠ¶æ€æ”¹ä¸ºâ€œå·²å ç”¨â€ã€‚åœ¨ä¸Šé¢çš„æ•°æ®ç»“æ„ä¸­ï¼Œå°±æ˜¯å°†ç›¸åº”åˆ†åŒºçš„stateå­—æ®µç½®1ã€‚ 4. å›ºå®šåˆ†åŒºçš„å›æ”¶ å½“è¿›ç¨‹è¿è¡Œç»“æŸåï¼Œç³»ç»Ÿè¦å›æ”¶è¿›ç¨‹å ç”¨çš„åˆ†åŒºã€‚é€šè¿‡æ‰§è¡Œå†…å­˜å›æ”¶ç¨‹åºå®Œæˆå›æ”¶æ“ä½œï¼Œåªè¦æŠŠå›æ”¶åˆ†åŒºçš„ä½¿ç”¨çŠ¶æ€æ”¹ä¸ºâ€œç©ºé—²â€å³å¯ï¼Œå³æŠŠä¸Šé¢æ•°æ®ç»“æ„ä¸­ç›¸åº”åˆ†åŒºçš„stateå­—æ®µç½®0ã€‚ å›ºå®šåˆ†åŒºåˆ†é…å®ç°ç®€å•ï¼Œä½†æ˜¯ç”±äºæ¯ä¸ªåˆ†åŒºçš„å¤§å°å›ºå®šï¼Œå¿…ç„¶é€ æˆå­˜å‚¨ç©ºé—´çš„æµªè´¹ï¼Œä½¿å†…å­˜åˆ©ç”¨ç‡ä½ä¸‹ã€‚ç°åœ¨çš„å¤šé“ç¨‹åºç³»ç»Ÿå¾ˆå°‘ä½¿ç”¨å›ºå®šåˆ†åŒºåˆ†é…çš„å†…å­˜ç®¡ç†æ–¹å¼ã€‚ä½†æ˜¯ï¼Œåœ¨ä¸€äº›å®æ—¶æ§åˆ¶ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨å›ºå®šåˆ†åŒºåˆ†é…è¿˜æ˜¯ç®€å•è€Œæœ‰æ•ˆçš„ã€‚ ä¸‰ã€åŠ¨æ€åˆ†åŒºåˆ†é… ç”±äºå›ºå®šåˆ†åŒºåˆ†é…å°†å†…å­˜ç©ºé—´åˆ’åˆ†æˆå¤§å°å›ºå®šçš„åˆ†åŒºï¼Œå½“è¿è¡Œéœ€è¦çš„å†…å­˜ç©ºé—´æ¯”åˆ†åŒºå¤§çš„è¿›ç¨‹æ—¶ï¼Œå›ºå®šåˆ†åŒºæ— æ³•æ»¡è¶³è¦æ±‚ã€‚è€Œå½“è¿è¡Œåªéœ€è¦å¾ˆå°ç©ºé—´çš„è¿›ç¨‹æ—¶ï¼Œå†…å­˜ç©ºé—´æµªè´¹å¤§ã€‚ä½¿ç”¨å›ºå®šåˆ†åŒºåˆ†é…å†…å­˜åˆ©ç”¨ç‡ä½ï¼Œéš¾ä»¥æé«˜ç³»ç»Ÿçš„å¤šé“ç¨‹åºåº¦ã€‚åŠ¨æ€åˆ†åŒºåˆ†é…æ˜¯æ ¹æ®è¿›ç¨‹çš„å®é™…éœ€è¦ï¼Œä¸ºè¿›ç¨‹åˆ†é…å¤§å°åˆé€‚çš„å†…å­˜åŒºåŸŸã€‚ç³»ç»Ÿä¸­ç”¨æˆ·åˆ†åŒºçš„æ•°é‡å’Œå¤§å°éƒ½æ˜¯åŠ¨æ€å˜åŒ–çš„ã€‚ æœ¬èŠ‚ä¸»è¦ä»‹ç»ä¸‹åˆ—å†…å®¹ 1) åŠ¨æ€åˆ†åŒºåˆ†é…ä½¿ç”¨çš„æ•°æ®ç»“æ„ã€‚ 2) åŠ¨æ€åˆ†åŒºåˆ†é…ç®—æ³•ã€‚ 3) åŠ¨æ€åˆ†åŒºçš„åˆ†é…å’Œå›æ”¶æ“ä½œã€‚ 1. åŠ¨æ€åˆ†åŒºåˆ†é…åŸç† åŠ¨æ€åˆ†åŒºåˆ†é…ç®—æ³•çš„åŸç†ï¼šç³»ç»Ÿåˆå§‹åªæœ‰ä¸€ä¸ªå¤§ç©ºé—²åŒºï¼Œå½“è¿›ç¨‹è¯·æ±‚ç©ºé—´æ—¶ï¼Œç”±ç³»ç»Ÿæ ¹æ®è¿›ç¨‹éœ€è¦çš„ç©ºé—´å¤§å°åˆ’åˆ†å‡ºä¸€ç‰‡ç©ºé—²åŒºåˆ†é…ç»™è¿›ç¨‹ã€‚ç³»ç»Ÿè¿è¡Œä¸€æ®µæ—¶é—´åï¼Œå†…å­˜çš„ç©ºé—²åŒº å¯èƒ½æ•£å¸ƒåœ¨ä¸è¿ç»­çš„åŒºåŸŸã€‚ç³»ç»Ÿç»´æŠ¤ä¸€ä¸ªè®°å½•å½“å‰ç©ºé—²åˆ†åŒºæƒ…å†µçš„æ•°æ®ç»“æ„ï¼Œå½“è¿›ç¨‹è¯·æ±‚å†… å­˜æ—¶ï¼Œç³»ç»Ÿä»æ‰€æœ‰ç©ºé—²åŒºä¸­æ‰¾åˆ°å¤§å°åˆé€‚çš„ç©ºé—²åˆ†åŒºè¿›è¡Œåˆ†é…ã€‚ç³»ç»Ÿä¸­åˆ†åŒºçš„å¤§å°å’Œæ•°é‡éƒ½ æ˜¯å˜åŒ–çš„ï¼Œç©ºé—²åŒºçš„å¤§å°å’Œæ•°é‡ä¹Ÿæ˜¯å˜åŒ–çš„ã€‚ 2. åŠ¨æ€åˆ†åŒºåˆ†é…ä¸­çš„æ•°æ®ç»“æ„ ä¸ºå®ç°åŠ¨æ€åˆ†åŒºåˆ†é…ï¼Œç³»ç»Ÿéœ€è¦å»ºç«‹å¹¶ç»´æŠ¤è®°å½•ç©ºé—²åˆ†åŒºæƒ…å†µçš„æ•°æ®ç»“æ„ã€‚å¸¸ç”¨çš„æ•°æ® ç»“æ„æœ‰ç©ºé—²åˆ†åŒºè¡¨å’Œç©ºé—²åˆ†åŒºé“¾ã€‚ (1) ç©ºé—²åˆ†åŒºè¡¨ å¦‚è¡¨4-2æ‰€ç¤ºï¼Œç³»ç»Ÿåœ¨ç©ºé—²åˆ†åŒºè¡¨ä¸­ä¸ºæ¯ä¸€ä¸ªç©ºé—²åˆ†åŒºå»ºç«‹ä¸€ä¸ªè¡¨é¡¹ï¼Œæ¯ä¸ªè¡¨é¡¹ä¸­åŒ…æ‹¬åˆ†åŒºç¼–å·ã€åˆ†åŒºå¤§å°å’Œåˆ†åŒºèµ·å§‹åœ°å€ã€‚åœ¨å…·ä½“ç¨‹åºå®ç°æ—¶ï¼Œå¯ä»¥ç”¨ç»“æ„æ•°ç»„æ¥å®ç°ç©ºé—²åˆ†åŒºè¡¨ã€‚æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ å¯¹åº”ä¸€ä¸ªè¡¨é¡¹ï¼Œè®°å½•ä¸€ä¸ªç©ºé—²åˆ†åŒºçš„æƒ…å†µã€‚æ¯ä¸ªè¡¨é¡¹åŒ…å«3ä¸ªå­—æ®µï¼Œå³åˆ†åŒºç¼–å·ã€åˆ†åŒºå¤§å°å’Œåˆ†åŒºèµ·å§‹åœ°å€ã€‚ä½¿ç”¨ç©ºé—²åˆ†åŒºè¡¨çš„ç¼ºç‚¹æ˜¯ï¼Œè‹¥è®¾ç½®å¤ªå¤šè¡¨é¡¹ï¼Œä¼šæµªè´¹å†…å­˜ç©ºé—´ï¼›è®¾ç½®å¤ªå°‘çš„è¡¨é¡¹ï¼Œå½“ç©ºé—²åˆ†åŒºè¾ƒå¤šæ—¶ï¼Œæ— æ³•è®°å½•æ‰€æœ‰ç©ºé—²åˆ†åŒºçš„æƒ…å†µã€‚åœ¨å®ç°æ—¶ï¼Œç»“æ„æ•°ç»„çš„å¤§å°ä¸å®¹æ˜“ç¡®å®šã€‚ åœ¨ç¨‹åºä¸­å¯ä»¥ç”¨ä¸‹åˆ—ç»“æ„æ•°ç»„è¡¨ç¤ºç©ºé—²åˆ†åŒºè¡¨ã€‚ struct { int num;//åˆ†åŒºç¼–å· int length;//åˆ†åŒºå¤§å° int addr;//åˆ†åŒºèµ·å§‹åœ°å€ } FreeMem_block[N] æ•°ç»„å¤§å°æ ¹æ®ç³»ç»Ÿç®¡ç†çš„æœ€å¤§åˆ†åŒºæ•°ç¡®å®šã€‚ (2) ç©ºé—²åˆ†åŒºé“¾ ä½¿ç”¨ç©ºé—²åˆ†åŒºé“¾å¯ä»¥åŠ¨æ€åœ°ä¸ºæ¯ä¸€ä¸ªç©ºé—²åˆ†åŒºå»ºç«‹ä¸€ä¸ªç»“ç‚¹ï¼Œæ¯ä¸ªç»“ç‚¹åŒ…æ‹¬åˆ†åŒºå¤§å°ã€åˆ†åŒºèµ·å§‹åœ°å€ã€æŒ‡å‘å‰ä¸€ä¸ªç©ºé—²åˆ†åŒºç»“ç‚¹çš„æŒ‡é’ˆï¼Œä»¥åŠæŒ‡å‘åä¸€ä¸ªç©ºé—²åˆ†åŒºç»“ç‚¹çš„æŒ‡é’ˆã€‚ç©ºé—²åˆ†åŒºé“¾ä¸­çš„æ¯ä¸ªç»“ç‚¹å ç”¨çš„å†…å­˜å¯ä»¥åŠ¨æ€åˆ†é…ã€åŠ¨æ€å›æ”¶ã€‚ä½¿ç”¨ç©ºé—²åˆ†åŒºé“¾å¯ä»¥å…‹æœç©ºé—²åˆ†åŒºè¡¨å­˜åœ¨çš„ç¼ºç‚¹ã€‚ ç©ºé—²åˆ†åŒºé“¾æ•°æ®ç»“æ„å¦‚å›¾4-7æ‰€ç¤ºã€‚å›¾ä¸­æœ‰5ä¸ªåˆ†åŒºï¼Œå…¶ä¸­æœ‰3ä¸ªåˆ†åŒºæ˜¯å·²å ç”¨åˆ†åŒºã€‚ä¸¤ä¸ªå¤§å°åˆ†åˆ«ä¸º10KBå’Œ20KBçš„åˆ†åŒºæ˜¯ç©ºé—²åˆ†åŒºï¼Œå…¶èµ·å§‹åœ°å€åˆ†åˆ«ä¸º100KBå’Œ130KBã€‚ç³»ç»Ÿå»ºç«‹çš„ç©ºé—²é“¾è¡¨å¦‚å›¾4-7æ‰€ç¤ºï¼ŒåŒ…æ‹¬ä¸¤ä¸ªä¸ç©ºé—²åˆ†åŒºå¯¹åº”çš„ç»“ç‚¹ã€‚æ¯ä¸ªç»“ç‚¹ä¸­åŒ…å«äº†ç©ºé—²åˆ†åŒºçš„å¤§å°ã€ç©ºé—²åˆ†åŒºçš„èµ·å§‹åœ°å€å’ŒæŒ‡å‘å‰ä¸€ä¸ªç©ºé—²åˆ†åŒºç»“ç‚¹çš„æŒ‡é’ˆã€æŒ‡å‘åä¸€ä¸ªç©ºé—²åˆ†åŒºç»“ç‚¹çš„æŒ‡é’ˆã€‚åœ¨å®é™…ç³»ç»Ÿä¸­ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨æ›´å¤æ‚çš„åŒå‘é“¾è¡¨æˆ–è€…åŒå‘å¾ªç¯é“¾è¡¨ã€‚ ä½¿ç”¨åŒå‘ç©ºé—²é“¾è¡¨çš„æ•°æ®ç»“æ„å¦‚ä¸‹æ‰€ç¤ºã€‚ Struct FreeMem { int length;//ç©ºé—²åˆ†åŒºå¤§å° int addr;//ç©ºé—²åˆ†åŒºèµ·å§‹åœ°å€ TFreeMem*prcv,*next;//æŒ‡å‘å‰ä¸€ä¸ªç»“ç‚¹çš„æŒ‡é’ˆå’ŒæŒ‡å‘åä¸€ä¸ªç»“ç‚¹çš„æŒ‡é’ˆ } 3. åŠ¨æ€åˆ†åŒºåˆ†é…ç®—æ³• å½“è¿›ç¨‹éœ€è¦å†…å­˜ç©ºé—´æ—¶ï¼Œæ“ä½œç³»ç»Ÿé€šè¿‡æ‰§è¡ŒåŠ¨æ€åˆ†åŒºåˆ†é…ç®—æ³•ä»å¤šä¸ªç©ºé—²åˆ†åŒºä¸­é€‰å®šä¸€ä¸ªåˆé€‚çš„åˆ†åŒºåˆ†é…ç»™è¿›ç¨‹ã€‚ä¸åŒçš„åˆ†åŒºåˆ†é…ç®—æ³•æœ‰ä¸åŒçš„ç‰¹ç‚¹ï¼Œéœ€è¦ä¸åŒæ•°æ®ç»“æ„çš„æ”¯æŒã€‚ ä¸‹é¢ä»‹ç»3ç§åŠ¨æ€åˆ†åŒºåˆ†é…ç®—æ³•ï¼Œå³é¦–æ¬¡é€‚åº”ç®—æ³•ã€å¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•å’Œæœ€ä½³é€‚åº”ç®—æ³•ã€‚ (1)é¦–æ¬¡é€‚åº”ç®—æ³•FF(First Fit,FF) åœ¨é‡‡ç”¨ç©ºé—²åˆ†åŒºé“¾ä½œä¸ºæ•°æ®ç»“æ„æ—¶ï¼Œé¦–æ¬¡é€‚åº”ç®—æ³•è¦æ±‚ç©ºé—²åˆ†åŒºé“¾ä»¥åœ°å€é€’å¢çš„é¡ºåºé“¾æ¥ã€‚åœ¨è¿›è¡Œå†…å­˜åˆ†é…æ—¶ï¼Œä»é“¾é¦–å¼€å§‹é¡ºåºæŸ¥æ‰¾ï¼Œç›´è‡³æ‰¾åˆ°ä¸€ä¸ªèƒ½æ»¡è¶³è¿›ç¨‹å¤§å°è¦æ±‚çš„ç©ºé—²åˆ†åŒºä¸ºæ­¢ã€‚ç„¶åï¼Œå†æŒ‰ç…§è¿›ç¨‹è¯·æ±‚å†…å­˜çš„å¤§å°ï¼Œä»è¯¥åˆ†åŒºä¸­åˆ’å‡ºä¸€å—å†…å­˜ç©ºé—´åˆ†é…ç»™è¯·æ±‚è€…ï¼Œä½™ä¸‹çš„ç©ºé—²åˆ†åŒºä»ç•™åœ¨ç©ºé—²é“¾ä¸­ã€‚ è¯¥ç®—æ³•æ€»æ˜¯å…ˆåˆ†é…ä½åœ°å€éƒ¨åˆ†çš„å†…å­˜ç©ºé—´ï¼Œå®¹æ˜“ä½¿ä½åœ°å€éƒ¨åˆ†ç•™ä¸‹å°åˆ†åŒºï¼Œè€Œé«˜åœ°å€éƒ¨åˆ†å¤§ç©ºé—²åŒºè¾ƒå¤šã€‚å½“è¿›ç¨‹è¯·æ±‚å¤§å†…å­˜ç©ºé—´æ—¶ï¼Œè¦æ‰¾åˆ°åˆé€‚çš„ç©ºé—²åˆ†åŒºï¼Œæœç´¢ç©ºé—²åˆ†åŒºé“¾éœ€è¦çš„æ—¶é—´å¼€é”€æ¯”è¾ƒå¤§ã€‚ æ­¤å¤–ï¼Œç”±äºä½åœ°å€éƒ¨åˆ†çš„ç©ºé—²åˆ†åŒºåå¤è¢«åˆ’åˆ†ï¼Œå¯èƒ½ç•™ä¸‹è®¸å¤šéš¾ä»¥åˆ©ç”¨çš„å¾ˆå°çš„ç©ºé—²åˆ†åŒºï¼Œè¿™ç§éš¾ä»¥è¢«åˆ©ç”¨çš„å°ç©ºé—²åŒºä¹Ÿè¢«ç§°ä¸ºå¤–éƒ¨ç¢ç‰‡æˆ–å¤–ç¢ç‰‡ã€‚åˆ†é…ç»™è¿›ç¨‹çš„åˆ†åŒºè‹¥å¤§äºè¿›ç¨‹è¯·æ±‚çš„åˆ†åŒºï¼Œåˆ†åŒºå†…ä¼šå­˜åœ¨ä¸€éƒ¨åˆ†ä¸è¢«åˆ©ç”¨çš„ç©ºé—´ï¼Œè¿™éƒ¨åˆ†è¢«æµªè´¹çš„ç©ºé—´ç§°ä¸ºå†…éƒ¨ç¢ç‰‡æˆ–å†…ç¢ç‰‡ã€‚ (2) å¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•NF(Next Fit,NF) è¯¥ç®—æ³•æ˜¯ç”±é¦–æ¬¡é€‚åº”ç®—æ³•æ¼”å˜è€Œå½¢æˆçš„ã€‚åœ¨ä¸ºè¿›ç¨‹åˆ†é…å†…å­˜ç©ºé—´æ—¶ï¼Œä¸å†æ¯æ¬¡ä»é“¾é¦–å¼€å§‹æŸ¥æ‰¾åˆé€‚çš„ç©ºé—²åˆ†åŒºï¼Œè€Œæ˜¯ä»ä¸Šæ¬¡æ‰¾åˆ°çš„ç©ºé—²åˆ†åŒºçš„ä¸‹ä¸€ä¸ªç©ºé—²åˆ†åŒºå¼€å§‹æŸ¥æ‰¾ï¼Œç›´è‡³æ‰¾åˆ°ç¬¬ä¸€ä¸ªèƒ½æ»¡è¶³è¦æ±‚çš„ç©ºé—²åˆ†åŒºï¼Œå¹¶ä»ä¸­åˆ’å‡ºä¸€å—ä¸è¯·æ±‚çš„å¤§å°ç›¸ç­‰çš„å†…å­˜ç©ºé—´åˆ†é…ç»™è¿›ç¨‹ã€‚ä¸ºå®ç°è¯¥ç®—æ³•ï¼Œåº”è®¾ç½®ä¸€ä¸ªèµ·å§‹æŸ¥æ‰¾æŒ‡é’ˆï¼Œä»¥æŒ‡ç¤ºä¸‹ä¸€æ¬¡èµ·å§‹æŸ¥æ‰¾çš„ç©ºé—²åˆ†åŒºï¼Œå¹¶é‡‡ç”¨å¾ªç¯æŸ¥æ‰¾æ–¹å¼ï¼Œå¦‚å›¾4-8æ‰€ç¤ºã€‚ å¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•çš„ä¼˜ç‚¹æ˜¯ï¼šç©ºé—²åŒºåˆ†å¸ƒå‡åŒ€ã€æŸ¥æ‰¾å¼€é”€è¾ƒå°ï¼Œç¼ºç‚¹æ˜¯å®¹æ˜“ä½¿ç³»ç»Ÿç¼ºä¹å¤§ç©ºé—²åŒºã€‚ (3) æœ€ä½³é€‚åº”ç®—æ³•BF(Best Fit,BF) è¯¥ç®—æ³•æ¯æ¬¡ä¸ºä½œä¸šåˆ†é…å†…å­˜ï¼Œæ€»æ˜¯æŠŠå¤§å°ä¸è¿›ç¨‹æ‰€è¯·æ±‚çš„å†…å­˜ç©ºé—´å¤§å°æœ€æ¥è¿‘çš„ç©ºé—²åˆ†åŒºåˆ†é…ç»™è¿›ç¨‹ï¼Œé¿å…äº†â€œå¤§æå°ç”¨â€ã€‚ä¸ºäº†åŠ é€Ÿå¯»æ‰¾ï¼Œè¯¥ç®—æ³•è¦æ±‚å°†æ‰€æœ‰çš„ç©ºé—²åŒºæŒ‰åˆ†åŒºå¤§å°é€’å¢çš„é¡ºåºå½¢æˆä¸€ä¸ªç©ºé—²åŒºé“¾ã€‚è¿™æ ·ï¼Œç¬¬ä¸€æ¬¡æ‰¾åˆ°çš„æ»¡è¶³è¦æ±‚çš„ç©ºé—²åŒºå¿…ç„¶æ˜¯å¤§å°æœ€æ¥è¿‘è¿›ç¨‹éœ€è¦çš„å†…å­˜ç©ºé—´å¤§å°çš„ã€‚ æœ€ä½³é€‚åº”ç®—æ³•çš„ä¼˜ç‚¹æ˜¯é¿å…äº†å¤§æå°ç”¨ï¼Œèƒ½æé«˜å†…å­˜åˆ©ç”¨ç‡ã€‚ä½†æ˜¯ï¼Œé‡‡ç”¨æœ€ä½³é€‚åº”ç®—æ³•å®¹æ˜“ç•™ä¸‹éš¾ä»¥åˆ©ç”¨çš„å°ç©ºé—²åŒºã€‚ ä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹é¢˜æ¥è¯´æ˜é¦–æ¬¡é€‚åº”ç®—æ³•ã€å¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•å’Œæœ€ä½³é€‚åº”ç®—æ³•ã€‚ ä¾‹4-1ï¼šå½“å‰ç©ºé—²é“¾å¦‚å›¾4-9æ‰€ç¤ºã€‚ ç©ºé—²é“¾å›¾ç¤ºçš„å«ä¹‰å¦‚ä¸‹ã€‚ å‡è®¾ç³»ç»Ÿä¸­ç°æœ‰3ä¸ªç©ºé—²åˆ†åŒºï¼Œç¬¬ä¸€ä¸ªç©ºé—²åˆ†åŒºèµ·å§‹åœ°å€ä¸º20KB,å¤§å°ä¸º120KBï¼›ç¬¬äºŒä¸ªç©ºé—²åˆ†åŒºèµ·å§‹åœ°å€ä¸º200KB,å¤§å°ä¸º100KBï¼›ç¬¬ä¸‰ä¸ªç©ºé—²åˆ†åŒºèµ·å§‹åœ°å€ä¸º400KB,å¤§å°ä¸º60KBã€‚è‹¥æŸè¿›ç¨‹p1å…ˆè¯·æ±‚å¤§å°ä¸º30KBçš„å†…å­˜ç©ºé—´ï¼Œéšåè¿›ç¨‹p2å†è¯·æ±‚å¤§å°ä¸º20KBçš„å†…å­˜ç©ºé—´ã€‚ç”»å‡ºåˆ†åˆ«é‡‡ç”¨é¦–æ¬¡é€‚åº”ç®—æ³•ã€å¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•å’Œæœ€ä½³é€‚åº”ç®—æ³•æ—¶ï¼Œä¸ºè¿›ç¨‹p1åˆ†é…å®Œç©ºé—´ä¹‹åç³»ç»Ÿçš„ç©ºé—²é“¾å’Œåœ¨æ­¤ä¹‹åä¸ºè¿›ç¨‹p2åˆ†é…å®Œç©ºé—´åçš„ç©ºé—²é“¾ï¼ˆå½“ç©ºé—²åˆ†åŒºå¤§å°m.size-è¿›ç¨‹è¯·æ±‚ç©ºé—´çš„å¤§å°u.size>1KBæ—¶ï¼Œä»ç©ºé—²åˆ†åŒºä¸­ä¸ºè¿›ç¨‹åˆ†é…u.sizeå¤§å°çš„ç©ºé—´ï¼Œå°†m.size-u.sizeå¤§å°çš„ç©ºé—²ç©ºé—´ä½œä¸ºæ–°çš„ç©ºé—²åŒºä½¿ç”¨)ã€‚ è§£ç­”ï¼š 1) è‹¥ç³»ç»Ÿé‡‡ç”¨é¦–æ¬¡é€‚åº”ç®—æ³•ï¼Œç©ºé—²åŒºåº”è¯¥æŒ‰åœ°å€é€’å¢é¡ºåºæ’åˆ—ï¼Œç©ºé—²åŒºé“¾å¦‚é¢˜æ‰€ç¤ºã€‚æŒ‰ç…§é¦–æ¬¡é€‚åº”ç®—æ³•ï¼Œä»ç¬¬ä¸€ä¸ªå¤§å°åˆé€‚çš„ç©ºé—²åŒºä¸­åˆ’åˆ†ä¸€å—ç»™è¿›ç¨‹p1,ä»èµ·å§‹åœ°å€ä¸º20KBã€å¤§å°ä¸º120KBçš„ç©ºé—²åŒºä¸­åˆ’åˆ†30KBç©ºé—´åˆ†é…ç»™è¿›ç¨‹p1ã€‚ä¸ºè¿›ç¨‹p1åˆ†é…å®Œç©ºé—´ä¹‹åï¼Œç©ºé—²é“¾å˜ä¸ºå¦‚å›¾4-10æ‰€ç¤ºã€‚ ä»è¿™ä¸ªé“¾è¡¨ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä¸ºè¿›ç¨‹p1åˆ†é…30KBç©ºé—´åï¼Œç¬¬ä¸€ä¸ªèµ·å§‹åœ°å€ä¸º20KBã€å¤§å°ä¸º120KBçš„åˆ†åŒºå› ç»™è¿›ç¨‹p1åˆ’åˆ†äº†30KBç©ºé—´ï¼Œå˜ä¸ºèµ·å§‹åœ°å€ä¸º50KBï¼Œå¤§å°ä¸º90KBçš„ç©ºé—²åˆ†åŒºã€‚è‹¥åœ¨æ­¤åï¼Œè¿›ç¨‹p2ç”³è¯·20KBç©ºé—´ï¼Œåˆ™ç©ºé—²åˆ†åŒºé“¾ä¸­çš„ç¬¬ä¸€ä¸ªåˆ†åŒºå¤§å°ä¹Ÿæ»¡è¶³p2çš„éœ€è¦ï¼Œä»èµ·å§‹åœ°å€ä¸º50KBã€å¤§å°ä¸º90KBçš„ç©ºé—²åˆ†åŒºä¸­å†åˆ’åˆ†20KBç©ºé—´åˆ†é…ç»™p2åï¼Œç³»ç»Ÿç©ºé—²åŒºé“¾å˜ä¸ºå¦‚å›¾4-11æ‰€ç¤ºã€‚ 2) è‹¥é‡‡ç”¨å¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•ã€‚ç³»ç»Ÿç»´æŠ¤çš„ç©ºé—²åŒºé“¾è¡¨ä¸­è¦å¢åŠ ä¸€ä¸ªå¾ªç¯æŒ‡é’ˆï¼Œæ¯æ¬¡ä¸ºè¿›ç¨‹åˆ†é…å†…å­˜éƒ½ä»å¾ªç¯æŒ‡é’ˆæŒ‡å‘çš„ç»“ç‚¹å¯¹åº”çš„ç©ºé—²åˆ†åŒºå¼€å§‹ã€‚ åˆå§‹ç©ºé—²åŒºé“¾è¡¨ä¸ºå¦‚å›¾4-12æ‰€ç¤ºã€‚ è¿›ç¨‹p1ç”³è¯·30KBç©ºé—´åï¼Œå¾ªç¯æŒ‡é’ˆç§»åˆ°ä¸‹ä¸€ä¸ªç»“ç‚¹ï¼Œä¸‹ä¸€æ¬¡åˆ†é…ç©ºé—²åŒºæ—¶ï¼Œä»å¾ªç¯æŒ‡é’ˆæŒ‡å‘çš„ç»“ç‚¹å¼€å§‹æœç´¢é€‚åˆè¿›ç¨‹è¯·æ±‚çš„ç©ºé—²åˆ†åŒºã€‚ç³»ç»Ÿä¸ºè¿›ç¨‹p1åˆ†é…30KBç©ºé—´åï¼Œç³»ç»Ÿç©ºé—²åˆ†åŒºé“¾è¡¨å˜ä¸ºå¦‚å›¾4-13æ‰€ç¤ºã€‚ æ­¤åï¼Œp2å†ç”³è¯·20KBç©ºé—´ï¼Œç”±äºå¾ªç¯æŒ‡é’ˆæŒ‡å‘èµ·å§‹åœ°å€ä¸º200KBã€å¤§å°ä¸º100KBçš„åˆ†åŒºå¯¹åº”çš„ç»“ç‚¹ï¼Œå› æ­¤ç³»ç»Ÿä»è¯¥ç»“ç‚¹å¼€å§‹æœç´¢å¤§å°å¤§äºæˆ–ç­‰äº20KBçš„ç©ºé—²åˆ†åŒºï¼Œä»ä¸­åˆ’åˆ†å‡º20KBç©ºé—´ç»™è¿›ç¨‹p2ï¼Œä¸ºè¿›ç¨‹p2åˆ†é…20KBç©ºé—´åï¼Œå¾ªç¯æŒ‡é’ˆåç§»ï¼Œç³»ç»Ÿç©ºé—²åˆ†åŒºé“¾å˜ä¸ºå¦‚å›¾4-14æ‰€ç¤ºã€‚ 3) è‹¥é‡‡ç”¨æœ€ä½³é€‚åº”ç®—æ³•ã€‚ç³»ç»Ÿç»´æŠ¤çš„ç©ºé—²åŒºé“¾è¡¨ä¸­çš„ç»“ç‚¹è¦æŒ‰ç…§ç©ºé—²åŒºçš„å¤§å°ç”±å°åˆ°å¤§æ’åºï¼Œå› æ­¤åœ¨è¿›ç¨‹p1ã€p2ç”³è¯·å†…å­˜ç©ºé—´ä¹‹å‰ï¼Œç©ºé—²åŒºé“¾å¦‚å›¾4-15æ‰€ç¤ºã€‚ è¿›ç¨‹p1ç”³è¯·30KBç©ºé—´åï¼Œç©ºé—²é“¾å˜ä¸ºå¦‚å›¾4-16æ‰€ç¤ºã€‚ è¯¥é“¾è¡¨åœ¨æ¯ä¸€æ¬¡åˆ†é…ç©ºé—´åéƒ½è¦é‡æ–°æ’åºï¼Œä»¥ä¿è¯ç©ºé—²åˆ†åŒºé“¾æ˜¯æŒ‰åˆ†åŒºå¤§å°é€’å¢çš„é¡ºåºæ’åºçš„ã€‚ æ­¤åï¼Œç³»ç»Ÿå†ä¸ºp2åˆ†é…20KBç©ºé—´åï¼Œç³»ç»Ÿç©ºé—²åˆ†åŒºé“¾è¡¨å˜ä¸ºå¦‚å›¾4-17æ‰€ç¤ºã€‚ ä¸ºäº†æ›´å¥½åœ°è¯´æ˜é—®é¢˜ï¼Œå‡è®¾è¿›ç¨‹p1ç”³è¯·30KBç©ºé—´åï¼Œp2ç”³è¯·å¤§å°ä¸º110KBçš„ç©ºé—´ï¼Œåœ¨å›¾4-16æ‰€ç¤ºçš„é“¾è¡¨ä¸­æŸ¥æ‰¾å¤§å°åˆé€‚çš„ç©ºé—²åŒºï¼Œåªæœ‰èµ·å§‹åœ°å€ä¸º20KBã€å¤§å°ä¸º120KBçš„åˆ†åŒºèƒ½æ»¡è¶³è¿›ç¨‹p2çš„è¯·æ±‚ã€‚ç³»ç»Ÿä»è¯¥åˆ†åŒºä¸­åˆ’åˆ†110KBçš„ç©ºé—´ç»™è¿›ç¨‹p2ï¼Œä¹‹åè¯¥åˆ†åŒºå‰©ä½™10KBçš„å°åˆ†åŒºä½œä¸ºæ–°çš„ç©ºé—²åˆ†åŒºã€‚ç©ºé—²åˆ†åŒºé“¾å˜ä¸ºå¦‚å›¾4-18æ‰€ç¤ºã€‚ å¯¹ç©ºé—²åˆ†åŒºé“¾é‡æ–°æ’åºï¼Œå¾—åˆ°çš„ç©ºé—²åˆ†åŒºé“¾å¦‚å›¾4-19æ‰€ç¤ºã€‚ 4. åŠ¨æ€åˆ†åŒºåˆ†é…çš„æµç¨‹ é‡‡å–åŠ¨æ€åˆ†åŒºåˆ†é…çš„å†…å­˜ç®¡ç†æ–¹å¼ï¼Œå†…å­˜åˆ†é…åŠŸèƒ½ç”±å†…å­˜åˆ†é…ç¨‹åºå®Œæˆï¼Œå†…å­˜åˆ†é…ç¨‹åºé‡‡ç”¨æŸç§å†…å­˜åˆ†é…ç®—æ³•ä¸ºè¿›ç¨‹åˆ†é…å†…å­˜ã€‚å†…å­˜ä¸å†è¢«åº”ç”¨ç¨‹åºéœ€è¦æ—¶ï¼Œç”±ç³»ç»Ÿè°ƒç”¨å†…å­˜å›æ”¶ç¨‹åºå›æ”¶åŸæ¥è¢«å ç”¨çš„å†…å­˜åˆ†åŒºã€‚ä¸‹é¢è¯´æ˜é‡‡ç”¨åŠ¨æ€åˆ†åŒºåˆ†é…æ—¶å†…å­˜åˆ†é…çš„æµç¨‹å’Œå†…å­˜å›æ”¶çš„æµç¨‹ã€‚ (1) å†…å­˜åˆ†é…æµç¨‹ å¦‚æœè¿›ç¨‹ç”³è¯·çš„å†…å­˜ç©ºé—´å¤§å°ä¸ºu.sizeï¼Œå½“å‰ç»“ç‚¹å¯¹åº”çš„ç©ºé—²åˆ†åŒºå¤§å°ä¸ºm.sizeï¼Œsizeæ˜¯ç³»ç»Ÿè§„ å®šçš„ä¸€ä¸ªé˜ˆå€¼ã€‚å½“ç³»ç»Ÿæ¥æ”¶åˆ°ç”³è¯·å†…å­˜çš„è¯·æ±‚åï¼ŒæŒ‰ç…§å¦‚å›¾4-20æ‰€ç¤ºçš„æµç¨‹åˆ†é…ç©ºé—²åˆ†åŒºã€‚ 1) æ£€ç´¢ç©ºé—²åˆ†åŒºé“¾ã€‚æ‰¾åˆ°æ»¡è¶³æ¡ä»¶m.sizeâ‰¥u.sizeçš„ç©ºé—²åŒº(å¯ä»¥é‡‡ç”¨é¦–æ¬¡é€‚åº”ç®—æ³•ã€å¾ªç¯é¦–æ¬¡é€‚åº”ç®—æ³•æˆ–æœ€ä½³é€‚åº”ç®—æ³•)ã€‚ 2) å¦‚æœm.size-u.sizeâ‰¤sizeï¼Œåˆ™ç›´æ¥æŠŠè¯¥ç©ºé—²åˆ†åŒºåˆ†é…ç»™è¿›ç¨‹ã€‚å¦åˆ™ï¼Œä»m.sizeä¸­åˆ’å‡ºå¤§å°ä¸ºuï¼Œsizeçš„ç©ºé—´åˆ†é…ç»™è¿›ç¨‹ï¼ŒæŠŠå‰©ä½™çš„å¤§å°ä¸ºm.size-u.sizeçš„ç©ºé—²ç©ºé—´ä½œä¸ºæ–°çš„ç©ºé—²åˆ†åŒºã€‚ 3) å°†åˆ†é…ç»™è¿›ç¨‹çš„åˆ†åŒºèµ·å§‹åœ°å€è¿”å›ç»™å†…å­˜åˆ†é…ç¨‹åºçš„è°ƒç”¨è€… 4) ä¿®æ”¹ç©ºé—²åˆ†åŒºé“¾è¡¨ã€‚ (2) å†…å­˜å›æ”¶æµç¨‹ å†…å­˜å›æ”¶çš„ä»»åŠ¡æ˜¯é‡Šæ”¾è¢«å ç”¨çš„å†…å­˜åŒºåŸŸï¼Œå¦‚æœè¢«é‡Šæ”¾çš„å†…å­˜ç©ºé—´ä¸å…¶ä»–ç©ºé—²åˆ†åŒºåœ¨åœ°å€ä¸Šç›¸é‚»æ¥ï¼Œè¿˜éœ€è¦è¿›è¡Œç©ºé—´åˆå¹¶ã€‚ ä¸‹é¢ä»¥é‡‡ç”¨åŠ¨æ€åˆ†åŒºé“¾ç®¡ç†ç©ºé—²åˆ†åŒºçš„æƒ…å†µä¸ºä¾‹ï¼Œè¯´æ˜å†…å­˜å›æ”¶çš„æµç¨‹ã€‚ 1) é‡Šæ”¾ä¸€å—è¿ç»­çš„å†…å­˜åŒºåŸŸã€‚ 2) å¦‚æœè¢«é‡Šæ”¾åŒºåŸŸä¸å…¶ä»–ç©ºé—²åŒºé—´ç›¸é‚»ï¼Œåˆ™åˆå¹¶ç©ºé—²åŒºã€‚ 3) ä¿®æ”¹ç©ºé—²åˆ†åŒºé“¾ã€‚ å¦‚æœè¢«é‡Šæ”¾çš„å†…å­˜åŒºåŸŸï¼ˆå›æ”¶åŒºï¼‰ä¸å…¶ä»–ä»»ä½•çš„ç©ºé—²åŒºéƒ½ä¸ç›¸é‚»ï¼Œåˆ™ä¸ºè¯¥å›æ”¶åŒºå»ºç«‹ä¸€ä¸ªç©ºé—²åŒºé“¾çš„ç»“ç‚¹ã€‚ä½¿æ–°å»ºç»“ç‚¹çš„èµ·å§‹åœ°å€å­—æ®µç­‰äºå›æ”¶åŒºèµ·å§‹åœ°å€ï¼Œç©ºé—²åˆ†åŒºå¤§å°å­—æ®µç­‰äºå›æ”¶åŒºå¤§å°ã€‚æ ¹æ®å†…å­˜åˆ†é…ç¨‹åºä½¿ç”¨çš„ç®—æ³•è¦æ±‚ï¼ˆæŒ‰åœ°å€é€’å¢é¡ºåºæˆ–æŒ‰ç©ºé—²åˆ†åŒºå¤§å°ç”±å°åˆ°å¤§æ’åº)ï¼ŒæŠŠæ–°å»ºç»“ç‚¹æ’å…¥ç©ºé—²åˆ†åŒºé“¾çš„é€‚å½“ä½ç½®ã€‚ å¦‚æœè¢«é‡Šæ”¾åŒºåŸŸä¸å…¶ä»–ç©ºé—²åŒºé—´ç›¸é‚»ï¼Œéœ€è¦è¿›è¡Œç©ºé—´åˆå¹¶ï¼Œåœ¨è¿›è¡Œç©ºé—´åˆå¹¶æ—¶éœ€è¦è€ƒè™‘ ä»¥ä¸‹3ç§æƒ…å†µã€‚ 1) ä»…å›æ”¶åŒºçš„å‰é¢æœ‰ç›¸é‚»çš„ç©ºé—²åˆ†åŒºï¼Œå¦‚å›¾4-21aæ‰€ç¤ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŠŠå›æ”¶åŒºä¸ ç©ºé—²åˆ†åŒºR1åˆå¹¶æˆä¸€ä¸ªç©ºé—²åˆ†åŒºï¼ŒæŠŠç©ºé—²é“¾ä¸­ä¸R1å¯¹åº”çš„ç»“ç‚¹çš„åˆ†åŒºèµ·å§‹åœ°å€ä½œä¸ºæ–°ç©º é—²åŒºçš„èµ·å§‹åœ°å€ï¼Œå°†è¯¥ç»“ç‚¹çš„åˆ†åŒºå¤§å°å­—æ®µä¿®æ”¹ä¸ºç©ºé—²åˆ†åŒºR1ä¸å›æ”¶åŒºå¤§å°ä¹‹å’Œã€‚ 2) ä»…å›æ”¶åŒºçš„åé¢æœ‰ç›¸é‚»çš„ç©ºé—²åˆ†åŒºï¼Œå¦‚å›¾4-21bæ‰€ç¤ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŠŠå›æ”¶åŒºä¸ç©ºé—²åˆ†åŒºR2åˆå¹¶æˆä¸€ä¸ªç©ºé—²åˆ†åŒºã€‚æŠŠç©ºé—²é“¾ä¸­ä¸R2å¯¹åº”çš„ç»“ç‚¹çš„åˆ†åŒºèµ·å§‹åœ°å€æ”¹ä¸ºå›æ”¶åŒºèµ·å§‹åœ°å€ï¼Œå°†è¯¥ç»“ç‚¹çš„åˆ†åŒºå¤§å°å­—æ®µä¿®æ”¹ä¸ºç©ºé—²åˆ†åŒºR2ä¸å›æ”¶åŒºå¤§å°ä¹‹å’Œã€‚ 3) å›æ”¶åŒºçš„å‰ã€åéƒ½æœ‰ç›¸é‚»çš„ç©ºé—²åˆ†åŒºï¼Œå¦‚å›¾4-21cæ‰€ç¤ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŠŠå›æ”¶åŒºä¸ç©ºé—²åˆ†åŒºR1ã€R2åˆå¹¶æˆä¸€ä¸ªç©ºé—²åˆ†åŒºã€‚æŠŠç©ºé—²é“¾ä¸­ä¸R1å¯¹åº”çš„ç»“ç‚¹çš„åˆ†åŒºèµ·å§‹åœ°å€ä½œä¸ºåˆå¹¶åæ–°ç©ºé—²åˆ†åŒºçš„èµ·å§‹åœ°å€ï¼Œå°†è¯¥ç»“ç‚¹çš„åˆ†åŒºå¤§å°å­—æ®µä¿®æ”¹ä¸ºç©ºé—²åˆ†åŒºR1ã€R2ä¸å›æ”¶åŒºä¸‰è€…å¤§å°ä¹‹å’Œï¼Œåˆ å»ä¸R2åˆ†åŒºå¯¹åº”çš„ç©ºé—²åˆ†åŒºç»“ç‚¹ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹åˆ†åŒºR2å¯¹åº”çš„ç»“ç‚¹ï¼Œè€Œåˆ å»R1å¯¹åº”çš„ç»“ç‚¹ã€‚è¿˜å¯ä»¥ä¸ºæ–°åˆå¹¶çš„ç©ºé—²åˆ†åŒºå»ºç«‹ä¸€ä¸ªæ–°çš„ç»“ç‚¹ï¼Œæ’å…¥ç©ºé—²åˆ†åŒºé“¾è¡¨ï¼Œåˆ é™¤R1å’ŒR2å¯¹åº”çš„åˆ†åŒºç»“ç‚¹ã€‚ ä¸ºäº†è¿›ä¸€æ­¥è¯´æ˜å›æ”¶æµç¨‹æ¥çœ‹ä¸‹é¢çš„ä¾‹é¢˜ã€‚ ä¾‹4-2ï¼šå½“å‰ç©ºé—²é“¾å¦‚å›¾4-22æ‰€ç¤ºã€‚ ç©ºé—²é“¾ç»“ç‚¹åˆ†åˆ«å¯¹åº”èµ·å§‹åœ°å€ä¸º30KBï¼Œå¤§å°ä¸º10KBï¼›èµ·å§‹åœ°å€ä¸º60KBï¼Œå¤§å°ä¸º100KBï¼›èµ·å§‹åœ°å€ä¸º500KBï¼Œå¤§å°ä¸º200KBçš„ç©ºé—²åˆ†åŒºã€‚ å‡å¦‚ç³»ç»Ÿé‡‡ç”¨é¦–æ¬¡é€‚åº”ç®—æ³•åˆ†é…å†…å­˜ï¼Œè¯·ç”»å‡ºåˆ†åˆ«å›æ”¶å¦‚è¡¨4-3ä¸­æ‰€ç¤ºçš„ç©ºé—²åŒºä¹‹åçš„ç©ºé—²é“¾ã€‚ è§£ç­”ï¼š å½“å›æ”¶åŒºæ˜¯F1æ—¶ï¼ŒF1å‰é¢çš„ç©ºé—²åŒºèµ·å§‹åœ°å€ä¸º30KBï¼Œå¤§å°ä¸º10KBï¼Œåœ°å€èŒƒå›´æ˜¯30~40KBã€‚F1åé¢ï¼ˆé«˜åœ°å€éƒ¨åˆ†ï¼‰çš„ç©ºé—²åŒºèµ·å§‹åœ°å€ä¸º60KBï¼Œå¤§å°ä¸º100KBï¼Œåœ°å€èŒƒå›´æ˜¯60~160KBã€‚è€ŒF1çš„èµ·å§‹åœ°å€ä¸º50KBï¼Œå¤§å°ä¸º5KBï¼ŒF1çš„åœ°å€èŒƒå›´ä¸º50~55KBã€‚å¯è§ï¼Œå›æ”¶åŒºF1å‰åéƒ½æ²¡æœ‰ç›¸é‚»çš„ç©ºé—²åˆ†åŒºï¼Œå› æ­¤ï¼Œè¦ä¸ºå›æ”¶F1åˆ›å»ºæ–°çš„ç©ºé—²åˆ†åŒºé“¾è¡¨ç»“ç‚¹ï¼Œç»“ç‚¹çš„èµ·å§‹åœ°å€å­—æ®µä¸ºF1çš„èµ·å§‹åœ°å€50KBï¼Œç»“ç‚¹çš„ç©ºé—²åˆ†åŒºå¤§å°å­—æ®µä¸ºF1çš„å¤§å°5KBã€‚æŒ‰é¦–æ¬¡é€‚åº”ç®—æ³•çš„è¦æ±‚ï¼Œå°†è¯¥ç»“ç‚¹æŒ‰ç©ºé—²åˆ†åŒºèµ·å§‹åœ°å€é€’å¢çš„é¡ºåºæ’åºæ’å…¥ï¼Œå¾—åˆ°å›æ”¶F1åçš„ç³»ç»Ÿç©ºé—²åˆ†åŒºé“¾è¡¨å¦‚å›¾4-23æ‰€ç¤ºã€‚ å½“å›æ”¶åŒºæ˜¯F2æ—¶ï¼ŒF2å‰é¢çš„ç©ºé—²åŒºèµ·å§‹åœ°å€ä¸º30KBï¼Œå¤§å°ä¸º10KBï¼Œåœ°å€èŒƒå›´æ˜¯30~40KBã€‚F2åé¢ï¼ˆé«˜åœ°å€éƒ¨åˆ†ï¼‰çš„ç©ºé—²åŒºèµ·å§‹åœ°å€ä¸º60KBï¼Œå¤§å°ä¸º100KBï¼Œåœ°å€èŒƒå›´æ˜¯60~160KBã€‚è€ŒF2çš„èµ·å§‹åœ°å€ä¸º40KBï¼Œå¤§å°ä¸º10KBï¼ŒF2çš„åœ°å€èŒƒå›´ä¸º40~50KBã€‚å¯è§ï¼Œå›æ”¶åŒºF2ä¸å‰é¢èµ·å§‹åœ°å€ä¸º30KBï¼Œå¤§å°ä¸º10KBï¼Œåœ°å€èŒƒå›´æ˜¯30~40KBçš„ç©ºé—²åˆ†åŒºç›¸é‚»ã€‚å› æ­¤ï¼Œå°†è¯¥ç©ºé—²åˆ†åŒºä¸F2åˆå¹¶ï¼Œåˆå¹¶åçš„ç©ºé—²åŒºèµ·å§‹åœ°å€ä¸º30KBï¼Œå¤§å°ä¸º20KBï¼Œå¾—åˆ°å›æ”¶F2åçš„ç³»ç»Ÿç©ºé—²åˆ†åŒºé“¾è¡¨å¦‚å›¾4-24æ‰€ç¤ºã€‚ å½“å›æ”¶åŒºæ˜¯F3æ—¶ï¼ŒF3å‰é¢çš„ç©ºé—²åŒºèµ·å§‹åœ°å€ä¸º30KBï¼Œå¤§å°ä¸º10KBï¼Œåœ°å€èŒƒå›´æ˜¯30~40KBã€‚F3åé¢ï¼ˆé«˜åœ°å€éƒ¨åˆ†ï¼‰çš„ç©ºé—²åŒºèµ·å§‹åœ°å€ä¸º60KBï¼Œå¤§å°ä¸º1O0KBï¼Œåœ°å€èŒƒå›´æ˜¯60~160KBã€‚è€ŒF3çš„èµ·å§‹åœ°å€ä¸º50KBï¼Œå¤§å°ä¸º10KBï¼ŒF3çš„åœ°å€èŒƒå›´ä¸º50~60KBã€‚å¯è§ï¼Œå›æ”¶åŒºF3ä¸åé¢èµ·å§‹åœ°å€ä¸º60KBï¼Œå¤§å°ä¸º100KBï¼Œåœ°å€èŒƒå›´æ˜¯60~160KBçš„ç©ºé—²åˆ†åŒºç›¸é‚»ã€‚å› æ­¤ï¼Œå°†è¯¥ç©ºé—²åˆ†åŒºä¸F3åˆå¹¶ï¼Œåˆå¹¶åçš„ç©ºé—²åŒºèµ·å§‹åœ°å€ä¸º50KBï¼Œå¤§å°ä¸º110KBã€‚å¾—åˆ°å›æ”¶3åçš„ç³»ç»Ÿç©ºé—²åˆ†åŒºé“¾è¡¨å¦‚å›¾4-25æ‰€ç¤ºã€‚ å½“å›æ”¶åŒºæ˜¯F4æ—¶ï¼ŒF4å‰é¢çš„ç©ºé—²åŒºèµ·å§‹åœ°å€ä¸º30KBï¼Œå¤§å°ä¸º10KBï¼Œåœ°å€èŒƒå›´æ˜¯30~40KBã€‚F4åé¢ï¼ˆé«˜åœ°å€éƒ¨åˆ†ï¼‰çš„ç©ºé—²åŒºèµ·å§‹åœ°å€ä¸º60KBï¼Œå¤§å°ä¸º100KBï¼Œåœ°å€èŒƒå›´æ˜¯60~160KBã€‚è€ŒF4çš„èµ·å§‹åœ°å€ä¸º40KBï¼Œå¤§å°ä¸º20KBï¼ŒF4çš„åœ°å€èŒƒå›´ä¸º40~60KBã€‚å¯è§ï¼Œå›æ”¶åŒºF4ä¸å‰é¢èµ·å§‹åœ°å€ä¸º30KBï¼Œå¤§å°ä¸º10KBï¼Œåœ°å€èŒƒå›´æ˜¯30~40KBçš„ç©ºé—²åˆ†åŒºç›¸é‚»ã€‚ä¸åé¢èµ·å§‹åœ°å€ä¸º60KBï¼Œå¤§å°ä¸º100KBï¼Œåœ°å€èŒƒå›´æ˜¯60~160KBçš„ç©ºé—²åˆ†åŒºä¹Ÿç›¸é‚»ã€‚å› æ­¤ï¼Œå°†F4å‰åä¸¤ä¸ªç©ºé—²åˆ†åŒºä¸F4åˆå¹¶ï¼Œåˆå¹¶åçš„ç©ºé—²åŒºèµ·å§‹åœ°å€ä¸º30KBï¼Œå¤§å°ä¸º130KBã€‚å¾—åˆ°å›æ”¶F4åçš„ç³»ç»Ÿç©ºé—²åˆ†åŒºé“¾è¡¨å¦‚å›¾4-26æ‰€ç¤ºã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å››ç« _å†…å­˜ç®¡ç†/ç¬¬å››èŠ‚_åŸºæœ¬åˆ†é¡µå­˜å‚¨ç®¡ç†æ–¹å¼.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å››ç« _å†…å­˜ç®¡ç†/ç¬¬å››èŠ‚_åŸºæœ¬åˆ†é¡µå­˜å‚¨ç®¡ç†æ–¹å¼.html","title":"ç¬¬å››èŠ‚ åŸºæœ¬åˆ†é¡µå­˜å‚¨ç®¡ç†æ–¹å¼","keywords":"","body":"ç¬¬å››èŠ‚ åŸºæœ¬åˆ†é¡µå­˜å‚¨ç®¡ç†æ–¹å¼ æŠŠè¿›ç¨‹ç¦»æ•£åœ°å­˜å‚¨åœ¨å†…å­˜ä¸­ç‰©ç†åœ°å€ä¸è¿ç»­çš„åŒºåŸŸä¸­ï¼Œè¿™ç§å†…å­˜ç®¡ç†æ–¹å¼ç§°ä¸ºç¦»æ•£å†…å­˜ç®¡ç†æ–¹å¼ã€‚ä¸ºäº†æ”¯æŒè™šæ‹Ÿå†…å­˜ç®¡ç†ï¼Œéœ€è¦å¼•å…¥ç¦»æ•£å†…å­˜ç®¡ç†æ–¹å¼ã€‚æ ¹æ®ç¦»æ•£å†…å­˜ç®¡ç†åˆ†é…å†…å­˜ç©ºé—´çš„åŸºæœ¬å•ä½çš„ä¸åŒï¼Œå°†å…¶åˆ†ä¸º3ç§ä¸åŒçš„ç®¡ç†æ–¹å¼ï¼šåˆ†é¡µå­˜å‚¨ç®¡ç†ã€åˆ†æ®µå­˜å‚¨ç®¡ç†å’Œæ®µé¡µå¼åœ¨å‚¨ç®¡ç†ã€‚ æœ¬èŠ‚è¯¦ç»†è¯´æ˜åˆ†é¡µå­˜å‚¨ç®¡ç†çš„åŸºæœ¬åŸç†ã€‚ ä¸€ã€åˆ†é¡µå­˜å‚¨ç®¡ç†çš„åŸºæœ¬åŸç† 1.åŸºæœ¬æ¦‚å¿µ (1) é¡µ(Page) å°†ä¸€ä¸ªè¿›ç¨‹çš„é€»è¾‘åœ°å€ç©ºé—´åˆ†æˆè‹¥äºä¸ªå¤§å°ç›¸ç­‰çš„ç‰‡ï¼Œç§°ä¸ºé¡µã€‚ (2) é¡µæ¡†(Page Frame) å°†ç‰©ç†å†…å­˜ç©ºé—´åˆ†æˆä¸é¡µå¤§å°ç›¸åŒçš„è‹¥å¹²ä¸ªå­˜å‚¨å—ï¼Œç§°ä¸ºé¡µæ¡†æˆ–é¡µå¸§ã€‚ (3) åˆ†é¡µå­˜å‚¨ åœ¨ä¸ºè¿›ç¨‹åˆ†é…å†…å­˜æ—¶ï¼Œä»¥é¡µæ¡†ä¸ºå•ä½å°†è¿›ç¨‹ä¸­çš„è‹¥å¹²é¡µåˆ†åˆ«è£…å…¥å¤šä¸ªå¯ä»¥ä¸ç›¸é‚»æ¥çš„é¡µæ¡†ä¸­ã€‚å¦‚å›¾4-27æ‰€ç¤ºï¼Œä¸€ä¸ªè¿›ç¨‹çš„é€»è¾‘åœ°å€ç©ºé—´åŒ…æ‹¬ä¸¤ä¸ªé¡µï¼š0å·é¡µå’Œ1å·é¡µã€‚0å·é¡µå­˜æ”¾åœ¨0å·é¡µæ¡†ä¸­ï¼Œ1å·é¡µå­˜æ”¾åœ¨2å·é¡µæ¡†ä¸­ã€‚ (4) é¡µå†…ç¢ç‰‡ è¿›ç¨‹çš„æœ€åä¸€é¡µä¸€èˆ¬è£…ä¸æ»¡ä¸€ä¸ªé¡µæ¡†ï¼Œè€Œå½¢æˆäº†ä¸å¯åˆ©ç”¨çš„ç¢ç‰‡ï¼Œç§°ä¸ºâ€œé¡µå†…ç¢ç‰‡â€æ˜¯ä¸€ç§å†…éƒ¨ç¢ç‰‡ã€‚ (5) é¡µè¡¨(Page Table) é¡µè¡¨æ˜¯ç³»ç»Ÿä¸ºè¿›ç¨‹å»ºç«‹çš„æ•°æ®ç»“æ„ï¼Œé¡µè¡¨çš„ä½œç”¨æ˜¯å®ç°ä»é¡µå·åˆ°é¡µæ¡†å·çš„æ˜ å°„ï¼Œåœ¨è¿›ç¨‹åœ°å€ç©ºé—´å†…çš„æ‰€æœ‰é¡µ(0~n)ï¼Œä¾æ¬¡åœ¨é¡µè¡¨ä¸­æœ‰ä¸€ä¸ªé¡µè¡¨é¡¹ï¼Œå…¶ä¸­è®°å½•äº†ç›¸åº”é¡µåœ¨å†…å­˜ä¸­å¯¹åº”çš„é¡µæ¡†å·ã€‚å¦‚å›¾4-27æ‰€ç¤ºï¼Œä¸€ä¸ªè¿›ç¨‹çš„é€»è¾‘åœ°å€ç©ºé—´åˆ’åˆ†æˆäº†ä¸¤ä¸ªé¡µï¼š0å·é¡µå’Œ1å·é¡µã€‚0å·é¡µå­˜æ”¾åœ¨0å·é¡µæ¡†ä¸­ï¼Œ1å·é¡µå­˜æ”¾åœ¨2å·é¡µæ¡†ä¸­ã€‚è¯¥è¿›ç¨‹çš„é¡µè¡¨ä¸­æœ‰ä¸¤ä¸ªè¡¨é¡¹ï¼Œ0å·è¡¨é¡¹ä¸­å­˜æ”¾äº†é¡µæ¡†å·0ï¼ŒæŒ‡ç¤º0å·é¡µå­˜æ”¾åœ¨0å·é¡µæ¡†ä¸­ã€‚1å·è¡¨é¡¹ä¸­å­˜äº†é¡µæ¡†å·2ï¼ŒæŒ‡ç¤º1å·é¡µå­˜æ”¾åœ¨2å·é¡µæ¡†ä¸­ã€‚åœ¨åŸºæœ¬çš„åˆ†é¡µæœºåˆ¶ä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹æœ‰ä¸€ä¸ªé¡µè¡¨ï¼Œè¿›ç¨‹çš„æ¯ä¸€ä¸ªé¡µåœ¨é¡µè¡¨ä¸­æœ‰ä¸€ä¸ªå¯¹åº”çš„é¡µè¡¨é¡¹ã€‚é¡µè¡¨åœ¨å†…å­˜ä¸­è¿ç»­å­˜æ”¾ã€‚ 2. åŸºæœ¬åˆ†é¡µå­˜å‚¨ç®¡ç†æ–¹å¼ä¸­çš„åœ°å€ç»“æ„ åŸºæœ¬åˆ†é¡µçš„é€»è¾‘åœ°å€ç»“æ„åŒ…å«ä¸¤éƒ¨åˆ†ï¼šé¡µå·På’Œé¡µå†…åç§»é‡Wã€‚è‹¥ç”¨mä½è¡¨ç¤ºé€»è¾‘åœ°å€ï¼Œé¡µå¤§å°ä¸º2^nå­—èŠ‚ï¼ˆå¦‚512å­—èŠ‚ï¼Œ1024å­—èŠ‚ï¼‰ï¼Œåˆ™ç”¨ä½nä½è¡¨ç¤ºé¡µå†…åç§»é‡W,ç”¨é«˜m-nä½è¡¨ç¤ºé¡µå·Pã€‚ ä»¥32ä½åœ°å€ä¸ºä¾‹ï¼šå¯ç”¨0~11ä½è¡¨ç¤ºé¡µå†…åç§»ï¼Œn=12ï¼Œé¡µå¤§å°=é¡µæ¡†å¤§å°=4KBã€‚12~31ä½(20ä½)è¡¨ç¤ºé¡µå·ï¼Œå…±å¯æœ‰2^20ä¸ªé¡µå³1Mä¸ªé¡µã€‚è¿™ç§åœ°å€ç»“æ„å¯ä»¥è¡¨ç¤º4Gçš„é€»è¾‘åœ°å€ç©ºé—´ï¼Œåœ°å€ç»“æ„å¦‚å›¾4-28æ‰€ç¤ºã€‚ è‹¥Aä¸ºé€»è¾‘åœ°å€ï¼ŒLä¸ºé¡µå¤§å°ï¼ŒPä¸ºé¡µå·ï¼ŒWä¸ºé¡µå†…åç§»é‡ï¼Œåˆ™æœ‰ä»¥ä¸‹è®¡ç®—å…³ç³»ã€‚ P=INT(A/L) W=MOD (A/L) ä¾‹4-3ï¼šé€»è¾‘åœ°å€ä¸ºåè¿›åˆ¶çš„5236ï¼Œç³»ç»Ÿé¡µå¤§å°ä¸º4KB,è¯¥é€»è¾‘åœ°å€æ‰€åœ¨çš„é¡µå·På’Œé¡µå†…åç§»åœ°å€Wè®¡ç®—å¦‚ä¸‹ã€‚ P=INT(5236/4096)=1 W=M0D(5236/4096)=1140 åœ¨å®é™…ç³»ç»Ÿä¸­ï¼Œæ˜¯æ ¹æ®ç³»ç»Ÿè®¾è®¡å¥½çš„é¡µå¤§å°å’Œåœ°å€ç»“æ„ï¼Œç”±ç¡¬ä»¶ä»é€»è¾‘åœ°å€Aä¸­åˆ†ç¦»å‡ºé¡µå·å’Œé¡µå†…åç§»åœ°å€ã€‚è‹¥ç³»ç»Ÿçš„åœ°å€ç»“æ„ä¸º32ä½ï¼Œé¡µå¤§å°ä¸º4KBï¼Œåˆ™ç¡¬ä»¶å°†é€»è¾‘åœ°å€Açš„é«˜20ä½è§£é‡Šä¸ºé¡µå·ï¼Œä½12ä½è§£é‡Šä¸ºé¡µå†…åç§»ï¼Œå¦‚å›¾4-29æ‰€ç¤ºã€‚ ä¾‹4-4ï¼šå·²çŸ¥é€»è¾‘åœ°å€Aä¸º0x503200A0ï¼Œè‹¥åœ°å€ç»“æ„å¦‚å›¾4-28æ‰€ç¤ºï¼Œè¯·é—®è¯¥åœ°å€å¯¹åº”çš„é¡µå·å’Œé¡µå†…åç§»åœ°å€åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ é€»è¾‘åœ°å€Aåœ¨é¢˜ä¸­ä»¥åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œå…¶å¯¹åº”çš„äºŒè¿›åˆ¶åœ°å€ä¸º0101 0000 0011 0010 0000 0000 1010 0000,é«˜20ä½ä¸º0101 0000 0011 0010 0000ï¼Œæ­¤ä¸ºé¡µå·ã€‚ä½12ä½ä¸º0000 1010 0000ï¼Œæ­¤ä¸ºé¡µå†…åç§»åœ°å€ã€‚é¡µå·çš„åå…­è¿›åˆ¶æ•°ä¸º0x50320ï¼Œé¡µå†…åç§»åœ°å€çš„åå…­è¿›åˆ¶æ•°ä¸º0xA0ã€‚ 3. åˆ†é¡µåœ°å€å˜æ¢ ä¸ºäº†èƒ½å°†ç”¨æˆ·åœ°å€ç©ºé—´ä¸­çš„é€»è¾‘åœ°å€å˜æ¢ä¸ºå†…å­˜ç©ºé—´ä¸­çš„ç‰©ç†åœ°å€ï¼Œåœ¨ç³»ç»Ÿä¸­å¿…é¡»è®¾ç½®åœ°å€å˜æ¢æœºæ„ï¼Œè¯¥æœºæ„çš„åŸºæœ¬ä»»åŠ¡æ˜¯å®ç°é€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„å˜æ¢ã€‚ åˆ†é¡µåœ°å€å˜æ¢åŸç†å¦‚å›¾4-31æ‰€ç¤ºã€‚ å›¾4-31æ‰€ç¤ºçš„åœ°å€å˜æ¢è¿‡ç¨‹å¦‚ä¸‹ã€‚ 1) è¿›ç¨‹æ‰§è¡Œï¼ŒPCBä¸­é¡µè¡¨èµ·å§‹åœ°å€å’Œé¡µè¡¨é•¿åº¦é€CPUçš„é¡µè¡¨å¯„å­˜å™¨ 2) CPUè®¿é—®é€»è¾‘å•å…ƒAã€‚ 3) ç”±åˆ†é¡µåœ°å€å˜æ¢ç¡¬ä»¶è‡ªåŠ¨å°†Aåˆ†ä¸ºé¡µå·å’Œé¡µå†…åç§»ä¸¤éƒ¨åˆ† 4) ç”±ç¡¬ä»¶æ£€ç´¢é¡µè¡¨ï¼Œå¾—åˆ°Aæ‰€åœ¨çš„é¡µå¯¹åº”çš„é¡µæ¡†å· é¡µå·å¯¹åº”çš„é¡µè¡¨é¡¹èµ·å§‹åœ°å€=é¡µè¡¨èµ·å§‹åœ°å€+é¡µè¡¨é¡¹é•¿åº¦Ã—é¡µå·ï¼ˆé¡µè¡¨é¡¹ä¸­å­˜æœ‰é¡µæ¡†å·)ã€‚ä»è¯¥åœ°å€æŒ‡ç¤ºçš„å†…å­˜å•å…ƒä¸­è¯»å–é¡µæ¡†å· 5) é¡µæ¡†å·å’Œé¡µå†…åç§»åœ°å€é€ç‰©ç†åœ°å€å¯„å­˜å™¨ï¼Œè®¡ç®—ç‰©ç†åœ°å€ã€‚ç‰©ç†åœ°å€=é¡µæ¡†å¤§å°Ã—é¡µæ¡†å·+é¡µå†…åç§»é‡ã€‚ ä¾‹4-5ï¼šåœ¨è¿™ä¸ªå®ä¾‹ä¸­å‡å®šé¡µå¤§å°ä¸º1KBï¼Œè¿›ç¨‹çš„é€»è¾‘åœ°å€ç©ºé—´æœ‰1026ä¸ªå•å…ƒï¼Œé€»è¾‘åœ°å€ä¸º0~1025ã€‚å°†é€»è¾‘åœ°å€ç©ºé—´åˆ’åˆ†ä¸ºä¸¤ä¸ªé¡µï¼Œå³0å·é¡µå’Œ1å·é¡µã€‚é€»è¾‘å•å…ƒ1025è½åœ¨1å·é¡µä¸­ã€‚0å·é¡µå­˜æ”¾åœ¨0å·é¡µæ¡†ä¸­ï¼Œ1å·é¡µå­˜æ”¾åœ¨2å·é¡µæ¡†ä¸­ã€‚æ­¤æ—¶é¡µè¡¨å­˜å‚¨äº†è¿™ä¸€å¯¹åº”å…³ç³»ã€‚å¯ä»¥å¾ˆæ˜¾ç„¶åœ°çœ‹å‡ºï¼Œé€»è¾‘å•å…ƒ1025ä¸­çš„å†…å®¹å®é™…ä¸Šå­˜æ”¾åœ¨ç‰©ç†åœ°å€ä¸º2049çš„ç‰©ç†å•å…ƒå†…ï¼Œå¦‚å›¾4- 32æ‰€ç¤ºã€‚ å½“æ‰§è¡Œæ±‡ç¼–æŒ‡ä»¤Move eaxï¼Œ(1025)æ—¶ï¼Œå¦‚ä½•æ ¹æ®ç¨‹åºä¸­ç»™å‡ºçš„é€»è¾‘å•å…ƒ1025è®¡ç®—å‡ºå¯¹åº”çš„ç‰©ç†åœ°å€å‘¢ï¼Ÿ 1) è®¡ç®—é¡µå·pã€‚ ç”±é¢˜æ„å¯çŸ¥ï¼Œé¡µå¤§å°ä¸º1KB,å³1024ä¸ªå­—èŠ‚ã€‚ P=INT(A/L)=INT(1025/1024)=1ã€‚ 2) æœç´¢é¡µè¡¨å¯çŸ¥ï¼Œ1å·é¡µå­˜æ”¾åœ¨2å·é¡µæ¡†ä¸­ã€‚ 3) é¡µå†…åç§»åœ°å€W=M0D(A/L)=M0D(1025/1024)=1ã€‚ 4) é€»è¾‘å•å…ƒ1025æ‰€å¯¹åº”çš„ç‰©ç†å•å…ƒåœ°å€=é¡µæ¡†å·Ã—é¡µæ¡†å¤§å°+é¡µå†…åç§»åœ°å€=2Ã—1024+1=2049ã€‚ ç”±å›¾4-32å¯è§é€»è¾‘å•å…ƒ1025å†…å­˜æ”¾æ•´æ•°200ï¼Œé€»è¾‘å•å…ƒ1025ç›¸åº”çš„ç‰©ç†å†…å­˜åœ°å€ä¸º2049ã€‚ ä¾‹4-6ï¼šæŸè®¡ç®—æœºç³»ç»ŸæŒ‰å­—èŠ‚ç¼–å€ï¼Œé‡‡ç”¨ä¸€çº§é¡µè¡¨çš„åˆ†é¡µå­˜å‚¨ç®¡ç†æ–¹å¼ï¼Œåˆ†é¡µé€»è¾‘åœ°å€æ ¼å¼å¦‚å›¾4-33æ‰€ç¤ºã€‚ é¡µè¡¨å¦‚å›¾4-34æ‰€ç¤ºã€‚ è¯·é—®é€»è¾‘åœ°å€0x01000001ç»è¿‡åœ°å€è½¬æ¢åçš„ç‰©ç†åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ è§£ç­”ï¼š ç”±é¢˜ä¸­ç»™å‡ºçš„åœ°å€ç»“æ„å¯çŸ¥ï¼šç¡¬ä»¶å°†é€»è¾‘åœ°å€çš„é«˜20ä½è§£é‡Šä¸ºé¡µå·ï¼Œä½12ä½è§£é‡Šä¸ºé¡µå†…åç§»ã€‚é€»è¾‘åœ°å€0x 0100 0001çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸º0000 0001 0000 0000 0000 0000 0000 0001ã€‚è¯¥é€»è¾‘åœ°å€çš„é«˜20ä½ä¸º0000 0001 0000 0000 0000ï¼Œæ­¤ä¸ºé¡µå·ï¼Œå…¶åå…­è¿›åˆ¶è¡¨ç¤ºä¸º0x01000ã€‚è¯¥é€»è¾‘åœ°å€çš„ä½12ä½ä¸º0000 0000 0001ï¼Œæ­¤ä¸ºé¡µå†…åç§»ï¼Œå…¶åå…­è¿›åˆ¶è¡¨ç¤ºä¸º0x001ã€‚ç”±é¡µå·æ£€ç´¢é¡µè¡¨å¯çŸ¥è¯¥é€»è¾‘å•å…ƒæ‰€åœ¨çš„é¡µå¯¹åº”çš„é¡µæ¡†å·ä¸º0x00110ã€‚ ç‰©ç†åœ°å€=0x00110Ã—0x1000+0x001=0x00110001 4.é¡µå¤§å°çš„é€‰æ‹© åœ¨åˆ†é¡µç³»ç»Ÿä¸­ï¼Œé¡µçš„å¤§å°æ˜¯ç”±æœºå™¨çš„ä½“ç³»ç»“æ„å’Œæ“ä½œç³»ç»Ÿå…±åŒå†³å®šçš„ã€‚å¯¹äºæŸä¸€ç§æœºå™¨åªèƒ½æ”¯æŒå‡ ç§å›ºå®šçš„é¡µå¤§å°ï¼Œä¸€æ—¦æ“ä½œç³»ç»Ÿé€‰å®šäº†ä¸€ç§é¡µå¤§å°ï¼Œç³»ç»Ÿä¸­æ‰€æœ‰è¿›ç¨‹çš„é¡µå¤§å°å°±å›ºå®šä¸å˜äº†ï¼ˆä¾‹å¦‚ï¼Œåˆ†é¡µå•å…ƒæŠŠä½12ä½é€»è¾‘åœ°å€è§£é‡Šä¸ºé¡µå†…åç§»åœ°å€ï¼Œåˆ™é¡µå¤§å°å°±æ˜¯4KB)ã€‚ åœ¨è®¾è®¡ç³»ç»Ÿæ—¶ï¼Œå¦‚ä½•é€‰æ‹©é¡µå¤§å°å‘¢ï¼Ÿé€‰æ‹©è¾ƒå°çš„é¡µï¼Œå¯ä»¥å‡å°é¡µå†…ç¢ç‰‡åŠæ‰€æœ‰è¿›ç¨‹é¡µå†…ç¢ç‰‡çš„æ€»å’Œã€‚ä½†è¾ƒå°çš„é¡µä¼šä½¿è¿›ç¨‹çš„é¡µæ•°è¾ƒå¤šï¼Œé¡µè¡¨è¾ƒé•¿ï¼Œé¡µè¡¨æ‰€éœ€å ç”¨çš„è¿ç»­å†…å­˜ç©ºé—´æ¯”è¾ƒå¤§ã€‚è€Œä¸”è¾ƒå°ã€è¾ƒå¤šçš„é¡µä¼šå¯¼è‡´è¿›ç¨‹çš„ç¼ºé¡µç‡é«˜ï¼Œé¡µæ¢å…¥ã€æ¢å‡ºé¢‘ç¹ã€‚è‹¥é€‰æ‹©è¾ƒå¤§çš„é¡µï¼Œé¡µå†…ç¢ç‰‡ä¼šå¢å¤§ã€‚ä¸ºäº†ä¿è¯ç³»ç»Ÿæœ‰è¾ƒå¥½çš„æ—¶é—´å’Œç©ºé—´æ€§èƒ½ï¼Œè¦æ…é‡é€‰æ‹©å¤§å°åˆé€‚çš„é¡µï¼Œä¸€èˆ¬é¡µçš„å¤§å°ä¸º2çš„æ•´æ•°æ¬¡å¹‚ã€‚åœ¨ç›®å‰çš„è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œå¤§å¤šé€‰æ‹©4KBå¤§å°çš„é¡µã€‚ å½’çº³å½±å“é¡µå¤§å°è®¾è®¡çš„å› ç´ å¦‚ä¸‹ã€‚ (1)ç®¡ç†å†…å­˜çš„å¼€é”€ é€‰æ‹©è¾ƒå°çš„é¡µï¼Œä¼šå¯¼è‡´è¿›ç¨‹è¢«åˆ’åˆ†ä¸ºè¾ƒå¤šçš„é¡µï¼Œé¡µè¡¨è¿‡é•¿ï¼Œå ç”¨å¤§é‡å†…å­˜ç©ºé—´ã€‚åŒæ—¶ï¼Œè¿›ç¨‹çš„ç¼ºé¡µç‡å’Œç½®æ¢ç‡éƒ½ä¼šæ¯”è¾ƒé«˜ï¼Œå†…å­˜ç®¡ç†çš„æ—¶é—´å¼€é”€ç›¸å¯¹å¤§ã€‚ (2)å†…å­˜çš„åˆ©ç”¨ç‡ é€‰æ‹©è¾ƒå°çš„é¡µï¼Œæœ‰åˆ©äºæé«˜å†…å­˜çš„åˆ©ç”¨ç‡ï¼Œä½†å­˜åœ¨(1)æ‰€è¿°çš„ç¼ºç‚¹ã€‚é€‰æ‹©è¾ƒå¤§çš„é¡µï¼Œå¯å…‹æœ(1)æ‰€è¿°çš„ç¼ºç‚¹ï¼Œä½†é¡µå†…ç¢ç‰‡å¤§ï¼Œç©ºé—´åˆ©ç”¨ç‡é™ä½ã€‚ é¡µå¤§å°ä¸€èˆ¬æ˜¯2çš„æ•´æ•°æ¬¡å¹‚ï¼Œå¤§å°ä¸º512B~4KBã€‚ç°åœ¨ç¡¬ä»¶å¯ä»¥æ”¯æŒå¤šç§ä¸åŒçš„é¡µå¤§å°ï¼Œé¡µå¤§å°å¯ä»¥é€‰æ‹©4KBã€16KBã€2MBã€4MBã€8MBå’Œ16MBç­‰ã€‚å¦‚æœç³»ç»Ÿæ”¯æŒçš„é€šå¸¸æ˜¯å¤§ä½œä¸šï¼Œå¯ä»¥é€‰æ‹©è¾ƒå¤§çš„é¡µã€‚è€Œæ”¯æŒè¾ƒå°çš„äº¤äº’å¼åº”ç”¨çš„ç³»ç»Ÿå¯ä»¥é€‰æ‹©è¾ƒå°çš„é¡µï¼Œç°åœ¨çš„äº¤äº’å¼ç³»ç»Ÿå¤§å¤šé€‰æ‹©4KBçš„é¡µã€‚ äºŒã€å¿«è¡¨ é¡µè¡¨çš„ç¡¬ä»¶å®ç°æœ‰å¤šç§æ–¹æ³•ï¼Œæœ€ä¸ºç®€å•çš„ä¸€ç§æ–¹æ³•å°±æ˜¯å°†é¡µè¡¨å­˜æ”¾åœ¨ä¸€ç»„ä¸“ç”¨å¯„å­˜å™¨ä¸­ï¼Œè¿›ç¨‹è°ƒåº¦ç¨‹åºé€‰ä¸­æ–°çš„è¿›ç¨‹æ‰§è¡Œæ—¶ï¼Œæ›´æ–°è¿™ç»„å¯„å­˜å™¨çš„å€¼ï¼ŒæŠŠå½“å‰è¿›ç¨‹çš„é¡µè¡¨è£…å…¥å¯„å­˜å™¨ã€‚æ“ä½œç³»ç»Ÿä½¿ç”¨ç‰¹æƒçº§æŒ‡ä»¤è£…å…¥æˆ–ä¿®æ”¹é¡µè¡¨å¯„å­˜å™¨çš„å€¼ã€‚æ—©æœŸçš„DEC PDP-11å°±é‡‡ç”¨è¿™ç§ç»“æ„ã€‚ä½†æ˜¯ï¼Œç›®å‰ä½¿ç”¨çš„è®¡ç®—æœºç³»ç»Ÿéƒ½å…è®¸éå¸¸å¤§çš„è¿›ç¨‹é¡µè¡¨ï¼Œä¸€ä¸ªé¡µè¡¨ä¸­çš„è¡¨é¡¹å¯èƒ½å¤šè¾¾ä¸Šç™¾ä¸‡ä¸ªï¼ŒæŠŠè¿™ä¹ˆå¤§çš„é¡µè¡¨å­˜æ”¾åœ¨å¯„å­˜å™¨ä¸­æ˜¾ç„¶æ˜¯ä¸åˆé€‚çš„ï¼Œæ‰€ä»¥ï¼Œç°åœ¨çš„è®¡ç®—æœºç³»ç»ŸåŸºæœ¬ä¸Šéƒ½æŠŠé¡µè¡¨å­˜æ”¾åœ¨å†…å­˜ä¸­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒCPUè¦è®¿é—®å†…å­˜è¯»å†™æ•°æ®æˆ–è¯»å–æŒ‡ä»¤ï¼Œå¿…é¡»è®¿é—®ä¸¤æ¬¡å†…å­˜ã€‚ç¬¬ä¸€æ¬¡è®¿é—®å†…å­˜ï¼Œä»å†…å­˜é¡µè¡¨ä¸­è·å–è®¿å­˜å•å…ƒæ‰€åœ¨çš„é¡µæ¡†å·ï¼Œä»¥å½¢æˆè®¿å­˜å•å…ƒçš„ç‰©ç†åœ°å€ã€‚ç¬¬äºŒæ¬¡è®¿å­˜æ˜¯æ ¹æ®è®¡ç®—å‡ºçš„ç‰©ç†åœ°å€å®ç°å¯¹å†…å­˜å•å…ƒçš„è®¿é—®ï¼Œè¯»å†™æ•°æ®æˆ–è¯»å–æŒ‡ä»¤ã€‚æ¯ä¸€æ¬¡çš„æœ‰æ•ˆè®¿å­˜éƒ½å¿…é¡»è¦è®¿é—®é¡µè¡¨ï¼Œå› æ­¤è®¿é—®é¡µè¡¨çš„æ•ˆç‡å¾ˆé‡è¦ã€‚è€Œä¸¤æ¬¡è®¿å­˜éƒ½æœ‰æ—¶é—´å¼€é”€ï¼Œä¸ºäº†å‡å°‘CPUåœ¨æœ‰æ•ˆè®¿å­˜ä¸Šçš„æ—¶é—´å¼€é”€ï¼Œæé«˜è®¿å­˜é€Ÿåº¦ï¼Œåœ¨ç¡¬ä»¶ä¸Šå¼•å…¥äº†å¿«è¡¨æœºåˆ¶ã€‚ 1. ä»€ä¹ˆæ˜¯å¿«è¡¨ å¿«è¡¨ä¹Ÿç§°è½¬æ¢åæ´ç¼“å†²(Translation Look-aside Buffer,TLB)ï¼Œæ˜¯ä¸ºäº†æé«˜CPUè®¿å­˜é€Ÿåº¦è€Œé‡‡ç”¨çš„ä¸“ç”¨ç¼“å­˜ï¼Œç”¨æ¥å­˜æ”¾æœ€è¿‘è¢«è®¿é—®è¿‡çš„é¡µè¡¨é¡¹ã€‚TLBæ˜¯å…³è”çš„å¿«é€Ÿé—ªå­˜ã€‚TLBçš„æ¡ç›®ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šé”®å’Œå€¼ã€‚é”®éƒ¨åˆ†å¯¹åº”é¡µå·ï¼Œå€¼éƒ¨åˆ†å¯¹åº”é¡µæ‰€åœ¨çš„é¡µæ¡†å·ã€‚å½“å…³è”å†…å­˜æŸ¥æ‰¾TLBä¸­çš„é¡µè¡¨é¡¹æ—¶ï¼Œä¼šåŒæ—¶ä¸æ‰€æœ‰é”®è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæ‰¾åˆ°æ¡ç›®ï¼Œå°±å¾—åˆ°ç›¸åº”çš„å€¼åŸŸï¼Œä»è€Œå¾—åˆ°é¡µçš„é¡µæ¡†å·ã€‚è¿™ç§æŸ¥æ‰¾æ–¹å¼æ¯”è¾ƒå¿«ï¼Œä½†æ˜¯ç¡¬ä»¶æ¯”è¾ƒæ˜‚è´µã€‚é€šå¸¸ï¼ŒTLBçš„æ¡ç›®æ•°å¾ˆæœ‰é™ï¼Œåœ¨64~1024ä¸ªä¹‹é—´ã€‚ 2. å¼•å…¥TLBä¹‹åçš„åœ°å€å˜æ¢è¿‡ç¨‹ å¼•å…¥TLBä¹‹åçš„åœ°å€å˜æ¢è¿‡ç¨‹å¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹3ä¸ªæ­¥éª¤ã€‚ 1) CPUäº§ç”Ÿåˆ†é¡µçš„é€»è¾‘åœ°å€é¡µå·å’Œé¡µå†…åç§»åï¼Œå°†è¯¥é€»è¾‘åœ°å€çš„é¡µå·æäº¤ç»™TLBã€‚ 2) æŸ¥æ‰¾TLB,å¦‚æœæ‰¾åˆ°é¡µå·ï¼Œåˆ™æŠŠè¯¥é¡µæ‰€åœ¨çš„é¡µæ¡†å·ç”¨äºå½¢æˆç‰©ç†åœ°å€ã€‚å¦åˆ™(TLBå¤±æ•ˆ)æŸ¥æ‰¾å†…å­˜é¡µè¡¨ï¼Œä»å†…å­˜é¡µè¡¨ä¸­æ‰¾åˆ°ç›¸åº”çš„é¡µè¡¨é¡¹ï¼Œè¯»å–é¡µæ‰€åœ¨çš„é¡µæ¡†å·ï¼Œä»¥å½¢æˆç‰©ç†åœ°å€ã€‚ 3) å¦‚æœæ‰€æŸ¥æ‰¾çš„é¡µè¡¨é¡¹ä¸åœ¨TLBä¸­ï¼Œåœ¨è®¿é—®å®Œå†…å­˜é¡µè¡¨åï¼Œè¦æŠŠæ‰¾åˆ°çš„é¡µè¡¨é¡¹ä¸­çš„é¡µå·å’Œé¡µæ¡†å·å†™åˆ°TLBä¸­ã€‚å¦‚æœTLBä¸­çš„æ¡ç›®å·²æ»¡ï¼Œç³»ç»Ÿä¼šæ ¹æ®æŸç§ç­–ç•¥ï¼ˆå¦‚æœ€è¿‘æœ€å°‘ä½¿ç”¨æ›¿æ¢)é€‰æ‹©ä¸€ä¸ªTLBä¸­çš„æ¡ç›®ï¼Œç”¨åˆšè®¿é—®çš„é¡µè¡¨é¡¹ä¿¡æ¯æ›¿æ¢é€‰ä¸­çš„è¿™ä¸ªTLBæ¡ç›®ã€‚ æœ‰äº›ç³»ç»Ÿä¸­å…è®¸TLBä¸­çš„æŸäº›æ¡ç›®æ˜¯å›ºå®šä¸å˜çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äº›æ¡ç›®æ˜¯æ°¸è¿œä¸ä¼šè¢«æ›´æ–°å’Œæ›¿æ¢çš„ã€‚è¿™äº›è¢«å›ºå®šçš„TLBæ¡ç›®é€šå¸¸æ˜¯ä¸æ“ä½œç³»ç»Ÿå†…æ ¸ä»£ç ç›¸å…³çš„æ¡ç›®ã€‚ å¸¦TLBçš„åˆ†é¡µç¡¬ä»¶å¦‚å›¾4-35æ‰€ç¤ºã€‚ ä½¿ç”¨TLBè¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜æ˜¯ï¼ŒTLBæ˜¯ç³»ç»Ÿä¸­æ‰€æœ‰è¿›ç¨‹å…¬ç”¨çš„ä¸€å¥—ç¡¬ä»¶ç¼“å­˜ï¼Œå¦‚ä½•ä¿è¯åœ¨å‘ç”Ÿè¿›ç¨‹åˆ‡æ¢åï¼Œæ–°çš„å½“å‰è¿›ç¨‹ä¸ä¼šé”™ç”¨äº†TLBä¸­ä¿å­˜çš„æ—§è¿›ç¨‹çš„é¡µè¡¨é¡¹ï¼Ÿä¸‹é¢ç”¨ä¸€ä¸ªå®ä¾‹æ¥è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚ç³»ç»Ÿä¸­æœ‰ä¸¤ä¸ªè¿›ç¨‹p1å’Œp2ï¼Œè¿›ç¨‹p1çš„1å·é¡µå­˜æ”¾åœ¨ç¬¬100å·é¡µæ¡†ä¸­ï¼Œåœ¨è¿›ç¨‹p1çš„é¡µè¡¨ä¸­æœ‰ä¸€ä¸ªç›¸åº”çš„é¡µè¡¨é¡¹å¦‚ä¸‹ã€‚ é¡µå· é¡µæ¡†å· 1 100 è¿›ç¨‹p2çš„1å·é¡µå­˜æ”¾åœ¨200å·é¡µæ¡†ä¸­ï¼Œåœ¨è¿›ç¨‹2çš„é¡µè¡¨ä¸­æœ‰ä¸€ä¸ªç›¸åº”çš„é¡µè¡¨é¡¹å¦‚ä¸‹ã€‚ é¡µå· é¡µæ¡†å· 1 200 å½“è¿›ç¨‹p1åœ¨CPUä¸Šè¿è¡Œæ—¶ï¼Œé¡µè¡¨é¡¹ã€1,1O0ã€‘åœ¨è¿›ç¨‹è®¿é—®è¿‡1å·é¡µåä¼šå­˜å…¥TLBã€‚å½“TLBä¸­è¿˜å­˜ç•™æœ‰è¿›ç¨‹p1çš„é¡µè¡¨é¡¹ã€1,1O0ã€‘æ—¶ï¼Œå¦‚æœå‘ç”Ÿè¿›ç¨‹åˆ‡æ¢ï¼Œp2å¼€å§‹åœ¨CPUä¸Šè¿è¡Œã€‚å½“CPUè®¿é—®è¿›ç¨‹p2çš„1å·é¡µæ—¶ï¼Œå¦‚ä½•ä¿è¯ä¸ä¼šé”™è¯¯åœ°æ‰¾åˆ°ã€1,100ã€‘è¿™ä¸ªæ¡ç›®ï¼Œè€Œèƒ½æ­£ç¡®åœ°æ‰¾åˆ°ã€1,200ã€‘è¿™ä¸ªæ¡ç›®ï¼Ÿ è§£å†³é€”å¾„å¦‚ä¸‹ã€‚ 1) æ¯å½“è¿›ç¨‹åˆ‡æ¢æ—¶å°±åˆ·æ–°ä¸€æ¬¡TLB,ä¿è¯TLBä¸­åªæœ‰å½“å‰è¿›ç¨‹çš„é¡µè¡¨é¡¹ã€‚ 2) åœ¨æ¯ä¸ªTLBé¡µè¡¨é¡¹ä¸­ä¿å­˜åœ°å€ç©ºé—´æ ‡è¯†ç¬¦(Address-Space Identifier,ASID)ã€‚ASIDç”¨æ¥å”¯ä¸€æ ‡è¯†è¿›ç¨‹ã€‚å½“TLBè¯•å›¾å‘½ä¸­ä¸€ä¸ªé¡µè¡¨é¡¹æ—¶ï¼Œä¸ºäº†ç¡®ä¿è¿™ä¸ªé¡µè¡¨é¡¹å±äºå½“å‰è¿›ç¨‹ï¼ŒTLBä¼šç¡®ä¿å½“å‰è¿›ç¨‹çš„ASIDä¸è¢«æŸ¥æ‰¾çš„TLBé¡µè¡¨é¡¹çš„ASIDç›¸åŒã€‚ 3. å¼•å…¥TLBçš„æ€§èƒ½åˆ†æ åœ¨TLBä¸­æ‰¾åˆ°æŸä¸€ä¸ªé¡µå·å¯¹åº”çš„é¡µè¡¨é¡¹çš„ç™¾åˆ†æ¯”ç§°ä¸ºTLBå‘½ä¸­ç‡ã€‚å½“èƒ½åœ¨TLBä¸­æ‰¾åˆ°æ‰€éœ€è¦çš„é¡µè¡¨é¡¹æ—¶ï¼Œæœ‰æ•ˆè®¿å­˜æ—¶é—´ç­‰äºä¸€æ¬¡è®¿é—®TLBçš„æ—¶é—´åŠ ä¸Šä¸€æ¬¡è®¿é—®å†…å­˜çš„æ—¶é—´ã€‚å½“æ²¡æœ‰åœ¨TLBä¸­æ‰¾åˆ°æ‰€éœ€è¦çš„é¡µè¡¨é¡¹æ—¶ï¼Œè®¿å­˜æ—¶é—´ç­‰äºä¸€æ¬¡è®¿é—®TLBçš„æ—¶é—´åŠ ä¸Šä¸¤æ¬¡è®¿é—®å†…å­˜ï¼ˆä¸€æ¬¡è®¿é—®å†…å­˜é¡µè¡¨ï¼Œä¸€æ¬¡è®¿é—®å†…å­˜è¯»å†™æ•°æ®æˆ–æŒ‡ä»¤ï¼‰çš„æ—¶é—´ã€‚ ä¸‹é¢ä»¥ä¸€ä¸ªå®ä¾‹æ¥è¯´æ˜å¼•å…¥TLBå¯¹æ”¹å–„æœ‰æ•ˆè®¿å­˜é€Ÿåº¦æ‰€èµ·çš„ä½œç”¨ã€‚ ä¾‹4-7ï¼šè‹¥CPUè®¿é—®å†…å­˜çš„é€Ÿåº¦ä¸º120nsï¼Œè®¿é—®TLBçš„é€Ÿåº¦ä¸º20nsï¼Œè¯•æ¯”è¾ƒæœ‰TLBå’Œæ— TLBç³»ç»Ÿçš„å¹³å‡æœ‰æ•ˆè®¿å­˜æ—¶é—´ã€‚å‡å®šTLBçš„å‘½ä¸­ç‡ä¸º90%ã€‚ 1) æœ‰TLBç³»ç»Ÿçš„æœ‰æ•ˆè®¿å­˜æ—¶é—´=(120+120+20)Ã—10%+(120+20)Ã—90%=152ns 2) æ— TLBç³»ç»Ÿçš„æœ‰æ•ˆè®¿å­˜æ—¶é—´=ä¸¤æ¬¡è®¿é—®å†…å­˜çš„æ—¶é—´=120+120=240ns æ— TLBç³»ç»Ÿçš„æœ‰æ•ˆè®¿é—®æ—¶é—´æ¯”æœ‰TLBç³»ç»Ÿçš„æœ‰æ•ˆè®¿é—®æ—¶é—´æ…¢(240-152)/152=57.9%ã€‚ ä¸‰ã€ä¸¤çº§å’Œå¤šçº§é¡µè¡¨ ç°ä»£è®¡ç®—æœºéƒ½æ”¯æŒå¾ˆå¤§çš„é€»è¾‘åœ°å€ç©ºé—´ï¼Œå¦‚32ä½ç³»ç»Ÿçš„4GBï¼Œ64ä½ç³»ç»Ÿçš„224TBã€‚ä½¿ç”¨å‰é¢æ‰€è®²çš„åŸºæœ¬åˆ†é¡µå­˜å‚¨ï¼Œå›å¿†ä»¥ä¸‹3ä¸ªçŸ¥è¯†ç‚¹ã€‚ 1) æ¯ä¸ªè¿›ç¨‹æœ‰ä¸€ä¸ªé¡µè¡¨ã€‚ 2) æ¯ä¸ªé¡µè¡¨è‡³å°‘åŒ…å«ä¸è¿›ç¨‹é¡µæ•°ç›¸åŒçš„é¡µè¡¨é¡¹æ•° 3) é¡µè¡¨å¿…é¡»è¿ç»­å­˜æ”¾ã€‚ å½“ç³»ç»Ÿæ”¯æŒçš„é€»è¾‘ç©ºé—´å¾ˆå¤§æ—¶ï¼Œæ„å‘³ç€ç³»ç»Ÿå…è®¸æ¯ä¸ªè¿›ç¨‹çš„é€»è¾‘åœ°å€ç©ºé—´å¾ˆå¤§ã€‚å¤§è¿›ç¨‹åŒ…å«çš„é¡µæ•°å¤šï¼Œå…¶é¡µè¡¨ä¸­çš„é¡µè¡¨é¡¹æ•°å°±å¤šã€‚å› ä¸ºä¸€ä¸ªç³»ç»Ÿçš„é¡µè¡¨é¡¹é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ï¼Œé¡µè¡¨é¡¹æ•°è¶Šå¤šï¼Œé¡µè¡¨çš„é•¿åº¦è¶Šå¤§ï¼Œå­˜æ”¾é¡µè¡¨æ‰€éœ€è¦çš„è¿ç»­åœ°å€ç©ºé—´ä¹Ÿè¶Šå¤§ã€‚å¤§å¤šæ•°ç³»ç»Ÿéƒ½æ”¯æŒ32ä½é€»è¾‘åœ°å€ç©ºé—´ï¼Œå³4GBçš„é€»è¾‘åœ°å€ç©ºé—´ã€‚éšç€è®¡ç®—æœºç¡¬ä»¶çš„æ›´æ–°æ¢ä»£ï¼Œé€»è¾‘åœ°å€ç©ºé—´å’Œç‰©ç†å†…å­˜ç©ºé—´éƒ½ä¼šæ›´å¤§ã€‚å¦‚æœç³»ç»Ÿæ”¯æŒçš„é¡µå¤§å°ä¸º4KBï¼Œé‚£ä¹ˆåœ¨32ä½ç³»ç»Ÿä¸­æ¯ä¸ªè¿›ç¨‹å¯ä»¥æ‹¥æœ‰4GB/4KB=1Mä¸ªé¡µã€‚ç›¸åº”çš„ï¼Œé¡µè¡¨ä¸­æœ‰è‡³å°‘éœ€è¦1Mä¸ªé¡µè¡¨é¡¹ï¼Œå¦‚æœæ¯ä¸ªé¡µè¡¨é¡¹çš„é•¿åº¦ä¸º4ä¸ªå­—èŠ‚ï¼ˆå­˜æ”¾ä¸€ä¸ªé¡µè¡¨é¡¹éœ€è¦4ä¸ªå­—èŠ‚çš„ç‰©ç†å†…å­˜ç©ºé—´ï¼‰ï¼Œé‚£ä¹ˆä¸€ä¸ªè¿›ç¨‹çš„é¡µè¡¨éœ€è¦1MÃ—4B=4MBçš„è¿ç»­ç‰©ç†ç©ºé—´æ¥å­˜æ”¾ã€‚ä»ç³»ç»Ÿæ€§èƒ½è€ƒè™‘ï¼Œä¸å¸Œæœ›ç”¨è¿™ä¹ˆå¤§çš„è¿ç»­åœ°å€ç©ºé—´å­˜æ”¾é¡µè¡¨ï¼Œè§£å†³çš„åŠæ³•å°±æ˜¯æŠŠé¡µè¡¨å†åˆ†é¡µï¼Œå½¢æˆä¸¤çº§æˆ–å¤šçº§é¡µè¡¨ã€‚ç”±æ­¤ï¼Œå¯ä»¥å°†é¡µè¡¨ç¦»æ•£åœ°å­˜æ”¾åœ¨ç‰©ç†å†…å­˜ä¸­ã€‚é¡µè¡¨ç¦»æ•£å­˜æ”¾ï¼Œä¹Ÿå¯ä»¥åœ¨æ”¯æŒè™šæ‹Ÿå­˜å‚¨ç®¡ç†æ—¶ï¼Œå°†ä¸€éƒ¨åˆ†é¡µè¡¨å­˜æ”¾åœ¨å¤–å­˜ä¸­ã€‚ 1. ä¸¤çº§é¡µè¡¨ ä¸¤çº§é¡µè¡¨æ˜¯å°†é¡µè¡¨å†è¿›è¡Œåˆ†é¡µï¼Œä½¿æ¯ä¸ªé¡µè¡¨åˆ†é¡µçš„å¤§å°ä¸å†…å­˜é¡µæ¡†çš„å¤§å°ç›¸åŒï¼Œå¹¶ä¸ºå®ƒä»¬ç¼–å·ã€‚å°†è¿™äº›é¡µè¡¨åˆ†é¡µåˆ†åˆ«æ”¾å…¥ä¸åŒçš„ã€ä¸ä¸€å®šç›¸é‚»çš„é¡µæ¡†ä¸­ä¸ºç¦»æ•£åˆ†é…çš„é¡µè¡¨å†å»ºç«‹ä¸€å¼ å¤–å±‚é¡µè¡¨ï¼Œæœ¬ä¹¦ç§°ä¹‹ä¸ºé¡µç›®å½•è¡¨ï¼Œé¡µç›®å½•è¡¨ä¸­çš„æ¯ä¸ªè¡¨é¡¹ä¸­è®°å½•äº†é¡µè¡¨åˆ†é¡µæ‰€åœ¨çš„é¡µæ¡†å·ã€‚ ä»¥å‰é¢ç³»ç»Ÿæ”¯æŒå¤§å°ä¸º4GBçš„é€»è¾‘åœ°å€ç©ºé—´ã€é¡µå¤§å°ä¸º4KBçš„æƒ…å†µä¸ºä¾‹ï¼Œä¸€ä¸ªé€»è¾‘åœ°å€ç©ºé—´ä¸º4GBçš„è¿›ç¨‹ï¼Œæ‹¥æœ‰1Mä¸ªé¡µï¼Œé¡µè¡¨ä¸­æœ‰1Mä¸ªé¡µè¡¨é¡¹ï¼Œå¦‚æœæ¯ä¸ªé¡µè¡¨é¡¹çš„é•¿åº¦ä¸º4ä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆä¸€ä¸ªè¿›ç¨‹éœ€è¦1MÃ—4B=4MBçš„è¿ç»­ç‰©ç†ç©ºé—´æ¥å­˜æ”¾ã€‚ä½¿ç”¨äºŒçº§é¡µè¡¨æ—¶ï¼ŒæŠŠ4Må¤§å°çš„é¡µè¡¨åˆ†æˆ1024ä¸ªé¡µè¡¨åˆ†é¡µï¼Œè¿™1024ä¸ªé¡µè¡¨åˆ†é¡µä¸­åŒ…å«çš„æ˜¯é¡µè¡¨é¡¹ï¼Œæœ¬ä¹¦ä¸­æŠŠè¿™ç§é¡µè¡¨åˆ†é¡µç§°ä¸ºé¡µè¡¨ã€‚æ¯ä¸ªé¡µè¡¨å 4KBç©ºé—´ï¼Œè¿ç»­å­˜æ”¾ã€‚ä¸åŒçš„é¡µè¡¨å¯ä»¥ç¦»æ•£åœ°å­˜æ”¾åœ¨é¡µæ¡†å·ä¸è¿ç»­çš„ç‰©ç†ç©ºé—´å†…ã€‚æ€»ç»“ä¸€ä¸‹ï¼Œå¤§å°ä¸º4GBçš„è¿›ç¨‹ï¼Œå…¶é¡µè¡¨æœ‰1Kä¸ªï¼Œæ¯ä¸ªé¡µè¡¨å¤§å°ä¸º4KBï¼Œ1Kä¸ªé¡µè¡¨ç¦»æ•£å­˜æ”¾ï¼Œå¦‚å›¾4-36æ‰€ç¤ºã€‚ (1) ä¸¤çº§é¡µè¡¨çš„é€»è¾‘åœ°å€ç»“æ„ åœ¨äºŒçº§åˆ†é¡µç³»ç»Ÿä¸­ï¼Œä¸ºäº†èƒ½åœ¨åœ°å€æ˜ å°„æ—¶å¾—åˆ°ç¦»æ•£å­˜æ”¾çš„é¡µè¡¨åœ¨ç‰©ç†å†…å­˜ä¸­çš„åœ°å€ï¼Œéœ€è¦ä¸ºé¡µè¡¨å†å»ºç«‹ä¸€ä¸ªè¿ç»­å­˜æ”¾çš„å¤–å±‚é¡µè¡¨ï¼Œæœ¬ä¹¦ä¹Ÿç§°ä¹‹ä¸ºé¡µç›®å½•è¡¨ã€‚é¡µç›®å½•è¡¨çš„è¡¨é¡¹ ä¸­å­˜æ”¾äº†æ¯ä¸€ä¸ªé¡µè¡¨åœ¨ç‰©ç†å†…å­˜ä¸­æ‰€åœ¨çš„é¡µæ¡†å·ã€‚ä¸ºäº†èƒ½å®ç°é€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„ï¼Œå¿…é¡»æŠŠè¦è®¿é—®çš„é€»è¾‘åœ°å€è§£ææˆå¦‚å›¾4-37æ‰€ç¤ºçš„ç»“æ„ã€‚ é¡µç›®å½•å·p1å®é™…ä¸Šæ˜¯ä¸€ä¸ªç´¢å¼•å€¼ï¼Œæ ¹æ®p1ä»é¡µç›®å½•è¡¨ä¸­æ‰¾åˆ°é¡µè¡¨æ‰€åœ¨çš„é¡µæ¡†å·ã€‚é¡µå·p2æ˜¯é¡µè¡¨ä¸­çš„åç§»é‡ï¼Œæ ¹æ®p2å¯ä»¥çŸ¥é“åº”è¯¥ä»é¡µè¡¨çš„ç¬¬p2é¡¹ä¸­æ‰¾åˆ°è¿›ç¨‹é¡µæ‰€åœ¨çš„é¡µæ¡†å·ã€‚ æ ¹æ®å¦‚å›¾4-38æ‰€ç¤ºçš„å®ä¾‹åšç®€å•è¯´æ˜ï¼šå¦‚æœç”±é€»è¾‘åœ°å€Aå¾—åˆ°p1=0ï¼Œp2=2ï¼Œé‚£ä¹ˆAæ‰€åœ¨çš„è¿›ç¨‹é¡µå­˜æ”¾åœ¨å“ªä¸ªé¡µæ¡†ä¸­ï¼Ÿ p1=0æ—¶ï¼Œæ ¹æ®p1å€¼åœ¨é¡µç›®å½•è¡¨ä¸­æ‰¾åˆ°0å·è¡¨é¡¹ï¼Œè¯¥è¡¨é¡¹ä¸­å­˜æ”¾çš„é¡µæ¡†å·æ˜¯1011ï¼Œè¯´æ˜0å·é¡µè¡¨å­˜æ”¾åœ¨1011å·é¡µæ¡†ä¸­ã€‚ç³»ç»Ÿæ ¹æ®è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥åœ¨å†…å­˜ä¸­æ‰¾åˆ°0å·é¡µè¡¨ã€‚ç„¶åæ ¹æ®p2=2ï¼Œæ‰¾åˆ°0å·é¡µè¡¨çš„ç¬¬2ä¸ªè¡¨é¡¹ã€‚å…¶ä¸­å­˜æ”¾çš„é¡µæ¡†å·æ˜¯6ï¼Œè¯´æ˜Aæ‰€åœ¨çš„è¿›ç¨‹é¡µå­˜æ”¾åœ¨6å·é¡µæ¡†ä¸­ã€‚å¾—åˆ°è¿™ä¸ªé¡µæ¡†å·åå°±å¯ä»¥è®¡ç®—Aå¯¹åº”çš„ç‰©ç†åœ°å€äº†ã€‚ç‰©ç†åœ°å€=Aæ‰€åœ¨çš„é¡µæ¡†å·Ã—é¡µæ¡†å¤§å°+é¡µå†…åç§»åœ°å€dã€‚ (2) ä¸¤çº§é¡µè¡¨çš„å¯»å€ ä½¿ç”¨ä¸¤çº§é¡µè¡¨çš„ç³»ç»Ÿï¼Œå½“è¿›ç¨‹åˆ‡æ¢æ—¶ï¼Œè¦è¿è¡Œçš„è¿›ç¨‹çš„é¡µç›®å½•è¡¨èµ·å§‹åœ°å€è¢«å†™å…¥CPUå¯„å­˜å™¨ï¼Œå¯ä»¥ç§°ä¹‹ä¸ºé¡µè¡¨å¯„å­˜å™¨ï¼Œåœ°å€æ˜ å°„çš„è¿‡ç¨‹å¦‚ä¸‹ã€‚ 1) å¯¹äºç»™å®šçš„é€»è¾‘åœ°å€Aï¼Œç”±ç¡¬ä»¶ä»ä¸­åˆ†ç¦»å‡ºé¡µç›®å½•å·p1ã€é¡µå·p2å’Œé¡µå†…åœ°å€dã€‚ 2) ç”±é¡µè¡¨å¯„å­˜å™¨çš„å€¼å’Œé¡µç›®å½•å·p1ï¼Œä»å­˜æ”¾é¡µç›®å½•çš„é¡µæ¡†ä¸­æ‰¾åˆ°é¡µè¡¨æ‰€åœ¨çš„é¡µæ¡†å·ã€‚é¡µè¡¨æ‰€åœ¨çš„é¡µæ¡†å·åœ¨å†…å­˜ä¸­çš„åœ°å€=é¡µç›®å½•èµ·å§‹åœ°å€+p1Ã—é¡µè¡¨é¡¹é•¿åº¦ï¼Œä»è¯¥åœ°å€æŒ‡ç¤ºçš„ç‰©ç†å†…å­˜å•å…ƒä¸­è¯»å–é¡µè¡¨æ‰€åœ¨çš„é¡µæ¡†å·ã€‚ 3) ç”±é¡µè¡¨æ‰€åœ¨çš„é¡µæ¡†å·å’Œé¡µå·p2ï¼Œä»å­˜æ”¾é¡µè¡¨çš„é¡µæ¡†ä¸­æ‰¾åˆ°è¿›ç¨‹é¡µæ‰€åœ¨çš„é¡µæ¡†å·ã€‚è¿›ç¨‹é¡µæ‰€åœ¨çš„é¡µæ¡†å·åœ¨å†…å­˜ä¸­çš„åœ°å€=é¡µè¡¨çš„èµ·å§‹åœ°å€+p2Ã—é¡µè¡¨é¡¹é•¿åº¦ã€‚ é¡µè¡¨çš„èµ·å§‹åœ°å€=é¡µè¡¨æ‰€åœ¨çš„é¡µæ¡†å—å·Ã—é¡µæ¡†å¤§å°ã€‚ 4) Açš„ç‰©ç†åœ°å€=è¿›ç¨‹é¡µæ‰€åœ¨çš„é¡µæ¡†å·Ã—é¡µæ¡†å¤§å°+é¡µå†…åœ°å€dã€‚ å¯ä»¥ç»“åˆå›¾4-39ç†è§£ä¸Šè¿°å¯»å€è¿‡ç¨‹ã€‚ ä¾‹4-8ï¼šæŸç³»ç»Ÿé€»è¾‘åœ°å€å’Œç‰©ç†åœ°å€å‡ä¸º32ä½ï¼Œé‡‡ç”¨ä¸¤çº§åˆ†é¡µï¼Œé¡µå¤§å°ä¸º4KBï¼Œåœ°å€ ç»“æ„å¦‚å›¾4-40æ‰€ç¤ºã€‚ å·²çŸ¥é€»è¾‘åœ°å€ä¸º0x00801004ï¼Œ2å·é¡µè¡¨å¦‚å›¾4-41æ‰€ç¤ºã€‚æ±‚å…¶å¯¹åº”çš„ç‰©ç†åœ°å€ã€‚ ç­”æ¡ˆï¼šé€»è¾‘åœ°å€0x00801004çš„äºŒè¿›åˆ¶åœ°å€ä¸º0000 0000 1000 0000 0001 0000 0000 0100 ç”±å›¾ä¸­ç»™å‡ºçš„åœ°å€ç»“æ„å¯çŸ¥ï¼Œå–äºŒè¿›åˆ¶é€»è¾‘åœ°å€çš„é«˜10ä½ä½œä¸ºé¡µç›®å½•å·ï¼Œå¾—åˆ°é¡µç›®å½•å·ä¸º0x2ã€‚ å–äºŒè¿›åˆ¶é€»è¾‘åœ°å€çš„ä¸­é—´10ä½ä½œä¸ºé¡µå·ï¼Œå¾—åˆ°é¡µå·ä¸º1ã€‚ å–äºŒè¿›åˆ¶é€»è¾‘åœ°å€çš„ä½12ä½ä½œä¸ºé¡µå†…åç§»ï¼Œå¾—åˆ°é¡µå†…åç§»å€¼ä¸º0x4ã€‚ ç”±2å·é¡µè¡¨å¯å¾—åˆ°é¡µå·ä¸º1çš„é¡µè¡¨é¡¹ä¸­å­˜æ”¾çš„é¡µæ¡†å·ä¸º0x208,å³è¿›ç¨‹é¡µæ‰€åœ¨çš„é¡µæ¡†å·ã€‚ é€»è¾‘åœ°å€0x00801004å¯¹åº”çš„ç‰©ç†åœ°å€ä¸ºï¼š0x208Ã—0x1000+0x4=0x208004ã€‚ (3) å‡å°‘é¡µè¡¨å ç”¨å†…å­˜çš„æ–¹æ³• ä¸ºäº†å‡å°‘é¡µè¡¨æ‰€å å†…å­˜ï¼Œå¯ä»¥å°†å½“å‰æ‰€éœ€è¦çš„é¡µç›®å½•è¡¨å’Œé¡µè¡¨å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œå…¶ä½™é¡µè¡¨å­˜æ”¾åœ¨å¤–å­˜ä¸­ï¼Œå½“æ‰€éœ€é¡µè¡¨ä¸åœ¨å†…å­˜ä¸­æ—¶ï¼Œäº§ç”Ÿä¸­æ–­ï¼Œå°†è¯·æ±‚çš„é¡µè¡¨è°ƒå…¥å†…å­˜ã€‚ 2. å¤šçº§é¡µè¡¨ç»“æ„ å¯¹äº64ä½çš„æœºå™¨ï¼Œä½¿ç”¨äºŒçº§é¡µè¡¨ï¼Œä»å­˜åœ¨è¿ç»­å ç”¨å¤§é‡å†…å­˜çš„é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨å¤šçº§é¡µè¡¨ç»“æ„ï¼Œå°†å¤–å±‚é¡µè¡¨å†åˆ†è‹¥å¹²é¡µï¼Œç„¶åä¸ºå¤–å±‚é¡µè¡¨å»ºç«‹è¿ç»­å­˜æ”¾çš„ç´¢å¼•è¡¨ã€‚ ä¾‹4-9ï¼š64ä½æœºå™¨è‹¥ä»ç„¶é‡‡ç”¨äºŒçº§é¡µè¡¨ï¼Œé¡µè¡¨é¡¹å 4ä¸ªå­—èŠ‚ï¼Œé¡µå¤§å°ä¸º4KB,ä½12ä½è¡¨ç¤ºé¡µå†…åç§»ï¼Œä¸­é—´10ä½è¡¨ç¤ºé¡µè¡¨é¡¹åœ¨é¡µè¡¨ä¸­çš„è¡¨é¡¹å·ï¼Œé‚£ä¹ˆå¤–å±‚é¡µå·å°±å¯ä»¥ä½¿ç”¨42ä½ã€‚è¡¨ç¤ºç³»ç»Ÿä¸­å¯ä»¥æœ‰2^42ä¸ªé¡µè¡¨åˆ†é¡µï¼Œå¤–å±‚é¡µè¡¨å°±æœ‰4096Gä¸ªé¡µè¡¨é¡¹ï¼Œéœ€è¦4Ã—4096Gå­—èŠ‚çš„è¿ç»­ç‰©ç†å†…å­˜æ¥å­˜æ”¾å¤–å±‚é¡µè¡¨ã€‚å› æ­¤ï¼Œéœ€è¦å¯¹å¤–å±‚é¡µè¡¨å†è¿›è¡Œåˆ†é¡µï¼Œå»ºç«‹æ›´å¤–å±‚çš„é¡µè¡¨ï¼Œå½¢æˆå¤šçº§é¡µè¡¨ã€‚ å››ã€åç½®é¡µè¡¨ 1. åç½®é¡µè¡¨ åœ¨å‰é¢æ‰€ä»‹ç»çš„åˆ†é¡µç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªé¡µè¡¨ï¼Œè¿›ç¨‹é€»è¾‘åœ°å€ç©ºé—´çš„æ¯ä¸ªé¡µåœ¨é¡µè¡¨ä¸­éƒ½æœ‰ä¸€ä¸ªç›¸åº”çš„é¡µè¡¨é¡¹ç”¨æ¥å­˜æ”¾é¡µæ‰€åœ¨çš„é¡µæ¡†å·ã€‚ç°ä»£ç³»ç»Ÿä¸­å¯èƒ½å­˜åœ¨å¤§é‡è¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½å…è®¸å¾ˆå¤§çš„é€»è¾‘åœ°å€ç©ºé—´ï¼Œå› è€Œè¿›ç¨‹å¯èƒ½æ‹¥æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é¡µè¡¨ï¼Œè¿™äº›é¡µè¡¨ä¼šå ç”¨å¤§é‡çš„ç‰©ç†å†…å­˜ç©ºé—´ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨åç½®é¡µè¡¨ï¼Œä¸ºæ¯ä¸€ä¸ªé¡µæ¡†è®¾ä¸€ä¸ªè¡¨é¡¹ï¼Œè¡¨é¡¹ä¸­å­˜æ”¾è¿›ç¨‹å·å’Œé¡µå·ï¼Œç³»ç»Ÿåªç»´æŠ¤ä¸€å¼ åç½®é¡µè¡¨å³å¯ã€‚ç”±äºç‰©ç†å­˜å‚¨ç©ºé—´å°äºé€»è¾‘å­˜å‚¨ç©ºé—´ï¼Œæ‰€ä»¥ä½¿ç”¨åç½®é¡µè¡¨å‡å°‘äº†é¡µè¡¨å ç”¨çš„å†…å­˜ç©ºé—´ã€‚ 2. åç½®é¡µè¡¨çš„åœ°å€æ˜ å°„ åœ¨åˆ©ç”¨åç½®é¡µè¡¨è¿›è¡Œåœ°å€å˜æ¢æ—¶ï¼Œæ˜¯ç”¨è¿›ç¨‹æ ‡å¿—ç¬¦ï¼ˆè¿›ç¨‹å·ï¼‰å’Œé¡µå·å»æ£€ç´¢åç½®é¡µè¡¨ä»¥è·å–é¡µæ¡†å·ã€‚åœ°å€æ˜ å°„è¿‡ç¨‹å¦‚ä¸‹ã€‚ 1) æ ¹æ®è¿›ç¨‹å·å’Œé¡µå·æ‰¾åˆ°é¡µæ¡†å·ã€‚ 2) ç‰©ç†åœ°å€=é¡µæ¡†å·Ã—é¡µæ¡†å¤§å°+é¡µå†…åç§»åœ°å€ã€‚ äº”ã€ç©ºé—²é¡µæ¡†çš„ç®¡ç† æ“ä½œç³»ç»Ÿéœ€è¦è·Ÿè¸ªå’Œè®°å½•ç©ºé—²é¡µæ¡†çš„ä¿¡æ¯ï¼Œä¸‹é¢ä»‹ç»ä¸¤ç§ç®¡ç†ç©ºé—²é¡µæ¡†çš„æ–¹å¼ã€‚ 1. ä½¿ç”¨ä½å›¾ç®¡ç†ç©ºé—²é¡µæ¡† ä½¿ç”¨ä½å›¾ç®¡ç†ç©ºé—²é¡µæ¡†æ—¶ï¼Œä½¿ä½å›¾ä¸­çš„æ¯ä¸€ä½å¯¹åº”ä¸€ä¸ªé¡µæ¡†ï¼Œå…·æœ‰Nä¸ªé¡µæ¡†çš„å†…å­˜éœ€è¦è‡³å°‘æœ‰Nä¸ªäºŒè¿›åˆ¶ä½çš„ä½å›¾ã€‚å½“æŸä¸ªäºŒè¿›åˆ¶ä½å¯¹åº”çš„é¡µæ¡†è¢«å ç”¨æ—¶ï¼Œå°†è¯¥ä½ç½®1ã€‚å½“è¯¥é¡µæ¡†ç©ºé—²æ—¶ï¼Œè¯¥ä½ç½®0ã€‚å½“æ“ä½œç³»ç»Ÿä¸ºè¿›ç¨‹åˆ†é…é¡µæ¡†æ—¶ï¼Œæ£€ç´¢ä½å›¾ï¼Œæ‰¾å¯¹åº”ä½ä¸º0çš„é¡µæ¡†åˆ†é…ç»™è¿›ç¨‹ï¼ˆå…·ä½“å®ç°æ—¶ç”¨0è¡¨ç¤ºç©ºé—²ï¼Œ1è¡¨ç¤ºè¢«å ç”¨ï¼Œåä¹‹ä¹Ÿå¯ï¼‰ã€‚ 2. ä½¿ç”¨ç©ºé—²é¡µæ¡†çš„é“¾è¡¨ ä½¿ç”¨ç©ºé—²é¡µæ¡†é“¾è¡¨æ—¶ï¼Œç³»ç»Ÿç»´æŠ¤è®°å½•ç©ºé—²é¡µæ¡†ä¿¡æ¯çš„é“¾è¡¨ã€‚ç©ºé—²é¡µæ¡†é“¾è¡¨å¯ä»¥æŒ‰åœ°å€é€’å¢çš„é¡ºåºæ’åºï¼Œæ¯ä¸ªç»“ç‚¹ä¸­åŒ…å«é¡µæ¡†çš„åœ°å€ä¿¡æ¯ã€æŒ‡å‘åé¢ç»“ç‚¹çš„æŒ‡é’ˆå’ŒæŒ‡å‘å‰é¢ç»“ç‚¹çš„æŒ‡é’ˆã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å››ç« _å†…å­˜ç®¡ç†/ç¬¬äº”èŠ‚_åŸºäºåˆ†é¡µçš„è™šæ‹Ÿå­˜å‚¨ç³»ç»Ÿ.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å››ç« _å†…å­˜ç®¡ç†/ç¬¬äº”èŠ‚_åŸºäºåˆ†é¡µçš„è™šæ‹Ÿå­˜å‚¨ç³»ç»Ÿ.html","title":"ç¬¬äº”èŠ‚ åŸºäºåˆ†é¡µçš„è™šæ‹Ÿå­˜å‚¨ç³»ç»Ÿ","keywords":"","body":"ç¬¬äº”èŠ‚ åŸºäºåˆ†é¡µçš„è™šæ‹Ÿå­˜å‚¨ç³»ç»Ÿ è™šæ‹Ÿå­˜å‚¨å™¨æ˜¯æŒ‡å…·æœ‰è¯·æ±‚è°ƒå…¥åŠŸèƒ½å’Œç½®æ¢åŠŸèƒ½ï¼Œèƒ½ä»é€»è¾‘ä¸Šå¯¹å†…å­˜å®¹é‡è¿›è¡Œæ‰©å……çš„ä¸€ç§å­˜å‚¨å™¨ç³»ç»Ÿã€‚åœ¨è™šæ‹Ÿå­˜å‚¨å™¨ç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹æ— éœ€å…¨éƒ¨è£…å…¥ï¼Œåªè¦è£…å…¥ä¸€éƒ¨åˆ†å³å¯è¿è¡Œã€‚ è™šæ‹Ÿå­˜å‚¨æŠ€æœ¯å®ç°çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼ŒåªæŠŠè¿›ç¨‹çš„ä¸€éƒ¨åˆ†è£…å…¥å†…å­˜ã€‚è¿›ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒCPUè®¿é—®å†…å­˜æ—¶å¦‚æœå‘ç°æ‰€è®¿é—®çš„å†…å®¹ä¸åœ¨å†…å­˜ä¸­ï¼Œåˆ™é€šè¿‡å¼‚å¸¸å¤„ç†å°†æ‰€éœ€è¦çš„å†…å®¹ä»å¤–å­˜è°ƒå…¥å†…å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´å…ˆå°†è¿›ç¨‹çš„ä¸€éƒ¨åˆ†è£…å…¥å†…å­˜ï¼Œå…¶ä½™çš„éƒ¨åˆ†ä»€ä¹ˆæ—¶å€™éœ€è¦ï¼Œä»€ä¹ˆæ—¶å€™è¯·æ±‚ç³»ç»Ÿè£…å…¥ï¼Œè¿™å°±æ˜¯è¯·æ±‚è°ƒå…¥ã€‚å¦‚æœåœ¨è¯·æ±‚ç³»ç»Ÿè£…å…¥è¿›ç¨‹åœ¨å¤–å­˜ä¸­çš„æŸä¸€éƒ¨åˆ†æ—¶ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œåˆ™ç”±æ“ä½œç³»ç»Ÿé€‰æ‹©ä¸€éƒ¨åˆ†å†…å­˜ä¸­çš„è¿›ç¨‹å†…å®¹æ¢å‡ºåˆ°å¤–å­˜ï¼Œä»¥è…¾å‡ºå†…å­˜ç©ºé—´æŠŠå½“å‰éœ€è¦è£…å…¥çš„å†…å®¹è°ƒå…¥å†…å­˜ï¼Œè¿™å°±æ˜¯ç½®æ¢ã€‚ è™šæ‹Ÿå­˜å‚¨æŠ€æœ¯è‡³å°‘èƒ½å¸¦æ¥ä»¥ä¸‹3ç‚¹å¥½å¤„ã€‚ 1) æé«˜å†…å­˜åˆ©ç”¨ç‡ã€‚å› ä¸ºè™šæ‹Ÿå­˜å‚¨æŠ€æœ¯å…è®¸åªæŠŠè¿›ç¨‹çš„ä¸€éƒ¨åˆ†è£…å…¥å†…å­˜ï¼ŒåŸåˆ™ä¸Šå°½é‡æŠŠå¿…é¡»æˆ–å¸¸ç”¨çš„éƒ¨åˆ†è£…å…¥å†…å­˜ã€‚ 2) æé«˜å¤šé“ç¨‹åºåº¦ã€‚å› ä¸ºåªæŠŠæ¯ä¸ªè¿›ç¨‹çš„ä¸€éƒ¨åˆ†è£…äººå†…å­˜ï¼Œå› æ­¤å¯ä»¥åœ¨å†…å­˜ä¸­è£…äººæ›´å¤šçš„è¿›ç¨‹ã€‚ 3) æŠŠé€»è¾‘åœ°å€ç©ºé—´å’Œç‰©ç†åœ°å€ç©ºé—´åˆ†å¼€ï¼Œä½¿ç¨‹åºå‘˜ä¸ç”¨å…³å¿ƒç‰©ç†å†…å­˜çš„å®¹é‡å¯¹ç¼–ç¨‹çš„é™åˆ¶ã€‚ è™šæ‹Ÿå­˜å‚¨ç³»ç»Ÿå…·æœ‰ä»¥ä¸‹å‡ ä¸ªä¸»è¦ç‰¹å¾ã€‚ 1) ç¦»æ•£æ€§ã€‚ç¦»æ•£æ€§æ˜¯æŒ‡è¿›ç¨‹å¯ä»¥åˆ†æ•£åœ°å­˜å‚¨åœ¨ç‰©ç†å†…å­˜ä¸­ã€‚åˆ†é¡µã€åˆ†æ®µå’Œæ®µé¡µå¼å­˜å‚¨éƒ½å±äºç¦»æ•£çš„å†…å­˜ç®¡ç†æ–¹å¼ã€‚ç¦»æ•£æ€§æ˜¯å®ç°è™šæ‹Ÿå­˜å‚¨ç®¡ç†çš„åŸºç¡€ã€‚ 2) å¤šæ¬¡æ€§ã€‚å¤šæ¬¡æ€§æ˜¯æŒ‡ä¸å¿…æŠŠè¿›ç¨‹ä¸€æ¬¡æ€§å…¨éƒ¨è£…å…¥å†…å­˜ï¼Œå¯ä»¥å…ˆå°†æ‰§è¡Œå½“å‰è¿›ç¨‹æ‰€å¿…éœ€çš„éƒ¨åˆ†ä»£ç å’Œæ•°æ®è£…å…¥å†…å­˜ï¼Œå…¶ä½™éƒ¨åˆ†ç­‰è¿›ç¨‹è¿è¡Œéœ€è¦æ—¶å†è£…å…¥ï¼Œå¯ä»¥å°†è¿›ç¨‹åˆ†å¤šæ¬¡è£…å…¥å†…å­˜ã€‚ 3) å¯¹æ¢æ€§ã€‚å¯¹æ¢æ€§æ˜¯æŒ‡åœ¨å†…å­˜ä¸­çš„è¿›ç¨‹å¯ä»¥æ¢å‡ºï¼Œä»¥è…¾å‡ºå†…å­˜ç©ºé—´æ¢å…¥å¤–å­˜ä¸­çš„è¿›ç¨‹ã€‚ä¸ºäº†æé«˜å†…å­˜çš„åˆ©ç”¨ç‡ï¼Œä¸ºç¨‹åºå‘˜æä¾›è¶³å¤Ÿå¤§çš„è™šæ‹Ÿç©ºé—´ï¼Œåœ¨è¿›ç¨‹è¿è¡ŒæœŸé—´ï¼Œç³»ç»Ÿå¯ä»¥å°†å†…å­˜ä¸­æš‚æ—¶ä¸ç”¨çš„ç¨‹åºä»£ç æˆ–æ•°æ®æ¢å‡ºåˆ°å¤–å­˜ï¼Œä»¥åéœ€è¦è¿™äº›ç¨‹åºå’Œä»£ç æ—¶å†ç”±ç³»ç»Ÿè°ƒå…¥å†…å­˜ã€‚ 4) è™šæ‹Ÿæ€§ã€‚è™šæ‹Ÿæ€§æ˜¯æŒ‡è™šæ‹Ÿå­˜å‚¨ç³»ç»Ÿä¸ºç”¨æˆ·æä¾›äº†æ¯”å®é™…ç‰©ç†å†…å­˜å¤§çš„é€»è¾‘å†…å­˜ç©ºé—´ï¼Œä½¿ç¨‹åºå‘˜ä¸å¿…åœ¨ç¼–ç¨‹æ—¶å—ç‰©ç†å†…å­˜ç©ºé—´å¤§å°çš„é™åˆ¶ã€‚è™šæ‹Ÿæ€§æ˜¯å®ç°è™šæ‹Ÿå­˜å‚¨ç³»ç»Ÿçš„æœ€é‡è¦çš„ç›®æ ‡ã€‚ è¯·æ±‚åˆ†é¡µç³»ç»Ÿæ˜¯æœ€åŸºæœ¬ã€æœ€å¸¸ç”¨çš„è™šæ‹Ÿå­˜å‚¨ç³»ç»Ÿçš„å®ç°æ–¹å¼ã€‚å…¶åŸºæœ¬åŸç†æ˜¯ï¼ŒæŠŠè¿›ç¨‹çš„ é€»è¾‘åœ°å€ç©ºé—´åˆ†æˆå¤§å°ç›¸åŒçš„é¡µï¼Œæ“ä½œç³»ç»Ÿåˆ›å»ºè¿›ç¨‹æ—¶åªæŠŠè¿›ç¨‹çš„ä¸€éƒ¨åˆ†é¡µè°ƒå…¥å†…å­˜ã€‚è¿›ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­è®¿é—®å†…å­˜ï¼Œè‹¥å‘ç°æ‰€è®¿é—®çš„é¡µä¸åœ¨å†…å­˜ä¸­ï¼Œåˆ™äº§ç”Ÿä¸€ä¸ªç¼ºé¡µå¼‚å¸¸ä¿¡å·ï¼Œç³»ç»Ÿå“åº”ç¼ºé¡µå¼‚å¸¸ï¼Œè¯·æ±‚è°ƒå…¥ç¼ºé¡µã€‚è‹¥è°ƒå…¥ç¼ºé¡µæ—¶å†…å­˜å·²æ»¡ï¼Œåˆ™éœ€è¦å…ˆä»å†…å­˜ä¸­é€‰æ‹©ä¸€ä¸ªæˆ–è‹¥å¹²ä¸ªé¡µæ¢å‡ºåˆ°å¤–å­˜ç©ºé—´ï¼Œä»¥è…¾å‡ºå†…å­˜ç©ºé—´å®¹çº³è¯·æ±‚è°ƒå…¥çš„ç¼ºé¡µã€‚æœ¬èŠ‚å°†è¯¦ç»†è¯´æ˜è¯·æ±‚åˆ†é¡µå­˜å‚¨ç®¡ç†çš„å®ç°åŸç†ã€‚ ä¸€ã€è¯·æ±‚åˆ†é¡µä¸­çš„ç¡¬ä»¶æ”¯æŒ ä¸ºäº†å®ç°è¯·æ±‚åˆ†é¡µï¼Œéœ€è¦ç‰¹æ®Šçš„é¡µè¡¨ï¼ˆç›¸å¯¹äºåŸºæœ¬åˆ†é¡µå­˜å‚¨çš„é¡µè¡¨è€Œè¨€ï¼‰ã€ç¼ºé¡µå¼‚å¸¸æœºæ„å’Œæ”¯æŒè¯·æ±‚åˆ†é¡µçš„åœ°å€å˜æ¢æœºæ„ã€‚ 1. é¡µè¡¨ é¡µè¡¨æ˜¯æ”¯æŒè¯·æ±‚åˆ†é¡µç³»ç»Ÿæœ€é‡è¦çš„æ•°æ®ç»“æ„ï¼Œå…¶ä½œç”¨æ˜¯è®°å½•æè¿°é¡µçš„å„ç§æ•°æ®ã€åŒ…æ‹¬åœ¨å®ç°é€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€æ˜ å°„æ—¶éœ€è¦çš„é¡µå·ä¸é¡µæ¡†å·çš„å¯¹åº”å…³ç³»ã€‚é™¤äº†é¡µå·å’Œé¡µæ¡†å·ä¹‹å¤–ï¼Œé¡µè¡¨ä¸­å¢åŠ äº†è¯·æ±‚æ¢å…¥å’Œé¡µç½®æ¢æ—¶éœ€è¦çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œè¡¨ç¤ºé¡µæ˜¯å¦åœ¨å†…å­˜ä¸­çš„çŠ¶æ€ä½ï¼Œä»¥åŠè®°å½•é¡µè¢«è®¿é—®æƒ…å†µçš„å­—æ®µã€‚ä¸åŒçš„æ“ä½œç³»ç»Ÿå¯èƒ½ä¸ºé¡µè¡¨é¡¹å®šä¹‰ä¸åŒçš„å­—æ®µï¼Œåœ¨æ”¯æŒè¯·æ±‚åˆ†é¡µçš„ç³»ç»Ÿä¸­ä¸€èˆ¬åŒ…å«ä»¥ä¸‹åŸºæœ¬å­—æ®µï¼Œé¡µè¡¨é¡¹çš„æ„æˆå¦‚å›¾4-42æ‰€ç¤ºã€‚ 1) é¡µæ¡†å·ï¼šå­˜æ”¾é¡µæ‰€åœ¨çš„é¡µæ¡†å·ã€‚ 2) çŠ¶æ€ä½Pï¼šç”¨æ¥æ ‡è¯†é¡µæ˜¯å¦åœ¨å†…å­˜ä¸­ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥è§„å®šPä¸º0æ—¶è¡¨ç¤ºé¡µä¸åœ¨å†…å­˜ä¸­ï¼Œéœ€è¦è¯·æ±‚è°ƒé¡µï¼›Pä¸º1æ—¶è¡¨ç¤ºé¡µåœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥è·å–è¯¥é¡µæ‰€åœ¨çš„é¡µæ¡†å·ã€‚ 3) è®¿é—®å­—æ®µAï¼šç”¨äºè®°å½•é¡µæœ€è¿‘è¢«è®¿é—®çš„æƒ…å†µã€‚Aä¸­å¯ä»¥å­˜æ”¾é¡µæœ€è¿‘è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œä¹Ÿå¯ä»¥å­˜æ”¾æœ€è¿‘æœªè¢«è®¿é—®çš„æ—¶é—´é•¿åº¦ã€‚ä¹Ÿå¯ä»¥ç®€å•åœ°ç”¨A=1è¡¨ç¤ºé¡µæœ€è¿‘è¢«è®¿é—®è¿‡ï¼Œç”¨A=0è¡¨ç¤ºé¡µæœ€è¿‘æ²¡æœ‰è¢«è®¿é—®è¿‡ã€‚æ“ä½œç³»ç»Ÿå®ç°ç½®æ¢ç¨‹åºæ—¶éœ€è¦æ ¹æ®Açš„å€¼æ¥é€‰æ‹©è¢«æ¢å‡ºçš„é¡µï¼Œå‡ºäºæ•ˆç‡çš„è€ƒè™‘ï¼Œç³»ç»Ÿæ€»æ˜¯å¸Œæœ›æ ¹æ®Açš„å€¼æŠŠæœ€è¿‘ã€æœ€ä¹…æœªè®¿é—®çš„é¡µæ¢å‡ºåˆ°å¤–å­˜ã€‚ 4) ä¿®æ”¹ä½Mï¼šç”¨äºæ ‡è¯†é¡µæœ€è¿‘æ˜¯å¦è¢«ä¿®æ”¹è¿‡ã€‚ç”±äºå†…å­˜ä¸­çš„æ¯ä¸ªé¡µåœ¨å¤–å­˜ä¸­éƒ½ä¿å­˜æœ‰ä¸€ä¸ªå‰¯æœ¬ï¼Œå¦‚æœé¡µæ²¡æœ‰è¢«ä¿®æ”¹è¿‡ï¼Œåˆ™å¤–å­˜ä¸­çš„é¡µå‰¯æœ¬å’Œå†…å­˜ä¸­çš„é¡µå®Œå…¨ä¸€è‡´ã€‚å› æ­¤ï¼Œæ¢å‡ºé¡µæ—¶å°±ä¸ç”¨æŠŠé¡µä¿¡æ¯å†™å›å¤–å­˜ï¼Œåªéœ€è¦æŠŠè¯¥é¡µæ‰€å ç”¨çš„é¡µæ¡†æ ‡è¯†ä¸ºç©ºé—²å¯ç”¨å³å¯ã€‚å¦‚æœé¡µæœ€è¿‘è¢«ä¿®æ”¹è¿‡ï¼Œé‚£ä¹ˆå†…å­˜ä¸­çš„é¡µå’Œå¤–å­˜ä¸­è¯¥é¡µçš„å‰¯æœ¬å°±ä¸ä¸€è‡´äº†ã€‚åœ¨æ¢å‡ºé¡µæ—¶ï¼Œå¿…é¡»æŠŠæœ€è¿‘ä¿®æ”¹è¿‡çš„é¡µå†™å›å¤–å­˜ã€‚å¾€å¤–å­˜ä¸­å†™ä¿¡æ¯ï¼Œéœ€è¦è¯·æ±‚ç£ç›˜æ“ä½œï¼Œä¸ºäº†å‡å°‘ç³»ç»Ÿå¼€é”€å’Œå¯åŠ¨ç£ç›˜çš„æ¬¡æ•°ï¼Œåœ¨è¿›è¡Œé¡µç½®æ¢æ—¶ï¼Œå°½é‡é€‰æ‹©æœ€è¿‘æ²¡æœ‰è¢«ä¿®æ”¹è¿‡çš„é¡µã€‚ 5) ä¿æŠ¤ä½ï¼šç”¨äºæ ‡è¯†é¡µçš„è®¿é—®æƒé™ï¼Œæ¯”å¦‚ï¼Œè¯¥ä½å€¼ä¸º1ï¼Œè¡¨ç¤ºé¡µæ˜¯æ—¢å¯è¯»åˆå¯å†™çš„ï¼›è¯¥ä½ä¸º0ï¼Œè¡¨ç¤ºé¡µæ˜¯åªè¯»çš„ã€‚ 2. ç¼ºé¡µå¼‚å¸¸æœºæ„ ç¼ºé¡µå¼‚å¸¸æœºæ„çš„ä¸»è¦ä½œç”¨æ˜¯åœ¨è®¿é—®å†…å­˜è¿‡ç¨‹ä¸­å‘ç°ç¼ºé¡µæ—¶äº§ç”Ÿç¼ºé¡µå¼‚å¸¸ä¿¡å·ï¼Œä½¿CPä¸­æ–­å½“å‰æ§åˆ¶æµçš„æ‰§è¡Œï¼Œè½¬å»æ‰§è¡Œæ“ä½œç³»ç»Ÿçš„ç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºï¼Œå®Œæˆè¯·æ±‚è°ƒé¡µã€‚å…·ä½“è¿‡ç¨‹ å¦‚ä¸‹ã€‚ 1) åˆ†é¡µç¡¬ä»¶é€šè¿‡é¡µè¡¨å®Œæˆé€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„æ—¶ï¼Œé€šè¿‡æ£€æŸ¥é¡µè¡¨ä¸­çš„çŠ¶æ€ä½Pï¼Œåˆ¤æ–­å½“å‰è¢«è®¿é—®çš„é¡µæ˜¯å¦åœ¨å†…å­˜ä¸­ã€‚å¦‚æœä¸åœ¨ï¼Œåˆ™äº§ç”Ÿç¼ºé¡µå¼‚å¸¸ä¿¡å·ã€‚ 2) æ‰§è¡Œæ“ä½œç³»ç»Ÿçš„ç¼ºé¡µå¼‚å¸¸å¤„ç†è¿‡ç¨‹ã€‚å…ˆåœ¨å†…å­˜ä¸­ä¸ºè¯·æ±‚è°ƒå…¥çš„é¡µæ‰¾ä¸€ä¸ªç©ºé—²é¡µæ¡†ã€‚ç„¶åï¼Œè°ƒåº¦ç£ç›˜æ“ä½œï¼ŒæŠŠéœ€è¦çš„é¡µè£…å…¥æ‰¾åˆ°çš„ç©ºé—²é¡µæ¡†ä¸­ã€‚ 3) ä¿®æ”¹é¡µè¡¨ï¼Œæ›´æ–°å·²ç»è°ƒå…¥é¡µçš„å­˜åœ¨ä½ã€åœ¨å†…å­˜ä¸­çš„é¡µæ¡†å·ã€è®¿é—®ä½å’Œä¿æŠ¤ä½ç­‰å­—æ®µçš„å€¼ã€‚ 4) é‡æ–°å¼€å§‹æ‰§è¡Œå› ç¼ºé¡µè€Œè¢«ä¸­æ–­çš„æŒ‡ä»¤ã€‚ ç¼ºé¡µå¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œç³»ç»Ÿä¿å­˜äº†è¢«ä¸­æ–­çš„è¿›ç¨‹çŠ¶æ€ï¼ŒåŒ…æ‹¬å¯„å­˜å™¨å’Œç¨‹åºè®¡æ•°å™¨çš„å†…å®¹ã€‚æ‰€ä»¥ï¼Œç¼ºé¡µå¼‚å¸¸å¤„ç†å®Œæˆè¿”å›æ—¶ï¼Œå¯ä»¥æŒ‰ç…§ä¸ä¸­æ–­å‰å®Œå…¨ç›¸åŒçš„ä½ç½®å’Œåœ°å€é‡æ–°å¼€å§‹æ‰§è¡Œè¿›ç¨‹ã€‚ ç”±äºå•æ¡æŒ‡ä»¤å¯èƒ½æ¶‰åŠå¤šä¸ªä¸åŒçš„é¡µï¼Œæ‰€ä»¥ï¼Œä»ç†è®ºä¸Šè¯´ï¼Œæ‰§è¡Œå•æ¡æŒ‡ä»¤çš„è¿‡ç¨‹ä¸­å¯èƒ½å‘ç”Ÿå¤šæ¬¡ç¼ºé¡µå¼‚å¸¸ã€‚ä¾‹å¦‚æŒ‡ä»¤ï¼šcopy A to Bï¼ŒæŒ‡ä»¤æœ¬èº«å¯èƒ½æ¶‰åŠä¸¤ä¸ªä¸åŒçš„é¡µï¼ŒAã€Bä¸¤ä¸ªå˜é‡ä¹Ÿå¯èƒ½åˆ†åˆ«æ¶‰åŠä¸åŒçš„é¡µï¼Œå¦‚å›¾4-43æ‰€ç¤ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœè¯¥æŒ‡ä»¤å’ŒAã€Bæ¶‰åŠçš„æ‰€æœ‰é¡µéƒ½ä¸åœ¨å†…å­˜ä¸­ï¼Œæ‰§è¡Œè¿™æ¡æŒ‡ä»¤å°±ä¼šå‘ç”Ÿ6æ¬¡ç¼ºé¡µå¼‚å¸¸ã€‚ 3. åœ°å€å˜æ¢ è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­çš„åœ°å€å˜åŒ–è¿‡ç¨‹å¦‚ä¸‹ 1) ç”±åˆ†é¡µåœ°å€å˜æ¢æœºæ„ä»é€»è¾‘åœ°å€ä¸­åˆ†ç¦»å‡ºé¡µå·å’Œé¡µå†…åç§»åœ°å€ã€‚ 2) ä»¥é¡µå·ä¸ºç´¢å¼•æŸ¥æ‰¾å¿«è¡¨ï¼Œè‹¥å¿«è¡¨ä¸­æœ‰è¯¥é¡µçš„é¡µè¡¨é¡¹ï¼Œåˆ™è¯»å‡ºé¡µæ¡†å·ï¼Œè®¡ç®—ç‰©ç†åœ°å€ã€‚ 3) è‹¥å¿«è¡¨ä¸­æ— è¯¥é¡µä¿¡æ¯ï¼Œè½¬åˆ°å†…å­˜é¡µè¡¨ä¸­æŸ¥æ‰¾ã€‚è‹¥é¡µè¡¨ä¸­çš„çŠ¶æ€ä½Pæ˜¾ç¤ºè¯¥é¡µå·²è°ƒå…¥å†…å­˜ï¼Œåˆ™ä»ç›¸åº”çš„é¡µè¡¨é¡¹è¯»å‡ºé¡µæ‰€åœ¨çš„é¡µæ¡†å·ï¼Œå¹¶è®¡ç®—ç‰©ç†åœ°å€ï¼Œç„¶åæŠŠè¯¥é¡µè¡¨é¡¹å†™å…¥å¿«è¡¨ã€‚ 4) è‹¥è¯¥é¡µå°šæœªè°ƒå…¥å†…å­˜ï¼Œåˆ™äº§ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼Œè¯·æ±‚æ“ä½œç³»ç»Ÿä»å¤–å­˜ä¸­æŠŠè¯¥é¡µè°ƒå…¥å†…å­˜ç„¶åä¿®æ”¹é¡µè¡¨ï¼Œé‡æ–°æ‰§è¡Œè¢«ä¸­æ–­çš„æŒ‡ä»¤ã€‚è¯¥è¿‡ç¨‹å¯ä»¥ç”¨å›¾4-44æ¥è¡¨ç¤ºã€‚ äºŒã€é¡µåˆ†é…ç­–ç•¥ æœ¬èŠ‚è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼š 1) åªè¦è£…å…¥è¿›ç¨‹çš„ä¸€éƒ¨åˆ†é¡µå°±å¯ä»¥è¿è¡Œè¿›ç¨‹ï¼Œé‚£ä¹ˆç©¶ç«Ÿä¸ºè¿›ç¨‹åˆ†é…å¤šå°‘ä¸ªé¡µæ¡†ï¼Œåœ¨å†…å­˜ä¸­è£…å…¥è¿›ç¨‹çš„å¤šå°‘ä¸ªé¡µå‘¢ï¼Ÿæˆ‘ä»¬é€šè¿‡é˜è¿°æœ€å°é¡µæ¡†æ•°ï¼Œä¹Ÿå°±æ˜¯è‡³å°‘è¦ä¸ºè¿›ç¨‹åˆ†é…å¤šå°‘ä¸ªé¡µæ¡†æ‰èƒ½ä½¿è¿›ç¨‹æ­£å¸¸è¿è¡Œï¼Œå›ç­”ä¸Šè¿°é—®é¢˜ã€‚ 2) æ“ä½œç³»ç»Ÿåœ¨éœ€è¦è¯·æ±‚è°ƒå…¥å¹¶è¿›è¡Œé¡µç½®æ¢æ—¶ï¼Œæ˜¯ä»ç¼ºé¡µè¿›ç¨‹æœ¬èº«çš„é¡µä¸­é€‰æ‹©æ·˜æ±°é¡µï¼Œè¿˜æ˜¯ä»ç³»ç»Ÿä¸­æ‰€æœ‰çš„è¿›ç¨‹é¡µä¸­é€‰æ‹©è¢«æ·˜æ±°çš„é¡µï¼Ÿ 3) é‡‡ç”¨ä»€ä¹ˆæ ·çš„ç®—æ³•ä¸ºä¸åŒçš„è¿›ç¨‹åˆ†é…é¡µæ¡†ï¼Ÿç³»ç»Ÿå¦‚ä½•åœ¨å¤šä¸ªè¿›ç¨‹ä¹‹é—´åˆç†åˆ†é…é¡µæ¡†æ•°ï¼Ÿ ä¸‹é¢å¯¹ä¸Šè¿°é—®é¢˜è¿›è¡Œè¯¦ç»†é˜è¿° 1. æœ€å°‘é¡µæ¡†æ•° æœ€å°‘é¡µæ¡†æ•°ï¼Œæ˜¯æŒ‡èƒ½ä¿è¯è¿›ç¨‹æ­£å¸¸è¿è¡Œæ‰€éœ€è¦çš„æœ€å°‘çš„é¡µæ¡†æ•°ã€‚å¦‚æœç³»ç»Ÿä¸ºè¿›ç¨‹åˆ†é…çš„é¡µæ¡†æ•°å°‘äºè¿™ä¸ªå€¼ï¼Œè¿›ç¨‹å°†æ— æ³•æ­£å¸¸è¿è¡Œã€‚ä¿è¯è¿›ç¨‹æ­£å¸¸è¿è¡Œæ‰€éœ€è¦çš„æœ€å°‘é¡µæ¡†æ•°ä¸è¿›ç¨‹çš„å¤§å°æ²¡æœ‰å…³ç³»ï¼Œå®ƒä¸è®¡ç®—æœºçš„ç¡¬ä»¶ç»“æ„æœ‰å…³ï¼Œå–å†³äºæŒ‡ä»¤çš„æ ¼å¼ã€åŠŸèƒ½å’Œå¯»å€æ–¹å¼ã€‚ ä¾‹å¦‚ï¼Œä¸€ä¸ªæ”¯æŒ16ä½æŒ‡ä»¤æ ¼å¼çš„æœºå™¨ï¼Œç”¨é«˜8ä½è¡¨ç¤ºæ“ä½œç ï¼Œä½8ä½è¡¨ç¤ºæ“ä½œæ•°ï¼Œå¦‚å›¾4-45æ‰€ç¤ºã€‚ å¦‚æœå†…å­˜å•å…ƒä»¥ä¸€ä¸ª8ä½å­—èŠ‚ä½œä¸ºä¸€ä¸ªç¼–å€å•å…ƒï¼Œå½“é‡‡ç”¨ç›´æ¥å¯»å€æ–¹å¼æ—¶ï¼Œä¸Šé¢çš„æŒ‡ä»¤æœ¬èº«å¯èƒ½æ¶‰åŠä¸¤ä¸ªé¡µï¼Œæ“ä½œæ•°éƒ¨åˆ†çš„åœ°å€å¯èƒ½æ¶‰åŠç¬¬ä¸‰ä¸ªé¡µï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œè‡³å°‘è¦ä¸ºè¿›ç¨‹åˆ†é…3ä¸ªé¡µæ¡†ï¼Œæ‰èƒ½ä¿è¯è¿›ç¨‹æ­£å¸¸æ‰§è¡Œã€‚ å¦‚æœé‡‡ç”¨é—´æ¥å¯»å€æ–¹å¼ï¼Œæ“ä½œæ•°éƒ¨åˆ†çš„åœ°å€æŒ‡å‘çš„å†…å­˜å•å…ƒä¸­å­˜æ”¾çš„æ˜¯å¦å¤–ä¸€ä¸ªåœ°å€ï¼Œè¿™æ—¶æŒ‡ä»¤æ¶‰åŠçš„é¡µæ•°æœ€å¤šå¯èƒ½è¾¾åˆ°4ä¸ªï¼ˆå‡è®¾åœ°å€å’Œæ•°æ®éƒ½åªå ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼Œå³æŒ‡ä»¤æœ¬èº«å¯èƒ½æ¶‰åŠä¸¤ä¸ªé¡µï¼Œæ“ä½œæ•°éƒ¨åˆ†çš„åœ°å€å¯èƒ½æ¶‰åŠç¬¬ä¸‰ä¸ªé¡µï¼Œæ“ä½œæ•°åœ°å€ä¸­å­˜æ”¾çš„å†…å­˜åœ°å€å¯èƒ½æ¶‰åŠç¬¬å››ä¸ªé¡µã€‚è¿™æ—¶ï¼Œç³»ç»Ÿå¿…é¡»ä¸ºè¿›ç¨‹åˆ†é…è‡³å°‘4ä¸ªé¡µæ¡†æ‰èƒ½ä¿è¯è¿›ç¨‹æ­£å¸¸æ‰§è¡Œã€‚å› ä¸ºç¼ºé¡µå¼‚å¸¸å‘ç”Ÿåœ¨æ‰§è¡ŒæŒ‡ä»¤çš„è¿‡ç¨‹ä¸­ï¼Œç¼ºé¡µå¼‚å¸¸å¤„ç†å®Œæ¯•ï¼Œè°ƒå…¥æ‰€ç¼ºé¡µåï¼Œè¿›ç¨‹è¦é‡æ–°æ‰§è¡ŒåŸæ¥è¢«ä¸­æ–­çš„æŒ‡ä»¤ã€‚å› æ­¤ï¼Œå¿…é¡»ä¿è¯è¿™æ¡æŒ‡ä»¤æ¶‰åŠçš„å…¨éƒ¨é¡µéƒ½åœ¨ç‰©ç†å†…å­˜ä¸­ï¼Œè¯¥æŒ‡ä»¤æ‰èƒ½è¢«é¡ºåˆ©æ‰§è¡Œå®Œæ¯•ã€‚ä¸ºäº†ä¿è¯è¿›ç¨‹é¡ºåˆ©æ‰§è¡Œï¼Œæ“ä½œç³»ç»Ÿä¸ºè¿›ç¨‹åˆ†é…çš„åˆå§‹é¡µæ•°åº”è¯¥å¤§äºæˆ–ç­‰äºæœ€å°‘é¡µæ¡†æ•°ã€‚ 2. é¡µåˆ†é…å’Œç½®æ¢ç­–ç•¥ åœ¨è¯·æ±‚åˆ†é¡µç³»ç»Ÿä¸­ï¼Œä»åˆ†é…ç»™è¿›ç¨‹çš„é¡µæ¡†æ•°é‡ä¸Šæ¥çœ‹ï¼Œå¯ä»¥é‡‡ç”¨å›ºå®šåˆ†é…å’Œå¯å˜åˆ†é…ç­–ç•¥ã€‚å›ºå®šåˆ†é…ç­–ç•¥æ˜¯æŒ‡åœ¨è¿›ç¨‹ä»åˆ›å»ºåˆ°æ’¤é”€çš„è¿‡ç¨‹ä¸­ï¼Œä¸ºè¿›ç¨‹åˆ†é…çš„é¡µæ¡†æ•°ä¿æŒä¸å˜ï¼Œè€Œå¯å˜åˆ†é…æ˜¯æŒ‡ä¸ºè¿›ç¨‹åˆ†é…çš„é¡µæ¡†æ•°æ˜¯å¯å˜çš„ã€‚ä»é€‰æ‹©æ·˜æ±°é¡µçš„å€™é€‰é¡µæ˜¯è¯·æ±‚è°ƒå…¥é¡µçš„è¿›ç¨‹é¡µè¿˜æ˜¯ç³»ç»Ÿä¸­çš„æ‰€æœ‰ç”¨æˆ·è¿›ç¨‹é¡µæ¥çœ‹ï¼Œå¯ä»¥é‡‡ç”¨å±€éƒ¨ç½®æ¢å’Œå…¨å±€ç½®æ¢ä¸¤ç§ç­–ç•¥ã€‚å±€éƒ¨ç½®æ¢æ˜¯æŒ‡å‘ç”Ÿç½®æ¢æ—¶ï¼Œåªä»è¯·æ±‚è°ƒé¡µè¿›ç¨‹æœ¬èº«çš„å†…å­˜é¡µä¸­é€‰æ‹©ä¸€ä¸ªè¢«æ·˜æ±°çš„é¡µï¼Œä»¥è…¾å‡ºå†…å­˜é¡µæ¡†ï¼Œè£…å…¥è¯·æ±‚è°ƒå…¥çš„é¡µã€‚å…¨å±€ç½®æ¢æ˜¯æŒ‡ç½®æ¢å‘ç”Ÿæ—¶ï¼Œä»ç³»ç»Ÿä¸­æ‰€æœ‰è¿›ç¨‹çš„å†…å­˜é¡µä¸­é€‰æ‹©è¢«æ·˜æ±°çš„é¡µã€‚å›ºå®šåˆ†é…å’Œå¯å˜åˆ†é…ç­–ç•¥ã€å±€éƒ¨ç½®æ¢å’Œå…¨å±€ç½®æ¢ä¸¤ç§ç­–ç•¥åœ¨å®é™…ç³»ç»Ÿä¸­å¯ä»¥ç»„åˆæˆä»¥ä¸‹3ç§é¡µåˆ†é…å’Œç½®æ¢ç­–ç•¥ã€‚ (1) å›ºå®šåˆ†é…å±€éƒ¨ç½®æ¢ åœ¨è¿›ç¨‹åˆ›å»ºæ—¶ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€å®šæ•°é‡çš„é¡µæ¡†ï¼Œåœ¨è¿›ç¨‹è¿è¡ŒæœŸé—´ï¼Œè¿›ç¨‹æ‹¥æœ‰çš„é¡µæ¡†æ•°ä¸å†æ”¹å˜ã€‚å½“è¿›ç¨‹å‘ç”Ÿç¼ºé¡µæ—¶ï¼Œç³»ç»Ÿä»è¯¥è¿›ç¨‹åœ¨å†…å­˜ä¸­çš„é¡µä¸­é€‰æ‹©ä¸€é¡µæ¢å‡ºï¼Œç„¶åå†è°ƒå…¥è¯·æ±‚çš„é¡µï¼Œä»¥ä¿è¯åˆ†é…ç»™è¯¥è¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¿æŒä¸å˜ã€‚ (2) å¯å˜åˆ†é…å…¨å±€ç½®æ¢ è¿™æ˜¯åœ¨æ“ä½œç³»ç»Ÿä¸­è¢«å¹¿æ³›ä½¿ç”¨çš„ç­–ç•¥ã€‚åœ¨é‡‡ç”¨è¿™ç§ç­–ç•¥æ—¶ï¼Œå…ˆä¸ºç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿›ç¨‹åˆ†é…ä¸€å®šæ•°é‡çš„é¡µæ¡†ï¼ŒåŒæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¿æŒä¸€ä¸ªç©ºé—²é¡µæ¡†é˜Ÿåˆ—ã€‚å½“æŸè¿›ç¨‹å‘ç”Ÿç¼ºé¡µæ—¶ï¼Œç”±ç³»ç»Ÿä» ç©ºé—²é¡µæ¡†é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªé¡µæ¡†åˆ†é…ç»™è¯¥è¿›ç¨‹ï¼Œå¹¶å°†æ¬²è°ƒå…¥çš„ç¼ºé¡µè£…å…¥å…¶ä¸­ã€‚ä»»ä½•äº§ç”Ÿç¼ºé¡µçš„è¿›ç¨‹éƒ½å¯ä»¥ç”±ç³»ç»Ÿè·å¾—æ–°çš„é¡µæ¡†ï¼Œä»¥å¢åŠ æœ¬è¿›ç¨‹åœ¨ç‰©ç†å†…å­˜ä¸­çš„é¡µæ•°ã€‚å½“ç³»ç»Ÿï¼Œæ€»ç©ºé—²é¡µæ¡†æ•°å°äºä¸€ä¸ªè§„å®šçš„é˜€å€¼æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šä»å†…å­˜ä¸­é€‰æ‹©ä¸€äº›é¡µè°ƒå‡ºï¼Œä»¥å¢åŠ ç³»ç»Ÿçš„ç©ºé—²é¡µæ¡†æ•°ï¼Œè°ƒå‡ºçš„é¡µå¯èƒ½æ˜¯ç³»ç»Ÿä¸­ä»»ä½•ä¸€ä¸ªè¿›ç¨‹çš„é¡µã€‚ (3) å¯å˜åˆ†é…å±€éƒ¨ç½®æ¢ è¿›ç¨‹åˆ›å»ºæ—¶ï¼Œä¸ºè¿›ç¨‹åˆ†é…ä¸€å®šæ•°ç›®çš„é¡µæ¡†ã€‚å½“è¿›ç¨‹å‘ç”Ÿç¼ºé¡µæ—¶ï¼Œåªå…è®¸ä»è¯¥è¿›ç¨‹åœ¨å†…å­˜ä¸­çš„é¡µä¸­é€‰å‡ºä¸€é¡µæ¢å‡ºã€‚åªæœ‰å½“è¿›ç¨‹é¢‘ç¹å‘ç”Ÿç¼ºé¡µæ—¶ï¼Œæ“ä½œç³»ç»Ÿæ‰ä¼šä¸ºè¯¥è¿›ç¨‹è¿½åŠ é¡µæ¡†ï¼Œä»¥è£…å…¥æ›´å¤šçš„è¿›ç¨‹é¡µï¼Œç›´åˆ°è¯¥è¿›ç¨‹çš„ç¼ºé¡µç‡é™ä½åˆ°é€‚å½“ç¨‹åº¦ã€‚åä¹‹ï¼Œè‹¥ä¸€ä¸ªè¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­çš„ç¼ºé¡µç‡ç‰¹åˆ«ä½ï¼Œåˆ™å¯åœ¨ä¸å¼•èµ·è¿›ç¨‹ç¼ºé¡µç‡æ˜æ˜¾å¢åŠ çš„å‰æä¸‹ï¼Œé€‚å½“å‡å°‘åˆ†é…ç»™è¯¥è¿›ç¨‹çš„é¡µæ¡†æ•°ã€‚ 3. åˆ†é…ç®—æ³• æ“ä½œç³»ç»Ÿä¸ºè¿›ç¨‹åˆ†é…çš„é¡µæ¡†æ•°é€šå¸¸éƒ½æ˜¯å¤§äºæœ€å°‘é¡µæ¡†æ•°çš„ï¼Œç©¶ç«Ÿä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…å¤šå°‘ä¸ªé¡µæ¡†ï¼Œå¯ä»¥é€šè¿‡æ‰§è¡Œé¡µæ¡†çš„åˆ†é…ç®—æ³•æ¥ç¡®å®šã€‚å¯é‡‡ç”¨çš„é¡µæ¡†åˆ†é…ç®—æ³•å¦‚ä¸‹ã€‚ (1) å¹³å‡åˆ†é…ç®—æ³• é‡‡ç”¨å¹³å‡åˆ†é…ç®—æ³•ï¼Œå¦‚æœç³»ç»Ÿä¸­æœ‰nä¸ªè¿›ç¨‹ï¼Œmä¸ªå¯ä¾›åˆ†é…çš„å†…å­˜é¡µæ¡†ï¼Œåˆ™ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…INT[m/n]ä¸ªé¡µæ¡†ï¼Œå…¶ä½™çš„MOD[m/n]ä¸ªé¡µæ¡†å¯ä»¥æ”¾å…¥ç©ºé—²é¡µæ¡†ç¼“å†²æ± ä¸­ã€‚ä¾‹å¦‚ï¼Œç³»ç»Ÿä¸­æœ‰26ä¸ªç©ºé—²é¡µæ¡†ï¼Œæœ‰3ä¸ªè¿›ç¨‹ï¼Œé‚£ä¹ˆä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…8ä¸ªé¡µæ¡†ï¼Œå³å…±ä¸º3ä¸ªè¿›ç¨‹åˆ†é…24ä¸ªé¡µæ¡†ï¼Œå‰©ä¸‹çš„2ä¸ªé¡µæ¡†å¯ä»¥ä½œä¸ºç³»ç»Ÿå¯ç”¨çš„ç©ºé—²é¡µæ¡†æ”¾åœ¨ç©ºé—²é¡µæ¡†ç¼“å†²æ± ä¸­ã€‚ (2) æŒ‰æ¯”ä¾‹åˆ†é…ç®—æ³• é‡‡ç”¨å¹³å‡åˆ†é…ç®—æ³•ä¸ºè¿›ç¨‹åˆ†é…é¡µæ¡†çš„ç¼ºç‚¹æ˜¯ç®—æ³•ä¸è€ƒè™‘è¿›ç¨‹è§„æ¨¡ï¼Œå¯èƒ½ä½¿å¤§è¿›ç¨‹åˆ†é…åˆ°çš„é¡µæ¡†ä¸å°è¿›ç¨‹ä¸€æ ·å¤šã€‚å¤§è¿›ç¨‹èƒ½è¿›å…¥å†…å­˜çš„é¡µæ•°å æœ¬è¿›ç¨‹é¡µæ€»æ•°çš„æ¯”ä¾‹è¿œè¿œå°äºå°è¿›ç¨‹ï¼Œå¤§è¿›ç¨‹å¯èƒ½å› æ­¤é¢‘ç¹ç¼ºé¡µã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨æŒ‰æ¯”ä¾‹åˆ†é…çš„ç®—æ³•ã€‚ ä¸ºè¿›ç¨‹åˆ†é…çš„é¡µæ¡†æ•°=è¿›ç¨‹é¡µæ•°/æ‰€æœ‰è¿›ç¨‹é¡µæ•°çš„æ€»å’ŒÃ—é¡µæ¡†æ•°ã€‚ ä¾‹4-10ï¼šåœ¨ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´æŒ‰æ¯”ä¾‹åˆ†é…40ä¸ªé¡µæ¡†ï¼Œè¿›ç¨‹p1å¤§å°ä¸º80é¡µï¼Œå¦ä¸€ä¸ªè¿›ç¨‹p2å¤§å°ä¸º240é¡µï¼Œåˆ™ä¸ºp1åˆ†é…10ä¸ªé¡µæ¡†ï¼Œä¸ºp2åˆ†é…30ä¸ªé¡µæ¡†ã€‚è®¡ç®—å¼å¦‚ä¸‹ ä¸ºp1åˆ†é…çš„é¡µæ¡†æ•°=80/(80+240)Ã—40=10ã€‚ ä¸ºp2åˆ†é…çš„é¡µæ¡†æ•°=240/(80+240)Ã—40=30ã€‚ (3) è€ƒè™‘ä¼˜å…ˆæƒçš„åˆ†é…ç®—æ³•ã€‚ è¿™ç§åˆ†é…ç®—æ³•çš„æ€æƒ³æ˜¯ä¸ºä¼˜å…ˆæƒé«˜çš„è¿›ç¨‹åˆ†é…è¾ƒå¤šçš„é¡µæ¡†æ•°ï¼Œä¸ºä¼˜å…ˆæƒä½çš„è¿›ç¨‹åˆ†é…è¾ƒå°‘çš„é¡µæ¡†æ•°ã€‚ ä¸‰ã€é¡µè°ƒå…¥ç­–ç•¥ å®ç°è¯·æ±‚åˆ†é¡µçš„è™šæ‹Ÿå­˜å‚¨ç³»ç»Ÿï¼Œè¿˜éœ€è¦è§£å†³ç³»ç»Ÿåº”åœ¨ä½•æ—¶ã€ä»ä½•å¤„è°ƒå…¥æ‰€éœ€é¡µçš„é—®é¢˜ã€‚å½“ç³»ç»Ÿäº§ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼Œè°ƒå…¥è¯·æ±‚é¡µçš„åŒæ—¶å¯ä»¥åªæŠŠè¯¥é¡µè°ƒå…¥å†…å­˜ï¼Œä¹Ÿå¯ä»¥åœ¨è°ƒå…¥è¯¥é¡µçš„åŒæ—¶ï¼ŒæŠŠä¸è¯¥é¡µç›¸é‚»çš„é¡µä¹Ÿè°ƒå…¥å†…å­˜ã€‚å¤–å­˜ä¸­çš„é¡µå¯ä»¥å­˜æ”¾äºå¯¹æ¢åŒºï¼Œä¹Ÿå¯èƒ½åœ¨æ–‡ä»¶åŒºã€‚ 1. ä½•æ—¶è°ƒå…¥é¡µ ç³»ç»Ÿå¯ä»¥è®¾è®¡æˆåªæœ‰åœ¨è¿›ç¨‹éœ€è¦æ—¶æ‰å°†é¡µè°ƒå…¥å†…å­˜ã€‚åœ¨ä¸€ç§æç«¯çš„æƒ…å†µä¸‹ï¼Œè¿›ç¨‹çš„æ‰€æœ‰é¡µéƒ½ä¸åœ¨å†…å­˜ä¸­å°±å¼€å§‹æ‰§è¡Œè¿›ç¨‹ã€‚å½“æ“ä½œç³»ç»Ÿå°†æŒ‡ä»¤æŒ‡é’ˆæŒ‡å‘è¿›ç¨‹çš„ç¬¬ä¸€æ¡æŒ‡ä»¤æ—¶ï¼Œç”±äºæ‰€åœ¨çš„é¡µä¸åœ¨å†…å­˜ä¸­ï¼Œç«‹å³äº§ç”Ÿç¼ºé¡µå¼‚å¸¸ã€‚å½“å®Œæˆç¼ºé¡µå¼‚å¸¸å¤„ç†ï¼ŒæŒ‡ä»¤æ‰€åœ¨çš„é¡µè°ƒå…¥å†…å­˜åï¼Œè¿›ç¨‹ç»§ç»­æ‰§è¡Œï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­ä¸æ–­å‘ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼Œå¹¶ä¸æ–­å°†æ‰€ç¼ºé¡µè°ƒäººå†…å­˜ã€‚å½“è°ƒå…¥è¶³å¤Ÿå¤šçš„é¡µåï¼Œå¤šæ•°éœ€è¦çš„é¡µéƒ½åœ¨å†…å­˜ä¸­äº†ï¼Œè¿›ç¨‹æ‰§è¡Œå°†ä¸å†å‡ºç°ç¼ºé¡µã€‚è¿™ç§ç­–ç•¥æœ‰åˆ©äºæé«˜å†…å­˜çš„ åˆ©ç”¨ç‡ï¼Œä½†æ˜¯å¯¹ç³»ç»Ÿçš„æ—¶é—´æ€§èƒ½ä¸åˆ©ã€‚ å¤§å¤šæ•°ç³»ç»Ÿéƒ½é‡‡ç”¨é¢„å…ˆè°ƒå…¥é¡µçš„ç­–ç•¥ï¼Œå°†é¢„è®¡ä¸ä¹…ä¹‹åä¼šè¢«è®¿é—®çš„é¡µé¢„å…ˆè°ƒå…¥å†…å­˜ï¼Œè€Œä¸æ˜¯ç¼ºå“ªä¸€é¡µæ—¶å†è°ƒå…¥è¯¥é¡µã€‚åœ¨å®é™…ç³»ç»Ÿä¸­ï¼Œé€šå¸¸æ˜¯åœ¨è°ƒå…¥ç¼ºé¡µæ—¶ï¼ŒæŠŠä¸æ‰€ç¼ºé¡µç›¸é‚»çš„è‹¥å¹²é¡µä¹Ÿè°ƒå…¥å†…å­˜ã€‚ 2. ä»ä½•å¤„è°ƒå…¥é¡µ (1) ä»å¯¹æ¢åŒºè°ƒå…¥ å½“ç³»ç»Ÿæ‹¥æœ‰è¶³å¤Ÿçš„å¯¹æ¢ç©ºé—´æ—¶ï¼Œè‹¥å‘ç”Ÿç¼ºé¡µè¯·æ±‚ï¼Œåˆ™ä»å¯¹æ¢åŒºè°ƒå…¥é¡µã€‚ä»å¯¹æ¢åŒºè°ƒå…¥é¡µæ¯”ä»æ–‡ä»¶åŒºè°ƒå…¥é¡µçš„é€Ÿåº¦å¿«ã€‚å¯¹æ¢åŒºä¸­çš„é¡µæ˜¯è¿›ç¨‹è¿è¡Œå‰ä»æ–‡ä»¶åŒºå¤åˆ¶åˆ°å¯¹æ¢åŒºçš„ã€‚ (2) UNIXæ–¹å¼ è¿›ç¨‹è¿è¡Œå‰ï¼Œä¸è¿›ç¨‹æœ‰å…³çš„ç¨‹åºä»£ç ã€æ•°æ®ç­‰éƒ½å­˜æ”¾åœ¨æ–‡ä»¶åŒºï¼Œæ‰€ä»¥ï¼Œæ²¡æœ‰è¢«è®¿é—®è¿‡çš„é¡µéƒ½ç›´æ¥ä»æ–‡ä»¶åŒºè°ƒå…¥ã€‚æ¢å‡ºé¡µéƒ½å­˜æ”¾åœ¨å¯¹æ¢åŒºï¼Œæ›¾ç»è¿è¡Œè¿‡è€Œåˆè¢«æ¢å‡ºçš„é¡µä»å¯¹æ¢åŒºä¸­è°ƒå…¥ã€‚å¯¹äºå¯ä»¥å…±äº«çš„é¡µï¼Œå¦‚æœå·²ç»ç”±äºå…¶ä»–è¿›ç¨‹çš„éœ€è¦è€Œè¢«è°ƒå…¥å†…å­˜ï¼Œå°±æ— éœ€å†æ¬¡ä»å¤–å­˜è°ƒå…¥ã€‚ 3. é¡µè°ƒå…¥è¿‡ç¨‹ è¯·æ±‚è°ƒé¡µå’Œé¡µè°ƒå…¥çš„è¿‡ç¨‹å¦‚å›¾4-46æ‰€ç¤ºã€‚ å››ã€é¡µç½®æ¢ç®—æ³• æœ¬å°èŠ‚ä¸»è¦é˜è¿°é¡µç½®æ¢ç®—æ³•ï¼ŒåŒæ—¶ä»‹ç»æŠ–åŠ¨åŠç¼ºé¡µç‡çš„ç›¸å…³é—®é¢˜ã€‚é¡µç½®æ¢ç®—æ³•æ˜¯ä»å†…å­˜é¡µä¸­é€‰æ‹©æ¢å‡ºé¡µçš„ç®—æ³•ã€‚ 1. æœ€ä½³ç½®æ¢ç®—æ³•å’Œå…ˆè¿›å…ˆå‡ºç½®æ¢ç®—æ³• (1) æœ€ä½³ç½®æ¢ç®—æ³•(Optimal page-Replacement Algorithm) æœ€ä½³ç½®æ¢ç®—æ³•æ˜¯Beladyäº1966å¹´æå‡ºçš„ä¸€ç§é¡µç½®æ¢ç®—æ³•ï¼Œè¯¥ç®—æ³•é€‰æ‹©ä»¥åæ°¸è¿œä¸ä¼šè¢«è®¿é—®çš„é¡µæˆ–è€…åœ¨æœªæ¥æœ€é•¿æ—¶é—´å†…ä¸å†è¢«è®¿é—®çš„é¡µä½œä¸ºæ¢å‡ºé¡µã€‚å› æ­¤ï¼Œè¯¥ç®—æ³•ä¸»è¦ç”¨äºç†è®ºç ”ç©¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœçŸ¥é“ä¸€ä¸ªç®—æ³•ä¸æ˜¯æœ€ä¼˜ï¼Œä½†æ˜¯ä¸æœ€ä¼˜ç›¸æ¯”æœ€åæƒ…å†µä¸‹çš„ç¼ºé¡µç‡æ¯”æœ€ä½³ç½®æ¢ç®—æ³•æœ€å¤šé«˜10%ï¼Œå¹³å‡ç¼ºé¡µç‡ä¸æœ€ä½³ç½®æ¢ç®—æ³•ç›¸æ¯”æœ€å¤šé«˜5%ï¼Œå¯ä»¥æ­¤è¯´æ˜è¯¥ç½®æ¢ç®—æ³•çš„æ€§èƒ½ã€‚ å‡å®šç³»ç»Ÿä¸ºæŸè¿›ç¨‹åˆ†é…äº†3ä¸ªé¡µæ¡†ï¼Œå¹¶è€ƒè™‘æœ‰ä»¥ä¸‹çš„é¡µå¼•ç”¨åºåˆ—ã€‚ 7,0,1,2,0,3,0,4,2,3,0,3,2,1,2,0,1,7,0,1 è¿›ç¨‹è¿è¡Œæ—¶ï¼Œå…ˆå°†7ã€0ã€1è¿™3ä¸ªé¡µè£…å…¥å†…å­˜ã€‚å½“è¿›ç¨‹è®¿é—®2å·é¡µæ—¶ï¼Œç”±äº2å·é¡µä¸åœ¨å†…å­˜ä¸­ï¼Œå°†äº§ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼Œè¯·æ±‚è°ƒå…¥2å·é¡µã€‚ç”±äº3ä¸ªé¡µæ¡†å·²æ»¡ï¼Œéœ€è¦é€‰æ‹©ä¸€ä¸ªæ¢å‡ºé¡µï¼Œä»¥è…¾å‡ºç©ºé—²é¡µæ¡†è£…å…¥2å·é¡µã€‚è‹¥æ“ä½œç³»ç»Ÿæ ¹æ®æœ€ä½³ç½®æ¢ç®—æ³•é€‰æ‹©è¢«æ¢å‡ºçš„é¡µï¼Œç”±äº7å·é¡µæ˜¯æœªæ¥æœ€é•¿æ—¶é—´ä¸ä¼šè¢«è®¿é—®çš„é¡µï¼Œæ‰€ä»¥é€‰æ‹©7å·é¡µä½œä¸ºæ¢å‡ºé¡µï¼Œç„¶åå°†2å·é¡µè°ƒå…¥å†…å­˜ã€‚è®¿é—®å®Œ2å·é¡µåï¼Œè®¿é—®0å·é¡µï¼Œç”±äºè¯¥é¡µå·²åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¸ä¼šäº§ç”Ÿç¼ºé¡µå¼‚å¸¸ã€‚å½“è¿›ç¨‹è®¿é—®3å·é¡µæ—¶ï¼Œå› ä¸º3å·é¡µä¸åœ¨å†…å­˜ä¸­ï¼Œåˆè¦äº§ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼Œå¹¶ä¸”ç”±äºå†…å­˜æ»¡ï¼Œåˆè¦æ‰§è¡Œé¡µç½®æ¢ç®—æ³•é€‰æ‹©æ¢å‡ºé¡µã€‚æ ¹æ®æœ€ä½³ç½®æ¢ç®—æ³•ï¼Œè¿™æ¬¡é€‰æ‹©2ã€0ã€1è¿™3ä¸ªé¡µä¸­çš„1å·é¡µæ¢å‡ºï¼Œå› ä¸º1å·é¡µæ˜¯æœªæ¥æœ€é•¿æ—¶é—´ä¸ä¼šè¢«è®¿é—®çš„é¡µï¼Œæ‰€ä»¥æ¢å‡º1å·é¡µï¼Œè°ƒå…¥3å·é¡µã€‚å›¾4-47æ‰€ç¤ºæ˜¯é‡‡ç”¨æœ€ä½³ç½®æ¢ç®—æ³•çš„ç½®æ¢å›¾ã€‚ç”±å›¾å¯è§ï¼Œåœ¨æ­¤ä¾‹ä¸­ï¼Œé‡‡ç”¨æœ€ä½³ç½®æ¢ç®—æ³•å‘ç”Ÿäº†6æ¬¡é¡µç½®æ¢ã€‚ (2) å…ˆè¿›å…ˆå‡ºé¡µç½®æ¢ç®—æ³•(First In First Out,FIFO) FIFOæ˜¯æœ€ç®€å•çš„é¡µç½®æ¢ç®—æ³•ã€‚å®ç°è¿™ç§ç®—æ³•çš„ä¸€ç§æ–¹å¼æ˜¯ä¸ºæ¯ä¸ªé¡µè®°å½•è¯¥é¡µè°ƒå…¥å†…å­˜çš„æ—¶é—´ï¼Œå½“é€‰æ‹©æ¢å‡ºé¡µæ—¶ï¼Œé€‰æ‹©è¿›å…¥å†…å­˜æ—¶é—´æœ€æ—©çš„é¡µã€‚æœ€ç®€å•çš„å®ç°æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªFIFOçš„é˜Ÿåˆ—æ¥ç®¡ç†å†…å­˜ä¸­çš„æ‰€æœ‰é¡µï¼Œé€‰æ‹©é˜Ÿé¦–çš„é¡µä½œä¸ºæ¢å‡ºé¡µã€‚æ–°è°ƒå…¥çš„é¡µè¢«åŠ å…¥åˆ°é˜Ÿå°¾ã€‚ FIFOç®—æ³•å®ç°ç®€å•ï¼Œä½†æ˜¯æ•ˆç‡è¾ƒä½ï¼Œä¼šå¯¼è‡´è¾ƒé«˜çš„ç¼ºé¡µç‡ã€‚å› ä¸ºFIFOç®—æ³•ä¸è€ƒè™‘é¡µè¢«å¼•ç”¨çš„é¢‘ç¹ç¨‹åº¦ï¼Œä¾‹å¦‚æœ‰çš„é¡µåˆšè¢«æ¢å‡ºï¼Œå¯èƒ½ç«‹åˆ»åˆè¦è¢«è®¿é—®ã€‚åœ¨è¿›ç¨‹ä¸­æœ‰äº›é¡µç»å¸¸è¢«è®¿é—®ï¼Œå¦‚åŒ…å«å…¨å±€å˜é‡ã€å¸¸ç”¨å‡½æ•°ç­‰çš„é¡µï¼ŒFIFOç®—æ³•ä¸èƒ½ä¿è¯è¿™äº›ç»å¸¸è¢«è®¿é—®çš„é¡µä¸è¢«æ¢å‡ºã€‚ ä»ç„¶é‡‡ç”¨ä¸Šé¢çš„ä¾‹å­æ¥è¯´æ˜é‡‡ç”¨FIFOç®—æ³•è¿›è¡Œé¡µç½®æ¢çš„è¿‡ç¨‹ã€‚å¦‚å›¾4-48æ‰€ç¤ºï¼Œå½“è¿›ç¨‹ç¬¬ä¸€æ¬¡è®¿é—®2å·é¡µæ—¶ï¼Œå°†æŠŠ7å·é¡µæ¢å‡ºï¼Œå› ä¸ºå®ƒæ˜¯æœ€æ—©è¢«è°ƒå…¥å†…å­˜çš„ã€‚è®¿é—®0å·é¡µæ—¶ï¼Œå› ä¸º0å·é¡µå·²ç»åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¸ä¼šäº§ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼Œä¹Ÿä¸ä¼šå‘ç”Ÿé¡µç½®æ¢ã€‚å½“ç¬¬ä¸€æ¬¡è®¿é—®3å·é¡µæ—¶ï¼Œå› ä¸ºå†…å­˜ä¸­çš„3ä¸ªé¡µ2ã€0ã€1ä¸­ï¼Œ0å·é¡µæ˜¯æœ€æ—©è¢«è°ƒå…¥å†…å­˜ä¸­çš„ï¼Œæ‰€ä»¥é€‰æ‹©0å·é¡µä½œä¸ºæ·˜æ±°é¡µã€‚ç”±å›¾4-48å¯è§ï¼Œåœ¨è¯¥ä¾‹ä¸­ï¼Œåˆ©ç”¨FIFOç®—æ³•æ—¶ï¼Œè¿›è¡Œäº†12æ¬¡é¡µç½®æ¢ï¼Œæ¯”æœ€ä½³ç½®æ¢ç®—æ³•çš„ç½®æ¢æ¬¡æ•°é«˜ä¸€å€ã€‚ 2. æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨LRUç½®æ¢ç®—æ³• FIFOç®—æ³•å®ç°ç®€å•ï¼Œä½†æ˜¯å¯¼è‡´å¾ˆé«˜çš„ç¼ºé¡µç‡å’Œç½®æ¢æ¬¡æ•°ï¼Œæ€§èƒ½è¾ƒå·®ã€‚è€Œæœ€ä½³ç½®æ¢ç®—æ³•æœ‰æœ€ä½çš„é¡µç½®æ¢æ¬¡æ•°ï¼Œæ€§èƒ½å¾ˆå¥½ï¼Œå´éš¾ä»¥å®ç°ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯•å›¾ç”¨â€œæœ€è¿‘çš„å†å²â€æ¥é¢„æµ‹â€œæœ€è¿‘çš„å°†æ¥â€ï¼Œå®ç°æœ€ä½³ç½®æ¢ç®—æ³•çš„è¿‘ä¼¼ç®—æ³•ã€‚LUç®—æ³•æ˜¯å¹¿æ³›ä½¿ç”¨çš„æ€§èƒ½è¾ƒå¥½çš„ç®—æ³•ã€‚ (1) LRU(Least Recently Used,LRU)ç®—æ³•çš„æè¿° LRUç½®æ¢ç®—æ³•æ˜¯é€‰æ‹©æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µæ¢å‡ºï¼ˆæœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µåœ¨æœ€è¿‘çš„å°†æ¥è¢«è®¿é—®çš„å¯èƒ½æ€§ä¹Ÿæ¯”è¾ƒå°)ã€‚è¯¥ç®—æ³•èµ‹äºæ¯ä¸ªé¡µä¸€ä¸ªè®¿é—®å­—æ®µï¼Œç”¨æ¥è®°å½•ä¸€ä¸ªé¡µè‡ªä¸Šæ¬¡è¢«è®¿é—®ä»¥æ¥æ‰€ç»å†çš„æ—¶é—´ã€‚å½“éœ€è¦æ·˜æ±°ä¸€ä¸ªé¡µæ—¶ï¼Œé€‰æ‹©ç°æœ‰é¡µä¸­tå€¼æœ€å¤§çš„é¡µæ¢å‡ºã€‚ ä»ç„¶é‡‡ç”¨ä¸Šé¢çš„ä¾‹å­æ¥è¯´æ˜é‡‡ç”¨LUç®—æ³•è¿›è¡Œé¡µç½®æ¢çš„è¿‡ç¨‹ã€‚å½“è¿›ç¨‹ç¬¬ä¸€æ¬¡è®¿é—®2å·é¡µæ—¶ï¼Œç”±äºå†…å­˜æ»¡ï¼Œéœ€è¦ä»7ã€0ã€1è¿™3ä¸ªé¡µä¸­é€‰æ‹©ä¸€é¡µæ¢å‡ºï¼Œç”±äº7å·é¡µæ˜¯æœ€è¿‘æœ€ä¹…æ²¡æœ‰è¢«è®¿é—®çš„é¡µï¼Œæ‰€ä»¥é€‰æ‹©7å·é¡µæ¢å‡ºã€‚å½“è¿›ç¨‹ç¬¬äºŒæ¬¡è®¿é—®0å·é¡µæ—¶ï¼Œç”±äº0å·é¡µå·²åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¸ä¼šå‘ç”Ÿç¼ºé¡µå¼‚å¸¸å’Œé¡µç½®æ¢ã€‚å½“è¿›ç¨‹ç¬¬ä¸€æ¬¡è®¿é—®3å·é¡µæ—¶ï¼Œå†…å­˜æ»¡ï¼Œè¦ä»åœ¨å†…å­˜ä¸­çš„3ä¸ªé¡µ2ã€0ã€1ä¸­é€‰æ‹©ä¸€ä¸ªé¡µæ¢å‡ºï¼Œç”±äº1å·é¡µæ˜¯è¿™3ä¸ªé¡µä¸­æœ€è¿‘æœ€ä¹…æ²¡æœ‰è¢«è®¿é—®çš„é¡µï¼Œæ‰€ä»¥æ¢å‡º1å·é¡µï¼Œä»¥è£…å…¥3å·é¡µã€‚ç”±å›¾4-49æ‰€ç¤ºçš„ç»“æœå¯è§ï¼Œå¯¹è¯¥è®¿é—®åºåˆ—é‡‡ç”¨LRUç½®æ¢ç®—æ³•å‘ç”Ÿäº†9æ¬¡ç½®æ¢ï¼Œæ€§èƒ½ä¼˜äºFIFOç®—æ³•ï¼Œä½†è¾ƒæœ€ä½³ç½®æ¢ç®—æ³•å·®ã€‚ (2)LRUç®—æ³•çš„å®ç° LRUç®—æ³•æ˜¯å¸¸ç”¨çš„é¡µç½®æ¢ç®—æ³•ï¼Œæ€§èƒ½è¾ƒå¥½ï¼Œä¹Ÿæœ‰è¾ƒå¥½çš„å®ç°æ–¹æ³•ã€‚å…¶å®ç°ä¸»è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€æ˜¯å†…å­˜ä¸­çš„å„ä¸ªé¡µå„æœ‰å¤šä¹…æ—¶é—´æœªè¢«è¿›ç¨‹è®¿é—®ï¼›äºŒæ˜¯å¦‚ä½•å¿«é€Ÿåœ°çŸ¥é“å“ªä¸€é¡µæ˜¯æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µã€‚å…¶å¯è¡Œçš„å®ç°æ–¹æ³•å¦‚ä¸‹ã€‚ 1) å¯„å­˜å™¨ã€‚ ä¸ºæ¯ä¸ªåœ¨å†…å­˜ä¸­çš„é¡µé…ç½®ä¸€ä¸ªç§»ä½å¯„å­˜å™¨ï¼Œå¯è¡¨ç¤ºä¸ºR=Rn-1...R2R1R0ã€‚å½“è¿›ç¨‹è®¿é—®æŸé¡µæ¡†æ—¶ï¼Œè¦å°†ç›¸åº”çš„å¯„å­˜å™¨çš„æœ€é«˜ä½ç½®æˆ1ã€‚æ­¤æ—¶ï¼Œæ¯éš”ä¸€å®šæ—¶é—´å°†å¯„å­˜å™¨å³ç§»ä¸€ä½ã€‚å¦‚æœæŠŠä½å¯„å­˜å™¨çš„æ•°çœ‹ä½œæ˜¯ä¸€ä¸ªé¡µå¯¹åº”çš„æ•´æ•°ï¼Œé‚£ä¹ˆå…·æœ‰æœ€å°æ•°å€¼çš„å¯„å­˜å™¨æ‰€å¯¹åº”çš„é¡µå°±æ˜¯æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µã€‚å›¾4-50æ‰€ç¤ºçš„ä¾‹å­è¯´æ˜äº†ä¸€ä¸ªå…·æœ‰8ä¸ªé¡µçš„è¿›ç¨‹ï¼Œé€šè¿‡ä¸ºæ¯ä¸ªé¡µé…å¤‡ä¸€ä¸ª8ä½å¯„å­˜å™¨å®ç°LRUç®—æ³•çš„æƒ…å†µã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ3å·é¡µçš„8ä½å¯„å­˜å™¨å€¼æœ€å°ã€‚æ‰€ä»¥å‘ç”Ÿç¼ºé¡µã€éœ€è¦ç½®æ¢æ—¶ï¼Œé€‰æ‹©3å·é¡µæ¢å‡ºã€‚å›¾ä¸­çš„å®é¡µæ˜¯æŒ‡åœ¨å†…å­˜ä¸­çš„é¡µã€‚ 2) æ ˆã€‚ å¯åˆ©ç”¨ä¸€ä¸ªç‰¹æ®Šçš„æ ˆæ¥ä¿å­˜å½“å‰ä½¿ç”¨çš„å„ä¸ªé¡µçš„é¡µå·ã€‚æ¯å½“è¿›ç¨‹è®¿é—®æŸé¡µæ—¶ï¼Œä¾¿å°†è¯¥é¡µçš„é¡µå·ä»æ ˆä¸­ç§»å‡ºï¼Œå°†å®ƒå‹å…¥æ ˆé¡¶ã€‚å› æ­¤ï¼Œæ ˆé¡¶å§‹ç»ˆæ˜¯æœ€æ–°è¢«è®¿é—®é¡µçš„ç¼–å·ï¼Œè€Œæ ˆåº•åˆ™æ˜¯æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µå·ã€‚ å›¾4-51æ‰€ç¤ºçš„ä¾‹å­ä¸­ï¼Œé¡µè®¿é—®åºåˆ—ä¸º4,7,0,7,1,0,1,2,1,2,6ï¼Œåœ¨è®¿é—´6å·é¡µæ—¶å‘ç”Ÿç¼ºé¡µã€‚æ­¤æ—¶æ ˆåº•çš„é¡µä¸º4ï¼Œæ˜¯æœ€è¿‘æœ€ä¹…æ²¡æœ‰è¢«è®¿é—®çš„é¡µï¼Œå°†4å·é¡µæ¢å‡ºï¼Œè°ƒå…¥6å·é¡µã€‚ 3) è®¡æ•°å™¨ã€‚ ä¸ºæ¯ä¸ªé¡µè¡¨é¡¹å¢åŠ ä¸€ä¸ªæ—¶é—´å­—æ®µï¼Œå¹¶ä¸ºCPUå¢åŠ ä¸€ä¸ªé€»è¾‘æ—¶é’Ÿæˆ–è®¡æ•°å™¨ã€‚æ¯æ¬¡è®¿é—®å†…å­˜ä¸­çš„æŸä¸ªé¡µæ—¶ï¼Œå°±å¢åŠ è¿™ä¸ªé¡µå¯¹åº”çš„é¡µè¡¨é¡¹çš„æ—¶é—´å­—æ®µçš„å€¼ï¼Œæ¯æ¬¡ç½®æ¢æ—¶é€‰æ‹©æ—¶é—´å­—æ®µå€¼æœ€å°çš„é¡µä½œä¸ºæ¢å‡ºé¡µã€‚ 3. å…¶ä»–ç½®æ¢ç®—æ³• è®¡ç®—æœºç³»ç»Ÿè¦æä¾›è¶³å¤Ÿçš„ç¡¬ä»¶æ¥æ”¯æŒLRUç®—æ³•æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œè®¸å¤šç³»ç»Ÿåœ¨å®ç°æ—¶éƒ½é‡‡ç”¨LRUçš„è¿‘ä¼¼ç®—æ³•ï¼Œå¦‚é™„åŠ å¼•ç”¨ä½ç®—æ³•ã€ç®€å•Clokç®—æ³•å’Œæ”¹è¿›å‹Clokç®—æ³•ç­‰ã€‚ (1) é™„åŠ å¼•ç”¨ä½ç®—æ³• é‡‡ç”¨è¿™ç§ç®—æ³•æ—¶ï¼Œä¸ºæ¯ä¸ªå†…å­˜ä¸­çš„é¡µå¢åŠ ä¸€ä¸ª8ä½çš„å­—èŠ‚ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆå¦‚100ms)ï¼Œæ“ä½œç³»ç»ŸæŠŠæ¯ä¸ªé¡µè‡ªå·±çš„è®¿é—®ä½ï¼ˆè¯·æ±‚åˆ†é¡µç®¡ç†çš„é¡µè¡¨é¡¹ä¸­çš„Aå­—æ®µï¼‰ç§»åˆ°8å­—èŠ‚é™„åŠ å¼•ç”¨ä½çš„æœ€é«˜ä½ï¼Œå°†å…¶ä»–ä½å‘å³ç§»ï¼Œå¹¶æŠ›å¼ƒæœ€ä½ä½ã€‚è¿›è¡Œé¡µç½®æ¢æ—¶ï¼Œé€‰æ‹©é™„åŠ å¼•ç”¨ä½å€¼æœ€å°çš„é¡µæ¢å‡ºã€‚å› ä¸ºå…·æœ‰æœ€å°é™„åŠ å¼•ç”¨ä½å€¼çš„é¡µå¯èƒ½ä¸æ­¢ä¸€ä¸ªï¼Œæ—¢å¯ä»¥æ¢å‡ºæ‰€æœ‰è¿™äº›é¡µï¼Œä¹Ÿå¯ä»¥æŒ‰FIFOé€‰æ‹©éƒ¨åˆ†å…·æœ‰æœ€å°é™„åŠ å¼•ç”¨ä½å€¼çš„é¡µæ¢å‡ºã€‚ (2) ç®€å•Clockç½®æ¢ç®—æ³• åˆ©ç”¨ç®€å•Clokç®—æ³•æ—¶ï¼Œä¸ºæ¯ä¸€é¡µè®¾ç½®ä¸€ä½è®¿é—®ä½ï¼Œå†å°†å†…å­˜ä¸­çš„æ‰€æœ‰é¡µéƒ½é€šè¿‡é“¾æ¥æŒ‡é’ˆé“¾æ¥æˆä¸€ä¸ªå¾ªç¯é˜Ÿåˆ—ã€‚å½“æŸé¡µè¢«è®¿é—®æ—¶ï¼Œå…¶è®¿é—®ä½è¢«ç½®1ã€‚ç½®æ¢ç®—æ³•åœ¨é€‰æ‹©ä¸€é¡µæ¢å‡ºæ—¶ã€æŒ‰ç…§FIFOç®—æ³•ï¼Œæ£€æŸ¥å„é¡µçš„è®¿é—®ä½ã€‚å¦‚æœæ˜¯0ï¼Œå°±é€‰æ‹©è¯¥é¡µæ¢å‡ºï¼›è‹¥ä¸º1ï¼Œåˆ™é‡æ–°å°†å®ƒç½®Oï¼Œæš‚ä¸æ¢å‡ºè€Œç»™è¯¥é¡µç¬¬äºŒæ¬¡é©»ç•™å†…å­˜çš„æœºä¼šï¼Œå†æŒ‰ç…§FIFOç®—æ³•æ£€æŸ¥ä¸‹ä¸€ä¸ªé¡µã€‚ å½“æ£€æŸ¥åˆ°é˜Ÿåˆ—ä¸­çš„æœ€åä¸€ä¸ªé¡µæ—¶ï¼Œè‹¥å…¶è®¿é—®ä½ä»ä¸º1ï¼Œåˆ™å†è¿”å›åˆ°é˜Ÿé¦–å»é‡æ–°ä»ç¬¬ä¸€ä¸ªé¡µå¼€å§‹æ£€æŸ¥ã€‚ (3) æ”¹è¿›å‹Clockç®—æ³• ç®€å•Clockç®—æ³•åœ¨é€‰æ‹©ä¸€ä¸ªæ¢å‡ºé¡µæ—¶ï¼Œä¸è€ƒè™‘è¯¥é¡µè¢«ä¿®æ”¹çš„æƒ…å†µï¼Œè€Œé€‰æ‹©æœ€è¿‘æ—¢æ²¡æœ‰è¢«è®¿é—®è¿‡åˆæ²¡æœ‰è¢«ä¿®æ”¹è¿‡çš„é¡µæ¢å‡ºï¼Œèƒ½å¤§å¤§æé«˜é¡µç½®æ¢çš„æ•ˆç‡ã€‚åœ¨å°†ä¸€ä¸ªé¡µæ¢å‡ºæ—¶ï¼Œå¦‚æœè¯¥é¡µå·²è¢«ä¿®æ”¹è¿‡ï¼Œä¾¿åº”å°†å®ƒé‡æ–°å†™åˆ°ç£ç›˜ä¸Šï¼Œä½†å¦‚æœè¯¥é¡µæœªè¢«ä¿®æ”¹è¿‡ï¼Œåˆ™ä¸å¿…å°†å®ƒå†™å›ç£ç›˜ã€‚æ¢è€Œè¨€ä¹‹ï¼Œä¿®æ”¹è¿‡çš„é¡µåœ¨æ¢å‡ºæ—¶æ‰€ä»˜å‡ºçš„æ—¶é—´å¼€é”€å°†æ¯”æœªä¿®æ”¹è¿‡çš„é¡µå¼€é”€å¤§ã€‚åœ¨æ”¹è¿›å‹C1ockç®—æ³•ä¸­ï¼Œé™¤äº†å¿…é¡»è€ƒè™‘é¡µçš„ä½¿ç”¨æƒ…å†µå¤–ï¼Œè¿˜è€ƒè™‘äº†ç½®æ¢ä»£ä»·è¿™ä¸€å› ç´ ï¼Œè¿™æ ·é€‰æ‹©æ¢å‡ºé¡µæ—¶ï¼Œæ—¢è¦æ˜¯æœªä½¿ç”¨è¿‡çš„é¡µï¼Œåˆè¦æ˜¯æœªè¢«ä¿®æ”¹è¿‡çš„é¡µã€‚æŠŠåŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶çš„é¡µä½œä¸ºé¦–é€‰çš„æ·˜æ±°é¡µã€‚æ”¹è¿›å‹Clockç®—æ³•æè¿°å¦‚ä¸‹ã€‚ åœ¨è¯¥ç®—æ³•ä¸­ï¼Œç”±è®¿é—®ä½Aå’Œä¿®æ”¹ä½Må¯ä»¥ç»„åˆæˆä¸‹é¢4ç§ç±»å‹çš„é¡µã€‚ 1) ç¬¬1ç±»(A=0,M=0)ã€‚è¡¨ç¤ºè¯¥é¡µæœ€è¿‘æ—¢æœªè¢«è®¿é—®ï¼Œåˆæœªè¢«ä¿®æ”¹ï¼Œæ˜¯æœ€ä½³æ¢å‡ºé¡µã€‚ 2) ç¬¬2ç±»(A=0,M=1)ã€‚è¡¨ç¤ºè¯¥é¡µæœ€è¿‘æœªè¢«è®¿é—®ï¼Œä½†å·²è¢«ä¿®æ”¹ï¼Œå¹¶ä¸æ˜¯å¾ˆå¥½çš„æ¢å‡ºé¡µã€‚ 3) ç¬¬3ç±»(A=1,M=0)ã€‚æœ€è¿‘å·²è¢«è®¿é—®ï¼Œä½†æœªè¢«ä¿®æ”¹ï¼Œè¯¥é¡µæœ‰å¯èƒ½å†è¢«è®¿é—®ã€‚ 4) ç¬¬4ç±»(A=1,M=1)ã€‚æœ€è¿‘å·²è¢«è®¿é—®ä¸”è¢«ä¿®æ”¹ï¼Œè¯¥é¡µå¯èƒ½å†è¢«è®¿é—®ã€‚ æ”¹è¿›å‹Clokç½®æ¢ç®—æ³•å¯åˆ†ä¸ºä»¥ä¸‹3æ­¥ã€‚ 1) ä»æŒ‡é’ˆæ‰€æŒ‡ç¤ºçš„å½“å‰ä½ç½®å¼€å§‹ï¼Œæ‰«æå¾ªç¯é˜Ÿåˆ—ï¼Œå¯»æ‰¾A=0ä¸”M=0çš„ç¬¬ä¸€ç±»é¡µã€‚å°†æ‰€é‡åˆ°çš„ç¬¬ä¸€ä¸ªé¡µä½œä¸ºæ‰€é€‰ä¸­çš„æ¢å‡ºé¡µã€‚åœ¨ç¬¬ä¸€æ¬¡æ‰«ææœŸé—´ä¸æ”¹å˜è®¿é—®ä½Aã€‚ 2) å¦‚æœç¬¬ä¸€æ­¥å¤±è´¥ï¼Œå³éå†é¡µçš„é“¾è¡¨åæœªé‡åˆ°ç¬¬ä¸€ç±»é¡µï¼Œåˆ™å¼€å§‹ç¬¬äºŒè½®æ‰«æã€‚å¯»æ‰¾A=0ä¸”M=1çš„ç¬¬äºŒç±»é¡µï¼Œå°†æ‰€é‡åˆ°çš„ç¬¬ä¸€ä¸ªè¿™ç±»é¡µä½œä¸ºæ¢å‡ºé¡µã€‚åœ¨ç¬¬äºŒè½®æ‰«ææœŸé—´ï¼Œå°†æ‰€æœ‰ç»è¿‡çš„é¡µçš„è®¿é—®ä½Aç½®0ã€‚ 3) å¦‚æœç¬¬äºŒæ­¥ä¹Ÿå¤±è´¥ï¼Œå³æœªæ‰¾åˆ°ç¬¬äºŒç±»é¡µï¼Œåˆ™å°†æŒ‡é’ˆè¿”å›åˆ°å¼€å§‹çš„ä½ç½®ã€‚ç„¶åå†æ¬¡å¯»æ‰¾A=0ä¸”M=0çš„ç¬¬ä¸€ç±»é¡µï¼Œå¦‚æœä»å¤±è´¥ï¼Œå†å¯»æ‰¾A=0ä¸”M=1çš„é¡µï¼Œæ­¤æ—¶å°±ä¸€å®šèƒ½æ‰¾åˆ°è¢«æ¢å‡ºçš„é¡µã€‚ æ”¹è¿›å‹Clokç½®æ¢ç®—æ³•æœ€åæƒ…å†µä¸‹ï¼Œéœ€4æ¬¡æ‰«æé¡µé˜Ÿåˆ—ï¼Œæ‰èƒ½é€‰ä¸­è¢«æ¢å‡ºçš„é¡µã€‚ (4) æœ€å°‘ä½¿ç”¨ç½®æ¢ç®—æ³•(Least Frequently Used Page--Replacement Algorithm,LFU) è¿™ç§ç®—æ³•é€‰æ‹©æœ€è¿‘æ—¶æœŸå†…ä½¿ç”¨æ¬¡æ•°æœ€å°‘çš„é¡µä½œä¸ºæ·˜æ±°é¡µã€‚è¿™ç§ç®—æ³•ä¸ºæ¯ä¸ªé¡µä¿ç•™ä¸€ä¸ªç”¨äºè®°å½•é¡µè¢«è®¿é—®æ¬¡æ•°çš„è®¡æ•°å™¨ï¼Œæ¯æ¬¡é€‰æ‹©å…¶è®¿é—®è®¡æ•°å™¨å€¼æœ€å°çš„é¡µæ¢å‡ºã€‚è¿™ç§ç®—æ³•å¯èƒ½å­˜åœ¨çš„é—®é¢˜æ˜¯ï¼šæœ‰äº›é¡µåœ¨è¿›ç¨‹å¼€å§‹æ—¶è¢«è®¿é—®çš„æ¬¡æ•°å¾ˆå¤šï¼Œä½†ä»¥åè¿™äº›é¡µä¸å†è¢«è®¿é—®ï¼Œè¿™äº›é¡µä¸åº”è¯¥é•¿æ—¶é—´ç•™åœ¨å†…å­˜ä¸­ï¼Œè€Œåº”è¯¥åœ¨ä¸å†è¢«è®¿é—®æ—¶è¢«æ¢å‡ºã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ä¹‹ä¸€æ˜¯å®šæœŸåœ°å°†è®¡æ•°å™¨å³ç§»ï¼Œä»¥å½¢æˆæŒ‡æ•°è¡°å‡çš„å¹³å‡ä½¿ç”¨æ¬¡æ•°ã€‚ (5) é¡µç¼“å†²ç®—æ³• é¡µç¼“å†²ç®—æ³•é‡‡ç”¨FIFOç®—æ³•é€‰æ‹©æ¢å‡ºé¡µï¼Œå¹¶ä¸ºæ¢å‡ºé¡µå»ºç«‹ä¸¤ä¸ªé“¾è¡¨ï¼Œè¢«æ¢å‡ºçš„é¡µè¦æ”¾å…¥ä¸¤ä¸ªé“¾è¡¨ä¸­çš„ä¸€ä¸ªã€‚å¦‚æœé¡µæ²¡æœ‰è¢«ä¿®æ”¹è¿‡ï¼Œåˆ™å°†å…¶æ”¾å…¥ç©ºé—²é¡µé“¾è¡¨ä¸­ã€‚å¦‚æœé¡µè¢«ä¿®æ”¹è¿‡ï¼Œåˆ™å°†å…¶æ”¾å…¥å·²ä¿®æ”¹é¡µçš„é“¾è¡¨ä¸­ã€‚é¡µåœ¨å†…å­˜ä¸­å¹¶ä¸åšç‰©ç†ä¸Šçš„ç§»åŠ¨ï¼Œè€Œåªæ˜¯å°†é¡µè¡¨ä¸­çš„è¡¨é¡¹ç§»åˆ°ä¸Šè¿°ä¸¤ä¸ªé“¾è¡¨ä¹‹ä¸€ä¸­ã€‚ ç©ºé—²é¡µé“¾è¡¨å®é™…ä¸Šæ˜¯ä¸€ä¸ªç©ºé—²é¡µæ¡†é“¾è¡¨ï¼Œå…¶ä¸­çš„æ¯ä¸ªé¡µæ¡†éƒ½æ˜¯ç©ºé—²çš„ï¼Œå› æ­¤å¯ä»¥åœ¨å…¶ä¸­è£…å…¥ç¨‹åºæˆ–è€…æ•°æ®ã€‚å½“éœ€è¦è¯»å…¥ä¸€ä¸ªé¡µæ—¶ï¼Œä¾¿å¯åˆ©ç”¨ç©ºé—²é¡µæ¡†é“¾è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªé¡µæ¡†æ¥è£…å…¥è¯¥é¡µã€‚å½“æœ‰ä¸€ä¸ªæ²¡æœ‰è¢«ä¿®æ”¹çš„é¡µè¦æ¢å‡ºæ—¶ï¼Œå®é™…ä¸Šå¹¶ä¸å°†å®ƒæ¢å‡ºå†…å­˜ï¼Œè€Œæ˜¯æŠŠè¯¥é¡µæ‰€åœ¨çš„é¡µæ¡†æŒ‚åœ¨ç©ºé—²é¡µé“¾è¡¨çš„æœ«å°¾ã€‚åœ¨ç½®æ¢ä¸€ä¸ªå·²ä¿®æ”¹çš„é¡µæ—¶ï¼Œå°†å…¶æ‰€åœ¨çš„é¡µæ¡†æŒ‚åœ¨ä¿®æ”¹é¡µé“¾è¡¨çš„æœ«å°¾ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥ä½¿æ²¡æœ‰è¢«ä¿®æ”¹çš„é¡µå’Œå·²ç»è¢«ä¿®æ”¹çš„é¡µéƒ½ç•™åœ¨å†…å­˜ä¸­ã€‚å½“è¿›ç¨‹ä»¥åå†æ¬¡éœ€è¦è®¿é—®è¿™äº›é¡µæ—¶ï¼Œå°±ä¸ç”¨ä»ç£ç›˜è€Œåªéœ€ä»å†…å­˜ä¸­å†æ¬¡ä½¿è¿™äº›é¡µå›åˆ°è¿›ç¨‹åœ¨å†…å­˜çš„é©»ç•™é›†ä¸­ï¼Œä½¿è¿™äº›é¡µæ‰€åœ¨çš„é¡µæ¡†æˆä¸ºâ€œè¢«å ç”¨â€çŠ¶æ€å³å¯ï¼Œç”±æ­¤å‡å°äº†è¯·æ±‚è°ƒå…¥å’Œé¡µç½®æ¢çš„å¼€é”€ã€‚ å·²ä¿®æ”¹é¡µçš„é“¾è¡¨å‘¨æœŸæ€§åœ°æˆ–è€…å½“å·²ä¿®æ”¹é¡µçš„æ•°é‡è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶è¢«å»¶è¿Ÿå†™äººç£ç›˜ï¼Œå‡å°‘äº†æ¢ å‡ºæ—¶å†™ç£ç›˜çš„æ—¶é—´å¼€é”€ã€‚ äº”ã€è¯·æ±‚åˆ†é¡µç³»ç»Ÿçš„æ€§èƒ½åˆ†æ å‰é¢å·²ç»é˜è¿°äº†åŸºäºè¯·æ±‚åˆ†é¡µçš„å­˜å‚¨ç®¡ç†çš„åŸºæœ¬åŸç†ï¼Œåœ¨è®¾è®¡å’Œé€‰æ‹©è™šæ‹Ÿå­˜å‚¨ç®¡ç†çš„ç­–ç•¥å’Œç®—æ³•æ—¶ï¼Œä¸å¯é¿å…åœ°è¦è€ƒè™‘è®¿å­˜çš„æ€§èƒ½ã€‚è¯·æ±‚è°ƒå…¥å’Œç½®æ¢æŠ€æœ¯éƒ½æ˜¯ä»¥æ—¶é—´æ¢ç©ºé—´çš„æŠ€æœ¯ï¼Œå¦‚ä½•åœ¨åº”ç”¨è¿™ç§æŠ€æœ¯æ—¶å°½é‡æé«˜æ—¶é—´æ€§èƒ½æ˜¯åœ¨è®¾è®¡ç³»ç»Ÿæ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜ã€‚ 1. ç¼ºé¡µç‡å¯¹æœ‰æ•ˆè®¿é—®æ—¶é—´çš„å½±å“ è¿›ç¨‹æ‰§è¡Œä¸­è®¿å­˜å‘ç”Ÿç¼ºé¡µæ—¶ï¼Œéœ€è¦è¯·æ±‚ä»å¤–å­˜è°ƒå…¥ç¼ºé¡µã€‚å¦‚æœå†…å­˜ä¸­æ²¡æœ‰ç©ºé—²é¡µæ¡†ï¼Œè¿˜éœ€è¦è¿›è¡Œé¡µç½®æ¢ï¼Œè°ƒå…¥ç¼ºé¡µåï¼ŒæŒ‡ä»¤éœ€è¦é‡æ–°æ‰§è¡Œã€‚å› æ­¤ï¼Œä¸€æ—¦å‘ç”Ÿç¼ºé¡µï¼Œè¿›ç¨‹ä¼šå­˜åœ¨å› ä¸ºè®¿å­˜è€Œå¸¦æ¥çš„æ—¶é—´å»¶è¿Ÿã€‚ä¸‹é¢åˆ†æç¼ºé¡µç‡å¯¹æœ‰æ•ˆè®¿é—®æ—¶é—´çš„å½±å“ã€‚ æœ‰æ•ˆè®¿é—®æ—¶é—´æ˜¯æˆåŠŸè®¿å­˜æ‰€ç”¨çš„æ—¶é—´ã€‚å‡è®¾Pä¸ºç¼ºé¡µç‡ï¼Œmaä¸ºå­˜å‚¨å™¨è®¿é—®æ—¶é—´ã€‚è¿™é‡Œæ ¹æ®å®é™…ç³»ç»Ÿçš„å¯èƒ½æ€§ï¼Œå–ma=100 ns=0.1Î¼sã€‚ç¼ºé¡µå¼‚å¸¸æœåŠ¡æ—¶é—´ã€ç¼ºé¡µè¯»å…¥æ—¶é—´åŠè¿›ç¨‹é‡æ–°æ‰§è¡Œæ—¶é—´è¿‘ä¼¼åœ°å–25msæ˜¯åˆç†çš„ã€‚ç”±æ­¤ï¼š æœ‰æ•ˆè®¿é—®æ—¶é—´=ï¼ˆ1-P)Ã—ma+PÃ—ç¼ºé¡µå¼‚å¸¸æ—¶é—´ã€‚ ç¼ºé¡µå¼‚å¸¸æ—¶é—´=ç¼ºé¡µå¼‚å¸¸æœåŠ¡æ—¶é—´+ç¼ºé¡µè¯»äººæ—¶é—´+è¿›ç¨‹é‡æ–°æ‰§è¡Œæ—¶é—´â‰ˆ25ms(æ¯«ç§’)=25000Î¼s(å¾®ç§’) æ‰€ä»¥ï¼Œæœ‰æ•ˆè®¿é—®æ—¶é—´=0.1Ã—(1-P)+25000Ã—P=0.1+24999.9Ã—P ç”±ä¸Šå¼å¯è§ï¼Œæœ‰æ•ˆè®¿é—®æ—¶é—´æ­£æ¯”äºç¼ºé¡µç‡ã€‚ä¸‹é¢ä»¥å®ä¾‹æ•°æ®è¯´æ˜ç¼ºé¡µç‡å¯¹æœ‰æ•ˆè®¿é—®æ—¶é—´çš„å½±å“ã€‚ ä¾‹4-11ï¼š P=0æ—¶ æœ‰æ•ˆè®¿é—®æ—¶é—´=0.1us P=1/1000æ—¶ æœ‰æ•ˆè®¿é—®æ—¶é—´=0.1+24999.9Ã—1/1000=0.1+24.9999â‰ˆ25Î¼s å¯è§ï¼Œç¼ºé¡µç‡P=1/1000æ—¶ï¼Œæœ‰æ•ˆè®¿é—®æ—¶é—´å»¶é•¿ä¸ºP=0æ—¶çš„250å€ã€‚ ä¾‹4-12ï¼šè¦ä½¿æœ‰æ•ˆè®¿é—®æ—¶é—´å»¶é•¿ä¸è¶…è¿‡10%ï¼Œç¼ºé¡µç‡Pä¸ºå¤šå°‘ï¼Ÿ å› ä¸ºP=0æ—¶ï¼Œæœ‰æ•ˆè®¿é—®æ—¶é—´=0.1Î¼sã€‚ Pä¸ä¸º0æ—¶ï¼Œæœ‰æ•ˆè®¿é—®æ—¶é—´ä¸º(0.1+24999.9P)Î¼sã€‚ Pä¸ä¸º0æ—¶æ¯”Pä¸º0å»¶é•¿çš„æ—¶é—´ä¸ºï¼š(0.1+24999.9P)-0.1=24999.9P è¦ä½¿ 24999.9p/0.1 å³è¦ä½¿æœ‰æ•ˆè®¿é—®æ—¶é—´å»¶é•¿ä¸è¶…è¿‡10%ï¼Œç¼ºé¡µç‡åº”è¯¥å°äº250ä¸‡åˆ†ä¹‹ä¸€ã€‚ 2. å·¥ä½œé›† (1) åŸºæœ¬åŸç† å¼•å…¥å·¥ä½œé›†æœºåˆ¶æ˜¯ä¸ºäº†èƒ½æœ‰æ•ˆé™ä½ç¼ºé¡µç‡ï¼Œä»è€Œæé«˜è®¿å­˜çš„æ—¶é—´æ•ˆç‡ã€‚ç¨‹åºåœ¨è¿è¡Œæ—¶å¯¹é¡µçš„è®¿é—®æ˜¯ä¸å‡åŒ€çš„ï¼Œå³å¾€å¾€åœ¨æŸæ®µæ—¶é—´å†…çš„è®¿é—®ä»…å±€é™äºè¾ƒå°‘çš„è‹¥å¹²ä¸ªé¡µï¼Œè€Œåœ¨å¦ä¸€æ®µæ—¶é—´å†…ï¼Œåˆ™åˆå¯èƒ½ä»…å±€é™äºè®¿é—®å¦ä¸€äº›è¾ƒå°‘çš„é¡µã€‚è‹¥èƒ½é¢„çŸ¥ç¨‹åºåœ¨æŸæ®µæ—¶é—´é—´éš”å†…è¦è®¿é—®å“ªäº›é¡µï¼Œå¹¶èƒ½å°†å®ƒä»¬æå‰è°ƒå…¥å†…å­˜ï¼Œå°†ä¼šå¤§å¤§é™ä½ç¼ºé¡µç‡ï¼Œä»è€Œå‡å°‘ç½®æ¢æ¬¡æ•°ï¼Œæé«˜CPUçš„åˆ©ç”¨ç‡ã€‚å·¥ä½œé›†å°±æ˜¯åœ¨æŸæ®µæ—¶é—´é—´éš”â–³é‡Œï¼Œè¿›ç¨‹å®é™…è¦è®¿é—®çš„é¡µçš„é›†åˆã€‚è¦ä½¿ç¼ºé¡µå°‘å‘ç”Ÿï¼Œå¿…é¡»ä½¿ç¨‹åºçš„å·¥ä½œé›†å…¨éƒ¨åœ¨å†…å­˜ä¸­ã€‚ ç”¨W(t,â–³)è¡¨ç¤ºå½“æ—¶é—´é—´éš”ä¸ºâ–³æ—¶tæ—¶åˆ»çš„å·¥ä½œé›†ã€‚ 1) â–³å¤ªå¤§ï¼Œå·¥ä½œé›†ä¸­çš„é¡µå¤ªå¤šï¼Œå½±å“å­˜å‚¨å™¨åˆ©ç”¨ç‡ã€‚ 2) â–³å¤ªå°ï¼Œå·¥ä½œé›†ä¸­çš„é¡µå¤ªå°‘ï¼Œç¼ºé¡µç‡é«˜ã€‚ 3) W(t,â–³)ä¸tç›¸å…³ï¼Œä¸åŒçš„tå¯¹åº”ä¸åŒçš„å·¥ä½œé›†ã€‚å³ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œè¿è¡Œåˆ°ä¸åŒçš„æ—¶åˆ»ï¼Œéœ€è¦è®¿é—®çš„é¡µä¸åŒã€‚ (2) Windows NTçš„å·¥ä½œé›†æœºåˆ¶ 1) è¿›ç¨‹è¢«ç¬¬ä¸€æ¬¡åˆ›å»ºæ—¶ï¼Œä¸ºè¿›ç¨‹æŒ‡å®šäº†ä¸€ä¸ªæœ€å°å·¥ä½œé›†å’Œä¸€ä¸ªæœ€å¤§å·¥ä½œé›†ã€‚æœ€å°å·¥ä½œé›†æ˜¯è¿›ç¨‹æ­£å¸¸è¿è¡Œéœ€è¦è°ƒå…¥å†…å­˜çš„æœ€å°é¡µæ•°ã€‚å½“å†…å­˜æœ‰è¶³å¤Ÿçš„ç©ºé—´æ—¶ï¼Œå¯ä»¥ä¸ºè¿›ç¨‹åˆ†é…è¶³å¤Ÿçš„ç©ºé—´ä»¥è£…å…¥å®ƒçš„æœ€å¤§å·¥ä½œé›†ã€‚ 2) å½“æŸè¿›ç¨‹åœ¨å†…å­˜ä¸­çš„é¡µæ•°å°äºæœ€å¤§å·¥ä½œé›†æ—¶ï¼Œè‹¥å‘ç”Ÿç¼ºé¡µï¼Œç³»ç»Ÿä»ç©ºé—²é¡µæ¡†é˜Ÿåˆ—ä¸­å–ä¸€é¡µæ¡†åˆ†é…ç»™è¯¥è¿›ç¨‹ã€‚ 3) å½“æŸè¿›ç¨‹åœ¨å†…å­˜ä¸­çš„é¡µæ•°ç­‰äºæœ€å¤§å·¥ä½œé›†æ—¶ï¼Œè‹¥å‘ç”Ÿç¼ºé¡µï¼Œç³»ç»Ÿä»è¯¥è¿›ç¨‹çš„é¡µä¸­æŒ‰FIFOçš„åŸåˆ™ï¼Œæ¢å‡ºä¸€ä¸ªè¯¥è¿›ç¨‹çš„é¡µã€‚ 4) å½“ç©ºé—²é¡µæ¡†é˜Ÿåˆ—ä¸­ç©ºé—²é¡µçš„æ•°é‡å‡åˆ°ä¸€ä¸ªæœ€ä½å€¼æ—¶ï¼Œç³»ç»Ÿæ£€æŸ¥æ‰€æœ‰è¿›ç¨‹ï¼Œå¯¹å·¥ä½œé›†å¤§äºæœ€å°å·¥ä½œé›†çš„è¿›ç¨‹ï¼Œæ·˜æ±°è¯¥è¿›ç¨‹çš„ä¸€äº›é¡µï¼Œä½¿è¯¥è¿›ç¨‹çš„å·¥ä½œé›†ç­‰äºæœ€å°å·¥ä½œé›†ã€‚ 3. æŠ–åŠ¨äº§ç”Ÿçš„åŸå› å’Œé¢„é˜²æ–¹æ³• (1) æŠ–åŠ¨ å¤šé“ç¨‹åºåº¦å¤ªé«˜ï¼Œä½¿è¿è¡Œè¿›ç¨‹çš„å¤§éƒ¨åˆ†æ—¶é—´éƒ½ç”¨äºè¿›è¡Œé¡µçš„æ¢å…¥ã€æ¢å‡ºï¼Œè€Œå‡ ä¹ä¸èƒ½å®Œæˆä»»ä½•æœ‰æ•ˆå·¥ä½œçš„çŠ¶æ€ç§°ä¸ºæŠ–åŠ¨ã€‚å¼•èµ·ç³»ç»ŸæŠ–åŠ¨çš„ä¸»è¦åŸå› æ˜¯ç³»ç»Ÿä¸­çš„è¿›ç¨‹æ•°é‡å¤ªå¤šï¼Œæ¯ä¸ªè¿›ç¨‹èƒ½åˆ†é…åˆ°çš„é¡µæ¡†å¤ªå°‘ï¼Œä»¥è‡³äºè¿›ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­é¢‘ç¹è¯·æ±‚è°ƒé¡µã€‚ (2) æŠ–åŠ¨çš„é¢„é˜² å¯ä»¥é‡‡ç”¨ä»¥ä¸‹æ–¹æ³•é¢„é˜²æŠ–åŠ¨çš„å‘ç”Ÿã€‚ 1) é‡‡å–å±€éƒ¨ç½®æ¢ç­–ç•¥ã€‚å½“è¿›ç¨‹å‘ç°ç¼ºé¡µåï¼Œä»…åœ¨è¿›ç¨‹è‡ªå·±çš„å†…å­˜ç©ºé—´èŒƒå›´å†…ç½®æ¢é¡µï¼Œä¸å…è®¸ä»å…¶ä»–è¿›ç¨‹è·å¾—æ–°çš„é¡µæ¡†ã€‚ 2) åœ¨CPUè°ƒåº¦ç¨‹åºä¸­å¼•å…¥å·¥ä½œé›†ç®—æ³•ã€‚åªæœ‰å½“æ¯ä¸ªè¿›ç¨‹åœ¨å†…å­˜ä¸­éƒ½æœ‰è¶³å¤Ÿå¤§çš„é©»ç•™é›†æ—¶ï¼Œæ‰èƒ½å†ä»å¤–å­˜ä¸­è°ƒå…¥æ–°çš„ä½œä¸šã€‚ 3) æŒ‚èµ·è‹¥å¹²è¿›ç¨‹ã€‚ä¸ºäº†é¢„é˜²æŠ–åŠ¨ï¼ŒæŒ‚èµ·è‹¥å¹²è¿›ç¨‹ï¼Œè…¾å‡ºè¿›ç¨‹å ç”¨çš„ç©ºé—´ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äº”ç« _æ–‡ä»¶ç³»ç»Ÿ/ç¬¬ä¸€èŠ‚_æ–‡ä»¶.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äº”ç« _æ–‡ä»¶ç³»ç»Ÿ/ç¬¬ä¸€èŠ‚_æ–‡ä»¶.html","title":"ç¬¬ä¸€èŠ‚ æ–‡ä»¶","keywords":"","body":"ç¬¬äº”ç«  æ–‡ä»¶ç³»ç»Ÿ æ–‡ä»¶ç³»ç»Ÿç®¡ç†æ˜¯æ“ä½œç³»ç»Ÿçš„é‡è¦åŠŸèƒ½ä¹‹ä¸€ï¼Œå®ƒä¸ºç”¨æˆ·æä¾›äº†åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­å¯¹æ•°æ®ä¿¡æ¯ è¿›è¡Œé•¿æœŸã€å¤§é‡å­˜å‚¨å’Œè®¿é—®çš„åŠŸèƒ½ã€‚æ–‡ä»¶çš„ç»“æ„ï¼Œä»¥åŠæ–‡ä»¶çš„å‘½åã€è®¿é—®ã€å­˜å‚¨ã€ä¿æŠ¤å’Œå®ç°æ–¹æ³•éƒ½æ˜¯æ–‡ä»¶ç³»ç»Ÿè®¾è®¡çš„ä¸»è¦å†…å®¹ã€‚ä»æ€»ä½“ä¸Šçœ‹ï¼Œæ“ä½œç³»ç»Ÿä¸­å¤„ç†æ–‡ä»¶çš„éƒ¨åˆ†ç§°ä¸ºæ–‡ä»¶ç³»ç»Ÿ(File System)ï¼Œæ–‡ä»¶ç³»ç»ŸåŒ…æ‹¬äº†æ–‡ä»¶åŠç®¡ç†æ–‡ä»¶çš„è½¯ä»¶é›†åˆã€‚ æœ¬ç« åˆ†ä¸¤éƒ¨åˆ†æ¥è®¨è®ºæ–‡ä»¶ç³»ç»Ÿï¼Œä¸€éƒ¨åˆ†æ˜¯æ–‡ä»¶ç³»ç»Ÿçš„ç”¨æˆ·æ¥å£ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æ–‡ä»¶ç³»ç»Ÿçš„å®ç°ï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„æŒ‰åè®¿é—®å’Œå­˜å‚¨ç©ºé—´ç®¡ç†çš„å®ç°ã€‚ ç¬¬ä¸€èŠ‚ æ–‡ä»¶ æœ¬èŠ‚è®¨è®ºæ–‡ä»¶ç³»ç»Ÿçš„ç”¨æˆ·æ¥å£ï¼Œå³ç”¨æˆ·å¯ä»¥â€œçœ‹è§â€å’Œä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿéƒ¨åˆ†ï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„å‘½åã€ç±»å‹ã€å±æ€§å’Œå¯¹æ–‡ä»¶çš„æ“ä½œã€‚ ä¸€ã€æ–‡ä»¶å‘½å æ–‡ä»¶å‘½åå‘ç”¨æˆ·æä¾›äº†ç®€å•ã€ç›´è§‚çš„æ–‡ä»¶è®¿é—®æ–¹å¼ï¼Œä½¿ç”¨æˆ·åœ¨è®¿é—®æ–‡ä»¶æ—¶ä¸å¿…äº†è§£ä¿¡æ¯å­˜å‚¨çš„æ–¹æ³•ã€ä½ç½®åŠç£ç›˜å®é™…åŠ¨ä½œæ–¹å¼ç­‰ç»†èŠ‚ï¼Œè€Œåªéœ€ç»™å‡ºè¦è®¿é—®çš„æ–‡ä»¶åã€‚åœ¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œè¿›ç¨‹ç»™å‡ºæ–‡ä»¶åã€‚è¿›ç¨‹ç»ˆæ­¢åï¼Œæ–‡ä»¶ä»ç„¶å­˜åœ¨ï¼Œå…¶ä»–è¿›ç¨‹ä½¿ç”¨è¯¥æ–‡ä»¶åå¯ä»¥å¯¹å®ƒè¿›è¡Œå­˜å–ã€‚ ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿä¸ºæ–‡ä»¶å‘½ååˆ¶å®šçš„è§„åˆ™ç•¥æœ‰ä¸åŒï¼Œä½†æ‰€æœ‰æ“ä½œç³»ç»Ÿéƒ½å…è®¸ç”¨1~8ä¸ªå­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ä½œä¸ºæ–‡ä»¶åã€‚ä¾‹å¦‚ï¼Œhelloã€bruceå’Œoenwéƒ½æ˜¯åˆæ³•æ–‡ä»¶åã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ–‡ä»¶åä¸­ä¹Ÿå…è®¸æœ‰æ•°å­—å’Œä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œå¦‚1ã€error!å’ŒTab.6-1éƒ½æ˜¯åˆæ³•çš„ã€‚è®¸å¤šæ–‡ä»¶ç³»ç»Ÿæ”¯æŒé•¿è¾¾255ä¸ªå­—ç¬¦çš„æ–‡ä»¶åã€‚æ–‡ä»¶çš„å‘½åè§„åˆ™å’Œæ–‡ä»¶åçš„é•¿åº¦åœ¨æ–‡ä»¶ç³»ç»Ÿè®¾è®¡æ—¶ç¡®å®šã€‚ æœ‰çš„æ–‡ä»¶ç³»ç»ŸåŒºåˆ†å¤§å°å†™å­—æ¯ï¼Œå¦‚UNIXçš„æ–‡ä»¶ç³»ç»Ÿï¼›æœ‰çš„ä¸åŒºåˆ†ï¼Œå¦‚MS-DOSã€‚å› æ­¤ï¼Œåœ¨UNIXä¸­ï¼Œhelloã€Heloå’ŒHELLOæ˜¯3ä¸ªä¸åŒçš„æ–‡ä»¶åï¼›è€Œåœ¨MS-DOSä¸­ï¼Œå®ƒä»¬æ˜¯åŒä¸€ä¸ªæ–‡ä»¶åã€‚ å¤šæ•°æ“ä½œç³»ç»Ÿéƒ½æ”¯æŒæ–‡ä»¶åç”¨åœ†ç‚¹éš”å¼€åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå¦‚hello.cã€‚åœ†ç‚¹åé¢çš„éƒ¨åˆ†ç§°ä¸ºæ–‡ä»¶æ‰©å±•åã€‚æ–‡ä»¶åinfo.txtç”¨äºè¡¨ç¤ºè¿™ä¸ªæ–‡ä»¶çš„ç±»å‹ï¼Œç»™ç”¨æˆ·ä¸€ä¸ªæç¤ºï¼Œè€Œä¸æ˜¯è¡¨ç¤ºç»™è®¡ç®—æœºä¼ é€ä»€ä¹ˆä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œç¼–è¯‘å™¨ã€é“¾æ¥ç¨‹åºç­‰åˆ©ç”¨æ‰©å±•ååŒºåˆ†å“ªäº›æ˜¯Cæ–‡ä»¶ï¼Œå“ªäº›æ˜¯æ±‡ç¼–æ–‡ä»¶ï¼Œå“ªäº›æ˜¯å…¶ä»–æ–‡ä»¶ã€‚ åœ¨Windowsç³»ç»Ÿä¸­ï¼Œæ‰©å±•åè¢«èµ‹äºˆäº†å«ä¹‰ã€‚ç”¨æˆ·å¯ä»¥åœ¨æ“ä½œç³»ç»Ÿä¸­æ³¨å†Œæ‰©å±•åï¼Œå¹¶ä¸”è§„å®šå“ªä¸ªç¨‹åºä¸è¯¥æ‰©å±•åå…³è”ï¼Œå½“ç”¨æˆ·åŒå‡»æŸä¸ªæ–‡ä»¶åæ—¶ï¼Œå…³è”è¯¥æ‰©å±•åçš„ç¨‹åºå°±ä¼šå¯åŠ¨å¹¶è®¿é—®è¯¥æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼ŒåŒå‡»â€œå­”å­.rmvbâ€å°±ä¼šå¯åŠ¨å…³è”çš„ç”µå½±æ’­æ”¾è½¯ä»¶ï¼Œå¹¶æ’­æ”¾è¯¥è§†é¢‘ã€‚ äºŒã€æ–‡ä»¶ç»“æ„ æœ¬èŠ‚ä»‹ç»å¦‚å›¾5-1æ‰€ç¤ºçš„3ç§æ–‡ä»¶ç»“æ„ã€‚ 1.æ— ç»“æ„å­—èŠ‚åºåˆ— æ— ç»“æ„å­—èŠ‚åºåˆ—æ–‡ä»¶ä¹Ÿç§°ä¸ºæµå¼æ–‡ä»¶ï¼Œæ“ä½œç³»ç»Ÿä¸çŸ¥é“ä¹Ÿä¸å…³å¿ƒæ–‡ä»¶å†…å®¹æ˜¯ä»€ä¹ˆï¼Œæ“ä½œç³»ç»Ÿæ‰€è§åˆ°çš„å°±æ˜¯å­—èŠ‚ï¼Œå…¶ä»»ä½•å«ä¹‰ç”±ä½¿ç”¨è¯¥æ–‡ä»¶çš„ç¨‹åºè‡ªè¡Œç†è§£ï¼Œåœ¨UNIXå’ŒWindowsç³»ç»Ÿä¸­éƒ½é‡‡ç”¨è¿™ç§æ–¹å¼ã€‚ æŠŠæ–‡ä»¶çœ‹æˆå­—èŠ‚åºåˆ—ä¸ºæ“ä½œç³»ç»Ÿæä¾›äº†æœ€å¤§çš„çµæ´»æ€§ã€‚ç”¨æˆ·ç¨‹åºå¯ä»¥å‘æ–‡ä»¶ä¸­åŠ äººä»»ä½• å†…å®¹ï¼Œå¹¶ä»¥æ–¹ä¾¿çš„å½¢å¼å¯¹æ–‡ä»¶è¿›è¡Œå‘½åã€‚ 2.å›ºå®šé•¿åº¦è®°å½•åºåˆ— åœ¨è¯¥æ¨¡å‹ä¸­ï¼Œæ„æˆæ–‡ä»¶çš„åŸºæœ¬å•ä½æ˜¯å…·æœ‰å›ºå®šé•¿åº¦çš„è®°å½•ï¼Œæ¯ä¸ªè®°å½•éƒ½æœ‰å…¶å†…éƒ¨ç»“æ„ã€‚æŠŠæ–‡ä»¶ä½œä¸ºè®°å½•åºåˆ—çš„ä¸­å¿ƒæ€æƒ³æ˜¯ï¼šè¯»æ“è¿”å›ä¸€ä¸ªè®°å½•ï¼Œè€Œå†™æ“ä½œé‡å†™æˆ–è¿½åŠ ä¸€ä¸ªè®°å½•ã€‚ 3.æ ‘å½¢ç»“æ„ æ–‡ä»¶ç”±ä¸€æ£µè®°å½•æ ‘æ„æˆï¼Œè®°å½•é•¿åº¦ä¸å®šï¼Œåœ¨è®°å½•çš„å›ºå®šä½ç½®åŒ…å«ä¸€ä¸ªå…³é”®å­—åŸŸï¼Œè®°å½•æ ‘ æŒ‰å…³é”®å­—åŸŸæ’åºã€‚åœ¨è¿™ç§æ–‡ä»¶ç»“æ„ä¸­ï¼ŒåŸºæœ¬æ“ä½œæ˜¯è·å–å…·æœ‰ç‰¹å®šå…³é”®å­—çš„è®°å½•ï¼ˆè€Œä¸æ˜¯è·å–ä¸‹ä¸€æ¡è®°å½•)ã€‚å¢åŠ è®°å½•æ—¶ï¼Œç”±æ“ä½œç³»ç»Ÿå†³å®šè®°å½•åœ¨æ–‡ä»¶ä¸­çš„å­˜æ”¾ä½ç½®ã€‚è¿™ç±»æ–‡ä»¶ç»“æ„ä¸UNIXå’ŒWindowsç³»ç»Ÿä¸­é‡‡ç”¨çš„æ— ç»“æ„å­—èŠ‚åºåˆ—æœ‰æ˜æ˜¾ä¸åŒï¼Œå®ƒåœ¨ä¸€äº›å¤„ç†å•†ä¸šæ•°æ®çš„å¤§å‹è®¡ç®—æœºä¸­è·å¾—äº†å¹¿æ³›ä½¿ç”¨ã€‚ ä¸‰ã€æ–‡ä»¶ç±»å‹ åœ¨è®¾è®¡æ“ä½œç³»ç»Ÿæ—¶è¦è€ƒè™‘ç³»ç»Ÿæ”¯æŒå“ªäº›ç±»å‹çš„æ–‡ä»¶ï¼Œå¹¶ä¸ºæ¯ç§ç±»å‹çš„æ–‡ä»¶å®šä¹‰åˆæ³•çš„æ“ä½œã€‚æ–‡ä»¶çš„ç±»å‹æœ‰æ­£è§„æ–‡ä»¶ã€ç›®å½•æ–‡ä»¶ã€å­—ç¬¦è®¾å¤‡æ–‡ä»¶å’Œå—è®¾å¤‡æ–‡ä»¶ç­‰ã€‚æ­£è§„æ–‡ä»¶åŒ…å«ç”¨æˆ·ä¿¡æ¯ï¼Œä¸€èˆ¬åˆ†ä¸ºASCIIæ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ã€‚ç›®å½•æ–‡ä»¶æ˜¯ç”¨äºç®¡ç†æ–‡ä»¶çš„ç³»ç»Ÿæ–‡ä»¶ã€‚å­—ç¬¦è®¾å¤‡æ–‡ä»¶å’Œè¾“å…¥/è¾“å‡ºæœ‰å…³ï¼Œç”¨äºä¸²è¡ŒI/Oç±»è®¾å¤‡ï¼Œå¦‚ç»ˆç«¯ã€æ‰“å°æœºå’Œç½‘ç»œç­‰ã€‚å—è®¾å¤‡æ–‡ä»¶ç”¨äºç£ç›˜ç±»è®¾å¤‡ã€‚æœ¬èŠ‚ä¸»è¦ä»‹ç»æ­£è§„æ–‡ä»¶ã€‚ 1.ASCII(American Standard Code for Information Interchange) ASCIIæ–‡ä»¶ç”±å¤šè¡Œæ­£æ–‡ç»„æˆï¼Œåœ¨æŸäº›ç³»ç»Ÿä¸­æ¯è¡Œç”¨å›è½¦ç¬¦ç»“æŸï¼ŒæŸäº›åˆ™ç”¨æ¢è¡Œç¬¦ç»“æŸï¼Œè€Œæœ‰äº›ç³»ç»Ÿè¿˜åŒæ—¶é‡‡ç”¨å›è½¦ç¬¦å’Œæ¢è¡Œç¬¦ï¼Œå¦‚MS-D05ã€‚å„è¡Œçš„é•¿åº¦ä¸å¿…ç›¸åŒã€‚ ASCIIæ–‡ä»¶çš„æ˜æ˜¾ä¼˜åŠ¿æ˜¯å¯ä»¥æ˜¾ç¤ºå’Œæ‰“å°ï¼Œä¹Ÿå¯ä»¥ç”¨é€šå¸¸çš„æ–‡æœ¬ç¼–è¾‘å™¨è¿›è¡Œç¼–è¾‘ã€‚å¦å¤–ï¼Œå¦‚æœç¨‹åºä»¥ASCIIæ–‡ä»¶ä½œä¸ºè¾“å…¥å’Œè¾“å‡ºï¼Œå°±å¾ˆå®¹æ˜“æŠŠä¸€ä¸ªç¨‹åºçš„è¾“å‡ºä½œä¸ºå¦ä¸€ä¸ªç¨‹åºçš„è¾“å…¥ã€‚ 2.äºŒè¿›åˆ¶æ–‡ä»¶ äºŒè¿›åˆ¶æ–‡ä»¶å…·æœ‰ä¸€å®šçš„å†…éƒ¨ç»“æ„ï¼Œå¦‚å¯æ‰§è¡Œçš„.exeæ–‡ä»¶ã€‚ç”¨é€šå¸¸çš„æ–‡æœ¬ç¼–è¾‘å™¨ä¸èƒ½ç›´æ¥æ˜¾ç¤ºæˆ–æ‰“å°äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¿…é¡»ä½¿ç”¨ä¸“é—¨çš„äºŒè¿›åˆ¶æ–‡ä»¶ç¼–è¾‘å™¨ã€‚ä¸åŒçš„æ“ä½œç³»ç»Ÿå¯ä»¥è¯†åˆ«ä¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ¯”å¦‚æŠŠæŸä¸€ç§ç»“æ„ï¼ˆå¦‚ELFæ ¼å¼ï¼‰çš„äºŒè¿›åˆ¶æ–‡ä»¶ä½œä¸ºç³»ç»Ÿä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ å››ã€æ–‡ä»¶å­˜å– ç”¨æˆ·é€šè¿‡å¯¹æ–‡ä»¶çš„å­˜å–æ¥å®Œæˆå¯¹æ–‡ä»¶çš„å„ç§æ“ä½œï¼Œæ–‡ä»¶çš„å­˜å–æ–¹å¼æ˜¯ç”±æ–‡ä»¶çš„æ€§è´¨å’Œç”¨æˆ·ä½¿ç”¨æ–‡ä»¶çš„æƒ…å†µç¡®å®šçš„ã€‚å¸¸ç”¨çš„æ–‡ä»¶å­˜å–æ–¹å¼æœ‰ä¸¤ç§ï¼šé¡ºåºå­˜å–å’Œéšæœºå­˜å–ã€‚ 1.é¡ºåºå­˜å– æ—©æœŸçš„æ“ä½œç³»ç»Ÿåªæœ‰é¡ºåºå­˜å–è¿™ä¸€ç§æ–‡ä»¶å­˜å–æ–¹å¼ã€‚è¿›ç¨‹å¯ä»¥ä»æ–‡ä»¶å¼€å§‹å¤„è¯»å–æ–‡ä»¶ä¸­çš„æ‰€æœ‰å­—èŠ‚æˆ–è€…è®°å½•ï¼Œä½†ä¸èƒ½è·³è¿‡æŸäº›å†…å®¹ï¼Œä¹Ÿä¸èƒ½ä¸æŒ‰é¡ºåºå­˜å–ã€‚åœ¨å­˜å‚¨ä»‹è´¨æ˜¯ç£å¸¦è€Œä¸æ˜¯ç£ç›˜æ—¶ï¼Œé¡ºåºå­˜å–æ–‡ä»¶æ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚ 2.éšæœºå­˜å– éšæœºå­˜å–åˆç§°ç›´æ¥å­˜å–ï¼Œå³å¯ä»¥ä»¥ä»»æ„é¡ºåºè¯»å–æ–‡ä»¶ä¸­çš„å­—èŠ‚æˆ–è®°å½•ã€‚ç°ä»£æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ä¸€æ—¦è¢«åˆ›å»ºï¼Œæ‰€æœ‰æ–‡ä»¶è‡ªåŠ¨æˆä¸ºéšæœºå­˜å–æ–‡ä»¶ã€‚å®šé•¿è®°å½•çš„æ–‡ä»¶èƒ½å¾ˆå¥½åœ°æ”¯æŒéšæœºå­˜å–ï¼Œè€Œå˜é•¿è®°å½•è™½ç„¶å¯ä»¥éšæœºå­˜å–ï¼Œä½†å®ç°èµ·æ¥å¤æ‚è€Œä¸”å­˜å–é€Ÿåº¦æ…¢ã€‚ äº”ã€æ–‡ä»¶å±æ€§ ä¸ºæ–¹ä¾¿ç®¡ç†ï¼Œé™¤äº†æ–‡ä»¶åå’Œæ–‡ä»¶æ•°æ®å¤–ï¼Œæ–‡ä»¶ç³»ç»Ÿè¿˜ä¼šä¿å­˜å…¶ä»–ä¸æ–‡ä»¶ç›¸å…³çš„ä¿¡æ¯ï¼Œå¦‚æ–‡ä»¶çš„åˆ›å»ºæ—¥æœŸã€æ–‡ä»¶å¤§å°å’Œä¿®æ”¹æ—¶é—´ç­‰ï¼Œè¿™äº›é™„åŠ ä¿¡æ¯ç§°ä¸ºæ–‡ä»¶å±æ€§ã€‚æ–‡ä»¶å±æ€§åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸­å·®åˆ«å¾ˆå¤§ï¼Œè¡¨5-1åˆ—å‡ºäº†ä¸€äº›å¸¸ç”¨çš„æ–‡ä»¶å±æ€§ã€‚ è¡¨5-1ä¸€äº›å¸¸ç”¨çš„æ–‡ä»¶å±æ€§ å…­ã€æ–‡ä»¶æ“ä½œ ä½¿ç”¨æ–‡ä»¶çš„ç›®çš„æ˜¯å­˜å‚¨ä¿¡æ¯å¹¶æ–¹ä¾¿ä»¥åæ£€ç´¢ã€‚ä¸åŒçš„ç³»ç»Ÿæä¾›äº†ä¸åŒçš„æ“ä½œæ¥å­˜å‚¨å’Œæ£€ç´¢ä¿¡æ¯ï¼Œä»¥ä¸‹æ˜¯å¸¸ç”¨çš„æ–‡ä»¶æ“ä½œã€‚ 1.CREATE è¯¥æ“ä½œå®Œæˆåˆ›å»ºæ–‡ä»¶çš„åŠŸèƒ½ï¼Œå¹¶è®¾ç½®æ–‡ä»¶çš„ä¸€äº›å±æ€§ã€‚ 2.DELETE å½“ä¸å†éœ€è¦æŸä¸ªæ–‡ä»¶æ—¶ï¼Œåˆ é™¤è¯¥æ–‡ä»¶å¹¶é‡Šæ”¾ç£ç›˜ç©ºé—´ã€‚ 3.OPEN åœ¨ä½¿ç”¨æ–‡ä»¶ä¹‹å‰ï¼Œå¿…é¡»å…ˆæ‰“å¼€æ–‡ä»¶ã€‚OPENè°ƒç”¨çš„ç›®çš„æ˜¯å°†æ–‡ä»¶å±æ€§å’Œæ–‡ä»¶çš„åœ°å€ä¿¡æ¯è£…å…¥ä¸»å­˜ï¼Œä¾¿äºåœ¨å¯¹æ–‡ä»¶çš„åç»­è®¿é—®ä¸­èƒ½å¿«é€Ÿå­˜å–æ–‡ä»¶ä¿¡æ¯ã€‚ 4.CLOSE å½“å­˜å–ç»“æŸåï¼Œä¸å†éœ€è¦æ–‡ä»¶å±æ€§å’Œåœ°å€ä¿¡æ¯ï¼Œè¿™æ—¶åº”è¯¥å…³é—­æ–‡ä»¶ä»¥é‡Šæ”¾å†…éƒ¨è¡¨ç©ºé—´ã€‚å¾ˆå¤šç³»ç»Ÿé™åˆ¶è¿›ç¨‹æ‰“å¼€æ–‡ä»¶çš„ä¸ªæ•°ï¼Œä»¥é¼“åŠ±ç”¨æˆ·å…³é—­ä¸å†ä½¿ç”¨çš„æ–‡ä»¶ã€‚ 5.READ ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚ä¸€èˆ¬åœ°ï¼Œç”¨æˆ·å¯ä»¥æŒ‡å®šä»å“ªä¸ªæ–‡ä»¶çš„ç¬¬å‡ ä¸ªå­—èŠ‚å¼€å§‹è¯»å–å¤šå°‘ä¸ªå­—èŠ‚çš„å†…å®¹ã€‚æ­¤å¤–ï¼Œè°ƒç”¨è¯»æ–‡ä»¶çš„å‡½æ•°æ—¶ï¼Œè¿˜éœ€è¦ç»™å‡ºå­˜æ”¾è¢«è¯»å–å†…å®¹çš„å†…å­˜ç¼“å†²åŒºã€‚ 6.WRITE å¾€æ–‡ä»¶ä¸­å†™æ•°æ®ï¼Œå†™æ“ä½œä¸€èˆ¬ä»å†™å‡½æ•°çš„å‚æ•°æŒ‡å®šçš„æ–‡ä»¶ä½ç½®å¼€å§‹ã€‚å¦‚æœå½“å‰ä½ç½®æ˜¯æ–‡ä»¶æœ«å°¾ï¼Œæ–‡ä»¶é•¿åº¦å¢åŠ ã€‚å¦‚æœå½“å‰ä½ç½®åœ¨æ–‡ä»¶ä¸­é—´ï¼Œåˆ™ç°æœ‰æ•°æ®è¢«è¦†ç›–ï¼Œå¹¶ä¸”æ°¸è¿œä¸¢å¤±ã€‚ 7.APPEND è¯¥æ“ä½œæ˜¯WRITEè°ƒç”¨çš„é™åˆ¶å½¢å¼ï¼Œå®ƒåªèƒ½åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ æ•°æ®ã€‚ 8.SEEK å¯¹äºéšæœºå­˜å–æ–‡ä»¶ï¼Œè¦æŒ‡å®šä»ä½•å¤„å¼€å§‹å–æ•°æ®ã€‚é€šå¸¸çš„åšæ³•æ˜¯ç”¨SEEKç³»ç»Ÿè°ƒç”¨æŠŠå½“å‰ ä½ç½®æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶ä¸­ç‰¹å®šçš„ä½ç½®ã€‚SEEKè°ƒç”¨ç»“æŸåï¼Œå°±å¯ä»¥ä»è¯¥ä½ç½®å¼€å§‹è¯»å†™æ•°æ®äº†ã€‚ 9.GETATTRIBUTES è¯¥æ“ä½œç”¨äºè·å–æ–‡ä»¶å±æ€§ã€‚ 10.SETATTRIBUTES æŸäº›å±æ€§æ˜¯å¯ç”±ç”¨æˆ·è®¾ç½®çš„ï¼Œæ–‡ä»¶åˆ›å»ºä»¥åï¼Œç”¨æˆ·è¿˜å¯ä»¥é€šè¿‡ç³»ç»Ÿè°ƒç”¨SETAT-TRIBUTESæ¥ä¿®æ”¹å®ƒä»¬ã€‚ 11.RENAME è¯¥æ“ä½œç”¨äºä¿®æ”¹å·²æœ‰æ–‡ä»¶çš„åä»¶åã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äº”ç« _æ–‡ä»¶ç³»ç»Ÿ/ç¬¬äºŒèŠ‚_ç›®å½•.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äº”ç« _æ–‡ä»¶ç³»ç»Ÿ/ç¬¬äºŒèŠ‚_ç›®å½•.html","title":"ç¬¬äºŒèŠ‚ ç›®å½•","keywords":"","body":"ç¬¬äºŒèŠ‚ ç›®å½• æ–‡ä»¶ç³»ç»Ÿé€šå¸¸æä¾›ç›®å½•æˆ–æ–‡ä»¶å¤¹ç”¨äºè®°å½•æ–‡ä»¶ï¼Œå¾ˆå¤šç³»ç»Ÿä¸­ç›®å½•æœ¬èº«ä¹Ÿæ˜¯æ–‡ä»¶ï¼Œç›®å½•æ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­å®ç°æŒ‰åè®¿é—®æ–‡ä»¶çš„é‡è¦æ•°æ®ç»“æ„ã€‚æœ¬èŠ‚è®¨è®ºç›®å½•ã€ç›®å½•çš„ç»„æˆã€ç›®å½•çš„ç‰¹æ€§ï¼Œä»¥åŠå¯ä»¥å¯¹ç›®å½•è¿›è¡Œçš„æ“ä½œã€‚ ä¸€ã€å±‚æ¬¡ç›®å½•ç³»ç»Ÿ 1.ç›®å½•æ–‡ä»¶çš„ç»“æ„ ç›®å½•æ–‡ä»¶æœ‰ä¸¤ç§å¸¸è§çš„ç»“æ„ï¼šå±æ€§æ”¾åœ¨ç›®å½•é¡¹ä¸­å’Œæ”¾åœ¨iç»“ç‚¹ä¸­ã€‚ ç›®å½•æ–‡ä»¶åŒ…å«è®¸å¤šç›®å½•é¡¹ï¼Œæ¯ä¸ªç›®å½•é¡¹ç”¨äºæè¿°ä¸€ä¸ªæ–‡ä»¶ã€‚åœ¨ç¬¬ä¸€ç§ç»“æ„ä¸­ï¼Œæ¯ä¸ªç›®å½•é¡¹é•¿åº¦ç›¸åŒï¼Œæ¯ä¸ªæ–‡ä»¶å¯¹åº”ä¸€ä¸ªç›®å½•é¡¹ã€‚å…¶ä¸­åŒ…å«æ–‡ä»¶åã€æ–‡ä»¶å±æ€§å’Œæ–‡ä»¶çš„åœ°å€ã€‚åœ¨ç¬¬äºŒç§ç»“æ„ä¸­ï¼Œç›®å½•é¡¹ä¸­æœ‰ä¸€ä¸ªæ–‡ä»¶åå’Œiç»“ç‚¹å·ã€‚iç»“ç‚¹æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œæ–‡ä»¶å±æ€§å’Œæ–‡ä»¶çš„åœ°å€ä¿¡æ¯å­˜æ”¾åœ¨iç»“ç‚¹ä¸­ã€‚è¿™ä¸¤ç§ç»“æ„éƒ½å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚å›¾5-2åˆ†åˆ«æè¿°äº†ä»¥ä¸Šä¸¤ç§ç»“æ„ã€‚ 2.ç›®å½•ç»“æ„ æ–‡ä»¶ç›®å½•çš„ç»„ç»‡å’Œç®¡ç†æ˜¯æ–‡ä»¶ç®¡ç†çš„ä¸€ä¸ªé‡è¦æ–¹é¢ï¼ŒåŒ…æ‹¬å•å±‚ç›®å½•ã€ä¸¤çº§ç›®å½•å’Œæ ‘å½¢ç›®å½•ã€‚ (1)å•å±‚ç›®å½• è¿™ç§ç›®å½•ä¹Ÿè¢«ç§°ä¸ºæ ¹ç›®å½•ã€‚åœ¨æ•´ä¸ªç³»ç»Ÿä¸­è®¾ç½®ä¸€å¼ çº¿æ€§ç›®å½•è¡¨ï¼Œè¡¨ä¸­åŒ…æ‹¬äº†æ‰€æœ‰æ–‡ä»¶çš„æè¿°ä¿¡æ¯ã€‚æ—©æœŸçš„ä¸ªäººè®¡ç®—æœºä¸­ï¼Œè¿™ç§ç³»ç»Ÿå¾ˆæ™®éã€‚è¿™ç§ç›®å½•ç»“æ„ä½¿å¾—è½¯ä»¶è®¾è®¡ç›¸å¯¹ç®€å•ã€‚ å›¾5-3æ‰€ç¤ºæ˜¯ä¸€ä¸ªå•å±‚ç›®å½•ç³»ç»Ÿçš„ä¾‹å­ã€‚è¯¥ç›®å½•ä¸­æœ‰4ä¸ªæ–‡ä»¶ã€‚ åœ¨å¤šç”¨æˆ·ç³»ç»Ÿä¸­ï¼Œå•å±‚ç›®å½•å¸¦æ¥çš„ä¸€ä¸ªæ˜¾è‘—é—®é¢˜æ˜¯ï¼Œä¸åŒç”¨æˆ·å¯èƒ½ä¼šä½¿ç”¨ç›¸åŒçš„æ–‡ä»¶åã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·Aåˆ›å»ºäº†ä¸€ä¸ªåä¸ºhelo.cçš„æ–‡ä»¶ï¼Œç„¶åï¼Œç”¨æˆ·Bä¹Ÿåˆ›å»ºäº†ä¸€ä¸ªåä¸ºhello.cçš„æ–‡ä»¶ï¼Œç”¨æˆ·Bçš„æ–‡ä»¶å¯èƒ½ä¼šè¦†ç›–ç”¨æˆ·Açš„æ–‡ä»¶ã€‚å¾ˆæ˜¾ç„¶ï¼Œè¿™ç§ç»“æ„ä¸é€‚åˆåœ¨å¤šç”¨æˆ·ç³»ç»Ÿä¸­ä½¿ç”¨ã€‚ å¦å¤–ï¼Œç”±äºä½¿ç”¨å•å±‚ç›®å½•æ—¶ï¼Œè¦æŸ¥æ‰¾ä¸€ä¸ªæ–‡ä»¶å¿…é¡»å¯¹å•å±‚ç›®å½•è¡¨ä¸­çš„æ‰€æœ‰æ–‡ä»¶ä¿¡æ¯é¡¹è¿›è¡Œæœç´¢ï¼Œå› è€Œæœç´¢æ•ˆç‡ä¹Ÿè¾ƒä½ã€‚ (2)ä¸¤çº§ç›®å½• ä¸ºäº†é¿å…ä¸Šè¿°æ–‡ä»¶åå†²çªï¼Œä¸€ç§æ”¹è¿›æ–¹æ³•æ˜¯ä¸ºæ¯ä¸ªç”¨æˆ·æä¾›ä¸€ä¸ªç§æœ‰ç›®å½•ã€‚è¿™æ ·ï¼Œä¸€ä¸ªç”¨æˆ·é€‰æ‹©æ–‡ä»¶åæ—¶å°±ä¸ä¼šå½±å“åˆ°å…¶ä»–ç”¨æˆ·ã€‚å›¾5-4å±•ç¤ºäº†ä¸€ä¸ªä¸¤çº§ç›®å½•ç³»ç»Ÿã€‚ åœ¨ä¸¤çº§ç›®å½•ç»“æ„ä¸­ï¼Œç›®å½•è¢«åˆ†ä¸ºä¸¤çº§ï¼Œç¬¬ä¸€çº§ç§°ä¸ºä¸»ç›®å½•ï¼Œç»™å‡ºäº†ç”¨æˆ·åå’Œç”¨æˆ·å­ç›®å½•æ‰€åœ¨çš„ç‰©ç†ä½ç½®ã€‚ç¬¬äºŒçº§ç§°ä¸ºç”¨æˆ·ç›®å½•ï¼Œç»™å‡ºäº†è¯¥ç”¨æˆ·æ‰€æœ‰æ–‡ä»¶çš„æ–‡ä»¶æ§åˆ¶å—ã€‚è¿™ä¸€è®¾è®¡éšå«çš„æœºåˆ¶æ˜¯ï¼Œå½“ä¸€ä¸ªç”¨æˆ·è¯•å›¾æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œç³»ç»ŸçŸ¥é“æ˜¯å“ªä¸ªç”¨æˆ·ï¼Œä»è€ŒçŸ¥é“åº”è¯¥æŸ¥è¯¢å“ªä¸ªç›®å½•ã€‚ ä½¿ç”¨ä¸¤çº§ç›®å½•çš„ä¼˜ç‚¹æ˜¯è§£å†³äº†æ–‡ä»¶çš„é‡åé—®é¢˜å’Œæ–‡ä»¶å…±äº«é—®é¢˜ï¼ŒæŸ¥æ‰¾æ—¶é—´é™ä½ã€‚ç¼ºç‚¹æ˜¯å¢åŠ äº†ç³»ç»Ÿçš„å­˜å‚¨å¼€é”€ã€‚ (3)æ ‘å½¢ç›®å½• æŠŠä¸¤çº§ç›®å½•çš„å±‚æ¬¡å…³ç³»åŠ ä»¥æ¨å¹¿ï¼Œå°±å½¢æˆäº†å¤šçº§ç›®å½•ï¼Œåˆç§°æ ‘å½¢ç›®å½•ï¼Œå¦‚å›¾5-5æ‰€ç¤ºã€‚ åœ¨å¤šçº§ç›®å½•ç»“æ„ä¸­ï¼Œé™¤äº†å¶å­ç»“ç‚¹å¯¹åº”çš„å­˜å‚¨å—ä¸­è£…æœ‰æ–‡ä»¶ä¿¡æ¯å¤–ï¼Œå…¶ä»–æ¯ä¸€çº§ç›®å½•ä¸­å­˜æ”¾çš„éƒ½æ˜¯ä¸‹ä¸€çº§ç›®å½•æˆ–æ–‡ä»¶çš„è¯´æ˜ä¿¡æ¯ï¼Œç”±æ­¤å½¢æˆå±‚æ¬¡å…³ç³»ã€‚æœ€é«˜å±‚ä¸ºæ ¹ç›®å½•ï¼Œæœ€åº•å±‚ä¸ºæ–‡ä»¶ã€‚åœ¨è¿™ç§ç»“æ„ä¸­ï¼Œç”¨æˆ·å¯ä»¥æ‹¥æœ‰å¤šä¸ªæ‰€éœ€çš„ç›®å½•ï¼Œè‡ªç”±åœ°ç»„ç»‡è‡ªå·±çš„æ–‡ä»¶ã€‚åŒæ—¶ï¼Œç”¨æˆ·å¯ä»¥åˆ›å»ºä»»æ„æ•°é‡å­ç›®å½•çš„åŠŸèƒ½ï¼Œä¸ºç”¨æˆ·ç»„ç»‡å…¶æ–‡ä»¶æä¾›äº†ä¸€ç§å¼ºå¤§çš„å·¥å…·ã€‚ æ ‘å½¢ç›®å½•çš„ä¼˜ç‚¹æ˜¯ä¾¿äºæ–‡ä»¶çš„åˆ†ç±»ï¼Œå±‚æ¬¡ç»“æ„æ¸…æ™°ï¼Œä¾¿äºç®¡ç†å’Œä¿æŠ¤ã€è§£å†³äº†é‡åé—®é¢˜ï¼ŒæŸ¥æ‰¾é€Ÿåº¦åŠ å¿«ã€‚ç¼ºç‚¹æ˜¯æŸ¥æ‰¾ä¸€ä¸ªæ–‡ä»¶æŒ‰è·¯å¾„åé€å±‚æ£€æŸ¥ï¼Œç”±äºæ¯ä¸ªæ–‡ä»¶éƒ½æ”¾åœ¨å¤–å­˜ä¸­ï¼Œå¤šæ¬¡è®¿é—®ç£ç›˜ä¼šå½±å“é€Ÿåº¦ï¼Œç»“æ„ç›¸å¯¹å¤æ‚ã€‚ äºŒã€è·¯å¾„å ç”¨ç›®å½•æ ‘ç»„ç»‡æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œéœ€è¦æœ‰æŸç§æ–¹æ³•æŒ‡æ˜æ–‡ä»¶åã€‚å¸¸ç”¨çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼šç»å¯¹è·¯å¾„åå’Œç›¸å¯¹è·¯å¾„åã€‚ 1.ç»å¯¹è·¯å¾„å ç»å¯¹è·¯å¾„åç”±ä»æ ¹ç›®å½•åˆ°æ–‡ä»¶çš„è·¯å¾„ç»„æˆã€‚ä¾‹å¦‚ï¼Œè·¯å¾„/program//practice/estè¡¨ç¤ºæ ¹ç›®å½•ä¸­æœ‰å­ç›®å½•programï¼Œè€Œprogramä¸­åˆæœ‰å­ç›®å½•practiceï¼Œæ–‡ä»¶testå°±åœ¨å­ç›®å½•practiceä¸‹ã€‚ç»å¯¹è·¯å¾„åæ€»æ˜¯ä»æ ¹ç›®å½•å¼€å§‹ï¼Œå¹¶ä¸”æ˜¯å”¯ä¸€çš„ã€‚åœ¨Windowsç³»ç»Ÿä¸­ï¼Œè·¯å¾„å„éƒ¨åˆ†ä¹‹é—´ç”¨â€œ\\â€åˆ†éš”ï¼›åœ¨UNIXç³»ç»Ÿä¸­ï¼Œåˆ†éš”ç¬¦ä¸ºâ€œ/â€ã€‚åŒæ ·çš„è·¯å¾„ååœ¨ä¸¤ç§ç³»ç»Ÿä¸­çš„ä¹¦å†™å½¢å¼å¦‚ä¸‹ã€‚ Windows \\ program \\ practice \\ test UNIX /program/practice/test ä¸ç®¡é‡‡ç”¨å“ªç§åˆ†éš”ç¬¦ï¼Œåªè¦è·¯å¾„åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯åˆ†éš”ç¬¦ï¼Œåˆ™è¿™ä¸ªè·¯å¾„å°±æ˜¯ç»å¯¹è·¯å¾„ã€‚ 2.ç›¸å¯¹è·¯å¾„å å½“è®¿é—®ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•åŒ…å«å¾ˆå¤šçº§æ—¶ï¼Œå¦‚æœè®¿é—®æ¯ä¸ªæ–‡ä»¶éƒ½è¦ä»æ ¹ç›®å½•å¼€å§‹ï¼Œç›´åˆ°å¶å­çš„æ–‡ä»¶åä¸ºæ­¢ï¼ŒåŒ…å«æ‰€æœ‰ç»è¿‡çš„å„çº§åˆ†ç›®å½•åœ¨å†…çš„å…¨è·¯å¾„åæ˜¯ç›¸å½“éº»çƒ¦çš„ã€‚åœ¨è®¾è®¡æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œå¯ä»¥å…è®¸ç”¨æˆ·æŒ‡å®šä¸€ä¸ªç›®å½•ä½œä¸ºå½“å‰çš„å·¥ä½œç›®å½•ï¼Œæ‰€æœ‰çš„ä¸ä»æ ¹ç›®å½•å¼€å§‹çš„è·¯å¾„åéƒ½æ˜¯ç›¸å¯¹äºå·¥ä½œç›®å½•çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå½“å‰çš„å·¥ä½œç›®å½•æ˜¯/program/practice,åˆ™ç»å¯¹è·¯å¾„åä¸º/program/practice/testçš„æ–‡ä»¶å¯ä»¥ç›´æ¥ç”¨testæ¥å¼•ç”¨ï¼Œç”¨æˆ·ä½¿ç”¨ç›¸å¯¹è·¯å¾„åå¾€å¾€æ›´æ–¹ä¾¿ï¼Œä½†æ˜¯å‰ææ˜¯ç”¨æˆ·è®¿é—®çš„æ–‡ä»¶å¿…é¡»åœ¨å½“å‰å·¥ä½œç›®å½•ä¸‹ã€‚ä¸€äº›ç¨‹åºéœ€è¦å­˜å–æŸä¸ªç‰¹å®šçš„æ–‡ä»¶ï¼Œè€Œä¸ç®¡å½“å‰ç›®å½•æ˜¯ä»€ä¹ˆï¼Œè¿™æ—¶å¿…é¡»é‡‡ç”¨ç»å¯¹è·¯å¾„åã€‚ä¸ç®¡å½“å‰çš„å·¥ä½œç›®å½•æ˜¯ä»€ä¹ˆï¼Œç»å¯¹è·¯å¾„åæ€»èƒ½æ­£å¸¸å·¥ä½œã€‚ æ”¯æŒæ ‘å½¢ç›®å½•ç»“æ„çš„å¤§å¤šæ•°æ–‡ä»¶ç³»ç»Ÿåœ¨æ¯ä¸ªç›®å½•ä¸­æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„ç›®å½•é¡¹â€œ.â€å’Œâ€œ..â€ã€‚â€œ.â€æŒ‡å½“å‰ç›®å½•ï¼Œâ€œ..â€æŒ‡å½“å‰ç›®å½•çš„çˆ¶ç›®å½•ã€‚ä¹Ÿå°±æ˜¯è¯´å½“åœ¨UNIXçš„ç»ˆç«¯æˆ–Windowsçš„å‘½ä»¤æç¤ºç¬¦ä¸­è¾“å…¥å‘½ä»¤â€œcd..â€æ—¶ï¼Œå°†è¿”å›ä¸Šä¸€å±‚ç›®å½•ï¼Œå¦‚æœå·²ç»åˆ°æ ¹ç›®å½•ï¼Œå†æ‰§è¡Œè¯¥å‘½ä»¤ï¼Œå½“å‰ç›®å½•å°†ä¸€ç›´ç•™åœ¨æ ¹ç›®å½•ã€‚ ä¸‰ã€ç›®å½•æ“ä½œ æœ¬èŠ‚ä»¥UNIXç³»ç»Ÿä¸ºä¾‹ï¼Œè¯´æ˜å¯¹ç›®å½•çš„æ“ä½œã€‚ 1.CREATE æ ¹æ®ç»™å®šçš„ç›®å½•æ–‡ä»¶åï¼Œåˆ›å»ºç›®å½•ã€‚é™¤äº†ç›®å½•é¡¹â€œ.â€å’Œâ€œ..â€å¤–ï¼Œç›®å½•å†…å®¹ä¸ºç©ºã€‚â€œ.â€å’Œ â€œ..â€æ˜¯ç³»ç»Ÿè‡ªåŠ¨æ”¾åœ¨ç›®å½•ä¸­çš„ã€‚ 2.DELETE åˆ é™¤ç›®å½•ï¼Œæ ¹æ®æŒ‡å®šçš„ç›®å½•ååˆ é™¤ä¸€ä¸ªç›®å½•æ–‡ä»¶ã€‚ 3.OPENDIR ç›®å½•å†…å®¹å¯ä»¥è¢«è¯»å–ã€‚ä¾‹å¦‚ï¼Œä¸ºåˆ—å‡ºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ï¼Œç¨‹åºå¿…é¡»å…ˆæ‰“å¼€è¯¥ç›®å½•ï¼Œç„¶åè¯»å–å…¶ä¸­æ‰€æœ‰æ–‡ä»¶çš„æ–‡ä»¶åï¼ŒåŒæ‰“å¼€å’Œè¯»å–æ–‡ä»¶ä¸€æ ·ï¼Œåœ¨è¯»ç›®å½•ä¹‹å‰å¿…é¡»æ‰“å¼€ç›®å½•ã€‚ 4.CLOSEDIR è¯»ç›®å½•ç»“æŸåï¼Œåº”å…³é—­ç›®å½•ä»¥é‡Šæ”¾å†…éƒ¨è¡¨ç©ºé—´ã€‚ 5.READDIR ä»¥æ ‡å‡†æ ¼å¼è¿”å›æ‰“å¼€ç›®å½•çš„ä¸‹ä¸€çº§ç›®å½•é¡¹ã€‚ 6.RENAME æ›´æ¢ç›®å½•åã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äº”ç« _æ–‡ä»¶ç³»ç»Ÿ/ç¬¬ä¸‰èŠ‚_æ–‡ä»¶ç³»ç»Ÿçš„å®ç°.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬äº”ç« _æ–‡ä»¶ç³»ç»Ÿ/ç¬¬ä¸‰èŠ‚_æ–‡ä»¶ç³»ç»Ÿçš„å®ç°.html","title":"ç¬¬ä¸‰èŠ‚ æ–‡ä»¶ç³»ç»Ÿçš„å®ç°","keywords":"","body":"ç¬¬ä¸‰èŠ‚ æ–‡ä»¶ç³»ç»Ÿçš„å®ç° å‰é¢è®¨è®ºçš„æ–‡ä»¶ç³»ç»Ÿï¼Œä¸»è¦æ˜¯ä»ç”¨æˆ·çš„è§’åº¦æ¢è®¨é—®é¢˜ã€‚ç”¨æˆ·å…³å¿ƒçš„æ˜¯æ–‡ä»¶æ€æ ·å‘½åã€å¯ä»¥è¿›è¡Œå“ªäº›æ“ä½œã€ç›®å½•æ ‘æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œä»¥åŠç±»ä¼¼ç•Œé¢é—®é¢˜ã€‚è€Œå®ç°è€…æ„Ÿå…´è¶£çš„æ˜¯æ–‡ä»¶å’Œç›®å½•æ˜¯æ€æ ·å­˜å‚¨çš„ã€æ–‡ä»¶çš„å­˜å‚¨ç©ºé—´æ˜¯æ€æ ·ç®¡ç†çš„ï¼Œä»¥åŠæ€æ ·ä½¿ç³»ç»Ÿæœ‰æ•ˆè€Œå¯é åœ°å·¥ä½œç­‰ã€‚ä¸‹é¢ï¼Œä»è®¾è®¡è€…å’Œå®ç°è€…çš„è§’åº¦è®¨è®ºæ–‡ä»¶ç³»ç»Ÿæ˜¯å¦‚ä½•å®ç°çš„ã€‚ ä¸€ã€å®ç°æ–‡ä»¶ æœ¬èŠ‚ä»¥æ–‡ä»¶å­˜æ”¾åœ¨ç£ç›˜ä¸­ä¸ºä¾‹ï¼Œè¯´æ˜å®ç°æ–‡ä»¶å­˜å‚¨çš„å‡ ç§å¸¸ç”¨æ–¹å¼ã€‚æ–‡ä»¶ç³»ç»Ÿé€šå¸¸æ˜¯ä»¥2â¿ä¸ªè¿ç»­çš„æ‰‡åŒºä¸ºå•ä½å¯¹æ–‡ä»¶è¿›è¡Œç£ç›˜ç©ºé—´çš„åˆ†é…ï¼Œä¸‹é¢æŠŠåˆ†é…ç»™æ–‡ä»¶çš„è¿ç»­æ‰‡åŒºæ„æˆçš„ç£ç›˜å—ç§°ä¸ºç°‡ã€‚ 1.è¿ç»­åˆ†é… é¡¾åæ€ä¹‰ï¼Œè¿ç»­åˆ†é…å°±æ˜¯æŠŠæ¯ä¸ªæ–‡ä»¶ä½œä¸ºä¸€è¿ä¸²è¿ç»­æ•°æ®å—å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚ä¾‹å¦‚ï¼Œç³»ç»Ÿè§„å®šçš„ç°‡å¤§å°ä¸º1KBï¼Œåˆ™å­˜å‚¨5KBå¤§å°çš„æ–‡ä»¶ï¼Œéœ€è¦5ä¸ªè¿ç»­çš„ç°‡ã€‚è‹¥ç°‡å¤§å°ä¸º2KB,åˆ™å­˜å‚¨5KBå¤§å°çš„æ–‡ä»¶éœ€è¦åˆ†é…3ä¸ªè¿ç»­çš„ç°‡ï¼Œæœ€åä¸€ä¸ªç°‡ä¸­ï¼Œæœ‰1KBçš„ç£ç›˜ç©ºé—´å°†ä¸èƒ½ä½¿ç”¨ï¼Œä¸‹ä¸€ä¸ªæ–‡ä»¶è¦ä»ä¸€ä¸ªæ–°çš„ç°‡å¼€å§‹ï¼Œå¦‚å›¾5-6æ‰€ç¤ºã€‚ è¿ç»­åˆ†é…æ–¹å¼æœ‰ä¸¤å¤§ä¼˜ç‚¹ã€‚é¦–å…ˆï¼Œå®ç°ç®€å•ï¼Œè®°å½•æ¯ä¸ªæ–‡ä»¶ç”¨åˆ°çš„ç°‡ä»…éœ€å­˜å‚¨ä¸¤ä¸ªæ•°å­—å³å¯ï¼šç¬¬ä¸€å—çš„ç£ç›˜åœ°å€å’Œæ–‡ä»¶çš„å—æ•°ã€‚ç»™å®šç¬¬ä¸€å—çš„ç°‡å·ï¼Œå°±å¯ä»¥æ‰¾åˆ°ä»»ä½•å…¶ä»–å—çš„ç°‡å·ã€‚å…¶æ¬¡ï¼Œè¯»æ“ä½œæ€§èƒ½å¥½ï¼Œåœ¨å•ä¸ªæ“ä½œä¸­å°±èƒ½ä»ç£ç›˜ä¸Šè¯»å–æ•´ä¸ªæ–‡ä»¶ã€‚åªéœ€è¦å¯»æ‰¾ä¸€æ¬¡ç¬¬ä¸€ä¸ªå—ï¼Œä¹‹åä¸å†éœ€è¦å¯»é“å’Œæ—‹è½¬å»¶è¿Ÿï¼Œæ‰€ä»¥æ•°æ®ä»¥ç£ç›˜å…¨å¸¦å®½çš„é€Ÿç‡è¾“å…¥ã€‚ ä½†æ˜¯ï¼Œè¿ç»­åˆ†é…æ–¹å¼ä¹Ÿæœ‰ååˆ†æ˜æ˜¾çš„ç¼ºç‚¹ï¼šéšç€æ—¶é—´çš„æ¨ç§»ï¼Œç£ç›˜ä¼šå˜å¾—é›¶ç¢ã€‚å½“åˆ é™¤æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶æ‰€å çš„ç°‡è¢«é‡Šæ”¾ï¼Œè¿™äº›ç©ºé—²çš„è¿ç»­ç°‡å½¢æˆâ€œç©ºæ´â€ã€‚éšç€ç£ç›˜çš„ä½¿ç”¨ï¼Œç£ç›˜ä¸Šä¼šæœ‰è®¸å¤šç©ºæ´ã€‚å½“ç£ç›˜è¢«å……æ»¡è€Œåˆéœ€è¦åˆ›å»ºæ–°æ–‡ä»¶æ—¶ï¼Œéœ€è¦æŒ‘é€‰å¤§å°åˆé€‚çš„ç©ºæ´å­˜å…¥æ–‡ä»¶ï¼Œè¿™æ—¶å°±æœ‰å¿…è¦çŸ¥é“è¯¥æ–‡ä»¶çš„æœ€ç»ˆå¤§å°ã€‚ä½†å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæ— æ³•é¢„çŸ¥ä¸€ä¸ªæ–‡ä»¶çš„æœ€ç»ˆå¤§å°ï¼Œæ¯”å¦‚å½•å…¥ä¸€ä¸ªæ–‡æ¡£ï¼Œæ–‡æ¡£çš„å†…å®¹æœ‰å¤šå°‘ï¼Œéœ€è¦å ç”¨å¤šå¤§ç©ºé—´éƒ½æ˜¯æœªçŸ¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ–‡ä»¶çš„å¤§å°å¯å˜ï¼Œç³»ç»Ÿç®¡ç†æ–‡ä»¶çš„å­˜å‚¨ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚ 2.ä½¿ç”¨ç£ç›˜é“¾æ¥è¡¨çš„åˆ†é… è¯¥æ–¹æ³•ä¸ºæ¯ä¸ªæ–‡ä»¶æ„é€ ç°‡çš„é“¾æ¥è¡¨ï¼Œæ¯ä¸ªç°‡å¼€å§‹çš„å‡ ä¸ªå­—èŠ‚ç”¨äºå­˜æ”¾ä¸‹ä¸€ä¸ªç°‡çš„ç°‡å·ï¼Œç°‡çš„å…¶ä»–éƒ¨åˆ†å­˜æ”¾æ•°æ®ï¼Œæ¯ä¸ªæ–‡ä»¶å¯ä»¥å­˜æ”¾åœ¨ä¸è¿ç»­çš„ç°‡ä¸­ã€‚åœ¨ç›®å½•é¡¹ä¸­åªéœ€å­˜æ”¾ç¬¬ä¸€ä¸ªæ•°æ®å—çš„ç£ç›˜åœ°å€ï¼Œæ–‡ä»¶çš„å…¶ä»–å—å¯ä»¥æ ¹æ®è¿™ä¸ªåœ°å€æ¥æŸ¥æ‰¾ã€‚å¦‚å›¾5-7æ‰€ç¤ºï¼ŒæŸæ–‡ä»¶çš„æ•°æ®ä¿¡æ¯éœ€è¦å ç”¨5ä¸ªç°‡ï¼Œç¬¬0å—æ•°æ®å­˜å‚¨åœ¨4å·ç°‡ä¸­ï¼Œç¬¬1å—æ•°æ®å­˜å‚¨åœ¨7å·ç°‡ä¸­ï¼Œç¬¬2å—æ•°æ®å­˜å‚¨åœ¨2å·ç°‡ä¸­ï¼Œç¬¬3å—æ•°æ®å­˜å‚¨åœ¨10å·ç°‡ä¸­ï¼Œç¬¬4å—æ•°æ®å­˜å‚¨åœ¨12å·ç°‡ä¸­ã€‚4å·ç°‡çš„èµ·å§‹å­—èŠ‚ä¸­å­˜æ”¾äº†1å·æ•°æ®å—æ‰€åœ¨ç°‡çš„ç°‡å·7ï¼Œ7å·ç°‡çš„èµ·å§‹å­—èŠ‚ä¸­å­˜æ”¾äº†2å·æ•°æ®å—æ‰€åœ¨ç°‡çš„ç°‡å·2ï¼Œ2å·ç°‡çš„èµ·å§‹å­—èŠ‚å­˜æ”¾äº†3å·æ•°æ®å—æ‰€åœ¨ç°‡çš„ç°‡å·10ï¼Œ10å·ç°‡çš„èµ·å§‹å­—èŠ‚å­˜æ”¾äº†4å·æ•°æ®å—æ‰€åœ¨ç°‡çš„ç°‡å·12ã€‚12å·ç°‡çš„èµ·å§‹å­—èŠ‚å­˜æ”¾æ–‡ä»¶ç»“æŸæ ‡å¿—ï¼Œè¡¨ç¤º12å·ç°‡æ˜¯å­˜æ”¾è¯¥æ–‡ä»¶çš„æœ€åä¸€ä¸ªç°‡ã€‚å¯¹è¯¥æ–‡ä»¶çš„æŸ¥æ‰¾è¿‡ç¨‹æ˜¯å…ˆæ ¹æ®è¯¥æ–‡ä»¶çš„æ–‡ä»¶åæœç´¢ç›®å½•æ–‡ä»¶ï¼Œæ‰¾åˆ°è¯¥æ–‡ä»¶çš„ç›®å½•é¡¹ï¼Œä»ç›®å½•é¡¹ä¸­å¾—åˆ°ç¬¬0ä¸ªæ•°æ®å—æ‰€åœ¨çš„ç°‡å·4ï¼Œä»4å·ç°‡çš„èµ·å§‹å­—èŠ‚å¾—åˆ°ç¬¬1å·æ•°æ®å—æ‰€åœ¨çš„ç°‡å·7ï¼Œä¾æ­¤è·å¾—æ‰€æœ‰æ•°æ®æ‰€åœ¨çš„ç°‡å·ï¼Œè®¿é—®æ–‡ä»¶çš„æ•°æ®ã€‚ è¿™ä¸€æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥å……åˆ†åˆ©ç”¨æ¯ä¸ªç°‡ï¼Œä¸ä¼šå› ä¸ºç£ç›˜ç¢ç‰‡ï¼ˆé™¤äº†æœ€åä¸€å—ä¸­çš„å†…éƒ¨ç¢ç‰‡)è€Œæµªè´¹å­˜å‚¨ç©ºé—´ï¼Œç®¡ç†ä¹Ÿæ¯”è¾ƒç®€å•ã€‚ç¼ºç‚¹æ˜¯éšæœºå­˜å–ç›¸å½“ç¼“æ…¢ã€‚è¦è·å¾—æ–‡ä»¶çš„ç¬¬nå—ï¼Œæ¯ä¸€æ¬¡éƒ½è¦ä»å¤´å¼€å§‹è¯»å–å‰é¢çš„n-1å—ã€‚æ˜¾ç„¶ï¼Œè¿›è¡Œå¦‚æ­¤å¤šçš„è¯»æ“ä½œä¼šå ç”¨å¾ˆå¤šæ—¶é—´ã€‚ 3.ä½¿ç”¨å†…å­˜çš„é“¾æ¥è¡¨åˆ†é… è¯¥æ–¹æ³•æ˜¯å°†æ–‡ä»¶æ‰€åœ¨çš„ç£ç›˜çš„ç°‡å·å­˜æ”¾åœ¨å†…å­˜çš„è¡¨ï¼ˆæ–‡ä»¶åˆ†é…è¡¨ï¼‰ä¸­ï¼Œè®¿é—®æ–‡ä»¶æ—¶ï¼Œåªéœ€ä»å†…å­˜æ–‡ä»¶åˆ†é…è¡¨ä¸­é¡ºç€æŸç§é“¾æ¥å…³ç³»æŸ¥æ‰¾ç°‡çš„ç°‡å·ã€‚ä¸ç®¡æ–‡ä»¶æœ‰å¤šå¤§ï¼Œåœ¨ç›®å½•é¡¹ä¸­åªéœ€è®°å½•æ–‡ä»¶çš„ç¬¬ä¸€å—æ•°æ®æ‰€åœ¨ç°‡çš„ç°‡å·ï¼Œæ ¹æ®å®ƒæŸ¥æ‰¾åˆ°æ–‡ä»¶çš„æ‰€æœ‰å—ã€‚ MS-DOSå°±ä½¿ç”¨è¿™ç§æ–¹æ³•è¿›è¡Œç£ç›˜åˆ†é…ã€‚å›¾5-8è¡¨ç¤ºäº†å›¾5-7æ‰€ç¤ºä¾‹å­çš„æ–‡ä»¶åˆ†é…è¡¨çš„å†…å®¹ã€‚è¯¥æ–‡ä»¶ä¾æ¬¡ä½¿ç”¨äº†ç°‡å·ä¸º4ã€7ã€2ã€10å’Œ12çš„ç£ç›˜å—ã€‚è®¿é—®è¯¥æ–‡ä»¶æ—¶ï¼Œå…ˆæ ¹æ®æ–‡ä»¶åæ£€ç´¢ç›®å½•æ–‡ä»¶ï¼Œä»ç›®å½•æ–‡ä»¶ä¸­è·å¾—æ–‡ä»¶ç¬¬0å·æ•°æ®å—æ‰€åœ¨çš„ç°‡å·4ï¼Œç„¶ååˆ©ç”¨å›¾5-8ä¸­çš„æ–‡ä»¶åˆ†é…è¡¨ï¼Œä»ç¬¬4å·è¡¨é¡¹ä¸­è¯»åˆ°ç°‡å·7ï¼Œä»7å·è¡¨é¡¹ä¸­è¯»åˆ°ç°‡å·2ï¼Œä»2å·è¡¨é¡¹ä¸­è¯»åˆ°ç°‡å·10ï¼Œä»10å·è¡¨é¡¹ä¸­è¯»åˆ°ç°‡å·12ã€‚åœ¨12å·è¡¨é¡¹ä¸­å­˜è¯¥æ–‡ä»¶çš„ç»“æŸæ ‡å¿—ï¼Œè‡³æ­¤æ‰¾åˆ°å›¾5-7æ‰€ç¤ºä¾‹å­ä¸­çš„æ–‡ä»¶å ç”¨çš„å…¨éƒ¨ç°‡çš„ç°‡å·ã€‚ è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯å¿…é¡»æŠŠæ•´ä¸ªè¡¨éƒ½å­˜æ”¾åœ¨å†…å­˜ä¸­ã€‚å¯¹äºç›®å‰æ¯”è¾ƒå¸¸è§çš„500GBçš„ç£ç›˜ï¼Œå¦‚æœç°‡å¤§å°ä¸º1KBï¼Œè¿™å¼ è¡¨éœ€è¦æœ‰500Mä¸ªè¡¨é¡¹ï¼Œæ¯ä¸€é¡¹å¯¹åº”ä¸€ä¸ªç°‡ã€‚è‹¥æ¯é¡¹å 4ä¸ªå­—èŠ‚ï¼Œæ ¹æ®ç³»ç»Ÿå¯¹ç©ºé—´æˆ–æ—¶é—´çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œè¿™å¼ è¡¨è¦å ç”¨çº¦2GBçš„å†…å­˜(500MÃ—4B)ã€‚å¾ˆæ˜¾ç„¶ï¼Œè¿™ç§æ–¹æ³•ä¸é€‚åˆå¤§å®¹é‡çš„ç£ç›˜ã€‚ 4.i-ç»“ç‚¹ è¯¥æ–¹æ³•ä¸ºæ¯ä¸ªæ–‡ä»¶èµ‹äºˆä¸€ä¸ªè¢«ç§°ä¸ºiç»“ç‚¹çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­åˆ—å‡ºäº†æ–‡ä»¶å±æ€§å’Œæ–‡ä»¶å—çš„ç£ç›˜åœ°å€ã€‚å›¾5-9æ‰€ç¤ºæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚ç»™å®šä¸€ä¸ªæ–‡ä»¶çš„iç»“ç‚¹ï¼Œå°±æœ‰å¯èƒ½æ‰¾åˆ°æ–‡ä»¶çš„æ‰€æœ‰å—ã€‚ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶æ—¶ï¼Œå°†æ–‡ä»¶çš„â…°ç»“ç‚¹ä»ç£ç›˜è¯»å…¥å†…å­˜ã€‚å½“è®¿é—®æ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿå…ˆæ ¹æ®æ–‡ä»¶åæœç´¢æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•æ–‡ä»¶ï¼Œä»è¯¥æ–‡ä»¶å¯¹åº”çš„ç›®å½•é¡¹ä¸­æ‰¾åˆ°æ–‡ä»¶çš„iç»“ç‚¹å·ï¼Œæ ¹æ®â…°ç»“ç‚¹å·ä»ç£ç›˜ä¸­å°†iç»“ç‚¹ä¿¡æ¯è¯»å…¥å†…å­˜ï¼Œæ–‡ä»¶åœ¨ç£ç›˜ä¸­çš„åœ°å€ä¿¡æ¯éƒ½å­˜æ”¾åœ¨iç»“ç‚¹ä¸­ã€‚ å¦‚æœæ¯ä¸ªiç»“ç‚¹åªèƒ½å­˜å‚¨å›ºå®šæ•°é‡çš„ç£ç›˜åœ°å€ï¼Œé‚£ä¹ˆå½“ä¸€ä¸ªæ–‡ä»¶æ¯”è¾ƒå¤§ï¼Œæ‰€å«ç°‡çš„æ•°ç›®å¤ªå¤šæ—¶ï¼Œiç»“ç‚¹å°†æ— æ³•è®°å½•æ‰€æœ‰çš„ç°‡å·ã€‚ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯é‡‡ç”¨é—´æ¥åœ°å€ï¼Œä½¿ä¸€ä¸ªâ€œç£ç›˜åœ°å€â€ä¸å­˜æ”¾æ•°æ®å—ï¼Œè€Œæ˜¯å­˜æ”¾ç°‡å·ã€‚å¯¹äºä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œâ…°ç»“ç‚¹å†…çš„å…¶ä¸­ä¸€ä¸ªåœ°å€æ˜¯ä¸€æ¬¡é—´æ¥å—çš„ç°‡å·ï¼Œè¿™ä¸ªå—åŒ…å«äº†å­˜æ”¾æ–‡ä»¶æ•°æ®çš„ç°‡çš„ç°‡å·ã€‚å¦‚æœè¿˜ä¸å¤Ÿçš„è¯ï¼Œåœ¨iç»“ç‚¹ä¸­è¿˜æœ‰äºŒæ¬¡é—´æ¥å—çš„ç°‡å·ï¼Œå…¶ä¸­å­˜æ”¾äº†è‹¥å¹²ä¸ªä¸€æ¬¡é—´æ¥å—çš„ç°‡å·ã€‚æ–‡ä»¶å†å¤§çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸‰æ¬¡é—´æ¥å—ï¼Œå¦‚å›¾5-9æ‰€ç¤ºã€‚ Linuxçš„Ext2æ–‡ä»¶ç³»ç»Ÿçš„ä¸€ä¸ªiç»“ç‚¹åŒ…æ‹¬15ä¸ªåœ°å€é¡¹ï¼Œæ¯ä¸ªåœ°å€é¡¹å­˜32ä½åœ°å€(4ä¸ªå­—èŠ‚)ï¼Œç”¨å…¶ä¸­12ä¸ªåœ°å€é¡¹å­˜ç›´æ¥åœ°å€ï¼Œä¸€ä¸ªåœ°å€é¡¹å­˜ä¸€æ¬¡é—´æ¥åœ°å€ï¼Œä¸€ä¸ªåœ°å€é¡¹å­˜äºŒæ¬¡é—´æ¥åœ°å€ï¼Œä¸€ä¸ªåœ°å€é¡¹å­˜ä¸‰æ¬¡é—´æ¥åœ°å€ã€‚å½“ç°‡å¤§å°ä¸º1KBæ—¶ï¼Œç³»ç»Ÿèƒ½ç®¡ç†çš„å•ä¸ªæ–‡ä»¶çš„æœ€å¤§é•¿åº¦è¯¥å¦‚ä½•è®¡ç®—å‘¢ï¼Ÿ é¦–å…ˆï¼Œ12ä¸ªåœ°å€é¡¹å­˜æ”¾çš„æ˜¯ç°‡å·ï¼Œæ‰€ä»¥12ä¸ªç›´æ¥åœ°å€å¯è¡¨ç¤ºçš„æ–‡ä»¶å¤§å°ä¸º12Ã—1KB=12KBã€‚å…¶æ¬¡ï¼Œæ¯ä¸ªç°‡å¤§å°ä¸º1KBï¼Œæ¯ä¸ªåœ°å€é¡¹å 4ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ï¼Œæ¯ä¸ªç°‡ä¸­å¯ä»¥å­˜æ”¾256ä¸ªç°‡å·ã€‚è¿™æ ·ï¼Œä¸€æ¬¡é—´æ¥å—å¯ä»¥è¡¨ç¤ºçš„æ–‡ä»¶å¤§å°ä¸º256Ã—1KB=256KBã€‚ä»¥æ­¤ç±»æ¨ï¼ŒäºŒæ¬¡é—´æ¥å—å¯ä»¥è¡¨ç¤ºçš„æ–‡ä»¶å¤§å°ä¸º256Ã—256Ã—1KB=64MBã€‚ä¸‰æ¬¡é—´æ¥å—å¯ä»¥è¡¨ç¤ºçš„æ–‡ä»¶å¤§å°ä¸º256Ã—256Ã—256Ã—1KB=16GBã€‚æœ€åï¼Œä¸€ä¸ªæ–‡ä»¶çš„æœ€å¤§é•¿åº¦ä¸º12KB+256KB+64MB+16GBã€‚ äºŒã€å®ç°ç›®å½• ç³»ç»Ÿåœ¨è¯»æ–‡ä»¶å‰ï¼Œå¿…é¡»å…ˆæ‰“å¼€æ–‡ä»¶ã€‚æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œæ“ä½œç³»ç»Ÿåˆ©ç”¨ç”¨æˆ·ç»™å‡ºçš„è·¯å¾„åæ‰¾åˆ°ç›¸åº”çš„ç›®å½•é¡¹ï¼Œç›®å½•é¡¹ä¸­æä¾›äº†æŸ¥æ‰¾æ–‡ä»¶ç°‡æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚ä¸‹é¢ï¼Œä»¥CP/Mã€MS-DOSå’ŒUNIXä¸ºä¾‹ï¼Œè¯´æ˜3ç§ä¸åŒçš„ç›®å½•å®ç°æ–¹å¼ã€‚ 1.CP/Mä¸­çš„ç›®å½• CP/Mæ˜¯ä¸€ä¸ªå¾®æœºæ“ä½œç³»ç»Ÿï¼Œå®ƒåªæœ‰ä¸€å±‚ç›®å½•ï¼Œå› æ­¤åªæœ‰ä¸€ä¸ªç›®å½•æ–‡ä»¶ã€‚è¦æŸ¥æ‰¾æ–‡ä»¶åï¼Œå°±æ˜¯åœ¨è¿™ä¸ªå”¯ä¸€çš„ç›®å½•æ–‡ä»¶ä¸­æ‰¾åˆ°æ–‡ä»¶å¯¹åº”çš„ç›®å½•é¡¹ï¼Œä»ç›®å½•é¡¹ä¸­è·å¾—æ–‡ä»¶å­˜æ”¾çš„ç£ç›˜åœ°å€ã€‚å›¾5-10æ‰€ç¤ºä¸ºCP/Mçš„ç›®å½•é¡¹ç»“æ„ã€‚å…¶ä¸­ï¼Œå„å­—æ®µçš„å«ä¹‰å¦‚ä¸‹ã€‚ 1)ç”¨æˆ·ç ï¼šè®°å½•äº†æ–‡ä»¶æ‰€æœ‰è€…ã€‚ 2)æ–‡ä»¶åï¼šå­˜æ”¾æ–‡ä»¶åã€‚ 3)æ‰©å±•åï¼šæ ‡è¯†æ–‡ä»¶ç±»å‹ã€‚ 4)èŒƒå›´ï¼šç”±è¯¥åŸŸå¯çŸ¥æŸç›®å½•é¡¹æ˜¯æ–‡ä»¶çš„ç¬¬å‡ ä¸ªç›®å½•é¡¹ï¼Œå› ä¸ºä¸€ä¸ªå¾ˆå¤§çš„æ–‡ä»¶ï¼ˆå¤§äº16KB)ï¼Œå…¶ç°‡çš„æ•°é‡å¤šï¼Œåœ¨ä¸€ä¸ªç›®å½•é¡¹ä¸­è®°å½•ä¸ä¸‹ã€‚ 5)å—æ•°ï¼šæ–‡ä»¶å®é™…ä½¿ç”¨çš„ç°‡çš„æ•°é‡ã€‚ 6)æœ€å16ä¸ªåŸŸè®°å½•äº†ç°‡å·ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ–‡ä»¶å ç”¨çš„æœ€åä¸€ä¸ªç°‡å¯èƒ½æ²¡æœ‰å†™æ»¡ï¼Œè¿™æ ·ç³»ç»Ÿæ— æ³•ç¡®åˆ‡åœ°çŸ¥é“æ–‡ä»¶çš„ å­—èŠ‚æ•°ï¼Œå› ä¸ºCP/Mæ˜¯ä»¥ç°‡è€Œä¸æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½æ¥è®°å½•æ–‡ä»¶é•¿åº¦çš„ã€‚ 2.MS-D0Sä¸­çš„ç›®å½• MS-DOSæ–‡ä»¶ç³»ç»Ÿæ›¾ç»æ˜¯IBM PCç³»åˆ—æ‰€é‡‡ç”¨çš„æ–‡ä»¶ç³»ç»Ÿï¼Œç›®å‰å®ƒå·²ç»ä¸å†æ˜¯æ–°çš„PCæ–‡ä»¶ç³»ç»Ÿçš„æ ‡å‡†äº†ï¼Œä½†å®ƒå’Œå®ƒçš„æ‰©å±•(FAT32)ä¸€ç›´è¢«è®¸å¤šåµŒäººå¼ç³»ç»Ÿæ‰€å¹¿æ³›ä½¿ç”¨ã€‚å¤§éƒ¨åˆ†çš„æ•°ç ç›¸æœºä½¿ç”¨å®ƒï¼Œè®¸å¤šMP3æ’­æ”¾å™¨ä½¿ç”¨å®ƒï¼Œæµè¡Œçš„è‹¹æœå…¬å¸çš„iPodä½¿ç”¨å®ƒä½œä¸ºé»˜è®¤çš„æ–‡ä»¶ç³»ç»Ÿã€‚ç°åœ¨ä½¿ç”¨MS-DOSæ–‡ä»¶ç³»ç»Ÿçš„ç”µå­è®¾å¤‡æ•°é‡è¿œè¿œå¤šäºè¿‡å»ï¼Œå¹¶ä¸”è¿œè¿œå¤šäºä½¿ç”¨æ›´ç°ä»£çš„NTFSæ–‡ä»¶ç³»ç»Ÿçš„æ•°é‡ã€‚ä¸‹é¢ä»‹ç»å…¶ä¸­çš„ä¸€äº›ç»†èŠ‚ã€‚ å›¾5-11æ‰€ç¤ºæ˜¯ä¸€ä¸ªMS-D0Sçš„ç›®å½•é¡¹ã€‚å®ƒæ€»å…±32ä¸ªå­—èŠ‚ï¼Œå…¶ä¸­åŒ…å«äº†8ä¸ªå­—èŠ‚çš„æ–‡ä»¶åã€1ä¸ªå­—èŠ‚çš„æ–‡ä»¶å±æ€§å’Œ2ä¸ªå­—èŠ‚çš„æ–‡ä»¶ç¬¬ä¸€ä¸ªç°‡çš„ç°‡å·ã€‚æ ¹æ®ç¬¬ä¸€ä¸ªç°‡å·ï¼Œé¡ºç€ç´¢å¼•é“¾è¡¨å¯ä»¥æ‰¾åˆ°æ‰€æœ‰çš„æ–‡ä»¶å—ã€‚MS-D0Sä¸­ï¼Œç›®å½•å¯ä»¥åŒ…å«å…¶ä»–å­ç›®å½•ï¼Œä»è€Œå½¢æˆæ ‘å½¢ç›®å½•ã€‚ MS-DOSç”¨æ–‡ä»¶åˆ†é…è¡¨å³FATä½œä¸ºç´¢å¼•è¡¨æ¥å­˜æ”¾æ–‡ä»¶æ•°æ®æ‰€åœ¨ç°‡çš„ç°‡å·ã€‚ç›®å½•é¡¹åŒ…å«äº†æ–‡ä»¶ç¬¬ä¸€ä¸ªæ•°æ®å—æ‰€åœ¨ç°‡çš„ç°‡å·ï¼Œå°†è¿™ä¸ªç°‡å·ç”¨ä½œFATçš„ç´¢å¼•ï¼Œå¯ä¾æ¬¡æ‰¾åˆ°æ–‡ä»¶çš„æ‰€æœ‰å—ã€‚FATçš„ç»“æ„è§å‰é¢çš„å›¾5-8ã€‚ FATæ–‡ä»¶ç³»ç»Ÿæœ‰3ä¸ªç‰ˆæœ¬ï¼šFAT-12,FAT-16å’ŒFAT-32ï¼Œå–å†³äºç”¨å¤šå°‘ä¸ªäºŒè¿›åˆ¶ä½å­˜æ”¾ç°‡å·ã€‚ 3.UNIXä¸­çš„ç›®å½• UNIXä¸­é‡‡ç”¨çš„ç›®å½•ç»“æ„éå¸¸ç®€å•ï¼Œå¦‚å›¾5-12æ‰€ç¤ºï¼Œæ¯ä¸ªç›®å½•é¡¹åªåŒ…å«ä¸€ä¸ªæ–‡ä»¶ååŠå…¶iç»“ç‚¹å·ã€‚æœ‰å…³æ–‡ä»¶ç±»å‹ã€é•¿åº¦ã€æ—¶é—´ã€æ‰€æœ‰è€…å’Œç°‡å·ç­‰ä¿¡æ¯éƒ½æ”¾åœ¨â…°ç»“ç‚¹ä¸­ã€‚å½“æ‰“å¼€æŸä¸ªæ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶ç³»ç»Ÿå¿…é¡»è¦è·å¾—æ–‡ä»¶åå¹¶ä¸”å®šä½æ–‡ä»¶æ‰€åœ¨çš„ç¬¬ä¸€ä¸ªç°‡ã€‚ä¸‹é¢è¯´æ˜æ–‡ä»¶ç³»ç»Ÿå¯»æ‰¾ä¸€ä¸ªæ–‡ä»¶çš„è¿‡ç¨‹ï¼Œä»¥æŸ¥æ‰¾UNIXä¸­çš„/usr/ast/mboxä¸ºä¾‹ã€‚ é¦–å…ˆï¼Œæ–‡ä»¶ç³»ç»Ÿæ‰¾åˆ°æ ¹ç›®å½•ï¼Œåœ¨UNIXä¸­æ ¹ç›®å½•çš„â…°ç»“ç‚¹ä½äºç£ç›˜çš„å›ºå®šä½ç½®ã€‚ç„¶åï¼Œç³»ç»Ÿè¯»æ ¹ç›®å½•æ–‡ä»¶å¹¶ä¸”åœ¨æ ¹ç›®å½•æ–‡ä»¶ä¸­æŸ¥æ‰¾è·¯å¾„çš„ç¬¬ä¸€éƒ¨åˆ†usrï¼Œè·å¾—æ–‡ä»¶/usrçš„iç»“ç‚¹å·ã€‚ç”±â…°ç»“ç‚¹å·æ¥å®šä½â…°ç»“ç‚¹æ˜¯å¾ˆç›´æ¥çš„ï¼Œå› ä¸ºæ¯ä¸ªiç»“ç‚¹åœ¨ç£ç›˜ä¸Šéƒ½æœ‰å›ºå®šçš„ä½ç½®ã€‚æ ¹æ®è¿™ä¸ªâ…°ç»“ç‚¹å·ï¼Œç³»ç»Ÿå®šä½/usrç›®å½•å¹¶æŸ¥æ‰¾ä¸‹ä¸€éƒ¨åˆ†astã€‚ä¸€æ—¦æ‰¾åˆ°astçš„ç›®å½•é¡¹ï¼Œä¾¿æ‰¾åˆ°äº†/usr/astçš„iç»“ç‚¹ã€‚æ ¹æ®è¿™ä¸ªiç»“ç‚¹ï¼Œå¯ä»¥å®šä½è¯¥ç›®å½•å¹¶åœ¨å…¶ä¸­æŸ¥æ‰¾mboxã€‚ç„¶åï¼Œè¿™ä¸ªæ–‡ä»¶çš„iç»“ç‚¹è¢«è¯»å…¥å†…å­˜ï¼Œå¹¶ä¸”åœ¨æ–‡ä»¶å…³é—­ä¹‹å‰ä¼šä¸€ç›´ä¿ç•™åœ¨å†…å­˜ä¸­ã€‚æŸ¥æ‰¾çš„è¿‡ç¨‹å¦‚å›¾5-13æ‰€ç¤ºã€‚ æç¤ºï¼šç›¸å¯¹è·¯å¾„çš„æŸ¥æ‰¾ä¸ç»å¯¹è·¯å¾„çš„æŸ¥æ‰¾æ–¹æ³•ç›¸åŒï¼Œåªä¸è¿‡æ˜¯ä»å½“å‰å·¥ä½œç›®å½•å¼€å§‹æŸ¥æ‰¾è€Œä¸æ˜¯ä»æ ¹ç›®å½•å¼€å§‹ã€‚ ä¸‰ã€ç£ç›˜ç©ºé—´ç®¡ç† ç£ç›˜ç©ºé—´ç®¡ç†æ˜¯æ–‡ä»¶ç³»ç»Ÿçš„é‡è¦åŠŸèƒ½ï¼ŒåŒ…æ‹¬è®°å½•ç©ºé—²ç£ç›˜ä¿¡æ¯ã€è®¾è®¡æ–‡ä»¶çš„å­˜æ”¾æ–¹å¼ï¼Œä»¥åŠè§„å®šæ–‡ä»¶ç³»ç»Ÿçš„ç°‡å¤§å°ç­‰å†…å®¹ã€‚ 1.ç°‡å¤§å° æ–‡ä»¶ç³»ç»Ÿä¸ºæ–‡ä»¶åˆ†é…ç£ç›˜ç©ºé—´æ˜¯ä»¥ç°‡ä¸ºå•ä½çš„ï¼Œä¸€æ—¦ç”¨å›ºå®šå¤§å°çš„ç°‡æ¥å­˜å‚¨æ–‡ä»¶ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼šç°‡çš„å¤§å°åº”è¯¥æ˜¯å¤šå°‘ï¼Ÿ æ‹¥æœ‰å¤§çš„ç°‡å°ºå¯¸æ„å‘³ç€æ¯ä¸ªæ–‡ä»¶ï¼Œç”šè‡³ä¸€ä¸ªå­—èŠ‚çš„æ–‡ä»¶ï¼Œéƒ½è¦å ç”¨å¾ˆå¤§çš„ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯è¯´å°çš„æ–‡ä»¶æµªè´¹äº†å¤§é‡çš„ç£ç›˜ç©ºé—´ã€‚å¦ä¸€æ–¹é¢ï¼Œå°çš„å°ºå¯¸æ„å‘³ç€å¤§å¤šæ•°æ–‡ä»¶ä¼šè·¨è¶Šå¤šä¸ªç°‡ï¼Œå› æ­¤éœ€è¦å¤šæ¬¡å¯»é“ä¸æ—‹è½¬å»¶è¿Ÿæ‰èƒ½è¯»å‡ºå®ƒä»¬ï¼Œä»è€Œé™ä½äº†æ—¶é—´æ€§èƒ½ã€‚å› æ­¤ï¼Œç°‡å¤ªå¤§ï¼Œå®¹æ˜“é€ æˆç©ºé—´çš„æµªè´¹ï¼›ç°‡å¤ªå°ï¼Œåˆ™ä¼šä½¿è®¿é—®æ–‡ä»¶çš„æ—¶é—´å»¶é•¿ã€‚ ä¸€èˆ¬ç°‡å¤§å°æ˜¯2çš„æ•´æ•°æ¬¡å¹‚ä¸ªè¿ç»­çš„æ‰‡åŒºï¼Œå¦‚1ä¸ªæ‰‡åŒºï¼Œ512ä¸ªå­—èŠ‚ï¼›è¿ç»­ä¸¤ä¸ªæ‰‡åŒºï¼Œå¤§å°ä¸º1KBï¼›è¿ç»­4ä¸ªæ‰‡åŒºï¼Œå¤§å°ä¸º2KBã€‚æ ¹æ®ç³»ç»Ÿç®¡ç†çš„æ–‡ä»¶å¤§å°ï¼Œå¯ä»¥é€‰æ‹©åˆé€‚çš„ç°‡å¤§å°æ¥æ ¼å¼åŒ–ç£ç›˜ã€‚ 2.è®°å½•ç©ºé—²å— ç¡®å®šäº†ç°‡å¤§å°åï¼Œä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯æ€æ ·è·Ÿè¸ªè®°å½•ç©ºé—²ç°‡ã€‚æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•è¢«å¹¿æ³›é‡‡ç”¨ã€‚ (1)ç©ºé—²ç°‡é“¾æ¥è¡¨ ç”¨ä¸€äº›ç©ºé—²ç°‡å­˜æ”¾ç©ºé—²ç°‡çš„ç°‡å·ã€‚ä¸€ä¸ªç°‡å­˜æ”¾å°½å¯èƒ½å¤šçš„ç©ºé—²ç°‡çš„ç°‡å·ï¼Œå¹¶ä¸“é—¨ç•™å‡ºæœ€åå‡ ä¸ªå­—èŠ‚å­˜æ”¾æŒ‡å‘ä¸‹ä¸€ä¸ªå­˜æ”¾ç©ºé—²ç°‡çš„æŒ‡é’ˆã€‚å¯¹äº1KBå¤§å°çš„ç°‡ï¼Œå¯ä»¥å­˜æ”¾256ä¸ª32ä½çš„ç°‡å·ï¼ˆæœ‰ä¸€ä¸ªå­˜æ”¾æŒ‡å‘ä¸‹ä¸€ä¸ªå—çš„æŒ‡é’ˆï¼‰ã€‚å›¾5-14aæ˜¾ç¤ºäº†è¯¥æ–¹æ³•çš„è®°å½•æ–¹å¼ã€‚ (2)ä½å›¾ ç”¨nä½ä½å›¾å¯¹åº”ç£ç›˜çš„nä¸ªç°‡ï¼Œåœ¨ä½å›¾ä¸­ï¼Œç©ºé—²ç°‡ç”¨1è¡¨ç¤ºï¼Œå·²åˆ†é…ç°‡ç”¨0è¡¨ç¤ºï¼ˆæˆ–è€…åè¿‡æ¥)ï¼Œå¦‚å›¾5-14bæ‰€ç¤ºã€‚å¾ˆæ˜¾ç„¶ï¼Œä½å›¾æ–¹æ³•æ‰€éœ€ç©ºé—´å°‘ï¼Œå› ä¸ºæ¯ä¸ªç°‡åªç”¨ä¸€ä¸ªäºŒè¿›åˆ¶ä½æ ‡è¯†ï¼Œè€Œåœ¨é“¾æ¥è¡¨æ–¹æ³•ä¸­ï¼Œæ¯ä¸€ä¸ªç°‡å·éƒ½è¦ç”¨32ä½ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å…­ç« _I_Oè®¾å¤‡ç®¡ç†/ç¬¬ä¸€èŠ‚_I_Oç³»ç»Ÿçš„ç»„æˆ.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å…­ç« _I_Oè®¾å¤‡ç®¡ç†/ç¬¬ä¸€èŠ‚_I_Oç³»ç»Ÿçš„ç»„æˆ.html","title":"ç¬¬ä¸€èŠ‚ I/Oç³»ç»Ÿçš„ç»„æˆ","keywords":"","body":"ç¬¬å…­ç«  I/Oè®¾å¤‡ç®¡ç† è®¡ç®—æœºç³»ç»Ÿä¸­çš„I/Oè®¾å¤‡å³è¾“å…¥/è¾“å‡ºè®¾å¤‡æ˜¯ç”¨äºè®¡ç®—æœºç³»ç»Ÿä¸äººé€šä¿¡æˆ–ä¸å…¶ä»–æœºå™¨é€šä¿¡çš„æ‰€æœ‰è®¾å¤‡ï¼Œä»¥åŠæ‰€æœ‰å¤–å­˜è®¾å¤‡ã€‚I/Oè®¾å¤‡ç®¡ç†æ˜¯æ“ä½œç³»ç»Ÿçš„é‡è¦åŠŸèƒ½ä¹‹ä¸€ï¼Œä¹Ÿç®€ç§°ä¸ºè®¾å¤‡ç®¡ç†ã€‚ I/Oè®¾å¤‡æ˜¯è®¡ç®—æœºç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œè®¡ç®—æœºI/Oè®¾å¤‡çš„å¤šæ ·æ€§ä½¿è®¾å¤‡çš„ç®¡ç†éå¸¸å¤æ‚ã€‚æœ¬ç« å…ˆä»ç¡¬ä»¶è§’åº¦ä»‹ç»I/Oè®¾å¤‡çš„ä¸€èˆ¬æ„æˆå’Œæ§åˆ¶æ–¹å¼ï¼Œç„¶åä»æ“ä½œç³»ç»Ÿè®¾å¤‡ç®¡ç†è½¯ä»¶çš„è§’åº¦è¯´æ˜I/Oè®¾å¤‡ç®¡ç†è½¯ä»¶çš„æ„æˆå’Œè½¯ä»¶å„ç»„æˆéƒ¨åˆ†çš„åŠŸèƒ½ï¼Œå¹¶è¯´æ˜éƒ¨åˆ†åŠŸèƒ½å®ç°çš„åŸç†ã€‚ ç¬¬ä¸€èŠ‚ I/Oç³»ç»Ÿçš„ç»„æˆ I/Oç³»ç»Ÿä¸ä»…åŒ…æ‹¬å„ç§I/Oè®¾å¤‡ï¼Œè¿˜åŒ…æ‹¬ä¸è®¾å¤‡ç›¸è¿çš„è®¾å¤‡æ§åˆ¶å™¨ï¼Œæœ‰äº›ç³»ç»Ÿè¿˜é…å¤‡äº†ä¸“é—¨ç”¨äºè¾“å…¥/è¾“å‡ºæ§åˆ¶çš„ä¸“ç”¨è®¡ç®—æœºï¼Œå³é€šé“ã€‚æ­¤å¤–ï¼ŒI/Oç³»ç»Ÿè¦é€šè¿‡æ€»çº¿ä¸CPUã€å†…å­˜ç›¸è¿ã€‚æœ¬èŠ‚ä»‹ç»I/Oç³»ç»Ÿçš„ç»“æ„ã€I/Oè®¾å¤‡çš„åˆ†ç±»ã€è®¾å¤‡æ§åˆ¶å™¨çš„åŠŸèƒ½å’Œæ„æˆï¼Œä»¥åŠé€šé“çš„ç‰¹ç‚¹å’ŒåŠŸèƒ½ã€‚ ä¸€ã€I/Oç³»ç»Ÿçš„ç»“æ„ I/Oç³»ç»Ÿçš„ç»“æ„åˆ†ä¸ºå¾®æœºI/Oç³»ç»Ÿå’Œä¸»æœºI/Oç³»ç»Ÿä¸¤å¤§ç±»ã€‚ 1.å¾®æœºI/Oç³»ç»Ÿ æ€»çº¿å‹I/Oç³»ç»Ÿç»“æ„å¦‚å›¾6-1æ‰€ç¤ºã€‚CPUä¸å†…å­˜ä¹‹é—´å¯ä»¥ç›´æ¥è¿›è¡Œä¿¡æ¯äº¤æ¢ï¼Œä½†æ˜¯ä¸èƒ½ä¸è®¾å¤‡ç›´æ¥è¿›è¡Œä¿¡æ¯äº¤æ¢ï¼Œå¿…é¡»ç»è¿‡è®¾å¤‡æ§åˆ¶å™¨ã€‚ 2.ä¸»æœºI/Oç³»ç»Ÿ I/Oç³»ç»Ÿå¯èƒ½é‡‡ç”¨å››çº§ç»“æ„ï¼ŒåŒ…æ‹¬ä¸»æœºã€é€šé“ã€æ§åˆ¶å™¨å’Œè®¾å¤‡ã€‚ä¸€ä¸ªé€šé“å¯ä»¥æ§åˆ¶å¤šä¸ªè®¾å¤‡æ§åˆ¶å™¨ï¼Œä¸€ä¸ªè®¾å¤‡æ§åˆ¶å™¨ä¹Ÿå¯ä»¥æ§åˆ¶å¤šä¸ªè®¾å¤‡ã€‚å›¾6-2æ‰€ç¤ºä¸ºå…·æœ‰é€šé“çš„I/Oç³»ç»Ÿç»“æ„ã€‚ äºŒã€I/Oè®¾å¤‡çš„åˆ†ç±» ä¸åŒåŠŸèƒ½çš„I/Oè®¾å¤‡ç§ç±»ç¹å¤šï¼Œå¯ä»¥æ ¹æ®è®¾å¤‡çš„æŸç§ç‰¹ç‚¹æˆ–åŠŸèƒ½åˆ†åˆ«å¯¹è®¾å¤‡è¿›è¡Œåˆ†ç±»ã€‚æ˜¯å¦éœ€è¦å¯¹è®¾å¤‡è¿›è¡Œåˆ†ç±»ï¼Œå¦‚ä½•åˆ†ç±»ï¼Œå¯æ ¹æ®å®é™…éœ€è¦çš„æƒ…å†µè€Œå®šã€‚ 1.æŒ‰ä¼ è¾“é€Ÿç‡åˆ†ç±» 1)ä½é€Ÿè®¾å¤‡ã€‚å¦‚é”®ç›˜å’Œé¼ æ ‡ï¼Œä¼ è¾“é€Ÿç‡ä¸ºå‡ ä¸ª~å‡ ç™¾ä¸ªå­—èŠ‚/ç§’ã€‚ 2)ä¸­é€Ÿè®¾å¤‡ã€‚å¦‚æ‰“å°æœºï¼Œä¼ è¾“é€Ÿç‡ä¸ºæ•°åƒä¸ª~æ•°ä¸‡ä¸ªå­—èŠ‚/ç§’ã€‚ 3)é«˜é€Ÿè®¾å¤‡ã€‚å¦‚ç£å¸¦æœºã€ç£ç›˜æœºã€å…‰ç›˜æœºï¼Œä¼ è¾“é€Ÿç‡ä¸ºå‡ åä¸‡~å‡ å…†å­—èŠ‚/ç§’ã€‚ 2.æŒ‰ä¿¡æ¯äº¤æ¢çš„å•ä½åˆ†ç±» 1)å—è®¾å¤‡ã€‚æ•°æ®çš„å­˜å–ä»¥æ•°æ®å—ä¸ºå•ä½ï¼Œå¦‚ç£ç›˜ã€‚å—è®¾å¤‡åœ¨å—ä¸­ä¿å­˜ä¿¡æ¯ï¼Œå—çš„å¤§å°é€šå¸¸æ˜¯å›ºå®šçš„ï¼Œå¹¶ä¸”ä¸€æ¬¡åªä¼ é€ä¸€å—ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡å—å·è®¿é—®æ•°æ®ã€‚ 2)å­—ç¬¦è®¾å¤‡ã€‚ä¼ é€å­—èŠ‚æµï¼Œæ²¡æœ‰ä½¿ç”¨å—ç»“æ„ã€‚ç»ˆç«¯ã€æ‰“å°æœºã€é€šä¿¡ç«¯å£å’Œé¼ æ ‡ç­‰éƒ½æ˜¯å­—ç¬¦è®¾å¤‡ã€‚ åœ¨æ“ä½œç³»ç»Ÿå®ç°é©±åŠ¨ç¨‹åºæ—¶ï¼Œé€šå¸¸éœ€è¦åŒºåˆ†ä¸€ä¸ªè®¾å¤‡æ˜¯å—è®¾å¤‡è¿˜æ˜¯å­—ç¬¦è®¾å¤‡ï¼Œæ“ä½œç³»ç»Ÿå¯¹è¿™ä¸¤ç§è®¾å¤‡çš„ç¼“å†²ç®¡ç†å’Œé©±åŠ¨ç¨‹åºçš„å®ç°æ–¹å¼æ˜¯ä¸åŒçš„ã€‚ 3.æŒ‰è®¾å¤‡çš„å…±äº«å±æ€§åˆ†ç±» 1)ç‹¬å è®¾å¤‡ã€‚æ˜¯å¿…é¡»ä½œä¸ºä¸´ç•Œèµ„æºä»¥äº’æ–¥æ–¹å¼è®¿é—®çš„è®¾å¤‡ã€‚åœ¨ä¸€ä¸ªè¿›ç¨‹æ²¡æœ‰ä½¿ç”¨å®Œæ¯•ä¹‹å‰ï¼Œå…¶ä»–ä»»ä½•è¿›ç¨‹ä¸èƒ½è®¿é—®è¯¥è®¾å¤‡ï¼Œç›´åˆ°è®¾å¤‡è¢«é‡Šæ”¾ã€‚ä¾‹å¦‚ï¼Œæ‰“å°æœºæ˜¯å…¸å‹çš„ç‹¬å è®¾å¤‡ã€‚ 2)å…±äº«è®¾å¤‡ã€‚æ˜¯å…è®¸å¤šä¸ªè¿›ç¨‹å…±åŒè®¿é—®çš„è®¾å¤‡ï¼Œå¦‚ç¡¬ç£ç›˜æ˜¯å…¸å‹çš„å…±äº«è®¾å¤‡ã€‚è¿™é‡Œå…±åŒè®¿é—®çš„å«ä¹‰æ˜¯ï¼šä¸€ä¸ªè¿›ç¨‹è®¿é—®è¯¥è®¾å¤‡çš„å…¨éƒ¨ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œå°±å¯ä»¥æŠŠè®¾å¤‡åˆ†é…ç»™å¦ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ã€‚å¦‚è¿›ç¨‹p1éœ€è¦è¯»5ä¸ªç£ç›˜å—çš„æ•°æ®ï¼Œp2éœ€è¦è¯»3ä¸ªç£ç›˜å—çš„æ•°æ®ã€‚å½“è¿›ç¨‹p1è¯»å®Œä¸€ä¸ªç£ç›˜å—åï¼Œå°±å¯ä»¥æŠŠç£ç›˜çš„è®¿é—®æƒåˆ†é…ç»™p2ï¼Œè®©è¿›ç¨‹p2è¯»ä¸€ä¸ªæˆ–è‹¥å¹²ä¸ªç£ç›˜å—ï¼Œå†è®©p1ç»§ç»­è¯»å…¶ä½™çš„ç£ç›˜å—ã€‚å¦‚æœå¿…é¡»è®©pl1è¯»å®Œæ‰€æœ‰5ä¸ªç£ç›˜å—åæ‰èƒ½è®©p2å¼€å§‹è®¿é—®ç£ç›˜ï¼Œé‚£ç£ç›˜å°±æˆäº†ç‹¬å è®¾å¤‡äº†ã€‚å…±äº«ç£ç›˜çš„å«ä¹‰å¹¶ä¸æ˜¯æŒ‡åœ¨ä»»æ„æ—¶åˆ»ä¸åŒçš„è¿›ç¨‹éƒ½å¯ä»¥åŒæ—¶è¯»å†™ç£ç›˜ã€‚ 3)è™šæ‹Ÿè®¾å¤‡ã€‚æ˜¯é€šè¿‡æŸç§è™šæ‹ŸæŠ€æœ¯æŠŠä¸€å°ç‰©ç†è®¾å¤‡å˜æˆè‹¥å¹²é€»è¾‘è®¾å¤‡ï¼Œä»ç”¨æˆ·çš„è§’åº¦çœ‹ï¼Œå¤šä¸ªç”¨æˆ·æ‹¥æœ‰å„è‡ªçš„è®¾å¤‡ï¼Œå¯ä»¥éšæ—¶å‘è®¾å¤‡å‘å‡ºè®¿é—®è¯·æ±‚å¹¶å¾—åˆ°ç³»ç»Ÿåº”ç­”ã€‚ ä¸‰ã€è®¾å¤‡æ§åˆ¶å™¨ I/Oè®¾å¤‡åˆ†ä¸ºæœºæ¢°å’Œç”µå­ä¸¤éƒ¨åˆ†ï¼Œè®¾å¤‡æ§åˆ¶å™¨å¯¹åº”ç”µå­éƒ¨åˆ†ï¼Œé€šå¸¸æ˜¯å¯ç¼–ç¨‹çš„ã€‚æ“ä½œç³»ç»Ÿçš„ç¨‹åºå‘˜éœ€è¦äº†è§£çš„æ˜¯è®¾å¤‡æ§åˆ¶å™¨çš„ç»“æ„ï¼Œç¼–å†™è®¾å¤‡é©±åŠ¨ç¨‹åºè¦é’ˆå¯¹å…·ä½“çš„è®¾å¤‡æ§åˆ¶å™¨ï¼Œäº†è§£è®¾å¤‡æ§åˆ¶å™¨ä¸­å¯„å­˜å™¨ã€ç«¯å£çš„åç§°ã€åœ°å€å’Œè®¿é—®æ–¹å¼ï¼Œä»¥åŠä½¿ç”¨æ–¹å¼ã€‚ 1.ä»€ä¹ˆæ˜¯è®¾å¤‡æ§åˆ¶å™¨ 1)è®¾å¤‡æ§åˆ¶å™¨æ˜¯CPUä¸I/Oè®¾å¤‡ä¹‹é—´çš„æ¥å£ï¼Œæ¥æ”¶I/Oçš„å‘½ä»¤å¹¶æ§åˆ¶è®¾å¤‡å®ŒæˆI/Oå·¥ä½œã€‚ 2)è®¾å¤‡æ§åˆ¶å™¨æ˜¯ä¸€ä¸ªå¯ç¼–å€è®¾å¤‡ï¼Œè¿æ¥å¤šä¸ªè®¾å¤‡æ—¶å¯æœ‰å¤šä¸ªè®¾å¤‡åœ°å€ã€‚æ§åˆ¶å™¨å¯ä»¥ç›´æ¥åšåœ¨ä¸»æ¿ä¸Šï¼Œä¹Ÿå¯ä»¥åšæˆæ’å¡æ’åœ¨ä¸»æ¿ä¸Šã€‚ç°åœ¨æœ‰äº›è®¾å¤‡çš„æ§åˆ¶å™¨åµŒå…¥åœ¨è®¾å¤‡ä¸­ï¼Œå¦‚æ¿€å…‰æ‰“å°æœºçš„æ§åˆ¶å™¨ã€‚ 2.è®¾å¤‡æ§åˆ¶å™¨çš„åŠŸèƒ½ è®¾å¤‡æ§åˆ¶å™¨çš„åŠŸèƒ½è¯´æ˜å¦‚ä¸‹ã€‚ 1)æ¥æ”¶å’Œè¯†åˆ«å‘½ä»¤ã€‚ æ¥æ”¶CPUçš„å‘½ä»¤å’Œå‚æ•°å­˜æ”¾åœ¨æ§åˆ¶å™¨çš„æ§åˆ¶å¯„å­˜å™¨ä¸­ï¼Œå¹¶å¯¹å‘½ä»¤å’Œåœ°å€è¯‘ç ã€‚ 2)æ•°æ®äº¤æ¢ã€‚é€šè¿‡æ•°æ®å¯„å­˜å™¨è¿›è¡Œæ•°æ®äº¤æ¢ã€‚ â‘ å°†é©±åŠ¨å™¨ä¸­çš„æ¯”ç‰¹æµæ±‡é›†åœ¨æ§åˆ¶å™¨çš„ç¼“å†²åŒºä¸­ä»¥å½¢æˆå­—èŠ‚å—ã€‚ â‘¡å®ç°CPUåˆ°æ§åˆ¶å™¨ã€æ§åˆ¶å™¨åˆ°CPUçš„åŒå‘æ•°æ®ä¼ é€ã€‚ â‘¢å°†æ§åˆ¶å™¨å¯¹è®¾å¤‡çš„æ§åˆ¶å‘½ä»¤ä¼ é€ç»™è®¾å¤‡æ§åˆ¶å™¨ã€‚ 3)è®¾å¤‡çŠ¶æ€çš„äº†è§£å’ŒæŠ¥å‘Šã€‚ è®¾å¤‡æ§åˆ¶å™¨ä¸­æœ‰ä¸“é—¨ç”¨æ¥å­˜æ”¾è®¾å¤‡çŠ¶æ€ä¿¡æ¯çš„å¯„å­˜å™¨æˆ–è§¦å‘å™¨ï¼ŒCPUå¯ä»¥é€šè¿‡è¯»å–è¿™äº›ä¿¡æ¯äº†è§£è®¾å¤‡çš„å½“å‰çŠ¶æ€ã€‚ 4)åœ°å€è¯†åˆ«ã€‚ â‘ è®¾å¤‡æ§åˆ¶å™¨å¿…é¡»èƒ½è¯†åˆ«å®ƒæ‰€æ§åˆ¶çš„æ¯ä¸ªè®¾å¤‡çš„åœ°å€ã€‚ â‘¡è®¾å¤‡æ§åˆ¶å™¨ä¸­çš„å¯„å­˜å™¨æœ¬èº«åº”è¯¥æœ‰å”¯ä¸€çš„åœ°å€ï¼Œä»¥ä½¿CPUèƒ½å‘å¯„å­˜å™¨ä¸­è¯»/å†™æ•°æ®ã€‚ â‘¢å°†CPUè¦è®¿é—®çš„å¤–è®¾åœ°å€é€å…¥æ§åˆ¶å™¨ï¼Œç”±æ§åˆ¶å™¨çš„åœ°å€è¯‘ç å™¨è¯‘ç åé€‰ä¸­ç›®æ ‡è®¾å¤‡ã€‚ 5)æ•°æ®ç¼“å†²ã€‚ åœ¨è®¾å¤‡æ§åˆ¶å™¨ä¸­å¯ä»¥å­˜å‚¨æ•°æ®ï¼Œä½œä¸ºCPUå’ŒI/Oä¹‹é—´çš„ç¼“å†²ã€‚ 6)å·®é”™æ§åˆ¶ã€‚ è®¾å¤‡æ§åˆ¶å™¨éœ€è¦å…·æœ‰å·®é”™æ£€æµ‹åŠŸèƒ½ï¼Œå½“é€šè¿‡æ•°æ®æ ¡éªŒå‘ç°æ•°æ®ä¼ è¾“å‡ºé”™æ—¶ï¼Œå¯ä»¥å‘CPUæŠ¥å‘Šï¼ŒåºŸå¼ƒé”™è¯¯æ•°æ®ï¼Œé‡æ–°å¯åŠ¨ä¸€æ¬¡æ•°æ®ä¼ è¾“ã€‚ 3.è®¾å¤‡æ§åˆ¶å™¨çš„ç»„æˆ è®¾å¤‡æ§åˆ¶å™¨çš„é€»è¾‘æ„æˆä¸»è¦åŒ…æ‹¬ä»¥ä¸‹3éƒ¨åˆ†ã€‚ 1)è®¾å¤‡æ§åˆ¶å™¨ä¸å¤„ç†æœºçš„æ¥å£ï¼šæ•°æ®çº¿ã€æ§åˆ¶çº¿å’Œåœ°å€çº¿ã€‚ 2)è®¾å¤‡æ§åˆ¶å™¨ä¸è®¾å¤‡çš„æ¥å£ï¼šè®¾å¤‡ä¸è®¾å¤‡æ§åˆ¶å™¨æ¥å£ä¸­çš„3ç±»ä¿¡å·ä¸ºæ•°æ®ã€çŠ¶æ€å’Œæ§ åˆ¶ä¿¡å·ã€‚ 3)I/Oé€»è¾‘ï¼šI/Oé€»è¾‘ä¸»è¦ç”±æŒ‡ä»¤è¯‘ç å™¨å’Œåœ°å€è¯‘ç å™¨ä¸¤éƒ¨åˆ†åŠŸèƒ½éƒ¨ä»¶æ„æˆï¼Œå°†CPUçš„å‘½ä»¤å’Œåœ°å€åˆ†åˆ«è¯‘ç ï¼Œæ§åˆ¶æŒ‡å®šè®¾å¤‡è¿›è¡ŒI/Oæ“ä½œã€‚ è®¾å¤‡æ§åˆ¶å™¨çš„é€»è¾‘ç»“æ„å¦‚å›¾6-3æ‰€ç¤ºã€‚ å››ã€I/Oé€šé“ é€šé“ç”¨äºå¤§å‹ä¸»æœºç³»ç»Ÿæ§åˆ¶I/Oè®¾å¤‡ï¼Œä¸æ§åˆ¶è®¾å¤‡ç»“åˆï¼Œä¸å¾®æœºå’Œå°å‹æœºçš„è®¾å¤‡æ§åˆ¶å™¨å…·æœ‰å¯¹ç­‰çš„åŠŸèƒ½ã€‚å³ç”¨æ¥ä»£æ›¿å¾®æœºã€å°å‹æœºä¸­çš„è®¾å¤‡æ§åˆ¶å™¨ï¼Œå®ç°å¤§å‹ä¸»æœºç³»ç»Ÿçš„I/Oè®¾å¤‡æ§åˆ¶åŠŸèƒ½ï¼Œæä¾›æ“ä½œç³»ç»Ÿä¸I/Oè®¾å¤‡é—´çš„æ¥å£ã€‚ I/Oé€šé“æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¤„ç†æœºï¼Œå®ƒå…·æœ‰æ‰§è¡ŒI/OæŒ‡ä»¤çš„èƒ½åŠ›ï¼Œå¹¶é€šè¿‡æ‰§è¡Œé€šé“ç¨‹åºæ¥æ§åˆ¶I/Oæ“ä½œã€‚ç®€å•åœ°è¯´ï¼Œé€šé“æ˜¯å¤§å‹ä¸»æœºç³»ç»Ÿä¸­ä¸“é—¨ç”¨äºI/Oçš„ä¸“ç”¨è®¡ç®—æœºã€‚å¼•äººé€šé“èƒ½å¤Ÿä½¿CPUä»æ§åˆ¶I/Oçš„ä»»åŠ¡ä¸­è§£è„±ï¼Œä½¿CPUä¸I/Oå¹¶è¡Œå·¥ä½œï¼Œæé«˜CPUçš„åˆ©ç”¨ç‡å’Œç³»ç»Ÿçš„ååé‡ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å…­ç« _I_Oè®¾å¤‡ç®¡ç†/ç¬¬äºŒèŠ‚_I_Oæ§åˆ¶æ–¹å¼.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å…­ç« _I_Oè®¾å¤‡ç®¡ç†/ç¬¬äºŒèŠ‚_I_Oæ§åˆ¶æ–¹å¼.html","title":"ç¬¬äºŒèŠ‚ I/Oæ§åˆ¶æ–¹å¼","keywords":"","body":"ç¬¬äºŒèŠ‚ I/Oæ§åˆ¶æ–¹å¼ è¾“å…¥/è¾“å‡ºæ–¹å¼æœ‰æ—©æœŸçš„ç¨‹åºè½®è¯¢æ§åˆ¶æ–¹å¼ã€‚åœ¨ä¸­æ–­æœºåˆ¶è¢«å¼•å…¥è®¡ç®—æœºç³»ç»Ÿåï¼Œè¾“å…¥/è¾“å‡ºæ§åˆ¶é‡‡ç”¨ä¸­æ–­æ§åˆ¶æ–¹å¼ã€‚ä¸ºäº†æé«˜å—è®¾å¤‡çš„è¾“å…¥/è¾“å‡ºæ€§èƒ½ï¼Œå¯ä»¥åˆ©ç”¨DMA(Direct Memory Accessï¼Œç›´æ¥å†…å­˜è®¿é—®)æ§åˆ¶å™¨å¯¹è¾“å…¥/è¾“å‡ºè¿›è¡ŒDMAæ§åˆ¶ã€‚é€šé“æ§åˆ¶æ–¹å¼åˆ™å¯ä»¥ä½¿è¾“å…¥/è¾“å‡ºæ›´å¤§ç¨‹åº¦åœ°ç‹¬ç«‹äºä¸»æœºCPUã€‚åœ¨è¾“å…¥/è¾“å‡ºæ§åˆ¶æ–¹å¼çš„å‘å±•ä¸­å§‹ç»ˆè¿½æ±‚çš„ç›®æ ‡æ˜¯å°½é‡å‡å°‘ä¸»æœºå¯¹è¾“å…¥/è¾“å‡ºæ§åˆ¶çš„å¹²é¢„ï¼Œæé«˜ä¸»æœºä¸è¾“å…¥/è¾“å‡ºçš„å¹¶è¡Œç¨‹åº¦ï¼Œä»¥æé«˜æ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½ã€‚æœ¬èŠ‚ä¸»è¦ä»‹ç»è½®è¯¢ã€ä¸­æ–­å’ŒDMAæ§åˆ¶æ–¹å¼ã€‚ ä¸€ã€è½®è¯¢ æ—©æœŸçš„è®¡ç®—æœºç³»ç»Ÿï¼Œå› ä¸ºæ²¡æœ‰ä¸­æ–­æœºåˆ¶ï¼Œå¤„ç†å™¨å¯¹è¾“å…¥/è¾“å‡ºçš„æ§åˆ¶ä¸å¾—ä¸é‡‡å–ç¨‹åºè½®è¯¢çš„æ–¹å¼ã€‚é‡‡ç”¨è¿™ç§æ§åˆ¶æ–¹å¼ï¼Œä¸»æœºè¯•å›¾å‘é€I/Oæ§åˆ¶å‘½ä»¤ä¹‹å‰ï¼Œå…ˆé€šè¿‡åå¤æ£€æµ‹è®¾å¤‡æ§åˆ¶å™¨çŠ¶æ€å¯„å­˜å™¨çš„å¿™/é—²æ ‡å¿—ä½ï¼Œè‹¥è®¾å¤‡â€œå¿™â€ï¼Œä¸»æœºç»§ç»­æ£€æµ‹è¯¥æ ‡å¿—ä½ï¼Œç›´åˆ°è¯¥ä½ä¸ºâ€œç©ºé—²â€ï¼Œä¸»æœºå‘é€I/OæŒ‡ä»¤ã€‚åœ¨ä¸»æœºå‘é€å®Œ/0æŒ‡ä»¤åï¼Œè®¾å¤‡æ§åˆ¶å™¨æŠŠçŠ¶æ€å¯„å­˜å™¨çš„å¿™/é—²æ ‡å¿—ä½å†ç½®æˆâ€œå¿™â€ï¼Œä¸»æœºå†æ¬¡è¿›äººè½®è¯¢çŠ¶æ€ï¼Œä»¥æ£€æµ‹æœ¬æ¬¡è¾“äºº/è¾“å‡ºæ˜¯å¦ç»“æŸã€‚è¿™ç§æ§åˆ¶æ–¹å¼ä½¿CPUç»å¸¸å¤„äºç”±äºè¾“å…¥/è¾“å‡ºè€Œé€ æˆçš„å¾ªç¯æµ‹è¯•çŠ¶æ€ï¼Œé€ æˆCPUçš„æå¤§æµªè´¹ï¼Œå½±å“æ•´ä¸ªç³»ç»Ÿçš„ååé‡ã€‚ äºŒã€ä¸­æ–­ ç°ä»£è®¡ç®—æœºç³»ç»Ÿå¹¿æ³›é‡‡ç”¨ä¸­æ–­æ§åˆ¶æ–¹å¼å®Œæˆå¯¹I/Oçš„æ§åˆ¶ã€‚é‡‡ç”¨ä¸­æ–­æ§åˆ¶æ–¹å¼çš„I/Oå·¥ä½œæ¨¡å¼æ˜¯CPUæ‰§è¡Œè¿›ç¨‹ä¸­ï¼Œå‘å‡ºè¾“å…¥/è¾“å‡ºè¯·æ±‚ï¼Œè‹¥æ­¤æ—¶I/Oè®¾å¤‡å¿™ï¼Œåˆ™è¿›ç¨‹é˜»å¡ç­‰å¾…ã€‚å½“å¤„äºâ€œå¿™â€çŠ¶æ€çš„è®¾å¤‡å·¥ä½œå®Œæ¯•ï¼Œé€šè¿‡ä¸­æ–­æ§åˆ¶å™¨å‘å‡ºä¸­æ–­è¯·æ±‚ä¿¡å·ï¼ŒCPUå“åº”ä¸­æ–­ï¼Œæ‰§è¡Œå¯¹åº”è¯¥è®¾å¤‡çš„ä¸­æ–­å¤„ç†ç¨‹åºï¼Œç„¶åå”¤é†’å› ç­‰å¾…è¯¥è®¾å¤‡è€Œè¢«é˜»å¡çš„è¿›ç¨‹ã€‚CPUç»§ç»­æ‰§è¡Œè¿™ä¸ªè¿›ç¨‹æ—¶ï¼Œå‘è®¾å¤‡æ§åˆ¶å™¨å‘é€I/OæŒ‡ä»¤ï¼Œç„¶åCPUè¢«è°ƒåº¦ç¨‹åºåˆ†é…ç»™æŸä¸ªè¿›ç¨‹ï¼Œç»§ç»­æ‰§è¡ŒæŸä¸ªç¨‹åºã€‚è‡ªæ­¤ï¼Œåœ¨è®¾å¤‡æ§åˆ¶å™¨æ§åˆ¶è®¾å¤‡å®Œæˆæœ¬æ¬¡I/Oçš„è¿‡ç¨‹ä¸­ï¼ŒI/Oä¸CPUå¹¶è¡Œå·¥ä½œã€‚å½“æœ¬æ¬¡I/Oç»“æŸåï¼Œè®¾å¤‡æ§åˆ¶å™¨é€šè¿‡å‘CPUå‘é€ä¸­æ–­è¯·æ±‚ä¿¡å·å‘ŠçŸ¥CPUæœ¬æ¬¡æ•°æ®ä¼ è¾“ç»“æŸã€‚ ä¸­æ–­æ§åˆ¶çš„å·¥ä½œæ–¹å¼èƒ½ä½¿CPUä¸I/Oè®¾å¤‡åœ¨æŸäº›æ—¶é—´æ®µä¸Šå¹¶è¡Œå·¥ä½œï¼Œæé«˜CPUçš„åˆ©ç”¨ç‡å’Œç³»ç»Ÿçš„ååé‡ã€‚å›¾6-4æ‰€ç¤ºä¸º3ç§I/Oæ§åˆ¶æ–¹å¼æµç¨‹ã€‚ ä¸‰ã€DMAæ§åˆ¶æ–¹å¼ å¯¹äºç£ç›˜é©±åŠ¨å™¨è¿™ç±»çš„è®¾å¤‡ï¼Œæ¯æ¬¡æ•°æ®ä¼ è¾“é‡è¾ƒå¤§ï¼Œé‡‡ç”¨ä¸­æ–­æ§åˆ¶æ–¹å¼ï¼Œä¼ è¾“ä¸€ä¸ªæ•°æ®å—å°±éœ€è¦è¿›è¡Œå¤šæ¬¡ä¸­æ–­å¤„ç†ã€‚å…¸å‹æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ•°æ®å—å¤§å°ä¸º512Bï¼Œé‡‡ç”¨ä¸­æ–­æ§åˆ¶æ–¹å¼ï¼Œè‹¥ç£ç›˜æ§åˆ¶å™¨ä¸­æ•°æ®å¯„å­˜å™¨ä¸ºä¸€ä¸ªå­—èŠ‚å¤§å°ï¼Œåˆ™æ¯ä¼ è¾“å®Œä¸€ä¸ªå­—èŠ‚ï¼Œå°±éœ€è¦CPUæ‰§è¡Œä¸€æ¬¡ä¸­æ–­å¤„ç†ã€‚ä¸ºäº†è¿›ä¸€æ­¥æé«˜I/Oçš„é€Ÿåº¦å’ŒCPUä¸I/Oçš„å¹¶è¡Œç¨‹åº¦ï¼Œå¯ä»¥é‡‡ç”¨DMAæ§åˆ¶æ–¹å¼ã€‚ DMAæ§åˆ¶éœ€è¦ç‰¹æ®Šç»“æ„çš„è®¾å¤‡æ§åˆ¶å™¨ï¼ŒDMAæ§åˆ¶å™¨çš„é€»è¾‘ç»„æˆåŒ…æ‹¬3éƒ¨åˆ†ï¼šä¸»æœºä¸DMAçš„æ¥å£ã€DMAä¸è®¾å¤‡çš„æ¥å£ï¼Œä»¥åŠI/Oæ§åˆ¶é€»è¾‘ã€‚ ä¸ºäº†å®ç°ä¸»æœºä¸è®¾å¤‡æ§åˆ¶å™¨ä¹‹é—´æˆå—æ•°æ®çš„ä¼ é€ï¼Œåœ¨DMAæ§åˆ¶å™¨ä¸­è®¾è®¡äº†4ç±»å¯„å­˜å™¨ï¼šå‘½ä»¤/çŠ¶æ€å¯„å­˜å™¨CRã€å†…å­˜åœ°å€å¯„å­˜å™¨MARã€æ•°æ®å¯„å­˜å™¨DRå’Œæ•°æ®è®¡æ•°å™¨DCã€‚DMAæ§åˆ¶å™¨çš„é€»è¾‘ç»“æ„å¦‚å›¾6-5æ‰€ç¤ºã€‚ 1.å‘½ä»¤/çŠ¶æ€å¯„å­˜å™¨CR ç”¨äºæ¥æ”¶ä»CPUå‘æ¥çš„I/Oå‘½ä»¤æˆ–æœ‰å…³æ§åˆ¶ä¿¡æ¯ã€è®¾å¤‡çŠ¶æ€ã€‚ 2.å†…å­˜åœ°å€å¯„å­˜å™¨MAR å­˜æ”¾å†…å­˜åœ°å€ï¼Œåœ¨è¾“å‡ºæ•°æ®æ—¶ï¼Œå­˜æ”¾è¾“å‡ºæ•°æ®åœ¨å†…å­˜çš„èµ·å§‹åœ°å€ï¼ŒæŒ‡ç¤ºDMAåº”è¯¥ä»å†…å­˜çš„ä»€ä¹ˆåœ°æ–¹è¯»å–è¾“å‡ºæ•°æ®ã€‚åœ¨è¾“å…¥æ•°æ®æ—¶ï¼Œå­˜æ”¾è¾“å…¥æ•°æ®å°†è¦è¢«æ”¾å…¥å†…å­˜çš„èµ·å§‹åœ°å€ï¼ŒæŒ‡ç¤ºDMAåº”è¯¥æŠŠè¾“å…¥æ•°æ®æ”¾åˆ°å†…å­˜çš„ä»€ä¹ˆåœ°æ–¹ã€‚ 3.æ•°æ®è®¡æ•°å™¨DC æŒ‡ç¤ºDMA,æœ¬æ¬¡å‘CPUå‘ä¸­æ–­ä¿¡å·å‰è¦è¯»æˆ–å†™æ•°æ®çš„æ¬¡æ•°ã€‚ 4.æ•°æ®å¯„å­˜å™¨DR ç”¨äºæš‚å­˜DMAä¼ è¾“ä¸­è¦è¾“å…¥æˆ–è¾“å‡ºçš„æ•°æ®ã€‚ ä¸‹é¢ä»¥ä»ç£ç›˜è¯»æ•°æ®ä¸ºä¾‹ï¼Œè¯´æ˜DMAæ§åˆ¶æ–¹å¼çš„å·¥ä½œåŸç†ï¼Œä»¥åŠDMAæ§åˆ¶å’Œä¸­æ–­æ§åˆ¶çš„åŒºåˆ«ã€‚ 1)æ²¡æœ‰ä½¿ç”¨DMAæ—¶ç£ç›˜è¯»æ•°æ®çš„è¿‡ç¨‹ã€‚ â‘ é¦–å…ˆæ§åˆ¶å™¨ä¸€ä¸ªæ¯”ç‰¹ä¸€ä¸ªæ¯”ç‰¹åœ°ä»è®¾å¤‡å®Œæ•´åœ°è¯»å‡ºä¸€å—æ•°æ®æ”¾å…¥å†…éƒ¨ç¼“å†²åŒºä¸­ã€‚ â‘¡ç¡®è®¤è¯¥å—æ•°æ®çš„æ­£ç¡®æ€§ã€‚ â‘¢æ§åˆ¶å™¨å‘ä¸­æ–­ä¿¡å·ï¼ŒCPUæ‰§è¡Œä¸­æ–­å¤„ç†ç¨‹åºï¼Œä»æ§åˆ¶å™¨çš„è®¾å¤‡å¯„å­˜å™¨ä¸­å°†æ•°æ®è¯»å…¥å†…å­˜ã€‚ 2)é€šè¿‡DMAä»ç£ç›˜è¯»æ•°æ®çš„è¿‡ç¨‹ã€‚ å½“CPUè¦ä»ç£ç›˜è¯»å…¥ä¸€ä¸ªæ•°æ®å—æ—¶ï¼Œä¾¿å‘ç£ç›˜æ§åˆ¶å™¨å‘é€ä¸€æ¡è¯»å‘½ä»¤ã€‚è¯¥å‘½ä»¤è¢«é€åˆ°å…¶ä¸­çš„å‘½ä»¤å¯„å­˜å™¨CRä¸­ã€‚åŒæ—¶ï¼ŒCPUå°†æœ¬æ¬¡è¯»å…¥æ•°æ®å°†è¦æ”¾åœ¨å†…å­˜ä¸­çš„èµ·å§‹åœ°å€é€DMAçš„MARå¯„å­˜å™¨ï¼Œå°†æœ¬æ¬¡è¦è¯»çš„å­—èŠ‚æ•°é€DCå¯„å­˜å™¨ã€‚ç„¶åï¼Œå¯åŠ¨DMAæ§åˆ¶å™¨è¿›è¡Œæ•°æ®ä¼ é€ã€‚åœ¨DMAæ§åˆ¶è¾“å…¥çš„è¿‡ç¨‹ä¸­ï¼ŒCPUå¯ä»¥æ‰§è¡Œå…¶ä»–çš„è¿›ç¨‹ã€‚å½“æœ¬æ¬¡è¯»å…¥çš„æ•°æ®å…¨éƒ¨ä¼ é€å®Œæ¯•åï¼ŒDMAå‘CPUå‘é€ä¸­æ–­è¯·æ±‚ã€‚ åœ¨DMAæ§åˆ¶ç£ç›˜è¯»å…¥æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œæ¯è¯»å…¥ä¸€ä¸ªå­—ï¼ˆèŠ‚ï¼‰ï¼Œä¾¿å°†è¯¥å­—ï¼ˆèŠ‚ï¼‰é€åˆ°å½“å‰MARæŒ‡ç¤ºçš„å†…å­˜å•å…ƒä¸­ï¼Œç„¶åMARçš„å€¼é€’å¢ï¼Œä»¥æŒ‡å‘ä¸‹ä¸€ä¸ªå†…å­˜å•å…ƒã€‚DCå‡1ï¼Œè‹¥DCé€’å‡åçš„å€¼ä¸ä¸ºOï¼Œè¯´æ˜æœ¬æ¬¡æ•°æ®ä¼ é€æ²¡æœ‰ç»“æŸï¼Œç»§ç»­åœ¨DMAæ§åˆ¶ä¸‹ä¼ é€ä¸‹ä¸€ä¸ªå­—èŠ‚ï¼›è‹¥DCå‡1åå˜ä¸ºOï¼Œè¯´æ˜æœ¬æ¬¡æ•°æ®ä¼ è¾“ç»“æŸï¼Œç”±DMAå‘CPUå‘ä¸­æ–­è¯·æ±‚ã€‚å›¾6-6æ‰€ç¤ºä¸ºDMAå·¥ä½œæ–¹å¼æµç¨‹ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å…­ç« _I_Oè®¾å¤‡ç®¡ç†/ç¬¬ä¸‰èŠ‚_ç¼“å†²ç®¡ç†.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å…­ç« _I_Oè®¾å¤‡ç®¡ç†/ç¬¬ä¸‰èŠ‚_ç¼“å†²ç®¡ç†.html","title":"ç¬¬ä¸‰èŠ‚ ç¼“å†²ç®¡ç†","keywords":"","body":"ç¬¬ä¸‰èŠ‚ ç¼“å†²ç®¡ç† ç¼“å†²åŒºæ˜¯ç”¨æ¥ä¿å­˜ä¸¤ä¸ªè®¾å¤‡ä¹‹é—´æˆ–è®¾å¤‡ä¸åº”ç”¨ç¨‹åºä¹‹é—´ä¼ è¾“æ•°æ®çš„å†…å­˜åŒºåŸŸã€‚ç”±äºCPUçš„é€Ÿåº¦è¿œé«˜äºI/Oè®¾å¤‡ï¼Œä¸ºäº†å°½å¯èƒ½ä½¿CPUä¸è®¾å¤‡å¹¶è¡Œå·¥ä½œï¼Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½ï¼Œé€šå¸¸éœ€è¦æ“ä½œç³»ç»Ÿåœ¨è®¾å¤‡ç®¡ç†è½¯ä»¶ä¸­æä¾›ç¼“å†²åŒºç®¡ç†åŠŸèƒ½ã€‚ ä¸€ã€ç¼“å†²çš„å¼•å…¥ åœ¨æ•°æ®åˆ°è¾¾é€Ÿç‡ä¸æ•°æ®ç¦»å»é€Ÿç‡ä¸åŒçš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥å¼•å…¥ç¼“å†²åŒºã€‚å¼•å…¥ç¼“å†²åŒºçš„ä¸»è¦åŸå› å¯ä»¥å½’çº³ä¸ºä»¥ä¸‹ä¸¤ç‚¹ã€‚ 1)å¤„ç†æ•°æ®æµçš„ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…ä¹‹é—´çš„é€Ÿåº¦å·®å¼‚ã€‚ä¾‹å¦‚ï¼Œå‡å¦‚ä»è°ƒåˆ¶è§£è°ƒå™¨æ”¶åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šã€‚è°ƒåˆ¶è§£è°ƒå™¨å¤§çº¦æ¯”ç¡¬ç›˜æ…¢æ•°åƒå€ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨å†…å­˜ä¸­åˆ›å»ºç¼“å†²åŒºä»¥å­˜æ”¾ä»è°ƒåˆ¶è§£è°ƒå™¨å¤„æ”¶åˆ°çš„å­—èŠ‚ã€‚å½“æ•´ä¸ªç¼“å†²åŒºå¡«æ»¡æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡ä¸€æ¬¡æ“ä½œå°†ç¼“å†²åŒºä¸­çš„æ•°æ®å†™å…¥åˆ°ç£ç›˜ä¸­ã€‚ç”±äºå†™ç£ç›˜å¹¶ä¸åŠæ—¶ï¼Œè€Œä¸”è°ƒåˆ¶è§£è°ƒå™¨éœ€è¦ä¸€ä¸ªç©ºé—´ç»§ç»­ä¿å­˜è¾“å…¥æ•°æ®ï¼Œå› è€Œéœ€è¦ä¸¤ä¸ªç¼“å†²åŒºã€‚å½“è°ƒåˆ¶è§£è°ƒå™¨å¡«æ»¡ç¬¬ä¸€ä¸ªç¼“å†²åŒºåï¼Œå°±å¯ä»¥è¯·æ±‚å†™ç£ç›˜ã€‚æ¥ç€è°ƒåˆ¶è§£è°ƒå™¨å¼€å§‹å¡«å†™ç¬¬äºŒä¸ªç¼“å†²åŒºï¼Œè€Œè¿™æ—¶ç¬¬ä¸€ä¸ªç¼“å†²åŒºä¸­çš„æ•°æ®æ­£è¢«å†™å…¥ç£ç›˜ã€‚ç­‰åˆ°è°ƒåˆ¶è§£è°ƒå™¨å†™æ»¡ç¬¬äºŒä¸ªç¼“å†²åŒºæ—¶ï¼Œç¬¬ä¸€ä¸ªç¼“å†²åŒºçš„æ•°æ®ä¹Ÿå·²å†™å…¥ç£ç›˜ã€‚å› æ­¤ï¼Œè°ƒåˆ¶è§£è°ƒå™¨å¯ä»¥åˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªç¼“å†²åŒºï¼Œè€Œç¬¬äºŒä¸ªç¼“å†²åŒºä¸­çš„æ•°æ®å¯ä»¥å¼€å§‹å†™å…¥ç£ç›˜ã€‚è¿™ç§åŒç¼“å†²å°†ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…è¿›è¡Œåˆ†ç¦»ï¼Œå› è€Œç¼“å’Œäº†ä¸¤è€…ä¹‹é—´çš„æ—¶åºè¦æ±‚ã€‚ 2)åè°ƒä¼ è¾“æ•°æ®å¤§å°ä¸ä¸€è‡´çš„è®¾å¤‡ã€‚è¿™ç§ä¸ä¸€è‡´åœ¨è®¡ç®—æœºç½‘ç»œä¸­ç‰¹åˆ«å¸¸è§ï¼Œç¼“å†²å¸¸å¸¸ç”¨æ¥å¤„ç†æ¶ˆæ¯çš„åˆ†æ®µå’Œé‡ç»„ã€‚åœ¨å‘é€ç«¯ï¼Œä¸€ä¸ªå¤§æ¶ˆæ¯åˆ†æˆè‹¥å¹²å°ç½‘ç»œåŒ…ã€‚è¿™äº›åŒ…é€šè¿‡ç½‘ç»œä¼ è¾“ï¼Œæ¥æ”¶ç«¯å°†å®ƒä»¬æ”¾åœ¨é‡ç»„ç¼“å†²åŒºå†…ä»¥ç”Ÿæˆå®Œæ•´çš„æºæ•°æ®é•œåƒã€‚ å¼•å…¥ç¼“å†²åŒºé™¤äº†å¯ä»¥ç¼“å’ŒCPUä¸I/Oè®¾å¤‡ä¹‹é—´é€Ÿåº¦ä¸åŒ¹é…çš„çŸ›ç›¾ï¼Œè¿˜èƒ½é™ä½å¯¹CPUä¸­æ–­é¢‘ç‡çš„è¦æ±‚ï¼Œæ”¾å®½å¯¹ä¸­æ–­å“åº”æ—¶é—´çš„é™åˆ¶ï¼Œæé«˜CPUå’ŒI/Oè®¾å¤‡ä¹‹é—´çš„å¹¶è¡Œæ€§ã€‚ äºŒã€å•ç¼“å†² æ“ä½œç³»ç»Ÿæä¾›çš„æœ€ç®€å•çš„ç¼“å†²ç±»å‹æ˜¯å•ç¼“å†²åŒºï¼Œå¦‚å›¾6-7æ‰€ç¤ºã€‚å½“ä¸€ä¸ªç”¨æˆ·è¿›ç¨‹å‘å‡ºI/Oè¯·æ±‚æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¸ºè¯¥æ“ä½œåˆ†é…ä¸€ä¸ªä½äºä¸»å­˜çš„ç¼“å†²åŒºã€‚ å¯¹äºé¢å‘å—çš„è®¾å¤‡ï¼Œå•ç¼“å†²åŒºæ–¹æ¡ˆå¯ä»¥æè¿°å¦‚ä¸‹ï¼šè¾“å…¥æ•°æ®è¢«ä¼ é€è¿›äººç³»ç»Ÿç¼“å†²åŒºã€‚å½“ä¼ é€å®Œæˆæ—¶ï¼Œè¿›ç¨‹æŠŠè¯¥å—ç§»åˆ°ç”¨æˆ·ç©ºé—´ï¼Œå¹¶ç«‹å³è¯·æ±‚å¦ä¸€å—ç³»ç»Ÿç¼“å†²åŒºã€‚ç”¨æˆ·è¿›ç¨‹å¯ä»¥åœ¨ä¸‹ä¸€å—æ•°æ®æ­£åœ¨è¯»å…¥ç³»ç»Ÿç¼“å†²åŒºæ—¶ï¼Œå¤„ç†ç”¨æˆ·åŒºä¸­çš„é‚£ä¸€å—æ•°æ®ã€‚ç›¸å¯¹äºæ²¡æœ‰ç³»ç»Ÿç¼“å†²çš„æƒ…å†µï¼Œè¿™ç§æ–¹æ³•é€šå¸¸èƒ½æé«˜é€Ÿåº¦ã€‚ ç±»ä¼¼çš„è€ƒè™‘ä¹Ÿå¯ä»¥ç”¨äºé¢å‘å—çš„è¾“å‡ºã€‚å½“å‡†å¤‡æŠŠæ•°æ®å‘é€åˆ°ä¸€å°è®¾å¤‡æ—¶ï¼Œé¦–å…ˆæŠŠå®ƒä»¬ä»ç”¨æˆ·ç©ºé—´å¤åˆ¶åˆ°ç³»ç»Ÿç¼“å†²åŒºä¸­ï¼Œå®ƒä»¬æœ€ç»ˆä»ç³»ç»Ÿç¼“å†²åŒºè¢«ä¼ é€ç»™è¾“å‡ºè®¾å¤‡ï¼Œæ­¤æ—¶CPUä¸è¾“å‡ºè®¾å¤‡å¯ä»¥å¹¶è¡Œå·¥ä½œã€‚ å¯¹äºé¢å‘æµçš„I/Oï¼Œåœ¨æ¯æ¬¡ä¼ é€ä¸€è¡Œçš„æ–¹å¼ä¸‹ï¼Œæˆ–è€…æ¯æ¬¡ä¼ é€ä¸€ä¸ªå­—èŠ‚çš„æ–¹å¼ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å•ç¼“å†²æ–¹æ¡ˆã€‚é”®ç›˜ã€æ‰“å°æœºå’Œä¼ æ„Ÿå™¨ç­‰éƒ½å±äºé¢å‘æµçš„è®¾å¤‡ã€‚ å¯¹äºæ¯æ¬¡ä¼ é€ä¸€è¡Œçš„I/Oï¼Œå¯ä»¥ç”¨ç¼“å†²åŒºä¿å­˜ä¸€è¡Œæ•°æ®ã€‚åœ¨è¾“å…¥æœŸé—´ç”¨æˆ·è¿›ç¨‹è¢«é˜»å¡ï¼Œç­‰å¾…æ•´è¡Œçš„åˆ°è¾¾ã€‚å¯¹äºè¾“å‡ºï¼Œç”¨æˆ·è¿›ç¨‹å¯ä»¥æŠŠä¸€è¡Œè¾“å‡ºæ”¾ç½®åœ¨ç¼“å†²åŒºä¸­ï¼Œç„¶åç»§ç»­å¤„ç†ã€‚åªæœ‰å½“ç¬¬ä¸€æ¬¡è¾“å‡ºæ“ä½œçš„ç¼“å†²åŒºå†…å®¹æ¸…ç©ºä¹‹å‰ï¼Œåˆéœ€è¦å‘é€ç¬¬äºŒè¡Œè¾“å‡ºæ—¶ï¼Œå®ƒæ‰éœ€è¦è¢«é˜»å¡ã€‚å¯¹äºæ¯æ¬¡ä¼ é€ä¸€ä¸ªå­—èŠ‚çš„I/Oï¼Œæ“ä½œç³»ç»Ÿå’Œç”¨æˆ·è¿›ç¨‹ä¹‹é—´çš„äº¤äº’æŒ‰ç…§ç¬¬ä¸‰ç« è¿›ç¨‹åŒæ­¥è®²è¿°çš„ç”Ÿäº§è€…ä¸€æ¶ˆè´¹è€…æ¨¡å‹è¿›è¡Œã€‚ ä¸‰ã€åŒç¼“å†² å¯ä»¥é€šè¿‡ç»™æ“ä½œç³»ç»ŸæŒ‡å®šä¸¤ä¸ªç³»ç»Ÿç¼“å†²åŒºï¼Œå¦‚å›¾6-8æ‰€ç¤ºï¼Œå¯¹å•ç¼“å†²æ–¹æ¡ˆè¿›è¡Œæ”¹è¿›ã€‚å½“ä¸€ä¸ªè¿›ç¨‹å¾€è¿™ä¸€ä¸ªç¼“å†²åŒºä¸­ä¼ é€æ•°æ®ï¼ˆæˆ–ä»è¿™ä¸ªç¼“å†²åŒºä¸­è¯»å–æ•°æ®ï¼‰æ—¶ï¼Œæ“ä½œç³»ç»Ÿæ­£åœ¨æ¸…ç©º(æˆ–å¡«å……)å¦ä¸€ä¸ªç¼“å†²åŒºï¼Œè¿™ç§æŠ€æœ¯ç§°ä¸ºåŒç¼“å†²(Doube Buffering)ï¼Œæˆ–ç¼“å†²äº¤æ¢(Buffering Swapping)ã€‚ åŒç¼“å†²çš„æ€§èƒ½æ¯”å•ç¼“å†²çš„æ€§èƒ½æœ‰æ‰€æé«˜ï¼Œä½†æ˜¯è¿™ç§æé«˜æ˜¯ä»¥å¢åŠ å¤æ‚æ€§ä¸ºä»£ä»·çš„ã€‚ å››ã€å¾ªç¯ç¼“å†² åŒç¼“å†²æ–¹æ¡ˆå¯ä»¥å¹³æ»‘I/Oè®¾å¤‡å’Œè¿›ç¨‹ä¹‹é—´çš„æ•°æ®æµï¼Œå¦‚æœæŸä¸ªç‰¹å®šè¿›ç¨‹çš„æ€§èƒ½æ˜¯å…³æ³¨çš„ç„¦ç‚¹ï¼Œå¸¸å¸¸ä¼šå¸Œæœ›ç›¸å…³I/Oæ“ä½œèƒ½å¤Ÿè·Ÿå¾—ä¸Šè¿™ä¸ªè¿›ç¨‹ã€‚å¦‚æœè¿™ä¸ªè¿›ç¨‹çªç„¶å¿«é€Ÿæ‰§è¡Œäº†å¤§é‡çš„I/Oï¼Œä»…æœ‰åŒç¼“å†²å°±ä¸å¤Ÿäº†ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šå¸¸ä½¿ç”¨å¤šäºä¸¤ä¸ªçš„ç¼“å†²åŒºï¼Œå¦‚å¾ªç¯ç¼“å†²æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¯ä»¥è¿™æ ·ç†è§£ï¼šåœ¨æ•°æ®åˆ°è¾¾å’Œæ•°æ®ç¦»å»çš„é€Ÿåº¦å·®åˆ«å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œéœ€è¦å¢åŠ ç¼“å†²åŒºçš„æ•°é‡ã€‚ 1.å¾ªç¯ç¼“å†²çš„ç»„æˆ å¾ªç¯ç¼“å†²çš„ç»„æˆå¦‚å›¾6-9æ‰€ç¤ºã€‚ (1)å¤šä¸ªç¼“å†²åŒº 1)ç©ºç¼“å†²åŒºR:ç”Ÿäº§è€…è¿›ç¨‹ä¸‹ä¸€ä¸ªå¯ç”¨çš„ç©ºç¼“å†²åŒºã€‚ 2)å·²è£…æ»¡æ•°æ®çš„ç¼“å†²åŒºG:ç”¨äºæŒ‡ç¤ºæ¶ˆè´¹è€…è¿›ç¨‹ä¸‹ä¸€ä¸ªå¯ç”¨çš„è£…æœ‰äº§å“çš„ç¼“å†²åŒºã€‚ 3)ç°è¡Œå·¥ä½œç¼“å†²åŒºC:æ¶ˆè´¹è€…è¿›ç¨‹æ­£åœ¨ä½¿ç”¨çš„å·¥ä½œç¼“å†²åŒºã€‚ (2)å¤šä¸ªæŒ‡é’ˆ 1)Nextg:ç”¨äºæŒ‡ç¤ºæ¶ˆè´¹è€…è¿›ç¨‹ä¸‹ä¸€ä¸ªå¯ç”¨çš„è£…æœ‰æ•°æ®çš„ç¼“å†²åŒºã€‚ 2)Nexti:ç”¨äºæŒ‡ç¤ºç”Ÿäº§è€…è¿›ç¨‹ä¸‹ä¸€ä¸ªå¯ç”¨çš„ç©ºç¼“å†²åŒºã€‚ 3)Current:ç”¨äºæŒ‡ç¤ºè¿›ç¨‹æ­£åœ¨ä½¿ç”¨çš„å·¥ä½œç¼“å†²åŒºã€‚ 2.å¾ªç¯ç¼“å†²çš„ä½¿ç”¨ ç”Ÿäº§è€…è¿›ç¨‹å’Œæ¶ˆè´¹è€…è¿›ç¨‹å¯ä»¥åˆ©ç”¨Getbufè¿‡ç¨‹å’ŒReleasebufè¿‡ç¨‹æ¥ä½¿ç”¨å¾ªç¯ç¼“å†²åŒºã€‚ (1)Getbufè¿‡ç¨‹ æ¶ˆè´¹è€…è¿›ç¨‹è¦ä½¿ç”¨ç¼“å†²åŒºä¸­çš„æ•°æ®æ—¶ï¼Œå¯è°ƒç”¨Getbufè¿‡ç¨‹ã€‚è¯¥è¿‡ç¨‹å°†NextgæŒ‡å‘çš„ç¼“å†²åŒºæä¾›ç»™è¿›ç¨‹ä½¿ç”¨ï¼Œå¹¶æŠŠå®ƒæ”¹æˆç”±CurrentæŒ‡é’ˆæŒ‡å‘çš„ç°è¡Œå·¥ä½œç¼“å†²åŒºï¼ŒåŒæ—¶ä½¿NextgæŒ‡å‘ä¸‹ä¸€ä¸ªå¯ç”¨çš„è£…æœ‰æ•°æ®çš„ç¼“å†²åŒºGã€‚è€Œå½“ç”Ÿäº§è€…è¿›ç¨‹è¦ä½¿ç”¨ç©ºç¼“å†²åŒºæ¥è£…æ•°æ®æ—¶ï¼Œä¹Ÿé€šè¿‡è°ƒç”¨Getbufè¿‡ç¨‹ï¼ŒæŠŠNextiæŒ‡ç¤ºçš„ç©ºç¼“å†²åŒºæä¾›ç»™ç”Ÿäº§è€…è¿›ç¨‹ä½¿ç”¨ï¼Œç„¶åä½¿NextiæŒ‡å‘ä¸‹ä¸€ä¸ªç©ºç¼“å†²åŒºRã€‚ (2)Releasebufè¿‡ç¨‹ å½“è¿›ç¨‹ä½¿ç”¨å®Œç¼“å†²åŒºä¹‹åï¼Œè°ƒç”¨Releasebufè¿‡ç¨‹é‡Šæ”¾ç¼“å†²åŒºã€‚å½“æ¶ˆè´¹è€…è¿›ç¨‹æŠŠCç¼“å†²åŒºä¸­çš„æ•°æ®æå–å®Œæ¯•æ—¶ï¼Œä¾¿è°ƒç”¨Releasebufè¿‡ç¨‹é‡Šæ”¾Cç¼“å†²åŒºï¼ŒæŠŠè¯¥ç¼“å†²åŒºæ”¹ä¸ºç©ºç¼“å†²åŒºRã€‚å½“ç”Ÿäº§è€…è¿›ç¨‹æŠŠç¼“å†²åŒºè£…æ»¡æ•°æ®åï¼Œè°ƒç”¨Releasebufè¿‡ç¨‹é‡Šæ”¾ç¼“å†²åŒºï¼Œä½¿è£…æ»¡æ•°æ®çš„å½“å‰å·¥ä½œç¼“å†²åŒºæˆä¸ºGç¼“å†²åŒºã€‚ 3.è¿›ç¨‹åŒæ­¥ ç”±äºä½¿ç”¨ç¼“å†²å¯ä½¿ç”Ÿäº§è€…è¿›ç¨‹å’Œæ¶ˆè´¹è€…è¿›ç¨‹å¹¶è¡Œæ‰§è¡Œï¼Œç›¸åº”åœ°ï¼ŒæŒ‡é’ˆNextiå’ŒæŒ‡é’ˆNextgå°†ä¸æ–­åœ°æ²¿é¡ºæ—¶é’ˆæ–¹å‘ç§»åŠ¨ï¼Œåœ¨ä¸‹åˆ—ä¸¤ç§æƒ…å†µä¸‹éœ€è¦ä¿æŒä¸¤ç§è¿›ç¨‹åŒæ­¥çš„æœºåˆ¶ã€‚ 1)NextiæŒ‡é’ˆè¿½ä¸ŠNextgæŒ‡é’ˆï¼Œå³ç”Ÿäº§è€…è¿›ç¨‹é€Ÿåº¦å¤§äºæ¶ˆè´¹è€…è¿›ç¨‹é€Ÿåº¦ï¼Œæ²¡æœ‰ç©ºç¼“å†²åŒºï¼Œå…¨éƒ¨ç¼“å†²åŒºå·²æ»¡ã€‚æ­¤æ—¶ï¼Œéœ€è¦é˜»å¡ç”Ÿäº§è€…è¿›ç¨‹ï¼Œç­‰å¾…æ¶ˆè´¹è€…è¿›ç¨‹ä¸ºç”Ÿäº§è€…è¿›ç¨‹é‡Šæ”¾ç©ºç¼“å†²åŒºRã€‚ 2)NextgæŒ‡é’ˆè¿½ä¸ŠNextiæŒ‡é’ˆï¼Œæ¶ˆè´¹è€…è¿›ç¨‹é€Ÿåº¦å¤§äºç”Ÿäº§è€…è¿›ç¨‹é€Ÿåº¦ï¼Œå…¨éƒ¨ç¼“å†²å·²ç©ºã€‚æ­¤æ—¶ï¼Œéœ€è¦é˜»å¡æ¶ˆè´¹è€…è¿›ç¨‹ï¼Œç­‰å¾…ç”Ÿäº§è€…è¿›ç¨‹ä¸ºæ¶ˆè´¹è€…è¿›ç¨‹é‡Šæ”¾è£…æœ‰æ•°æ®çš„ç¼“å†²åŒºGã€‚ äº”ã€ç¼“å†²æ±  å…¬å…±ç¼“å†²æ± æ˜¯è¢«å¹¿æ³›åº”ç”¨çš„ä¸€ç§ç¼“å†²ç®¡ç†æŠ€æœ¯ï¼Œå…¬å…±ç¼“å†²æ± ä¸­è®¾ç½®å¤šä¸ªå¯ä¾›è‹¥å¹²è¿›ç¨‹å…±äº«çš„ç¼“å†²åŒºï¼Œè¿™ç§æ–¹å¼èƒ½æé«˜ç¼“å†²åŒºçš„åˆ©ç”¨ç‡ã€‚ 1.ç¼“å†²æ± çš„ç»„æˆ å…¬å…±ç¼“å†²æ± æ—¢å¯ç”¨äºè¾“å…¥ï¼Œåˆå¯ç”¨äºè¾“å‡ºï¼Œå…¶ä¸­è‡³å°‘åŒ…å«3ç§ç±»å‹çš„ç¼“å†²åŒºã€3ç§ç¼“å†²é˜Ÿåˆ—å’Œ4ç§å·¥ä½œç¼“å†²åŒºã€‚ 1)3ç§ç±»å‹çš„ç¼“å†²åŒºã€‚ç©ºç¼“å†²åŒºã€è£…æ»¡è¾“å…¥æ•°æ®çš„ç¼“å†²åŒºå’Œè£…æ»¡è¾“å‡ºæ•°æ®çš„ç¼“å†²åŒºã€‚ 2)3ç§é˜Ÿåˆ—ã€‚ â‘ ç©ºç¼“å†²é˜Ÿåˆ—emq:æ˜¯ç”±ç©ºç¼“å†²åŒºé“¾æ¥è€Œæˆçš„é˜Ÿåˆ—ã€‚ â‘¡è¾“å…¥é˜Ÿåˆ—inq:æ˜¯ç”±è£…æ»¡è¾“å…¥æ•°æ®çš„ç¼“å†²åŒºé“¾æ¥æˆçš„é˜Ÿåˆ—ã€‚ â‘¢è¾“å‡ºé˜Ÿåˆ—outq:æ˜¯ç”±è£…æ»¡è¾“å‡ºæ•°æ®çš„ç¼“å†²åŒºé“¾æ¥æˆçš„é˜Ÿåˆ—ã€‚ 3)4ç§å·¥ä½œç¼“å†²åŒºã€‚ â‘ æ”¶å®¹è¾“äººæ•°æ®çš„ç¼“å†²åŒºã€‚æ”¶å®¹å®Œè¾“å…¥æ•°æ®åï¼Œç¼“å†²åŒºè¢«æ’å…¥è¾“å…¥é˜Ÿåˆ—ä¸­ã€‚ â‘¡æå–è¾“äººæ•°æ®çš„ç¼“å†²åŒºã€‚å­˜åœ¨äºè¾“å…¥é˜Ÿåˆ—ä¸­ï¼Œè¿›ç¨‹éœ€è¦è¾“å…¥æ•°æ®æ—¶ï¼Œå…ˆä»è¾“å…¥é˜Ÿåˆ—ä¸­è·å–è¿™ç§ç¼“å†²åŒºã€‚ â‘¢æ”¶å®¹è¾“å‡ºæ•°æ®çš„ç¼“å†²åŒºã€‚æ”¶å®¹å®Œè¾“å‡ºæ•°æ®åï¼Œç¼“å†²åŒºè¢«æ’å…¥è¾“å‡ºé˜Ÿåˆ—ä¸­ã€‚ â‘£æå–è¾“å‡ºæ•°æ®çš„ç¼“å†²åŒºã€‚å­˜åœ¨äºè¾“å‡ºé˜Ÿåˆ—ä¸­ï¼Œè¿›ç¨‹éœ€è¦è¾“å‡ºæ•°æ®æ—¶ï¼Œå…ˆä»è¾“å‡ºé˜Ÿåˆ—ä¸­è·å–è¿™ç§ç¼“å†²åŒºã€‚ 2.Getbufè¿‡ç¨‹å’ŒPutbufè¿‡ç¨‹ å¯¹ç¼“å†²æ± çš„æ“ä½œç”±Getbufè¿‡ç¨‹å’ŒPutbufè¿‡ç¨‹æ¥å®Œæˆã€‚ä¸ºäº†ä½¿è¿›ç¨‹èƒ½ä»¥äº’æ–¥çš„æ–¹å¼è®¿é—®ç¼“å†²æ± é˜Ÿåˆ—ï¼Œå¯ä¸ºæ¯ä¸ªé˜Ÿåˆ—è®¾ç½®ä¸€ä¸ªç›¸åº”çš„äº’æ–¥ä¿¡å·é‡MS(type)ã€‚ä¸ºäº†ä¿è¯è¿›ç¨‹åŒæ­¥ä½¿ç”¨ç¼“å†²åŒºï¼Œå¯ä»¥ä¸ºæ¯ä¸ªé˜Ÿåˆ—è®¾ç½®ä¸€ä¸ªèµ„æºä¿¡å·é‡RS(type)ã€‚å…¶ä¸­ï¼ŒtypeæŒ‡ç¤ºç¼“å†²åŒºé˜Ÿåˆ—ç±»å‹ï¼Œå¯ä»¥æ˜¯emqã€inqæˆ–outqã€‚ (1)Getbufè¿‡ç¨‹ Procedure Getbuf(type) Begin Wait(RS(type));//ç”³è¯·ç¼“å†²åŒº Wait(MS(type));//ç”³è¯·ç¼“å†²é˜Ÿåˆ—çš„äº’æ–¥è®¿é—®æƒ B(number)=Takebuf(type);//æå–ç¼“å†²åŒº Signal(MS(type));//é‡Šæ”¾ç¼“å†²é˜Ÿåˆ—çš„äº’æ–¥è®¿é—®æƒ End (2)Putbufè¿‡ç¨‹ Procedure Putbuf(type,number) Begin Wait(MS(type));//ç”³è¯·ç¼“å†²é˜Ÿåˆ—çš„äº’æ–¥è®¿é—®æƒ Addbuf(type,number);//å‘typeæŒ‡ç¤ºçš„é˜Ÿåˆ—ä¸­æ’å…¥numberæŒ‡ç¤ºçš„ç¼“å†²åŒºï¼Œnumberå¯ä»¥æ˜¯hinã€sinã€soutæˆ–hout,è§å›¾6-l0 Signal (MS(type));//é‡Šæ”¾ç¼“å†²é˜Ÿåˆ—çš„äº’æ–¥è®¿é—®æƒ Signal (RS(type));//é‡Šæ”¾ç¼“å†²åŒºæ–¯ç­‰é‡ End 3.ç¼“å†²åŒºçš„å·¥ä½œæ–¹å¼ ç¼“å†²åŒºå¯ä»¥å·¥ä½œåœ¨æ”¶å®¹è¾“å…¥ã€æå–è¾“å…¥ã€æ”¶å®¹è¾“å‡ºå’Œæå–è¾“å‡º4ç§å·¥ä½œæ–¹å¼ä¸‹ï¼Œå¦‚å›¾6-10æ‰€ç¤ºã€‚ (1)æ”¶å®¹è¾“å…¥ åœ¨è¿›ç¨‹éœ€è¦æ”¶å®¹è¾“å…¥æ•°æ®æ—¶ï¼Œè¦å…ˆä»ç©ºç¼“å†²é˜Ÿåˆ—æå–ä¸€ä¸ªç©ºç¼“å†²åŒºï¼Œå°†è¾“å…¥æ•°æ®å†™å…¥ç¼“å†²åï¼Œå†æŠŠè£…å…¥äº†è¾“å…¥æ•°æ®çš„ç¼“å†²åŒºå…¥åˆ°è¾“å…¥é˜Ÿåˆ—ä¸­å»ã€‚æ“ä½œæ­¥éª¤å¦‚ä¸‹ã€‚ 1)Getbuf(emq)ã€‚ 2)å°†è¾“å…¥æ•°æ®å†™å…¥ç¼“å†²åŒºã€‚ 3)putbuf(inq,hin)ã€‚ (2)æå–è¾“å…¥ å½“è¿›ç¨‹éœ€è¦è¾“å…¥æ•°æ®æ—¶ï¼ˆå¦‚è®¡ç®—è¿›ç¨‹éœ€è¦æå–è¾“å…¥æ•°æ®ï¼Œç„¶åå¯¹æ•°æ®è¿›è¡Œè®¡ç®—å¤„ç†ï¼‰ï¼Œå…ˆä»è¾“å…¥é˜Ÿåˆ—æå–è¾“å…¥ç¼“å†²åŒºï¼Œç„¶åä»ä¸­æå–è¾“å…¥æ•°æ®ï¼Œæœ€åæŠŠç¼“å†²åŒºä½œä¸ºç©ºç¼“å†²åŒºæ’äººç©ºç¼“å†²é˜Ÿåˆ—ã€‚æ“ä½œæ­¥éª¤å¦‚ä¸‹ã€‚ 1)Getbuf(inq)ã€‚ 2)ä»ç¼“å†²åŒºæå–æ•°æ®. 3)putbuf(emq,sin)ã€‚ (3)æ”¶å®¹è¾“å‡º åœ¨è¿›ç¨‹éœ€è¦æ”¶å®¹è¾“å‡ºæ•°æ®æ—¶ï¼Œè¦å…ˆä»ç©ºç¼“å†²é˜Ÿåˆ—æå–ä¸€ä¸ªç©ºç¼“å†²åŒºï¼Œå°†è¾“å‡ºæ•°æ®å†™å…¥ç¼“å†²åï¼Œå†æŠŠè£…å…¥äº†è¾“å‡ºæ•°æ®çš„ç¼“å†²åŒºæ’å…¥åˆ°è¾“å‡ºé˜Ÿåˆ—ä¸­å»ã€‚æ“ä½œæ­¥éª¤å¦‚ä¸‹ã€‚ 1)Getbuf(emq)ã€‚ 2)å°†è¾“å‡ºæ•°æ®å†™å…¥ç¼“å†²åŒºã€‚ 3)putbuf(outq,hout)ã€‚ (4)æå–è¾“å‡º å½“è¿›ç¨‹éœ€è¦è¾“å‡ºæ•°æ®æ—¶ï¼ˆå¦‚æ‰“å°è¿›ç¨‹éœ€è¦æå–è¾“å‡ºæ•°æ®é€æ‰“å°æœºï¼‰ï¼Œå…ˆä»è¾“å‡ºé˜Ÿåˆ—æå–è¾“å‡ºç¼“å†²åŒºï¼Œç„¶åä»ä¸­æå–è¾“å‡ºæ•°æ®ï¼Œæœ€åæŠŠè¿™ä¸ªç¼“å†²åŒºæ’å…¥ç©ºç¼“å†²é˜Ÿåˆ—ã€‚æ“ä½œæ­¥éª¤å¦‚ä¸‹ã€‚ 1)Getbuf(outq)ã€‚ 2)è¾“å‡ºæ•°æ®ã€‚ 3)putbuf(emq,sout)ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å…­ç« _I_Oè®¾å¤‡ç®¡ç†/ç¬¬å››èŠ‚_è®¾å¤‡åˆ†é….html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å…­ç« _I_Oè®¾å¤‡ç®¡ç†/ç¬¬å››èŠ‚_è®¾å¤‡åˆ†é….html","title":"ç¬¬å››èŠ‚ è®¾å¤‡åˆ†é…","keywords":"","body":"ç¬¬å››èŠ‚ è®¾å¤‡åˆ†é… åœ¨å¤šé“ç¨‹åºç¯å¢ƒä¸‹ï¼Œç³»ç»Ÿä¸­çš„è®¾å¤‡ä¸å…è®¸ç”¨æˆ·è‡ªè¡Œä½¿ç”¨ï¼Œè€Œå¿…é¡»ç”±ç³»ç»Ÿåˆ†é…ã€‚æ¯å½“è¿›ç¨‹å‘ç³»ç»Ÿæå‡ºI/Oè¯·æ±‚æ—¶ï¼Œè®¾å¤‡åˆ†é…ç¨‹åºä¾¿æŒ‰ç…§ä¸€å®šçš„ç­–ç•¥ï¼ŒæŠŠè®¾å¤‡åˆ†é…ç»™ç”¨æˆ·ã€‚è®¾å¤‡åˆ†é…åŠŸèƒ½çš„å®Œæˆï¼Œéœ€è¦è®°å½•è®¾å¤‡æƒ…å†µçš„æ•°æ®ç»“æ„å’Œè®¾å¤‡åˆ†é…ç®—æ³•ã€‚ ä¸€ã€è®¾å¤‡åˆ†é…ä¸­çš„æ•°æ®ç»“æ„ æ”¯æŒè®¾å¤‡åˆ†é…çš„æ•°æ®ç»“æ„éœ€è¦è®°å½•è®¾å¤‡çš„çŠ¶æ€ï¼ˆå¿™æˆ–ç©ºé—²ï¼‰ã€è®¾å¤‡ç±»å‹ç­‰åŸºæœ¬ä¿¡æ¯ã€‚ä¸‹é¢æ˜¯ä¸€ç§æ”¯æŒè®¾å¤‡åˆ†é…çš„æ•°æ®ç»“æ„è®¾è®¡æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆåŒ…æ‹¬è®¾å¤‡æ§åˆ¶è¡¨ã€æ§åˆ¶å™¨æ§åˆ¶è¡¨ã€é€šé“æ§åˆ¶è¡¨å’Œç³»ç»Ÿè®¾å¤‡è¡¨ã€‚è¿™äº›æ•°æ®ç»“æ„è®°å½•äº†è®¾å¤‡ã€æ§åˆ¶å™¨ã€é€šé“çš„çŠ¶æ€åŠæ§åˆ¶å™¨è¿›è¡Œæ§åˆ¶æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚ 1.è®¾å¤‡æ§åˆ¶è¡¨DCT(Device Control Table) ç³»ç»Ÿä¸ºæ¯ä¸ªè®¾å¤‡å»ºç«‹ä¸€å¼ è®¾å¤‡æ§åˆ¶è¡¨ï¼Œå¤šå°è®¾å¤‡çš„è®¾å¤‡æ§åˆ¶è¡¨æ„æˆè®¾å¤‡æ§åˆ¶è¡¨é›†åˆã€‚æ¯å¼ è®¾å¤‡æ§åˆ¶è¡¨åŒ…å«ä»¥ä¸‹ä¿¡æ¯ã€‚ 1)è®¾å¤‡ç±»å‹ã€‚ 2)è®¾å¤‡æ ‡è¯†ç¬¦ã€‚ 3)è®¾å¤‡çŠ¶æ€ï¼šå¿™/é—²ã€‚ 4)æŒ‡å‘æ§åˆ¶å™¨è¡¨çš„æŒ‡é’ˆã€‚ 5)é‡å¤æ‰§è¡Œçš„æ¬¡æ•°æˆ–æ—¶é—´ã€‚ 6)è®¾å¤‡é˜Ÿåˆ—çš„é˜Ÿé¦–æŒ‡é’ˆã€‚è®¾å¤‡é˜Ÿåˆ—ä¹Ÿç§°è®¾å¤‡è¯·æ±‚é˜Ÿåˆ—ï¼Œæ˜¯å› è¯·æ±‚è®¾å¤‡è€Œè¢«é˜»å¡çš„è¿›ç¨‹çš„PCBæ„æˆçš„é˜Ÿåˆ—ã€‚è®¾å¤‡é˜Ÿåˆ—çš„é˜Ÿé¦–æŒ‡é’ˆæŒ‡å‘é˜Ÿé¦–çš„PCBã€‚ 2.æ§åˆ¶å™¨æ§åˆ¶è¡¨COCT(Controller Control Table) ç³»ç»Ÿä¸ºæ¯ä¸ªæ§åˆ¶å™¨è®¾ç½®ä¸€å¼ ç”¨äºè®°å½•è¯¥æ§åˆ¶å™¨ä¿¡æ¯çš„æ§åˆ¶å™¨æ§åˆ¶è¡¨ï¼Œæ§åˆ¶å™¨æ§åˆ¶è¡¨ä¸­é€šå¸¸åŒ…å«ä»¥ä¸‹å‡ ä¸ªå­—æ®µã€‚ 1)æ§åˆ¶å™¨æ ‡è¯†ç¬¦ã€‚ 2)æ§åˆ¶å™¨çŠ¶æ€ã€‚ 3)ä¸æ§åˆ¶å™¨ç›¸è¿æ¥çš„é€šé“è¡¨æŒ‡é’ˆã€‚ 4)æ§åˆ¶å™¨é˜Ÿåˆ—çš„é˜Ÿé¦–æŒ‡é’ˆã€‚ 5)æ§åˆ¶å™¨é˜Ÿåˆ—çš„é˜Ÿå°¾æŒ‡é’ˆã€‚ 3.é€šé“æ§åˆ¶è¡¨CHCT(Channel Control Table) åœ¨ä¸€äº›ä¸»æœºç³»ç»Ÿä¸­è¿˜æœ‰é€šé“è®¾å¤‡ï¼Œç³»ç»Ÿä¼šä¸ºæ¯ä¸ªé€šé“è®¾å¤‡è®¾ç½®ä¸€å¼ é€šé“æ§åˆ¶è¡¨ï¼Œé€šé“æ§åˆ¶è¡¨åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªå­—æ®µã€‚ 1)é€šé“æ ‡è¯†ç¬¦ã€‚ 2)é€šé“çŠ¶æ€ã€‚ 3)ä¸é€šé“è¿æ¥çš„æ§åˆ¶å™¨è¡¨é¦–å€ã€‚ 4)é€šé“é˜Ÿåˆ—çš„é˜Ÿé¦–æŒ‡é’ˆã€‚ 5)é€šé“é˜Ÿåˆ—çš„é˜Ÿå°¾æŒ‡é’ˆã€‚ 4.ç³»ç»Ÿè®¾å¤‡è¡¨SDT(System Device Table) ç³»ç»Ÿè®¾å¤‡è¡¨æ˜¯ç³»ç»ŸèŒƒå›´çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­è®°å½•äº†ç³»ç»Ÿä¸­å…¨éƒ¨è®¾å¤‡çš„æƒ…å†µã€‚æ¯ä¸ªè®¾å¤‡å ä¸€ä¸ªè¡¨ç›®ï¼Œå…¶ä¸­åŒ…æ‹¬è®¾å¤‡ç±»å‹ã€è®¾å¤‡æ ‡è¯†ç¬¦ã€è®¾å¤‡æ§åˆ¶è¡¨åŠè®¾å¤‡é©±åŠ¨ç¨‹åºçš„å…¥å£åœ°å€ã€‚ ç³»ç»Ÿè®¾å¤‡è¡¨ã€æ§åˆ¶å™¨æ§åˆ¶è¡¨ã€è®¾å¤‡æ§åˆ¶è¡¨ä¹‹é—´çš„å…³ç³»åŠåˆ©ç”¨æ•°æ®ç»“æ„è¿›è¡Œè®¾å¤‡åˆ†é…çš„æµ ç¨‹å¦‚å›¾6-11æ‰€ç¤ºï¼Œå…¶ä¸­çš„é€»è¾‘è®¾å¤‡è¡¨LUTçš„ç”¨é€”åŠä¸€èˆ¬ç»“æ„è§åé¢â€œä¸‰ã€è®¾å¤‡ç‹¬ç«‹æ€§â€ä¸€èŠ‚ã€‚ äºŒã€è®¾å¤‡åˆ†é… ä¸ºäº†ä½¿ç³»ç»Ÿæœ‰æ¡ä¸ç´Šåœ°å·¥ä½œï¼Œç³»ç»Ÿåœ¨åˆ†é…è®¾å¤‡æ—¶åº”è€ƒè™‘ä»¥ä¸‹3ä¸ªå› ç´ ã€‚ 1)è®¾å¤‡çš„å›ºæœ‰å±æ€§ã€‚ 2)è®¾å¤‡åˆ†é…ç®—æ³•ã€‚ 3)è®¾å¤‡åˆ†é…æ—¶çš„å®‰å…¨æ€§ã€‚ 1.è®¾å¤‡çš„å›ºæœ‰å±æ€§ åœ¨åˆ†é…è®¾å¤‡æ—¶ï¼Œé¦–å…ˆåº”è€ƒè™‘ä¸è®¾å¤‡åˆ†é…æœ‰å…³çš„è®¾å¤‡å±æ€§ã€‚è®¾å¤‡çš„å›ºæœ‰å±æ€§å¯åˆ†æˆ3ç§ï¼šç¬¬ä¸€ç§æ˜¯ç‹¬å æ€§ï¼ŒæŒ‡è¿™ç§è®¾å¤‡åœ¨ä¸€æ®µæ—¶é—´å†…åªå…è®¸ä¸€ä¸ªè¿›ç¨‹ç‹¬å ï¼Œå³â€œä¸´ç•Œèµ„æºâ€ã€‚ç¬¬äºŒç§æ˜¯å…±äº«æ€§ï¼ŒæŒ‡è¿™ç§è®¾å¤‡å…è®¸å¤šä¸ªè¿›ç¨‹åŒæ—¶å…±äº«ã€‚ç¬¬ä¸‰ç§æ˜¯å¯è™šæ‹Ÿæ€§ï¼ŒæŒ‡è®¾å¤‡æœ¬èº«è™½æ˜¯ç‹¬å è®¾å¤‡ï¼Œä½†ç»è¿‡æŸç§æŠ€æœ¯å¤„ç†ï¼Œå¯ä»¥æŠŠå®ƒæ”¹é€ æˆè™šæ‹Ÿè®¾å¤‡ã€‚å¯¹ä¸Šè¿°çš„ç‹¬å ã€å…±äº«ã€å¯è™šæ‹Ÿ3ç§è®¾å¤‡åº”é‡‡å–ä¸åŒçš„åˆ†é…ç­–ç•¥ã€‚ (1)ç‹¬å è®¾å¤‡ å¯¹äºç‹¬å è®¾å¤‡ï¼Œåº”é‡‡ç”¨ç‹¬äº«åˆ†é…ç­–ç•¥ï¼Œå³å°†ä¸€ä¸ªè®¾å¤‡åˆ†é…ç»™æŸè¿›ç¨‹åï¼Œä½¿ç”±è¯¥è¿›ç¨‹ç‹¬å ï¼Œç›´è‡³è¿›ç¨‹å®Œæˆæˆ–é‡Šæ”¾è¯¥è®¾å¤‡ã€‚ç„¶åï¼Œç³»ç»Ÿæ‰èƒ½å†å°†è¯¥è®¾å¤‡åˆ†é…ç»™å…¶ä»–è¿›ç¨‹ä½¿ç”¨ã€‚è¿™ç§åˆ†é…ç­–ç•¥çš„ç¼ºç‚¹æ˜¯ï¼Œè®¾å¤‡å¾—ä¸åˆ°å……åˆ†åˆ©ç”¨ï¼Œè€Œä¸”è¿˜å¯èƒ½å¼•èµ·æ­»é”ã€‚ (2)å…±äº«è®¾å¤‡ å¯¹äºå…±äº«è®¾å¤‡ï¼Œå¯åŒæ—¶åˆ†é…ç»™å¤šä¸ªè¿›ç¨‹ä½¿ç”¨ï¼Œæ­¤æ—¶éœ€è¦æ³¨æ„å¯¹è¿™äº›è¿›ç¨‹è®¿é—®è¯¥è®¾å¤‡çš„å…ˆåé¡ºåºè¿›è¡Œåˆç†çš„è°ƒåº¦ã€‚ (3)å¯è™šæ‹Ÿè®¾å¤‡ ç”±äºå¯è™šæ‹Ÿè®¾å¤‡æ˜¯æŒ‡ä¸€å°ç‰©ç†è®¾å¤‡åœ¨é‡‡ç”¨è™šæ‹ŸæŠ€æœ¯åå¯å˜æˆå¤šå°é€»è¾‘ä¸Šçš„æ‰€è°“è™šæ‹Ÿè®¾å¤‡ï¼Œå› è€Œä¸€å°å¯è™šæ‹Ÿè®¾å¤‡æ˜¯å¯å…±äº«çš„è®¾å¤‡ï¼Œå¯ä»¥å°†å®ƒåŒæ—¶åˆ†é…ç»™å¤šä¸ªè¿›ç¨‹ä½¿ç”¨ï¼Œå¹¶å¯¹è¿›ç¨‹è®¿é—®è¯¥è®¾å¤‡çš„å…ˆåé¡ºåºè¿›è¡Œæ§åˆ¶ã€‚ 2.è®¾å¤‡åˆ†é…ç®—æ³• å¯¹è®¾å¤‡åˆ†é…çš„ç®—æ³•ï¼Œä¸è¿›ç¨‹è°ƒåº¦çš„ç®—æ³•æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†ç›¸å¯¹ç®€å•ï¼Œé€šå¸¸åªé‡‡ç”¨ä»¥ä¸‹ä¸¤ç§åˆ†é…ç®—æ³•ã€‚ (1)å…ˆæ¥å…ˆæœåŠ¡ å½“æœ‰å¤šä¸ªè¿›ç¨‹å¯¹åŒä¸€è®¾å¤‡æå‡ºI/Oè¯·æ±‚æ—¶ï¼Œè¯¥ç®—æ³•æ˜¯æ ¹æ®è¿›ç¨‹å¯¹æŸè®¾å¤‡æå‡ºè¯·æ±‚çš„å…ˆåé¡ºåºå°†è¿™äº›è¿›ç¨‹æ’æˆä¸€ä¸ªè®¾å¤‡è¯·æ±‚é˜Ÿåˆ—ï¼Œè®¾å¤‡åˆ†é…ç¨‹åºæ€»æ˜¯å…ˆæŠŠè®¾å¤‡åˆ†é…ç»™é˜Ÿé¦–è¿›ç¨‹ã€‚ (2)åŸºäºä¼˜å…ˆæƒçš„åˆ†é…ç®—æ³• åœ¨è¿›ç¨‹è°ƒåº¦ä¸­çš„è¿™ç§ç­–ç•¥ï¼Œæ˜¯ä¼˜å…ˆæƒé«˜çš„è¿›ç¨‹ä¼˜å…ˆè·å¾—å¤„ç†æœºã€‚å¦‚æœå¯¹è¿™ç§é«˜ä¼˜å…ˆæƒè¿›ç¨‹æ‰€æå‡ºçš„I/Oè¯·æ±‚ä¹Ÿèµ‹äºˆé«˜ä¼˜å…ˆæƒï¼Œæ˜¾ç„¶æœ‰åŠ©äºè¿™ç§è¿›ç¨‹å°½å¿«å®Œæˆã€‚åœ¨åˆ©ç”¨è¯¥ç®—æ³•å½¢æˆè®¾å¤‡é˜Ÿåˆ—æ—¶ï¼Œå°†ä¼˜å…ˆæƒé«˜çš„è¿›ç¨‹æ’åœ¨è®¾å¤‡é˜Ÿåˆ—å‰é¢ï¼Œè€Œå¯¹äºä¼˜å…ˆçº§ç›¸åŒçš„I/Oè¯·æ±‚ï¼Œåˆ™æŒ‰å…ˆæ¥å…ˆæœåŠ¡åŸåˆ™æ’é˜Ÿã€‚ 3.è®¾å¤‡åˆ†é…æ–¹å¼ ä»è¿›ç¨‹è¿è¡Œçš„å®‰å…¨æ€§ä¸Šè€ƒè™‘ï¼Œè®¾å¤‡åˆ†é…æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ã€‚ (1)å®‰å…¨åˆ†é…æ–¹å¼ åœ¨è¿™ç§åˆ†é…æ–¹å¼ä¸­ï¼Œæ¯å½“è¿›ç¨‹å‘å‡ºI/Oè¯·æ±‚åï¼Œä¾¿è¿›äººé˜»å¡çŠ¶æ€ï¼Œç›´åˆ°å…¶I/Oæ“ä½œå®Œæˆæ—¶æ‰è¢«å”¤é†’ã€‚åœ¨é‡‡ç”¨è¿™ç§åˆ†é…ç­–ç•¥æ—¶ï¼Œä¸€æ—¦è¿›ç¨‹å·²ç»è·å¾—æŸç§è®¾å¤‡ï¼ˆèµ„æºï¼‰åä¾¿é˜»å¡ï¼Œä½¿è¯¥è¿›ç¨‹ä¸å¯èƒ½å†è¯·æ±‚ä»»ä½•å…¶ä»–èµ„æºï¼Œè€Œåœ¨å®ƒè¿è¡Œæ—¶åˆä¸èƒ½ä¿æŒä»»ä½•èµ„æºã€‚å› æ­¤ï¼Œè¿™ç§åˆ†é…æ–¹å¼å·²ç»æ‘’å¼ƒäº†é€ æˆæ­»é”çš„4ä¸ªå¿…è¦æ¡ä»¶ä¹‹ä¸€çš„â€œè¯·æ±‚å’Œä¿æŒâ€æ¡ä»¶ï¼Œä»è€Œä½¿è®¾å¤‡åˆ†é…æ˜¯å®‰å…¨çš„ã€‚å…¶ç¼ºç‚¹æ˜¯è¿›ç¨‹è¿›å±•ç¼“æ…¢ï¼Œå³å¯¹äºåŒä¸€ä¸ªè¿›ç¨‹ï¼ŒCPUä¸I/Oè®¾å¤‡æ˜¯ä¸²è¡Œå·¥ä½œçš„ã€‚ (2)ä¸å®‰å…¨åˆ†é…æ–¹å¼ åœ¨è¿™ç§åˆ†é…æ–¹å¼ä¸­ï¼Œè¿›ç¨‹åœ¨å‘å‡ºI/Oè¯·æ±‚åä»åœ¨ç»§ç»­è¿è¡Œï¼Œéœ€è¦æ—¶åˆå‘å‡ºå…¶ä»–çš„I/Oè¯·æ±‚ã€‚ä»…å½“è¿›ç¨‹æ‰€è¯·æ±‚çš„è®¾å¤‡å·²è¢«å¦ä¸€ä¸ªè¿›ç¨‹å ç”¨æ—¶ï¼Œè¯·æ±‚è¿›ç¨‹æ‰è¿›äººé˜»å¡çŠ¶æ€ã€‚è¿™ç§åˆ†é…æ–¹å¼çš„ä¼˜ç‚¹æ˜¯ï¼Œä¸€ä¸ªè¿›ç¨‹å¯åŒæ—¶æ“ä½œå¤šä¸ªè®¾å¤‡ï¼Œä½¿è¿›ç¨‹æ¨è¿›è¿…é€Ÿã€‚å…¶ç¼ºç‚¹æ˜¯åˆ†é…ä¸å®‰å…¨ï¼Œå› ä¸ºå®ƒå¯èƒ½å…·å¤‡â€œè¯·æ±‚å’Œä¿æŒâ€æ¡ä»¶ï¼Œä»è€Œå¯èƒ½é€ æˆæ­»é”ã€‚ ä¸‰ã€è®¾å¤‡ç‹¬ç«‹æ€§ 1.è®¾å¤‡ç‹¬ç«‹æ€§çš„æ¦‚å¿µ ä¸ºäº†æé«˜æ“ä½œç³»ç»Ÿçš„å¯é€‚åº”æ€§å’Œå¯æ‰©å±•æ€§ï¼Œåœ¨ç°ä»£æ“ä½œç³»ç»Ÿä¸­éƒ½æ¯«æ— ä¾‹å¤–åœ°å®ç°äº†è®¾å¤‡ç‹¬ç«‹æ€§ï¼Œä¹Ÿç§°ä¸ºè®¾å¤‡æ— å…³æ€§ã€‚å…¶åŸºæœ¬å«ä¹‰æ˜¯åº”ç”¨ç¨‹åºç‹¬ç«‹äºå…·ä½“ä½¿ç”¨çš„ç‰©ç†è®¾å¤‡ã€‚ä¸ºäº†å®ç°è®¾å¤‡ç‹¬ç«‹æ€§ï¼Œå¼•å…¥äº†é€»è¾‘è®¾å¤‡å’Œç‰©ç†è®¾å¤‡è¿™ä¸¤ä¸ªæ¦‚å¿µã€‚åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œä½¿ç”¨é€»è¾‘è®¾å¤‡åç§°æ¥è¯·æ±‚ä½¿ç”¨æŸç±»è®¾å¤‡ï¼Œè€Œç³»ç»Ÿåœ¨å®é™…æ‰§è¡Œæ—¶ï¼Œè¿˜å¿…é¡»ä½¿ç”¨ç‰©ç†è®¾å¤‡åç§°ã€‚å› æ­¤ï¼Œç³»ç»Ÿå¿…é¡»å…·æœ‰å°†é€»è¾‘è®¾å¤‡åç§°è½¬æ¢ä¸ºç‰©ç†è®¾å¤‡åç§°çš„åŠŸèƒ½ã€‚ 2.å®ç°è®¾å¤‡ç‹¬ç«‹æ€§å¸¦æ¥çš„å¥½å¤„ å®ç°è®¾å¤‡ç‹¬ç«‹æ€§å¸¦æ¥çš„å¥½å¤„å¦‚ä¸‹ã€‚ 1)åº”ç”¨ç¨‹åºä¸ç‰©ç†è®¾å¤‡æ— å…³ï¼Œç³»ç»Ÿå¢å‡æˆ–å˜æ›´å¤–å›´è®¾å¤‡æ—¶ä¸éœ€è¦ä¿®æ”¹åº”ç”¨ç¨‹åºã€‚ 2)æ˜“äºå¤„ç†è¾“å…¥/è¾“å‡ºè®¾å¤‡çš„æ•…éšœã€‚ä¾‹å¦‚ï¼ŒæŸå°æ‰“å°æœºå‘ç”Ÿæ•…éšœæ—¶ï¼Œå¯ç”¨å¦ä¸€å°ä¸åŒå‹å·ã€ä¸åŒå“ç‰Œçš„æ‰“å°æœºæ›¿æ¢ï¼Œè€Œä¸ç”¨ä¿®æ”¹åº”ç”¨ç¨‹åºã€‚ 3)æé«˜äº†ç³»ç»Ÿçš„å¯é æ€§ï¼Œå¢åŠ äº†è®¾å¤‡åˆ†é…çš„çµæ´»æ€§ã€‚ 3.è®¾å¤‡ç‹¬ç«‹è½¯ä»¶ è®¾å¤‡ç‹¬ç«‹è½¯ä»¶å®Œæˆçš„ä¸»è¦åŠŸèƒ½å¦‚ä¸‹ã€‚ (1)æ‰§è¡Œæ‰€æœ‰è®¾å¤‡çš„å…¬æœ‰æ“ä½œ æ‰§è¡Œçš„æ“ä½œåŒ…æ‹¬ï¼šç‹¬å è®¾å¤‡çš„åˆ†é…ä¸å›æ”¶ã€å°†é€»è¾‘è®¾å¤‡åæ˜ å°„ä¸ºç‰©ç†è®¾å¤‡åã€å¯¹è®¾å¤‡è¿›è¡Œä¿æŠ¤ã€ç¼“å†²ç®¡ç†å’Œå·®é”™æ§åˆ¶ã€‚ä¸ºäº†å®ç°é€»è¾‘è®¾å¤‡ååˆ°ç‰©ç†è®¾å¤‡åçš„è½¬åŒ–ï¼Œå¯ä»¥åˆ©ç”¨ç§°ä¸ºé€»è¾‘è®¾å¤‡è¡¨LUT(Logical Unit Table)çš„æ•°æ®ç»“æ„ã€‚åœ¨è¯¥è¡¨çš„æ¯ä¸ªè¡¨ç›®ä¸­éƒ½åŒ…å«é€»è¾‘è®¾å¤‡åã€ç‰©ç†è®¾å¤‡åã€‚LUTçš„è®¾ç½®å¯é‡‡å–ä¸¤ç§æ–¹å¼ï¼šä¸ºæ•´ä¸ªç³»ç»Ÿè®¾ç½®ä¸€å¼ LUTæˆ–è€…ä¸ºæ¯ä¸ªç”¨æˆ·è®¾ç½®ä¸€å¼ LUTã€‚ (2)å‘ç”¨æˆ·å±‚è½¯ä»¶æä¾›ç»Ÿä¸€çš„æ¥å£ è®¾å¤‡ç‹¬ç«‹è½¯ä»¶å‘ç”¨æˆ·å±‚å±è”½è®¿é—®ç¡¬ä»¶çš„ç»†èŠ‚ï¼Œå‘åº”ç”¨è½¯ä»¶å’Œæœ€ç»ˆç”¨æˆ·æä¾›ç®€å•ã€ç»Ÿä¸€çš„è®¿é—®æ¥å£ã€‚ä¾‹å¦‚ï¼Œå¯¹å„ç§è®¾å¤‡çš„è¯»æ“ä½œåœ¨åº”ç”¨ç¨‹åºä¸­éƒ½ä½¿ç”¨readå‡½æ•°è°ƒç”¨ï¼Œå†™æ“ä½œéƒ½ä½¿ç”¨writeå‡½æ•°è°ƒç”¨ã€‚ ä¾‹6-1ï¼šåœ¨ç¼–ç¨‹çº§ï¼Œå¦‚æœè¦åœ¨ç¨‹åºä¸­åœ¨æ‰“å°æœº/dev/ptlä¸Šè¾“å‡ºå­—ç¬¦ä¸²â€œhelloâ€ï¼Œç”¨ä¸‹åˆ—è¯­å¥å³å¯ã€‚ fd open(\"/dev/ptl\"); write(\"hello\"); close(fd); å››ã€ç‹¬å è®¾å¤‡çš„åˆ†é…ç¨‹åº å¯¹äºå…·æœ‰I/Oé€šé“çš„ç³»ç»Ÿï¼Œåœ¨è¿›ç¨‹æå‡ºI/Oè¯·æ±‚åï¼Œç³»ç»Ÿçš„è®¾å¤‡åˆ†é…ç¨‹åºå¯æŒ‰ä¸‹åˆ—æ­¥éª¤è¿›è¡Œè®¾å¤‡åˆ†é…ã€‚ (1)åˆ†é…è®¾å¤‡ æ ¹æ®ç”¨æˆ·è¯·æ±‚çš„è®¾å¤‡çš„ç‰©ç†åï¼ŒæŸ¥æ‰¾ç³»ç»Ÿè®¾å¤‡è¡¨ï¼Œä»ä¸­æ‰¾å‡ºè¯¥è®¾å¤‡çš„è®¾å¤‡æ§åˆ¶è¡¨ï¼Œæ£€æŸ¥è®¾å¤‡æ§åˆ¶è¡¨ä¸­çš„è®¾å¤‡çŠ¶æ€å­—ã€‚è‹¥è®¾å¤‡å¿™ï¼Œåˆ™å°†è¿›ç¨‹é˜»å¡åœ¨è¯¥è®¾å¤‡çš„é˜»å¡é˜Ÿåˆ—ä¸­ï¼›è‹¥è®¾å¤‡ç©ºé—²ï¼Œåˆ™æ ¹æ®è®¾å¤‡åˆ†é…ç®—æ³•å°†è®¾å¤‡åˆ†é…ç»™è¿›ç¨‹ã€‚ (2)åˆ†é…æ§åˆ¶å™¨ è‹¥ç³»ç»Ÿä¸ºè¿›ç¨‹åˆ†é…äº†å…¶è¯·æ±‚çš„è®¾å¤‡ï¼Œå°±åˆ°è¯¥è®¾å¤‡çš„æ§åˆ¶è¡¨ä¸­æ‰¾å‡ºä¸è¯¥è®¾å¤‡è¿æ¥çš„æ§åˆ¶å™¨çš„COCTï¼Œå³è®¾å¤‡æ§åˆ¶å™¨æ§åˆ¶è¡¨ï¼Œæ£€æŸ¥å…¶ä¸­çš„çŠ¶æ€å­—æ®µã€‚è‹¥è¯¥æ§åˆ¶å™¨å¿™ï¼Œåˆ™å°†è¯·æ±‚I/Oçš„è¿›ç¨‹é˜»å¡åœ¨è¯¥è®¾å¤‡æ§åˆ¶å™¨çš„é˜»å¡é˜Ÿåˆ—ä¸­ï¼›è‹¥æ§åˆ¶å™¨ç©ºé—²ï¼Œåˆ™å°†å®ƒåˆ†é…ç»™è¿›ç¨‹ã€‚ (3)åˆ†é…é€šé“ åœ¨æœ‰é€šé“çš„ç³»ç»Ÿä¸­ï¼Œè¿˜éœ€è¦ä»ç›¸åº”çš„è®¾å¤‡æ§åˆ¶å™¨æ§åˆ¶è¡¨ä¸­æ‰¾åˆ°ä¸è¯¥æ§åˆ¶å™¨è¿æ¥çš„é€šé“æ§åˆ¶è¡¨ï¼Œæ£€æŸ¥è¡¨ä¸­çš„é€šé“çŠ¶æ€å­—æ®µã€‚è‹¥é€šé“å¿™ï¼Œåˆ™å°†è¿›ç¨‹é˜»å¡åœ¨è¯¥é€šé“çš„é˜»å¡é˜Ÿåˆ—ä¸Šï¼›è‹¥é€šé“ç©ºé—²ï¼Œåˆ™å°†è¯¥é€šé“åˆ†é…ç»™è¿›ç¨‹ã€‚ å½“è¿›ç¨‹è·å¾—äº†è®¾å¤‡ã€è®¾å¤‡æ§åˆ¶å™¨æˆ–è€…è·å¾—äº†è®¾å¤‡ã€è®¾å¤‡æ§åˆ¶å™¨å’Œé€šé“æ—¶ï¼ˆåœ¨æœ‰é€šé“çš„ç³» ç»Ÿä¸­)ï¼Œç³»ç»Ÿçš„æœ¬æ¬¡è®¾å¤‡åˆ†é…æ‰ç®—æˆåŠŸï¼Œç³»ç»Ÿå¯ä»¥å¯åŠ¨è¿›ç¨‹çš„I/Oã€‚ äº”ã€SPOOLingæŠ€æœ¯ 1.ä»€ä¹ˆæ˜¯SP00Ling åœ¨å¤šé“ç¨‹åºç¯å¢ƒä¸‹ï¼Œåˆ©ç”¨ä¸€é“ç¨‹åºæ¥æ¨¡æ‹Ÿè„±æœºè¾“å…¥æ—¶çš„å¤–å›´æ§åˆ¶æœºçš„åŠŸèƒ½ï¼ŒæŠŠä½é€ŸI/Oè®¾å¤‡ä¸Šçš„æ•°æ®ä¼ é€åˆ°é«˜é€Ÿè¾“å‡ºç£ç›˜ä¸Šï¼Œå†åˆ©ç”¨å¦ä¸€é“ç¨‹åºæ¥æ¨¡æ‹Ÿè„±æœºè¾“å‡ºæ—¶å¤–å›´æ§åˆ¶æœºçš„åŠŸèƒ½ï¼ŒæŠŠæ•°æ®ä»ç£ç›˜ä¼ é€åˆ°ä½é€Ÿè¾“å‡ºè®¾å¤‡ä¸Šã€‚è¿™ç§åœ¨è”æœºæƒ…å†µä¸‹å®ç°çš„åŒæ—¶å¤–å›´æ“ä½œç§°ä¸ºSPOOLing (Simultaneous Perihernal Operations On-Line)ã€‚ (1)SPOOLingç³»ç»Ÿçš„ç»„æˆ SPOOingç³»ç»Ÿçš„ç»„æˆå¦‚å›¾6-12æ‰€ç¤ºã€‚ 1)è¾“å…¥äº•å’Œè¾“å‡ºäº•ã€‚è¿™æ˜¯ä½äºç£ç›˜ä¸Šçš„ä¸¤ä¸ªåˆ†åˆ«å­˜æ”¾è¾“å…¥æ•°æ®å’Œè¾“å‡ºæ•°æ®çš„å­˜å‚¨åŒºåŸŸï¼Œä½œä¸ºå¤§é‡è¾“å…¥æˆ–è¾“å‡ºæ•°æ®çš„ç¼“å­˜ã€‚ 2)è¾“å…¥ç¼“å†²åŒºå’Œè¾“å‡ºç¼“å†²åŒºã€‚è¾“å…¥ç¼“å†²åŒºç”¨æ¥æš‚å­˜ç”±è¾“å…¥è®¾å¤‡é€æ¥çš„è¾“å…¥æ•°æ®ï¼Œè¾“å‡ºç¼“å­˜åŒºç”¨æ¥å­˜æ”¾ä»è¾“å‡ºäº•é€æ¥çš„è¾“å‡ºæ•°æ®ï¼Œä»¥åå†ä¼ ç»™è¾“å‡ºè®¾å¤‡ã€‚ 3)è¾“å…¥è¿›ç¨‹SPiå’Œè¾“å‡ºè¿›ç¨‹SP0ã€‚è¾“å…¥è¿›ç¨‹æŠŠè¾“å…¥è®¾å¤‡é€æ¥çš„æ•°æ®é€å…¥è¾“å…¥ç¼“å­˜ï¼Œå†æŠŠç¼“å­˜ä¸­çš„æ•°æ®é€å…¥è¾“å…¥äº•ã€‚å½“æ¶ˆè´¹è€…è¿›ç¨‹éœ€è¦è¾“å…¥æ•°æ®æ—¶ï¼Œå†ä»è¾“äººäº•æŠŠè¾“å…¥æ•°æ®è¯»å…¥å†…å­˜ã€‚ è¾“å‡ºè¿›ç¨‹æŠŠè¦è¾“å‡ºçš„æ•°æ®ä»å†…å­˜é€å…¥è¾“å‡ºäº•ï¼Œå½“éœ€è¦è¾“å‡ºæ•°æ®æ—¶ï¼Œå†ä»è¾“å‡ºäº•æŠŠæ•°æ®è¯»åˆ°è¾“å‡ºç¼“å­˜ï¼ˆå¦‚æ‰“å°ç¼“å­˜ï¼‰ï¼Œæ•°æ®ä»è¾“å‡ºç¼“å­˜é€å¾€è¾“å‡ºè®¾å¤‡ã€‚ 4)è¯·æ±‚I/Oé˜Ÿåˆ—ã€‚è¯·æ±‚è¾“å…¥æˆ–è¾“å‡ºçš„è¿›ç¨‹æäº¤çš„è¾“å…¥/è¾“å‡ºä»»åŠ¡ç»„æˆçš„é˜Ÿåˆ—ã€‚ 2.åˆ©ç”¨SPOOLingæŠ€æœ¯å®ç°å…±äº«æ‰“å°æœº å½“ç”¨æˆ·è¿›ç¨‹æå‡ºæ‰“å°è¯·æ±‚æ—¶ï¼ŒSPOOLingç³»ç»Ÿå…ˆä¸ºç”¨æˆ·åšä¸‹åˆ—ä¸¤ä»¶äº‹ã€‚ 1)ç”±è¾“å‡ºè¿›ç¨‹åœ¨è¾“å‡ºäº•ä¸­ç”³è¯·ç©ºé—²ç›˜å—åŒºï¼Œå¹¶å°†è¦æ‰“å°çš„æ•°æ®é€å…¥å…¶ä¸­ã€‚ 2)è¾“å‡ºè¿›ç¨‹å†ä¸ºç”¨æˆ·ç”³è¯·å¹¶å¡«å†™ä¸€å¼ ç”¨æˆ·è¯·æ±‚æ‰“å°è¡¨ï¼Œå°†è¯¥è¡¨æŒ‚åˆ°è¯·æ±‚æ‰“å°é˜Ÿåˆ—ä¸Šã€‚å½“æ‰“å°æœºç©ºé—²æ—¶ï¼Œè¾“å‡ºè¿›ç¨‹å®Œæˆä»¥ä¸‹åŠ¨ä½œã€‚ â‘ ä»è¯·æ±‚æ‰“å°é˜Ÿåˆ—é˜Ÿé¦–å–ä¸€å¼ è¯·æ±‚æ‰“å°è¡¨ã€‚ â‘¡å°†æ‰“å°æ•°æ®ä»è¾“å‡ºäº•é€åˆ°æ‰“å°æœºç¼“å†²åŒºï¼ˆè¾“å‡ºç¼“å†²åŒºï¼‰ã€‚ â‘¢æ‰“å°ã€‚ â‘£æ‰“å°å®Œæ¯•ï¼Œè‹¥æ‰“å°é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œåˆ™è½¬ç¬¬â‘ æ­¥ã€‚ SPOOLingç³»ç»Ÿçš„ç‰¹ç‚¹å¦‚ä¸‹ã€‚ 1)æé«˜äº†I/Oé€Ÿåº¦ã€‚ç”±äºä½¿ç”¨äº†ç£ç›˜ä½œä¸ºä½é€Ÿè®¾å¤‡ï¼ˆå¦‚æ‰“å°æœºã€ç£å¸¦ç­‰ï¼‰çš„å¤§å®¹é‡ç¼“å­˜ï¼Œæé«˜äº†è¾“å…¥/è¾“å‡ºçš„é€Ÿåº¦ã€‚ 2)å°†ç‹¬å è®¾å¤‡æ”¹é€ ä¸ºå…±äº«è®¾å¤‡ã€‚é€šè¿‡SPOOLingç³»ç»Ÿä½¿ç‹¬å è®¾å¤‡å˜ä¸ºäº†é€»è¾‘ä¸Šçš„å…±äº«è®¾å¤‡ï¼Œç³»ç»Ÿå¯ä»¥åŒæ—¶æ¥å—å¤šä¸ªç”¨æˆ·å¯¹è®¾å¤‡çš„è®¿é—®è¯·æ±‚ã€‚ 3)å®ç°äº†è™šæ‹Ÿè®¾å¤‡åŠŸèƒ½ã€‚æŠŠä¸€å°ç‰©ç†ä¸Šåªèƒ½äº’æ–¥ä½¿ç”¨çš„è®¾å¤‡ï¼Œå˜ä¸ºäº†ä»ç”¨æˆ·çœ¼é‡Œçœ‹åˆ°çš„å…±äº«è®¾å¤‡ã€‚å®è§‚ä¸Šçœ‹ï¼Œç³»ç»Ÿå¯ä»¥åŒæ—¶å“åº”å¤šä¸ªç”¨æˆ·å¯¹è®¾å¤‡çš„è¯·æ±‚ã€‚å¾®è§‚ä¸Šçœ‹ï¼Œä»»æ„æ—¶åˆ»è®¾å¤‡åªèƒ½ä¸ºæŸä¸€ä¸ªç”¨æˆ·è¿›ç¨‹æœåŠ¡ï¼ŒSPOOLingç³»ç»Ÿå®ç°äº†å°†ç‹¬å è®¾å¤‡å˜æ¢æˆå¤šä¸ªé€»è¾‘è®¾å¤‡çš„åŠŸèƒ½ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å…­ç« _I_Oè®¾å¤‡ç®¡ç†/ç¬¬äº”èŠ‚_I_Oè½¯ä»¶ç®¡ç†.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å…­ç« _I_Oè®¾å¤‡ç®¡ç†/ç¬¬äº”èŠ‚_I_Oè½¯ä»¶ç®¡ç†.html","title":"ç¬¬äº”èŠ‚ I/Oè½¯ä»¶ç®¡ç†","keywords":"","body":"ç¬¬äº”èŠ‚ I/Oè½¯ä»¶ç®¡ç† I/Oè½¯ä»¶çš„æ€»ä½“ç›®æ ‡æ˜¯å°†è½¯ä»¶ç»„ç»‡æˆä¸€ç§å±‚æ¬¡ç»“æ„ï¼Œä½å±‚è½¯ä»¶ç”¨æ¥å±è”½ç¡¬ä»¶çš„å…·ä½“ç»†èŠ‚ï¼Œé«˜å±‚è½¯ä»¶åˆ™ä¸»è¦æ˜¯ä¸ºç”¨æˆ·æä¾›ä¸€ä¸ªç®€æ´ã€è§„èŒƒçš„ç•Œé¢ã€‚ç”¨æˆ·ç¨‹åºåŠæ“ä½œç³»ç»Ÿä¸­è®¾å¤‡ç®¡ç†è½¯ä»¶çš„æ„æˆå’Œå…³ç³»å¦‚å›¾6-13æ‰€ç¤ºï¼Œå°†è®¾å¤‡ç®¡ç†è½¯ä»¶ç»„ç»‡æˆ4ä¸ªå±‚æ¬¡ï¼Œå³ 1)ç”¨æˆ·å±‚è½¯ä»¶ã€‚ 2)ä¸è®¾å¤‡æ— å…³çš„è½¯ä»¶å±‚ã€‚ 3)è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚ 4)ä¸­æ–­å¤„ç†ç¨‹åºï¼ˆåº•å±‚ï¼‰ã€‚ è®¾å¤‡ç®¡ç†è½¯ä»¶ä¸ç¡¬ä»¶å…³ç³»æœ€å¯†åˆ‡çš„æ˜¯è®¾å¤‡é©±åŠ¨ç¨‹åºï¼ŒåŒ…æ‹¬è®¾å¤‡æœåŠ¡ç¨‹åºå’Œä¸­æ–­å¤„ç†ç¨‹åºã€‚è®¾å¤‡é©±åŠ¨ç¨‹åºä¸Šå±‚æ˜¯è®¾å¤‡æ— å…³è½¯ä»¶ï¼Œé€šå¸¸å®Œæˆè®¾å¤‡å‘½åã€è®¾å¤‡åˆ†é…ã€è®¾å¤‡ç‹¬ç«‹æ€§å’Œç¼“å†²ç®¡ç†ç­‰åŠŸèƒ½ã€‚æœ€ä¸Šå±‚çš„ç”¨æˆ·è¿›ç¨‹å‘ç³»ç»Ÿå‘é€I/Oè¯·æ±‚ï¼Œæ˜¾ç¤ºI/Oæ“ä½œçš„ç»“æœï¼Œæä¾›ç”¨æˆ·ä¸è®¾å¤‡çš„æ¥å£ã€‚ ä¸€ã€è®¾å¤‡ç®¡ç†è½¯ä»¶çš„åŠŸèƒ½ æœ¬èŠ‚ç»¼è¿°è®¾å¤‡ç®¡ç†è½¯ä»¶çš„åŠŸèƒ½ï¼Œåé¢çš„å†…å®¹åˆ†åˆ«è¯´æ˜è®¾å¤‡é©±åŠ¨ç¨‹åºã€I/Oè®¾å¤‡ä¸­æ–­å¤„ç†ç¨‹åºçš„åŠŸèƒ½å’Œè®¾å¤‡æ— å…³è½¯ä»¶ã€‚æ“ä½œç³»ç»Ÿè®¾å¤‡ç®¡ç†è½¯ä»¶(I/Oè½¯ä»¶)åº”è¯¥å®ç°ä»¥ä¸‹åŠŸèƒ½ã€‚ 1.å®ç°I/Oè®¾å¤‡çš„ç‹¬ç«‹æ€§ å½“ç”¨æˆ·ä½¿ç”¨çš„è®¾å¤‡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ¯”å¦‚ç”¨æ¿€å…‰æ‰“å°æœºæ›¿ä»£äº†å–·å¢¨æ‰“å°æœºï¼Œåº”ç”¨ç¨‹åºçš„ä»£ç ä¸éœ€è¦ä¿®æ”¹ã€‚æ“ä½œç³»ç»Ÿå‘åº”ç”¨è½¯ä»¶å±‚æä¾›çš„è¿™ä¸€æ”¯æŒæ–¹ä¾¿äº†åº”ç”¨ç¨‹åºçš„å¼€å‘å’Œç»´æŠ¤ã€‚ 2.é”™è¯¯å¤„ç† é”™è¯¯åº”è¯¥åœ¨å°½å¯èƒ½æ¥è¿‘ç¡¬ä»¶çš„åœ°æ–¹å¤„ç†ï¼Œåªæœ‰åœ¨ä½å±‚è½¯ä»¶å¤„ç†ä¸äº†çš„æƒ…å†µä¸‹æ‰é€šçŸ¥é«˜å±‚è½¯ä»¶ã€‚ä¾‹å¦‚ï¼Œæ§åˆ¶å™¨è¿›è¡Œä¸€ä¸ªè¯»æ“ä½œï¼Œå®ƒåº”è¯¥å°½é‡å¤„ç†å¹¶å®Œæˆæ“ä½œï¼Œå¦‚æœå› ä¸ºæŸç§æ•…éšœæ§åˆ¶å™¨å¤„ç†ä¸äº†ï¼Œåˆ™äº¤ç»™è®¾å¤‡é©±åŠ¨ç¨‹åºï¼Œå¯èƒ½åªéœ€é‡è¯»ä¸€æ¬¡å°±å¯ä»¥è§£å†³é—®é¢˜ã€‚ 3.å¼‚æ­¥ä¼ è¾“ å¤šæ•°ç‰©ç†I/Oæ˜¯å¼‚æ­¥ä¼ è¾“ï¼Œå³CPUåœ¨å¯åŠ¨ä¼ è¾“æ“ä½œåä¾¿å¯ä»¥è½¬å‘å…¶ä»–å·¥ä½œï¼Œç›´åˆ°ä¸­æ–­åˆ°è¾¾ã€‚ 4.ç¼“å†²ç®¡ç† ç”±äºè®¾å¤‡ä¹‹é—´çš„é€Ÿåº¦å·®å¼‚ï¼Œå¿…é¡»æä¾›ç¼“å†²ç®¡ç†ï¼Œä¸ºæ‰€æœ‰çš„å—è®¾å¤‡å’Œå­—ç¬¦è®¾å¤‡æä¾›ç¼“å†²ç®¡ç†åŠŸèƒ½ï¼Œå¹¶å‘é«˜å±‚è½¯ä»¶å±è”½ç”±äºè®¾å¤‡å·®å¼‚å¸¦æ¥çš„ç¼“å†²ç®¡ç†å®ç°çš„å…·ä½“ç»†èŠ‚ã€‚ 5.è®¾å¤‡çš„åˆ†é…å’Œé‡Šæ”¾ å¯¹å…±äº«è®¾å¤‡å’Œäº’æ–¥è®¾å¤‡åº”è¯¥é‡‡å–ä¸åŒçš„æ–¹å¼ä¸ºç”¨æˆ·è¯·æ±‚åˆ†é…è®¾å¤‡ã€‚è®¾å¤‡ä½¿ç”¨å®Œæ¯•ï¼Œè¦å®Œæˆå¯¹è®¾å¤‡çš„é‡Šæ”¾ã€‚ 6.å®ç°I/Oæ§åˆ¶æ–¹å¼ é’ˆå¯¹ä¸åŒçš„è®¾å¤‡æä¾›ä¸åŒçš„I/Oæ§åˆ¶æ–¹å¼ï¼Œå¦‚å¯¹æ‰“å°æœºã€é”®ç›˜ç­‰å­—ç¬¦è®¾å¤‡å®ç°ä¸­æ–­æ§åˆ¶ã€‚è€Œå¯¹ç£ç›˜è¿™æ ·çš„å—è®¾å¤‡æ—¢å¯ä»¥é‡‡ç”¨ä¸­æ–­æ§åˆ¶æ–¹å¼ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨DMAæ§åˆ¶æ–¹å¼ã€‚ä½†æ˜¯ï¼Œé‰´äºç£ç›˜ä¼ è¾“æ•°æ®çš„ç‰¹ç‚¹ï¼Œä¸€èˆ¬éƒ½é‡‡ç”¨DMAæ§åˆ¶æ–¹å¼ã€‚ æ“ä½œç³»ç»Ÿé€šè¿‡å°†I/Oè½¯ä»¶ç»„ç»‡æˆå¦‚å›¾6-13æ‰€ç¤ºçš„4ä¸ªå±‚æ¬¡ï¼Œå¯ä»¥åˆç†ã€é«˜æ•ˆåœ°å®ç°ä»¥ä¸Šç›®æ ‡ã€‚ äºŒã€ä¸­æ–­å¤„ç†ç¨‹åº I/Oä¸­æ–­å¤„ç†ç¨‹åºçš„ä½œç”¨æ˜¯å°†å‘å‡ºI/Oè¯·æ±‚è€Œè¢«é˜»å¡çš„è¿›ç¨‹å”¤é†’ã€‚ç”¨æˆ·è¿›ç¨‹åœ¨å‘å‡ºI/Oè¯·æ±‚åï¼Œç”±äºç­‰å¾…I/Oçš„å®Œæˆè€Œè¢«é˜»å¡ã€‚CPUè½¬å»æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œå½“I/Oä»»åŠ¡å®Œæˆï¼Œæ§åˆ¶å™¨å‘CPUå‘ä¸­æ–­è¯·æ±‚ä¿¡å·ï¼ŒCPUè½¬å»æ‰§è¡Œä¸­æ–­å¤„ç†ç¨‹åºï¼Œç”±ä¸­æ–­å¤„ç†ç¨‹åºå”¤é†’è¢«é˜»å¡çš„è®¾å¤‡ç”¨æˆ·è¿›ç¨‹ã€‚ ä¸‰ã€è®¾å¤‡é©±åŠ¨ç¨‹åº è®¾å¤‡é©±åŠ¨ç¨‹åºæ˜¯I/Oè¿›ç¨‹ä¸è®¾å¤‡æ§åˆ¶å™¨ä¹‹é—´çš„é€šä¿¡ç¨‹åºï¼Œå…¶ä¸»è¦ä»»åŠ¡æ˜¯æ¥å—ä¸Šå±‚è½¯ä»¶å‘æ¥çš„æŠ½è±¡çš„I/Oè¯·æ±‚ï¼Œå¦‚readæˆ–writeå‘½ä»¤ï¼ŒæŠŠå®ƒä»¬è½¬æ¢ä¸ºå…·ä½“è¦æ±‚åï¼Œå‘é€ç»™è®¾å¤‡æ§åˆ¶å™¨ï¼Œå¯åŠ¨è®¾å¤‡å»æ‰§è¡Œã€‚æ­¤å¤–ï¼Œå®ƒä¹Ÿå°†ç”±è®¾å¤‡æ§åˆ¶å™¨å‘æ¥çš„ä¿¡å·ä¼ é€ç»™ä¸Šå±‚è½¯ä»¶ã€‚è®¾å¤‡é©±åŠ¨ç¨‹åºä¸­åŒ…å«æ‰€æœ‰ä¸è®¾å¤‡ç›¸å…³çš„ä»£ç ã€‚æ¯ä¸ªè®¾å¤‡é©±åŠ¨ç¨‹åºåªå¤„ç†ä¸€ç§è®¾å¤‡ï¼Œæˆ–è€…ä¸€ç±»ç´§å¯†ç›¸å…³çš„è®¾å¤‡ã€‚å¼€å‘é©±åŠ¨ç¨‹åºéœ€è¦çŸ¥é“æŸç±»è®¾å¤‡æ§åˆ¶å™¨æœ‰å¤šå°‘ä¸ªå¯„å­˜å™¨åŠå®ƒä»¬çš„ç”¨é€”ã€‚é©±åŠ¨ç¨‹åºå·¥ä½œçš„ç®€åŒ–æµç¨‹å¦‚å›¾6-14æ‰€ç¤ºã€‚ ä¸‹é¢ä¸¾ä¾‹è¯´æ˜é©±åŠ¨ç¨‹åºçš„ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œå½“æœ‰ä¸€ä¸ªè¯»ç¬¬nå—ç£ç›˜çš„è¯·æ±‚æ—¶ï¼Œç£ç›˜é©±åŠ¨ç¨‹åºçš„å·¥ä½œå¦‚ä¸‹ã€‚ 1)è®¡ç®—å‡ºæ‰€è¯·æ±‚å—çš„ç‰©ç†åœ°å€ã€‚ 2)æ£€æŸ¥é©±åŠ¨å™¨ç”µæœºæ˜¯å¦æ­£åœ¨è¿è½¬ã€‚ 3)æ£€æŸ¥ç£å¤´è‡‚æ˜¯å¦å®šä½åœ¨æ­£ç¡®çš„æŸ±é¢ã€‚ 4)ç¡®å®šéœ€è¦å“ªäº›æ§åˆ¶å™¨å‘½ä»¤åŠå‘½ä»¤çš„æ‰§è¡Œé¡ºåºã€‚ 5)å‘è®¾å¤‡æ§åˆ¶å™¨çš„è®¾å¤‡å¯„å­˜å™¨ä¸­å†™å…¥å‘½ä»¤ã€‚ 6)I/Oå®Œæˆåï¼Œå‘ä¸Šå±‚è½¯ä»¶ä¼ é€æ•°æ®ã€‚ è®¾å¤‡é©±åŠ¨ç¨‹åºå±äºæ“ä½œç³»ç»Ÿçš„å†…æ ¸ç¨‹åºï¼Œä½†æ˜¯ä¸€èˆ¬ç”±è®¾å¤‡ç”Ÿäº§å‚å•†å¼€å‘ï¼Œé”€å”®ç¡¬ä»¶è®¾å¤‡æ—¶é™„é€ç»™ç”¨æˆ·ï¼Œå¹¶ä¸æ˜¯ç”±æ“ä½œç³»ç»Ÿå‚å•†æä¾›ã€‚è®¾å¤‡é©±åŠ¨ç¨‹åºè¦éµå¾ªæ“ä½œç³»ç»Ÿæä¾›çš„å†…æ ¸ä¸è®¾å¤‡é©±åŠ¨çš„æ¥å£æ ‡å‡†ã€‚ç”±äºä¸åŒçš„æ“ä½œç³»ç»Ÿæä¾›çš„å†…æ ¸ä¸é©±åŠ¨ç¨‹åºæ¥å£ä¸ä¸€æ ·ï¼Œè¦ä½¿é©±åŠ¨ç¨‹åºåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿç¯å¢ƒä¸­è¿è¡Œï¼Œå¯¹åŒä¸€ç§è®¾å¤‡éœ€è¦å¼€å‘é’ˆå¯¹ä¸åŒæ“ä½œç³»ç»Ÿçš„é©±åŠ¨ç¨‹åºã€‚äººä»¬ç»å¸¸è¯´æŸä¸ªé©±åŠ¨ç¨‹åºæ˜¯for Windowsæˆ–è€…for Linuxçš„ï¼Œå°±æ˜¯å‡ºäºè¿™ä¸ªåŸå› ã€‚ å››ã€ä¸ç¡¬ä»¶æ— å…³çš„è½¯ä»¶ è®¾å¤‡æ— å…³è½¯ä»¶å’Œè®¾å¤‡é©±åŠ¨ç¨‹åºä¹‹é—´çš„ç²¾ç¡®ç•Œé™åœ¨å„ä¸ªç³»ç»Ÿä¸­ä¸å°½ç›¸åŒã€‚å¯¹äºä¸€äº›ä»¥è®¾å¤‡æ— å…³æ–¹å¼å®Œæˆçš„åŠŸèƒ½ï¼Œåœ¨å®é™…ä¸­ç”±äºè€ƒè™‘åˆ°æ‰§è¡Œæ•ˆç‡ç­‰å› ç´ ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ç”±é©±åŠ¨ç¨‹åºå®Œæˆã€‚ è®¾å¤‡æ— å…³I/Oè½¯ä»¶çš„åŠŸèƒ½å¦‚ä¸‹ã€‚ 1)è®¾å¤‡å‘½åï¼šå°†è®¾å¤‡åæ˜ å°„åˆ°ç›¸åº”çš„é©±åŠ¨ç¨‹åºã€‚ 2)è®¾å¤‡ä¿æŠ¤ï¼šä¸ºè®¾å¤‡è®¾ç½®åˆç†çš„è®¿é—®æƒé™ã€‚ 3)æä¾›ç‹¬ç«‹äºè®¾å¤‡çš„å—å¤§å°ã€‚ä¾‹å¦‚ï¼Œä¸åŒç£ç›˜çš„æ‰‡åŒºå¤§å°å¯èƒ½ä¸åŒï¼Œè®¾å¤‡æ— å…³è½¯ä»¶å±è”½äº†è¿™ä¸€äº‹å®å¹¶å‘é«˜å±‚è½¯ä»¶æä¾›ç»Ÿä¸€çš„æ•°æ®å—å¤§å°ã€‚ä¾‹å¦‚ï¼Œæ‰‡åŒºå¤§å°ä¸º512B,è‹¥é€»è¾‘ç£ç›˜å—å¤§å°ä¸º1KBï¼Œåˆ™è½¯ä»¶å‘å‡ºè¯»ä¸¤ä¸ªè¿ç»­æ‰‡åŒºçš„å‘½ä»¤ï¼Œå°†è¿ç»­ä¸¤ä¸ªæ‰‡åŒºä½œä¸ºä¸€ä¸ªå¤§å°ä¸º1KBçš„é€»è¾‘å—æ¥å¤„ç†ã€‚ 4)ä¸ºå—è®¾å¤‡å’Œå­—ç¬¦è®¾å¤‡æä¾›å¿…è¦çš„ç¼“å†²æŠ€æœ¯ã€‚ 5)å—è®¾å¤‡çš„å­˜å‚¨åˆ†é…ã€‚å½“åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶å¹¶å‘å…¶è¾“å…¥æ•°æ®æ—¶ï¼Œè¯¥æ–‡ä»¶å¿…é¡»è¢«åˆ†é…æ–°çš„ç£ç›˜å—ã€‚ä¸ºäº†å®Œæˆåˆ†é…å·¥ä½œï¼Œæ“ä½œç³»ç»Ÿéœ€è¦ä¸ºæ¯ä¸ªç£ç›˜éƒ½é…ç½®ä¸€å¼ è®°å½•ç©ºé—²ç›˜å—çš„è¡¨æˆ–ä½å›¾ï¼Œä½†å®šä½ä¸€ä¸ªç©ºé—²å—çš„ç®—æ³•æ˜¯ç‹¬ç«‹äºè®¾å¤‡çš„ï¼Œå› æ­¤å¯ä»¥åœ¨é«˜äºé©±åŠ¨ç¨‹åºçš„å±‚æ¬¡å¤„ç†ã€‚ 6)åˆ†é…å’Œé‡Šæ”¾ç‹¬ç«‹è®¾å¤‡ã€‚ 7)é”™è¯¯å¤„ç†ã€‚ "},"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å…­ç« _I_Oè®¾å¤‡ç®¡ç†/ç¬¬å…­èŠ‚_ç£ç›˜ç®¡ç†.html":{"url":"pages/æ“ä½œç³»ç»Ÿæ¦‚è®º/ç¬¬å…­ç« _I_Oè®¾å¤‡ç®¡ç†/ç¬¬å…­èŠ‚_ç£ç›˜ç®¡ç†.html","title":"ç¬¬å…­èŠ‚ ç£ç›˜ç®¡ç†","keywords":"","body":"ç¬¬å…­èŠ‚ ç£ç›˜ç®¡ç† ç£ç›˜å­˜å‚¨å™¨ä¸ä»…å®¹é‡å¤§ï¼Œå­˜å–é€Ÿåº¦å¿«ï¼Œè€Œä¸”å¯ä»¥å®ç°éšæœºå­˜å–ï¼Œæ˜¯å­˜æ”¾å¤§é‡ç¨‹åºå’Œæ•°æ®çš„ç†æƒ³è®¾å¤‡ã€‚åœ¨ç°ä»£è®¡ç®—æœºç³»ç»Ÿä¸­éƒ½é…ç½®äº†ç£ç›˜å­˜å‚¨å™¨ï¼Œå¹¶ä»¥å®ƒä¸ºä¸»å­˜æ”¾æ–‡ä»¶ã€‚è®¡ç®—æœºç³»ç»Ÿä¸­å¯¹æ–‡ä»¶çš„æ“ä½œï¼ŒåŸºæœ¬ä¸Šéƒ½æ¶‰åŠå¯¹ç£ç›˜çš„è®¿é—®ã€‚ç£ç›˜I/Oé€Ÿåº¦çš„é«˜ä½å’Œç£ç›˜ç³»ç»Ÿçš„å¯é æ€§ï¼Œéƒ½å°†ç›´æ¥å½±å“ç³»ç»Ÿæ€§èƒ½ã€‚ç£ç›˜ç®¡ç†çš„é‡è¦ç›®æ ‡æ˜¯æé«˜ç£ç›˜ç©ºé—´åˆ©ç”¨ç‡å’Œç£ç›˜è®¿é—®é€Ÿåº¦ã€‚ ä¸€ã€ç£ç›˜ç»“æ„ ç£ç›˜è®¾å¤‡æ˜¯ä¸€ç§å¤æ‚çš„æœºç”µè®¾å¤‡ï¼Œæœ¬èŠ‚ä»…å¯¹ç£ç›˜çš„æ•°æ®ç»„ç»‡å’Œæ ¼å¼ã€ç£ç›˜çš„ç±»å‹å’Œè®¿é—®æ—¶é—´ç­‰æ–¹é¢è¿›è¡Œç®€è¦ä»‹ç»ã€‚ 1.æ•°æ®çš„ç»„ç»‡å’Œæ ¼å¼ ç£ç›˜è®¾å¤‡å¯åŒ…æ‹¬ä¸€ä¸ªæˆ–å¤šä¸ªç‰©ç†ç›˜ç‰‡ï¼Œæ¯ä¸ªç£ç›˜ç‰‡åˆ†ä¸€ä¸ªæˆ–ä¸¤ä¸ªå­˜å‚¨é¢(Surface)ï¼Œå¦‚å›¾6-l5aæ‰€ç¤ºã€‚æ¯ä¸ªç›˜é¢è¢«ç»„ç»‡æˆè‹¥å¹²ä¸ªåŒå¿ƒç¯ï¼Œè¿™ç§ç¯ç§°ä¸ºç£é“(Track)ï¼Œå„ç£é“ä¹‹é—´ç•™æœ‰å¿…è¦çš„é—´éš™ã€‚ä¸ºä½¿å¤„ç†ç®€å•ï¼Œåœ¨æ¯æ¡ç£é“ä¸Šå¯å­˜å‚¨ç›¸åŒæ•°ç›®çš„äºŒè¿›åˆ¶ä½ã€‚è¿™æ ·ï¼Œç£ç›˜å¯†åº¦å³æ˜¯æ¯è‹±å¯¸ä¸­æ‰€å­˜å‚¨çš„ä½æ•°ï¼Œæ˜¾ç„¶æ˜¯å†…å±‚ç£é“çš„å¯†åº¦è¾ƒå¤–å±‚ç£é“çš„å¯†åº¦é«˜ã€‚æ¯æ¡ç£é“åˆè¢«åˆ’åˆ†æˆè‹¥å¹²ä¸ªæ‰‡åŒº(Sector)ã€‚å›¾6-l5bæ‰€ç¤ºä¸ºä¸€ä¸ªç£é“åˆ†æˆ8ä¸ªæ‰‡åŒºï¼Œå„æ‰‡åŒºä¹‹é—´ä¿ç•™ä¸€å®šçš„é—´éš™ã€‚ ä¸€ä¸ªç‰©ç†è®°å½•å­˜å‚¨åœ¨ä¸€ä¸ªæ‰‡åŒºä¸Šï¼Œç£ç›˜ä¸Šå­˜å‚¨çš„ç‰©ç†è®°å½•æ•°ç›®æ˜¯ç”±æ‰‡åŒºæ•°ã€ç£é“æ•°åŠç£ç›˜é¢æ•°æ‰€å†³å®šçš„ã€‚ ä¸ºäº†æé«˜ç£ç›˜çš„å­˜å‚¨å®¹é‡ï¼Œå……åˆ†åˆ©ç”¨ç£ç›˜å¤–ç£é“çš„å­˜å‚¨èƒ½åŠ›ï¼Œç°ä»£ç£ç›˜ä¸å†æŠŠå†…å¤–ç£é“åˆ’åˆ†ä¸ºç›¸åŒæ•°ç›®çš„æ‰‡åŒºï¼Œè€Œæ˜¯åˆ©ç”¨å¤–å±‚ç£é“å®¹é‡è¾ƒå†…å±‚ç£é“å¤§çš„ç‰¹ç‚¹ï¼Œå°†ç›˜é¢åˆ’åˆ†æˆè‹¥å¹²æ¡ç¯å¸¦ï¼Œä½¿å¾—åŒä¸€ç¯å¸¦å†…çš„æ‰€æœ‰ç£é“å…·æœ‰ç›¸åŒçš„æ‰‡åŒºæ•°ã€‚æ˜¾ç„¶ï¼Œå¤–å±‚ç¯å¸¦çš„ç£é“æ‹¥æœ‰è¾ƒå†…å±‚ç¯å¸¦çš„ç£é“æ›´å¤šçš„æ‰‡åŒºã€‚ä¸ºäº†å‡å°‘è¿™ç§ç£é“å’Œæ‰‡åŒºåœ¨ç›˜é¢åˆ†å¸ƒçš„å‡ ä½•å½¢å¼å˜åŒ–å¯¹é©±åŠ¨ç¨‹åºçš„å½±å“ï¼Œå¤§å¤šæ•°ç°ä»£ç£ç›˜éƒ½éšè—äº†è¿™äº›ç»†èŠ‚ã€‚ ä¸ºäº†åœ¨ç£ç›˜ä¸­å­˜å‚¨æ•°æ®ï¼Œå¿…é¡»å…ˆå°†ç£ç›˜ä½çº§æ ¼å¼åŒ–ã€‚å›¾6-16æ˜¾ç¤ºå‡ºäº†ä¸€ç§æ¸©ç›˜ï¼ˆæ¸©åˆ‡æ–¯ç‰¹ç›˜)ä¸­ä¸€æ¡ç£é“æ ¼å¼åŒ–çš„æƒ…å†µã€‚å…¶ä¸­æ¯æ¡ç£é“å«æœ‰30ä¸ªå›ºå®šå¤§å°çš„æ‰‡åŒºï¼Œæ¯ä¸ªæ‰‡åŒºå®¹é‡ä¸º600ä¸ªå­—èŠ‚ã€‚å…¶ä¸­512ä¸ªå­—èŠ‚å­˜æ”¾æ•°æ®ï¼Œå…¶ä½™çš„ç”¨äºå­˜æ”¾æ§åˆ¶ä¿¡æ¯ã€‚æ¯ä¸ªæ‰‡åŒºåŒ…æ‹¬ä¸¤ä¸ªå­—æ®µã€‚ 1)æ ‡è¯†ç¬¦å­—æ®µï¼Œå…¶ä¸­ä¸€ä¸ªå­—èŠ‚çš„SYNCHå…·æœ‰ç‰¹å®šçš„ä½å›¾åƒï¼Œä½œä¸ºè¯¥å­—æ®µçš„å®šç•Œç¬¦ã€‚åˆ©ç”¨ç£é“å·ã€ç£å¤´å·åŠæ‰‡åŒºå·ä¸‰è€…æ¥æ ‡è¯†ä¸€ä¸ªæ‰‡åŒºã€‚CRCå­—æ®µç”¨äºæ®µæ ¡éªŒã€‚ 2)æ•°æ®å­—æ®µï¼Œå…¶ä¸­å¯å­˜æ”¾512ä¸ªå­—èŠ‚çš„æ•°æ®ã€‚ ç£ç›˜æ ¼å¼åŒ–å®Œæˆåï¼Œä¸€èˆ¬è¦å¯¹ç£ç›˜åˆ†åŒºã€‚åœ¨é€»è¾‘ä¸Šï¼Œæ¯ä¸ªåˆ†åŒºå°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é€»è¾‘ç£ç›˜ã€‚æ¯ä¸ªåˆ†åŒºçš„èµ·å§‹æ‰‡åŒºå’Œå¤§å°éƒ½è¢«è®°å½•åœ¨ç£ç›˜0æ‰‡åŒºçš„ä¸»å¼•å¯¼è®°å½•åˆ†åŒºè¡¨æ‰€åŒ…å«çš„åˆ†åŒºè¡¨ä¸­ã€‚åœ¨è¿™ä¸ªåˆ†åŒºè¡¨ä¸­å¿…é¡»æœ‰ä¸€ä¸ªåˆ†åŒºè¢«æ ‡è®°æˆæ´»åŠ¨çš„ï¼Œä»¥ä¿è¯èƒ½å¤Ÿä»ç¡¬ç›˜å¼•å¯¼ç³»ç»Ÿã€‚ ä½†æ˜¯ï¼Œåœ¨çœŸæ­£å¯ä»¥ä½¿ç”¨ç£ç›˜å‰ï¼Œè¿˜éœ€è¦å¯¹ç£ç›˜è¿›è¡Œä¸€æ¬¡é«˜çº§æ ¼å¼åŒ–ï¼Œå³è®¾ç½®ä¸€ä¸ªå¼•å¯¼å—ã€æ ¹ç›®å½•å’Œä¸€ä¸ªç©ºæ–‡ä»¶ç³»ç»Ÿï¼ŒåŒæ—¶åœ¨åˆ†åŒºè¡¨ä¸­æ ‡è®°è¯¥åˆ†åŒºæ‰€ä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿã€‚ 2.ç£ç›˜çš„ç±»å‹ å¯¹ç£ç›˜å¯ä»¥ä»ä¸åŒçš„è§’åº¦è¿›è¡Œåˆ†ç±»ã€‚æœ€å¸¸è§çš„æœ‰ï¼šå°†ç£ç›˜åˆ†æˆç¡¬ç›˜å’Œè½¯ç›˜ã€å•ç‰‡ç›˜å’Œå¤šç‰‡ç›˜ã€å›ºå®šå¤´ç£ç›˜å’Œæ´»åŠ¨å¤´ï¼ˆç§»åŠ¨å¤´ï¼‰ç£ç›˜ç­‰ã€‚ä¸‹é¢ä»…å¯¹å›ºå®šå¤´ç£ç›˜å’Œç§»åŠ¨å¤´ç£ç›˜è¿›è¡Œä»‹ç»ã€‚ (1)å›ºå®šå¤´ç£ç›˜ è¿™ç§ç£ç›˜åœ¨æ¯æ¡ç£é“ä¸Šéƒ½æœ‰è¯»/å†™ç£å¤´ï¼Œæ‰€æœ‰çš„ç£å¤´éƒ½è¢«è£…åœ¨ä¸€ä¸ªåˆšæ€§ç£è‡‚ç”²ã€‚é€šè¿‡è¿™äº›ç£å¤´å¯è®¿é—®å„ç£é“ä¸”è¿›è¡Œå¹¶è¡Œè¯»/å†™ï¼Œæœ‰æ•ˆåœ°æé«˜äº†ç£ç›˜çš„I/Oé€Ÿåº¦ã€‚è¿™ç§ç»“æ„çš„ç£ç›˜ä¸»è¦ç”¨äºå¤§å®¹é‡ç£ç›˜ä¸Šã€‚ (2)ç§»åŠ¨å¤´ç£ç›˜ è¿™ç§ç£ç›˜æ¯ä¸€ä¸ªç›˜é¢ä»…é…æœ‰ä¸€ä¸ªç£å¤´ï¼Œä¹Ÿè¢«è£…äººç£è‡‚ä¸­ã€‚ä¸ºäº†èƒ½è®¿é—®è¯¥ç›˜é¢çš„æ‰€æœ‰ç£é“ï¼Œè¯¥ç£å¤´å¿…é¡»èƒ½ç§»åŠ¨å¹¶è¿›è¡Œå¯»é“ã€‚å¯è§ï¼Œç§»åŠ¨ç£å¤´ä»…èƒ½ä»¥ä¸²è¡Œæ–¹å¼è¯»/å†™ï¼Œè‡´ä½¿ç£ç›˜è¯»å†™é€Ÿåº¦è¾ƒæ…¢ã€‚ä½†ç”±äºå…¶ç»“æ„ç®€å•ï¼Œæ•…ä»å¹¿æ³›åº”ç”¨äºä¸­å°å‹ç£ç›˜è®¾å¤‡ä¸­ã€‚åœ¨å¾®å‹æœºä¸Šé…ç½®çš„ç¡¬ç›˜é‡‡ç”¨ç§»åŠ¨ç£å¤´ç»“æ„ï¼Œæ•…æœ¬èŠ‚ä¸»è¦é’ˆå¯¹è¿™ç±»ç£ç›˜çš„I/Oè¿›è¡Œè®¨è®ºã€‚ 3.ç£ç›˜çš„è®¿é—®æ—¶é—´ ç£ç›˜è®¾å¤‡åœ¨å·¥ä½œæ—¶ä»¥æ’å®šé€Ÿç‡æ—‹è½¬ã€‚ä¸ºäº†è¯»æˆ–å†™ï¼Œç£å¤´å¿…é¡»èƒ½ç§»åŠ¨åˆ°æ‰€è¦æ±‚çš„ç£é“ä¸Šï¼Œå¹¶ç­‰å¾…æ‰€è¦æ±‚çš„æ‰‡åŒºçš„å¼€å§‹ä½ç½®æ—‹è½¬åˆ°ç£å¤´ä¸‹ï¼Œç„¶åå†å¼€å§‹è¯»æˆ–å†™æ•°æ®ã€‚æ•…å¯æŠŠå¯¹ç£ç›˜çš„è®¿é—®æ—¶é—´åˆ†æˆä»¥ä¸‹3éƒ¨åˆ†ã€‚ (1)å¯»é“æ—¶é—´ è¿™æ˜¯æŒ‡æŠŠç£è‡‚ï¼ˆç£å¤´ï¼‰ç§»åŠ¨åˆ°æŒ‡å®šç£é“ä¸Šæ‰€ç»å†çš„æ—¶é—´ã€‚è¯¥æ—¶é—´æ˜¯å¯åŠ¨ç£è‡‚çš„æ—¶é—´ä¸ç£å¤´ç§»åŠ¨næ¡ç£é“æ‰€èŠ±è´¹çš„æ—¶é—´ä¹‹å’Œã€‚ (2)æ—‹è½¬å»¶è¿Ÿæ—¶é—´ è¿™æ˜¯æŒ‡å°†æŒ‡å®šæ‰‡åŒºç§»åŠ¨åˆ°ç£å¤´ä¸‹é¢æ‰€ç»å†çš„æ—¶é—´ã€‚ä¸åŒçš„ç£ç›˜ç±»å‹ï¼Œæ—‹è½¬é€Ÿåº¦å·®åˆ«å¾ˆå¤§ã€‚ (3)ä¼ è¾“æ—¶é—´ è¿™æ˜¯æŒ‡æŠŠæ•°æ®ä»ç£ç›˜è¯»å‡ºæˆ–å‘ç£ç›˜å†™å…¥æ•°æ®æ—¶æ‰€ç»å†çš„æ—¶é—´ã€‚å…¶å¤§å°ä¸æ¯æ¬¡æ‰€è¯»/å†™çš„å­—èŠ‚æ•°å’Œæ—‹è½¬é€Ÿåº¦æœ‰å…³ã€‚ åœ¨ç£ç›˜è®¿é—®æ—¶é—´ä¸­ï¼Œå¯»é“æ—¶é—´å’Œæ—‹è½¬å»¶è¿Ÿæ—¶é—´åŸºæœ¬ä¸Šéƒ½ä¸æ‰€è¯»/å†™æ•°æ®çš„å¤šå°‘æ— å…³ï¼Œè€Œä¸”å¯»é“æ—¶é—´å’Œæ—‹è½¬å»¶è¿Ÿæ—¶é—´é€šå¸¸å æ®äº†è®¿é—®æ—¶é—´ä¸­çš„å¤§å¤´ã€‚é€‚å½“åœ°é›†ä¸­æ•°æ®åœ¨ç£ç›˜ä¸Šå­˜æ”¾çš„ä½ç½®ï¼Œå¯ä»¥å‡å°‘ç£è‡‚ç§»åŠ¨è·ç¦»ï¼Œè¿™å°†æœ‰åˆ©äºæé«˜ä¼ è¾“é€Ÿç‡ã€‚ äºŒã€ç£ç›˜è°ƒåº¦ ç£ç›˜æ˜¯å¯ä¾›å¤šä¸ªè¿›ç¨‹å…±äº«çš„è®¾å¤‡ï¼Œå½“æœ‰å¤šä¸ªè¿›ç¨‹éƒ½è¦æ±‚è®¿é—®ç£ç›˜æ—¶ï¼Œåº”é‡‡ç”¨ä¸€ç§æœ€ä½³è°ƒåº¦ç®—æ³•ï¼Œä»¥ä½¿å„ä¸ªè¿›ç¨‹å¯¹ç£ç›˜çš„å¹³å‡è®¿é—®æ—¶é—´æœ€çŸ­ã€‚ç”±äºåœ¨è®¿é—®ç£ç›˜çš„æ—¶é—´ä¸­ï¼Œä¸»è¦æ˜¯å¯»é“æ—¶é—´ï¼Œå› æ­¤ç£ç›˜è°ƒåº¦çš„ä¸€ä¸ªé‡è¦ç›®æ ‡æ˜¯ä½¿ç£ç›˜çš„å¹³å‡å¯»é“æ—¶é—´æœ€å°‘ã€‚ç›®å‰å¸¸ç”¨çš„ç£ç›˜è°ƒåº¦ç®—æ³•æœ‰å…ˆæ¥å…ˆæœåŠ¡ã€æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆåŠæ‰«æç­‰ç®—æ³•ï¼Œä¸‹é¢é€ä¸€è¿›è¡Œä»‹ç»ã€‚ 1.å…ˆæ¥å…ˆæœåŠ¡(First Come First Served,FCFS) è¿™æ˜¯ä¸€ç§æœ€ç®€å•çš„ç£ç›˜è°ƒåº¦ç®—æ³•ã€‚å®ƒæ ¹æ®è¿›ç¨‹è¯·æ±‚è®¿é—®ç£ç›˜çš„å…ˆåé¡ºåºè¿›è¡Œè°ƒåº¦ã€‚æ­¤ç®—æ³•çš„ä¼˜ç‚¹æ˜¯å…¬å¹³ã€ç®€å•ï¼Œä¸”æ¯ä¸ªè¿›ç¨‹çš„è¯·æ±‚éƒ½èƒ½ä¾æ¬¡å¾—åˆ°å¤„ç†ï¼Œä¸ä¼šå‡ºç°æŸä¸€è¿›ç¨‹çš„è¯·æ±‚é•¿æœŸå¾—ä¸åˆ°æ»¡è¶³çš„æƒ…å†µã€‚ä½†æ­¤ç®—æ³•ç”±äºæœªå¯¹å¯»é“è¿›è¡Œä¼˜åŒ–ï¼Œè‡´ä½¿å¹³å‡å¯»é“æ—¶é—´å¯èƒ½è¾ƒé•¿ã€‚è¡¨6-1ç»™å‡ºäº†æœ‰9ä¸ªè¿›ç¨‹å…ˆåæå‡ºç£ç›˜I/Oè¯·æ±‚æ—¶ï¼ŒæŒ‰FCSç®—æ³•è¿›è¡Œè°ƒåº¦çš„æƒ…å†µã€‚è¿™é‡Œå°†è¿›ç¨‹å·ï¼ˆè¯·æ±‚è€…ï¼‰æŒ‰ä»–ä»¬å‘å‡ºçš„è¯·æ±‚çš„å…ˆåé¡ºåºæ’é˜Ÿã€‚è¿™æ ·ï¼Œå¹³å‡å¯»é“è·ç¦»ä¸º55.3æ¡ç£é“ï¼Œä¸åé¢å³å°†è®²åˆ°çš„å‡ ç§è°ƒåº¦ç®—æ³•ç›¸æ¯”ï¼Œå…¶å¹³å‡å¯»é“è·ç¦»è¾ƒå¤§ï¼Œæ•…FCFSç®—æ³•ä»…é€‚ç”¨äºè¯·æ±‚ç£ç›˜I/Oçš„è¿›ç¨‹æ•°ç›®è¾ƒå°‘çš„åœºåˆã€‚ 2.æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆ(Shortest Seek Time First,SSTF) è¯¥ç®—æ³•é€‰æ‹©è¿™æ ·çš„è¿›ç¨‹ï¼šå…¶è¦æ±‚è®¿é—®çš„ç£é“ä¸å½“å‰ç£å¤´æ‰€åœ¨çš„ç£é“è·ç¦»æœ€è¿‘ï¼Œä»¥ä½¿æ¯æ¬¡çš„å¯»é“æ—¶é—´æœ€çŸ­ã€‚ä½†è¿™ç§ç®—æ³•ä¸èƒ½ä¿è¯å¹³å‡å¯»é“æ—¶é—´æœ€çŸ­ã€‚è¡¨6-2ç»™å‡ºäº†SSTFç®—æ³•è¿›è¡Œè°ƒåº¦æ—¶ï¼Œå„è¿›ç¨‹è¢«è°ƒåº¦çš„é¡ºåºã€æ¯æ¬¡ç£å¤´ç§»åŠ¨çš„è·ç¦»ï¼Œä»¥åŠ9æ¬¡è°ƒåº¦ç£å¤´å¹³å‡ç§»åŠ¨çš„è·ç¦»ã€‚æ¯”è¾ƒè¡¨6-1å’Œè¡¨6-2å¯ä»¥çœ‹å‡ºï¼ŒSSTFç®—æ³•çš„æ¯æ¬¡ç£å¤´ç§»åŠ¨å¹³å‡è·ç¦»æ˜æ˜¾ä½äºFCFSçš„è·ç¦»ï¼Œå› è€ŒSSTFè¾ƒä¹‹FCFSæœ‰æ›´å¥½çš„å¯»é“æ€§èƒ½ï¼Œæ•…æ›¾ä¸€åº¦è¢«å¹¿æ³›é‡‡ç”¨ã€‚ 3.æ‰«æ(SCAN)ç®—æ³• (1)è¿›ç¨‹â€œé¥¥é¥¿â€ç°è±¡ SSTFç®—æ³•è™½ç„¶èƒ½è·å¾—è¾ƒå¥½çš„å¯»é“æ€§èƒ½ï¼Œä½†å´å¯èƒ½å¯¼è‡´æŸä¸ªè¿›ç¨‹å‘ç”Ÿâ€œé¥¥é¥¿â€(Starvation)ç°è±¡ã€‚å› ä¸ºåªè¦ä¸æ–­æœ‰æ–°è¿›ç¨‹çš„è¯·æ±‚åˆ°è¾¾ï¼Œä¸”å…¶æ‰€è¦è®¿é—®çš„ç£é“ä¸ç£å¤´å½“å‰æ‰€åœ¨ç£é“çš„è·ç¦»è¾ƒè¿‘ï¼Œè¿™ç§æ–°è¿›ç¨‹çš„I/Oè¯·æ±‚å¿…ç„¶ä¼˜å…ˆè¢«æ»¡è¶³ï¼Œå¯¼è‡´æ‰€è¦è®¿é—®çš„ç£é“è·ç¦»ä¸ç£å¤´æ‰€åœ¨ä½ç½®è¾ƒè¿œçš„ç£ç›˜ä»»åŠ¡æ€»æ˜¯ä¸èƒ½å¾—åˆ°è°ƒåº¦ã€‚å¯¹SSTFç®—æ³•ç•¥åŠ ä¿®æ”¹åæ‰€å½¢æˆçš„SCANç®—æ³•å¯é˜²æ­¢è¿›ç¨‹å‡ºç°â€œé¥¥é¥¿â€ç°è±¡ã€‚ (2)SCANç®—æ³• è¯¥ç®—æ³•ä¸ä»…è€ƒè™‘åˆ°è¦è®¿é—®çš„ç£é“ä¸å½“å‰ç£é“çš„è·ç¦»ï¼Œæ›´ä¼˜å…ˆè€ƒè™‘ç£å¤´å½“å‰çš„ç§»åŠ¨æ–¹å‘ã€‚ä¾‹å¦‚ï¼Œå½“ç£å¤´æ­£åœ¨è‡ªé‡Œå‘å¤–ç§»åŠ¨æ—¶ï¼ŒSCANç®—æ³•æ‰€è€ƒè™‘çš„ä¸‹ä¸€ä¸ªè®¿é—®å¯¹è±¡åº”æ˜¯å…¶è¦è®¿é—®çš„ç£é“æ—¢åœ¨å½“å‰ç£é“ä¹‹å¤–ï¼Œåˆæ˜¯è·ç¦»æœ€è¿‘çš„ã€‚è¿™æ ·è‡ªé‡Œå‘å¤–åœ°è®¿é—®ï¼Œç›´è‡³å†æ— æ›´å¤–çš„ç£é“éœ€è¦è®¿é—®æ—¶ï¼Œæ‰å°†ç£è‡‚æ¢ä¸ºè‡ªå¤–å‘é‡Œç§»åŠ¨ã€‚è¿™æ—¶ï¼ŒåŒæ ·ä¹Ÿæ˜¯æ¯æ¬¡é€‰æ‹©è¿™æ ·çš„è¿›ç¨‹æ¥è°ƒåº¦ï¼Œå³è¦è®¿é—®çš„ç£é“åœ¨å½“å‰ä½ç½®å†…è·ç¦»æœ€è¿‘è€…ã€‚è¿™æ ·ï¼Œç£å¤´é€æ­¥åœ°è‡ªå¤–å‘é‡Œç§»åŠ¨ï¼Œç›´è‡³å†æ— æ›´é‡Œé¢çš„ç£é“ è¦è®¿é—®ï¼Œä»è€Œé¿å…å‡ºç°â€œé¥¥é¥¿â€ç°è±¡ã€‚ç”±äºåœ¨è¿™ç§ç®—æ³•ä¸­ç£å¤´ç§»åŠ¨çš„è§„å¾‹é¢‡ä¼¼ç”µæ¢¯çš„è¿è¡Œï¼Œå› è€Œåˆå¸¸ç§°ä¹‹ä¸ºç”µæ¢¯è°ƒåº¦ç®—æ³•ã€‚è¡¨6-3ç»™å‡ºäº†æŒ‰SCANç®—æ³•å¯¹9ä¸ªè¿›ç¨‹è¿›è¡Œè°ƒåº¦åŠç£å¤´ç§»åŠ¨çš„æƒ…å†µã€‚ 4.å¾ªç¯æ‰«æ(CSCAN)ç®—æ³• SCANç®—æ³•æ—¢èƒ½è·å¾—è¾ƒå¥½çš„å¯»é“æ€§èƒ½ï¼Œåˆé˜²æ­¢äº†â€œé¥¥é¥¿â€ç°è±¡ï¼Œæ•…è¢«å¹¿æ³›ç”¨äºå¤§ã€ä¸­ã€å°å‹æœºå™¨å’Œç½‘ç»œä¸­çš„ç£ç›˜è°ƒåº¦ã€‚ä½†SCANä¹Ÿå­˜åœ¨è¿™æ ·çš„é—®é¢˜ï¼šå½“ç£å¤´åˆšä»é‡Œå‘å¤–ç§»åŠ¨è€Œè¶Šè¿‡äº†æŸä¸€ç£é“æ—¶ï¼Œæ°å¥½åˆæœ‰ä¸€è¿›ç¨‹è¯·æ±‚è®¿é—®æ­¤ç£é“ã€‚è¿™æ—¶ï¼Œè¯¥è¿›ç¨‹å¿…é¡»ç­‰å¾…ï¼Œå¾…ç£å¤´ç»§ç»­è‡ªé‡Œå‘å¤–ï¼Œç„¶åå†è‡ªå¤–å‘é‡Œæ‰«æå®Œæ‰€æœ‰è¦è®¿é—®çš„ç£é“åï¼Œæ‰å¤„ç†è¯¥è¿›ç¨‹çš„è¯·æ±‚ï¼Œè‡´ä½¿è¯¥è¿›ç¨‹çš„è¯·æ±‚è¢«å¤§å¤§æ¨è¿Ÿã€‚ä¸ºäº†å‡å°‘è¿™ç§å»¶è¿Ÿï¼ŒCSCANç®—æ³•è§„å®šç£å¤´æ˜¯å•å‘ç§»åŠ¨ã€‚ä¾‹å¦‚ï¼Œåªæ˜¯è‡ªé‡Œå‘å¤–ç§»åŠ¨ï¼Œå½“ç£å¤´ç§»åˆ°æœ€å¤–çš„ç£é“åï¼Œç£å¤´ç«‹å³è¿”å›åˆ°æœ€é‡Œçš„è¦è®¿é—®çš„ç£é“ï¼Œäº¦å³å°†æœ€å°ç£é“å·ç´§æ¥ç€æœ€å¤§ç£é“å·æ„æˆå¾ªç¯ï¼Œè¿›è¡Œå¾ªç¯æ‰«æã€‚è¡¨6-4ç»™å‡ºäº†CSCANç®—æ³•å¯¹9ä¸ªè¿›ç¨‹è°ƒåº¦çš„é¡ºåºåŠæ¯æ¬¡ç£å¤´ç§»åŠ¨çš„è·ç¦»ã€‚ 5.NStepSCANå’ŒFSCANè°ƒåº¦ç®—æ³• (1)NStepSCANç®—æ³• åœ¨SSTFã€SCANåŠCSCANå‡ ç§è°ƒåº¦ç®—æ³•ä¸­ï¼Œéƒ½å¯èƒ½ä¼šå‡ºç°ç£è‡‚åœç•™åœ¨æŸå¤„ä¸åŠ¨çš„æƒ…å†µï¼Œä¾‹å¦‚ï¼Œæœ‰ä¸€ä¸ªæˆ–å‡ ä¸ªè¿›ç¨‹å¯¹æŸä¸€ç£é“æœ‰è¾ƒé«˜çš„è®¿é—®é¢‘ç‡ï¼Œå³è¿™ä¸ªï¼ˆäº›ï¼‰è¿›ç¨‹åå¤è¯·æ±‚å¯¹æŸç£é“çš„I/Oæ“ä½œï¼Œä»è€Œå„æ–­äº†æ•´ä¸ªç£ç›˜è®¾å¤‡ã€‚æŠŠè¿™ä¸€ç°è±¡ç§°ä¸ºâ€œç£è‡‚ç²˜ç€â€(Armstickiness)ï¼Œåœ¨é«˜å¯†åº¦ç£ç›˜ä¸Šå®¹æ˜“å‡ºç°æ­¤æƒ…å†µã€‚NStepSCANç®—æ³•æ˜¯å°†ç£ç›˜è¯·æ±‚é˜Ÿåˆ—åˆ†æˆè‹¥å¹²ä¸ªé•¿åº¦ä¸ºNçš„å­é˜Ÿåˆ—ï¼Œç£ç›˜è°ƒåº¦å°†æŒ‰FCFSç®—æ³•ä¾æ¬¡å¤„ç†è¿™äº›å­é˜Ÿåˆ—ã€‚æ¯å¤„ç†ä¸€ä¸ªé˜Ÿåˆ—æ—¶åˆæ˜¯æŒ‰SCANç®—æ³•ï¼Œå¯¹ä¸€ä¸ªé˜Ÿåˆ—å¤„ç†å®Œåï¼Œå†å¤„ç†å…¶ä»–é˜Ÿåˆ—ã€‚å½“æ­£åœ¨å¤„ç†æŸå­é˜Ÿåˆ—æ—¶ï¼Œå¦‚æœåˆå‡ºç°æ–°çš„ç£ç›˜I/Oè¯·æ±‚ï¼Œä¾¿å°†æ–°è¯·æ±‚è¿›ç¨‹æ”¾å…¥å…¶ä»–é˜Ÿåˆ—ï¼Œè¿™æ ·å°±å¯é¿å…å‡ºç°ç£è‡‚ç²˜ç€ç°è±¡ã€‚å½“Nå€¼å–å¾—å¾ˆå¤§æ—¶ï¼Œä¼šä½¿NStepSCANç®—æ³•çš„æ€§èƒ½æ¥è¿‘äºSCANç®—æ³•çš„æ€§èƒ½ã€‚å½“N=1æ—¶ï¼ŒNStepSCANç®—æ³•ä¾¿èœ•åŒ–ä¸ºFCFSç®—æ³•ã€‚ (2)FSCANç®—æ³• FSCANç®—æ³•å®è´¨ä¸Šæ˜¯NStepSCANç®—æ³•çš„ç®€åŒ–ï¼Œå³FSCANåªå°†ç£ç›˜è¯·æ±‚é˜Ÿåˆ—åˆ†æˆä¸¤ä¸ªå­é˜Ÿåˆ—ã€‚ä¸€ä¸ªæ˜¯ç”±å½“å‰æ‰€æœ‰è¯·æ±‚ç£ç›˜I/Oçš„è¿›ç¨‹å½¢æˆçš„é˜Ÿåˆ—ï¼Œç”±ç£ç›˜è°ƒåº¦æŒ‰SCANç®—æ³•è¿›è¡Œå¤„ç†ã€‚åœ¨æ‰«ææœŸé—´ï¼Œå°†æ–°å‡ºç°çš„æ‰€æœ‰è¯·æ±‚ç£ç›˜I/Oçš„è¿›ç¨‹ï¼Œæ”¾å…¥å¦ä¸€ä¸ªç­‰å¾…å¤„ç†çš„è¯·æ±‚é˜Ÿåˆ—ã€‚è¿™æ ·ï¼Œæ‰€æœ‰çš„æ–°è¯·æ±‚éƒ½å°†è¢«æ¨è¿Ÿåˆ°ä¸‹ä¸€æ¬¡æ‰«ææ—¶å¤„ç†ã€‚ ä¸‰ã€æé«˜ç£ç›˜I/Oé€Ÿåº¦çš„æ–¹æ³• ç£ç›˜çš„I/Oé€Ÿåº¦è¿œä½äºå†…å­˜çš„è®¿é—®é€Ÿåº¦ï¼Œé€šå¸¸è¦ä½ä¸Š4~6ä¸ªæ•°é‡çº§ã€‚å› æ­¤ï¼Œç£ç›˜çš„I/Oå·²æˆä¸ºè®¡ç®—æœºç³»ç»Ÿçš„ç“¶é¢ˆã€‚æœ¬èŠ‚ä»‹ç»å„¿ç§å·²ç»å¹¿æ³›é‡‡ç”¨çš„æé«˜ç£ç›˜I/Oé€Ÿåº¦çš„æ–¹æ³•ã€‚ 1.æå‰è¯» ç®€å•æ¥è¯´ï¼Œæå‰è¯»å°±æ˜¯ç³»ç»Ÿæ ¹æ®ç°åœ¨ç”¨æˆ·è¯·æ±‚è¯»çš„å†…å®¹ï¼ŒæŠŠé¢„è®¡æœ€è¿‘ä¸ä¹…å¯èƒ½è¦è¯»çš„å†…å®¹ä¸ç°åœ¨è¯·æ±‚è¯»çš„å†…å®¹ä¸€èµ·æå‰è¯»äººå†…å­˜ã€‚ç”¨æˆ·è¯»æ–‡ä»¶æ—¶ï¼Œç»å¸¸æ˜¯é¡ºåºè¯»æ–‡ä»¶å†…å®¹ï¼Œæ–‡ä»¶çš„å­˜æ”¾æ˜¯æŒ‰å†…å®¹é¡ºåºæ”¾äººç£ç›˜å—çš„ã€‚æ“ä½œç³»ç»ŸçŸ¥é“æ–‡ä»¶å†…å®¹æ˜¯æŒ‰ç…§æ€æ ·çš„é¡ºåºå­˜æ”¾åœ¨ç£ç›˜å—ä¸­çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨æŒ‰ç…§ç”¨æˆ·è¯·æ±‚è¯»å½“å‰ç£ç›˜å—æ—¶ï¼Œæå‰æŠŠä¸‹ä¸€ä¸ªç£ç›˜å—çš„å†…å®¹ä¹Ÿè¯»å…¥ç¼“å†²åŒºã€‚æ¯”å¦‚æ–‡ä»¶f1ï¼Œå†…å®¹ä¾æ¬¡å­˜æ”¾åœ¨10ã€20ã€60å·ç£ç›˜å—ä¸­ï¼Œå¦‚æœå½“å‰ç”¨æˆ·è¯·æ±‚è¯»çš„å†…å®¹åœ¨10å·ç£ç›˜å—ä¸­ï¼Œç³»ç»Ÿåœ¨è¯»å…¥10å·ç£ç›˜å—çš„å†…å®¹æ—¶ï¼ŒæŠŠ20å·ç£ç›˜å—çš„å†…å®¹ä¹Ÿæå‰è¯»å…¥ç¼“å†²ã€‚è¿™æ ·ï¼Œå½“ä¸‹æ¬¡è¦è®¿é—®å·²ç»æå‰è¯»å…¥ç¼“å†²çš„ç£ç›˜å—æ—¶ï¼Œå°±ä¸éœ€è¦ä»ç£ç›˜ä¸­è¯»ï¼Œè€Œæ˜¯å¯ä»¥ç›´æ¥ä»å†…å­˜çš„ç¼“å†²åŒºä¸­è¯»ã€‚å› æ­¤ï¼Œå¤§å¤§å‡å°‘äº†è¯»æ•°æ®çš„æ—¶é—´ï¼Œæé«˜äº†ç”¨æˆ·è¯»ç£ç›˜æ•°æ®çš„é€Ÿåº¦ 2.å»¶è¿Ÿå†™ å»¶è¿Ÿå†™æ˜¯åœ¨æ”¯æŒè¯·æ±‚åˆ†é¡µçš„è™šæ‹Ÿå­˜å‚¨ç®¡ç†ä¸­ï¼Œå¯¹ä¿®æ”¹è¿‡çš„æ¢å‡ºé¡µï¼Œåœ¨æŠŠé¡µæ ‡è®°ä¸ºæ¢å‡ºé¡µæ—¶å¹¶ä¸é©¬ä¸ŠæŠŠé¡µçš„å†…å®¹å†™å…¥ç£ç›˜ï¼Œè€Œæ˜¯æš‚æ—¶ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°è¿™äº›é¡µæ‰€åœ¨çš„é¡µæ¡†è¦è¢«ä½¿ç”¨ï¼Œå¯¼è‡´é¡µçš„å†…å®¹å°†è¢«è¦†ç›–å‰çš„â€œæœ€åâ€æ—¶åˆ»æ‰å¯åŠ¨ç£ç›˜æ“ä½œï¼ŒæŠŠä¿®æ”¹è¿‡çš„ä¸€ä¸ªæˆ–è‹¥å¹²é¡µå†™å…¥ç£ç›˜ï¼Œè¿™ç§å»¶è¿Ÿå†™çš„ç­–ç•¥å‡å°‘äº†å†™ç£ç›˜çš„æ¬¡æ•°ã€‚ 3.ä¼˜åŒ–ç‰©ç†å—çš„åˆ†å¸ƒ å¯»é“æ—¶é—´å’Œç£ç›˜æ—‹è½¬å»¶è¿Ÿæ—¶é—´é€šå¸¸å æ®äº†ç£ç›˜I/Oæ‰€è€—æ—¶é—´ä¸­çš„ä¸»è¦éƒ¨åˆ†ï¼Œæ‰€ä»¥é€‚å½“åœ°é›†ä¸­æ•°æ®åœ¨ç£ç›˜ä¸Šå­˜æ”¾çš„ä½ç½®ï¼Œå¯ä»¥å‡å°‘ç£è‡‚ç§»åŠ¨è·ç¦»ï¼Œæœ‰åˆ©äºæé«˜ä¼ è¾“é€Ÿç‡ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸€ç›®çš„ï¼Œå¯ä»¥é‡‡å–ä¼˜åŒ–æ–‡ä»¶ç‰©ç†å—åˆ†å¸ƒçš„æ–¹æ³•ã€‚ç°åœ¨çš„æ–‡ä»¶ç³»ç»Ÿéƒ½å…è®¸æ–‡ä»¶ç¦»æ•£å­˜æ”¾ã€‚ç†è®ºä¸Šï¼Œä¸€ä¸ªæ–‡ä»¶çš„ç‰©ç†å—å¯ä»¥åˆ†æ•£åœ¨ç£ç›˜çš„ä»»æ„ä½ç½®ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†ä¸€ä¸ªæ–‡ä»¶å­˜æ”¾åœ¨è¿‡äºåˆ†æ•£çš„å¤šä¸ªç£ç›˜å—ä¸Šï¼Œä¼šå¢åŠ ç£å¤´çš„ç§»åŠ¨è·ç¦»ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåˆ†é…ç»™ä¸€ä¸ªæ–‡ä»¶çš„ç¬¬ä¸€ä¸ªç£ç›˜å—åœ¨æœ€é‡Œé¢çš„ç£é“ä¸Šï¼Œè€Œç¬¬äºŒä¸ªç£ç›˜å—åœ¨æœ€å¤–é¢çš„ç£é“ä¸Šï¼Œå½“è¯»å®Œè¯¥æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªç£ç›˜å—æ—¶ï¼Œéœ€è¦æŠŠç£å¤´ä»æœ€é‡Œé¢çš„ç£é“ç§»åŠ¨åˆ°æœ€å¤–é¢ä¸€ä¸ªç£é“ã€‚è€Œå¦‚æœæŠŠè¿™ä¸ªæ–‡ä»¶å­˜æ”¾åœ¨åŒä¸€ä¸ªç£é“æˆ–è€…ç›¸é‚»çš„ä¸¤ä¸ªç£é“ä¸Šï¼Œè¯»è¿™ä¸ªæ–‡ä»¶çš„ä¸¤ä¸ªç£ç›˜å—ç£å¤´çš„ç§»åŠ¨è·ç¦»ä¼šçŸ­å¾—å¤šï¼Œè¯»ç£ç›˜çš„é€Ÿåº¦ä¼šå¿«å¾—å¤šã€‚ å› æ­¤ï¼Œç°åœ¨çš„æ–‡ä»¶ç³»ç»ŸåŸºæœ¬éƒ½ä¼šè€ƒè™‘å¯¹æ–‡ä»¶çš„ä½ç½®è¿›è¡Œä¼˜åŒ–ï¼ŒåŸåˆ™å°±æ˜¯å°½å¯èƒ½åœ°æŠŠä¸€ä¸ªæ–‡ä»¶å­˜æ”¾åœ¨åŒä¸€ä¸ªç£é“æˆ–è€…ç›¸é‚»çš„ç£é“ä¸Šã€‚å®ç°è¿™ä¸ªåŸåˆ™çš„æŠ€æœ¯ä¸€ä¸ªæ˜¯ä»¥è¿ç»­çš„å‡ ä¸ªæ‰‡åŒºå³ä¸€ä¸ªç°‡ä½œä¸ºç£ç›˜å—çš„åˆ†é…å•ä½ï¼Œå¦ä¸€ä¸ªæŠ€æœ¯æ˜¯æŠŠç£ç›˜åˆ†æˆå—ç»„ï¼Œä¸€ä¸ªå—ç»„ä¸­çš„ä¸åŒç°‡éƒ½åœ¨ç›¸é‚»çš„ç£é“ä¸Šï¼Œä¸€ä¸ªæ–‡ä»¶å°½å¯èƒ½åœ°æ”¾åœ¨åŒä¸€ä¸ªå—ç»„ä¸­ï¼Œå¦‚Liuxçš„Ext2æ–‡ä»¶ç³»ç»Ÿã€‚ 4.è™šæ‹Ÿç›˜ è™šæ‹Ÿç›˜æ˜¯æŒ‡åˆ©ç”¨å†…å­˜ç©ºé—´å»ä»¿çœŸç£ç›˜ï¼Œåˆç§°RAMç›˜ã€‚è™šæ‹Ÿç›˜å¯ä»¥æ¥å—æ‰€æœ‰æ ‡å‡†çš„ç£ç›˜æ“ä½œï¼Œä½†è¿™äº›æ“ä½œçš„æ‰§è¡Œä¸æ˜¯åœ¨ç£ç›˜ä¸Šï¼Œè€Œæ˜¯åœ¨å†…å­˜ä¸­ã€‚å› æ­¤ï¼Œå¯¹è™šæ‹Ÿç›˜çš„è®¿é—®æ¯”å¯¹ç£ç›˜çš„è®¿é—®é€Ÿåº¦å¿«ã€‚ç”¨æˆ·å¯¹è™šæ‹Ÿç›˜çš„æ“ä½œä¸å¯¹ç£ç›˜çš„æ“ä½œå®Œå…¨ç›¸åŒï¼Œæ‰€æœ‰å®ç°ç»†èŠ‚å¯¹ç”¨æˆ·éƒ½æ˜¯é€æ˜çš„ã€‚è™šæ‹Ÿç›˜é€šå¸¸ç”¨äºå­˜æ”¾ä¸´æ—¶æ€§æ–‡ä»¶ï¼Œå¦‚ç¼–è¯‘ç¨‹åºæ‰€äº§ç”Ÿçš„ç›®æ ‡ç¨‹åºç­‰ã€‚è™šæ‹Ÿç›˜ä¸ç£ç›˜é«˜é€Ÿç¼“å­˜è™½ç„¶éƒ½ä½äºå†…å­˜ä¸­ï¼Œä½†æ˜¯è™šæ‹Ÿç›˜ä¸­çš„å†…å®¹æ“ä½œå®Œå…¨ç”±ç”¨æˆ·æ§åˆ¶ï¼Œè€Œé«˜é€Ÿç¼“å­˜ä¸­çš„å†…å®¹åˆ™ æ˜¯ç”±æ“ä½œç³»ç»Ÿæ§åˆ¶çš„ã€‚ 5.ç£ç›˜é«˜é€Ÿç¼“å­˜ ç£ç›˜é«˜é€Ÿç¼“å­˜æ˜¯æŒ‡å†…å­˜çš„ä¸€å—å­˜å‚¨ç©ºé—´ï¼Œç”¨æ¥æš‚å­˜ä»ç£ç›˜ä¸­è¯»å‡ºçš„ä¸€ç³»åˆ—ç›˜å—ä¸­çš„ä¿¡æ¯ã€‚å› æ­¤ï¼Œè¿™é‡Œçš„é«˜é€Ÿç¼“å­˜æ˜¯ä¸€ç»„é€»è¾‘ä¸Šå±äºç£ç›˜ï¼Œè€Œç‰©ç†ä¸Šæ˜¯é©»ç•™åœ¨å†…å­˜ä¸­çš„ç›˜å—ã€‚é«˜é€Ÿç¼“å­˜åœ¨å†…å­˜ä¸­å¯åˆ†æˆä¸¤ç§å½¢å¼ã€‚ç¬¬ä¸€ç§æ˜¯åœ¨å†…å­˜ä¸­å¼€è¾Ÿä¸€ä¸ªå•ç‹¬çš„å­˜å‚¨ç©ºé—´æ¥ä½œä¸ºç£ç›˜é«˜é€Ÿç¼“å­˜ï¼Œå…¶å¤§å°æ˜¯å›ºå®šçš„ï¼Œä¸ä¼šå—åº”ç”¨ç¨‹åºå¤šå°‘çš„å½±å“ã€‚ç¬¬äºŒç§æ˜¯æŠŠæ‰€æœ‰æœªåˆ©ç”¨çš„å†…å­˜ç©ºé—´å˜ä¸ºä¸€ä¸ªç¼“å†²æ± ï¼Œä¾›è¯·æ±‚åˆ†é¡µç³»ç»Ÿå’Œç£ç›˜I/Oæ—¶ï¼ˆä½œä¸ºç£ç›˜é«˜é€Ÿç¼“å­˜ï¼‰å…±äº«ã€‚æ­¤æ—¶ï¼Œé«˜é€Ÿç¼“å­˜çš„å¤§å°ä¸å†æ˜¯å›ºå®šçš„ã€‚å½“ç£ç›˜é¢‘ç¹å‘ç”ŸI/Oæ—¶ï¼Œè¯¥ç¼“å†²æ± å¯èƒ½åŒ…å«æ›´å¤šçš„å†…å­˜ç©ºé—´ã€‚è€Œåœ¨åº”ç”¨ç¨‹åºè¿è¡Œå¾—è¾ƒå¤šæ—¶ï¼Œè¯¥ç¼“å†²æ± å¯èƒ½åªå‰©ä¸‹è¾ƒå°‘çš„å†…å­˜ç©ºé—´ã€‚ "},"pages/lflivekit/LFLiveKitæºç ä¹‹LFLivePreview.html":{"url":"pages/lflivekit/LFLiveKitæºç ä¹‹LFLivePreview.html","title":"LFLiveKitæºç ä¹‹LFLivePreview","keywords":"","body":"LFLiveKitæºç ä¹‹LFLivePreview "},"pages/librtmp/librtmpæºç ä¹‹è°ƒè¯•.html":{"url":"pages/librtmp/librtmpæºç ä¹‹è°ƒè¯•.html","title":"librtmpæºç ä¹‹è°ƒè¯•","keywords":"","body":"librtmpæºç ä¹‹è°ƒè¯• "},"pages/librtmp/librtmpæºç ä¹‹ç›¸å…³ç»“æ„ä½“.html":{"url":"pages/librtmp/librtmpæºç ä¹‹ç›¸å…³ç»“æ„ä½“.html","title":"librtmpæºç ä¹‹ç›¸å…³ç»“æ„ä½“","keywords":"","body":"librttmpæºç ä¹‹ç›¸å…³ç»“æ„ä½“ åˆ†æRTMP_Connectä¹‹å‰ï¼Œæœ‰å¿…è¦äº†è§£ä¸‹ä¸€ä¸‹å®šä¹‰ã€‚ Ip Protocol /* Standard well-defined IP protocols. */ enum { IPPROTO_IP = 0, /* Dummy protocol for TCP. */ IPPROTO_ICMP = 1, /* Internet Control Message Protocol. */ IPPROTO_IGMP = 2, /* Internet Group Management Protocol. */ IPPROTO_IPIP = 4, /* IPIP tunnels (older KA9Q tunnels use 94). */ IPPROTO_TCP = 6, /* Transmission Control Protocol. */ IPPROTO_EGP = 8, /* Exterior Gateway Protocol. */ IPPROTO_PUP = 12, /* PUP protocol. */ IPPROTO_UDP = 17, /* User Datagram Protocol. */ IPPROTO_IDP = 22, /* XNS IDP protocol. */ IPPROTO_TP = 29, /* SO Transport Protocol Class 4. */ IPPROTO_DCCP = 33, /* Datagram Congestion Control Protocol. */ IPPROTO_IPV6 = 41, /* IPv6 header. */ IPPROTO_RSVP = 46, /* Reservation Protocol. */ IPPROTO_GRE = 47, /* General Routing Encapsulation. */ IPPROTO_ESP = 50, /* encapsulating security payload. */ IPPROTO_AH = 51, /* authentication header. */ IPPROTO_MTP = 92, /* Multicast Transport Protocol. */ IPPROTO_BEETPH = 94, /* IP option pseudo header for BEET. */ IPPROTO_ENCAP = 98, /* Encapsulation Header. */ IPPROTO_PIM = 103, /* Protocol Independent Multicast. */ IPPROTO_COMP = 108, /* Compression Header Protocol. */ IPPROTO_SCTP = 132, /* Stream Control Transmission Protocol. */ IPPROTO_UDPLITE = 136, /* UDP-Lite protocol. */ IPPROTO_RAW = 255, /* Raw IP packets. */ IPPROTO_MAX }; struct sockaddr å†…å®¹æ¥æºäºï¼šhttps://www.cnblogs.com/cyx-b/p/12450811.html struct sockaddr { ã€€ã€€unsigned short sa_family;// 2å­—èŠ‚ï¼Œåœ°å€æ—ï¼ŒAF_xxx ã€€ã€€char sa_data[14]; // 14å­—èŠ‚ï¼ŒåŒ…å«å¥—æ¥å­—ä¸­çš„ç›®æ ‡åœ°å€å’Œç«¯å£ä¿¡æ¯ }; struct addrinfo å†…å®¹æ¥æºäºï¼šhttps://www.cnblogs.com/LubinLew/p/POSIX-DataStructure.html The header shall define the addrinfo structure, which shall include at least the following members: #include #include #include /* ======================Types of sockets====================== */ enum __socket_type { SOCK_STREAM = 1, /* Sequenced, reliable, connection-based byte streams. */ SOCK_DGRAM = 2, /* Connectionless, unreliable datagrams of fixed maximum length. */ SOCK_RAW = 3, /* Raw protocol interface. */ SOCK_RDM = 4, /* Reliably-delivered messages. */ SOCK_SEQPACKET = 5, /* Sequenced, reliable, connection-based,datagrams of fixed maximum length. */ SOCK_DCCP = 6, /* Datagram Congestion Control Protocol. */ SOCK_PACKET = 10, /* Linux specific way of getting packets at the dev level. For writing rarp and other similar things on the user level. */ /* Flags to be ORed into the type parameter of socket and socketpair and used for the flags parameter of paccept. */ SOCK_CLOEXEC = 02000000, /* Atomically set close-on-exec flag for the new descriptor(s). */ SOCK_NONBLOCK = 00004000 /* Atomically mark descriptor(s) as non-blocking. */ }; /* ============Protocol families(åªåˆ—å‡ºå¸¸ç”¨å‡ ä¸ª)================= */ #define PF_UNSPEC 0 /* Unspecified. */ #define PF_LOCAL 1 /* Local to host (pipes and file-domain). */ #define PF_INET 2 /* IP protocol family. */ #define PF_IPX 4 /* Novell Internet Protocol. */ #define PF_APPLETALK 5 /* Appletalk DDP. */ #define PF_INET6 10 /* IP version 6. */ #define PF_TIPC 30 /* TIPC sockets. */ #define PF_BLUETOOTH 31 /* Bluetooth sockets. */ /* ==============Address families(åªåˆ—å‡ºå¸¸ç”¨å‡ ä¸ª)================= */ #define AF_UNSPEC PF_UNSPEC #define AF_LOCAL PF_LOCAL #define AF_UNIX PF_UNIX #define AF_FILE PF_FILE #define AF_INET PF_INET #define AF_IPX PF_IPX #define AF_APPLETALK PF_APPLETALK #define AF_INET6 PF_INET6 #define AF_ROSE PF_ROSE #define AF_NETLINK PF_NETLINK #define AF_TIPC PF_TIPC #define AF_BLUETOOTH PF_BLUETOOTH /* ====Possible values for `ai_flags' field in `addrinfo' structure.===== */ #define AI_PASSIVE 0x0001 /* Socket address is intended for `bind'. */ #define AI_CANONNAME 0x0002 /* Request for canonical name. */ #define AI_NUMERICHOST 0x0004 /* Don't use name resolution. */ #define AI_V4MAPPED 0x0008 /* IPv4 mapped addresses are acceptable. */ #define AI_ALL 0x0010 /* Return IPv4 mapped and IPv6 addresses. */ #define AI_ADDRCONFIG 0x0020 /* Use configuration of this host to choose returned address type. */ #ifdef __USE_GNU #define AI_IDN 0x0040 /* IDN encode input (assuming it is encoded in the current locale's character set) before looking it up. */ #define AI_CANONIDN 0x0080 /* Translate canonical name from IDN format. */ #define AI_IDN_ALLOW_UNASSIGNED 0x0100 /* Don't reject unassigned Unicode code points. */ #define AI_IDN_USE_STD3_ASCII_RULES 0x0200 /* Validate strings according to STD3 rules. */ #endif #define AI_NUMERICSERV 0x0400 /* Don't use name resolution. */ /* =======================struct addrinfo======================= */ struct addrinfo { int ai_flags; /* é™„åŠ é€‰é¡¹,å¤šä¸ªé€‰é¡¹å¯ä»¥ä½¿ç”¨æˆ–æ“ä½œç»“åˆ */ int ai_family; /* æŒ‡å®šè¿”å›åœ°å€çš„åè®®ç°‡,å–å€¼èŒƒå›´:AF_INET(IPv4)ã€AF_INET6(IPv6)ã€AF_UNSPEC(IPv4 and IPv6) */ int ai_socktype; /* enum __socket_type ç±»å‹ï¼Œè®¾ç½®ä¸º0è¡¨ç¤ºä»»æ„ç±»å‹ */ int ai_protocol; /* åè®®ç±»å‹ï¼Œè®¾ç½®ä¸º0è¡¨ç¤ºä»»æ„ç±»å‹,å…·ä½“è§ä¸Šä¸€èŠ‚çš„ Ip Protocol */ socklen_t ai_addrlen; /* socket address çš„é•¿åº¦ */ struct sockaddr *ai_addr; /* socket address çš„åœ°å€ */ char *ai_canonname; /* Canonical name of service location. */ struct addrinfo *ai_next; /* æŒ‡å‘ä¸‹ä¸€æ¡ä¿¡æ¯,å› ä¸ºå¯èƒ½è¿”å›å¤šä¸ªåœ°å€ */ }; RTMP å†…å®¹æ¥æºäºï¼šhttps://www.jianshu.com/p/05b1e5d70c06 RTMPå®šä¹‰åœ¨rtmp.hã€‚ /* ** è¿œç¨‹è°ƒç”¨æ–¹æ³• */ typedef struct RTMP_METHOD { AVal name; int num; } RTMP_METHOD; typedef struct RTMPSockBuf { int sb_socket; // å¥—æ¥å­— int sb_size; // ç¼“å†²åŒºå¯è¯»å¤§å° char *sb_start; // ç¼“å†²åŒºè¯»å–ä½ç½® char sb_buf[RTMP_BUFFER_CACHE_SIZE]; // å¥—æ¥å­—è¯»å–ç¼“å†²åŒº int sb_timedout; // è¶…æ—¶æ ‡å¿— void *sb_ssl; // TLSä¸Šä¸‹æ–‡ } RTMPSockBuf; typedef struct RTMP { int m_inChunkSize; // æœ€å¤§æ¥æ”¶å—å¤§å° int m_outChunkSize; // æœ€å¤§å‘é€å—å¤§å° int m_nBWCheckCounter; // å¸¦å®½æ£€æµ‹è®¡æ•°å™¨ int m_nBytesIn; // æ¥æ”¶æ•°æ®è®¡æ•°å™¨ int m_nBytesInSent; // å½“å‰æ•°æ®å·²å›åº”è®¡æ•°å™¨ int m_nBufferMS; // å½“å‰ç¼“å†²çš„æ—¶é—´é•¿åº¦ï¼Œä»¥MSä¸ºå•ä½ int m_stream_id; // å½“å‰è¿æ¥çš„æµID int m_mediaChannel; // å½“å‰è¿æ¥åª’ä½“ä½¿ç”¨çš„å—æµID uint32_t m_mediaStamp; // å½“å‰è¿æ¥åª’ä½“æœ€æ–°çš„æ—¶é—´æˆ³ uint32_t m_pauseStamp; // å½“å‰è¿æ¥åª’ä½“æš‚åœæ—¶çš„æ—¶é—´æˆ³ int m_pausing; // æ˜¯å¦æš‚åœçŠ¶æ€ int m_nServerBW; // æœåŠ¡å™¨å¸¦å®½ int m_nClientBW; // å®¢æˆ·ç«¯å¸¦å®½ uint8_t m_nClientBW2; // å®¢æˆ·ç«¯å¸¦å®½è°ƒèŠ‚æ–¹å¼ uint8_t m_bPlaying; // å½“å‰æ˜¯å¦æ¨æµæˆ–è¿æ¥ä¸­ uint8_t m_bSendEncoding; // è¿æ¥æœåŠ¡å™¨æ—¶å‘é€ç¼–ç  uint8_t m_bSendCounter; // è®¾ç½®æ˜¯å¦å‘æœåŠ¡å™¨å‘é€æ¥æ”¶å­—èŠ‚åº”ç­” int m_numInvokes; // 0x14å‘½ä»¤è¿œç¨‹è¿‡ç¨‹è°ƒç”¨è®¡æ•° int m_numCalls; // 0x14å‘½ä»¤è¿œç¨‹è¿‡ç¨‹è¯·æ±‚é˜Ÿåˆ—æ•°é‡ RTMP_METHOD *m_methodCalls; // è¿œç¨‹è¿‡ç¨‹è°ƒç”¨è¯·æ±‚é˜Ÿåˆ— RTMPPacket *m_vecChannelsIn[RTMP_CHANNELS]; // å¯¹åº”å—æµIDä¸Šä¸€æ¬¡æ¥æ”¶çš„æŠ¥æ–‡ RTMPPacket *m_vecChannelsOut[RTMP_CHANNELS]; // å¯¹åº”å—æµIDä¸Šä¸€æ¬¡å‘é€çš„æŠ¥æ–‡ int m_channelTimestamp[RTMP_CHANNELS]; // å¯¹åº”å—æµIDåª’ä½“çš„æœ€æ–°æ—¶é—´æˆ³ double m_fAudioCodecs; // éŸ³é¢‘ç¼–ç å™¨ä»£ç  double m_fVideoCodecs; // è§†é¢‘ç¼–ç å™¨ä»£ç  double m_fEncoding; /* AMF0 or AMF3 */ double m_fDuration; // å½“å‰åª’ä½“çš„æ—¶é•¿ int m_msgCounter; // ä½¿ç”¨HTTPåè®®å‘é€è¯·æ±‚çš„è®¡æ•°å™¨ int m_polling; // ä½¿ç”¨HTTPåè®®æ¥æ”¶æ¶ˆæ¯ä¸»ä½“æ—¶çš„ä½ç½® int m_resplen; // ä½¿ç”¨HTTPåè®®æ¥æ”¶æ¶ˆæ¯ä¸»ä½“æ—¶çš„æœªè¯»æ¶ˆæ¯è®¡æ•° int m_unackd; // ä½¿ç”¨HTTPåè®®å¤„ç†æ—¶æ— å“åº”çš„è®¡æ•° AVal m_clientID; // ä½¿ç”¨HTTPåè®®å¤„ç†æ—¶çš„èº«ä»½ID RTMP_READ m_read; // RTMP_Read()æ“ä½œçš„ä¸Šä¸‹æ–‡ RTMPPacket m_write; // RTMP_Write()æ“ä½œä½¿ç”¨çš„å¯å¤ç”¨æŠ¥æ–‡å¯¹è±¡ RTMPSockBuf m_sb; // RTMP_ReadPacket()è¯»åŒ…æ“ä½œçš„ä¸Šä¸‹æ–‡ RTMP_LNK Link; // RTMPè¿æ¥ä¸Šä¸‹æ–‡ } RTMP; RTMP_LINK å†…å®¹æ¥æºäºï¼šhttps://www.jianshu.com/p/05b1e5d70c06 typedef struct RTMP_LNK { AVal hostname; // ç›®æ ‡ä¸»æœºåœ°å€ AVal sockshost; // socksä»£ç†åœ°å€ // è¿æ¥å’Œæ¨æ‹‰æµæ¶‰åŠçš„ä¸€äº›å‚æ•°ä¿¡æ¯ AVal playpath0; /* parsed from URL */ AVal playpath; /* passed in explicitly */ AVal tcUrl; AVal swfUrl; AVal pageUrl; AVal app; AVal auth; AVal flashVer; AVal subscribepath; AVal token; AMFObject extras; int edepth; int seekTime; // æ’­æ”¾æµçš„å¼€å§‹æ—¶é—´ int stopTime; // æ’­æ”¾æµçš„åœæ­¢æ—¶é—´ #define RTMP_LF_AUTH 0x0001 /* using auth param */ #define RTMP_LF_LIVE 0x0002 /* stream is live */ #define RTMP_LF_SWFV 0x0004 /* do SWF verification */ #define RTMP_LF_PLST 0x0008 /* send playlist before play */ #define RTMP_LF_BUFX 0x0010 /* toggle stream on BufferEmpty msg */ #define RTMP_LF_FTCU 0x0020 /* free tcUrl on close */ int lFlags; int swfAge; int protocol; // è¿æ¥ä½¿ç”¨çš„åè®® int timeout; // è¿æ¥è¶…æ—¶æ—¶é—´ unsigned short socksport; // socksä»£ç†ç«¯å£ unsigned short port; // ç›®æ ‡ä¸»æœºç«¯å£ #ifdef CRYPTO #define RTMP_SWF_HASHLEN 32 void *dh; /* for encryption */ void *rc4keyIn; void *rc4keyOut; uint32_t SWFSize; uint8_t SWFHash[RTMP_SWF_HASHLEN]; char SWFVerificationResponse[RTMP_SWF_HASHLEN+10]; #endif } RTMP_LNK; RTMPPacket å†…å®¹æ¥æºäºï¼šhttps://blog.csdn.net/NB_vol_1/article/details/58660181 https://blog.csdn.net/bwangk/article/details/112802823 // åŸå§‹çš„rtmpæ¶ˆæ¯å— typedef struct RTMPChunk { int c_headerSize; // å¤´éƒ¨çš„é•¿åº¦ int c_chunkSize; // chunkçš„å¤§å° char *c_chunk; // æ•°æ® char c_header[RTMP_MAX_HEADER_SIZE]; // chunkå¤´éƒ¨ } RTMPChunk; // rtmpæ¶ˆæ¯å— typedef struct RTMPPacket { // chunk basic headerï¼ˆå¤§éƒ¨åˆ†æƒ…å†µæ˜¯ä¸€ä¸ªå­—èŠ‚ï¼‰ // #define RTMP_PACKET_SIZE_LARGE 0 onMetaDataæµå¼€å§‹çš„ç»å¯¹æ—¶é—´æˆ³æ§åˆ¶æ¶ˆæ¯ï¼ˆå¦‚connectï¼‰ // #define RTMP_PACKET_SIZE_MEDIUM 1 å¤§éƒ¨åˆ†çš„rtmp headeréƒ½æ˜¯8å­—èŠ‚çš„ // #define RTMP_PACKET_SIZE_SMALL 2 æ¯”è¾ƒå°‘è§ // #define RTMP_PACKET_SIZE_MINIMUM 3 å¶å°”å‡ºç°ï¼Œä½äº8å­—èŠ‚é¢‘ç‡ // chunk type id (2bit)fmt å¯¹åº”message head {0,3,7,11} + (6bit)chunk stream id // å—ç±»å‹IDï¼Œæ¶ˆæ¯å¤´çš„ç¬¬1ä¸ªå­—èŠ‚çš„å‰2ä½ï¼Œå†³å®šæ¶ˆæ¯å¤´é•¿åº¦ uint8_t m_headerType; // Message type IDï¼ˆ1-7åè®®æ§åˆ¶ï¼›8ï¼Œ9éŸ³è§†é¢‘ï¼›10ä»¥åä¸ºAMFç¼–ç æ¶ˆæ¯ï¼‰ uint8_t m_packetType; // æ˜¯å¦å«æœ‰Extend timeStampå­—æ®µ uint8_t m_hasAbsTimestamp; /* timestamp absolute or relative? */ // channel å³ stream idå­—æ®µ // ç¬¬ä¸€ä¸ªå­—èŠ‚çš„ä½6ä½ï¼Œå‘½åä¸ºChunk Stream IDï¼ŒChunk Stream IDç”¨æ¥è¡¨ç¤ºæ¶ˆæ¯çš„çº§åˆ«ï¼š // chunk stream id çº§åˆ« // 2 low level // 3 high level(åƒconnect, create_streamä¸€ç±»æ¶ˆæ¯) // 4 control stream // 5 video // 6 audio // 8 control stream int m_nChannel; // æ—¶é—´æˆ³ uint32_t m_nTimeStamp; /* timestamp */ // message stream id int32_t m_nInfoField2; /* last 4 bytes in a long header */ // chunkä½“çš„é•¿åº¦ uint32_t m_nBodySize; uint32_t m_nBytesRead; RTMPChunk *m_chunk; // åŸå§‹rtmpæ¶ˆæ¯å— char *m_body; } RTMPPacket; typedef struct RTMPPacket { uint8_t m_headerType; //basic header ä¸­çš„typeå¤´å­—èŠ‚ï¼Œå€¼ä¸º(0,1,2,3)è¡¨ç¤ºChunkMsgHeaderçš„ç±»å‹ï¼ˆ4ç§ï¼‰ uint8_t m_packetType; //Chunk Msg Headerä¸­msg type 1å­—èŠ‚ï¼šæ¶ˆæ¯ç±»å‹idï¼ˆ8: audioï¼›9:videoï¼›18:AMF0ç¼–ç çš„å…ƒæ•°æ®ï¼‰ uint8_t m_hasAbsTimestamp; //boolå€¼ï¼Œæ˜¯å¦æ˜¯ç»å¯¹æ—¶é—´æˆ³(ç±»å‹1æ—¶ä¸ºtrue) int m_nChannel; //å—æµID ï¼Œé€šè¿‡è®¾ç½®ChannelIDæ¥è®¾ç½®Basic stream idçš„é•¿åº¦å’Œå€¼ uint32_t m_nTimeStamp; //æ—¶é—´æˆ³ï¼Œæ¶ˆæ¯å¤´å‰ä¸‰å­—èŠ‚ int32_t m_nInfoField2; //Chunk Msg Headerä¸­msg StreamID 4å­—èŠ‚ï¼šæ¶ˆæ¯æµid uint32_t m_nBodySize; //Chunk Msg Headerä¸­msg length 4å­—èŠ‚ï¼šæ¶ˆæ¯é•¿åº¦ uint32_t m_nBytesRead; //å·²è¯»å–çš„æ•°æ® RTMPChunk *m_chunk; //raw chunkç»“æ„ä½“æŒ‡é’ˆï¼ŒæŠŠRTMPPacketçš„çœŸå®å¤´éƒ¨å’Œæ•°æ®æ®µæ‹·è´è¿›æ¥ char *m_body; //æ•°æ®æ®µæŒ‡é’ˆ } RTMPPacket; RTMP_READ å†…å®¹æ¥æºäºï¼šhttps://blog.csdn.net/NB_vol_1/article/details/58660181 /* ** AValè¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸² */ typedef struct AVal { char *av_val; int av_len; } AVal; /* state for read() wrapper */ // readå‡½æ•°çš„åŒ…è£…å™¨ï¼ŒåŒ…æ‹¬çŠ¶æ€ç­‰ç­‰ typedef struct RTMP_READ { char *buf; char *bufpos; unsigned int buflen; uint32_t timestamp; uint8_t dataType; uint8_t flags; #define RTMP_READ_HEADER 0x01 #define RTMP_READ_RESUME 0x02 #define RTMP_READ_NO_IGNORE 0x04 #define RTMP_READ_GOTKF 0x08 #define RTMP_READ_GOTFLVK 0x10 #define RTMP_READ_SEEKING 0x20 int8_t status; #define RTMP_READ_COMPLETE -3 #define RTMP_READ_ERROR -2 #define RTMP_READ_EOF -1 #define RTMP_READ_IGNORE 0 /* if bResume == TRUE */ uint8_t initialFrameType; uint32_t nResumeTS; char *metaHeader; char *initialFrame; uint32_t nMetaHeaderSize; uint32_t nInitialFrameSize; uint32_t nIgnoredFrameCounter; uint32_t nIgnoredFlvFrameCounter; } RTMP_READ; "},"pages/librtmp/librtmpæºç ä¹‹RTMP_Connect.html":{"url":"pages/librtmp/librtmpæºç ä¹‹RTMP_Connect.html","title":"librtmpæºç ä¹‹RTMP_Connect","keywords":"","body":"librttmpæºç ä¹‹RTMP_Connect RTMP_Connect int RTMP_Connect(RTMP *r, RTMPPacket *cp) { struct addrinfo *service; if (!r->Link.hostname.av_len) return FALSE; // è®¾ç½®ç›´æ¥è¿æ¥çš„æœåŠ¡å™¨åœ°å€ if (r->Link.socksport) { /* Connect via SOCKS */ if (!add_addr_info(&service, &r->Link.sockshost, r->Link.socksport)) return FALSE; } else { /* Connect directly */ if (!add_addr_info(&service, &r->Link.hostname, r->Link.port)) return FALSE; } RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_flags:%d\", service->ai_flags); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_family:%d\", service->ai_family); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_socktype:%d\", service->ai_socktype); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_protocol:%d\", service->ai_protocol); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_addrlen:%d\", service->ai_addrlen); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_addr->sa_family:%d\", service->ai_addr->sa_family); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_addr->sa_data:%s\", service->ai_addr->sa_data); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_canonname:%s\", service->ai_canonname); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_next:%s\", service->ai_next); if (!RTMP_Connect0(r, service)) { freeaddrinfo(service); return FALSE; } freeaddrinfo(service); r->m_bSendCounter = TRUE; return RTMP_Connect1(r, cp); } ä»£ç ç‰‡æ®µåˆ†æ1 // è®¾ç½®ç›´æ¥è¿æ¥çš„æœåŠ¡å™¨åœ°å€ if (r->Link.socksport) { /* Connect via SOCKS */ if (!add_addr_info(&service, &r->Link.sockshost, r->Link.socksport)) return FALSE; } else { /* Connect directly */ if (!add_addr_info(&service, &r->Link.hostname, r->Link.port)) return FALSE; } RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_flags:%d\", service->ai_flags); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_family:%d\", service->ai_family); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_socktype:%d\", service->ai_socktype); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_protocol:%d\", service->ai_protocol); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_addrlen:%d\", service->ai_addrlen); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_addr->sa_family:%d\", service->ai_addr->sa_family); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_addr->sa_data:%s\", service->ai_addr->sa_data); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_canonname:%s\", service->ai_canonname); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: addrinfo->ai_next:%s\", service->ai_next); // DEBUG: CCQ: addrinfo->ai_flags:0 /* 0ä»£è¡¨æ²¡æœ‰è®¾å€¼ï¼Œå¦‚æœè®¾å€¼ï¼Œå–å€¼èŒƒå›´è§ä¸Š`AI_PASSIVE`... */ // DEBUG: CCQ: addrinfo->ai_family:2 /* 2ä»£è¡¨`AF_INET`ï¼Œä¹Ÿå°±æ˜¯`PF_INET`ï¼Œå–ä¹‹èŒƒå›´è§ä¸Š`AF_UNSPEC`... */ // DEBUG: CCQ: addrinfo->ai_socktype:1 /* 1ä»£è¡¨`SOCK_STREAM`ï¼Œå–å€¼èŒƒå›´è§ä¸Š`__socket_type` */ // DEBUG: CCQ: addrinfo->ai_protocol:6 /* 6ä»£è¡¨`IPPROTO_TCP`ï¼Œå–ä¹‹èŒƒå›´è§ä¸Š`Ip Protocol` */ // DEBUG: CCQ: addrinfo->ai_addrlen:16 /* socket address çš„é•¿åº¦ */ // DEBUG: CCQ: addrinfo->ai_addr->sa_family:2 /* 2ä»£è¡¨`AF_INET`ï¼Œä¹Ÿå°±æ˜¯`PF_INET`ï¼Œå–ä¹‹èŒƒå›´è§ä¸Š`AF_UNSPEC`... */ // DEBUG: CCQ: addrinfo->ai_addr->sa_data:\u0007\\217\\300\\250 // DEBUG: CCQ: addrinfo->ai_canonname:(null) /* Canonical name of service location. */ // DEBUG: CCQ: addrinfo->ai_next:(null) ä»£ç ç‰‡æ®µåˆ†æ2 if (!RTMP_Connect0(r, service)) { freeaddrinfo(service); return FALSE; } freeaddrinfo(service); r->m_bSendCounter = TRUE;// è®¾ç½®æ˜¯å¦å‘æœåŠ¡å™¨å‘é€æ¥æ”¶å­—èŠ‚åº”ç­” return RTMP_Connect1(r, cp); å†…å®¹æ¥æºäºï¼šhttps://www.jianshu.com/p/05b1e5d70c06 å¼€å§‹è°ƒç”¨RTMP_Connect1ï¼Œç»§ç»­æ‰§è¡ŒSSLæˆ–HTTPåå•†ï¼Œä»¥åŠRTMPæ¡æ‰‹ã€‚ add_addr_info å†…å®¹æ¥æºäºï¼šhttps://blog.csdn.net/weixin_37921201/article/details/90111641 å¡«å……struct addrinfoç»“æ„ä½“ç”¨äºä¹‹åçš„socketé€šä¿¡ã€‚ /** å¡«å……struct addrinfoç»“æ„ä½“ç”¨äºä¹‹åçš„socketé€šä¿¡ã€‚ service: addrinfoæŒ‡é’ˆçš„æŒ‡é’ˆ host: 192.168.0.12:1935/zbcs/room port: 1935 */ static int add_addr_info(struct addrinfo **service, AVal *host, int port) { struct addrinfo hints; char *hostname, portNo[32]; int ret = TRUE; RTMP_Log(RTMP_LOGDEBUG, \"CCQ: host->av_valï¼š%s\", host->av_val); if (host->av_val[host->av_len]) { hostname = malloc(host->av_len+1); memcpy(hostname, host->av_val, host->av_len); hostname[host->av_len] = '\\0'; RTMP_Log(RTMP_LOGDEBUG, \"CCQ: hostnameï¼š%s\", hostname); } else { hostname = host->av_val; RTMP_Log(RTMP_LOGDEBUG, \"CCQ: hostname2ï¼š%s\", hostname); } sprintf(portNo, \"%d\", port); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: portNoï¼š%s\", portNo); memset(&hints, 0, sizeof(struct addrinfo)); hints.ai_socktype = SOCK_STREAM; hints.ai_family = AF_UNSPEC; if(getaddrinfo(hostname, portNo, &hints, service) != 0) { RTMP_Log(RTMP_LOGERROR, \"Problem accessing the DNS. (addr: %s)\", hostname); ret = FALSE; } finish: if (hostname != host->av_val) free(hostname); return ret; } ä»£ç ç‰‡æ®µåˆ†æ1 RTMP_Log(RTMP_LOGDEBUG, \"CCQ: host->av_valï¼š%s\", host->av_val); if (host->av_val[host->av_len]) { hostname = malloc(host->av_len+1); memcpy(hostname, host->av_val, host->av_len); hostname[host->av_len] = '\\0'; RTMP_Log(RTMP_LOGDEBUG, \"CCQ: hostnameï¼š%s\", hostname); } else { hostname = host->av_val; RTMP_Log(RTMP_LOGDEBUG, \"CCQ: hostname2ï¼š%s\", hostname); } // è¾“å‡ºç»“æœï¼š // DEBUG: host->av_valï¼š192.168.0.12:1935/zbcs/room // DEBUG: hostnameï¼š192.168.0.12 é€šè¿‡æ‰“å°ç»“æœåˆ†æï¼Œè¿™æ®µä»£ç å°±æ˜¯ç»™hostnameèµ‹å€¼ï¼Œå¾—åˆ°IPåœ°å€æ®µã€‚ ä»£ç ç‰‡æ®µåˆ†æ2 sprintf(portNo, \"%d\", port); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: portNoï¼š%d\", portNo); // DEBUG: CCQ: portNoï¼š1935 sprintfï¼šhttps://baike.baidu.com/item/sprintf/9703430?fr=aladdin è¿™é‡Œå°±æ˜¯ç»™portNoèµ‹å€¼ï¼Œå°†intè½¬char *ã€‚ ä»£ç ç‰‡æ®µåˆ†æ3 memset(&hints, 0, sizeof(struct addrinfo));// ç»™hintsåˆ†é…å†…å­˜ hints.ai_socktype = SOCK_STREAM;// è®¾ç½®sockç±»å‹ï¼Œè®¾ç½®èŒƒå›´ï¼š__socket_type hints.ai_family = AF_UNSPEC;// æŒ‡å®šè¿”å›åœ°å€çš„åè®®ç°‡ å†…å®¹æ¥æºäºï¼š https://blog.csdn.net/u011003120/article/details/78277133 https://www.cnblogs.com/LubinLew/p/POSIX-getaddrinfo.html ai_familyè§£é‡Šï¼šæŒ‡å®šè¿”å›åœ°å€çš„åè®®ç°‡ï¼Œå–å€¼èŒƒå›´:AF_INET(IPv4)ã€AF_INET6(IPv6)ã€AF_UNSPEC(IPv4 and IPv6)ã€‚ ä»£ç ç‰‡æ®µåˆ†æ4 // hostnameï¼šIPåœ°å€ï¼Œä¾‹å¦‚ï¼š192.168.0.12 // portNoï¼šç«¯å£å·ï¼Œä¾‹å¦‚ï¼š1935 // hintsï¼šstruct addrinfoåœ°å€ // serviceï¼šä¼ è¿›æ¥çš„struct addrinfoï¼Œç”¨äºè·å–ä¿¡æ¯ç»“æœ if(getaddrinfo(hostname, portNo, &hints, service) != 0) { RTMP_Log(RTMP_LOGERROR, \"Problem accessing the DNS. (addr: %s)\", hostname); ret = FALSE; } å†…å®¹æ¥æºäºï¼š https://www.cnblogs.com/LubinLew/p/POSIX-getaddrinfo.html å‡½æ•°æ³¨é‡Šï¼š int getaddrinfo(const char *restrict nodename, /* host æˆ–è€…IPåœ°å€ */ const char *restrict servname, /* åè¿›åˆ¶ç«¯å£å· æˆ–è€…å¸¸ç”¨æœåŠ¡åç§°å¦‚\"ftp\"ã€\"http\"ç­‰ */ const struct addrinfo *restrict hints, /* è·å–ä¿¡æ¯è¦æ±‚è®¾ç½® */ struct addrinfo **restrict res); /* è·å–ä¿¡æ¯ç»“æœ */ IPv4ä¸­ä½¿ç”¨gethostbyname()å‡½æ•°å®Œæˆä¸»æœºååˆ°åœ°å€è§£æï¼Œè¿™ä¸ªå‡½æ•°ä»…ä»…æ”¯æŒIPv4ï¼Œä¸”ä¸å…è®¸è°ƒç”¨è€…æŒ‡å®šæ‰€éœ€åœ°å€ç±»å‹çš„ä»»ä½•ä¿¡æ¯ï¼Œè¿”å›çš„ç»“æ„åªåŒ…å«äº†ç”¨äºå­˜å‚¨IPv4åœ°å€çš„ç©ºé—´ã€‚IPv6ä¸­å¼•å…¥äº†æ–°çš„API getaddrinfo()ï¼Œå®ƒæ˜¯åè®®æ— å…³çš„ï¼Œæ—¢å¯ç”¨äºIPv4ä¹Ÿå¯ç”¨äºIPv6ã€‚getaddrinfo() å‡½æ•°èƒ½å¤Ÿå¤„ç†åå­—åˆ°åœ°å€ä»¥åŠæœåŠ¡åˆ°ç«¯å£è¿™ä¸¤ç§è½¬æ¢ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ª struct addrinfo çš„ç»“æ„ä½“(åˆ—è¡¨)æŒ‡é’ˆè€Œä¸æ˜¯ä¸€ä¸ªåœ°å€æ¸…å•ã€‚è¿™äº› struct addrinfo ç»“æ„ä½“éšåå¯ç”±å¥—æ¥å£å‡½æ•°ç›´æ¥ä½¿ç”¨ã€‚å¦‚æ­¤ä»¥æ¥ï¼Œgetaddrinfo()å‡½æ•°æŠŠåè®®ç›¸å…³æ€§å®‰å…¨éšè—åœ¨è¿™ä¸ªåº“å‡½æ•°å†…éƒ¨ã€‚åº”ç”¨ç¨‹åºåªè¦å¤„ç†ç”±getaddrinfo()å‡½æ•°å¡«å†™çš„å¥—æ¥å£åœ°å€ç»“æ„ã€‚ ä»£ç ç‰‡æ®µåˆ†æ5 finish: if (hostname != host->av_val) free(hostname); é‡Šæ”¾hostnameå†…å­˜ï¼Œè‡³æ­¤add_addr_infoå‡½æ•°åˆ†æå®Œæ¯•ã€‚ RTMP_Connect0 int RTMP_Connect0(RTMP *r, struct addrinfo * service) { int on = 1; r->m_sb.sb_timedout = FALSE; r->m_pausing = 0; r->m_fDuration = 0.0; // åˆ›å»ºå¥—æ¥å­— r->m_sb.sb_socket = socket(service->ai_family, service->ai_socktype, service->ai_protocol); if (r->m_sb.sb_socket != -1) {// è¿æ¥å¯¹ç«¯ if (connect(r->m_sb.sb_socket, service->ai_addr, service->ai_addrlen) Link.socksport) { RTMP_Log(RTMP_LOGDEBUG, \"%s ... SOCKS negotiation\", __FUNCTION__); if (!SocksNegotiate(r)) { RTMP_Log(RTMP_LOGERROR, \"%s, SOCKS negotiation failed.\", __FUNCTION__); RTMP_Close(r); return FALSE; } } } else { RTMP_Log(RTMP_LOGERROR, \"%s, failed to create socket. Error: %d\", __FUNCTION__, GetSockError()); return FALSE; } /* set timeout */ { SET_RCVTIMEO(tv, r->Link.timeout); if (setsockopt (r->m_sb.sb_socket, SOL_SOCKET, SO_RCVTIMEO, (char *)&tv, sizeof(tv))) { RTMP_Log(RTMP_LOGERROR, \"%s, Setting socket timeout to %ds failed!\", __FUNCTION__, r->Link.timeout); } } setsockopt(r->m_sb.sb_socket, SOL_SOCKET, SO_NOSIGPIPE, (char *) &on, sizeof(on)); setsockopt(r->m_sb.sb_socket, IPPROTO_TCP, TCP_NODELAY, (char *) &on, sizeof(on)); return TRUE; } ä»£ç ç‰‡æ®µåˆ†æ1 int on = 1;// setsockoptå‡½æ•°ä½¿ç”¨ r->m_sb.sb_timedout = FALSE;// è¶…æ—¶æ ‡å¿— r->m_pausing = 0;// æ˜¯å¦æš‚åœçŠ¶æ€ r->m_fDuration = 0.0;// å½“å‰åª’ä½“çš„æ—¶é•¿ ä»£ç ç‰‡æ®µåˆ†æ2 // åˆ›å»ºå¥—æ¥å­— // DEBUG: CCQ: addrinfo->ai_family:2 /* 2ä»£è¡¨`AF_INET`ï¼Œä¹Ÿå°±æ˜¯`PF_INET`ï¼Œå–ä¹‹èŒƒå›´è§ä¸Š`AF_UNSPEC`... */ // DEBUG: CCQ: addrinfo->ai_socktype:1 /* 1ä»£è¡¨`SOCK_STREAM`ï¼Œå–å€¼èŒƒå›´è§ä¸Š`__socket_type` */ // DEBUG: CCQ: addrinfo->ai_protocol:6 /* 6ä»£è¡¨`IPPROTO_TCP`ï¼Œå–ä¹‹èŒƒå›´è§ä¸Š`Ip Protocol` */ r->m_sb.sb_socket = socket(service->ai_family, service->ai_socktype, service->ai_protocol); if (r->m_sb.sb_socket != -1) { // è¿æ¥å¯¹ç«¯ // DEBUG: CCQ: addrinfo->ai_addrlen:16 /* socket address çš„é•¿åº¦ */ // DEBUG: CCQ: addrinfo->ai_addr->sa_family:2 /* 2ä»£è¡¨`AF_INET`ï¼Œä¹Ÿå°±æ˜¯`PF_INET`ï¼Œå–ä¹‹èŒƒå›´è§ä¸Š`AF_UNSPEC`... */ // DEBUG: CCQ: addrinfo->ai_addr->sa_data:\u0007\\217\\300\\250 if (connect(r->m_sb.sb_socket, service->ai_addr, service->ai_addrlen) å†…å®¹æ¥æºäºï¼šhttp://c.biancheng.net/view/2131.html åœ¨ Linux ä¸‹ä½¿ç”¨ å¤´æ–‡ä»¶ä¸­ socket() å‡½æ•°æ¥åˆ›å»ºå¥—æ¥å­—ï¼ŒåŸå‹ä¸ºï¼š int socket(int af, int type, int protocol); 1) af ä¸ºåœ°å€æ—ï¼ˆAddress Familyï¼‰ï¼Œä¹Ÿå°±æ˜¯ IP åœ°å€ç±»å‹ï¼Œå¸¸ç”¨çš„æœ‰ AF_INET å’Œ AF_INET6ã€‚AF æ˜¯â€œAddress Familyâ€çš„ç®€å†™ï¼ŒINETæ˜¯â€œInetnetâ€çš„ç®€å†™ã€‚AF_INET è¡¨ç¤º IPv4 åœ°å€ï¼Œä¾‹å¦‚ 127.0.0.1ï¼›AF_INET6 è¡¨ç¤º IPv6 åœ°å€ï¼Œä¾‹å¦‚ 1030::C9B4:FF12:48AA:1A2Bã€‚ å¤§å®¶éœ€è¦è®°ä½127.0.0.1ï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®ŠIPåœ°å€ï¼Œè¡¨ç¤ºæœ¬æœºåœ°å€ï¼Œåé¢çš„æ•™ç¨‹ä¼šç»å¸¸ç”¨åˆ°ã€‚ ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ PF å‰ç¼€ï¼ŒPF æ˜¯â€œProtocol Familyâ€çš„ç®€å†™ï¼Œå®ƒå’Œ AF æ˜¯ä¸€æ ·çš„ã€‚ä¾‹å¦‚ï¼ŒPF_INET ç­‰ä»·äº AF_INETï¼ŒPF_INET6 ç­‰ä»·äº AF_INET6ã€‚ 2) type ä¸ºæ•°æ®ä¼ è¾“æ–¹å¼/å¥—æ¥å­—ç±»å‹ï¼Œå¸¸ç”¨çš„æœ‰ SOCK_STREAMï¼ˆæµæ ¼å¼å¥—æ¥å­—/é¢å‘è¿æ¥çš„å¥—æ¥å­—ï¼‰ å’Œ SOCK_DGRAMï¼ˆæ•°æ®æŠ¥å¥—æ¥å­—/æ— è¿æ¥çš„å¥—æ¥å­—ï¼‰ï¼Œæˆ‘ä»¬å·²ç»åœ¨ã€Šå¥—æ¥å­—æœ‰å“ªäº›ç±»å‹ã€‹ä¸€èŠ‚ä¸­è¿›è¡Œäº†ä»‹ç»ã€‚ 3) protocol è¡¨ç¤ºä¼ è¾“åè®®ï¼Œå¸¸ç”¨çš„æœ‰ IPPROTO_TCP å’Œ IPPTOTO_UDPï¼Œåˆ†åˆ«è¡¨ç¤º TCP ä¼ è¾“åè®®å’Œ UDP ä¼ è¾“åè®®ã€‚ connect(r->m_sb.sb_socket, service->ai_addr, service->ai_addrlen)æŠ“åŒ…ç»“æœï¼š è¿‡æ»¤æ¡ä»¶ï¼šip.addr eq 81.68.250.191 9833 2261.079011 192.168.1.3 81.68.250.191 TCP 78 51965 â†’ 1935 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=64 TSval=45457028 TSecr=0 SACK_PERM=1 9834 2261.090254 81.68.250.191 192.168.1.3 TCP 74 1935 â†’ 51965 [SYN, ACK] Seq=0 Ack=1 Win=28960 Len=0 MSS=1400 SACK_PERM=1 TSval=2657772015 TSecr=45457028 WS=128 9835 2261.090325 192.168.1.3 81.68.250.191 TCP 66 51965 â†’ 1935 [ACK] Seq=1 Ack=1 Win=131840 Len=0 TSval=45457039 TSecr=2657772015 ä»£ç ç‰‡æ®µåˆ†æ3 // æ‰§è¡ŒSocksåå•† RTMP_Log(RTMP_LOGDEBUG, \"CCQ: r->Link.socksportï¼š%d\", r->Link.socksport); // DEBUG: CCQ: r->Link.socksportï¼š0 if (r->Link.socksport) { RTMP_Log(RTMP_LOGDEBUG, \"%s ... SOCKS negotiation\", __FUNCTION__); if (!SocksNegotiate(r)) { RTMP_Log(RTMP_LOGERROR, \"%s, SOCKS negotiation failed.\", __FUNCTION__); RTMP_Close(r); return FALSE; } } r->Link.socksportï¼š0ï¼Œé¦–æ¬¡ä¸ä¼šæ‰§è¡ŒSocksNegotiateã€‚ ä»£ç ç‰‡æ®µåˆ†æ4 /* set timeout */ { RTMP_Log(RTMP_LOGDEBUG, \"CCQ: r->Link.timeoutï¼š%d\", r->Link.timeout); // DEBUG: CCQ: r->Link.timeoutï¼š30 // #define SET_RCVTIMEO(tv,s) int tv = s*1000 SET_RCVTIMEO(tv, r->Link.timeout); // r->m_sb.sb_socketï¼šæ ‡è¯†ä¸€ä¸ªå¥—æ¥å£çš„æè¿°å­—ï¼ˆRTMP->RTMPSockBuf->sb_socketï¼‰ // SOL_SOCKETï¼šé€‰é¡¹å®šä¹‰çš„å±‚æ¬¡ï¼›ç›®å‰ä»…æ”¯æŒSOL_SOCKETå’ŒIPPROTO_TCPå±‚æ¬¡ã€‚ // SO_RCVTIMEOï¼šæ¥æ”¶è¶…æ—¶ã€‚ // tvï¼šè¶…æ—¶æ—¶é—´ if (setsockopt (r->m_sb.sb_socket, SOL_SOCKET, SO_RCVTIMEO, (char *)&tv, sizeof(tv))) { RTMP_Log(RTMP_LOGERROR, \"%s, Setting socket timeout to %ds failed!\", __FUNCTION__, r->Link.timeout); } } å†…å®¹æ¥æºäºï¼šhttps://www.cnblogs.com/cthon/p/9270778.html SET_RCVTIMEOæ˜¯å®å®šä¹‰ï¼Œç»™tvèµ‹å€¼ï¼Œè¿™é‡Œtvä¸º30*1000ã€‚ ä»£ç ç‰‡æ®µåˆ†æ5 setsockopt(r->m_sb.sb_socket, SOL_SOCKET, SO_NOSIGPIPE, (char *) &on, sizeof(on)); setsockopt(r->m_sb.sb_socket, IPPROTO_TCP, TCP_NODELAY, (char *) &on, sizeof(on)); å†…å®¹æ¥æºäºï¼šhttps://www.cnblogs.com/cthon/p/9270778.html TCP_NODELAYé€‰é¡¹ç¦æ­¢Nagleç®—æ³•ã€‚Nagleç®—æ³•é€šè¿‡å°†æœªç¡®è®¤çš„æ•°æ®å­˜å…¥ç¼“å†²åŒºç›´åˆ°è“„è¶³ä¸€ä¸ªåŒ…ä¸€èµ·å‘é€çš„æ–¹æ³•ï¼Œæ¥å‡å°‘ä¸»æœºå‘é€çš„é›¶ç¢å°æ•°æ®åŒ…çš„æ•°ç›®ã€‚ä½†å¯¹äºæŸäº›åº”ç”¨æ¥è¯´ï¼Œè¿™ç§ç®—æ³•å°†é™ä½ç³»ç»Ÿæ€§èƒ½ã€‚æ‰€ä»¥TCP_NODELAYå¯ç”¨æ¥å°†æ­¤ç®—æ³•å…³é—­ã€‚åº”ç”¨ç¨‹åºç¼–å†™è€…åªæœ‰åœ¨ç¡®åˆ‡äº†è§£å®ƒçš„æ•ˆæœå¹¶ç¡®å®éœ€è¦çš„æƒ…å†µä¸‹ï¼Œæ‰è®¾ç½®TCP_NODELAYé€‰é¡¹ï¼Œå› ä¸ºè®¾ç½®åå¯¹ç½‘ç»œæ€§èƒ½æœ‰æ˜æ˜¾çš„è´Ÿé¢å½±å“ã€‚TCP_NODELAYæ˜¯å”¯ä¸€ä½¿ç”¨IPPROTO_TCPå±‚çš„é€‰é¡¹ï¼Œå…¶ä»–æ‰€æœ‰é€‰é¡¹éƒ½ä½¿ç”¨SOL_SOCKETå±‚ã€‚ å†…å®¹æ¥æºäºï¼šhttp://www.sinohandset.com/mac-osx%E4%B8%8Bso_nosigpipe%E7%9A%84%E6%80%AA%E5%BC%82%E8%A1%A8%E7%8E%B0 åœ¨linuxä¸‹ä¸ºäº†é¿å…ç½‘ç»œå‡ºé”™å¼•èµ·ç¨‹åºé€€å‡ºï¼Œæˆ‘ä»¬ä¸€èˆ¬é‡‡ç”¨MSG_NOSIGNALæ¥é¿å…ç³»ç»Ÿå‘é€singalã€‚è¿™ç§é”™è¯¯ä¸€èˆ¬å‘é€åœ¨ç½‘ç»œæ–­å¼€ï¼Œä½†æ˜¯ç¨‹åºä»ç„¶å‘é€æ•°æ®æ—¶ï¼Œåœ¨æ¥æ”¶æ—¶ï¼Œæ²¡æœ‰å¿…è¦ä½¿ç”¨ã€‚ä½†æ˜¯åœ¨linuxä¸‹ï¼Œä½¿ç”¨æ­¤å‚æ•°ï¼Œä¹Ÿä¸ä¼šå¼•èµ·ä¸å¥½çš„ç»“æœã€‚ RTMP_Connect1 int RTMP_Connect1(RTMP *r, RTMPPacket *cp) { if (r->Link.protocol & RTMP_FEATURE_SSL) { #if defined(CRYPTO) && !defined(NO_SSL) TLS_client(RTMP_TLS_ctx, r->m_sb.sb_ssl); TLS_setfd(r->m_sb.sb_ssl, r->m_sb.sb_socket); if (TLS_connect(r->m_sb.sb_ssl) Link.protocol & RTMP_FEATURE_HTTP) { r->m_msgCounter = 1; r->m_clientID.av_val = NULL; r->m_clientID.av_len = 0; HTTP_Post(r, RTMPT_OPEN, \"\", 1); if (HTTP_read(r, 1) != 0) { r->m_msgCounter = 0; RTMP_Log(RTMP_LOGDEBUG, \"%s, Could not connect for handshake\", __FUNCTION__); RTMP_Close(r); return 0; } r->m_msgCounter = 0; } RTMP_Log(RTMP_LOGDEBUG, \"%s, ... connected, handshaking\", __FUNCTION__); if (!HandShake(r, TRUE)) { RTMP_Log(RTMP_LOGERROR, \"%s, handshake failed.\", __FUNCTION__); RTMP_Close(r); return FALSE; } RTMP_Log(RTMP_LOGDEBUG, \"%s, handshaked\", __FUNCTION__); if (!SendConnectPacket(r, cp)) { RTMP_Log(RTMP_LOGERROR, \"%s, RTMP connect failed.\", __FUNCTION__); RTMP_Close(r); return FALSE; } return TRUE; } ä»£ç ç‰‡æ®µåˆ†æ1 RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s, r->Link.protocol:%d\", __FUNCTION__, r->Link.protocol); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s, RTMP_FEATURE_SSL:%d\", __FUNCTION__, RTMP_FEATURE_SSL); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s, r->Link.protocol & RTMP_FEATURE_SSL:%d\", __FUNCTION__, r->Link.protocol & RTMP_FEATURE_SSL); // DEBUG: CCQ: RTMP_Connect1, r->Link.protocol:16 // DEBUG: CCQ: RTMP_Connect1, RTMP_FEATURE_SSL:4 // #define RTMP_FEATURE_SSL 0x04 // DEBUG: CCQ: RTMP_Connect1, r->Link.protocol & RTMP_FEATURE_SSL:0 if (r->Link.protocol & RTMP_FEATURE_SSL) { #if defined(CRYPTO) && !defined(NO_SSL) TLS_client(RTMP_TLS_ctx, r->m_sb.sb_ssl); TLS_setfd(r->m_sb.sb_ssl, r->m_sb.sb_socket); if (TLS_connect(r->m_sb.sb_ssl) 1.ä¸ºä»€ä¹ˆr->Link.protocol=16ï¼Ÿ #define RTMP_FEATURE_WRITE 0x10 /* publish, not play */ void RTMP_EnableWrite(RTMP *r) { r->Link.protocol |= RTMP_FEATURE_WRITE; } RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s, r->Link.protocol1:%d\", __FUNCTION__, _rtmp->Link.protocol); // DEBUG: CCQ: -[RTMPPusher connectWithURL:], r->Link.protocol1:0 RTMP_EnableWrite(_rtmp); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s, r->Link.protocol2:%d\", __FUNCTION__, _rtmp->Link.protocol); // DEBUG: CCQ: -[RTMPPusher connectWithURL:], r->Link.protocol2:16 2.r->Link.protocol & RTMP_FEATURE_SSLä¸º0ï¼Œä¸ä¼šæ‰§è¡Œifåçš„ä»£ç ã€‚ ä»£ç ç‰‡æ®µåˆ†æ2 RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s, r->Link.protocol & RTMP_FEATURE_HTTP:%d\", __FUNCTION__, r->Link.protocol & RTMP_FEATURE_HTTP); // DEBUG: CCQ: RTMP_Connect1, r->Link.protocol & RTMP_FEATURE_HTTP:0 if (r->Link.protocol & RTMP_FEATURE_HTTP) { r->m_msgCounter = 1; r->m_clientID.av_val = NULL; r->m_clientID.av_len = 0; HTTP_Post(r, RTMPT_OPEN, \"\", 1); if (HTTP_read(r, 1) != 0) { r->m_msgCounter = 0; RTMP_Log(RTMP_LOGDEBUG, \"%s, Could not connect for handshake\", __FUNCTION__); RTMP_Close(r); return 0; } r->m_msgCounter = 0; } RTMP_Log(RTMP_LOGDEBUG, \"%s, ... connected, handshaking\", __FUNCTION__); r->Link.protocol & RTMP_FEATURE_HTTPä¸º0ï¼Œä¸ä¼šæ‰§è¡Œifåçš„ä»£ç ã€‚è¿æ¥æˆåŠŸï¼Œå¼€å§‹æ‰§è¡Œhandshakingã€‚ ä»£ç ç‰‡æ®µ3 // è¿›è¡ŒHandShake if (!HandShake(r, TRUE)) { RTMP_Log(RTMP_LOGERROR, \"%s, handshake failed.\", __FUNCTION__); RTMP_Close(r); return FALSE; } RTMP_Log(RTMP_LOGDEBUG, \"%s, handshaked\", __FUNCTION__); connect(r->m_sb.sb_socket, service->ai_addr, service->ai_addrlen)ï¼š 14 6.159961 192.168.1.3 81.68.250.191 TCP 78 52049 â†’ 1935 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=64 TSval=1695460720 TSecr=0 SACK_PERM=1 15 6.177631 81.68.250.191 192.168.1.3 TCP 74 1935 â†’ 52049 [SYN, ACK] Seq=0 Ack=1 Win=28960 Len=0 MSS=1400 SACK_PERM=1 TSval=2658240513 TSecr=1695460720 WS=128 16 6.177717 192.168.1.3 81.68.250.191 TCP 66 52049 â†’ 1935 [ACK] Seq=1 Ack=1 Win=131840 Len=0 TSval=1695460737 TSecr=2658240513 HandShakeï¼š 17 6.177792 192.168.1.3 81.68.250.191 TCP 1454 52049 â†’ 1935 [ACK] Seq=1 Ack=1 Win=131840 Len=1388 TSval=1695460737 TSecr=2658240513 18 6.177793 192.168.1.3 81.68.250.191 RTMP 215 Handshake C0+C1 19 6.186903 81.68.250.191 192.168.1.3 TCP 66 1935 â†’ 52049 [ACK] Seq=1 Ack=1538 Win=32128 Len=0 TSval=2658240524 TSecr=1695460737 20 6.187494 81.68.250.191 192.168.1.3 TCP 1454 1935 â†’ 52049 [ACK] Seq=1 Ack=1538 Win=32128 Len=1388 TSval=2658240524 TSecr=1695460737 21 6.187498 81.68.250.191 192.168.1.3 TCP 1454 1935 â†’ 52049 [ACK] Seq=1389 Ack=1538 Win=32128 Len=1388 TSval=2658240524 TSecr=1695460737 22 6.187499 81.68.250.191 192.168.1.3 RTMP 363 Handshake S0+S1+S2 23 6.187559 192.168.1.3 81.68.250.191 TCP 66 52049 â†’ 1935 [ACK] Seq=1538 Ack=3074 Win=128768 Len=0 TSval=1695460746 TSecr=2658240524 24 6.187636 192.168.1.3 81.68.250.191 TCP 1454 52049 â†’ 1935 [ACK] Seq=1538 Ack=3074 Win=131072 Len=1388 TSval=1695460746 TSecr=2658240524 25 6.187636 192.168.1.3 81.68.250.191 RTMP 214 Handshake C2 26 6.195197 81.68.250.191 192.168.1.3 TCP 66 1935 â†’ 52049 [ACK] Seq=3074 Ack=3074 Win=35200 Len=0 TSval=2658240532 TSecr=1695460746 ä»£ç ç‰‡æ®µ4 // /*æ¡æ‰‹æˆåŠŸä¹‹åï¼Œå‘é€Connect Packet*/ if (!SendConnectPacket(r, cp)) { RTMP_Log(RTMP_LOGERROR, \"%s, RTMP connect failed.\", __FUNCTION__); RTMP_Close(r); return FALSE; } "},"pages/librtmp/librtmpæºç ä¹‹HandShake.html":{"url":"pages/librtmp/librtmpæºç ä¹‹HandShake.html","title":"librtmpæºç ä¹‹HandShake","keywords":"","body":"librttmpæºç ä¹‹HandShake HandShake static int HandShake(RTMP * r, int FP9HandShake) { RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s start\", __FUNCTION__); int i, offalg = 0; int dhposClient = 0; int digestPosClient = 0; int encrypted = r->Link.protocol & RTMP_FEATURE_ENC; RC4_handle keyIn = 0; RC4_handle keyOut = 0; int32_t *ip; uint32_t uptime; uint8_t clientbuf[RTMP_SIG_SIZE + 4], *clientsig=clientbuf+4; uint8_t serversig[RTMP_SIG_SIZE], client2[RTMP_SIG_SIZE], *reply; uint8_t type; getoff *getdh = NULL, *getdig = NULL; if (encrypted || r->Link.SWFSize) FP9HandShake = TRUE; else FP9HandShake = FALSE; r->Link.rc4keyIn = r->Link.rc4keyOut = 0; if (encrypted) { clientsig[-1] = 0x06; /* 0x08 is RTMPE as well */ offalg = 1; } else clientsig[-1] = 0x03; uptime = htonl(RTMP_GetTime()); memcpy(clientsig, &uptime, 4); if (FP9HandShake) { /* set version to at least 9.0.115.0 */ if (encrypted) { clientsig[4] = 128; clientsig[6] = 3; } else { clientsig[4] = 10; clientsig[6] = 45; } clientsig[5] = 0; clientsig[7] = 2; RTMP_Log(RTMP_LOGDEBUG, \"%s: Client type: %02X\", __FUNCTION__, clientsig[-1]); getdig = digoff[offalg]; getdh = dhoff[offalg]; } else { memset(&clientsig[4], 0, 4); } /* generate random data */ #ifdef _DEBUG memset(clientsig+8, 0, RTMP_SIG_SIZE-8); #else ip = (int32_t *)(clientsig+8); for (i = 2; i Link.dh = DHInit(1024); if (!r->Link.dh) { RTMP_Log(RTMP_LOGERROR, \"%s: Couldn't initialize Diffie-Hellmann!\", __FUNCTION__); return FALSE; } dhposClient = getdh(clientsig, RTMP_SIG_SIZE); RTMP_Log(RTMP_LOGDEBUG, \"%s: DH pubkey position: %d\", __FUNCTION__, dhposClient); if (!DHGenerateKey(r->Link.dh)) { RTMP_Log(RTMP_LOGERROR, \"%s: Couldn't generate Diffie-Hellmann public key!\", __FUNCTION__); return FALSE; } if (!DHGetPublicKey(r->Link.dh, &clientsig[dhposClient], 128)) { RTMP_Log(RTMP_LOGERROR, \"%s: Couldn't write public key!\", __FUNCTION__); return FALSE; } } digestPosClient = getdig(clientsig, RTMP_SIG_SIZE); /* reuse this value in verification */ RTMP_Log(RTMP_LOGDEBUG, \"%s: Client digest offset: %d\", __FUNCTION__, digestPosClient); CalculateDigest(digestPosClient, clientsig, GenuineFPKey, 30, &clientsig[digestPosClient]); RTMP_Log(RTMP_LOGDEBUG, \"%s: Initial client digest: \", __FUNCTION__); RTMP_LogHex(RTMP_LOGDEBUG, clientsig + digestPosClient, SHA256_DIGEST_LENGTH); } #ifdef _DEBUG RTMP_Log(RTMP_LOGDEBUG, \"Clientsig: \"); RTMP_LogHex(RTMP_LOGDEBUG, clientsig, RTMP_SIG_SIZE); #endif if (!WriteN(r, (char *)clientsig-1, RTMP_SIG_SIZE + 1)) return FALSE; if (ReadN(r, (char *)&type, 1) != 1) /* 0x03 or 0x06 */ return FALSE; RTMP_Log(RTMP_LOGDEBUG, \"%s: Type Answer : %02X\", __FUNCTION__, type); if (type != clientsig[-1]) RTMP_Log(RTMP_LOGWARNING, \"%s: Type mismatch: client sent %d, server answered %d\", __FUNCTION__, clientsig[-1], type); if (ReadN(r, (char *)serversig, RTMP_SIG_SIZE) != RTMP_SIG_SIZE) return FALSE; /* decode server response */ memcpy(&uptime, serversig, 4); uptime = ntohl(uptime); RTMP_Log(RTMP_LOGDEBUG, \"%s: Server Uptime : %d\", __FUNCTION__, uptime); RTMP_Log(RTMP_LOGDEBUG, \"%s: FMS Version : %d.%d.%d.%d\", __FUNCTION__, serversig[4], serversig[5], serversig[6], serversig[7]); if (FP9HandShake && type == 3 && !serversig[4]) FP9HandShake = FALSE; #ifdef _DEBUG RTMP_Log(RTMP_LOGDEBUG, \"Server signature:\"); RTMP_LogHex(RTMP_LOGDEBUG, serversig, RTMP_SIG_SIZE); #endif if (FP9HandShake) { uint8_t digestResp[SHA256_DIGEST_LENGTH]; uint8_t *signatureResp = NULL; /* we have to use this signature now to find the correct algorithms for getting the digest and DH positions */ int digestPosServer = getdig(serversig, RTMP_SIG_SIZE); if (!VerifyDigest(digestPosServer, serversig, GenuineFMSKey, 36)) { RTMP_Log(RTMP_LOGWARNING, \"Trying different position for server digest!\"); offalg ^= 1; getdig = digoff[offalg]; getdh = dhoff[offalg]; digestPosServer = getdig(serversig, RTMP_SIG_SIZE); if (!VerifyDigest(digestPosServer, serversig, GenuineFMSKey, 36)) { RTMP_Log(RTMP_LOGERROR, \"Couldn't verify the server digest\"); /* continuing anyway will probably fail */ return FALSE; } } /* generate SWFVerification token (SHA256 HMAC hash of decompressed SWF, key are the last 32 bytes of the server handshake) */ if (r->Link.SWFSize) { const char swfVerify[] = { 0x01, 0x01 }; char *vend = r->Link.SWFVerificationResponse+sizeof(r->Link.SWFVerificationResponse); memcpy(r->Link.SWFVerificationResponse, swfVerify, 2); AMF_EncodeInt32(&r->Link.SWFVerificationResponse[2], vend, r->Link.SWFSize); AMF_EncodeInt32(&r->Link.SWFVerificationResponse[6], vend, r->Link.SWFSize); HMACsha256(r->Link.SWFHash, SHA256_DIGEST_LENGTH, &serversig[RTMP_SIG_SIZE - SHA256_DIGEST_LENGTH], SHA256_DIGEST_LENGTH, (uint8_t *)&r->Link.SWFVerificationResponse[10]); } /* do Diffie-Hellmann Key exchange for encrypted RTMP */ if (encrypted) { /* compute secret key */ uint8_t secretKey[128] = { 0 }; int len, dhposServer; dhposServer = getdh(serversig, RTMP_SIG_SIZE); RTMP_Log(RTMP_LOGDEBUG, \"%s: Server DH public key offset: %d\", __FUNCTION__, dhposServer); len = DHComputeSharedSecretKey(r->Link.dh, &serversig[dhposServer], 128, secretKey); if (len Link.rc4keyIn = keyIn; r->Link.rc4keyOut = keyOut; /* update the keystreams */ if (r->Link.rc4keyIn) { RC4_encrypt(r->Link.rc4keyIn, RTMP_SIG_SIZE, (uint8_t *) buff); } if (r->Link.rc4keyOut) { RC4_encrypt(r->Link.rc4keyOut, RTMP_SIG_SIZE, (uint8_t *) buff); } } } else { if (memcmp(serversig, clientsig, RTMP_SIG_SIZE) != 0) { RTMP_Log(RTMP_LOGWARNING, \"%s: client signature does not match!\", __FUNCTION__); } } RTMP_Log(RTMP_LOGDEBUG, \"%s: Handshaking finished....\", __FUNCTION__); return TRUE; } ä»£ç ç‰‡æ®µåˆ†æ1 int i, offalg = 0;// offalgåŠ å¯†æ‰ä½¿ç”¨ int dhposClient = 0;// åŠ å¯†æ‰ä½¿ç”¨ int digestPosClient = 0;// åŠ å¯†æ‰ä½¿ç”¨ int encrypted = r->Link.protocol & RTMP_FEATURE_ENC; RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s encrypted:%d\", __FUNCTION__, encrypted); // DEBUG: CCQ: HandShake encrypted:0 // ä¸åŠ å¯† RC4_handle keyIn = 0;// åŠ å¯†æ‰ä½¿ç”¨ RC4_handle keyOut = 0;// åŠ å¯†æ‰ä½¿ç”¨ int32_t *ip;/* generate random data */ uint32_t uptime;// å½“å‰æ—¶é—´ï¼Œå¡«å……C1å‰4å­—èŠ‚ ä»£ç ç‰‡æ®µåˆ†æ2 RC4_handle keyIn = 0;// åŠ å¯†æ‰ä½¿ç”¨ RC4_handle keyOut = 0;// åŠ å¯†æ‰ä½¿ç”¨ int32_t *ip;/* generate random data */ uint32_t uptime;// å½“å‰æ—¶é—´ï¼Œå¡«å……C1å‰4å­—èŠ‚ // #define RTMP_SIG_SIZE 1536:C1å’ŒS1æ¶ˆæ¯æœ‰1536å­—èŠ‚é•¿ uint8_t clientbuf[RTMP_SIG_SIZE + 4], *clientsig=clientbuf+4; uint8_t serversig[RTMP_SIG_SIZE], client2[RTMP_SIG_SIZE], *reply;// reply,client2åŠ å¯†æ‰ä½¿ç”¨ uint8_t type;// ReadN(r, (char *)&type, 1)ä¹‹åè·å¾— getoff *getdh = NULL, *getdig = NULL;// åŠ å¯†æ‰ä½¿ç”¨ ä»£ç ç‰‡æ®µåˆ†æ3 if (encrypted || r->Link.SWFSize) FP9HandShake = TRUE; else //æ™®é€šçš„ FP9HandShake = FALSE; r->Link.rc4keyIn = r->Link.rc4keyOut = 0;// åŠ å¯†æ‰ä½¿ç”¨ /*C0 å­—æ®µå·²ç»å†™å…¥clientsig*/ if (encrypted) { clientsig[-1] = 0x06; /* 0x08 is RTMPE as well */ offalg = 1; } else //0x03ä»£è¡¨RTMPåè®®çš„ç‰ˆæœ¬ï¼ˆå®¢æˆ·ç«¯è¦æ±‚çš„ï¼‰ //æ•°ç»„ç«Ÿç„¶èƒ½æœ‰â€œ-1â€ä¸‹æ ‡,å› ä¸ºclientsigæŒ‡å‘çš„æ˜¯clientbuf+4,æ‰€ä»¥ä¸å­˜åœ¨éæ³•åœ°å€ //C0ä¸­çš„å­—æ®µ(1B) clientsig[-1] = 0x03; uptime = htonl(RTMP_GetTime()); //void *memcpy(void *dest, const void *src, int n); //ç”±srcæŒ‡å‘åœ°å€ä¸ºèµ·å§‹åœ°å€çš„è¿ç»­nä¸ªå­—èŠ‚çš„æ•°æ®å¤åˆ¶åˆ°ä»¥destæŒ‡å‘åœ°å€ä¸ºèµ·å§‹åœ°å€çš„ç©ºé—´å†… //æŠŠuptimeçš„å‰4å­—èŠ‚ï¼ˆå…¶å®ä¸€å…±å°±4å­—èŠ‚ï¼‰æ•°æ®æ‹·è´åˆ°clientsigæŒ‡å‘çš„åœ°å€ä¸­ //C1ä¸­çš„å­—æ®µ(4B) // â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” // ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œé›·éœ„éª…ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚ // åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/leixiaohua1020/article/details/12954329 memcpy(clientsig, &uptime, 4); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: uptime: \"); RTMP_LogHexString(RTMP_LOGDEBUG, clientsig, 4); // DEBUG: Clientsig: // DEBUG: 0000: 0c b7 58 56 ..XV clientsig[-1] = 0x03;å°†RTMPåè®®çš„ç‰ˆæœ¬å·å†™å…¥ï¼Œ1å­—èŠ‚ã€‚ memcpy(clientsig, &uptime, 4);å°†å½“å‰æ—¶é—´å†™å…¥clientsigï¼Œ4å­—èŠ‚ã€‚ ä»£ç ç‰‡æ®µåˆ†æ4 if (FP9HandShake)// åŠ å¯†æ‰å¤„ç† { /* set version to at least 9.0.115.0 */ if (encrypted) { clientsig[4] = 128; clientsig[6] = 3; } else { clientsig[4] = 10; clientsig[6] = 45; } clientsig[5] = 0; clientsig[7] = 2; RTMP_Log(RTMP_LOGDEBUG, \"%s: Client type: %02X\", __FUNCTION__, clientsig[-1]); getdig = digoff[offalg]; getdh = dhoff[offalg]; } else { memset(&clientsig[4], 0, 4); } memset(&clientsig[4], 0, 4);å½“å‰æ—¶é—´çš„åè¡¥0ï¼Œå 4å­—èŠ‚ã€‚ ä»£ç ç‰‡æ®µåˆ†æ5 /* generate random data */ #ifdef _DEBUG //å°†clientsig+8å¼€å§‹çš„1528ä¸ªå­—èŠ‚æ›¿æ¢ä¸º0ï¼ˆè¿™æ˜¯ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼‰ //è¿™æ˜¯C1ä¸­çš„randomå­—æ®µ memset(clientsig+8, 0, RTMP_SIG_SIZE-8); #else //å®é™…ä¸­ä½¿ç”¨rand()å¾ªç¯ç”Ÿæˆ1528å­—èŠ‚çš„ä¼ªéšæœºæ•° ip = (int32_t *)(clientsig+8); for (i = 2; i æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œå¾—çŸ¥clientsigçš„-1ä½ç½®å­˜æ”¾è¿™0x03ï¼ˆRTMPï¼‰çš„ç‰ˆæœ¬å·ï¼Œå 1å­—èŠ‚ï¼›0-4ä½ç½®å­˜æ”¾è¿™å½“å‰æ—¶é—´uptimeï¼Œå 4å­—èŠ‚ï¼›ä¹‹å5-8ä½ç½®è¡¥0ï¼Œå 4å­—èŠ‚ï¼›è€Œclientsigçš„æ€»é•¿åº¦æ˜¯1536ä¸ªå­—èŠ‚ï¼Œå·²ç»å ç”¨äº†8å­—èŠ‚ï¼Œæ‰€ä»¥ä¸Šé¢ä»£ç æ˜¯åœ¨è¡¥å…¨å‰©ä¸‹çš„1528ä¸ªå­—èŠ‚ï¼Œè¡¥å…¨çš„æ–¹å¼æ˜¯ä½¿ç”¨éšæœºæ•°ã€‚ ä»£ç ç‰‡æ®µåˆ†æ5 #ifdef _DEBUG RTMP_Log(RTMP_LOGDEBUG, \"Clientsig: \"); RTMP_LogHex(RTMP_LOGDEBUG, clientsig, RTMP_SIG_SIZE); #endif RTMP_Log(RTMP_LOGDEBUG, \"CCQ: Clientsig: \"); RTMP_LogHexString(RTMP_LOGDEBUG, clientsig, RTMP_SIG_SIZE); //å‘é€æ•°æ®æŠ¥C0+C1 //ä»clientsig-1å¼€å§‹å‘ï¼Œé•¿åº¦1536+1ï¼Œä¸¤ä¸ªåŒ…åˆå¹¶ //æ¡æ‰‹---------------- RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å»ºç«‹è¿æ¥ï¼šç¬¬1æ¬¡è¿æ¥ã€‚å‘é€æ¡æ‰‹æ•°æ®C0+C1\", __FUNCTION__); if (!WriteN(r, (char *)clientsig-1, RTMP_SIG_SIZE + 1)) return FALSE; //è¯»å–æ•°æ®æŠ¥ï¼Œé•¿åº¦1ï¼Œå­˜å…¥type //æ˜¯æœåŠ¡å™¨çš„S0ï¼Œè¡¨ç¤ºæœåŠ¡å™¨ä½¿ç”¨çš„RTMPç‰ˆæœ¬ if (ReadN(r, (char *)&type, 1) != 1) /* 0x03 or 0x06 */ return FALSE; RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å»ºç«‹è¿æ¥ï¼šç¬¬1æ¬¡è¿æ¥ã€‚æ¥æ”¶æ¡æ‰‹æ•°æ®S0\", __FUNCTION__); RTMP_Log(RTMP_LOGDEBUG, \"%s: Type Answer : %02X\", __FUNCTION__, type); //å®¢æˆ·ç«¯è¦æ±‚çš„ç‰ˆæœ¬å’ŒæœåŠ¡å™¨æä¾›çš„ç‰ˆæœ¬ä¸åŒ if (type != clientsig[-1]) RTMP_Log(RTMP_LOGWARNING, \"%s: Type mismatch: client sent %d, server answered %d\", __FUNCTION__, clientsig[-1], type); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å»ºç«‹è¿æ¥ï¼šç¬¬1æ¬¡è¿æ¥ã€‚æ¥æ”¶æ¡æ‰‹æ•°æ®S1\", __FUNCTION__); //å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éšæœºåºåˆ—é•¿åº¦æ˜¯å¦ç›¸åŒ if (ReadN(r, (char *)serversig, RTMP_SIG_SIZE) != RTMP_SIG_SIZE) return FALSE; RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å»ºç«‹è¿æ¥ï¼šç¬¬1æ¬¡è¿æ¥ã€‚æ¥æ”¶æ¡æ‰‹æ•°æ®S1\", __FUNCTION__); /* decode server response */ //æŠŠserversigçš„å‰å››ä¸ªå­—èŠ‚èµ‹å€¼ç»™uptime memcpy(&uptime, serversig, 4); uptime = ntohl(uptime);//å¤§ç«¯è½¬å°ç«¯ RTMP_Log(RTMP_LOGDEBUG, \"%s: Server Uptime : %d\", __FUNCTION__, uptime); RTMP_Log(RTMP_LOGDEBUG, \"%s: FMS Version : %d.%d.%d.%d\", __FUNCTION__, serversig[4], serversig[5], serversig[6], serversig[7]); å†…å®¹æ¥æºäºï¼šhttps://blog.csdn.net/bwangk/article/details/112802823 C0 å’Œ S0æ¶ˆæ¯æ ¼å¼ï¼šC0å’ŒS0æ˜¯å•ç‹¬çš„ä¸€ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚ åœ¨C0ä¸­è¿™ä¸ªå­—æ®µè¡¨ç¤ºå®¢æˆ·ç«¯è¦æ±‚çš„RTMPç‰ˆæœ¬ ã€‚åœ¨S0ä¸­è¿™ä¸ªå­—æ®µè¡¨ç¤ºæœåŠ¡å™¨é€‰æ‹©çš„RTMPç‰ˆæœ¬ã€‚æœ¬è§„èŒƒæ‰€å®šä¹‰çš„ç‰ˆæœ¬æ˜¯3ï¼›0-2æ˜¯æ—©æœŸäº§å“æ‰€ç”¨çš„ï¼Œå·²è¢«ä¸¢å¼ƒï¼›4-31ä¿ç•™åœ¨æœªæ¥ä½¿ç”¨ ï¼›32-255ä¸å…è®¸ä½¿ç”¨ ï¼ˆä¸ºäº†åŒºåˆ†å…¶ä»–ä»¥æŸä¸€å­—ç¬¦å¼€å§‹çš„æ–‡æœ¬åè®®ï¼‰ã€‚å¦‚æœæœåŠ¡æ— æ³•è¯†åˆ«å®¢æˆ·ç«¯è¯·æ±‚çš„ç‰ˆæœ¬ï¼Œåº”è¯¥è¿”å›3 ã€‚å®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©å‡åˆ°ç‰ˆæœ¬3æˆ–é€‰æ‹©å–æ¶ˆæ¡æ‰‹ C1 å’Œ S1æ¶ˆæ¯æ ¼å¼ï¼šC1å’ŒS1æ¶ˆæ¯æœ‰1536å­—èŠ‚é•¿ã€‚ æ—¶é—´ï¼š4å­—èŠ‚ï¼šæœ¬å­—æ®µåŒ…å«æ—¶é—´æˆ³ã€‚è¯¥æ—¶é—´æˆ³åº”è¯¥æ˜¯å‘é€è¿™ä¸ªæ•°æ®å—çš„ç«¯ç‚¹çš„åç»­å—çš„æ—¶é—´èµ·å§‹ç‚¹ã€‚å¯ä»¥æ˜¯0ï¼Œæˆ–å…¶ä»–çš„ä»»ä½•å€¼ã€‚ä¸ºäº†åŒæ­¥å¤šä¸ªæµï¼Œç«¯ç‚¹å¯èƒ½å‘é€å…¶å—æµçš„å½“å‰å€¼ã€‚ é›¶ï¼š4å­—èŠ‚ï¼šæœ¬å­—æ®µå¿…é¡»æ˜¯å…¨é›¶ã€‚ éšæœºæ•°æ®ï¼š1528å­—èŠ‚ã€‚æœ¬å­—æ®µå¯ä»¥åŒ…å«ä»»ä½•å€¼ã€‚å› ä¸ºæ¯ä¸ªç«¯ç‚¹å¿…é¡»ç”¨è‡ªå·±åˆå§‹åŒ–çš„æ¡æ‰‹å’Œå¯¹ç«¯åˆå§‹åŒ–çš„æ¡æ‰‹æ¥åŒºåˆ†èº«ä»½ï¼Œæ‰€ä»¥è¿™ä¸ªæ•°æ®åº”æœ‰å……åˆ†çš„éšæœºæ€§ã€‚ä½†æ˜¯å¹¶ä¸éœ€è¦åŠ å¯†å®‰å…¨çš„éšæœºå€¼ï¼Œæˆ–è€…åŠ¨æ€å€¼ã€‚ C2 å’Œ S2 æ¶ˆæ¯æ ¼å¼ï¼šC2å’ŒS2æ¶ˆæ¯æœ‰1536å­—èŠ‚é•¿ï¼Œåªæ˜¯S1å’ŒC1çš„å›å¤ã€‚ æ—¶é—´ï¼š4å­—èŠ‚ï¼šæœ¬å­—æ®µå¿…é¡»åŒ…å«å¯¹ç­‰æ®µå‘é€çš„æ—¶é—´ï¼ˆå¯¹C2æ¥è¯´æ˜¯S1ï¼Œå¯¹S2æ¥è¯´æ˜¯C1ï¼‰ã€‚ æ—¶é—´2ï¼š4å­—èŠ‚ï¼šæœ¬å­—æ®µå¿…é¡»åŒ…å«å…ˆå‰å‘é€çš„å¹¶è¢«å¯¹ç«¯è¯»å–çš„åŒ…çš„æ—¶é—´æˆ³ã€‚ éšæœºå›å¤ï¼š1528å­—èŠ‚ï¼šæœ¬å­—æ®µå¿…é¡»åŒ…å«å¯¹ç«¯å‘é€çš„éšæœºæ•°æ®å­—æ®µï¼ˆå¯¹C2æ¥è¯´æ˜¯S1ï¼Œå¯¹S2æ¥è¯´æ˜¯C1ï¼‰ã€‚æ¯ä¸ªå¯¹ç­‰ç«¯å¯ä»¥ç”¨æ—¶é—´å’Œæ—¶é—´2å­—æ®µä¸­çš„æ—¶é—´æˆ³æ¥å¿«é€Ÿåœ°ä¼°è®¡å¸¦å®½å’Œå»¶è¿Ÿã€‚ä½†è¿™æ ·åšå¯èƒ½å¹¶ä¸å®ç”¨ã€‚ ä¸Šé¢ä»£ç çš„åŠŸèƒ½ç®€å•è¯´ï¼šå‘é€C0+C1ï¼Œè§£æS0ã€S1ã€‚ ä»£ç ç‰‡æ®µåˆ†æ6 #ifdef _DEBUG RTMP_Log(RTMP_LOGDEBUG, \"Server signature:\"); RTMP_LogHex(RTMP_LOGDEBUG, serversig, RTMP_SIG_SIZE); #endif RTMP_Log(RTMP_LOGDEBUG, \"CCQ: Server signature:\"); RTMP_LogHexString(RTMP_LOGDEBUG, serversig, RTMP_SIG_SIZE); if (FP9HandShake) {} else { RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s reply = serversig\", __FUNCTION__); //ç›´æ¥èµ‹å€¼ reply = serversig; #if 0 uptime = htonl(RTMP_GetTime()); memcpy(reply+4, &uptime, 4); #endif } ä»£ç ç‰‡æ®µåˆ†æ7 #ifdef _DEBUG RTMP_Log(RTMP_LOGDEBUG, \"%s: Sending handshake response: \", __FUNCTION__); RTMP_LogHex(RTMP_LOGDEBUG, reply, RTMP_SIG_SIZE); #endif //æŠŠreplyä¸­çš„1536å­—èŠ‚æ•°æ®å‘é€å‡ºå» //å¯¹åº”C2 //æ¡æ‰‹---------------- RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å»ºç«‹è¿æ¥ï¼šç¬¬1æ¬¡è¿æ¥ã€‚å‘é€æ¡æ‰‹æ•°æ®C2\", __FUNCTION__); if (!WriteN(r, (char *)reply, RTMP_SIG_SIZE)) return FALSE; /* 2nd part of handshake */ //è¯»å–1536å­—èŠ‚æ•°æ®åˆ°serversig //æ¡æ‰‹---------------- RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å»ºç«‹è¿æ¥ï¼šç¬¬1æ¬¡è¿æ¥ã€‚è¯»å–æ¡æ‰‹æ•°æ®S2\", __FUNCTION__); if (ReadN(r, (char *)serversig, RTMP_SIG_SIZE) != RTMP_SIG_SIZE) return FALSE; #ifdef _DEBUG RTMP_Log(RTMP_LOGDEBUG, \"%s: 2nd handshake: \", __FUNCTION__); RTMP_LogHex(RTMP_LOGDEBUG, serversig, RTMP_SIG_SIZE); #endif RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s: 2nd handshake: \", __FUNCTION__); RTMP_LogHexString(RTMP_LOGDEBUG, serversig, RTMP_SIG_SIZE); if (FP9HandShake)// åŠ å¯†æ‰æ‰§è¡Œ {} else { //int memcmp(const void *buf1, const void *buf2, unsigned int count); å½“buf1=buf2æ—¶ï¼Œè¿”å›å€¼=0 //æ¯”è¾ƒserversigå’Œclientsigæ˜¯å¦ç›¸ç­‰ //æ¡æ‰‹---------------- RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å»ºç«‹è¿æ¥ï¼šç¬¬1æ¬¡è¿æ¥ã€‚æ¯”è¾ƒæ¡æ‰‹æ•°æ®ç­¾å\", __FUNCTION__); if (memcmp(serversig, clientsig, RTMP_SIG_SIZE) != 0) { RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å»ºç«‹è¿æ¥ï¼šç¬¬1æ¬¡è¿æ¥ã€‚æ¡æ‰‹æ•°æ®ç­¾åä¸åŒ¹é…ï¼\", __FUNCTION__); RTMP_Log(RTMP_LOGWARNING, \"%s: client signature does not match!\", __FUNCTION__); } } ä¸Šé¢ä»£ç ç®€å•è¯´ï¼šå‘é€C2ï¼Œè§£æS2ï¼Œå®¢æˆ·ç«¯æˆåŠŸè§£æS2ï¼ŒæœåŠ¡ç«¯æˆåŠŸæ¥æ”¶C2ï¼Œç¬¬ä¸€æ¬¡è¿æ¥æ¡æ‰‹æˆåŠŸã€‚ è‡³æ­¤ï¼ŒHandShakeçš„ä»£ç åˆ†æå®Œæ¯•ã€‚ "},"pages/librtmp/librtmpæºç ä¹‹SendConnectPacket.html":{"url":"pages/librtmp/librtmpæºç ä¹‹SendConnectPacket.html","title":"librtmpæºç ä¹‹SendConnectPacket","keywords":"","body":"librtmpæºç ä¹‹SendConnectPacket ä»£ç ç‰‡æ®µåˆ†æ1 RTMPPacket packet; // pendï¼šAMF_EncodeNamedStringå‡½æ•°å‚æ•° // pbuf: packet.m_body = pbuf + RTMP_MAX_HEADER_SIZE; char pbuf[4096], *pend = pbuf + sizeof(pbuf); char *enc; if (cp) // ä¸ä¼šèµ° return RTMP_SendPacket(r, cp, TRUE); ä»£ç ç‰‡æ®µåˆ†æ2 // chunk stream id(chunk basic header)å­—æ®µ // å—æµIDï¼Œæ¶ˆæ¯å¤´çš„ç¬¬1ä¸ªå­—èŠ‚çš„å6ä½ packet.m_nChannel = 0x03; /* control channel (invoke) */ // #define RTMP_PACKET_SIZE_LARGE 0 onMetaDataæµå¼€å§‹çš„ç»å¯¹æ—¶é—´æˆ³æ§åˆ¶æ¶ˆæ¯ï¼ˆå¦‚connectï¼‰ // #define RTMP_PACKET_SIZE_MEDIUM 1 å¤§éƒ¨åˆ†çš„rtmp headeréƒ½æ˜¯8å­—èŠ‚çš„ // #define RTMP_PACKET_SIZE_SMALL 2 æ¯”è¾ƒå°‘è§ // #define RTMP_PACKET_SIZE_MINIMUM 3 å¶å°”å‡ºç°ï¼Œä½äº8å­—èŠ‚é¢‘ç‡ // chunk type id (2bit)fmt å¯¹åº”message head {0,3,7,11} + (6bit)chunk stream id // å—ç±»å‹IDï¼Œæ¶ˆæ¯å¤´çš„ç¬¬1ä¸ªå­—èŠ‚çš„å‰2ä½ï¼Œå†³å®šæ¶ˆæ¯å¤´é•¿åº¦ packet.m_headerType = RTMP_PACKET_SIZE_LARGE; // æ¶ˆæ¯ç±»å‹ä¸º20çš„ç”¨AMF0ç¼–ç ï¼Œè¿™äº›æ¶ˆæ¯ç”¨äºåœ¨è¿œç«¯å®ç°è¿æ¥ï¼Œåˆ›å»ºæµï¼Œå‘å¸ƒï¼Œæ’­æ”¾å’Œæš‚åœç­‰æ“ä½œ // #define RTMP_PACKET_TYPE_INVOKE 0x14 // Message type IDï¼ˆ1-7åè®®æ§åˆ¶ï¼›8ï¼Œ9éŸ³è§†é¢‘ï¼›10ä»¥åä¸ºAMFç¼–ç æ¶ˆæ¯ï¼‰ // æ¶ˆæ¯ç±»å‹IDï¼Œæ¶ˆæ¯å¤´çš„ç¬¬8ä¸ªå­—èŠ‚ï¼Œ0x14è¡¨ç¤ºä»¥AMF0ç¼–ç ã€‚å¦å¤–è¿˜æœ‰å¦‚0x04è¡¨ç¤ºç”¨æˆ·æ§åˆ¶æ¶ˆæ¯ï¼Œ0x05è¡¨ç¤ºWindow Acknowledgement Sizeï¼Œ0x06è¡¨ç¤º Set Peer Bandwithç­‰ç­‰ã€‚ packet.m_packetType = RTMP_PACKET_TYPE_INVOKE; // æ—¶é—´æ“ï¼Œæ¶ˆæ¯å¤´çš„ç¬¬2-4ä¸ªå­—èŠ‚ packet.m_nTimeStamp = 0; // Stream IDé€šå¸¸ç”¨ä»¥å®ŒæˆæŸäº›ç‰¹å®šçš„å·¥ä½œï¼Œå¦‚ä½¿ç”¨IDä¸º0çš„Streamæ¥å®Œæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„è¿æ¥å’Œæ§åˆ¶ï¼Œä½¿ç”¨IDä¸º1çš„Streamæ¥å®Œæˆè§†é¢‘æµçš„æ§åˆ¶å’Œæ’­æ”¾ç­‰å·¥ä½œã€‚ // æµIDï¼Œæ¶ˆæ¯å¤´çš„ç¬¬9-12ä¸ªå­—èŠ‚ï¼ˆæœ«å°¾æœ€å4ä¸ªå­—èŠ‚ï¼‰ packet.m_nInfoField2 = 0; // æ˜¯å¦å«æœ‰Extend timeStampå­—æ®µ packet.m_hasAbsTimestamp = 0; // #define RTMP_MAX_HEADER_SIZE 18 // è®¾ç½®chunk body(data)çš„èµ·å§‹æŒ‡é’ˆï¼Œå‰18ä¸ªå­—èŠ‚ç”¨æ¥å­˜å‚¨æ¶ˆæ¯å¤´ï¼Œä¹‹åå°±ç”¨æ¥å­˜æ¶ˆæ¯ä½“ packet.m_body = pbuf + RTMP_MAX_HEADER_SIZE; æ¶ˆæ¯å¤´çš„ç¬¬5-7ä¸ªå­—èŠ‚æ˜¯æ”¾çš„æ˜¯bodyçš„é•¿åº¦ï¼Œåé¢ä¼šè®¾ç½®ã€‚ ä»£ç ç‰‡æ®µåˆ†æ3 // æŒ‡é’ˆèµ‹å€¼ï¼Œé€šè¿‡encæ¥è®¾ç½®æ¶ˆæ¯ä½“çš„å†…å®¹ enc = packet.m_body; // å‹å…¥connectå‘½ä»¤å’Œæ“ä½œæµæ°´å· // connectä½¿ç”¨##è¿›è¡Œå­—ç¬¦ä¸²åŒ–è¿æ¥ï¼Œæ­¤å¤„ç¼–ç connectå­—ç¬¦ä¸² enc = AMF_EncodeString(enc, pend, &av_connect); // m_numInvokesï¼š0x14å‘½ä»¤è¿œç¨‹è¿‡ç¨‹è°ƒç”¨è®¡æ•° enc = AMF_EncodeNumber(enc, pend, ++r->m_numInvokes); // å‹å…¥å¯¹è±¡ *enc++ = AMF_OBJECT; // å‹å…¥å¯¹è±¡çš„â€œappâ€å­—ç¬¦ä¸²ï¼Œå®¢æˆ·ç«¯è¿æ¥åˆ°çš„æœåŠ¡å™¨ç«¯åº”ç”¨çš„åå­— enc = AMF_EncodeNamedString(enc, pend, &av_app, &r->Link.app); if (!enc) return FALSE; // å‹å…¥â€œtypeâ€ï¼Œè¿™é‡Œæ˜¯â€œnonprivateâ€ if (r->Link.protocol & RTMP_FEATURE_WRITE) { enc = AMF_EncodeNamedString(enc, pend, &av_type, &av_nonprivate); if (!enc) return FALSE; } // å‹å…¥â€œflashverâ€ï¼ŒFlash Player ç‰ˆæœ¬å·ã€‚å’ŒApplicationScript getversion() æ–¹æ³•è¿”å›çš„æ˜¯åŒä¸€ä¸ªå­—ç¬¦ä¸²ã€‚FMSc/1.0 if (r->Link.flashVer.av_len) { enc = AMF_EncodeNamedString(enc, pend, &av_flashVer, &r->Link.flashVer); if (!enc) return FALSE; } // å‹å…¥â€œswfUrlâ€ï¼Œè¿›è¡Œå½“å‰è¿æ¥çš„ SWF æ–‡ä»¶æºåœ°å€ã€‚file://C:/FlvPlayer.swf if (r->Link.swfUrl.av_len) { enc = AMF_EncodeNamedString(enc, pend, &av_swfUrl, &r->Link.swfUrl); if (!enc) return FALSE; } // å‹å…¥â€œtcUrlâ€ï¼ŒæœåŠ¡å™¨ URLã€‚å…·æœ‰ä»¥ä¸‹æ ¼å¼ï¼šprotocol://servername:port/appName/appInstanceï¼Œrtmp://localhost:1935/testapp/instance1 if (r->Link.tcUrl.av_len) { enc = AMF_EncodeNamedString(enc, pend, &av_tcUrl, &r->Link.tcUrl); if (!enc) return FALSE; } if (!(r->Link.protocol & RTMP_FEATURE_WRITE)) { // å‹å…¥â€œfpadâ€ï¼Œå¦‚æœä½¿ç”¨äº†ä»£ç†å°±æ˜¯ trueã€‚true æˆ–è€… falseã€‚ enc = AMF_EncodeNamedBoolean(enc, pend, &av_fpad, FALSE); if (!enc) return FALSE; enc = AMF_EncodeNamedNumber(enc, pend, &av_capabilities, 15.0); if (!enc) return FALSE; // å‹å…¥â€œaudioCodecsâ€œï¼Œè¡¨æ˜å®¢æˆ·ç«¯æ‰€æ”¯æŒçš„éŸ³é¢‘ç¼–ç ã€‚SUPPORT_SND_MP3 enc = AMF_EncodeNamedNumber(enc, pend, &av_audioCodecs, r->m_fAudioCodecs); if (!enc) return FALSE; // å‹å…¥â€œvideoCodecsâ€ï¼Œè¡¨æ˜æ”¯æŒçš„è§†é¢‘ç¼–ç ã€‚SUPPORT_VID_SORENSON enc = AMF_EncodeNamedNumber(enc, pend, &av_videoCodecs, r->m_fVideoCodecs); if (!enc) return FALSE; // å‹å…¥â€œvideoFunctionâ€ï¼Œè¡¨æ˜æ‰€æ”¯æŒçš„ç‰¹æ®Šè§†é¢‘æ–¹æ³•ã€‚SUPPORT_VID_CLIENT_SEEK enc = AMF_EncodeNamedNumber(enc, pend, &av_videoFunction, 1.0); if (!enc) return FALSE; if (r->Link.pageUrl.av_len) { // å‹å…¥â€œpageUrlâ€œï¼ŒSWF æ–‡ä»¶æ‰€åŠ è½½çš„ç½‘é¡µ URLã€‚http://somehost/sample.html enc = AMF_EncodeNamedString(enc, pend, &av_pageUrl, &r->Link.pageUrl); if (!enc) return FALSE; } } if (r->m_fEncoding != 0.0 || r->m_bSendEncoding) { /* AMF0, AMF3 not fully supported yet */ enc = AMF_EncodeNamedNumber(enc, pend, &av_objectEncoding, r->m_fEncoding); if (!enc) return FALSE; } // åˆ¤æ–­æ˜¯å¦æº¢å‡º if (enc + 3 >= pend) return FALSE; // å‹å…¥å±æ€§ç»“æŸæ ‡è®° *enc++ = 0; *enc++ = 0; /* end of object - 0x00 0x00 0x09 */ *enc++ = AMF_OBJECT_END; /* add auth string */ if (r->Link.auth.av_len) { enc = AMF_EncodeBoolean(enc, pend, r->Link.lFlags & RTMP_LF_AUTH); if (!enc) return FALSE; enc = AMF_EncodeString(enc, pend, &r->Link.auth); if (!enc) return FALSE; } if (r->Link.extras.o_num) { int i; for (i = 0; i Link.extras.o_num; i++) { enc = AMFProp_Encode(&r->Link.extras.o_props[i], enc, pend); if (!enc) return FALSE; } } ä»£ç ç‰‡æ®µåˆ†æ4 if (!enc) return FALSE; if (r->Link.protocol & RTMP_FEATURE_WRITE) { enc = AMF_EncodeNamedString(enc, pend, &av_type, &av_nonprivate); if (!enc) return FALSE; } if (r->Link.flashVer.av_len) { enc = AMF_EncodeNamedString(enc, pend, &av_flashVer, &r->Link.flashVer); if (!enc) return FALSE; } if (r->Link.swfUrl.av_len) { enc = AMF_EncodeNamedString(enc, pend, &av_swfUrl, &r->Link.swfUrl); if (!enc) return FALSE; } if (r->Link.tcUrl.av_len) { enc = AMF_EncodeNamedString(enc, pend, &av_tcUrl, &r->Link.tcUrl); if (!enc) return FALSE; } if (!(r->Link.protocol & RTMP_FEATURE_WRITE)) { enc = AMF_EncodeNamedBoolean(enc, pend, &av_fpad, FALSE); if (!enc) return FALSE; enc = AMF_EncodeNamedNumber(enc, pend, &av_capabilities, 15.0); if (!enc) return FALSE; enc = AMF_EncodeNamedNumber(enc, pend, &av_audioCodecs, r->m_fAudioCodecs); if (!enc) return FALSE; enc = AMF_EncodeNamedNumber(enc, pend, &av_videoCodecs, r->m_fVideoCodecs); if (!enc) return FALSE; enc = AMF_EncodeNamedNumber(enc, pend, &av_videoFunction, 1.0); if (!enc) return FALSE; if (r->Link.pageUrl.av_len) { enc = AMF_EncodeNamedString(enc, pend, &av_pageUrl, &r->Link.pageUrl); if (!enc) return FALSE; } } if (r->m_fEncoding != 0.0 || r->m_bSendEncoding) { /* AMF0, AMF3 not fully supported yet */ enc = AMF_EncodeNamedNumber(enc, pend, &av_objectEncoding, r->m_fEncoding); if (!enc) return FALSE; } if (enc + 3 >= pend) return FALSE; // å‹å…¥å±æ€§ç»“æŸæ ‡è®° *enc++ = 0; *enc++ = 0; /* end of object - 0x00 0x00 0x09 */ *enc++ = AMF_OBJECT_END; ä»£ç ç‰‡æ®µåˆ†æ5 /* add auth string */ if (r->Link.auth.av_len) { enc = AMF_EncodeBoolean(enc, pend, r->Link.lFlags & RTMP_LF_AUTH); if (!enc) return FALSE; enc = AMF_EncodeString(enc, pend, &r->Link.auth); if (!enc) return FALSE; } if (r->Link.extras.o_num) { int i; for (i = 0; i Link.extras.o_num; i++) { enc = AMFProp_Encode(&r->Link.extras.o_props[i], enc, pend); if (!enc) return FALSE; } } // ç»è¿‡AMFç¼–ç ç»„åŒ…åï¼Œmessageçš„å¤§å° (å¦‚æœæ˜¯éŸ³è§†é¢‘æ•°æ® å³FLVæ ¼å¼ä¸€ä¸ªTagä¸­Tag Data å¤§å°) // æ¶ˆæ¯ä½“é•¿åº¦ï¼Œæ¶ˆæ¯å¤´çš„ç¬¬5-7ä¸ªå­—èŠ‚ packet.m_nBodySize = enc - packet.m_body; // å‘é€æŠ¥æ–‡ï¼Œå¹¶è®°å…¥åº”ç­”é˜Ÿåˆ— return RTMP_SendPacket(r, &packet, TRUE); æŠ¥æ–‡æ•°æ® DEBUG2: 0000: 03 00 00 00 00 00 55 14 00 00 00 00 ......U..... DEBUG2: 0000: 02 00 07 63 6f 6e 6e 65 63 74 00 3f f0 00 00 00 ...connect.?.... DEBUG2: 0010: 00 00 00 03 00 03 61 70 70 02 00 04 6c 69 76 65 ......app...live DEBUG2: 0020: 00 04 74 79 70 65 02 00 0a 6e 6f 6e 70 72 69 76 ..type...nonpriv DEBUG2: 0030: 61 74 65 00 05 74 63 55 72 6c 02 00 15 72 74 6d ate..tcUrl...rtm DEBUG2: 0040: 70 3a 2f 2f 31 32 32 31 2e 73 69 74 65 2f 6c 69 p://1221.site/li DEBUG2: 0050: 76 65 00 00 09 ve... å‚è€ƒï¼š RTMP åè®®è§„èŒƒ(ä¸­æ–‡ç‰ˆ) æµåª’ä½“-RTMPåè®®-librtmpåº“å­¦ä¹ ï¼ˆäºŒï¼‰ librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» rtmpæºç åˆ†æä¹‹RTMP_Write å’Œ RTMP_SendPacket ASCIIå¯¹ç…§è¡¨ RTMPåè®®è¯¦è§£åŠå®ä¾‹åˆ†æ æ‰‹æ’•rtmpåè®®ç»†èŠ‚ï¼ˆ2ï¼‰â€”â€”rtmp Header "},"pages/librtmp/librtmpæºç ä¹‹RTMP_SendPacket.html":{"url":"pages/librtmp/librtmpæºç ä¹‹RTMP_SendPacket.html","title":"librtmpæºç ä¹‹RTMP_SendPacket","keywords":"","body":"librtmpæºç ä¹‹RTMP_SendPacket ä»£ç ç‰‡æ®µåˆ†æ1 // å–å‡ºå¯¹åº”å—æµIDä¸Šä¸€æ¬¡å‘é€çš„æŠ¥æ–‡ const RTMPPacket *prevPacket; // ä¸Šä¸€æ¬¡ç›¸å¯¹æ—¶é—´æˆ³ uint32_t last = 0; // è¡¨ç¤ºå—å¤´åˆå§‹å¤§å° int nSize; // hSizeè¡¨ç¤ºå—å¤´å¤§å° // å—åŸºæœ¬å¤´æ˜¯1-3å­—èŠ‚ï¼Œå› æ­¤ç”¨å˜é‡cSizeæ¥è¡¨ç¤ºå‰©ä¸‹çš„0-2å­—èŠ‚ int hSize, cSize; // headerå¤´æŒ‡é’ˆæŒ‡å‘å¤´éƒ¨ï¼Œhendå—å°¾æŒ‡é’ˆæŒ‡å‘bodyå¤´éƒ¨ // hbufè¡¨ç¤ºå¤´éƒ¨æœ€å¤§18ï¼ˆ3å­—èŠ‚æœ€å¤§å—åŸºæœ¬å¤´+11å­—èŠ‚æœ€å¤§å¿«æ¶ˆæ¯å¤´+4å­—èŠ‚æ‰©å±•æ—¶é—´æˆ³ï¼‰ç¼“å†²æ•°ç»„ // hptræŒ‡å‘header // c = packet->m_headerType m_nTimeStamp - last; // æ—¶é—´æˆ³å¢é‡ uint32_t t; // buffer è¡¨ç¤º data çš„æŒ‡é’ˆï¼Œtbuf å—åˆå§‹æŒ‡é’ˆï¼Œtoff å—æŒ‡é’ˆ char *buffer, *tbuf = NULL, *toff = NULL; // Chunkå¤§å°ï¼Œé»˜è®¤æ˜¯128å­—èŠ‚ int nChunkSize; // tlen ? int tlen; // ? if (packet->m_nChannel >= r->m_channelsAllocatedOut) { RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s if (packet->m_nChannel >= r->m_channelsAllocatedOut)\", __FUNCTION__); int n = packet->m_nChannel + 10; RTMPPacket **packets = realloc(r->m_vecChannelsOut, sizeof(RTMPPacket*) * n); if (!packets) { free(r->m_vecChannelsOut); r->m_vecChannelsOut = NULL; r->m_channelsAllocatedOut = 0; return FALSE; } r->m_vecChannelsOut = packets; memset(r->m_vecChannelsOut + r->m_channelsAllocatedOut, 0, sizeof(RTMPPacket*) * (n - r->m_channelsAllocatedOut)); r->m_channelsAllocatedOut = n; } ä»£ç ç‰‡æ®µåˆ†æ2 // è·å–è¯¥é€šé“ï¼Œä¸Šä¸€æ¬¡çš„æ•°æ® prevPacket = r->m_vecChannelsOut[packet->m_nChannel]; // å°è¯•å¯¹éLARGEæŠ¥æ–‡è¿›è¡Œå­—æ®µå‹ç¼© // å‰ä¸€ä¸ªpacketå­˜åœ¨ä¸”ä¸æ˜¯å®Œæ•´çš„ChunkMsgHeaderï¼Œå› æ­¤æœ‰å¯èƒ½éœ€è¦è°ƒæ•´å—æ¶ˆæ¯å¤´çš„ç±»å‹ // fmtå­—èŠ‚ /* case 0:chunk msg header é•¿åº¦ä¸º11 * case 1:chunk msg header é•¿åº¦ä¸º7 * case 2:chunk msg header é•¿åº¦ä¸º3 * case 3:chunk msg header é•¿åº¦ä¸º0 */ if (prevPacket && packet->m_headerType != RTMP_PACKET_SIZE_LARGE) { RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s if (prevPacket && packet->m_headerType != RTMP_PACKET_SIZE_LARGE)\", __FUNCTION__); /* compress a bit by using the prev packet's attributes */ // è·å–ChunkMsgHeaderç±»å‹ï¼Œå‰ä¸€ä¸ªChunkä¸å½“å‰Chunkæ¯”è¾ƒ // å¦‚æœå‰åä¸¤ä¸ªå—çš„å¤§å°ã€åŒ…ç±»å‹åŠå—å¤´ç±»å‹éƒ½ç›¸åŒï¼Œåˆ™å°†å—å¤´ç±»å‹fmtè®¾ä¸º2ï¼Œ // å³å¯çœç•¥æ¶ˆæ¯é•¿åº¦ã€æ¶ˆæ¯ç±»å‹idã€æ¶ˆæ¯æµid // å¯ä»¥å‚è€ƒå®˜æ–¹åè®®ï¼šæµçš„åˆ†å— --- 6.1.2.3èŠ‚ if (prevPacket->m_nBodySize == packet->m_nBodySize && prevPacket->m_packetType == packet->m_packetType && packet->m_headerType == RTMP_PACKET_SIZE_MEDIUM) packet->m_headerType = RTMP_PACKET_SIZE_SMALL; // å‰åä¸¤ä¸ªå—çš„æ—¶é—´æˆ³ç›¸åŒï¼Œä¸”å—å¤´ç±»å‹fmtä¸º2ï¼Œåˆ™ç›¸åº”çš„æ—¶é—´æˆ³ä¹Ÿå¯çœç•¥ï¼Œå› æ­¤å°†å—å¤´ç±»å‹ç½®ä¸º3 // å¯ä»¥å‚è€ƒå®˜æ–¹åè®®ï¼šæµçš„åˆ†å— --- 6.1.2.4èŠ‚ if (prevPacket->m_nTimeStamp == packet->m_nTimeStamp && packet->m_headerType == RTMP_PACKET_SIZE_SMALL) packet->m_headerType = RTMP_PACKET_SIZE_MINIMUM; // ä¸Šä¸€æ¬¡ç›¸å¯¹æ—¶é—´æˆ³ last = prevPacket->m_nTimeStamp; } // å—å¤´ç±»å‹fmtå–å€¼0ã€1ã€2ã€3ï¼Œè¶…è¿‡3å°±è¡¨ç¤ºå‡ºé”™(fmtå äºŒä¸ªå­—èŠ‚) if (packet->m_headerType > 3) /* sanity */ { RTMP_Log(RTMP_LOGERROR, \"sanity failed!! trying to send header of type: 0x%02x.\", (unsigned char)packet->m_headerType); return FALSE; } // å—å¤´åˆå§‹å¤§å° = åŸºæœ¬å¤´(1å­—èŠ‚) + å—æ¶ˆæ¯å¤´å¤§å°(11/7/3/0) = [12, 8, 4, 1] // å—åŸºæœ¬å¤´æ˜¯1-3å­—èŠ‚ï¼Œå› æ­¤ç”¨å˜é‡cSizeæ¥è¡¨ç¤ºå‰©ä¸‹çš„0-2å­—èŠ‚ // nSize è¡¨ç¤ºå—å¤´åˆå§‹å¤§å°ï¼Œ hSizeè¡¨ç¤ºå—å¤´å¤§å° nSize = packetSize[packet->m_headerType]; hSize = nSize; cSize = 0; // æ—¶é—´æˆ³å¢é‡ t = packet->m_nTimeStamp - last; ä»£ç ç‰‡æ®µåˆ†æ3 if (packet->m_body) { // å—å¤´çš„é¦–æŒ‡é’ˆ å‘å‰å¹³ç§»äº† åŸºæœ¬å¤´(1å­—èŠ‚) + å—æ¶ˆæ¯å¤´å¤§å°(11/7/3/0) å­—èŠ‚ header = packet->m_body - nSize; // å—å¤´çš„å°¾æŒ‡é’ˆ hend = packet->m_body; } else { header = hbuf + 6; hend = hbuf + sizeof(hbuf); } // è®¡ç®—åŸºæœ¬å¤´çš„æ‰©å……å¤§å° // å—åŸºæœ¬å¤´æ˜¯1-3å­—èŠ‚ï¼Œå› æ­¤ç”¨å˜é‡cSizeæ¥è¡¨ç¤ºå‰©ä¸‹çš„0-2å­—èŠ‚ if (packet->m_nChannel > 319) // å—æµid(cs id)å¤§äº319ï¼Œåˆ™å—åŸºæœ¬å¤´å 3ä¸ªå­—èŠ‚ cSize = 2; else if (packet->m_nChannel > 63) // å—æµid(cs id)åœ¨64ä¸319ä¹‹é—´ï¼Œåˆ™å—åŸºæœ¬å¤´å 2ä¸ªå­—èŠ‚ cSize = 1; if (cSize) { // å‘å‰å¹³ç§»äº† å—åŸºæœ¬å¤´æ˜¯1-3å­—èŠ‚ï¼Œå› æ­¤ç”¨å˜é‡cSizeæ¥è¡¨ç¤ºå‰©ä¸‹çš„0-2å­—èŠ‚ ä¸ªå­—èŠ‚ header -= cSize; hSize += cSize; RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s cSize:%d\", __FUNCTION__, cSize); } // æ ¹æ®æ—¶é—´æˆ³è®¡ç®—æ˜¯å¦éœ€è¦æ‰©å……å¤´å¤§å° // å¦‚æœ t>0xffffffï¼Œ åˆ™éœ€è¦ä½¿ç”¨ extended timestamp if (t >= 0xffffff) { // å‘å‰å¹³ç§»äº† extended timestamp header -= 4; hSize += 4; RTMP_Log(RTMP_LOGWARNING, \"Larger timestamp than 24-bit: 0x%x\", t); } // ç¡®å®šå¥½ Header çš„ä½ç½®åï¼Œå°±å¯ä»¥å¼€å§‹èµ‹å€¼äº† // å‘ç¼“å†²åŒºå‹å…¥åŸºæœ¬å¤´ hptr = header; // æŠŠChunkBasicHeaderçš„Fmtç±»å‹å·¦ç§»6ä½ // cSize è¡¨ç¤ºå—åŸºæœ¬å¤´å‰©ä¸‹çš„0-2å­—èŠ‚ // è®¾ç½®basic headerçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å€¼ï¼Œå‰ä¸¤ä½ä¸ºfmt. å¯ä»¥å‚è€ƒå®˜æ–¹åè®®ï¼šæµçš„åˆ†å— --- 6.1.1èŠ‚ c = packet->m_headerType m_nChannel;// chunk stream ID RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s æŠŠChunkBasicHeaderçš„ä½6ä½è®¾ç½®æˆChunkStreamID\", __FUNCTION__); break; case 1:// åŒç†ï¼Œä½†ä½6ä½è®¾ç½®æˆ000000 break; case 2:// åŒç†ï¼Œä½†ä½6ä½è®¾ç½®æˆ000001 c |= 1; break; } // å¯ä»¥æ‹†åˆ†æˆä¸¤å¥*hptr=c; hptr++ï¼Œæ­¤æ—¶hptræŒ‡å‘ç¬¬2ä¸ªå­—èŠ‚ *hptr++ = c; // è®¾ç½®basic headerçš„ç¬¬äºŒ(ä¸‰)ä¸ªå­—èŠ‚å€¼ if (cSize) { // å°†è¦æ”¾åˆ°ç¬¬2å­—èŠ‚çš„å†…å®¹tmp int tmp = packet->m_nChannel - 64; // è·å–ä½ä½å­˜å‚¨ä¸ç¬¬2å­—èŠ‚ *hptr++ = tmp & 0xff; // ChunkBasicHeaderæ˜¯æœ€å¤§çš„3å­—èŠ‚æ—¶,è·å–é«˜ä½å­˜å‚¨äºæœ€å1ä¸ªå­—èŠ‚ï¼ˆæ³¨æ„ï¼šæ’åºä½¿ç”¨å¤§ç«¯åºåˆ—ï¼Œå’Œä¸»æœºç›¸åï¼‰ if (cSize == 2) *hptr++ = tmp >> 8; } // nSize å—å¤´åˆå§‹å¤§å° = åŸºæœ¬å¤´(1å­—èŠ‚) + å—æ¶ˆæ¯å¤´å¤§å°(11/7/3/0) = [12, 8, 4, 1] // å‘ç¼“å†²åŒºå‹å…¥æ—¶é—´æˆ³ if (nSize > 1) { // å†™å…¥ timestamp æˆ– timestamp delta hptr = AMF_EncodeInt24(hptr, hend, t > 0xffffff ? 0xffffff : t); } // å‘ç¼“å†²åŒºå‹å…¥è´Ÿè½½å¤§å°å’ŒæŠ¥æ–‡ç±»å‹ if (nSize > 4) { // å†™å…¥ message length hptr = AMF_EncodeInt24(hptr, hend, packet->m_nBodySize); // å†™å…¥ message type id *hptr++ = packet->m_packetType; } // å‘ç¼“å†²åŒºå‹å…¥æµID if (nSize > 8) // å†™å…¥ message stream id // è¿˜åŸChunkä¸ºMessageçš„æ—¶å€™éƒ½æ˜¯æ ¹æ®è¿™ä¸ªIDæ¥è¾¨è¯†æ˜¯å¦æ˜¯åŒä¸€ä¸ªæ¶ˆæ¯çš„Chunkçš„ hptr += EncodeInt32LE(hptr, packet->m_nInfoField2); // å‘ç¼“å†²åŒºå‹å…¥æ‰©å±•æ—¶é—´æˆ³ if (t >= 0xffffff) // å†™å…¥ extended timestamp hptr = AMF_EncodeInt32(hptr, hend, t); // åˆ°æ­¤ä¸ºæ­¢ï¼Œå·²ç»å°†å—å¤´å¡«å†™å¥½äº† // æ­¤æ—¶nSizeè¡¨ç¤ºè´Ÿè½½æ•°æ®çš„é•¿åº¦, bufferæ˜¯æŒ‡å‘è´Ÿè½½æ•°æ®åŒºçš„æŒ‡é’ˆ nSize = packet->m_nBodySize; buffer = packet->m_body; // Chunkå¤§å°ï¼Œé»˜è®¤æ˜¯128å­—èŠ‚ nChunkSize = r->m_outChunkSize; RTMP_Log(RTMP_LOGDEBUG2, \"%s: fd=%d, size=%d\", __FUNCTION__, r->m_sb.sb_socket, nSize); ä»£ç ç‰‡æ®µåˆ†æ4 /* send all chunks in one HTTP request */ if (r->Link.protocol & RTMP_FEATURE_HTTP) { RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s if (r->Link.protocol & RTMP_FEATURE_HTTP)\", __FUNCTION__); // nSize:Messageè´Ÿè½½é•¿åº¦ï¼›nChunkSizeï¼šChunké•¿åº¦ï¼› // ä¾‹nSizeï¼š307ï¼ŒnChunkSize:128ï¼› // å¯åˆ†ä¸ºï¼ˆ307 + 128 - 1ï¼‰/128 = 3ä¸ª // ä¸ºä»€ä¹ˆåŠ  nChunkSize - 1ï¼Ÿå› ä¸ºé™¤æ³•ä¼šåªå–æ•´æ•°éƒ¨åˆ†ï¼ int chunks = (nSize+nChunkSize-1) / nChunkSize; if (chunks > 1) { RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s chunks > 1ï¼Œchunks: %d\", __FUNCTION__, chunks); // æ³¨æ„ï¼šChunkBasicHeaderçš„é•¿åº¦ = cSize + 1 // æ¶ˆæ¯åˆ†nå—åæ€»çš„å¼€é”€ï¼š // nä¸ªChunkBasicHeaderï¼Œ1ä¸ªChunkMsgHeaderï¼Œ1ä¸ªMessageè´Ÿè½½ // å®é™…ä¸Šåªæœ‰ç¬¬ä¸€ä¸ªChunkæ˜¯å®Œæ•´çš„ï¼Œå‰©ä¸‹çš„åªæœ‰ChunkBasicHeader tlen = chunks * (cSize + 1) + nSize + hSize; tbuf = malloc(tlen); if (!tbuf) return FALSE; toff = tbuf; } } // æ¶ˆæ¯çš„è´Ÿè½½ + å¤´ while (nSize + hSize) { int wrote; // æ¶ˆæ¯è´Ÿè½½å¤§å° Link.protocolé‡‡ç”¨Httpåè®®ï¼Œåˆ™å°†RTMPåŒ…æ•°æ®å°è£…æˆå¤šä¸ªChunkï¼Œç„¶åä¸€æ¬¡æ€§å‘é€ã€‚ // å¦åˆ™æ¯å°è£…æˆä¸€ä¸ªå—ï¼Œå°±ç«‹å³å‘é€å‡ºå» if (tbuf) { // å°†ä»Chunkå¤´å¼€å§‹çš„nChunkSize + hSizeä¸ªå­—èŠ‚æ‹·è´è‡³toffä¸­ï¼Œ // è¿™äº›æ‹·è´çš„æ•°æ®åŒ…æ‹¬å—å¤´æ•°æ®(hSizeå­—èŠ‚)å’ŒnChunkSizeä¸ªè´Ÿè½½æ•°æ® memcpy(toff, header, nChunkSize + hSize); toff += nChunkSize + hSize; RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s if (tbuf)\", __FUNCTION__); } // è´Ÿè½½æ•°æ®é•¿åº¦ä¸è¶…è¿‡è®¾å®šçš„å—å¤§å°ï¼Œä¸éœ€è¦åˆ†å—ï¼Œå› æ­¤tbufä¸ºNULLï¼›æˆ–è€…r->Link.protocolä¸é‡‡ç”¨Http else { RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s if !(tbuf)\", __FUNCTION__); // ç›´æ¥å°†è´Ÿè½½æ•°æ®å’Œå—å¤´æ•°æ®å‘é€å‡ºå» wrote = WriteN(r, header, nChunkSize + hSize); if (!wrote) return FALSE; } // æ¶ˆæ¯è´Ÿè½½é•¿åº¦ - Chunkè´Ÿè½½é•¿åº¦ nSize -= nChunkSize; // bufferæŒ‡é’ˆå‰ç§»1ä¸ªChunkè´Ÿè½½é•¿åº¦ buffer += nChunkSize; // é‡ç½®å—å¤´å¤§å°ä¸º0ï¼Œåç»­çš„å—åªéœ€è¦æœ‰åŸºæœ¬å¤´(æˆ–åŠ ä¸Šæ‰©å±•æ—¶é—´æˆ³)å³å¯ hSize = 0; // å¦‚æœæ¶ˆæ¯è´Ÿè½½æ•°æ®è¿˜æ²¡æœ‰å‘å®Œï¼Œå‡†å¤‡å¡«å……ä¸‹ä¸€ä¸ªå—çš„å—å¤´æ•°æ® // è‹¥åªæœ‰éƒ¨åˆ†è´Ÿè½½å‘é€æˆåŠŸï¼Œåˆ™éœ€ç»§ç»­æ„é€ å—å†æ¬¡å‘é€ if (nSize > 0) { RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s ç»§ç»­æ„é€ å—å†æ¬¡å‘é€\", __FUNCTION__); // åªéœ€è¦æ„é€ 3å·ç±»å‹çš„å—å¤´ header = buffer - 1; // basic header å­—èŠ‚ hSize = 1; if (cSize) { header -= cSize; hSize += cSize; } if (t >= 0xffffff) { header -= 4; hSize += 4; } // c ä¸º basic header ç¬¬ä¸€ä¸ªå­—èŠ‚ *header = (0xc0 | c); if (cSize) { int tmp = packet->m_nChannel - 64; header[1] = tmp & 0xff; if (cSize == 2) header[2] = tmp >> 8; } if (t >= 0xffffff) { char* extendedTimestamp = header + 1 + cSize; AMF_EncodeInt32(extendedTimestamp, extendedTimestamp + 4, t); } } } ä»£ç ç‰‡æ®µåˆ†æ5 if (tbuf) { RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s if (tbuf)ï¼Œ write tbuf\", __FUNCTION__); int wrote = WriteN(r, tbuf, toff-tbuf); free(tbuf); tbuf = NULL; if (!wrote) return FALSE; } /* we invoked a remote method */ // å¦‚æœæ˜¯0x14è¿œç¨‹è°ƒç”¨ï¼Œåˆ™éœ€è¦è§£å‡ºè°ƒç”¨åç§°ï¼ŒåŠ å…¥ç­‰å¾…å“åº”çš„é˜Ÿåˆ—ä¸­ if (packet->m_packetType == RTMP_PACKET_TYPE_INVOKE) { AVal method; char *ptr; ptr = packet->m_body + 1; AMF_DecodeString(ptr, &method); RTMP_Log(RTMP_LOGDEBUG, \"Invoking %s\", method.av_val); /* keep it in call queue till result arrives */ if (queue) { int txn; ptr += 3 + method.av_len; txn = (int)AMF_DecodeNumber(ptr); AV_queue(&r->m_methodCalls, &r->m_numCalls, &method, txn); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å¦‚æœæ˜¯0x14è¿œç¨‹è°ƒç”¨ï¼Œåˆ™éœ€è¦è§£å‡ºè°ƒç”¨åç§°ï¼ŒåŠ å…¥ç­‰å¾…å“åº”çš„é˜Ÿåˆ—ä¸­\", __FUNCTION__); } } // è®°å½•è¿™ä¸ªå—æµIDåˆšåˆšå‘é€çš„æŠ¥æ–‡ï¼Œä½†æ˜¯åº”å¿½ç•¥è´Ÿè½½ if (!r->m_vecChannelsOut[packet->m_nChannel]) r->m_vecChannelsOut[packet->m_nChannel] = malloc(sizeof(RTMPPacket)); memcpy(r->m_vecChannelsOut[packet->m_nChannel], packet, sizeof(RTMPPacket)); return TRUE; æŠ¥æ–‡æ•°æ® DEBUG2: 0000: 03 00 00 00 00 00 55 14 00 00 00 00 ......U..... DEBUG2: 0000: 02 00 07 63 6f 6e 6e 65 63 74 00 3f f0 00 00 00 ...connect.?.... DEBUG2: 0010: 00 00 00 03 00 03 61 70 70 02 00 04 6c 69 76 65 ......app...live DEBUG2: 0020: 00 04 74 79 70 65 02 00 0a 6e 6f 6e 70 72 69 76 ..type...nonpriv DEBUG2: 0030: 61 74 65 00 05 74 63 55 72 6c 02 00 15 72 74 6d ate..tcUrl...rtm DEBUG2: 0040: 70 3a 2f 2f 31 32 32 31 2e 73 69 74 65 2f 6c 69 p://1221.site/li DEBUG2: 0050: 76 65 00 00 09 ve... å‚è€ƒï¼š librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» rtmpæºç åˆ†æä¹‹RTMP_Write å’Œ RTMP_SendPacket librtmpåè®®åˆ†æ---RTMP_SendPacketå‡½æ•° librtmp æºç åˆ†æç¬”è®° RTMP_SendPacket "},"pages/librtmp/librtmpæºç ä¹‹WriteN.html":{"url":"pages/librtmp/librtmpæºç ä¹‹WriteN.html","title":"librtmpæºç ä¹‹WriteN","keywords":"","body":"librtmpæºç ä¹‹WriteN // å‘é€æ•°æ®æŠ¥çš„æ—¶å€™è°ƒç”¨ï¼ˆè¿æ¥ï¼Œbufferï¼Œé•¿åº¦ï¼‰ static int WriteN(RTMP *r, const char *buffer, int n) { const char *ptr = buffer; #ifdef CRYPTO char *encrypted = 0; char buf[RTMP_BUFFER_CACHE_SIZE]; if (r->Link.rc4keyOut) { if (n > sizeof(buf)) encrypted = (char *)malloc(n); else encrypted = (char *)buf; ptr = encrypted; RC4_encrypt2(r->Link.rc4keyOut, n, buffer, ptr); } #endif while (n > 0) { int nBytes; // å› æ–¹å¼çš„ä¸åŒè€Œè°ƒç”¨ä¸åŒå‡½æ•° // å¦‚æœä½¿ç”¨çš„æ˜¯HTTPåè®®è¿›è¡Œè¿æ¥ if (r->Link.protocol & RTMP_FEATURE_HTTP) nBytes = HTTP_Post(r, RTMPT_SEND, ptr, n); else nBytes = RTMPSockBuf_Send(&r->m_sb, ptr, n); /*RTMP_Log(RTMP_LOGDEBUG, \"%s: %d\\n\", __FUNCTION__, nBytes); */ // æˆåŠŸå‘é€å­—èŠ‚æ•°sb_ssl) { rc = TLS_write(sb->sb_ssl, buf, len); } else #endif { // å‘ä¸€ä¸ªå·²è¿æ¥çš„å¥—æ¥å£å‘é€æ•°æ®ã€‚ // int send( SOCKET s, const char * buf, int len, int flags); // sï¼šä¸€ä¸ªç”¨äºæ ‡è¯†å·²è¿æ¥å¥—æ¥å£çš„æè¿°å­—ã€‚ // bufï¼šåŒ…å«å¾…å‘é€æ•°æ®çš„ç¼“å†²åŒºã€‚ // lenï¼šç¼“å†²åŒºä¸­æ•°æ®çš„é•¿åº¦ã€‚ // flagsï¼šè°ƒç”¨æ‰§è¡Œæ–¹å¼ã€‚ // rc:æ‰€å‘æ•°æ®é‡ã€‚ rc = send(sb->sb_socket, buf, len, 0); } return rc; } å‚è€ƒï¼š RTMPdumpï¼ˆlibRTMPï¼‰ æºä»£ç åˆ†æ 8ï¼š å‘é€æ¶ˆæ¯ï¼ˆMessageï¼‰ "},"pages/librtmp/librtmpæºç ä¹‹RTMP_ConnectStream.html":{"url":"pages/librtmp/librtmpæºç ä¹‹RTMP_ConnectStream.html","title":"librtmpæºç ä¹‹RTMP_ConnectStream","keywords":"","body":"librtmpæºç ä¹‹RTMP_ConnectStream // å»ºç«‹æµï¼ˆNetStreamï¼‰ int RTMP_ConnectStream(RTMP *r, int seekTime) { RTMPPacket packet = { 0 }; /* seekTime was already set by SetupStream / SetupURL. * This is only needed by ReconnectStream. */ if (seekTime > 0) r->Link.seekTime = seekTime; // å½“å‰è¿æ¥åª’ä½“ä½¿ç”¨çš„å—æµID r->m_mediaChannel = 0; // æ¥æ”¶åˆ°çš„å®é™…ä¸Šæ˜¯å—(Chunk)ï¼Œè€Œä¸æ˜¯æ¶ˆæ¯(Message)ï¼Œå› ä¸ºæ¶ˆæ¯åœ¨ç½‘ä¸Šä¼ è¾“çš„æ—¶å€™è¦åˆ†å‰²æˆå—. while (!r->m_bPlaying && RTMP_IsConnected(r) && RTMP_ReadPacket(r, &packet)) { // ä¸€ä¸ªæ¶ˆæ¯å¯èƒ½è¢«å°è£…æˆå¤šä¸ªå—(Chunk)ï¼Œåªæœ‰å½“æ‰€æœ‰å—è¯»å–å®Œæ‰å¤„ç†è¿™ä¸ªæ¶ˆæ¯åŒ… if (RTMPPacket_IsReady(&packet)) { if (!packet.m_nBodySize) continue; // è¯»å–åˆ°flvæ•°æ®åŒ…ï¼Œåˆ™ç»§ç»­è¯»å–ä¸‹ä¸€ä¸ªåŒ… if ((packet.m_packetType == RTMP_PACKET_TYPE_AUDIO) || (packet.m_packetType == RTMP_PACKET_TYPE_VIDEO) || (packet.m_packetType == RTMP_PACKET_TYPE_INFO)) { RTMP_Log(RTMP_LOGWARNING, \"Received FLV packet before play()! Ignoring.\"); RTMPPacket_Free(&packet); continue; } // å¤„ç†æ”¶åˆ°çš„æ•°æ®åŒ… RTMP_ClientPacket(r, &packet); // å¤„ç†å®Œæ¯•ï¼Œæ¸…é™¤æ•°æ® RTMPPacket_Free(&packet); } } // å½“å‰æ˜¯å¦æ¨æµæˆ–è¿æ¥ä¸­ return r->m_bPlaying; } ç®€å•çš„ä¸€ä¸ªé€»è¾‘åˆ¤æ–­ï¼Œé‡ç‚¹åœ¨whileå¾ªç¯é‡Œã€‚é¦–å…ˆï¼Œå¿…é¡»è¦æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ã€‚å…¶æ¬¡ï¼Œè¿›å…¥å¾ªç¯ä»¥ååªæœ‰å‡ºé”™æˆ–è€…å»ºç«‹æµï¼ˆNetStreamï¼‰å®Œæˆåï¼Œæ‰èƒ½é€€å‡ºå¾ªç¯ã€‚ åœ¨RTMP_ConnectStream()å¤„ç†äº¤äº’å‡†å¤‡çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸¤ä¸ªé‡è¦å‡½æ•°ï¼šRTMP_ReadPacket()è´Ÿè´£æ¥æ”¶æŠ¥æ–‡ï¼ŒRTMP_ClientPacket()è´Ÿè´£é€»è¾‘çš„åˆ†æ´¾å¤„ç†ã€‚ å‚è€ƒï¼š RTMPdumpï¼ˆlibRTMPï¼‰ æºä»£ç åˆ†æ 6ï¼š å»ºç«‹ä¸€ä¸ªæµåª’ä½“è¿æ¥ ï¼ˆNetStreaméƒ¨åˆ† 1ï¼‰ RTMPæ¨æµåŠåè®®å­¦ä¹  librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» ã€åŸã€‘librtmpæºç è¯¦è§£ "},"pages/librtmp/librtmpæºç ä¹‹RTMP_ReadPacket.html":{"url":"pages/librtmp/librtmpæºç ä¹‹RTMP_ReadPacket.html","title":"librtmpæºç ä¹‹RTMP_ReadPacket","keywords":"","body":"librtmpæºç ä¹‹RTMP_ReadPacket /** * @brief è¯»å–æ¥æ”¶åˆ°çš„æ¶ˆæ¯å—(Chunk)ï¼Œå­˜æ”¾åœ¨packetä¸­. å¯¹æ¥æ”¶åˆ°çš„æ¶ˆæ¯ä¸åšä»»ä½•å¤„ç†ã€‚ å—çš„æ ¼å¼ä¸ºï¼š * * | basic header(1-3å­—èŠ‚ï¼‰| chunk msg header(0/3/7/11å­—èŠ‚) | Extended Timestamp(0/4å­—èŠ‚) | chunk data | * * å…¶ä¸­ basic headerè¿˜å¯ä»¥åˆ†è§£ä¸ºï¼š| fmt(2ä½) | cs id (3 m_sb.sb_socket); // æ”¶ä¸‹æ¥çš„æ•°æ®å­˜å…¥hbuf if (ReadN(r, (char *)hbuf, 1) == 0) { RTMP_Log(RTMP_LOGERROR, \"%s, failed to read RTMP packet header\", __FUNCTION__); return FALSE; } // å—ç±»å‹fmt packet->m_headerType = (hbuf[0] & 0xc0) >> 6; // å—æµIDï¼ˆ2-63ï¼‰ packet->m_nChannel = (hbuf[0] & 0x3f); header++; // å—æµIDç¬¬ä¸€ä¸ªå­—èŠ‚ä¸º0ï¼Œè¡¨ç¤ºå—æµIDå 2ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºIDçš„èŒƒå›´æ˜¯64-319ï¼ˆç¬¬äºŒä¸ªå­—èŠ‚ + 64ï¼‰ if (packet->m_nChannel == 0) { // è¯»å–æ¥ä¸‹æ¥çš„1ä¸ªå­—èŠ‚å­˜æ”¾åœ¨hbuf[1]ä¸­ if (ReadN(r, (char *)&hbuf[1], 1) != 1) { RTMP_Log(RTMP_LOGERROR, \"%s, failed to read RTMP packet header 2nd byte\", __FUNCTION__); return FALSE; } // å—æµID = ç¬¬äºŒä¸ªå­—èŠ‚ + 64 = hbuf[1] + 64 packet->m_nChannel = hbuf[1]; packet->m_nChannel += 64; header++; } // å—æµIDç¬¬ä¸€ä¸ªå­—èŠ‚ä¸º1ï¼Œè¡¨ç¤ºå—æµIDå 3ä¸ªå­—èŠ‚ï¼Œè¡¨ç¤ºIDèŒƒå›´æ˜¯64 -- 65599ï¼ˆç¬¬ä¸‰ä¸ªå­—èŠ‚*256 + ç¬¬äºŒä¸ªå­—èŠ‚ + 64ï¼‰ else if (packet->m_nChannel == 1) { int tmp; // è¯»å–2ä¸ªå­—èŠ‚å­˜æ”¾åœ¨hbuf[1]å’Œhbuf[2]ä¸­ if (ReadN(r, (char *)&hbuf[1], 2) != 2) { RTMP_Log(RTMP_LOGERROR, \"%s, failed to read RTMP packet header 3nd byte\", __FUNCTION__); return FALSE; } // å—æµID = ç¬¬ä¸‰ä¸ªå­—èŠ‚*256 + ç¬¬äºŒä¸ªå­—èŠ‚ + 64 tmp = (hbuf[2] m_nChannel = tmp + 64; RTMP_Log(RTMP_LOGDEBUG, \"%s, m_nChannel: %0x\", __FUNCTION__, packet->m_nChannel); header += 2; } // å—æ¶ˆæ¯å¤´(ChunkMsgHeader)æœ‰å››ç§ç±»å‹ï¼Œå¤§å°åˆ†åˆ«ä¸º11ã€7ã€3ã€0,æ¯ä¸ªå€¼åŠ 1 å°±å¾—åˆ°è¯¥æ•°ç»„çš„å€¼ // å—å¤´ = BasicHeader(1-3å­—èŠ‚) + ChunkMsgHeader + ExtendTimestamp(0æˆ–4å­—èŠ‚) nSize = packetSize[packet->m_headerType]; if (packet->m_nChannel >= r->m_channelsAllocatedIn) { int n = packet->m_nChannel + 10; int *timestamp = realloc(r->m_channelTimestamp, sizeof(int) * n); RTMPPacket **packets = realloc(r->m_vecChannelsIn, sizeof(RTMPPacket*) * n); if (!timestamp) free(r->m_channelTimestamp); if (!packets) free(r->m_vecChannelsIn); r->m_channelTimestamp = timestamp; r->m_vecChannelsIn = packets; if (!timestamp || !packets) { r->m_channelsAllocatedIn = 0; return FALSE; } memset(r->m_channelTimestamp + r->m_channelsAllocatedIn, 0, sizeof(int) * (n - r->m_channelsAllocatedIn)); memset(r->m_vecChannelsIn + r->m_channelsAllocatedIn, 0, sizeof(RTMPPacket*) * (n - r->m_channelsAllocatedIn)); r->m_channelsAllocatedIn = n; } // å—ç±»å‹fmtä¸º0çš„å—ï¼Œåœ¨ä¸€ä¸ªå—æµçš„å¼€å§‹å’Œæ—¶é—´æˆ³è¿”å›çš„æ—¶å€™å¿…é¡»æœ‰è¿™ç§å— // å—ç±»å‹fmtä¸º1ã€2ã€3çš„å—ä½¿ç”¨ä¸å…ˆå‰å—ç›¸åŒçš„æ•°æ® // å…³äºå—ç±»å‹çš„å®šä¹‰ï¼Œå¯å‚è€ƒå®˜æ–¹åè®®ï¼šæµçš„åˆ†å— --- 6.1.2èŠ‚ // å¦‚æœæ˜¯æ ‡å‡†å¤§å¤´ï¼Œè®¾ç½®æ—¶é—´æˆ³ä¸ºç»å¯¹çš„ if (nSize == RTMP_LARGE_HEADER_SIZE) /* if we get a full header the timestamp is absolute */ // 11ä¸ªå­—èŠ‚çš„å®Œæ•´ChunkMsgHeaderçš„TimeStampæ˜¯ç»å¯¹æ—¶é—´æˆ³ packet->m_hasAbsTimestamp = TRUE; // å¦‚æœéæ ‡å‡†å¤§å¤´ï¼Œé¦–æ¬¡å°è¯•æ‹·è´ä¸Šä¸€æ¬¡çš„æŠ¥å¤´ else if (nSize m_vecChannelsIn[packet->m_nChannel]) memcpy(packet, r->m_vecChannelsIn[packet->m_nChannel], sizeof(RTMPPacket)); } // çœŸå®çš„ChunkMsgHeaderçš„å¤§å°ï¼Œæ­¤å¤„å‡1æ˜¯å› ä¸ºå‰é¢è·å–åŒ…ç±»å‹çš„æ—¶å€™å¤šåŠ äº†1 nSize--; // è¯»å–nSizeä¸ªå­—èŠ‚å­˜å…¥header if (nSize > 0 && ReadN(r, header, nSize) != nSize) { RTMP_Log(RTMP_LOGERROR, \"%s, failed to read RTMP packet header. type: %x\", __FUNCTION__, (unsigned int)hbuf[0]); return FALSE; } // ç›®å‰å·²ç»è¯»å–çš„å­—èŠ‚æ•° = chunk msg header + basic header // è®¡ç®—åŸºæœ¬å—å¤´+æ¶ˆæ¯å—å¤´çš„å¤§å° hSize = nSize + (header - (char *)hbuf); // chunk msg headerä¸º11ã€7ã€3å­—èŠ‚ï¼Œfmtç±»å‹å€¼ä¸º0ã€1ã€2 if (nSize >= 3) { // TimeStamp(æ³¨æ„ BigEndian to SmallEndian)(11ï¼Œ7ï¼Œ3å­—èŠ‚é¦–éƒ¨éƒ½æœ‰) // é¦–éƒ¨å‰3ä¸ªå­—èŠ‚ä¸ºtimestamp packet->m_nTimeStamp = AMF_DecodeInt24(header); /*RTMP_Log(RTMP_LOGDEBUG, \"%s, reading RTMP packet chunk on channel %x, headersz %i, timestamp %i, abs timestamp %i\", __FUNCTION__, packet.m_nChannel, nSize, packet.m_nTimeStamp, packet.m_hasAbsTimestamp); */ // chunk msg headerä¸º11æˆ–7å­—èŠ‚ï¼Œfmtç±»å‹å€¼ä¸º0æˆ–1 // æ¶ˆæ¯é•¿åº¦(11ï¼Œ7å­—èŠ‚é¦–éƒ¨éƒ½æœ‰) if (nSize >= 6) { // è§£æè´Ÿè½½é•¿åº¦ packet->m_nBodySize = AMF_DecodeInt24(header + 3); packet->m_nBytesRead = 0; //(11ï¼Œ7å­—èŠ‚é¦–éƒ¨éƒ½æœ‰) if (nSize > 6) { // Msg type ID // è§£æåŒ…ç±»å‹ packet->m_packetType = header[6]; // Msg Stream ID // è§£ææµID if (nSize == 11) // msg stream idï¼Œå°ç«¯å­—èŠ‚åº packet->m_nInfoField2 = DecodeInt32LE(header + 7); } } } // è¯»å–æ‰©å±•æ—¶é—´æˆ³å¹¶è§£æ // Extend Tiemstamp,å 4ä¸ªå­—èŠ‚ extendedTimestamp = packet->m_nTimeStamp == 0xffffff; if (extendedTimestamp) { if (ReadN(r, header + nSize, 4) != 4) { RTMP_Log(RTMP_LOGERROR, \"%s, failed to read extended timestamp\", __FUNCTION__); return FALSE; } packet->m_nTimeStamp = AMF_DecodeInt32(header + nSize); hSize += 4; } RTMP_LogHexString(RTMP_LOGDEBUG2, (uint8_t *)hbuf, hSize); // è´Ÿè½½é0ï¼Œéœ€è¦åˆ†é…å†…å­˜ï¼Œæˆ–ç¬¬ä¸€ä¸ªåˆ†å—çš„åˆä½¿åŒ–å·¥ä½œ if (packet->m_nBodySize > 0 && packet->m_body == NULL) { if (!RTMPPacket_Alloc(packet, packet->m_nBodySize)) { RTMP_Log(RTMP_LOGDEBUG, \"%s, failed to allocate packet\", __FUNCTION__); return FALSE; } didAlloc = TRUE; packet->m_headerType = (hbuf[0] & 0xc0) >> 6; } // å‰©ä¸‹çš„æ¶ˆæ¯æ•°æ®é•¿åº¦å¦‚æœæ¯”å—å°ºå¯¸å¤§ï¼Œåˆ™éœ€è¦åˆ†å—,å¦åˆ™å—å°ºå¯¸å°±ç­‰äºå‰©ä¸‹çš„æ¶ˆæ¯æ•°æ®é•¿åº¦ // å‡†å¤‡è¯»å–çš„æ•°æ®å’Œå—å¤§å° nToRead = packet->m_nBodySize - packet->m_nBytesRead; nChunk = r->m_inChunkSize; if (nToRead m_chunk) { // å—å¤´å¤§å° packet->m_chunk->c_headerSize = hSize; // å¡«å……å—å¤´æ•°æ® memcpy(packet->m_chunk->c_header, hbuf, hSize); // å—æ¶ˆæ¯æ•°æ®ç¼“å†²åŒºæŒ‡é’ˆ packet->m_chunk->c_chunk = packet->m_body + packet->m_nBytesRead; // å—å¤§å° packet->m_chunk->c_chunkSize = nChunk; } // è¯»å–è´Ÿè½½åˆ°ç¼“å†²åŒºä¸­ // è¯»å–ä¸€ä¸ªå—å¤§å°çš„æ•°æ®å­˜å…¥å—æ¶ˆæ¯æ•°æ®ç¼“å†²åŒº if (ReadN(r, packet->m_body + packet->m_nBytesRead, nChunk) != nChunk) { RTMP_Log(RTMP_LOGERROR, \"%s, failed to read RTMP packet body. len: %u\", __FUNCTION__, packet->m_nBodySize); return FALSE; } RTMP_LogHexString(RTMP_LOGDEBUG2, (uint8_t *)packet->m_body + packet->m_nBytesRead, nChunk); // æ›´æ–°å·²è¯»æ•°æ®å­—èŠ‚ä¸ªæ•° packet->m_nBytesRead += nChunk; /* keep the packet as ref for other packets on this channel */ // å°†è¿™ä¸ªåŒ…ä½œä¸ºé€šé“ä¸­å…¶ä»–åŒ…çš„å‚è€ƒ // ä¿å­˜å½“å‰å—æµIDæœ€æ–°çš„æŠ¥æ–‡ï¼Œä¸RTMP_SendPacket()ä¸åŒçš„æ˜¯ï¼Œè´Ÿè½½éƒ¨åˆ†ä¹Ÿè¢«ä¿å­˜äº†ï¼Œä»¥åº”å¯¹ä¸å®Œæ•´çš„åˆ†å—æŠ¥æ–‡ if (!r->m_vecChannelsIn[packet->m_nChannel]) r->m_vecChannelsIn[packet->m_nChannel] = malloc(sizeof(RTMPPacket)); memcpy(r->m_vecChannelsIn[packet->m_nChannel], packet, sizeof(RTMPPacket)); // è®¾ç½®æ‰©å±•æ—¶é—´æˆ³ if (extendedTimestamp) { r->m_vecChannelsIn[packet->m_nChannel]->m_nTimeStamp = 0xffffff; } // è‹¥æŠ¥æ–‡è´Ÿè½½æ¥æ”¶å®Œæ•´ if (RTMPPacket_IsReady(packet)) { /* make packet's timestamp absolute */ // å¤„ç†å¢é‡æ—¶é—´æˆ³ // ç»å¯¹æ—¶é—´æˆ³ = ä¸Šä¸€æ¬¡ç»å¯¹æ—¶é—´æˆ³ + æ—¶é—´æˆ³å¢é‡ if (!packet->m_hasAbsTimestamp) packet->m_nTimeStamp += r->m_channelTimestamp[packet->m_nChannel]; /* timestamps seem to be always relative!! */ // ä¿å­˜å½“å‰å—æµIDçš„æ—¶é—´æˆ³ // å½“å‰ç»å¯¹æ—¶é—´æˆ³ä¿å­˜èµ·æ¥ï¼Œä¾›ä¸‹ä¸€ä¸ªåŒ…è½¬æ¢æ—¶é—´æˆ³ä½¿ç”¨ r->m_channelTimestamp[packet->m_nChannel] = packet->m_nTimeStamp; /* reset the data from the stored packet. we keep the header since we may use it later if a new packet for this channel */ /* arrives and requests to re-use some info (small packet header) */ // æ¸…ç†ä¸Šä¸‹æ–‡ä¸­å½“å‰å—æµIDæœ€æ–°çš„æŠ¥æ–‡çš„è´Ÿè½½ä¿¡æ¯ // é‡ç½®ä¿å­˜çš„åŒ…ã€‚ä¿ç•™å—å¤´æ•°æ®ï¼Œå› ä¸ºé€šé“ä¸­æ–°åˆ°æ¥çš„åŒ…(æ›´çŸ­çš„å—å¤´)å¯èƒ½éœ€è¦ä½¿ç”¨å‰é¢å—å¤´çš„ä¿¡æ¯. r->m_vecChannelsIn[packet->m_nChannel]->m_body = NULL; r->m_vecChannelsIn[packet->m_nChannel]->m_nBytesRead = 0; r->m_vecChannelsIn[packet->m_nChannel]->m_hasAbsTimestamp = FALSE; /* can only be false if we reuse header */ } else { packet->m_body = NULL; /* so it won't be erased on free */ } return TRUE; } å‚è€ƒï¼š RTMPdumpï¼ˆlibRTMPï¼‰ æºä»£ç åˆ†æ 6ï¼š å»ºç«‹ä¸€ä¸ªæµåª’ä½“è¿æ¥ ï¼ˆNetStreaméƒ¨åˆ† 1ï¼‰ RTMPæ¨æµåŠåè®®å­¦ä¹  librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» ã€åŸã€‘librtmpæºç è¯¦è§£ "},"pages/librtmp/librtmpæºç ä¹‹RTMP_ClientPacket.html":{"url":"pages/librtmp/librtmpæºç ä¹‹RTMP_ClientPacket.html","title":"librtmpæºç ä¹‹RTMP_ClientPacket","keywords":"","body":"librtmpæºç ä¹‹RTMP_ClientPacket // å¤„ç†æ¶ˆæ¯ï¼ˆMessageï¼‰ï¼Œå¹¶åšå‡ºå“åº” int RTMP_ClientPacket(RTMP *r, RTMPPacket *packet) { // è¿”å›å€¼ä¸º1è¡¨ç¤ºæ¨æ‹‰æµæ­£åœ¨æ­£ä½œä¸­ï¼Œä¸º2è¡¨ç¤ºå·²ç»åœæ­¢ int bHasMediaPacket = 0; switch (packet->m_packetType) { // RTMPæ¶ˆæ¯ç±»å‹ID=1,è®¾ç½®å—å¤§å° case RTMP_PACKET_TYPE_CHUNK_SIZE: /* chunk size */ RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å¤„ç†æ¶ˆæ¯ Set Chunk Size (typeID=1)\", __FUNCTION__); // æ›´æ–°æ¥æ”¶å¤„ç†æ—¶çš„å—é™åˆ¶ HandleChangeChunkSize(r, packet); break; // å¯¹ç«¯åé¦ˆçš„å·²è¯»å¤§å° // RTMPæ¶ˆæ¯ç±»å‹ID=3 case RTMP_PACKET_TYPE_BYTES_READ_REPORT: /* bytes read report */ RTMP_Log(RTMP_LOGDEBUG, \"%s, received: bytes read report\", __FUNCTION__); break; // RTMPæ¶ˆæ¯ç±»å‹ID=4ï¼Œç”¨æˆ·æ§åˆ¶ // å¤„ç†å¯¹ç«¯å‘é€çš„æ§åˆ¶æŠ¥æ–‡ case RTMP_PACKET_TYPE_CONTROL: /* ctrl */ RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å¤„ç†æ¶ˆæ¯ User Control (typeID=4)\", __FUNCTION__); HandleCtrl(r, packet); break; // RTMPæ¶ˆæ¯ç±»å‹ID=5 case RTMP_PACKET_TYPE_SERVER_BW: /* server bw */ // å¤„ç†å¯¹ç«¯å‘é€çš„åº”ç­”çª—å£å¤§å°ï¼Œè¿™é‡Œç”±æœåŠ¡å™¨å‘é€ï¼Œå³å‘Šä¹‹å®¢æˆ·ç«¯æ”¶åˆ°å¯¹åº”å¤§å°çš„æ•°æ®ååº”å‘é€åé¦ˆ RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å¤„ç†æ¶ˆæ¯ Window Acknowledgement Size (typeID=5)\", __FUNCTION__); HandleServerBW(r, packet); break; // RTMPæ¶ˆæ¯ç±»å‹ID=6 case RTMP_PACKET_TYPE_CLIENT_BW: /* client bw */ // å¤„ç†å¯¹ç«¯å‘é€çš„è®¾ç½®å‘é€å¸¦å®½å¤§å°ï¼Œè¿™é‡Œç”±æœåŠ¡å™¨å‘é€ï¼Œå³è®¾ç½®å®¢æˆ·ç«¯çš„å‘é€å¸¦å®½ RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å¤„ç†æ¶ˆæ¯ Set Peer Bandwidth (typeID=6)\", __FUNCTION__); HandleClientBW(r, packet); break; // RTMPæ¶ˆæ¯ç±»å‹ID=8ï¼ŒéŸ³é¢‘æ•°æ® case RTMP_PACKET_TYPE_AUDIO: /* audio data */ /*RTMP_Log(RTMP_LOGDEBUG, \"%s, received: audio %lu bytes\", __FUNCTION__, packet.m_nBodySize); */ HandleAudio(r, packet); bHasMediaPacket = 1; if (!r->m_mediaChannel) r->m_mediaChannel = packet->m_nChannel; if (!r->m_pausing) r->m_mediaStamp = packet->m_nTimeStamp; break; // RTMPæ¶ˆæ¯ç±»å‹ID=9ï¼Œè§†é¢‘æ•°æ® case RTMP_PACKET_TYPE_VIDEO: /* video data */ /*RTMP_Log(RTMP_LOGDEBUG, \"%s, received: video %lu bytes\", __FUNCTION__, packet.m_nBodySize); */ HandleVideo(r, packet); bHasMediaPacket = 1; if (!r->m_mediaChannel) r->m_mediaChannel = packet->m_nChannel; if (!r->m_pausing) r->m_mediaStamp = packet->m_nTimeStamp; break; // RTMPæ¶ˆæ¯ç±»å‹ID=15ï¼ŒAMF3ç¼–ç ï¼Œå¿½ç•¥ case RTMP_PACKET_TYPE_FLEX_STREAM_SEND: /* flex stream send */ RTMP_Log(RTMP_LOGDEBUG, \"%s, flex stream send, size %u bytes, not supported, ignoring\", __FUNCTION__, packet->m_nBodySize); break; // RTMPæ¶ˆæ¯ç±»å‹ID=16ï¼ŒAMF3ç¼–ç ï¼Œå¿½ç•¥ case RTMP_PACKET_TYPE_FLEX_SHARED_OBJECT: /* flex shared object */ RTMP_Log(RTMP_LOGDEBUG, \"%s, flex shared object, size %u bytes, not supported, ignoring\", __FUNCTION__, packet->m_nBodySize); break; // RTMPæ¶ˆæ¯ç±»å‹ID=17ï¼ŒAMF3ç¼–ç ï¼Œå¿½ç•¥ case RTMP_PACKET_TYPE_FLEX_MESSAGE: /* flex message */ { RTMP_Log(RTMP_LOGDEBUG, \"%s, flex message, size %u bytes, not fully supported\", __FUNCTION__, packet->m_nBodySize); /*RTMP_LogHex(packet.m_body, packet.m_nBodySize); */ /* some DEBUG code */ #if 0 RTMP_LIB_AMFObject obj; int nRes = obj.Decode(packet.m_body+1, packet.m_nBodySize-1); if(nRes m_body + 1, packet->m_nBodySize - 1) == 1) bHasMediaPacket = 2; break; } // RTMPæ¶ˆæ¯ç±»å‹ID=18ï¼ŒAMF0ç¼–ç ï¼Œæ•°æ®æ¶ˆæ¯ case RTMP_PACKET_TYPE_INFO: /* metadata (notify) */ RTMP_Log(RTMP_LOGDEBUG, \"%s, received: notify %u bytes\", __FUNCTION__, packet->m_nBodySize); if (HandleMetadata(r, packet->m_body, packet->m_nBodySize)) bHasMediaPacket = 1; break; // RTMPæ¶ˆæ¯ç±»å‹ID=19ï¼ŒAMF0ç¼–ç ï¼Œå¿½ç•¥ case RTMP_PACKET_TYPE_SHARED_OBJECT: RTMP_Log(RTMP_LOGDEBUG, \"%s, shared object, not supported, ignoring\", __FUNCTION__); break; // RTMPæ¶ˆæ¯ç±»å‹ID=20ï¼ŒAMF0ç¼–ç ï¼Œå‘½ä»¤æ¶ˆæ¯ // å¤„ç†å‘½ä»¤æ¶ˆæ¯ï¼ case RTMP_PACKET_TYPE_INVOKE: /* invoke */ RTMP_Log(RTMP_LOGDEBUG, \"%s, received: invoke %u bytes\", __FUNCTION__, packet->m_nBodySize); RTMP_Log(RTMP_LOGDEBUG, \"CCQ: %s å¤„ç†æ¶ˆæ¯ (typeID=20ï¼ŒAMF0ç¼–ç )\", __FUNCTION__); /*RTMP_LogHex(packet.m_body, packet.m_nBodySize); */ if (HandleInvoke(r, packet->m_body, packet->m_nBodySize) == 1) bHasMediaPacket = 2; break; // RTMPæ¶ˆæ¯ç±»å‹ID=22 case RTMP_PACKET_TYPE_FLASH_VIDEO: { /* go through FLV packets and handle metadata packets */ unsigned int pos = 0; uint32_t nTimeStamp = packet->m_nTimeStamp; while (pos + 11 m_nBodySize) { uint32_t dataSize = AMF_DecodeInt24(packet->m_body + pos + 1); /* size without header (11) and prevTagSize (4) */ if (pos + 11 + dataSize + 4 > packet->m_nBodySize) { RTMP_Log(RTMP_LOGWARNING, \"Stream corrupt?!\"); break; } if (packet->m_body[pos] == 0x12) { HandleMetadata(r, packet->m_body + pos + 11, dataSize); } else if (packet->m_body[pos] == 8 || packet->m_body[pos] == 9) { nTimeStamp = AMF_DecodeInt24(packet->m_body + pos + 4); nTimeStamp |= (packet->m_body[pos + 7] m_pausing) r->m_mediaStamp = nTimeStamp; /* FLV tag(s) */ /*RTMP_Log(RTMP_LOGDEBUG, \"%s, received: FLV tag(s) %lu bytes\", __FUNCTION__, packet.m_nBodySize); */ bHasMediaPacket = 1; break; } default: RTMP_Log(RTMP_LOGDEBUG, \"%s, unknown packet type received: 0x%02x\", __FUNCTION__, packet->m_packetType); #ifdef _DEBUG RTMP_LogHex(RTMP_LOGDEBUG, packet->m_body, packet->m_nBodySize); #endif } // è¿”å›å€¼ä¸º1è¡¨ç¤ºæ¨æ‹‰æµæ­£åœ¨æ­£ä½œä¸­ï¼Œä¸º2è¡¨ç¤ºå·²ç»åœæ­¢ return bHasMediaPacket; } å‚è€ƒï¼š RTMPdumpï¼ˆlibRTMPï¼‰ æºä»£ç åˆ†æ 7ï¼š å»ºç«‹ä¸€ä¸ªæµåª’ä½“è¿æ¥ ï¼ˆNetStreaméƒ¨åˆ† 2ï¼‰ librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» "},"pages/librtmp/librtmpæºç ä¹‹ReadN.html":{"url":"pages/librtmp/librtmpæºç ä¹‹ReadN.html","title":"librtmpæºç ä¹‹ReadN","keywords":"","body":"librtmpæºç ä¹‹ReadN // ä»HTTPæˆ–SOCKETä¸­è¯»å–nä¸ªæ•°æ®å­˜æ”¾åœ¨bufferä¸­. static int ReadN(RTMP *r, char *buffer, int n) { int nOriginalSize = n; int avail; char *ptr; r->m_sb.sb_timedout = FALSE; #ifdef _DEBUG memset(buffer, 0, n); #endif ptr = buffer; while (n > 0) { int nBytes = 0, nRead; if (r->Link.protocol & RTMP_FEATURE_HTTP) { int refill = 0; while (!r->m_resplen) { int ret; if (r->m_sb.sb_size m_unackd) HTTP_Post(r, RTMPT_IDLE, \"\", 1); if (RTMPSockBuf_Fill(&r->m_sb) m_sb.sb_timedout) RTMP_Close(r); return 0; } } if ((ret = HTTP_read(r, 0)) == -1) { RTMP_Log(RTMP_LOGDEBUG, \"%s, No valid HTTP response found\", __FUNCTION__); RTMP_Close(r); return 0; } else if (ret == -2) { refill = 1; } else { refill = 0; } } if (r->m_resplen && !r->m_sb.sb_size) RTMPSockBuf_Fill(&r->m_sb); avail = r->m_sb.sb_size; if (avail > r->m_resplen) avail = r->m_resplen; } else { avail = r->m_sb.sb_size; if (avail == 0) { if (RTMPSockBuf_Fill(&r->m_sb) m_sb.sb_timedout) RTMP_Close(r); return 0; } avail = r->m_sb.sb_size; } } nRead = ((n 0) { memcpy(ptr, r->m_sb.sb_start, nRead); r->m_sb.sb_start += nRead; r->m_sb.sb_size -= nRead; nBytes = nRead; r->m_nBytesIn += nRead; if (r->m_bSendCounter && r->m_nBytesIn > ( r->m_nBytesInSent + r->m_nClientBW / 10)) if (!SendBytesReceived(r)) return FALSE; } /*RTMP_Log(RTMP_LOGDEBUG, \"%s: %d bytes\\n\", __FUNCTION__, nBytes); */ #ifdef _DEBUG fwrite(ptr, 1, nBytes, netstackdump_read); #endif if (nBytes == 0) { RTMP_Log(RTMP_LOGDEBUG, \"%s, RTMP socket closed by peer\", __FUNCTION__); /*goto again; */ RTMP_Close(r); break; } if (r->Link.protocol & RTMP_FEATURE_HTTP) r->m_resplen -= nBytes; #ifdef CRYPTO if (r->Link.rc4keyIn) { RC4_encrypt(r->Link.rc4keyIn, nBytes, ptr); } #endif n -= nBytes; ptr += nBytes; } return nOriginalSize - n; } // è°ƒç”¨Socketç¼–ç¨‹ä¸­çš„recv()å‡½æ•°ï¼Œæ¥æ”¶æ•°æ® int RTMPSockBuf_Fill(RTMPSockBuf *sb) { int nBytes; if (!sb->sb_size) sb->sb_start = sb->sb_buf; while (1) { // ç¼“å†²åŒºé•¿åº¦ï¼šæ€»é•¿-æœªå¤„ç†å­—èŠ‚-å·²å¤„ç†å­—èŠ‚ // |-----å·²å¤„ç†--------|-----æœªå¤„ç†--------|---------ç¼“å†²åŒº----------| // sb_buf sb_start sb_size nBytes = sizeof(sb->sb_buf) - 1 - sb->sb_size - (sb->sb_start - sb->sb_buf); #if defined(CRYPTO) && !defined(NO_SSL) if (sb->sb_ssl) { nBytes = TLS_read(sb->sb_ssl, sb->sb_start + sb->sb_size, nBytes); } else #endif { // int recv( SOCKET s, char * buf, int len, int flags); // s ï¼šä¸€ä¸ªæ ‡è¯†å·²è¿æ¥å¥—æ¥å£çš„æè¿°å­—ã€‚ // buf ï¼šç”¨äºæ¥æ”¶æ•°æ®çš„ç¼“å†²åŒºã€‚ // len ï¼šç¼“å†²åŒºé•¿åº¦ã€‚ // flagsï¼šæŒ‡å®šè°ƒç”¨æ–¹å¼ã€‚ // ä»sb_startï¼ˆå¾…å¤„ç†çš„ä¸‹ä¸€å­—èŠ‚ï¼‰ + sb_sizeï¼ˆï¼‰è¿˜æœªå¤„ç†çš„å­—èŠ‚å¼€å§‹bufferä¸ºç©ºï¼Œå¯ä»¥å­˜å‚¨ nBytes = recv(sb->sb_socket, sb->sb_start + sb->sb_size, nBytes, 0); } if (nBytes != -1) { // æœªå¤„ç†çš„å­—èŠ‚åˆå¤šäº† sb->sb_size += nBytes; } else { int sockerr = GetSockError(); RTMP_Log(RTMP_LOGDEBUG, \"%s, recv returned %d. GetSockError(): %d (%s)\", __FUNCTION__, nBytes, sockerr, strerror(sockerr)); if (sockerr == EINTR && !RTMP_ctrlC) continue; if (sockerr == EWOULDBLOCK || sockerr == EAGAIN) { sb->sb_timedout = TRUE; nBytes = 0; } } break; } return nBytes; } å‚è€ƒï¼š RTMPæ¨æµåŠåè®®å­¦ä¹  RTMPdumpï¼ˆlibRTMPï¼‰ æºä»£ç åˆ†æ 9ï¼š æ¥æ”¶æ¶ˆæ¯ï¼ˆMessageï¼‰ï¼ˆæ¥æ”¶è§†éŸ³é¢‘æ•°æ®ï¼‰ "},"pages/librtmp/librtmpæºç ä¹‹HandleInvoke.html":{"url":"pages/librtmp/librtmpæºç ä¹‹HandleInvoke.html","title":"librtmpæºç ä¹‹HandleInvoke","keywords":"","body":"librtmpæºç ä¹‹HandleInvoke // å¤„ç†æœåŠ¡å™¨å‘æ¥çš„AMF0ç¼–ç çš„å‘½ä»¤ /* Returns 0 for OK/Failed/error, 1 for 'Stop or Complete' */ static int HandleInvoke(RTMP *r, const char *body, unsigned int nBodySize){ AMFObject obj; AVal method; double txn; int ret = 0, nRes; // ç¡®ä¿å“åº”æŠ¥æ–‡æ˜¯0x14çš„å‘½ä»¤å­— // 0x02:string if (body[0] != 0x02) /* make sure it is a string method name we start with */ { RTMP_Log(RTMP_LOGWARNING, \"%s, Sanity failed. no string method in invoke packet\", __FUNCTION__); return 0; } // å°†å„å‚æ•°ä»¥æ— åç§°çš„å¯¹è±¡å±æ€§æ–¹å¼è¿›è¡Œè§£æ nRes = AMF_Decode(&obj, body, nBodySize, FALSE); if (nRes \", __FUNCTION__, method.av_val); // æ¥æ”¶åˆ°æœåŠ¡ç«¯è¿”å›çš„ä¸€ä¸ª_resultåŒ…ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰¾åˆ°è¿™ä¸ªåŒ…å¯¹åº”çš„é‚£æ¡å‘½ä»¤ï¼Œä»è€Œå¤„ç†è¿™æ¡å‘½ä»¤çš„å¯¹åº”äº‹ä»¶ã€‚ // æ¯”å¦‚æˆ‘ä»¬ä¹‹å‰å‘é€äº†ä¸ªconnectç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å¿…ç„¶ä¼šè¿”å›_resultï¼Œç„¶åæˆ‘ä»¬å¼‚æ­¥æ”¶åˆ°resultåï¼Œä¼šè°ƒç”¨ // RTMP_SendServerBW,RTMP_SendCtrl,ä»¥åŠRTMP_SendCreateStreamæ¥åˆ›å»ºä¸€ä¸ªstream // è¿‡ç¨‹åç§°ä¸º_result if (AVMATCH(&method, &av__result)) { AVal methodInvoked = {0}; int i; // åˆ é™¤è¯·æ±‚é˜Ÿåˆ—ä¸­çš„æµæ°´é¡¹ for (i=0; im_numCalls; i++) { // æ‰¾åˆ°è¿™æ¡æŒ‡ä»¤å¯¹åº”çš„è§¦å‘çš„æ–¹æ³• if (r->m_methodCalls[i].num == (int)txn) { methodInvoked = r->m_methodCalls[i].name; AV_erase(r->m_methodCalls, &r->m_numCalls, i, FALSE); break; } } if (!methodInvoked.av_val) { RTMP_Log(RTMP_LOGDEBUG, \"%s, received result id %f without matching request\", __FUNCTION__, txn); goto leave; } RTMP_Log(RTMP_LOGDEBUG, \"%s, received result for method call \", __FUNCTION__, methodInvoked.av_val); // æ‰¾åˆ°äº†è¿æ¥è¯·æ±‚ï¼Œç¡®è®¤æ˜¯è¿æ¥å“åº” if (AVMATCH(&methodInvoked, &av_connect)) { if (r->Link.token.av_len) { AMFObjectProperty p; if (RTMP_FindFirstMatchingProperty(&obj, &av_secureToken, &p)) { DecodeTEA(&r->Link.token, &p.p_vu.p_aval); SendSecureTokenResponse(r, &p.p_vu.p_aval); } } // å®¢æˆ·ç«¯æ¨æµ if (r->Link.protocol & RTMP_FEATURE_WRITE) { // é€šçŸ¥æœåŠ¡å™¨é‡Šæ”¾æµé€šé“å’Œæ¸…ç†æ¨æµèµ„æº SendReleaseStream(r); SendFCPublish(r); } // å®¢æˆ·ç«¯æ‹‰æµ else { // è®¾ç½®æœåŠ¡å™¨çš„åº”ç­”çª—å£å¤§å° // å‘Šè¯‰æœåŠ¡ç«¯ï¼Œæˆ‘ä»¬çš„æœŸæœ›æ˜¯ä»€ä¹ˆï¼Œçª—å£å¤§å°ï¼Œç­‰ RTMP_SendServerBW(r); RTMP_SendCtrl(r, 3, 0, 300); } // å‘é€åˆ›å»ºæµé€šé“è¯·æ±‚ // å› ä¸ºæœåŠ¡ç«¯åŒæ„äº†æˆ‘ä»¬çš„connectï¼Œæ‰€ä»¥è¿™é‡Œå‘é€createStreamåˆ›å»ºä¸€ä¸ªæµ // åˆ›å»ºå®Œæˆåï¼Œä¼šå†æ¬¡è¿›å¦‚è¿™ä¸ªå‡½æ•°ä»è€Œèµ°åˆ°ä¸‹é¢çš„av_createStreamåˆ†æ”¯ï¼Œä»è€Œå‘é€playè¿‡å» RTMP_SendCreateStream(r); if (!(r->Link.protocol & RTMP_FEATURE_WRITE)) { /* Authenticate on Justin.tv legacy servers before sending FCSubscribe */ if (r->Link.usherToken.av_len) SendUsherToken(r, &r->Link.usherToken); /* Send the FCSubscribe if live stream or if subscribepath is set */ if (r->Link.subscribepath.av_len) SendFCSubscribe(r, &r->Link.subscribepath); else if (r->Link.lFlags & RTMP_LF_LIVE) SendFCSubscribe(r, &r->Link.playpath); } } // æ‰¾åˆ°äº†åˆ›å»ºæµè¯·æ±‚ï¼Œç¡®è®¤æ˜¯åˆ›å»ºæµçš„å“åº” else if (AVMATCH(&methodInvoked, &av_createStream)) { // ä»å“åº”ä¸­å–æµID r->m_stream_id = (int)AMFProp_GetNumber(AMF_GetProp(&obj, NULL, 3)); // å®¢æˆ·ç«¯æ¨æµ if (r->Link.protocol & RTMP_FEATURE_WRITE) { // å‘é€æ¨æµç‚¹ // å¦‚æœæ˜¯è¦å‘é€ï¼Œé‚£ä¹ˆé«˜å°šæœåŠ¡ç«¯ï¼Œæˆ‘ä»¬è¦å‘æ•°æ® SendPublish(r); } // å®¢æˆ·ç«¯æ‹‰æµ else { // å¦åˆ™å‘Šè¯‰ä»–æˆ‘ä»¬è¦æ¥å—æ•°æ® if (r->Link.lFlags & RTMP_LF_PLST) SendPlaylist(r); // å‘é€playè¿‡å» // å‘é€æ‹‰æµç‚¹ SendPlay(r); // ä»¥åŠæˆ‘ä»¬çš„bufå¤§å° // å‘é€æ‹‰æµç¼“å†²æ—¶é•¿ RTMP_SendCtrl(r, 3, r->m_stream_id, r->m_nBufferMS); } } // æ‰¾åˆ°äº†æ¨æµå’Œæ‹‰æµè¯·æ±‚ï¼Œç¡®è®¤æ˜¯å®ƒä»¬çš„å“åº” else if (AVMATCH(&methodInvoked, &av_play) || AVMATCH(&methodInvoked, &av_publish)) { // æ¥æ”¶åˆ°äº†playçš„å›å¤ï¼Œé‚£ä¹ˆæ ‡è®°ä¸ºplay // æ ‡è¯†å·²ç»è¿›å…¥æµçŠ¶æ€ r->m_bPlaying = TRUE; } free(methodInvoked.av_val); } else if (AVMATCH(&method, &av_onBWDone)) { if (!r->m_nBWCheckCounter) SendCheckBW(r); } else if (AVMATCH(&method, &av_onFCSubscribe)) { /* SendOnFCSubscribe(); */ } else if (AVMATCH(&method, &av_onFCUnsubscribe)) { RTMP_Close(r); ret = 1; } // è¿‡ç¨‹åç§°ä¸ºping else if (AVMATCH(&method, &av_ping)) { // å‘é€pongå“åº” SendPong(r, txn); } else if (AVMATCH(&method, &av__onbwcheck)) { SendCheckBWResult(r, txn); } else if (AVMATCH(&method, &av__onbwdone)) { int i; for (i = 0; i m_numCalls; i++) if (AVMATCH(&r->m_methodCalls[i].name, &av__checkbw)) { AV_erase(r->m_methodCalls, &r->m_numCalls, i, TRUE); break; } } // è¿‡ç¨‹åç§°ä¸º_error else if (AVMATCH(&method, &av__error)) { #ifdef CRYPTO AVal methodInvoked = {0}; int i; if (r->Link.protocol & RTMP_FEATURE_WRITE) { for (i=0; im_numCalls; i++) { if (r->m_methodCalls[i].num == txn) { methodInvoked = r->m_methodCalls[i].name; AV_erase(r->m_methodCalls, &r->m_numCalls, i, FALSE); break; } } if (!methodInvoked.av_val) { RTMP_Log(RTMP_LOGDEBUG, \"%s, received result id %f without matching request\", __FUNCTION__, txn); goto leave; } RTMP_Log(RTMP_LOGDEBUG, \"%s, received error for method call \", __FUNCTION__, methodInvoked.av_val); if (AVMATCH(&methodInvoked, &av_connect)) { AMFObject obj2; AVal code, level, description; AMFProp_GetObject(AMF_GetProp(&obj, NULL, 3), &obj2); AMFProp_GetString(AMF_GetProp(&obj2, &av_code, -1), &code); AMFProp_GetString(AMF_GetProp(&obj2, &av_level, -1), &level); AMFProp_GetString(AMF_GetProp(&obj2, &av_description, -1), &description); RTMP_Log(RTMP_LOGDEBUG, \"%s, error description: %s\", __FUNCTION__, description.av_val); /* if PublisherAuth returns 1, then reconnect */ if (PublisherAuth(r, &description) == 1) { CloseInternal(r, 1); if (!RTMP_Connect(r, NULL) || !RTMP_ConnectStream(r, 0)) goto leave; } } } else { RTMP_Log(RTMP_LOGERROR, \"rtmp server sent error\"); } free(methodInvoked.av_val); #else RTMP_Log(RTMP_LOGERROR, \"rtmp server sent error\"); #endif } // è¿‡ç¨‹åç§°ä¸ºclose else if (AVMATCH(&method, &av_close)) { RTMP_Log(RTMP_LOGERROR, \"rtmp server requested close\"); RTMP_Close(r); } // è¿‡ç¨‹åç§°ä¸ºonStatus else if (AVMATCH(&method, &av_onStatus)) { // è·å–è¿”å›å¯¹è±¡åŠå…¶ä¸»è¦å±æ€§ AMFObject obj2; AVal code, level; AMFProp_GetObject(AMF_GetProp(&obj, NULL, 3), &obj2); AMFProp_GetString(AMF_GetProp(&obj2, &av_code, -1), &code); AMFProp_GetString(AMF_GetProp(&obj2, &av_level, -1), &level); RTMP_Log(RTMP_LOGDEBUG, \"%s, onStatus: %s\", __FUNCTION__, code.av_val); // å‡ºé”™è¿”å› if (AVMATCH(&code, &av_NetStream_Failed) || AVMATCH(&code, &av_NetStream_Play_Failed) || AVMATCH(&code, &av_NetStream_Play_StreamNotFound) || AVMATCH(&code, &av_NetConnection_Connect_InvalidApp)) { r->m_stream_id = -1; RTMP_Close(r); RTMP_Log(RTMP_LOGERROR, \"Closing connection: %s\", code.av_val); } // å¯åŠ¨æ‹‰æµæˆåŠŸ else if (AVMATCH(&code, &av_NetStream_Play_Start) || AVMATCH(&code, &av_NetStream_Play_PublishNotify)) { int i; r->m_bPlaying = TRUE; for (i = 0; i m_numCalls; i++) { if (AVMATCH(&r->m_methodCalls[i].name, &av_play)) { AV_erase(r->m_methodCalls, &r->m_numCalls, i, TRUE); break; } } } // å¯åŠ¨æ¨æµæˆåŠŸ else if (AVMATCH(&code, &av_NetStream_Publish_Start)) { int i; r->m_bPlaying = TRUE; for (i = 0; i m_numCalls; i++) { if (AVMATCH(&r->m_methodCalls[i].name, &av_publish)) { AV_erase(r->m_methodCalls, &r->m_numCalls, i, TRUE); break; } } } // é€šçŸ¥æµå®Œæˆæˆ–ç»“æŸ /* Return 1 if this is a Play.Complete or Play.Stop */ else if (AVMATCH(&code, &av_NetStream_Play_Complete) || AVMATCH(&code, &av_NetStream_Play_Stop) || AVMATCH(&code, &av_NetStream_Play_UnpublishNotify)) { RTMP_Close(r); ret = 1; } else if (AVMATCH(&code, &av_NetStream_Seek_Notify)) { r->m_read.flags &= ~RTMP_READ_SEEKING; } // é€šçŸ¥æµæš‚åœ else if (AVMATCH(&code, &av_NetStream_Pause_Notify)) { if (r->m_pausing == 1 || r->m_pausing == 2) { RTMP_SendPause(r, FALSE, r->m_pauseStamp); r->m_pausing = 3; } } } else if (AVMATCH(&method, &av_playlist_ready)) { int i; for (i = 0; i m_numCalls; i++) { if (AVMATCH(&r->m_methodCalls[i].name, &av_set_playlist)) { AV_erase(r->m_methodCalls, &r->m_numCalls, i, TRUE); break; } } } else { } leave: AMF_Reset(&obj); return ret; } å‚è€ƒï¼š librtmpå®æ—¶æ¶ˆæ¯ä¼ è¾“åè®®(RTMP)åº“ä»£ç æµ…æ librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» RTMPdumpï¼ˆlibRTMPï¼‰ æºä»£ç åˆ†æ 7ï¼š å»ºç«‹ä¸€ä¸ªæµåª’ä½“è¿æ¥ ï¼ˆNetStreaméƒ¨åˆ† 2ï¼‰ æ‰‹æ’•Rtmpåè®®ç»†èŠ‚ï¼ˆ3ï¼‰â€”â€”Rtmp Body "},"pages/librtmp/librtmpæºç ä¹‹SendReleaseStream.html":{"url":"pages/librtmp/librtmpæºç ä¹‹SendReleaseStream.html","title":"librtmpæºç ä¹‹SendReleaseStream","keywords":"","body":"librtmpæºç ä¹‹SendReleaseStream // å‘é€RealeaseStreamå‘½ä»¤ // Real Time Messaging Protocol (AMF0 Command releaseStream()) // RTMP Header // 01.. .... = Format: 1 // ..00 0011 = Chunk Stream ID: 3 // Timestamp delta: 0 // Timestamp: 0 (calculated) // Body size: 39 // Type ID: AMF0 Command (0x14) // RTMP Body // String 'releaseStream' // Number 2 // Null // String 'livestream' static int SendReleaseStream(RTMP *r) { RTMPPacket packet; char pbuf[1024], *pend = pbuf + sizeof(pbuf); char *enc; // å—æµIDï¼Œ`..00 0011 = Chunk Stream ID: 3`ä¸­çš„11ï¼Œç¬¬1ä¸ªå­—èŠ‚çš„ä½ä¸¤ä½ packet.m_nChannel = 0x03; /* control channel (invoke) */ // å—ç±»å‹IDï¼Œ`01.. .... = Format: 1`ä¸­çš„01ï¼Œç¬¬1ä¸ªå­—èŠ‚çš„é«˜ä¸¤ä½ packet.m_headerType = RTMP_PACKET_SIZE_MEDIUM; // å‘½ä»¤ç±»å‹IDï¼Œ`Type ID: AMF0 Command (0x14)`ï¼Œç¬¬8ä¸ªå­—èŠ‚ packet.m_packetType = RTMP_PACKET_TYPE_INVOKE; // æ—¶é—´æˆ³ç¬¬2ã€3ã€4å­—èŠ‚ packet.m_nTimeStamp = 0; // æ¶ˆæ¯æµIDï¼Œè¿™é‡Œå—ç±»å‹IDä¸º1ï¼Œåªæœ‰8ä¸ªå­—èŠ‚ï¼Œè¿™é‡Œæ˜¯æ²¡æœ‰æ¶ˆæ¯æµIDçš„ packet.m_nInfoField2 = 0; // æ˜¯å¦æ˜¯ç»å¯¹æ—¶é—´æˆ³(ç±»å‹1æ—¶ä¸ºtrue) packet.m_hasAbsTimestamp = 0; // å—bodyæŒ‡é’ˆï¼Œå‰é¢18ï¼ˆRTMP_MAX_HEADER_SIZEï¼‰å­—èŠ‚ç”¨æ¥æ”¾å—å¤´ï¼Œåé¢æ”¾body packet.m_body = pbuf + RTMP_MAX_HEADER_SIZE; // è®¾ç½®bodyå¼€å§‹ä½ç½® enc = packet.m_body; // å¯¹â€œreleaseStreamâ€å­—ç¬¦ä¸²è¿›è¡ŒAMFç¼–ç  enc = AMF_EncodeString(enc, pend, &av_releaseStream); // å¯¹ä¼ è¾“IDï¼ˆ0ï¼‰è¿›è¡ŒAMFç¼–ç ï¼Œ0x14å‘½ä»¤è¿œç¨‹è¿‡ç¨‹è°ƒç”¨è®¡æ•° enc = AMF_EncodeNumber(enc, pend, ++r->m_numInvokes); // ç¼–ç Null *enc++ = AMF_NULL; // å¯¹æ’­æ”¾è·¯å¾„å­—ç¬¦ä¸²è¿›è¡ŒAMFç¼–ç ï¼Œlivestream enc = AMF_EncodeString(enc, pend, &r->Link.playpath); if (!enc) return FALSE; // å—bodyå¤§å°ï¼Œç¬¬5ã€6ã€7ä¸ªå­—èŠ‚ packet.m_nBodySize = enc - packet.m_body; return RTMP_SendPacket(r, &packet, FALSE); } å‚è€ƒï¼š librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» RTMPdumpï¼ˆlibRTMPï¼‰ æºä»£ç åˆ†æ 8ï¼š å‘é€æ¶ˆæ¯ï¼ˆMessageï¼‰ï¼‰ æ‰‹æ’•rtmpåè®®ç»†èŠ‚ï¼ˆ2ï¼‰â€”â€”rtmp Header æ‰‹æ’•Rtmpåè®®ç»†èŠ‚ï¼ˆ3ï¼‰â€”â€”Rtmp Body "},"pages/librtmp/librtmpæºç ä¹‹SendFCPublish.html":{"url":"pages/librtmp/librtmpæºç ä¹‹SendFCPublish.html","title":"librtmpæºç ä¹‹SendFCPublish","keywords":"","body":"librtmpæºç ä¹‹SendFCPublish // å‘é€å‡†å¤‡æ¨æµç‚¹è¯·æ±‚ // Real Time Messaging Protocol (AMF0 Command FCPublish()) // RTMP Header // 01.. .... = Format: 1 // ..00 0011 = Chunk Stream ID: 3 // Timestamp delta: 0 // Timestamp: 0 (calculated) // Body size: 35 // Type ID: AMF0 Command (0x14) // RTMP Body // String 'FCPublish' // AMF0 type: String (0x02) // String length: 9 // String: FCPublish // Number 3 // AMF0 type: Number (0x00) // Number: 3 // Null // AMF0 type: Null (0x05) // String 'livestream' // AMF0 type: String (0x02) // String length: 10 // String: livestream static int SendFCPublish(RTMP *r) { RTMPPacket packet; char pbuf[1024], *pend = pbuf + sizeof(pbuf); char *enc; packet.m_nChannel = 0x03; /* control channel (invoke) */ packet.m_headerType = RTMP_PACKET_SIZE_MEDIUM; packet.m_packetType = RTMP_PACKET_TYPE_INVOKE; packet.m_nTimeStamp = 0; packet.m_nInfoField2 = 0; packet.m_hasAbsTimestamp = 0; packet.m_body = pbuf + RTMP_MAX_HEADER_SIZE; enc = packet.m_body; // å¯¹â€œFCPublishâ€å­—ç¬¦ä¸²è¿›è¡ŒAMFç¼–ç  enc = AMF_EncodeString(enc, pend, &av_FCPublish); enc = AMF_EncodeNumber(enc, pend, ++r->m_numInvokes); *enc++ = AMF_NULL; enc = AMF_EncodeString(enc, pend, &r->Link.playpath); if (!enc) return FALSE; packet.m_nBodySize = enc - packet.m_body; return RTMP_SendPacket(r, &packet, FALSE); } å’ŒSendReleaseStreamå‡½æ•°ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨ä¸bodyçš„ç¬¬ä¸€ä¸ªå­—æ®µæ˜¯FCPublishã€‚ å‚è€ƒï¼š librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» "},"pages/librtmp/librtmpæºç ä¹‹RTMP_SendServerBW.html":{"url":"pages/librtmp/librtmpæºç ä¹‹RTMP_SendServerBW.html","title":"librtmpæºç ä¹‹RTMP_SendServerBW","keywords":"","body":"librtmpæºç ä¹‹RTMP_SendServerBW // è®¾ç½®ç¼“å†²å¤§å° int RTMP_SendServerBW(RTMP *r) { RTMPPacket packet; char pbuf[256], *pend = pbuf + sizeof(pbuf); // Chunk Stream IDç”¨æ¥è¡¨ç¤ºæ¶ˆæ¯çš„çº§åˆ« // 2:low level // å—æµIDï¼Œ`..00 0010 = Chunk Stream ID: 2`ä¸­çš„11ï¼Œç¬¬1ä¸ªå­—èŠ‚çš„ä½ä¸¤ä½ packet.m_nChannel = 0x02; /* control channel (invoke) */ // Formatä¸º0çš„æ—¶å€™ï¼ŒRTMP Headerçš„é•¿åº¦ä¸º12 // å—ç±»å‹IDï¼Œ`01.. .... = Format: 1`ä¸­çš„01ï¼Œç¬¬1ä¸ªå­—èŠ‚çš„é«˜ä¸¤ä½ packet.m_headerType = RTMP_PACKET_SIZE_LARGE; // #define RTMP_PACKET_TYPE_SERVER_BW 0x05 // å‘½ä»¤ç±»å‹IDï¼Œ`Type ID: AMF0 Command (0x14)`ï¼Œç¬¬8ä¸ªå­—èŠ‚ packet.m_packetType = RTMP_PACKET_TYPE_SERVER_BW; // æ—¶é—´æˆ³ç¬¬2ã€3ã€4å­—èŠ‚ packet.m_nTimeStamp = 0; // æ¶ˆæ¯æµIDï¼Œè¿™é‡Œå—ç±»å‹IDä¸º1ï¼Œæœ‰12ä¸ªå­—èŠ‚ï¼Œè¿™é‡Œæ˜¯æ²¡æœ‰æ¶ˆæ¯æµIDçš„ packet.m_nInfoField2 = 0; // æ˜¯å¦æ˜¯ç»å¯¹æ—¶é—´æˆ³(ç±»å‹1æ—¶ä¸ºtrue) packet.m_hasAbsTimestamp = 0; // å—bodyæŒ‡é’ˆï¼Œå‰é¢18ï¼ˆRTMP_MAX_HEADER_SIZEï¼‰å­—èŠ‚ç”¨æ¥æ”¾å—å¤´ï¼Œåé¢æ”¾body packet.m_body = pbuf + RTMP_MAX_HEADER_SIZE; // å—bodyå¤§å°ï¼Œç¬¬5ã€6ã€7ä¸ªå­—èŠ‚ packet.m_nBodySize = 4; // å‹å…¥4å­—èŠ‚å¸¦å®½ AMF_EncodeInt32(packet.m_body, pend, r->m_nServerBW); return RTMP_SendPacket(r, &packet, FALSE); } å‚è€ƒï¼š librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» "},"pages/librtmp/librtmpæºç ä¹‹RTMP_SendCtrl.html":{"url":"pages/librtmp/librtmpæºç ä¹‹RTMP_SendCtrl.html","title":"librtmpæºç ä¹‹RTMP_SendCtrl","keywords":"","body":"librtmpæºç ä¹‹RTMP_SendCtrl // å‘é€ç”¨æˆ¶æ§åˆ¶æ¶ˆæ¯ //Ping æ˜¯ RTMP ä¸­æœ€ç¥ç§˜çš„æ¶ˆæ¯ï¼Œç›´åˆ°ç°åœ¨æˆ‘ä»¬è¿˜æ²¡æœ‰å®Œå…¨è§£é‡Šå®ƒã€‚æ€»ä¹‹ï¼ŒPing æ¶ˆæ¯ç”¨ä½œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´äº¤æ¢çš„ç‰¹æ®Šå‘½ä»¤ã€‚æ­¤é¡µé¢æ—¨åœ¨è®°å½•æ‰€æœ‰å·²çŸ¥çš„ Ping æ¶ˆæ¯ã€‚é¢„è®¡åå•ä¼šå¢é•¿ã€‚ // //Ping æ•°æ®åŒ…çš„ç±»å‹ä¸º 0x4ï¼ŒåŒ…å«ä¸¤ä¸ªå¼ºåˆ¶å‚æ•°å’Œä¸¤ä¸ªå¯é€‰å‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ Ping çš„ç±»å‹ï¼Œç®€ç§°æ•´æ•°ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯ ping çš„ç›®æ ‡ã€‚ç”±äº Ping å§‹ç»ˆåœ¨ Channel 2ï¼ˆæ§åˆ¶é€šé“ï¼‰ä¸­å‘é€ï¼Œå¹¶ä¸” RTMP æ ‡å¤´ä¸­çš„ç›®æ ‡å¯¹è±¡å§‹ç»ˆä¸º 0ï¼Œè¿™æ„å‘³ç€ Connection å¯¹è±¡ï¼Œå› æ­¤æœ‰å¿…è¦æ”¾ç½®ä¸€ä¸ªé¢å¤–çš„å‚æ•°æ¥æŒ‡ç¤º Ping å‘é€åˆ°çš„ç¡®åˆ‡ç›®æ ‡å¯¹è±¡ã€‚ç¬¬äºŒä¸ªå‚æ•°æ‰¿æ‹…è¿™ä¸ªè´£ä»»ã€‚è¯¥å€¼ä¸ RTMP å¤´ä¸­çš„ç›®æ ‡å¯¹è±¡å­—æ®µå«ä¹‰ç›¸åŒã€‚ ï¼ˆç¬¬äºŒä¸ªå€¼ä¹Ÿå¯ä»¥åšå…¶ä»–ç”¨é€”ï¼Œæ¯”å¦‚RTT Ping/Pongã€‚å®ƒç”¨ä½œæ—¶é—´æˆ³ã€‚ï¼‰ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥çœ‹ä½œæ˜¯PingåŒ…çš„å‚æ•°ã€‚ä»¥ä¸‹æ˜¯ Ping æ¶ˆæ¯çš„æ— ç©·æ— å°½çš„åˆ—è¡¨ã€‚ // // * ç±»å‹ 0ï¼šæ¸…é™¤æµã€‚æ²¡æœ‰ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªå‚æ•°ã€‚ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æ˜¯ 0ã€‚å»ºç«‹è¿æ¥åï¼ŒæœåŠ¡å™¨ä¼šå‘å®¢æˆ·ç«¯å‘é€ Ping 0,0ã€‚è¯¥æ¶ˆæ¯è¿˜å°†åœ¨ Play å¼€å§‹æ—¶å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå¹¶å“åº” Seek æˆ– Pause/Resume è¯·æ±‚ã€‚æ­¤ Ping å‘Šè¯‰å®¢æˆ·ç«¯ä½¿ç”¨ä¸‹ä¸€ä¸ªæ•°æ®åŒ…æœåŠ¡å™¨å‘é€çš„æ—¶é—´æˆ³é‡æ–°æ ¡å‡†æ—¶é’Ÿã€‚ // * ç±»å‹ 1ï¼šå‘Šè¯‰æµæ¸…é™¤æ’­æ”¾ç¼“å†²åŒºã€‚ // * ç±»å‹ 3ï¼šå®¢æˆ·ç«¯çš„ç¼“å†²æ—¶é—´ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä»¥æ¯«ç§’ä¸ºå•ä½çš„ç¼“å†²æ—¶é—´ã€‚ // * ç±»å‹ 4ï¼šé‡ç½®æµã€‚åœ¨ VOD çš„æƒ…å†µä¸‹ä¸ç±»å‹ 0 ä¸€èµ·ä½¿ç”¨ã€‚é€šå¸¸åœ¨ç±»å‹ 0 ä¹‹å‰å‘é€ã€‚ // * ç±»å‹ 6ï¼šä»æœåŠ¡å™¨ Ping å®¢æˆ·ç«¯ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯å½“å‰æ—¶é—´ã€‚ // * ç±»å‹ 7ï¼šæ¥è‡ªå®¢æˆ·çš„ Pong å›å¤ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯æœåŠ¡å™¨å‘é€ä»–çš„ ping è¯·æ±‚çš„æ—¶é—´ã€‚ // * ç±»å‹ 26ï¼šSWFVerification è¯·æ±‚ // * ç±»å‹ 27ï¼šSWFVerification å“åº” int RTMP_SendCtrl(RTMP *r, short nType, unsigned int nObject, unsigned int nTime) { RTMPPacket packet; char pbuf[256], *pend = pbuf + sizeof(pbuf); int nSize; char *buf; RTMP_Log(RTMP_LOGDEBUG, \"sending ctrl. type: 0x%04x\", (unsigned short)nType); packet.m_nChannel = 0x02; /* control channel (ping) */ packet.m_headerType = RTMP_PACKET_SIZE_MEDIUM; // #define RTMP_PACKET_TYPE_CONTROL 0x04 packet.m_packetType = RTMP_PACKET_TYPE_CONTROL; packet.m_nTimeStamp = 0; /* RTMP_GetTime(); */ packet.m_nInfoField2 = 0; packet.m_hasAbsTimestamp = 0; packet.m_body = pbuf + RTMP_MAX_HEADER_SIZE; switch(nType) { case 0x03: nSize = 10; break; /* buffer time */ case 0x1A: nSize = 3; break; /* SWF verify request */ case 0x1B: nSize = 44; break; /* SWF verify response */ default: nSize = 6; break; } packet.m_nBodySize = nSize; buf = packet.m_body; buf = AMF_EncodeInt16(buf, pend, nType); if (nType == 0x1B) { #ifdef CRYPTO memcpy(buf, r->Link.SWFVerificationResponse, 42); RTMP_Log(RTMP_LOGDEBUG, \"Sending SWFVerification response: \"); RTMP_LogHex(RTMP_LOGDEBUG, (uint8_t *)packet.m_body, packet.m_nBodySize); #endif } else if (nType == 0x1A) { *buf = nObject & 0xff; } else { if (nSize > 2) buf = AMF_EncodeInt32(buf, pend, nObject); if (nSize > 6) buf = AMF_EncodeInt32(buf, pend, nTime); } return RTMP_SendPacket(r, &packet, FALSE); } å‚è€ƒï¼š librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» "},"pages/librtmp/librtmpæºç ä¹‹RTMP_SendCreateStream.html":{"url":"pages/librtmp/librtmpæºç ä¹‹RTMP_SendCreateStream.html","title":"librtmpæºç ä¹‹RTMP_SendCreateStream","keywords":"","body":"librtmpæºç ä¹‹RTMP_SendCreateStream // å‘é€åˆ›å»ºæµè¯·æ±‚ int RTMP_SendCreateStream(RTMP *r) { RTMPPacket packet; char pbuf[256], *pend = pbuf + sizeof(pbuf); char *enc; packet.m_nChannel = 0x03; /* control channel (invoke) */ packet.m_headerType = RTMP_PACKET_SIZE_MEDIUM; packet.m_packetType = RTMP_PACKET_TYPE_INVOKE; packet.m_nTimeStamp = 0; packet.m_nInfoField2 = 0; packet.m_hasAbsTimestamp = 0; packet.m_body = pbuf + RTMP_MAX_HEADER_SIZE; enc = packet.m_body; enc = AMF_EncodeString(enc, pend, &av_createStream); enc = AMF_EncodeNumber(enc, pend, ++r->m_numInvokes); *enc++ = AMF_NULL; /* NULL */ packet.m_nBodySize = enc - packet.m_body; return RTMP_SendPacket(r, &packet, TRUE); } å†…å®¹å’ŒSendReleaseStreamå‡½æ•°å·®ä¸å¤šï¼Œåªä¸è¿‡å‘½ä»¤æ”¹ç”¨äº†av_createStreamã€‚ å‚è€ƒï¼š librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» "},"pages/librtmp/librtmpæºç ä¹‹SendPublish.html":{"url":"pages/librtmp/librtmpæºç ä¹‹SendPublish.html","title":"librtmpæºç ä¹‹SendPublish","keywords":"","body":"librtmpæºç ä¹‹SendPublish // å‘é€Publishå‘½ä»¤ static int SendPublish(RTMP *r) { RTMPPacket packet; char pbuf[1024], *pend = pbuf + sizeof(pbuf); char *enc; // å—æµIDï¼Œ04: control stream packet.m_nChannel = 0x04; /* source channel (invoke) */ packet.m_headerType = RTMP_PACKET_SIZE_LARGE; packet.m_packetType = RTMP_PACKET_TYPE_INVOKE; packet.m_nTimeStamp = 0; // æ¶ˆæ¯æµIDï¼Œè¿™ä¸ªæ—¶å€™å°±æœ‰äº†æµIDï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨æ”¶åˆ°æœåŠ¡å™¨è¿”å›åˆ›å»ºæµçš„æ—¶å€™è°ƒç”¨ packet.m_nInfoField2 = r->m_stream_id; packet.m_hasAbsTimestamp = 0; packet.m_body = pbuf + RTMP_MAX_HEADER_SIZE; enc = packet.m_body; // å‹å…¥publish enc = AMF_EncodeString(enc, pend, &av_publish); enc = AMF_EncodeNumber(enc, pend, ++r->m_numInvokes); *enc++ = AMF_NULL; enc = AMF_EncodeString(enc, pend, &r->Link.playpath); if (!enc) return FALSE; /* FIXME: should we choose live based on Link.lFlags & RTMP_LF_LIVE? */ enc = AMF_EncodeString(enc, pend, &av_live); if (!enc) return FALSE; packet.m_nBodySize = enc - packet.m_body; return RTMP_SendPacket(r, &packet, TRUE); } å‚è€ƒï¼š RTMPdumpï¼ˆlibRTMPï¼‰ æºä»£ç åˆ†æ 8ï¼š å‘é€æ¶ˆæ¯ï¼ˆMessageï¼‰ librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» "},"pages/librtmp/librtmpæºç ä¹‹SendPlay.html":{"url":"pages/librtmp/librtmpæºç ä¹‹SendPlay.html","title":"librtmpæºç ä¹‹SendPlay","keywords":"","body":"librtmpæºç ä¹‹SendPlay // å‘é€å‘½ä»¤â€œæ’­æ”¾â€ static int SendPlay(RTMP *r) { RTMPPacket packet; char pbuf[1024], *pend = pbuf + sizeof(pbuf); char *enc; // 8:control stream packet.m_nChannel = 0x08; /* we make 8 our stream channel */ packet.m_headerType = RTMP_PACKET_SIZE_LARGE; packet.m_packetType = RTMP_PACKET_TYPE_INVOKE; packet.m_nTimeStamp = 0; // æŒ‡å®šæµID packet.m_nInfoField2 = r->m_stream_id; /*0x01000000; */ packet.m_hasAbsTimestamp = 0; packet.m_body = pbuf + RTMP_MAX_HEADER_SIZE; enc = packet.m_body; enc = AMF_EncodeString(enc, pend, &av_play); enc = AMF_EncodeNumber(enc, pend, ++r->m_numInvokes); *enc++ = AMF_NULL; RTMP_Log(RTMP_LOGDEBUG, \"%s, seekTime=%d, stopTime=%d, sending play: %s\", __FUNCTION__, r->Link.seekTime, r->Link.stopTime, r->Link.playpath.av_val); enc = AMF_EncodeString(enc, pend, &r->Link.playpath); if (!enc) return FALSE; // æŒ‡å®šå¼€å§‹æ—¶é—´ /* Optional parameters start and len. * * start: -2, -1, 0, positive number * -2: looks for a live stream, then a recorded stream, * if not found any open a live stream * -1: plays a live stream * >=0: plays a recorded streams from 'start' milliseconds */ // #define RTMP_LF_LIVE 0x0002 /* stream is live */ if (r->Link.lFlags & RTMP_LF_LIVE) enc = AMF_EncodeNumber(enc, pend, -1000.0); else { if (r->Link.seekTime > 0.0) enc = AMF_EncodeNumber(enc, pend, r->Link.seekTime); /* resume from here */ else enc = AMF_EncodeNumber(enc, pend, 0.0); /*-2000.0);*/ /* recorded as default, -2000.0 is not reliable since that freezes the player if the stream is not found */ } if (!enc) return FALSE; // æŒ‡ç‚¹æ’­æ”¾æ—¶é•¿ /* len: -1, 0, positive number * -1: plays live or recorded stream to the end (default) * 0: plays a frame 'start' ms away from the beginning * >0: plays a live or recoded stream for 'len' milliseconds */ /*enc += EncodeNumber(enc, -1.0); */ /* len */ if (r->Link.stopTime) { enc = AMF_EncodeNumber(enc, pend, r->Link.stopTime - r->Link.seekTime); if (!enc) return FALSE; } packet.m_nBodySize = enc - packet.m_body; return RTMP_SendPacket(r, &packet, TRUE); } å‚è€ƒï¼š RTMPå­¦ä¹ ï¼ˆåä¸€ï¼‰rtmpdumpæºç é˜…è¯»ï¼ˆ6ï¼‰è¯·æ±‚æ’­æ”¾ librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» "},"pages/FFmpeg/ç›¸å…³é“¾æ¥.html":{"url":"pages/FFmpeg/ç›¸å…³é“¾æ¥.html","title":"ç›¸å…³é“¾æ¥","keywords":"","body":"ç›¸å…³é“¾æ¥ FFmpegå®˜ç½‘ ç¨‹åºå‘˜ç§˜å¯†:â€ffmpegç¼–è¯‘iosâ€œ çš„æœç´¢ç»“æœ 1.ç¼–è¯‘FFmpegåº“ FFmpegä½¿ç”¨é‡åˆ°é—®é¢˜è®°å½• å®æˆ˜FFmpegï¼ï¼ç¼–è¯‘iOSå¹³å°ä½¿ç”¨çš„FFmpegåº“ï¼ˆæ”¯æŒarm64çš„FFmpeg2.6.2ï¼‰ gas-preprocessor.pl build-ffmpeg.sh FFMpegä¸‹è½½ç¼–è¯‘iOSåº“ iOS audio and video - compiled FFmpeg å…«.FFmepg--ç¼–è¯‘é™æ€åº“(iOS) FFMpeg cross compiler library Android-SO ffmpegä»å…¥é—¨åˆ°å®æˆ˜ Androidæƒé™ java.io.IOExceptionï¼šå¯¹createNewFileï¼ˆï¼‰çš„æƒé™è¢«æ‹’ç» è¯·æ±‚åº”ç”¨æƒé™ è§†é¢‘è§£ç  ä¸€æ–‡è¯»æ‡‚ Android FFmpeg è§†é¢‘è§£ç è¿‡ç¨‹ä¸å®æˆ˜åˆ†æ è§†é¢‘ç¼–ç  FFmpegè§†é¢‘ç¼–ç  YUV420Pç¼–ç H264 Audio and video development (c) - encoded video Audio and video development-audio and video learning materials ffmpegå…¥é—¨æ•™ç¨‹ä¹‹YUVç¼–ç æˆh264 åšå®¢ éŸ³è§†é¢‘å­¦ä¹  é›·éœ„éª… é›·ç¥çš„ã€ŠåŸºäº FFmpeg + SDL çš„è§†é¢‘æ’­æ”¾å™¨çš„åˆ¶ä½œã€‹è¯¾ç¨‹çš„è§†é¢‘ æ–­ç‚¹å®éªŒå®¤ å¦‚ä½•å†™ä¸€ä¸ªä¸åˆ° 1000 è¡Œçš„è§†é¢‘æ’­æ”¾å™¨ è½å½±loyinglin ä¸æœ½çš„ä¼ å¥‡ HBStream 12å¹´ä¸“æ³¨ç›´æ’­ç‚¹æ’­ã€ç½‘ç»œè§†é¢‘æŠ€æœ¯ wcf è¯¾ç¨‹ ã€å…è´¹ã€‘FFmpeg/WebRTC/RTMP/NDK/AndroidéŸ³è§†é¢‘æµåª’ä½“é«˜çº§å¼€å‘ ffmpegå…¥é–€æ•™ç¨‹ æè¶… SDLÂ·lazyfoo tongtong è§†é¢‘ä¸‹è½½ ultravideo yuvè§†é¢‘å¤„ç† media adb macä¸‹å®‰è£…adbç¯å¢ƒçš„ä¸‰ç§æ–¹å¼ adbå‘½ä»¤è¯»å–Androidæ‰‹æœºå†…å­˜å¡æ–‡ä»¶ adbåŸºæœ¬å‘½ä»¤æ“ä½œ(å››) æ¨æ‹‰æµ Nginxå­¦ä¹ ä¹‹é…ç½®RTMPæ¨¡å—æ­å»ºæ¨æµæœåŠ¡ FFmpegé—®é¢˜ ã€ŠFFmpegç²¾è®²ä¸å®æˆ˜ã€‹å¸¸è§é—®é¢˜ä¸è§£ç­” éŸ³é¢‘ç¼–ç  ffmpegå¯¼å…¥x264ã€libfdk_aacå¤–éƒ¨åº“ æ’­æ”¾å™¨ vlc ä¸€ä¸ªå°ç©å…·ï¼šNDKç¼–è¯‘SDLçš„ä¾‹å­ äº¤å‰ç¼–è¯‘sdl2æˆandroidçš„.soåº“ åˆ©ç”¨ffmpegå’ŒSDLå®ç°ä¸€ä¸ªè·¨androidç‰ˆæœ¬çš„éŸ³è§†é¢‘æ’­æ”¾å™¨ SDLæ’­æ”¾YUVâ€”â€”å¾ªç¯ SDLæ’­æ”¾yuv ä½¿ç”¨SDLæ˜¾ç¤ºYUV ffmpegå®æˆ˜æ•™ç¨‹ï¼ˆäºŒï¼‰ç”¨SDLæ’­æ”¾YUVï¼Œå¹¶ç»“åˆffmpegå®ç°ç®€æ˜“æ’­æ”¾å™¨ æœ€ç®€iOSæ’­æ”¾å™¨ï¼ˆäºŒï¼‰ kxmovie iOS åŸºäºffmpegçš„éŸ³è§†é¢‘ç¼–ã€è§£ç ä»¥åŠæ’­æ”¾å™¨çš„åˆ¶ä½œ iOS-FFmpegå®ç°ç®€å•æ’­æ”¾å™¨(ç¼–è¯‘fak-aac+x264+sdl) ffmpeg-video-player ijkplayer ijkplayer ijkplayer#topics ffplayer ffplayer ffplayer åŸç†ã€æ¶æ„åŠä»£ç åˆ†æâ€”â€”æ’­æ”¾å™¨åŠŸèƒ½åŸç† ffplay for mfc ä»£ç å¤‡å¿˜ ffplayåŸºæœ¬ä½¿ç”¨ ffplayer è°ƒè¯• ä½¿ç”¨XCode debug ffmpeg/ffplay ffplayè°ƒè¯•ç¯å¢ƒæ­å»º Windowså¹³å°ä¸Šç¼–è¯‘ffmpegæºç ï¼Œè°ƒè¯•ffplay Xcodeè°ƒè¯•ffmpegæºç (åäº”) ffplayer æºç è§£æ ffplay.cæºç é˜…è¯»ä¹‹éŸ³é¢‘ã€å­—å¹•ã€è§†é¢‘æ¸²æŸ“åŸç†(ä¸€) ffplayæºç åˆ†æ1-æ¦‚è¿° FFPLAYçš„åŸç†ï¼ˆä¸€ï¼‰ Ffplayæºç read_threadè§£è¯»ï¼ˆä¸€ï¼‰ é›¶åŸºç¡€è¯»æ‡‚è§†é¢‘æ’­æ”¾å™¨æ§åˆ¶åŸç†ï¼š ffplay æ’­æ”¾å™¨æºä»£ç åˆ†æ ffplaymfc-ffplaycore.cpp ffplay æ’­æ”¾å™¨æºä»£ç åˆ†æ Fplayæºä»£ç åˆ†æï¼šæ•´ä½“æµç¨‹å›¾ è°ƒè¯•åˆ†æFFmpeg å¸¸ç”¨ç»“æ„ä½“ FFMPEG å®‰è£… æ•™ç¨‹ï¼ˆæ”¯æŒmp3ï¼‰ Ffplayæºç read_threadè§£è¯»ï¼ˆä¸€ï¼‰ ffplay frame queueåˆ†æ ffmpegæºç åˆ†æä¹‹ffplayä¸»æµç¨‹ å¼€æº ffmpeg_develop_doc æƒé™å¤„ç† Android permission deniedåŸå› å½’çº³å’Œè§£å†³åŠæ³• Android11ç¼ºå°‘æƒé™å¯¼è‡´æ— æ³•ä¿®æ”¹åŸæ–‡ä»¶ï¼Œè·å–æ‰€æœ‰æ–‡ä»¶è®¿é—®æƒé™çš„æ–¹æ³• sdl SDLä¸­æ–‡æ•™ç¨‹ SDLè®ºå› Androidå¹³å°ä¸Šä½¿ç”¨SDLå®˜æ–¹demoæ’­æ”¾è§†é¢‘ï¼ˆä½¿ç”¨ffmpegè§£ç ï¼‰ ant NDK NDKä¸‹è½½ Unsupported-Downloads android-ndk-r10e-darwin-x86_64 è§†é¢‘ç¼–è¾‘ YXYVideoEditor SRS æ‰‹æŠŠæ‰‹å¸¦ä½ å®ç°srsæµåª’ä½“æ¨æµå’Œæ‹‰æµæ“ä½œ Chmod 777 to a folder and all contents [duplicate] è…¾è®¯äº‘è½»é‡æœåŠ¡å™¨å¼€æ”¾ç«¯å£æ–¹æ³•æ•™ç¨‹ v4_CN_Home SRS 4.0å¼€å‘ç¯å¢ƒæ­å»º:åŒ…æ‹¬æ¨æµã€æœåŠ¡å™¨é…ç½®ã€æ‹‰æµæµ‹è¯• ffmpeg -re -i ./doc/source.flv -c copy -f flv rtmp://www.1221.site/live/livestream ffmpeg -re -i /Users/you5yi/Downloads/è“è“ä¹‹å¤œ/è“è“ä¹‹å¤œ.1080p.å›½è‹±åŒè¯­.BDä¸­è‹±åŒå­—[66å½±è§†www.66Ys.Co].mkv -c copy -f flv rtmp://www.1221.site/live/livestream LFLiveKit LFLiveKitæºç åˆ†æ LFLiveKit-Review.md iosåŸºäºLFLiveKitçš„ç›´æ’­é¡¹ç›® ç‚¹æ’­ HLSç‚¹æ’­å®ç°ï¼ˆH.264å’ŒAACç æµï¼‰ RTMP åˆ©ç”¨librtmpåº“åœ¨iOSä¸Šè¿›è¡Œæ¨æµ ã€åŸã€‘librtmpæºç è¯¦è§£ è°ƒè¯•libRTMPä»£ç æ¥åˆ†æRTMPåè®® srs-librtmp-for-ios ä»åŠ¨æ‰‹åˆ°æ”¾å¼ƒä¹‹æˆ‘ä¸è¦è‡ªå·±ç¼–è¯‘ffmpegäº† ã€è¸©å‘+è‰ç¨¿ç¯‡ã€‘ ç®€è¿°RTMPDumpä¸ç¼–è¯‘ç§»æ¤ RTMPdump æºä»£ç åˆ†æ 1ï¼š main()å‡½æ•° rtmpæºç åˆ†æä¹‹RTMP_Write å’Œ RTMP_SendPacket librtmpæºç åˆ†æä¹‹æ ¸å¿ƒå®ç°è§£è¯» æµåª’ä½“-RTMPåè®®-librtmpåº“å­¦ä¹ ï¼ˆäºŒï¼‰ RTMPæ¨æµåŠåè®®å­¦ä¹  RTMPåè®®è¯¦è§£åŠå®ä¾‹åˆ†æ RTMP åè®®è§„èŒƒ(ä¸­æ–‡ç‰ˆ) æ‰‹æ’•Rtmpåè®®ç»†èŠ‚ï¼ˆ3ï¼‰â€”â€”Rtmp Body Socket socket()å‡½æ•°ç”¨æ³•è¯¦è§£ï¼šåˆ›å»ºå¥—æ¥å­— "},"pages/FFmpeg/FFmpegç¼–è¯‘.html":{"url":"pages/FFmpeg/FFmpegç¼–è¯‘.html","title":"FFmpegç¼–è¯‘","keywords":"","body":"ç¼–è¯‘FFmpegåº“ ä¸€ã€ä¸‹è½½éŸ³è§†é¢‘æ¡†æ¶ 1. ä¸Šç½‘ä¸‹è½½ ä¸‹è½½ç½‘å€ï¼šhttp://www.ffmpeg.org/download.html 2. Shellè„šæœ¬ä¸‹è½½ 1) ä¸‹è½½å‘½ä»¤curl å®ƒå¯ä»¥é€šè¿‡http\\ftpç­‰ç­‰è¿™æ ·çš„ç½‘ç»œæ–¹å¼ä¸‹è½½å’Œä¸Šä¼ æ–‡ä»¶ï¼ˆå®ƒæ˜¯ä¸€ä¸ªå¼ºå¤§ç½‘ç»œå·¥å…·ï¼‰ã€‚ 2ï¼‰è§£å‹å‘½ä»¤tar è¡¨ç¤ºè§£å‹å’Œå‹ç¼©ï¼ˆæ‰“åŒ…ï¼‰ï¼ŒåŸºæœ¬è¯­æ³•ï¼štar optionsï¼Œä¾‹å¦‚ï¼štar xjï¼Œoptionsé€‰é¡¹åˆ†ä¸ºå¾ˆå¤šä¸­ç±»å‹ï¼š -x è¡¨ç¤ºï¼šè§£å‹æ–‡ä»¶é€‰é¡¹ï¼Œ -j è¡¨ç¤ºï¼šæ˜¯å¦éœ€è¦è§£å‹bz2å‹ç¼©åŒ…ï¼ˆå‹ç¼©åŒ…æ ¼å¼ç±»å‹æœ‰å¾ˆå¤šï¼šzipã€bz2ç­‰ç­‰â€¦ï¼‰ã€‚ 3ï¼‰Shellè„šæœ¬ï¼šdownload-ffmpeg.shã€‚ äºŒã€ç¼–è¯‘é…ç½®é€‰é¡¹ 1. æŸ¥çœ‹é€‰é¡¹ è¿›å…¥FFmpegæ¡†æ¶åŒ…ä¸­ï¼Œæ‰§è¡Œconfigureå‘½ä»¤ï¼š cd ffmpeg-3.4 ./configure --help 2. è§£é‡Šé€‰é¡¹ 1ï¼‰Help optionsï¼šå¸®åŠ©é€‰é¡¹ --list-decodersï¼šæ˜¾ç¤ºæ‰€æœ‰çš„è§£ç å™¨ --list-encodersï¼šæ˜¾ç¤ºæ‰€æœ‰çš„ç¼–ç å™¨ --list-hwaccelsï¼šæ˜¾ç¤ºæ‰€æœ‰å¯ç”¨ç¡¬ä»¶åŠ é€Ÿ 2ï¼‰Standard optionsï¼šæ ‡å‡†é€‰é¡¹ --logfile=FILEï¼šæ—¥å¿—è¾“å…¥æ–‡ä»¶ --disable-loggingï¼šä¸è¦æ‰“å°debugæ—¥å¿— --prefix=PREFIXï¼šå®‰è£…ç›®å½• 3ï¼‰Licensing optionsï¼šè®¸å¯è¯é€‰é¡¹ --enable-gplï¼šå…è®¸ä½¿ç”¨gplä»£ç ï¼Œç”±æ­¤ç”Ÿæˆä½ çš„åº“æˆ–è€…äºŒè¿›åˆ¶æ–‡ä»¶ GPLï¼ˆè®¸å¯è¯ï¼‰ï¼šå¼€æºã€å…è´¹ã€å…¬ç”¨ã€ä¿®æ”¹ã€æ‰©å±•ã€‚ 4ï¼‰Configuration optionsï¼šé…ç½®å¤‡é€‰é€‰é¡¹ --disable-staticï¼šä¸èƒ½ç¼–è¯‘é™æ€åº“ --enable-sharedï¼šæ„å»ºåŠ¨æ€åº“ 5ï¼‰Component optionsï¼šç»„ä»¶é€‰é¡¹ --disable-avdevice disable libavdevice build --disable-avcodec disable libavcodec build --disable-avformat disable libavformat build --disable-swresample disable libswresample build --disable-swscale disable libswscale build --disable-postproc disable libpostproc build --disable-avfilter disable libavfilter build --enable-avresample enable libavresample build [no] 6ï¼‰External library supportï¼šå¤–éƒ¨åº“æ”¯æŒ Using any of the following switches will allow FFmpeg to link to the corresponding external library. All the components depending on that library will become enabled, if all their other dependencies are met and they are not explicitly disabled. E.g. --enable-libwavpack will enable linking to libwavpack and allow the libwavpack encoder to be built, unless it is specifically disabled with --disable-encoder=libwavpack. Note that only the system libraries are auto-detected. All the other external libraries must be explicitly enabled. Also note that the following help text describes the purpose of the libraries themselves, not all their features will necessarily be usable by FFmpeg. --enable-libfdk-aacï¼šå¯ç”¨accç¼–ç  7ï¼‰Toolchain optionsï¼šå·¥å…·é“¾é€‰é¡¹ --arch=ARCHï¼šæŒ‡å®šæˆ‘ä¹ˆéœ€è¦ç¼–è¯‘å¹³å°CPUæ¶æ„ç±»å‹ï¼Œä¾‹å¦‚ï¼šarm64ã€x86ç­‰ç­‰â€¦ --target-os=OSï¼šæŒ‡å®šæ“ä½œç³»ç»Ÿ 8ï¼‰Advanced optionsï¼šé«˜çº§é€‰é¡¹ï¼ˆæš‚æ—¶ç”¨ä¸åˆ°ï¼‰ 9ï¼‰Optimization options (experts only)ï¼šä¼˜åŒ–é€‰é¡¹ 10ï¼‰Developer optionsï¼šå¼€å‘è€…æ¨¡å¼ --disable-debugï¼šç¦ç”¨è°ƒè¯• --enable-debug=LEVELï¼šè°ƒè¯•çº§åˆ« å››ã€Androidå¹³å°ç¼–è¯‘ 1. ä¸‹è½½æºç  download-ffmpeg.shæ˜¯ä¸‹è½½è„šæœ¬ï¼Œæ‰§è¡Œsh download-ffmpeg.shä¸‹è½½æºç ï¼Œè¿™é‡Œä»¥ffmpeg-3.4ä¸ºä¾‹ã€‚ 2. ä¸‹è½½ndk https://developer.android.google.cn/ndk/downloads/older_releases.html æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ndkr10eã€‚ åœ¨ffmpegæºç çš„åŒç›®å½•ä¸‹æ–°å»ºndkæ–‡ä»¶äº¤ï¼Œå°†ä¸‹è½½å¥½çš„ndkæ”¾å…¥ndkæ–‡ä»¶å¤¹ã€‚ 3. ä¿®æ”¹configure # SLIBNAME_WITH_MAJOR='$(SLIBNAME).$(LIBMAJOR)' # LIB_INSTALL_EXTRA_CMD='$$(RANLIB) \"$(LIBDIR)/$(LIBNAME)\"' # SLIB_INSTALL_NAME='$(SLIBNAME_WITH_VERSION)' # SLIB_INSTALL_LINKS='$(SLIBNAME_WITH_MAJOR) $(SLIBNAME)' The above code is modified as the following SLIBNAME_WITH_MAJOR='$(SLIBPREF)$(FULLNAME)-$(LIBMAJOR)$(SLIBSUF)' LIB_INSTALL_EXTRA_CMD='$$(RANLIB) \"$(LIBDIR)/$(LIBNAME)\"' SLIB_INSTALL_NAME='$(SLIBNAME_WITH_MAJOR)' SLIB_INSTALL_LINKS='$(SLIBNAME)' 4. æ‰§è¡Œç¼–è¯‘ android-build-ffmpeg.shæ˜¯ç¼–è¯‘è„šæœ¬ï¼Œå°†ç¼–è¯‘è„šæœ¬æ”¾åœ¨å’Œæºç çš„åŒä¸€ç›®å½•ï¼Œæ‰§è¡Œï¼š sh android-build-ffmpeg.sh "},"pages/FFmpeg/FFmpegé›†æˆ.html":{"url":"pages/FFmpeg/FFmpegé›†æˆ.html","title":"FFmpegé›†æˆ","keywords":"","body":"FFmpegé›†æˆ ä¸€ã€iOSé›†æˆFFmpeg ä»£ç å·¥ç¨‹ 1. é›†æˆFFmpeg æµ‹è¯•æˆ‘ä»¬è‡ªå·±ç¼–è¯‘åº“FFmpegã€‚ (1) ç¬¬ä¸€æ­¥ï¼šæ–°å»ºå·¥ç¨‹ åˆ é™¤Scenedelegateï¼Œå‚è€ƒï¼šXcode 11æ–°å»ºé¡¹ç›®å¤šäº†Scenedelegateã€‚ (2) ç¬¬äºŒæ­¥ï¼šå¯¼å…¥åº“æ–‡ä»¶ã€‚ åœ¨å·¥ç¨‹ç›®å½•æ–°å»ºFFmpeg-3.4ï¼Œæ‹·è´å·²ç»ç¼–è¯‘å¥½çš„arm64é™æ€åº“æ–‡ä»¶å¤¹ï¼Œåˆ é™¤ä¸éœ€è¦çš„shareã€lib/pkgconfigæ–‡ä»¶å¤¹ï¼Œæœ€åå°†FFmpeg-3.4Addè¿›å…¥å·¥ç¨‹ã€‚ (3ï¼‰ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ ä¾èµ–åº“ CoreMedia.framework CoreGraphics.framework VideoToolbox.framework AudioToolbox.framework libiconv.tbd libz.tbd libbz2.tbd (4) é…ç½®å¤´æ–‡ä»¶ 1) å¤åˆ¶å¤´æ–‡ä»¶è·¯å¾„ é€‰ä¸­Target>Build Setting>æœç´¢Library Search>åŒå‡»Library Search Pathså¤åˆ¶FFmpeg libè·¯å¾„>ä¿®æ”¹libä¸ºincludeå°±æ˜¯FFmpegå¤´æ–‡ä»¶è·¯å¾„ï¼š $(PROJECT_DIR)/FFmpegCompiled/FFmpeg-3.4/arm64/includeã€‚ 2) é…ç½®å¤´æ–‡ä»¶è·¯å¾„ é€‰ä¸­Target>Build Setting>æœç´¢Header Search>é€‰ä¸­Header Search Paths>å¢åŠ ä¸Šé¢å¤åˆ¶å¥½å¤´æ–‡ä»¶è·¯å¾„ã€‚ (5) ç¼–è¯‘æˆåŠŸ 2. æµ‹è¯•æ¡ˆä¾‹ (1) æ‰“å°é…ç½®ä¿¡æ¯ æ–°å»ºFFmpegTestæµ‹è¯•ç±»ï¼Œå¢åŠ ç±»æ–¹æ³•ï¼š // å¼•å…¥å¤´æ–‡ä»¶ // æ ¸å¿ƒåº“->éŸ³è§†é¢‘ç¼–è§£ç åº“ #import /// æµ‹è¯•FFmpegé…ç½® + (void)ffmpegTestConfig { const char *configuration = avcodec_configuration(); NSLog(@\"é…ç½®ä¿¡æ¯: %s\", configuration); } åœ¨ViewControllerä¸­æµ‹è¯•ï¼š #import \"FFmpegTest.h\" - (void)viewDidLoad { [super viewDidLoad]; // Do any additional setup after loading the view. //æµ‹è¯•ä¸€ [FFmpegTest ffmpegTestConfig]; } consoleè¾“å‡ºï¼š é…ç½®ä¿¡æ¯: --target-os=darwin --arch=arm64 --cc='xcrun -sdk iphoneos clang' --as='gas-preprocessor.pl -arch aarch64 -- xcrun -sdk iphoneos clang' --enable-cross-compile --disable-debug --disable-programs --disable-doc --enable-pic --extra-cflags='-arch arm64 -mios-version-min=7.0 -fembed-bitcode' --extra-ldflags='-arch arm64 -mios-version-min=7.0 -fembed-bitcode' --prefix=/Users/chenchangqing/Documents/FFmpeg/ffmpeg-3.4-target-iOS/arm64 (2) æ‰“å¼€è§†é¢‘æ–‡ä»¶ FFmpegTestå¢åŠ ç±»æ–¹æ³•ï¼š // å¯¼å…¥å°è£…æ ¼å¼åº“ #import /// æ‰“å¼€è§†é¢‘æ–‡ä»¶ + (void)ffmpegVideoOpenfile:(NSString*)filePath { // ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ av_register_all(); // ç¬¬äºŒæ­¥ï¼šæ‰“å¼€å°è£…æ ¼å¼æ–‡ä»¶ // å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ AVFormatContext* avformat_context = avformat_alloc_context(); // å‚æ•°äºŒï¼šæ‰“å¼€è§†é¢‘åœ°å€->path const char *url = [filePath UTF8String]; // å‚æ•°ä¸‰ï¼šæŒ‡å®šè¾“å…¥å°è£…æ ¼å¼->é»˜è®¤æ ¼å¼ // å‚æ•°å››ï¼šæŒ‡å®šé»˜è®¤é…ç½®ä¿¡æ¯->é»˜è®¤é…ç½® int avformat_open_input_reuslt = avformat_open_input(&avformat_context, url, NULL, NULL); if (avformat_open_input_reuslt != 0){ // å¤±è´¥äº† // è·å–é”™è¯¯ä¿¡æ¯ // char* error_info = NULL; // av_strerror(avformat_open_input_reuslt, error_info, 1024); NSLog(@\"æ‰“å¼€æ–‡ä»¶å¤±è´¥\"); return; } NSLog(@\"æ‰“å¼€æ–‡ä»¶æˆåŠŸ\"); } é¡¹ç›®æ–°å¢è§†é¢‘Test.movï¼Œåœ¨ViewControllerä¸­æµ‹è¯•ï¼š // æµ‹è¯•äºŒ NSString *path = [[NSBundle mainBundle] pathForResource:@\"Test\" ofType:@\".mov\"]; [FFmpegTest ffmpegVideoOpenfile:path]; consoleè¾“å‡ºï¼š æ‰“å¼€æ–‡ä»¶æˆåŠŸ äºŒã€Androidé›†æˆFFmpeg ä»£ç å·¥ç¨‹ 1. é›†æˆFFmpeg (1) ç¬¬ä¸€æ­¥ï¼šæ–°å»ºå·¥ç¨‹ File->NewProject->Native C++->è¾“å…¥å·¥ç¨‹ä¿¡æ¯->Next->Finishã€‚ ä¸‰æ˜Ÿæ‰‹æœºå¼€å¯å¼€å‘è€…é€‰é¡¹ (2) ç¬¬äºŒæ­¥ï¼šå¯¼å…¥åº“æ–‡ä»¶ã€‚ 1) é¡¹ç›®é€‰ä¸­Projectæ¨¡å¼->app->src->main->å³é”®new->Directory->è¾“å…¥jniLibs->enterã€‚ 2) å°†ç¼–è¯‘å¥½çš„includeå’Œlibæ–‡ä»¶å¤¹copy->é€‰ä¸­åˆšæ‰æ–°å»ºçš„jniLibs->pasteã€‚ (3) ç¬¬ä¸‰æ­¥ï¼šä¿®æ”¹CMakeLists.txt 1) app->src->main->cpp->åŒå‡»CMakeLists.txtã€‚ 2) ä¿®æ”¹CMakeLists.txtã€‚ # FFMpegé…ç½® # FFmpegé…ç½®ç›®å½• set(JNILIBS_DIR ${CMAKE_SOURCE_DIR}/../jniLibs) # ç¼–è§£ç (æœ€é‡è¦çš„åº“) add_library( avcodec SHARED IMPORTED) set_target_properties( avcodec PROPERTIES IMPORTED_LOCATION ${JNILIBS_DIR}/lib/libavcodec.so) # æ»¤é•œç‰¹æ•ˆå¤„ç†åº“ add_library( avfilter SHARED IMPORTED) set_target_properties( avfilter PROPERTIES IMPORTED_LOCATION ${JNILIBS_DIR}/lib/libavfilter.so) # å°è£…æ ¼å¼å¤„ç†åº“ add_library( avformat SHARED IMPORTED) set_target_properties( avformat PROPERTIES IMPORTED_LOCATION ${JNILIBS_DIR}/lib/libavformat.so) # å·¥å…·åº“(å¤§éƒ¨åˆ†åº“éƒ½éœ€è¦è¿™ä¸ªåº“çš„æ”¯æŒ) add_library( avutil SHARED IMPORTED) set_target_properties( avutil PROPERTIES IMPORTED_LOCATION ${JNILIBS_DIR}/lib/libavutil.so) # éŸ³é¢‘é‡‡æ ·æ•°æ®æ ¼å¼è½¬æ¢åº“ add_library( swresample SHARED IMPORTED) set_target_properties( swresample PROPERTIES IMPORTED_LOCATION ${JNILIBS_DIR}/lib/libswresample.so) # è§†é¢‘åƒç´ æ•°æ®æ ¼å¼è½¬æ¢ add_library( swscale SHARED IMPORTED) set_target_properties( swscale PROPERTIES IMPORTED_LOCATION ${JNILIBS_DIR}/lib/libswscale.so) add_library( avdevice SHARED IMPORTED) set_target_properties( avdevice PROPERTIES IMPORTED_LOCATION ${JNILIBS_DIR}/lib/libavdevice.so) add_library( postproc SHARED IMPORTED) set_target_properties( postproc PROPERTIES IMPORTED_LOCATION ${JNILIBS_DIR}/lib/libpostproc.so) #set(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -std=gnu++11\") #åˆ¤æ–­ç¼–è¯‘å™¨ç±»å‹,å¦‚æœæ˜¯gccç¼–è¯‘å™¨,åˆ™åœ¨ç¼–è¯‘é€‰é¡¹ä¸­åŠ å…¥c++11æ”¯æŒ if(CMAKE_COMPILER_IS_GNUCXX) set(CMAKE_CXX_FLAGS \"-std=c++11 ${CMAKE_CXX_FLAGS}\") message(STATUS \"optional:-std=c++11\") endif(CMAKE_COMPILER_IS_GNUCXX) #é…ç½®ç¼–è¯‘çš„å¤´æ–‡ä»¶ include_directories(${JNILIBS_DIR}/include) . . . target_link_libraries( # Specifies the target library. myapplication avcodec swresample avfilter avformat avutil swscale avdevice postproc # Links the target library to the log library # included in the NDK. ${log-lib}) (4) é…ç½®CPUæ¶æ„ç±»å‹ ä¿®æ”¹app->build.gradleï¼š externalNativeBuild { cmake { cppFlags '' abiFilters 'armeabi' } } å‘ç°ç¼–è¯‘å¤±è´¥ï¼Œè§£å†³æ–¹æ³•ï¼Œä¿®æ”¹ä¸ºå¦‚ä¸‹( å‚è€ƒé“¾æ¥)ï¼š defaultConfig { ndk { abiFilters 'armeabi-v7a' } } (5) ç¼–è¯‘æˆåŠŸ 2. æµ‹è¯•æ¡ˆä¾‹ (1) æ‰“å°é…ç½®ä¿¡æ¯ 1) å®šä¹‰Javaæ–¹æ³• æ–°å»ºJavaç±»FFmpegTestï¼Œå®šä¹‰ffmpegTestConfigæ–¹æ³•ï¼š // æµ‹è¯•FFmpegé…ç½® // nativeï¼šæ ‡è®°è¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªç‰¹æ®Šæ–¹æ³•ï¼Œä¸æ˜¯æ™®é€šçš„javaæ–¹æ³•ï¼Œè€Œæ˜¯ç”¨äºä¸NDKè¿›è¡Œäº¤äº’çš„æ–¹æ³•ï¼ˆC/C++è¯­è¨€äº¤äº’ï¼‰ // ç”¨nativeä¿®é¥°æ–¹æ³•ï¼Œæ–¹æ³•æ²¡æœ‰å®ç°ï¼Œå…·ä½“çš„å®ç°åœ¨C/C++é‡Œé¢ã€‚ public static native void ffmpegTestConfig(); 2) å®šä¹‰NDKæ–¹æ³• åœ¨native-lib.cppä¸­ï¼Œå¯¼å…¥FFmpegå¤´æ–‡ä»¶ï¼Œç”±äº FFmpeg æ˜¯ä½¿ç”¨ C è¯­è¨€ç¼–å†™çš„ï¼Œæ‰€åœ¨ C++ æ–‡ä»¶ä¸­å¼•ç”¨ #include çš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦åŒ…è£¹åœ¨ extern \"C\" { }ï¼Œæ‰èƒ½æ­£ç¡®çš„ç¼–è¯‘ã€‚ #import extern \"C\" { // å¼•å…¥å¤´æ–‡ä»¶ // æ ¸å¿ƒåº“->éŸ³è§†é¢‘ç¼–è§£ç åº“ #include } åœ¨native-lib.cppä¸­æ–°å¢Javaæ–¹æ³•ffmpegTestConfigçš„C++å®ç°ã€‚ extern \"C\" JNIEXPORT void JNICALL Java_com_ccq_androidffmpegcompiled_FFmpegTest_ffmpegTestConfig(JNIEnv *env, jclass clazz) { const char *configuration = avcodec_configuration(); __android_log_print(ANDROID_LOG_INFO, \"ffmpeg configuration\", \"%s\", configuration); } ä¹‹æ‰€ä»¥å¯ä»¥è¿™ä¹ˆå†™æ˜¯å› ä¸ºåœ¨CMakeLists.txtä¸­æœ‰å¦‚ä¸‹é…ç½®ï¼Œå°†Javaå’ŒC/C++è¿›è¡Œå…³è”ã€‚ add_library( # Sets the name of the library. androidffmpegcompiled # Sets the library as a shared library. SHARED # Provides a relative path to your source file(s). native-lib.cpp) 3) MainActivityå¢åŠ æµ‹è¯•ä»£ç ã€‚ protected void onCreate(Bundle savedInstanceState) { ... FFmpegTest.ffmpegTestConfig(); } 4) è¿è¡Œå·¥ç¨‹ï¼Œæ­£ç¡®æ‰“å°ã€‚ I/ffmpeg configuration: --prefix=/Users/chenchangqing/Documents/code/ffmpeg/01_ffmpeg_compiled/ffmpeg-3.4-target-android/armeabi-v7a --enable-shared --enable-gpl --disable-static --disable-doc --disable-ffmpeg --disable-ffplay --disable-ffprobe --disable-ffserver --disable-doc --disable-symver --enable-small --cross-prefix=/Users/chenchangqing/Documents/code/ffmpeg/01_ffmpeg_compiled/ndk/android-ndk-r10e/toolchains/arm-linux-androideabi-4.9/prebuilt/darwin-x86_64/bin/arm-linux-androideabi- --target-os=android --arch=armeabi-v7a --enable-cross-compile --sysroot=/Users/chenchangqing/Documents/code/ffmpeg/01_ffmpeg_compiled/ndk/android-ndk-r10e/platforms/android-18/arch-arm --extra-cflags='-Os -fpic -marm' --enable-pic (2) æ‰“å¼€è§†é¢‘æ–‡ä»¶ 1) å®šä¹‰Javaæ–¹æ³• FFmpegTestå®šä¹‰ffmpegVideoOpenFileæ–¹æ³•ï¼š // æµ‹è¯•FFmpegæ‰“å¼€è§†é¢‘ // filePath:è·¯å¾„ public static native void ffmpegVideoOpenFile(String filePath); 2) å®šä¹‰NDKæ–¹æ³• åœ¨native-lib.cppä¸­ï¼Œå¯¼å…¥FFmpegå¤´æ–‡ä»¶ã€‚ #import extern \"C\" { // å¼•å…¥å¤´æ–‡ä»¶ // æ ¸å¿ƒåº“->éŸ³è§†é¢‘ç¼–è§£ç åº“ #include // å¯¼å…¥å°è£…æ ¼å¼åº“ #import } åœ¨native-lib.cppä¸­æ–°å¢Javaæ–¹æ³•ffmpegVideoOpenFileçš„C++å®ç°ã€‚ extern \"C\" JNIEXPORT void JNICALL Java_com_ccq_androidffmpegcompiled_FFmpegTest_ffmpegVideoOpenFile(JNIEnv *env, jclass clazz, jstring file_path) { // ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ av_register_all(); // ç¬¬äºŒæ­¥ï¼šæ‰“å¼€å°è£…æ ¼å¼æ–‡ä»¶ // å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ AVFormatContext* avformat_context = avformat_alloc_context(); // å‚æ•°äºŒï¼šæ‰“å¼€è§†é¢‘åœ°å€->path const char *url = env->GetStringUTFChars(file_path, NULL); // å‚æ•°ä¸‰ï¼šæŒ‡å®šè¾“å…¥å°è£…æ ¼å¼->é»˜è®¤æ ¼å¼ // å‚æ•°å››ï¼šæŒ‡å®šé»˜è®¤é…ç½®ä¿¡æ¯->é»˜è®¤é…ç½® int avformat_open_input_reuslt = avformat_open_input(&avformat_context, url, NULL, NULL); if (avformat_open_input_reuslt != 0){ // å¤±è´¥äº† // è·å–é”™è¯¯ä¿¡æ¯ // char* error_info = NULL; // av_strerror(avformat_open_input_reuslt, error_info, 1024); __android_log_print(ANDROID_LOG_INFO, \"ffmpeg\", \"æ‰“å¼€æ–‡ä»¶å¤±è´¥\"); return; } __android_log_print(ANDROID_LOG_INFO, \"ffmpeg\", \"æ‰“å¼€æ–‡ä»¶æˆåŠŸ\"); } 3) å¢åŠ æƒé™ åœ¨AndroidManifest.xmlå¢åŠ SDå¡çš„è¯»å†™æƒé™ã€‚ 4) MainActivityå¢åŠ æµ‹è¯•ä»£ç ã€‚ æ³¨æ„ï¼šå¦‚æœæ‰“å¼€å¤±è´¥ï¼Œå¯èƒ½è¯»å†™å­˜å‚¨è®¾å¤‡çš„æƒé™è¢«ç¦ç”¨ã€‚ æ‘©æ‰˜ç½—æ‹‰Â·åˆ€é”‹ï¼šè®¾ç½®->åº”ç”¨å’Œé€šçŸ¥->é«˜çº§->æƒé™ç®¡ç†å™¨->éšç§ç›¸å…³Â·è¯»å†™å­˜å‚¨è®¾å¤‡->æ‰¾åˆ°åº”ç”¨->å¦‚æœç¦ç”¨ï¼Œåˆ™ä¿®æ”¹ä¸ºå…è®¸ã€‚ String rootPath = Environment.getExternalStorageDirectory().getAbsolutePath(); String inFilePath = rootPath.concat(\"/DCIM/Camera/VID_20220220_181306412.mp4\"); FFmpegTest.ffmpegVideoOpenFile(inFilePath); "},"pages/FFmpeg/iOSé›†æˆFFmpeg.html":{"url":"pages/FFmpeg/iOSé›†æˆFFmpeg.html","title":"iOSé›†æˆFFmpeg","keywords":"","body":"iOSé›†æˆFFmpeg ä»£ç å·¥ç¨‹ ä¸‹è½½FFmpegæºç  ffmpeg-3.4ä¸‹è½½è„šæœ¬ï¼šdownload-ffmpeg.shã€‚ sh download-ffmpeg.sh å®‰è£…gas-preprocessor ffmpeg-3.4å¯¹åº”çš„gas-preprocessor.plã€‚ cd gas-preprocessor directory sudo cp -f gas-preprocessor.pl /usr/local/bin/ chmod 777 /usr/local/bin/gas-preprocessor.pl æ³¨æ„ï¼šä½¿ç”¨Githubæœ€æ–°çš„gas-preprocessor.plç¼–è¯‘FFmpegï¼ŒæŠ¥é”™\"GNU assembler not found, install/update gas-preprocessor\"ï¼Œæ‰€ä»¥ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„gas-preprocessorã€‚ ç¼–è¯‘FFmpeg ffmpeg-3.4ç¼–è¯‘è„šæœ¬ï¼šios-build-ffmpeg.shï¼Œå°†ç¼–è¯‘è„šæœ¬æ”¾åœ¨å’Œæºç çš„åŒä¸€ç›®å½•ã€‚ é»˜è®¤åˆ†åˆ«ç¼–è¯‘arm64ã€armv7ã€i386ã€x86_64ï¼Œä»£ç å¦‚ä¸‹ï¼š sh ios-build-ffmpeg.sh æŒ‡å®šæ¶æ„ç¼–è¯‘ï¼Œå¯ä»¥æŒ‡å®šarm64ã€armv7ã€i386ã€x86_64ï¼Œä»£ç å¦‚ä¸‹ï¼š sh ios-build-ffmpeg.sh arm64 æŒ‡å®šarmv7ç¼–è¯‘æ—¶å‡ºç°é—®é¢˜ï¼Œå¾…è§£å†³ï¼š AS libavcodec/arm/aacpsdsp_neon.o src/libavutil/arm/asm.S:50:9: error: unknown directive .arch armv7-a ^ make: *** [libavcodec/arm/aacpsdsp_neon.o] Error 1 make: *** Waiting for unfinished jobs.... æ–°å»ºå·¥ç¨‹ åˆ é™¤Scenedelegateï¼Œå‚è€ƒï¼šXcode 11æ–°å»ºé¡¹ç›®å¤šäº†Scenedelegateã€‚ å¯¼å…¥åº“æ–‡ä»¶ åœ¨å·¥ç¨‹ç›®å½•æ–°å»ºFFmpeg-3.4ï¼Œæ‹·è´å·²ç»ç¼–è¯‘å¥½çš„arm64é™æ€åº“æ–‡ä»¶å¤¹è‡³FFmpeg-3.4ï¼Œåˆ é™¤ä¸éœ€è¦çš„shareã€lib/pkgconfigæ–‡ä»¶å¤¹ï¼Œæœ€åå°†FFmpeg-3.4é€šè¿‡Add FilesåŠ å…¥å·¥ç¨‹ã€‚ é…ç½®å¤´æ–‡ä»¶ 1) å¤åˆ¶å¤´æ–‡ä»¶è·¯å¾„ é€‰ä¸­Target>Build Setting>æœç´¢Library Search>åŒå‡»Library Search Pathså¤åˆ¶FFmpeg libè·¯å¾„>ä¿®æ”¹libä¸ºincludeå°±æ˜¯FFmpegå¤´æ–‡ä»¶è·¯å¾„ï¼š $(PROJECT_DIR)/iOSIntegrationWithFFmpegï¼ˆå·¥ç¨‹åï¼‰/FFmpeg-3.4/arm64/include 2) é…ç½®å¤´æ–‡ä»¶è·¯å¾„ é€‰ä¸­Target>Build Setting>æœç´¢Header Search>é€‰ä¸­Header Search Paths>å¢åŠ ä¸Šé¢å¤åˆ¶å¥½å¤´æ–‡ä»¶è·¯å¾„ã€‚ æ·»åŠ ä¾èµ–åº“ CoreMedia.framework CoreGraphics.framework VideoToolbox.framework AudioToolbox.framework libiconv.tbd libz.tbd libbz2.tbd æ·»åŠ å®Œæ¯•ï¼Œç¼–è¯‘æˆåŠŸã€‚ ç®€å•æµ‹è¯• ä¸‹è½½test.movï¼ŒåŠ å…¥å·¥ç¨‹ï¼Œæ–°å»ºæµ‹è¯•ç±»FFmpegTestï¼ŒFFmpegTest.hå¢åŠ æ–¹æ³•å®šä¹‰ã€‚ /// æµ‹è¯•FFmpegé…ç½® + (void)ffmpegTestConfig; /// æ‰“å¼€è§†é¢‘æ–‡ä»¶ + (void)ffmpegVideoOpenfile:(NSString*)filePath; FFmpegTest.må¼•å…¥FFmpegå¤´æ–‡ä»¶ã€‚ // æ ¸å¿ƒåº“->éŸ³è§†é¢‘ç¼–è§£ç åº“ #import // å¯¼å…¥å°è£…æ ¼å¼åº“ #import FFmpegTest.må¢åŠ æ–¹æ³•å®ç°ã€‚ /// æµ‹è¯•FFmpegé…ç½® + (void)ffmpegTestConfig { const char *configuration = avcodec_configuration(); NSLog(@\"é…ç½®ä¿¡æ¯: %s\", configuration); } /// æ‰“å¼€è§†é¢‘æ–‡ä»¶ + (void)ffmpegVideoOpenfile:(NSString*)filePath { // ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ av_register_all(); // ç¬¬äºŒæ­¥ï¼šæ‰“å¼€å°è£…æ ¼å¼æ–‡ä»¶ // å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ AVFormatContext* avformat_context = avformat_alloc_context(); // å‚æ•°äºŒï¼šæ‰“å¼€è§†é¢‘åœ°å€->path const char *url = [filePath UTF8String]; // å‚æ•°ä¸‰ï¼šæŒ‡å®šè¾“å…¥å°è£…æ ¼å¼->é»˜è®¤æ ¼å¼ // å‚æ•°å››ï¼šæŒ‡å®šé»˜è®¤é…ç½®ä¿¡æ¯->é»˜è®¤é…ç½® int avformat_open_input_reuslt = avformat_open_input(&avformat_context, url, NULL, NULL); if (avformat_open_input_reuslt != 0){ // å¤±è´¥äº† // è·å–é”™è¯¯ä¿¡æ¯ // char* error_info = NULL; // av_strerror(avformat_open_input_reuslt, error_info, 1024); NSLog(@\"æ‰“å¼€æ–‡ä»¶å¤±è´¥\"); return; } NSLog(@\"æ‰“å¼€æ–‡ä»¶æˆåŠŸ\"); } åœ¨ViewControllerå¼•å…¥FFmpegTest.hå¤´æ–‡ä»¶ã€‚ #import \"FFmpegTest.h\" åœ¨ViewControllerçš„viewDidLoadåŠ å…¥æ–¹æ³•è°ƒç”¨ã€‚ // æµ‹è¯•ä¸€ [FFmpegTest ffmpegTestConfig]; // æµ‹è¯•äºŒ NSString *path = [[NSBundle mainBundle] pathForResource:@\"Test\" ofType:@\".mov\"]; [FFmpegTest ffmpegVideoOpenfile:path]; runå·¥ç¨‹ï¼Œconsoleæ­£ç¡®è¾“å‡ºã€‚ 2022-05-08 01:32:12.320527+0800 iOSIntegrationWithFFmpeg[34898:1017443] é…ç½®ä¿¡æ¯: --target-os=darwin --arch=arm64 --cc='xcrun -sdk iphoneos clang' --as='gas-preprocessor.pl -arch aarch64 -- xcrun -sdk iphoneos clang' --enable-cross-compile --disable-debug --disable-programs --disable-doc --enable-pic --extra-cflags='-arch arm64 -mios-version-min=7.0 -fembed-bitcode' --extra-ldflags='-arch arm64 -mios-version-min=7.0 -fembed-bitcode' --prefix=/Users/chenchangqing/Documents/code/ffmpeg/01_ffmpeg_compiled/ios_build/arm64 2022-05-08 01:32:12.338556+0800 iOSIntegrationWithFFmpeg[34898:1017443] æ‰“å¼€æ–‡ä»¶æˆåŠŸ "},"pages/FFmpeg/FFmpegåŸºç¡€çŸ¥è¯†.html":{"url":"pages/FFmpeg/FFmpegåŸºç¡€çŸ¥è¯†.html","title":"FFmpegåŸºç¡€çŸ¥è¯†","keywords":"","body":"FFmpegåŸºç¡€çŸ¥è¯† ä¸€ã€è§†é¢‘æ’­æ”¾ 1. è§†é¢‘æ’­æ”¾æµç¨‹ é€šå¸¸çœ‹åˆ°è§†é¢‘æ ¼å¼ï¼šmp4ã€movã€flvã€wmvç­‰ç­‰â€¦ï¼Œç§°ä¹‹ä¸ºï¼šå°è£…æ ¼å¼ã€‚ 2. è§†é¢‘æ’­æ”¾å™¨ ä¸¤ç§æ¨¡å¼æ’­æ”¾å™¨ï¼š (1) å¯è§†åŒ–ç•Œé¢æ’­æ”¾å™¨ ç›´æ¥ç”¨æˆ·ç›´è§‚æ“ä½œã€ç®€å•æ˜“æ‡‚ã€‚ä¾‹å¦‚è…¾è®¯è§†é¢‘ã€çˆ±å¥‡è‰ºè§†é¢‘ã€QQå½±éŸ³ã€æš´é£å½±éŸ³ã€å¿«æ’­ã€ä¼˜é…·ç­‰ç­‰ã€‚ (2) éå¯è§†åŒ–ç•Œé¢æ’­æ”¾å™¨ å‘½ä»¤æ“ä½œæ’­æ”¾å™¨ï¼Œç”¨æˆ·çœ‹ä¸æ‡‚ï¼Œä½¿ç”¨èµ·æ¥éå¸¸éº»çƒ¦ã€‚ä¾‹å¦‚FFmpegçš„fplayï¼ˆå‘½ä»¤ï¼‰æ’­æ”¾å™¨ï¼ˆå†…ç½®æ’­æ”¾å™¨ï¼‰ã€vlcæ’­æ”¾å™¨ã€mplayeræ’­æ”¾å™¨ã€‚ 3. è§†é¢‘ä¿¡æ¯æŸ¥çœ‹å·¥å…· MediaInfoï¼šå¸®åŠ©æˆ‘ä»¬æŸ¥çœ‹è§†é¢‘å®Œæ•´ä¿¡æ¯ï¼Œç›´æ¥å»AppStoreä¸‹è½½å³å¯ï¼Œä¸è¿‡è¦3å—é’±ã€‚ ULtraEditï¼šç›´æ¥æŸ¥çœ‹è§†é¢‘äºŒè¿›åˆ¶æ•°æ®ã€‚ è§†é¢‘å•é¡¹ä¿¡æ¯ï¼š Elecard Format Analyzerï¼šå°è£…æ ¼å¼ä¿¡æ¯å·¥å…·ã€‚ Elecard Stream Eyeï¼šè§†é¢‘ç¼–ç ä¿¡æ¯å·¥å…·ã€‚ GLYUVPlayerï¼šè§†é¢‘åƒç´ ä¿¡æ¯å·¥å…·ï¼Œæœ€æ–°çš„macç³»ç»Ÿä¸æ”¯æŒäº†ï¼Œè¿™é‡Œç”¨YuvEyeæ›¿æ¢ã€‚ Adobe Auditionï¼šéŸ³é¢‘é‡‡æ ·æ•°æ®å·¥å…·ã€‚ äºŒã€éŸ³è§†é¢‘å°è£…æ ¼å¼ 1. å°è£…æ ¼å¼ mp4ã€movã€flvã€wmvã€aviã€tsã€mkvç­‰ç­‰ã€‚ 2. å°è£…æ ¼å¼ä½œç”¨ è§†é¢‘æµ+éŸ³é¢‘æµæŒ‰ç…§æ ¼å¼è¿›è¡Œå­˜å‚¨åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚ 3.MPEG2-TSæ ¼å¼ è§†é¢‘å‹ç¼©æ•°æ®æ ¼å¼ï¼šMPEG2-TSã€‚ç‰¹å®šï¼šæ•°æ®æ’ç‰ˆï¼Œä¸åŒ…å«å¤´æ–‡ä»¶ï¼Œæ•°æ®å¤§å°å›ºå®šï¼ˆ188byteï¼‰çš„TS-Packetã€‚ 4. FLVæ ¼å¼ (1) ä¼˜åŠ¿ ç”±äºå®ƒå½¢æˆçš„æ–‡ä»¶æå°ã€åŠ è½½é€Ÿåº¦æå¿«ï¼Œä½¿å¾—ç½‘ç»œè§‚çœ‹è§†é¢‘æ–‡ä»¶æˆä¸ºå¯èƒ½ï¼Œå®ƒçš„å‡ºç°æœ‰æ•ˆåœ°è§£å†³äº†è§†é¢‘æ–‡ä»¶å¯¼å…¥Flashåï¼Œä½¿å¯¼å‡ºçš„SWFæ–‡ä»¶ä½“ç§¯åºå¤§ï¼Œä¸èƒ½åœ¨ç½‘ç»œä¸Šå¾ˆå¥½çš„ä½¿ç”¨ç­‰é—®é¢˜ã€‚ (2) æ–‡ä»¶ç»“æ„ FLVæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”±æ–‡ä»¶å¤´ï¼ˆFLV headerï¼‰å’Œå¾ˆå¤štagç»„æˆã€‚tagåˆå¯ä»¥åˆ†æˆä¸‰ç±»ï¼šaudio,video,scriptï¼Œåˆ†åˆ«ä»£è¡¨éŸ³é¢‘æµï¼Œè§†é¢‘æµï¼Œè„šæœ¬æµï¼ˆå…³é”®å­—æˆ–è€…æ–‡ä»¶ä¿¡æ¯ä¹‹ç±»ï¼‰ã€‚ (3) FLVæ–‡ä»¶ FLVæ–‡ä»¶=FLVå¤´æ–‡ä»¶+ tag1+tagå†…å®¹1 + tag2+tagå†…å®¹2 + ...+... + tagN+tagå†…å®¹Nã€‚ (4) FLVå¤´æ–‡ä»¶ 1-3ï¼š å‰3ä¸ªå­—èŠ‚æ˜¯æ–‡ä»¶æ ¼å¼æ ‡è¯†(FLV 0x46 0x4C 0x56)ã€‚ 4-4ï¼š ç¬¬4ä¸ªå­—èŠ‚æ˜¯ç‰ˆæœ¬ï¼ˆ0x01ï¼‰ã€‚ 5-5ï¼š ç¬¬5ä¸ªå­—èŠ‚çš„å‰5ä¸ªbitæ˜¯ä¿ç•™çš„å¿…é¡»æ˜¯0ã€‚ 6-9: ç¬¬6-9çš„å››ä¸ªå­—èŠ‚è¿˜æ˜¯ä¿ç•™çš„.å…¶æ•°æ®ä¸º 00000009ã€‚ æ•´ä¸ªæ–‡ä»¶å¤´çš„é•¿åº¦ï¼Œä¸€èˆ¬æ˜¯9ï¼ˆ3+1+1+4ï¼‰ã€‚ ä¸‰ã€è§†é¢‘ç¼–ç æ•°æ® 1. è§†é¢‘ç¼–ç ä½œç”¨ å°†è§†é¢‘åƒç´ æ•°æ®ï¼ˆYUVã€RGBï¼‰è¿›è¡Œå‹ç¼©æˆä¸ºè§†é¢‘ç æµï¼Œä»è€Œé™ä½è§†é¢‘æ•°æ®é‡ã€‚ï¼ˆå‡å°å†…å­˜æš‚ç”¨ï¼‰ 2. è§†é¢‘ç¼–ç æ ¼å¼ 3. H.264è§†é¢‘å‹ç¼©æ•°æ®æ ¼å¼ éå¸¸å¤æ‚ç®—æ³•->å‹ç¼©->å ç”¨å†…å­˜é‚£ä¹ˆå°‘ï¼Ÿï¼ˆä¾‹å¦‚ï¼šå¸§é—´é¢„æµ‹ã€å¸§å†…é¢„æµ‹â€¦ï¼‰->æé«˜å‹ç¼©æ€§èƒ½ã€‚ å››ã€éŸ³é¢‘ç¼–ç æ•°æ® 1. éŸ³é¢‘ç¼–ç ä½œç”¨ å°†éŸ³é¢‘é‡‡æ ·æ•°æ®ï¼ˆPCMæ ¼å¼ï¼‰è¿›è¡Œå‹ç¼©æˆä¸ºéŸ³é¢‘ç æµï¼Œä»è€Œé™ä½éŸ³é¢‘æ•°æ®é‡ã€‚ï¼ˆå‡å°å†…å­˜æš‚ç”¨ï¼‰ 2. éŸ³é¢‘ç¼–ç æ ¼å¼ 3. AACæ ¼å¼ AACï¼Œå…¨ç§°Advanced Audio Codingï¼Œæ˜¯ä¸€ç§ä¸“ä¸ºå£°éŸ³æ•°æ®è®¾è®¡çš„æ–‡ä»¶å‹ç¼©æ ¼å¼ã€‚ä¸MP3ä¸åŒï¼Œå®ƒé‡‡ç”¨äº†å…¨æ–°çš„ç®—æ³•è¿›è¡Œç¼–ç ï¼Œæ›´åŠ é«˜æ•ˆï¼Œå…·æœ‰æ›´é«˜çš„â€œæ€§ä»·æ¯”â€ã€‚åˆ©ç”¨AACæ ¼å¼ï¼Œå¯ä½¿äººæ„Ÿè§‰å£°éŸ³è´¨é‡æ²¡æœ‰æ˜æ˜¾é™ä½çš„å‰æä¸‹ï¼Œæ›´åŠ å°å·§ã€‚è‹¹æœipodã€è¯ºåŸºäºšæ‰‹æœºæ”¯æŒAACæ ¼å¼çš„éŸ³é¢‘æ–‡ä»¶ã€‚ (1) ä¼˜ç‚¹ ç›¸å¯¹äºmp3ï¼ŒAACæ ¼å¼çš„éŸ³è´¨æ›´ä½³ï¼Œæ–‡ä»¶æ›´å°ã€‚ (2) ä¸è¶³ AACå±äºæœ‰æŸå‹ç¼©çš„æ ¼å¼ï¼Œä¸æ—¶ä¸‹æµè¡Œçš„APEã€FLACç­‰æ— æŸæ ¼å¼ç›¸æ¯”éŸ³è´¨å­˜åœ¨â€œæœ¬è´¨ä¸Šâ€çš„å·®è·ã€‚åŠ ä¹‹ï¼Œä¼ è¾“é€Ÿåº¦æ›´å¿«çš„USB3.0å’Œ16Gä»¥ä¸Šå¤§å®¹é‡MP3æ­£åœ¨åŠ é€Ÿæ™®åŠï¼Œä¹Ÿä½¿å¾—AACå¤´ä¸Šâ€œå°å·§â€çš„å…‰ç¯ä¸å¤å­˜åœ¨ã€‚ (3) ç‰¹ç‚¹ â‘ æå‡çš„å‹ç¼©ç‡ï¼šå¯ä»¥ä»¥æ›´å°çš„æ–‡ä»¶å¤§å°è·å¾—æ›´é«˜çš„éŸ³è´¨ï¼› â‘¡æ”¯æŒå¤šå£°é“ï¼šå¯æä¾›æœ€å¤š48ä¸ªå…¨éŸ³åŸŸå£°é“ï¼› â‘¢æ›´é«˜çš„è§£æåº¦ï¼šæœ€é«˜æ”¯æŒ96KHzçš„é‡‡æ ·é¢‘ç‡ï¼› â‘£æå‡çš„è§£ç æ•ˆç‡ï¼šè§£ç æ’­æ”¾æ‰€å çš„èµ„æºæ›´å°‘ï¼› äº”ã€è§†é¢‘åƒç´ æ•°æ® 1. ä½œç”¨ ä¿å­˜äº†å±å¹•ä¸Šé¢æ¯ä¸€ä¸ªåƒç´ ç‚¹çš„å€¼ã€‚ 2. æ•°æ®æ ¼å¼ å¸¸è§æ ¼å¼ï¼šRGB24ã€RGB32ã€YUV420Pã€YUV422Pã€YUV444Pç­‰ç­‰â€¦ä¸€èˆ¬æœ€å¸¸è§ï¼šYUV420Pã€‚ RGBæ ¼å¼ï¼š 3. æ•°æ®æ–‡ä»¶å¤§å° ä¾‹å¦‚ï¼šRGB24é«˜æ¸…è§†é¢‘ä½“ç§¯ï¼Ÿï¼ˆ1ä¸ªå°æ—¶æ—¶é•¿ï¼‰ã€‚ ä½“ç§¯ï¼š3600 x 25 x 1920 x 1080 * 3 = 559GBï¼ˆéå¸¸å¤§ï¼‰ã€‚ å‡è®¾ï¼šå¸§ç‡25HZï¼Œé‡‡æ ·ç²¾åº¦8bitï¼Œ3ä¸ªå­—èŠ‚ã€‚ 4. YUVæ’­æ”¾å™¨ äººç±»ï¼šå¯¹è‰²åº¦ä¸æ•æ„Ÿï¼Œå¯¹äº®åº¦æ•æ„Ÿã€‚ Yè¡¨ç¤ºï¼šäº®åº¦ï¼ŒUVè¡¨ç¤ºï¼šè‰²åº¦ã€‚ å…­ã€éŸ³é¢‘é‡‡æ ·æ•°æ® 1. ä½œç”¨ ä¿å­˜äº†éŸ³é¢‘ä¸­çš„æ¯ä¸€ä¸ªé‡‡æ ·ç‚¹å€¼ã€‚ 2. æ•°æ®æ–‡ä»¶å¤§å° ä¾‹å¦‚ï¼š1åˆ†é’ŸPCMæ ¼å¼æ­Œæ›²ã€‚ ä½“ç§¯ï¼š60 x 44100 x 2 x 2 = 11MBã€‚ åˆ†æï¼š60è¡¨ç¤ºæ—¶é—´ï¼Œ44100è¡¨ç¤ºé‡‡æ ·ç‡ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯è¿™ä¸ªé‡‡æ ·ç‡ï¼Œäººçš„è€³æœµèƒ½å¤Ÿåˆ†è¾¨çš„å£°éŸ³ï¼‰ï¼Œ2è¡¨ç¤ºå£°é“æ•°é‡ï¼Œ2è¡¨ç¤ºé‡‡æ ·ç²¾åº¦16ä½ = 2å­—èŠ‚ã€‚ 3. å·¥å…· Audition 4. PCMæ ¼å¼ ä¸ƒã€FFmpegå®‰è£… 1. å®‰è£…å¼¯è·¯ å‚è€ƒè¿™ç‰‡æ–‡ç« ï¼ˆmacä¸‹ffmpegå®‰è£…ï¼‰ï¼Œæˆ‘æ²¡ææˆåŠŸã€‚ æ‰§è¡Œå‘½ä»¤ï¼š brew install ffmpeg å‡ºç°é”™è¯¯ï¼š Error: Xcode alone is not sufficient on Big Sur. Install the Command Line Tools: xcode-select --install å¼€å§‹æ‰§è¡Œxcode-select --installï¼Œå®‰è£…xcodeå‘½ä»¤è¡Œï¼Œè¿™é‡Œåˆä¸ªé—®é¢˜ï¼Œä¸ºå•¥æˆ‘æœ‰xcodeè¿˜å¾—è£…è¿™ä¸ªã€‚ å‡ºç°é”™è¯¯ï¼š Error: No such file or directory @ rb_sysopen - /Users/chenchangqing/Library/Caches/Homebrew/downloads/c1e04fd8a5516a3a63dd106e38df40a2d44af18cc3f3d366e5ba0563d2f95570--openexr-3.1.4.big_sur.bottle.tar.gz æŸ¥èµ„æ–™åï¼Œå…ˆåæ‰§è¡Œäº†ä»¥ä¸‹å‘½ä»¤ï¼š brew install openexr brew install libvmaf brew install freetype ä¸€ç›´å¤„äºï¼š åˆå¡ä½äº†ï¼š ==> Applying configure-big_sur.diff patching file configure Hunk #1 succeeded at 9513 (offset 780 lines). ==> ./configure --prefix=/usr/local/Homebrew/Cellar/gettext/0.21 --with-included-glib --w ==> make å‡ºç°é”™è¯¯ï¼Œä¾æ¬¡æ‰§è¡Œï¼š brew install sqlite brew install meson brew install harfbuzz æ”¾å¼ƒ... 2. æ­£ç¡®æ–¹æ³• æœ€åçœ‹äº†è¿™ç¯‡æ–‡ç« ï¼ŒMac OSä¸Šä½¿ç”¨ffmpegçš„â€œè¡€æ³ªâ€æ€»ç»“ï¼ŒæŒ‰æ–‡ç« æ‰§è¡Œå¦‚ä¸‹æ­¥éª¤ï¼š brew tap homebrew-ffmpeg/ffmpeg brew install homebrew-ffmpeg/ffmpeg/ffmpeg å®‰è£…æˆåŠŸã€‚ å…«ã€FFmpegåº”ç”¨ æä¾›äº†ä¸€å¥—æ¯”è¾ƒå®Œæ•´ä»£ç ï¼Œå¼€æºå…è´¹ã€‚æ ¸å¿ƒæ¶æ„è®¾è®¡æ€æƒ³ï¼šï¼ˆæ ¸å¿ƒ + æ’ä»¶ï¼‰è®¾è®¡ã€‚ 1. ffmpeg (1) ä½œç”¨ ç”¨äºå¯¹è§†é¢‘è¿›è¡Œè½¬ç ï¼Œå°†mp4->movï¼Œmov->mp4ï¼Œwmv->mp4ç­‰ç­‰ã€‚ (2) å‘½ä»¤æ ¼å¼ ffmpeg -i {æŒ‡å®šè¾“å…¥æ–‡ä»¶è·¯å¾„} -b:v {è¾“å‡ºè§†é¢‘ç ç‡} {è¾“å‡ºæ–‡ä»¶è·¯å¾„}ã€‚ (3) æµ‹è¯•è¿è¡Œ ä¸‹è½½test.movï¼Œä¿®æ”¹ç ç‡ï¼Œmovè½¬mp4ã€‚ ffmpeg -i test.mov -b:v 234k -b:a 64k test.mp4 (4) å¸¸ç”¨è„šæœ¬ topmp4.shï¼Œto1080pmp4.sh (4) æ¡ˆä¾‹ï¼šè§†é¢‘è½¬ä¸ºé«˜è´¨é‡GIFåŠ¨å›¾ ffmpeg -ss 00:00:03 -t 3 -i Test.mov -s 640x360 -r â€œ15â€ dongtu.gif 1) -ss 00:00:03 è¡¨ç¤ºä»ç¬¬ 00 åˆ†é’Ÿ 03 ç§’å¼€å§‹åˆ¶ä½œ GIFï¼Œå¦‚æœä½ æƒ³ä»ç¬¬ 9 ç§’å¼€å§‹ï¼Œåˆ™è¾“å…¥ -ss 00:00:09ï¼Œæˆ–è€… -ss 9ï¼Œæ”¯æŒå°æ•°ç‚¹ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥è¾“å…¥ -ss 00:00:11.3ï¼Œæˆ–è€… -ss 34.6 ä¹‹ç±»çš„ï¼Œå¦‚æœä¸åŠ è¯¥å‘½ä»¤ï¼Œåˆ™ä» 0 ç§’å¼€å§‹åˆ¶ä½œï¼› 2) -t 3 è¡¨ç¤ºæŠŠæŒç»­ 3 ç§’çš„è§†é¢‘è½¬æ¢ä¸º GIFï¼Œä½ å¯ä»¥æŠŠå®ƒæ”¹ä¸ºå…¶ä»–æ•°å­—ï¼Œä¾‹å¦‚ 1.5ï¼Œ7 ç­‰ç­‰ï¼Œæ—¶é—´è¶Šé•¿ï¼ŒGIF ä½“ç§¯è¶Šå¤§ï¼Œå¦‚æœä¸åŠ è¯¥å‘½ä»¤ï¼Œåˆ™æŠŠæ•´ä¸ªè§†é¢‘è½¬ä¸º GIFï¼› 3) -i è¡¨ç¤º invert çš„æ„æ€å§ï¼Œè½¬æ¢ï¼› 4) Test.mov å°±æ˜¯ä½ è¦è½¬æ¢çš„è§†é¢‘ï¼Œåç§°æœ€å¥½ä¸è¦æœ‰ä¸­æ–‡ï¼Œä¸è¦ç•™ç©ºæ ¼ï¼Œæ”¯æŒå¤šç§è§†é¢‘æ ¼å¼ï¼› 5) -s 640x360 æ˜¯ GIF çš„åˆ†è¾¨ç‡ï¼Œè§†é¢‘åˆ†è¾¨ç‡å¯èƒ½æ˜¯ 1080pï¼Œä½†ä½ åˆ¶ä½œçš„ GIF å¯ä»¥è½¬ä¸º 720p ç­‰ï¼Œå…è®¸è‡ªå®šä¹‰ï¼Œåˆ†è¾¨ç‡è¶Šé«˜ä½“ç§¯è¶Šå¤§ï¼Œå¦‚æœä¸åŠ è¯¥å‘½ä»¤ï¼Œåˆ™ä¿æŒåˆ†è¾¨ç‡ä¸å˜ï¼› 6) -r â€œ15â€ è¡¨ç¤ºå¸§ç‡ï¼Œç½‘ä¸Šä¸‹è½½çš„è§†é¢‘å¸§ç‡é€šå¸¸ä¸º 24ï¼Œè®¾ä¸º 15 æ•ˆæœæŒºå¥½äº†ï¼Œå¸§ç‡è¶Šé«˜ä½“ç§¯è¶Šå¤§ï¼Œå¦‚æœä¸åŠ è¯¥å‘½ä»¤ï¼Œåˆ™ä¿æŒå¸§ç‡ä¸å˜ï¼› 7) dongtu.gifï¼šå°±æ˜¯ä½ è¦è¾“å‡ºçš„æ–‡ä»¶ï¼Œä½ ä¹Ÿå¯ä»¥æŠŠå®ƒå‘½åä¸º hello.gif ç­‰ç­‰ã€‚ 2. ffplay æ ¼å¼ï¼šffplay {æ–‡ä»¶è·¯å¾„}ï¼Œå¦‚ä¸‹ï¼š ffplay test.mov "},"pages/FFmpeg/FFmpegè§†é¢‘è§£ç .html":{"url":"pages/FFmpeg/FFmpegè§†é¢‘è§£ç .html","title":"FFmpegè§†é¢‘è§£ç ","keywords":"","body":"FFmpegè§†é¢‘è§£ç  ä»£ç å·¥ç¨‹ ä¸€ã€è§†é¢‘è§£ç æµç¨‹ ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ av_register_allï¼šä¾‹å¦‚ï¼šç¼–ç å™¨ã€è§£ç å™¨ç­‰ç­‰ã€‚ // ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ av_register_all(); ç¬¬äºŒæ­¥ï¼šæ‰“å¼€å°è£…æ ¼å¼ avformat_open_inputï¼šä¾‹å¦‚ï¼šæ‰“å¼€.mp4ã€.movã€.wmvæ–‡ä»¶ç­‰ç­‰ã€‚ // ç¬¬äºŒæ­¥ï¼šæ‰“å¼€å°è£…æ ¼å¼ // å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ // ä½œç”¨ï¼šä¿å­˜æ•´ä¸ªè§†é¢‘ä¿¡æ¯(è§£ç å™¨ã€ç¼–ç å™¨ç­‰ç­‰...) // ä¿¡æ¯ï¼šç ç‡ã€å¸§ç‡ç­‰... AVFormatContext* avformat_context = avformat_alloc_context(); // å‚æ•°äºŒï¼šè§†é¢‘è·¯å¾„ // åœ¨æˆ‘ä»¬iOSé‡Œé¢ // NSString* path = @\"test.mov\"; // const char *url = [path UTF8String] const char *url = env->GetStringUTFChars(in_file_path, NULL); // å‚æ•°ä¸‰ï¼šæŒ‡å®šè¾“å…¥çš„æ ¼å¼ // å‚æ•°å››ï¼šè®¾ç½®é»˜è®¤å‚æ•° int avformat_open_input_result = avformat_open_input(&avformat_context, url, NULL, NULL); if (avformat_open_input_result != 0){ // å®‰å“å¹³å°ä¸‹log __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ‰“å¼€æ–‡ä»¶å¤±è´¥\"); // iOSå¹³å°ä¸‹log // NSLog(\"æ‰“å¼€æ–‡ä»¶å¤±è´¥\"); // ä¸åŒçš„å¹³å°æ›¿æ¢ä¸åŒå¹³å°logæ—¥å¿— return; } ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾è§†é¢‘åŸºæœ¬ä¿¡æ¯ avformat_find_stream_infoï¼šå¦‚æœæ˜¯è§†é¢‘è§£ç ï¼Œé‚£ä¹ˆæŸ¥æ‰¾è§†é¢‘æµï¼Œå¦‚æœæ˜¯éŸ³é¢‘è§£ç ï¼Œé‚£ä¹ˆå°±æŸ¥æ‰¾éŸ³é¢‘æµã€‚ // ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾è§†é¢‘æµï¼Œæ‹¿åˆ°è§†é¢‘ä¿¡æ¯ // å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ // å‚æ•°äºŒï¼šæŒ‡å®šé»˜è®¤é…ç½® int avformat_find_stream_info_result = avformat_find_stream_info(avformat_context, NULL); if (avformat_find_stream_info_result ç¬¬å››æ­¥ï¼šæŸ¥æ‰¾è§†é¢‘è§£ç å™¨ avcodec_find_decoderï¼šæŸ¥æ‰¾è§£ç å™¨ã€‚ 1. æŸ¥æ‰¾è§†é¢‘æµç´¢å¼•ä½ç½® // ç¬¬å››æ­¥ï¼šæŸ¥æ‰¾è§†é¢‘è§£ç å™¨ // 4.1 æŸ¥æ‰¾è§†é¢‘æµç´¢å¼•ä½ç½® int av_stream_index = -1; for (int i = 0; i nb_streams; ++i) { // åˆ¤æ–­æµç±»å‹ï¼šè§†é¢‘æµã€éŸ³é¢‘æµã€å­—æ¯æµç­‰ç­‰... if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_VIDEO){ av_stream_index = i; break; } } 2. è·å–è§£ç å™¨ä¸Šä¸‹æ–‡ æ ¹æ®è§†é¢‘æµç´¢å¼•ï¼Œè·å–è§£ç å™¨ä¸Šä¸‹æ–‡ã€‚ // 4.2 æ ¹æ®è§†é¢‘æµç´¢å¼•ï¼Œè·å–è§£ç å™¨ä¸Šä¸‹æ–‡ AVCodecContext *avcodec_context = avformat_context->streams[av_stream_index]->codec; 3. è·å¾—è§£ç å™¨ID æ ¹æ®è§£ç å™¨ä¸Šä¸‹æ–‡ï¼Œè·å¾—è§£ç å™¨IDï¼Œç„¶åæŸ¥æ‰¾è§£ç å™¨ã€‚ // 4.3 æ ¹æ®è§£ç å™¨ä¸Šä¸‹æ–‡ï¼Œè·å¾—è§£ç å™¨IDï¼Œç„¶åæŸ¥æ‰¾è§£ç å™¨ AVCodec *avcodec = avcodec_find_decoder(avcodec_context->codec_id); ç¬¬äº”æ­¥ï¼šæ‰“å¼€è§£ç å™¨ avcodec_open2ï¼šæ‰“å¼€è§£ç å™¨ã€‚ // ç¬¬äº”æ­¥ï¼šæ‰“å¼€è§£ç å™¨ int avcodec_open2_result = avcodec_open2(avcodec_context, avcodec, NULL); if (avcodec_open2_result != 0){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ‰“å¼€è§£ç å™¨å¤±è´¥\"); return; } // æµ‹è¯•ä¸€ä¸‹ // æ‰“å°ä¿¡æ¯ __android_log_print(ANDROID_LOG_INFO, \"main\", \"è§£ç å™¨åç§°ï¼š%s\", avcodec->name); ç¬¬å…­æ­¥ï¼šå®šä¹‰ç±»å‹è½¬æ¢å‚æ•° ç”¨äºsws_scale()ï¼Œè¿›è¡ŒéŸ³é¢‘é‡‡æ ·æ•°æ®è½¬æ¢æ“ä½œã€‚ 1. åˆ›å»ºè§†é¢‘é‡‡æ ·æ•°æ®ä¸Šä¸‹æ–‡ // ç¬¬å…­æ­¥ï¼šå®šä¹‰ç±»å‹è½¬æ¢å‚æ•° // 6.1 åˆ›å»ºè§†é¢‘é‡‡æ ·æ•°æ®å¸§ä¸Šä¸‹æ–‡ // å‚æ•°ä¸€ï¼šæºæ–‡ä»¶->åŸå§‹è§†é¢‘åƒç´ æ•°æ®æ ¼å¼å®½ // å‚æ•°äºŒï¼šæºæ–‡ä»¶->åŸå§‹è§†é¢‘åƒç´ æ•°æ®æ ¼å¼é«˜ // å‚æ•°ä¸‰ï¼šæºæ–‡ä»¶->åŸå§‹è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ // å‚æ•°å››ï¼šç›®æ ‡æ–‡ä»¶->ç›®æ ‡è§†é¢‘åƒç´ æ•°æ®æ ¼å¼å®½ // å‚æ•°äº”ï¼šç›®æ ‡æ–‡ä»¶->ç›®æ ‡è§†é¢‘åƒç´ æ•°æ®æ ¼å¼é«˜ // å‚æ•°å…­ï¼šç›®æ ‡æ–‡ä»¶->ç›®æ ‡è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ SwsContext *swscontext = sws_getContext(avcodec_context->width, avcodec_context->height, avcodec_context->pix_fmt, avcodec_context->width, avcodec_context->height, AV_PIX_FMT_YUV420P, SWS_BICUBIC, NULL, NULL, NULL); 2. åˆ›å»ºè§†é¢‘å‹ç¼©æ•°æ®å¸§ // 6.2 åˆ›å»ºè§†é¢‘å‹ç¼©æ•°æ®å¸§ // è§†é¢‘å‹ç¼©æ•°æ®ï¼šH264 AVFrame* avframe_in = av_frame_alloc(); // å®šä¹‰è§£ç ç»“æœ int decode_result = 0; 3. åˆ›å»ºè§†é¢‘é‡‡æ ·æ•°æ®å¸§ // 6.3 åˆ›å»ºè§†é¢‘é‡‡æ ·æ•°æ®å¸§ // è§†é¢‘é‡‡æ ·æ•°æ®ï¼šYUVæ ¼å¼ AVFrame* avframe_yuv420p = av_frame_alloc(); // ç»™ç¼“å†²åŒºè®¾ç½®ç±»å‹->yuv420ç±»å‹ // å¾—åˆ°YUV420Pç¼“å†²åŒºå¤§å° // å‚æ•°ä¸€ï¼šè§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹->YUV420Pæ ¼å¼ // å‚æ•°äºŒï¼šä¸€å¸§è§†é¢‘åƒç´ æ•°æ®å®½ = è§†é¢‘å®½ // å‚æ•°ä¸‰ï¼šä¸€å¸§è§†é¢‘åƒç´ æ•°æ®é«˜ = è§†é¢‘é«˜ // å‚æ•°å››ï¼šå­—èŠ‚å¯¹é½æ–¹å¼->é»˜è®¤æ˜¯1 int buffer_size = av_image_get_buffer_size(AV_PIX_FMT_YUV420P, avcodec_context->width, avcodec_context->height, 1); // å¼€è¾Ÿä¸€å—å†…å­˜ç©ºé—´ uint8_t *out_buffer = (uint8_t *)av_malloc(buffer_size); // å‘avframe_yuv420på¡«å……æ•°æ® // å‚æ•°ä¸€ï¼šç›®æ ‡->å¡«å……æ•°æ®(avframe_yuv420p) // å‚æ•°äºŒï¼šç›®æ ‡->æ¯ä¸€è¡Œå¤§å° // å‚æ•°ä¸‰ï¼šåŸå§‹æ•°æ® // å‚æ•°å››ï¼šç›®æ ‡->æ ¼å¼ç±»å‹ // å‚æ•°äº”ï¼šå®½ // å‚æ•°å…­ï¼šé«˜ // å‚æ•°ä¸ƒï¼šå­—èŠ‚å¯¹é½æ–¹å¼ av_image_fill_arrays(avframe_yuv420p->data, avframe_yuv420p->linesize, out_buffer, AV_PIX_FMT_YUV420P, avcodec_context->width, avcodec_context->height, 1); ç¬¬ä¸ƒæ­¥ï¼šæ‰“å¼€.yuvæ–‡ä»¶ // ç¬¬ä¸ƒæ­¥ï¼šæ‰“å¼€.yuvæ–‡ä»¶ const char *outfile = env->GetStringUTFChars(out_file_path, NULL); FILE* file_yuv420p = fopen(outfile, \"wb+\"); if (file_yuv420p == NULL){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"è¾“å‡ºæ–‡ä»¶æ‰“å¼€å¤±è´¥\"); return; } ç¬¬å…«æ­¥ï¼šè¯»å–è§†é¢‘å‹ç¼©æ•°æ®å¸§ av_read_frameï¼šè¯»å–è§†é¢‘å‹ç¼©æ•°æ®å¸§ã€‚ // ç¬¬å…«æ­¥ï¼šè¯»å–è§†é¢‘å‹ç¼©æ•°æ®å¸§ int current_index = 0; // å†™å…¥æ—¶yuvæ•°æ®ä½ç½® int y_size, u_size, v_size; // åˆ†æav_read_frameå‚æ•°ã€‚ // å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ // å‚æ•°äºŒï¼šä¸€å¸§å‹ç¼©æ•°æ® // å¦‚æœæ˜¯è§£ç è§†é¢‘æµï¼Œæ˜¯è§†é¢‘å‹ç¼©å¸§æ•°æ®ï¼Œä¾‹å¦‚H264 AVPacket* packet = (AVPacket*)av_malloc(sizeof(AVPacket)); while (av_read_frame(avformat_context, packet) >= 0) { // >=:è¯»å–åˆ°äº† // stream_index == av_stream_index) { // ç¬¬ä¹æ­¥ï¼šå¼€å§‹è§†é¢‘è§£ç  // ... current_index++; __android_log_print(ANDROID_LOG_INFO, \"main\", \"å½“å‰è§£ç ç¬¬%då¸§\", current_index); } } ç¬¬ä¹æ­¥ï¼šå¼€å§‹è§†é¢‘è§£ç  æ³¨æ„ï¼šä»£ç ä½ç½®åœ¨ç¬¬å…«æ­¥ã€‚ avcodec_send_packetï¼šå‘é€ä¸€å¸§è§†é¢‘å‹ç¼©æ•°æ®ã€‚ avcodec_receive_frameï¼šè§£ç ä¸€å¸§è§†é¢‘æ•°æ®ã€‚ // ç¬¬ä¹æ­¥ï¼šå¼€å§‹è§†é¢‘è§£ç  // å‘é€ä¸€å¸§è§†é¢‘å‹ç¼©æ•°æ® avcodec_send_packet(avcodec_context, packet); // è§£ç ä¸€å¸§è§†é¢‘æ•°æ® decode_result = avcodec_receive_frame(avcodec_context, avframe_in); if (decode_result == 0) { // è§†é¢‘è§£ç æˆåŠŸ // ç¬¬åæ­¥ï¼šå¼€å§‹ç±»å‹è½¬æ¢ // ... // ç¬¬åä¸€æ­¥ï¼šå†™å…¥.yuvæ–‡ä»¶ // ... } ç¬¬åæ­¥ï¼šå¼€å§‹ç±»å‹è½¬æ¢ æ³¨æ„ï¼šä»£ç ä½ç½®åœ¨ç¬¬ä¹æ­¥ã€‚ // ç¬¬åæ­¥ï¼šå¼€å§‹ç±»å‹è½¬æ¢ // å°†è§£ç å‡ºæ¥çš„è§†é¢‘åƒç´ ç‚¹æ•°æ®æ ¼å¼ç»Ÿä¸€è½¬ç±»å‹ä¸ºyuv420P // å‚æ•°ä¸€ï¼šè§†é¢‘åƒç´ æ•°æ®æ ¼å¼ä¸Šä¸‹æ–‡ // å‚æ•°äºŒï¼šåŸæ¥çš„è§†é¢‘åƒç´ æ•°æ®æ ¼å¼->è¾“å…¥æ•°æ® // å‚æ•°ä¸‰ï¼šåŸæ¥çš„è§†é¢‘åƒç´ æ•°æ®æ ¼å¼->è¾“å…¥ç”»é¢æ¯ä¸€è¡Œå¤§å° // å‚æ•°å››ï¼šåŸæ¥çš„è§†é¢‘åƒç´ æ•°æ®æ ¼å¼->è¾“å…¥ç”»é¢æ¯ä¸€è¡Œå¼€å§‹ä½ç½®(å¡«å†™ï¼š0->è¡¨ç¤ºä»åŸç‚¹å¼€å§‹è¯»å–) // å‚æ•°äº”ï¼šåŸæ¥çš„è§†é¢‘åƒç´ æ•°æ®æ ¼å¼->è¾“å…¥æ•°æ®è¡Œæ•° // å‚æ•°å…­ï¼šè½¬æ¢ç±»å‹åè§†é¢‘åƒç´ æ•°æ®æ ¼å¼->è¾“å‡ºæ•°æ® // å‚æ•°ä¸ƒï¼šè½¬æ¢ç±»å‹åè§†é¢‘åƒç´ æ•°æ®æ ¼å¼->è¾“å‡ºç”»é¢æ¯ä¸€è¡Œå¤§å° sws_scale(swscontext, (const uint8_t *const *)avframe_in->data, avframe_in->linesize, 0, avcodec_context->height, avframe_yuv420p->data, avframe_yuv420p->linesize); ç¬¬åä¸€æ­¥ï¼šå†™å…¥.yuvæ–‡ä»¶ æ³¨æ„ï¼šä»£ç ä½ç½®åœ¨ç¬¬ä¹æ­¥ã€‚ // ç¬¬åä¸€æ­¥ï¼šå†™å…¥.yuvæ–‡ä»¶ // è®¡ç®—YUVå¤§å° // Yè¡¨ç¤ºï¼šäº®åº¦ // UVè¡¨ç¤ºï¼šè‰²åº¦ // YUV420Pæ ¼å¼è§„èŒƒä¸€ï¼šYç»“æ„è¡¨ç¤ºä¸€ä¸ªåƒç´ (ä¸€ä¸ªåƒç´ å¯¹åº”ä¸€ä¸ªY) // YUV420Pæ ¼å¼è§„èŒƒäºŒï¼š4ä¸ªåƒç´ ç‚¹å¯¹åº”ä¸€ä¸ª(Uå’ŒV: 4Y = U = V) y_size = avcodec_context->width * avcodec_context->height; u_size = y_size / 4; v_size = y_size / 4; // é¦–å…ˆ->Yæ•°æ® fwrite(avframe_yuv420p->data[0], 1, y_size, file_yuv420p); // å…¶æ¬¡->Uæ•°æ® fwrite(avframe_yuv420p->data[1], 1, u_size, file_yuv420p); // å†å…¶æ¬¡->Væ•°æ® fwrite(avframe_yuv420p->data[2], 1, v_size, file_yuv420p); ç¬¬åäºŒæ­¥ï¼šé‡Šæ”¾å†…å­˜èµ„æºï¼Œå…³é—­è§£ç å™¨ // ç¬¬åäºŒæ­¥ï¼šé‡Šæ”¾å†…å­˜èµ„æºï¼Œå…³é—­è§£ç å™¨ av_packet_free(&packet); fclose(file_yuv420p); av_frame_free(&avframe_in); av_frame_free(&avframe_yuv420p); free(out_buffer); avcodec_close(avcodec_context); avformat_free_context(avformat_context); äºŒã€æ–°å»ºAndroidè§†é¢‘è§£ç å·¥ç¨‹ 1. æ–°å»ºå·¥ç¨‹ å‚è€ƒä¹‹å‰FFmpegé›†æˆï¼Œæ–°å»ºndkå·¥ç¨‹AndroidFFmpegDecodingVideoã€‚ 2. å®šä¹‰javaæ–¹æ³• å¯»æ‰¾MainActivityï¼šapp->src->main->java->MainActivityï¼Œå¢åŠ ä»£ç å¦‚ä¸‹ï¼š public native void ffmepgDecodeVideo(String inFilePath, String outFilePath); 3. å®šä¹‰NDKæ–¹æ³• å¢åŠ androidæ‰“å°ã€‚ #include åœ¨native-lib.cppä¸­ï¼Œå¯¼å…¥FFmpegå¤´æ–‡ä»¶ã€‚ extern \"C\" { // å¼•å…¥å¤´æ–‡ä»¶ // æ ¸å¿ƒåº“->éŸ³è§†é¢‘ç¼–è§£ç åº“ #include // å°è£…æ ¼å¼å¤„ç†åº“ #include \"libavformat/avformat.h\" // å·¥å…·åº“ #include \"libavutil/imgutils.h\" // è§†é¢‘åƒç´ æ•°æ®æ ¼å¼åº“ #include \"libswscale/swscale.h\" } åœ¨native-lib.cppä¸­æ–°å¢javaæ–¹æ³•ffmepgDecodeVideoçš„C++å®ç°ï¼Œè¾“å…¥MainActivity.å°±ä¼šæœ‰ä»£ç æç¤ºï¼Œé€‰æ‹©æ­£ç¡®ffmepgDecodeVideoæ–¹æ³•è¡¥å…¨ä»£ç ã€‚ extern \"C\" JNIEXPORT void JNICALL Java_com_ccq_androidffmpegdecodingvideo_MainActivity_ffmepgDecodeVideo(JNIEnv *env, jobject thiz, jstring in_file_path, jstring out_file_path) { // è¿™é‡Œæ‹·è´ä¸Šé¢çš„è§†é¢‘è§£ç æµç¨‹çš„ä»£ç å³å¯ã€‚ } ä¸‰ã€æµ‹è¯•Androidè§†é¢‘è§£ç å·¥ç¨‹ å‡†å¤‡è§†é¢‘æ–‡ä»¶ï¼štest.mov åœ¨AndroidManifest.xmlå¢åŠ SDå¡çš„è¯»å†™æƒé™ã€‚ MainActivityå¢åŠ æµ‹è¯•ä»£ç ã€‚ æ³¨æ„ï¼šå¦‚æœæ‰“å¼€å¤±è´¥ï¼Œå¯èƒ½è¯»å†™å­˜å‚¨è®¾å¤‡çš„æƒé™è¢«ç¦ç”¨ã€‚ æ‘©æ‰˜ç½—æ‹‰Â·åˆ€é”‹ï¼šè®¾ç½®->åº”ç”¨å’Œé€šçŸ¥->é«˜çº§->æƒé™ç®¡ç†å™¨->éšç§ç›¸å…³Â·è¯»å†™å­˜å‚¨è®¾å¤‡->æ‰¾åˆ°åº”ç”¨->å¦‚æœç¦ç”¨ï¼Œåˆ™ä¿®æ”¹ä¸ºå…è®¸ã€‚ import android.os.Environment; import java.io.File; import java.io.IOException; import android.util.Log; String rootPath = Environment.getExternalStorageDirectory().getAbsolutePath(); String downloadPath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS).getAbsolutePath(); String inFilePath = downloadPath.concat(\"/test.mov\"); String outFilePath = downloadPath.concat(\"/test.yuv\"); // æ–‡ä»¶ä¸å­˜åœ¨æˆ‘åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ File file = new File(outFilePath); if (file.exists()) { Log.i(\"æ—¥å¿—ï¼š\",\"å­˜åœ¨\"); } else { try { file.createNewFile(); } catch (IOException e) { e.printStackTrace(); } } ffmepgDecodeVideo(inFilePath, outFilePath); å‡ºç°é—®é¢˜ï¼Œå¾…è§£å†³ï¼š I/main: è§£ç å™¨åç§°ï¼šh264 A/libc: Fatal signal 6 (SIGABRT), code -1 (SI_QUEUE) in tid 5713 (egdecodingvideo), pid 5713 (egdecodingvideo) å¢åŠ æ‰“å°pix_fmtä»£ç ï¼š __android_log_print(ANDROID_LOG_INFO, \"main\", \"avcodec_context->pix_fmtï¼š%d\", avcodec_context->pix_fmt); å‘ç°avcodec_context->pix_fmt = -1ï¼Œå¯¼è‡´sws_getContextæ–¹æ³•å‡ºé”™ï¼Œä¿®æ”¹sws_getContextçš„srcFormatå‚æ•°ã€‚ SwsContext *swscontext = sws_getContext(avcodec_context->width, avcodec_context->height, AV_PIX_FMT_YUV420P, //avcodec_context->pix_fmt, avcodec_context->width, avcodec_context->height, AV_PIX_FMT_YUV420P, SWS_BICUBIC, NULL, NULL, NULL); runå·¥ç¨‹ä»£ç ï¼Œæ­£ç¡®æ‰“å°ï¼ŒåŒæ—¶æ­£ç¡®ç”Ÿæˆyuvæ–‡ä»¶ã€‚ I/main: è§£ç å™¨åç§°ï¼šh264 I/main: avcodec_context->widthï¼š640 I/main: avcodec_context->heightï¼š352 I/main: avcodec_context->pix_fmtï¼š-1 I/main: å½“å‰è§£ç ç¬¬1å¸§ . . . I/main: å½“å‰è§£ç ç¬¬600å¸§ yuvæ–‡ä»¶å¤ªå¤§ï¼ˆ202.1Mï¼‰ï¼Œä¸æ–¹ä¾¿ä¸Šä¼ ã€‚yuvæ’­æ”¾ï¼š ffplay -f rawvideo -video_size 640x352 /Users/chenchangqing/Documents/code/ffmpeg/resources/test.yuv "},"pages/FFmpeg/FFmpegéŸ³é¢‘è§£ç .html":{"url":"pages/FFmpeg/FFmpegéŸ³é¢‘è§£ç .html","title":"FFmpegéŸ³é¢‘è§£ç ","keywords":"","body":"FFmpegè§†é¢‘è§£ç  ä»£ç å·¥ç¨‹ ä¸€ã€è§†é¢‘è§£ç æµç¨‹ ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ av_register_allï¼šä¾‹å¦‚ï¼šç¼–ç å™¨ã€è§£ç å™¨ç­‰ç­‰ã€‚ // ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ av_register_all(); ç¬¬äºŒæ­¥ï¼šæ‰“å¼€å°è£…æ ¼å¼ avformat_open_inputï¼šä¾‹å¦‚ï¼šæ‰“å¼€.mp4ã€.movã€.wmvæ–‡ä»¶ç­‰ç­‰ã€‚ // ç¬¬äºŒæ­¥ï¼šæ‰“å¼€å°è£…æ ¼å¼ // å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ // ä½œç”¨ï¼šä¿å­˜æ•´ä¸ªè§†é¢‘ä¿¡æ¯(è§£ç å™¨ã€ç¼–ç å™¨ç­‰ç­‰...) // ä¿¡æ¯ï¼šç ç‡ã€å¸§ç‡ç­‰... AVFormatContext* avformat_context = avformat_alloc_context(); // å‚æ•°äºŒï¼šè§†é¢‘è·¯å¾„ // åœ¨æˆ‘ä»¬iOSé‡Œé¢ // NSString* path = @\"test.mov\"; // const char *url = [path UTF8String] const char *url = env->GetStringUTFChars(in_file_path, NULL); // å‚æ•°ä¸‰ï¼šæŒ‡å®šè¾“å…¥çš„æ ¼å¼ // å‚æ•°å››ï¼šè®¾ç½®é»˜è®¤å‚æ•° int avformat_open_input_result = avformat_open_input(&avformat_context, url, NULL, NULL); if (avformat_open_input_result != 0){ // å®‰å“å¹³å°ä¸‹log __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ‰“å¼€æ–‡ä»¶å¤±è´¥\"); // iOSå¹³å°ä¸‹log // NSLog(\"æ‰“å¼€æ–‡ä»¶å¤±è´¥\"); // ä¸åŒçš„å¹³å°æ›¿æ¢ä¸åŒå¹³å°logæ—¥å¿— return; } ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾è§†é¢‘åŸºæœ¬ä¿¡æ¯ avformat_find_stream_infoï¼šå¦‚æœæ˜¯è§†é¢‘è§£ç ï¼Œé‚£ä¹ˆæŸ¥æ‰¾è§†é¢‘æµï¼Œå¦‚æœæ˜¯éŸ³é¢‘è§£ç ï¼Œé‚£ä¹ˆå°±æŸ¥æ‰¾éŸ³é¢‘æµã€‚ // ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾è§†é¢‘æµï¼Œæ‹¿åˆ°è§†é¢‘ä¿¡æ¯ // å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ // å‚æ•°äºŒï¼šæŒ‡å®šé»˜è®¤é…ç½® int avformat_find_stream_info_result = avformat_find_stream_info(avformat_context, NULL); if (avformat_find_stream_info_result ç¬¬å››æ­¥ï¼šæŸ¥æ‰¾éŸ³é¢‘è§£ç å™¨ avcodec_find_decoderï¼šæŸ¥æ‰¾è§£ç å™¨ã€‚ 1. æŸ¥æ‰¾éŸ³é¢‘æµç´¢å¼•ä½ç½® // ç¬¬å››æ­¥ï¼šæŸ¥æ‰¾éŸ³é¢‘è§£ç å™¨ // 4.1 æŸ¥æ‰¾éŸ³é¢‘æµç´¢å¼•ä½ç½® int av_stream_index = -1; for (int i = 0; i nb_streams; ++i) { // åˆ¤æ–­æµç±»å‹ï¼šè§†é¢‘æµã€éŸ³é¢‘æµã€å­—æ¯æµç­‰ç­‰... if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_AUDIO){ av_stream_index = i; break; } } 2. è·å–è§£ç å™¨ä¸Šä¸‹æ–‡ æ ¹æ®éŸ³é¢‘æµç´¢å¼•ï¼Œè·å–è§£ç å™¨ä¸Šä¸‹æ–‡ã€‚ // 4.2 æ ¹æ®éŸ³é¢‘æµç´¢å¼•ï¼Œè·å–è§£ç å™¨ä¸Šä¸‹æ–‡ AVCodecContext *avcodec_context = avformat_context->streams[av_stream_index]->codec; 3. è·å¾—è§£ç å™¨ID æ ¹æ®è§£ç å™¨ä¸Šä¸‹æ–‡ï¼Œè·å¾—è§£ç å™¨IDï¼Œç„¶åæŸ¥æ‰¾è§£ç å™¨ã€‚ // 4.3 æ ¹æ®è§£ç å™¨ä¸Šä¸‹æ–‡ï¼Œè·å¾—è§£ç å™¨IDï¼Œç„¶åæŸ¥æ‰¾è§£ç å™¨ AVCodec *avcodec = avcodec_find_decoder(avcodec_context->codec_id); ç¬¬äº”æ­¥ï¼šæ‰“å¼€è§£ç å™¨ avcodec_open2ï¼šæ‰“å¼€è§£ç å™¨ã€‚ // ç¬¬äº”æ­¥ï¼šæ‰“å¼€è§£ç å™¨ int avcodec_open2_result = avcodec_open2(avcodec_context, avcodec, NULL); if (avcodec_open2_result != 0){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ‰“å¼€è§£ç å™¨å¤±è´¥\"); return; } // æµ‹è¯•ä¸€ä¸‹ // æ‰“å°ä¿¡æ¯ __android_log_print(ANDROID_LOG_INFO, \"main\", \"è§£ç å™¨åç§°ï¼š%s\", avcodec->name); ç¬¬å…­æ­¥ï¼šå®šä¹‰ç±»å‹è½¬æ¢å‚æ•° ç”¨äºswr_convert()ï¼Œè¿›è¡ŒéŸ³é¢‘é‡‡æ ·æ•°æ®è½¬æ¢æ“ä½œã€‚ 1. åˆ›å»ºéŸ³é¢‘é‡‡æ ·æ•°æ®ä¸Šä¸‹æ–‡ // ç¬¬å…­æ­¥ï¼šå®šä¹‰ç±»å‹è½¬æ¢å‚æ•° // 6.1 åˆ›å»ºéŸ³é¢‘é‡‡æ ·æ•°æ®ä¸Šä¸‹æ–‡ // å‚æ•°ä¸€ï¼šéŸ³é¢‘é‡‡æ ·æ•°æ®ä¸Šä¸‹æ–‡ // ä¸Šä¸‹æ–‡ï¼šä¿å­˜éŸ³é¢‘ä¿¡æ¯ SwrContext* swr_context = swr_alloc(); // å‚æ•°äºŒï¼šè¾“å‡ºå£°é“å¸ƒå±€ç±»å‹(ç«‹ä½“å£°ã€ç¯ç»•å£°ã€æœºå™¨äººç­‰ç­‰...) // ç«‹ä½“å£° int64_t out_ch_layout = AV_CH_LAYOUT_STEREO; // int out_ch_layout = av_get_default_channel_layout(avcodec_context->channels); // å‚æ•°ä¸‰ï¼šè¾“å‡ºé‡‡æ ·ç²¾åº¦ï¼ˆç¼–ç ï¼‰ // ä¾‹å¦‚ï¼šé‡‡æ ·ç²¾åº¦8ä½ = 1å­—èŠ‚ï¼Œé‡‡æ ·ç²¾åº¦16ä½ = 2å­—èŠ‚ // ç›´æ¥æŒ‡å®š // int out_sample_fmt = AV_SAMPLE_FMT_S16; // åŠ¨æ€è·å–ï¼Œä¿æŒä¸€è‡´ AVSampleFormat out_sample_fmt = avcodec_context->sample_fmt; // å‚æ•°å››ï¼šè¾“å‡ºé‡‡æ ·ç‡(44100HZ) int out_sample_rate = avcodec_context->sample_rate; // å‚æ•°äº”ï¼šè¾“å…¥å£°é“å¸ƒå±€ç±»å‹ int64_t in_ch_layout = av_get_default_channel_layout(avcodec_context->channels); // å‚æ•°å…­ï¼šè¾“å…¥é‡‡æ ·ç²¾åº¦ AVSampleFormat in_sample_fmt = avcodec_context->sample_fmt; // å‚æ•°ä¸ƒï¼šè¾“å…¥é‡‡æ ·ç‡ int in_sample_rate = avcodec_context->sample_rate; // å‚æ•°å…«ï¼šlog_offset->logæ—¥å¿—ï¼Œä»é‚£é‡Œå¼€å§‹ç»Ÿè®¡ int log_offset = 0; // å‚æ•°ä¹ï¼šlogä¸Šä¸‹æ–‡ swr_alloc_set_opts(swr_context, out_ch_layout, out_sample_fmt, out_sample_rate, in_ch_layout, in_sample_fmt, in_sample_rate, log_offset, NULL); // åˆå§‹åŒ–éŸ³é¢‘é‡‡æ ·æ•°æ®ä¸Šä¸‹æ–‡ swr_init(swr_context); 2. åˆ›å»ºéŸ³é¢‘å‹ç¼©æ•°æ®å¸§ // 6.2 åˆ›å»ºéŸ³é¢‘å‹ç¼©æ•°æ®å¸§ // éŸ³é¢‘å‹ç¼©æ•°æ®ï¼šaccæ ¼å¼ã€mp3æ ¼å¼ AVFrame* avframe_in = av_frame_alloc(); // å®šä¹‰è§£ç ç»“æœ int decode_result = 0; 3. åˆ›å»ºéŸ³é¢‘é‡‡æ ·æ•°æ®å¸§ // 6.3 åˆ›å»ºéŸ³é¢‘é‡‡æ ·æ•°æ®å¸§ // éŸ³é¢‘é‡‡æ ·æ•°æ®ï¼šPCMæ ¼å¼ // ç¼“å†²åŒºå¤§å° = é‡‡æ ·ç‡(44100HZ) * é‡‡æ ·ç²¾åº¦(16ä½ = 2å­—èŠ‚) int MAX_AUDIO_SIZE = 44100 * 2; uint8_t *out_buffer = (uint8_t *)av_malloc(MAX_AUDIO_SIZE); ç¬¬ä¸ƒæ­¥ï¼šæ‰“å¼€.pcmæ–‡ä»¶ // ç¬¬ä¸ƒæ­¥ï¼šæ‰“å¼€.yuvæ–‡ä»¶ const char *outfile = env->GetStringUTFChars(out_file_path, NULL); FILE* file_pcm = fopen(outfile, \"wb+\"); if (file_pcm == NULL){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"è¾“å‡ºæ–‡ä»¶æ‰“å¼€å¤±è´¥\"); return; } ç¬¬å…«æ­¥ï¼šè¯»å–è§†é¢‘å‹ç¼©æ•°æ®å¸§ av_read_frameï¼šè¯»å–è§†é¢‘å‹ç¼©æ•°æ®å¸§ã€‚ // ç¬¬å…«æ­¥ï¼šè¯»å–è§†é¢‘å‹ç¼©æ•°æ®å¸§ int current_index = 0; // åˆ†æav_read_frameå‚æ•°ã€‚ // å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ // å‚æ•°äºŒï¼šä¸€å¸§å‹ç¼©æ•°æ® // å¦‚æœæ˜¯è§£ç éŸ³é¢‘æµï¼Œæ˜¯éŸ³é¢‘å‹ç¼©å¸§æ•°æ®ï¼Œä¾‹å¦‚accã€mp3 AVPacket* packet = (AVPacket*)av_malloc(sizeof(AVPacket)); while (av_read_frame(avformat_context, packet) >= 0) { // >=:è¯»å–åˆ°äº† // stream_index == av_stream_index) { // ç¬¬ä¹æ­¥ï¼šå¼€å§‹éŸ³é¢‘è§£ç  // ... current_index++; __android_log_print(ANDROID_LOG_INFO, \"main\", \"å½“å‰è§£ç ç¬¬%då¸§\", current_index); } } ç¬¬ä¹æ­¥ï¼šå¼€å§‹è§†é¢‘è§£ç  æ³¨æ„ï¼šä»£ç ä½ç½®åœ¨ç¬¬å…«æ­¥ã€‚ avcodec_send_packetï¼šå‘é€ä¸€å¸§è§†é¢‘å‹ç¼©æ•°æ®ã€‚ avcodec_receive_frameï¼šè§£ç ä¸€å¸§è§†é¢‘æ•°æ®ã€‚ // ç¬¬ä¹æ­¥ï¼šå¼€å§‹éŸ³é¢‘è§£ç  // å‘é€ä¸€å¸§éŸ³é¢‘å‹ç¼©æ•°æ® avcodec_send_packet(avcodec_context, packet); // è§£ç ä¸€å¸§è§†é¢‘æ•°æ® decode_result = avcodec_receive_frame(avcodec_context, avframe_in); if (decode_result == 0) { // éŸ³é¢‘è§£ç æˆåŠŸ // ç¬¬åæ­¥ï¼šå¼€å§‹ç±»å‹è½¬æ¢ // ... // ç¬¬åä¸€æ­¥ï¼šå†™å…¥.pcmæ–‡ä»¶ // ... } ç¬¬åæ­¥ï¼šå¼€å§‹ç±»å‹è½¬æ¢ æ³¨æ„ï¼šä»£ç ä½ç½®åœ¨ç¬¬ä¹æ­¥ã€‚ // ç¬¬åæ­¥ï¼šå¼€å§‹ç±»å‹è½¬æ¢ // å°†è§£ç å‡ºæ¥çš„éŸ³é¢‘æ•°æ®æ ¼å¼ç»Ÿä¸€è½¬ç±»å‹ä¸ºPCM // å‚æ•°ä¸€ï¼šéŸ³é¢‘é‡‡æ ·æ•°æ®ä¸Šä¸‹æ–‡ // å‚æ•°äºŒï¼šè¾“å‡ºéŸ³é¢‘é‡‡æ ·æ•°æ® // å‚æ•°ä¸‰ï¼šè¾“å‡ºéŸ³é¢‘é‡‡æ ·æ•°æ®->å¤§å° // å‚æ•°å››ï¼šè¾“å…¥éŸ³é¢‘é‡‡æ ·æ•°æ® // å‚æ•°äº”ï¼šè¾“å…¥éŸ³é¢‘é‡‡æ ·æ•°æ®->å¤§å° swr_convert(swr_context, &out_buffer, MAX_AUDIO_SIZE, (const uint8_t **)avframe_in->data, avframe_in->nb_samples); ç¬¬åä¸€æ­¥ï¼šå†™å…¥.pcmæ–‡ä»¶ æ³¨æ„ï¼šä»£ç ä½ç½®åœ¨ç¬¬ä¹æ­¥ã€‚ // ç¬¬åä¸€æ­¥ï¼šå†™å…¥.pcmæ–‡ä»¶ // è·å–ç¼“å†²åŒºå®é™…å­˜å‚¨å¤§å° // å‚æ•°ä¸€ï¼šè¡Œå¤§å° // å‚æ•°äºŒï¼šè¾“å‡ºå£°é“æ•°é‡ int out_nb_channels = av_get_channel_layout_nb_channels(out_ch_layout); // å‚æ•°ä¸‰ï¼šè¾“å…¥å¤§å° // å‚æ•°å››ï¼šè¾“å‡ºéŸ³é¢‘é‡‡æ ·æ•°æ®æ ¼å¼ // å‚æ•°äº”ï¼šå­—èŠ‚å¯¹é½æ–¹å¼ int out_buffer_size = av_samples_get_buffer_size(NULL, out_nb_channels, avframe_in->nb_samples, out_sample_fmt, 1); // å†™å…¥æ–‡ä»¶ fwrite(out_buffer, 1, out_buffer_size, file_pcm); ç¬¬åäºŒæ­¥ï¼šé‡Šæ”¾å†…å­˜èµ„æºï¼Œå…³é—­è§£ç å™¨ // ç¬¬åäºŒæ­¥ï¼šé‡Šæ”¾å†…å­˜èµ„æºï¼Œå…³é—­è§£ç å™¨ fclose(file_pcm); av_packet_free(&packet); swr_free(&swr_context); av_free(out_buffer); av_frame_free(&avframe_in); avcodec_close(avcodec_context); avformat_close_input(&avformat_context); äºŒã€æ–°å»ºAndroidéŸ³é¢‘è§£ç å·¥ç¨‹ 1. æ–°å»ºå·¥ç¨‹ å‚è€ƒä¹‹å‰FFmpegé›†æˆï¼Œæ–°å»ºndkå·¥ç¨‹AndroidFFmpegDecodingAudioã€‚ 2. å®šä¹‰javaæ–¹æ³• å¯»æ‰¾MainActivityï¼šapp->src->main->java->MainActivityï¼Œå¢åŠ ä»£ç å¦‚ä¸‹ï¼š public native void ffmepgDecodeAudio(String inFilePath, String outFilePath); 3. å®šä¹‰NDKæ–¹æ³• å¢åŠ androidæ‰“å°ã€‚ #include åœ¨native-lib.cppä¸­ï¼Œå¯¼å…¥FFmpegå¤´æ–‡ä»¶ã€‚ extern \"C\" { // å¼•å…¥å¤´æ–‡ä»¶ // æ ¸å¿ƒåº“->éŸ³è§†é¢‘ç¼–è§£ç åº“ #include // å°è£…æ ¼å¼å¤„ç†åº“ #include \"libavformat/avformat.h\" // å·¥å…·åº“ #include \"libavutil/imgutils.h\" // è§†é¢‘åƒç´ æ•°æ®æ ¼å¼åº“ #include \"libswscale/swscale.h\" // éŸ³é¢‘é‡‡æ ·æ•°æ®æ ¼å¼åº“ #include \"libswresample/swresample.h\" } åœ¨native-lib.cppä¸­æ–°å¢javaæ–¹æ³•ffmepgDecodeAudioçš„C++å®ç°ï¼Œè¾“å…¥MainActivity.å°±ä¼šæœ‰ä»£ç æç¤ºï¼Œé€‰æ‹©æ­£ç¡®ffmepgDecodeAudioæ–¹æ³•è¡¥å…¨ä»£ç ã€‚ extern \"C\" JNIEXPORT void JNICALL Java_com_ccq_androidffmpegdecodingaudio_MainActivity_ffmepgDecodeAudio(JNIEnv *env, jobject thiz, jstring in_file_path, jstring out_file_path) { // è¿™é‡Œæ‹·è´ä¸Šé¢çš„éŸ³é¢‘è§£ç æµç¨‹çš„ä»£ç å³å¯ã€‚ } ä¸‰ã€æµ‹è¯•AndroidéŸ³é¢‘è§£ç å·¥ç¨‹ å‡†å¤‡è§†é¢‘æ–‡ä»¶ï¼štest.mov åœ¨AndroidManifest.xmlå¢åŠ SDå¡çš„è¯»å†™æƒé™ã€‚ MainActivityå¢åŠ æµ‹è¯•ä»£ç ã€‚ æ³¨æ„ï¼šå¦‚æœæ‰“å¼€å¤±è´¥ï¼Œå¯èƒ½è¯»å†™å­˜å‚¨è®¾å¤‡çš„æƒé™è¢«ç¦ç”¨ã€‚ æ‘©æ‰˜ç½—æ‹‰Â·åˆ€é”‹ï¼šè®¾ç½®->åº”ç”¨å’Œé€šçŸ¥->é«˜çº§->æƒé™ç®¡ç†å™¨->éšç§ç›¸å…³Â·è¯»å†™å­˜å‚¨è®¾å¤‡->æ‰¾åˆ°åº”ç”¨->å¦‚æœç¦ç”¨ï¼Œåˆ™ä¿®æ”¹ä¸ºå…è®¸ã€‚ import android.os.Environment; import java.io.File; import java.io.IOException; import android.util.Log; String rootPath = Environment.getExternalStorageDirectory().getAbsolutePath(); String downloadPath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS).getAbsolutePath(); String inFilePath = downloadPath.concat(\"/test.mov\"); String outFilePath = downloadPath.concat(\"/test.pcm\"); // æ–‡ä»¶ä¸å­˜åœ¨æˆ‘åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ File file = new File(outFilePath); if (file.exists()) { Log.i(\"æ—¥å¿—ï¼š\",\"å­˜åœ¨\"); } else { try { file.createNewFile(); } catch (IOException e) { e.printStackTrace(); } } ffmepgDecodeAudio(inFilePath, outFilePath); runå·¥ç¨‹ä»£ç ï¼Œæ­£ç¡®æ‰“å°ï¼ŒåŒæ—¶æ­£ç¡®ç”Ÿæˆpcmæ–‡ä»¶ã€‚ I/main: è§£ç å™¨åç§°ï¼šacc I/main: å½“å‰è§£ç ç¬¬1å¸§ . . . I/main: å½“å‰è§£ç ç¬¬502å¸§ pcmæ–‡ä»¶éŸ³é¢‘æ’­æ”¾ï¼š ffplay -f s16le -ac 2 -ar 44100 /Users/chenchangqing/Downloads/test.pcm "},"pages/FFmpeg/FFmpegè§†é¢‘ç¼–ç .html":{"url":"pages/FFmpeg/FFmpegè§†é¢‘ç¼–ç .html","title":"FFmpegè§†é¢‘ç¼–ç ","keywords":"","body":"FFmpegè§†é¢‘ç¼–ç  Androidä»£ç å·¥ç¨‹ iOSä»£ç å·¥ç¨‹ ä¸€ã€è§†é¢‘ç¼–ç æµç¨‹ ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ av_register_allï¼šä¾‹å¦‚ï¼šç¼–ç å™¨ã€è§£ç å™¨ç­‰ç­‰ã€‚ // ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ av_register_all(); ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–å°è£…æ ¼å¼ä¸Šä¸‹æ–‡ // ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–å°è£…æ ¼å¼ä¸Šä¸‹æ–‡ AVFormatContext *avformat_context = avformat_alloc_context(); const char *coutFilePath = env->GetStringUTFChars(out_file_path, NULL); // iOSä½¿ç”¨ // const char *coutFilePath = [outFilePath UTF8String]; AVOutputFormat *avoutput_format = av_guess_format(NULL, coutFilePath, NULL); // è®¾ç½®è§†é¢‘å‹ç¼©æ•°æ®æ ¼å¼ç±»å‹(h264ã€h265ã€mpeg2ç­‰ç­‰...) avformat_context->oformat = avoutput_format; ç¬¬ä¸‰æ­¥ï¼šæ‰“å¼€è¾“å‡ºæ–‡ä»¶ // ç¬¬ä¸‰æ­¥ï¼šæ‰“å¼€è¾“å‡ºæ–‡ä»¶ // å‚æ•°ä¸€ï¼šè¾“å‡ºæµ // å‚æ•°äºŒï¼šè¾“å‡ºæ–‡ä»¶ // å‚æ•°ä¸‰ï¼šæƒé™->è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ if (avio_open(&avformat_context->pb, coutFilePath, AVIO_FLAG_WRITE) ç¬¬å››æ­¥ï¼šåˆ›å»ºè¾“å‡ºç æµ // ç¬¬å››æ­¥ï¼šåˆ›å»ºè¾“å‡ºç æµ // æ³¨æ„ï¼šåˆ›å»ºäº†ä¸€å—å†…å­˜ç©ºé—´ï¼Œå¹¶ä¸çŸ¥é“ä»–æ˜¯ä»€ä¹ˆç±»å‹æµï¼Œå¸Œæœ›ä»–æ˜¯è§†é¢‘æµ AVStream *av_video_stream = avformat_new_stream(avformat_context, NULL); ç¬¬äº”æ­¥ï¼šåˆå§‹åŒ–ç¼–ç å™¨ä¸Šä¸‹æ–‡ 1. è·å–ç¼–ç å™¨ä¸Šä¸‹æ–‡ // 5.1 è·å–ç¼–ç å™¨ä¸Šä¸‹æ–‡ AVCodecContext *avcodec_context = av_video_stream->codec; 2. è®¾ç½®è§†é¢‘ç¼–ç å™¨ID // 5.2 è®¾ç½®è§†é¢‘ç¼–ç å™¨ID avcodec_context->codec_id = avoutput_format->video_codec; 3. è®¾ç½®ä¸ºè§†é¢‘ç¼–ç å™¨ // 5.3 è®¾ç½®ä¸ºè§†é¢‘ç¼–ç å™¨ avcodec_context->codec_type = AVMEDIA_TYPE_VIDEO; 4. è®¾ç½®åƒç´ æ•°æ®æ ¼å¼ // 5.4 è®¾ç½®åƒç´ æ•°æ®æ ¼å¼ // ç¼–ç çš„æ˜¯åƒç´ æ•°æ®æ ¼å¼ï¼Œè§†é¢‘åƒç´ æ•°æ®æ ¼å¼ä¸ºYUV420P(YUV422Pã€YUV444Pç­‰ç­‰...) // æ³¨æ„ï¼šè¿™ä¸ªç±»å‹æ˜¯æ ¹æ®ä½ è§£ç çš„æ—¶å€™æŒ‡å®šçš„è§£ç çš„è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ avcodec_context->pix_fmt = AV_PIX_FMT_YUV420P; 5. è®¾ç½®è§†é¢‘å°ºå¯¸ // 5.5 è®¾ç½®è§†é¢‘å°ºå¯¸ avcodec_context->width = 640; avcodec_context->height = 352; 6. è®¾ç½®è§†é¢‘å¸§ç‡ // 5.6 è®¾ç½®è§†é¢‘å¸§ç‡ // è§†é¢‘å¸§ç‡ï¼š25fpsï¼ˆæ¯ç§’25å¸§ï¼‰ // å•ä½ï¼šfpsï¼Œ\"f\"è¡¨ç¤ºå¸§æ•°ï¼Œ\"ps\"è¡¨ç¤ºæ¯ç§’ avcodec_context->time_base.num = 1; avcodec_context->time_base.den = 25; 7. è®¾ç½®è§†é¢‘ç ç‡ // 5.7 è®¾ç½®è§†é¢‘ç ç‡ //ï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯ç ç‡ï¼Ÿ // å«ä¹‰ï¼šæ¯ç§’ä¼ é€çš„æ¯”ç‰¹(bit)æ•°å•ä½ä¸º bps(Bit Per Second)ï¼Œæ¯”ç‰¹ç‡è¶Šé«˜ï¼Œä¼ é€æ•°æ®é€Ÿåº¦è¶Šå¿«ã€‚ // å•ä½ï¼šbpsï¼Œ\"b\"è¡¨ç¤ºæ•°æ®é‡ï¼Œ\"ps\"è¡¨ç¤ºæ¯ç§’ã€‚ //ï¼ˆ2ï¼‰ä»€ä¹ˆæ˜¯è§†é¢‘ç ç‡? // å«ä¹‰ï¼šè§†é¢‘ç ç‡å°±æ˜¯æ•°æ®ä¼ è¾“æ—¶å•ä½æ—¶é—´ä¼ é€çš„æ•°æ®ä½æ•°ï¼Œä¸€èˆ¬æˆ‘ä»¬ç”¨çš„å•ä½æ˜¯kbpså³åƒä½æ¯ç§’ã€‚ //ï¼ˆ3ï¼‰è§†é¢‘ç ç‡è®¡ç®—å¦‚ä¸‹ï¼Ÿ // åŸºæœ¬çš„ç®—æ³•æ˜¯ï¼šç ç‡ï¼ˆkbpsï¼‰= è§†é¢‘å¤§å° - éŸ³é¢‘å¤§å°ï¼ˆbitä½ï¼‰/ æ—¶é—´ï¼ˆç§’ï¼‰ã€‚ // ä¾‹å¦‚ï¼šTest.movæ—¶é—´ = 24ç§’ï¼Œæ–‡ä»¶å¤§å°ï¼ˆè§†é¢‘+éŸ³é¢‘ï¼‰ = 1.73MBã€‚ // è§†é¢‘å¤§å° = 1.34MBï¼ˆæ–‡ä»¶å æ¯”ï¼š77%ï¼‰= 1.34MB * 1024 * 1024 * 8 / 24 = å­—èŠ‚å¤§å° = 468365å­—èŠ‚ = 468Kbpsã€‚ // éŸ³é¢‘å¤§å° = 376KBï¼ˆæ–‡ä»¶å æ¯”ï¼š21%ï¼‰ã€‚ // è®¡ç®—å‡ºæ¥çš„ç ç‡ : 468Kbpsï¼ŒKè¡¨ç¤º1000ï¼Œbè¡¨ç¤ºä½ï¼ˆbitï¼‰ã€‚ // æ€»ç»“ï¼šç ç‡è¶Šå¤§ï¼Œè§†é¢‘è¶Šå¤§ã€‚ avcodec_context->bit_rate = 468000; 8. è®¾ç½®GOP // 5.8 è®¾ç½®GOP // å½±å“åˆ°è§†é¢‘è´¨é‡é—®é¢˜ï¼Œæ˜¯ä¸€ç»„è¿ç»­ç”»é¢ //ï¼ˆ1ï¼‰MPEGæ ¼å¼ç”»é¢ç±»å‹ // 3ç§ç±»å‹ï¼šIå¸§ã€På¸§ã€Bå¸§ã€‚ //ï¼ˆ2ï¼‰Iå¸§ï¼š // å†…éƒ¨ç¼–ç å¸§ï¼Œæ˜¯åŸå§‹å¸§ï¼ˆåŸå§‹è§†é¢‘æ•°æ®ï¼‰ // æ˜¯å®Œæ•´ç”»é¢ï¼Œæ˜¯å…³é”®å¸§ï¼ˆå¿…éœ€çš„æœ‰ï¼Œå¦‚æœæ²¡æœ‰Iï¼Œé‚£ä¹ˆä½ æ— æ³•è¿›è¡Œç¼–ç ï¼Œè§£ç ï¼‰ã€‚ // è§†é¢‘ç¬¬1å¸§ï¼šè§†é¢‘åºåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå¸§å§‹ç»ˆéƒ½æ˜¯Iå¸§ï¼Œå› ä¸ºå®ƒæ˜¯å…³é”®å¸§ã€‚ //ï¼ˆ3ï¼‰På¸§ // å‘å‰é¢„æµ‹å¸§ // é¢„æµ‹å‰é¢çš„ä¸€å¸§ç±»å‹ï¼Œå¤„ç†å‰é¢çš„ä¸€é˜µæ•°æ®(->Iå¸§ã€Bå¸§)ã€‚ // På¸§æ•°æ®æ ¹æ®å‰é¢çš„ä¸€å¸§æ•°æ®è¿›è¡Œå¤„ç†å¾—åˆ°äº†På¸§ã€‚ //ï¼ˆ4ï¼‰Bå¸§ // å‰åé¢„æµ‹å¸§ï¼ˆåŒå‘é¢„æµ‹å¸§ï¼‰ï¼Œå‰é¢ä¸€å¸§å’Œåé¢ä¸€å¸§çš„å·®åˆ«ã€‚ // Bå¸§å‹ç¼©ç‡é«˜ï¼Œä½†æ˜¯å¯¹è§£ç æ€§èƒ½è¦æ±‚è¾ƒé«˜ã€‚ //ï¼ˆ5ï¼‰æ€»ç»“ // Iåªéœ€è¦è€ƒè™‘è‡ªå·± = 1å¸§ï¼ŒPå¸§è€ƒè™‘è‡ªå·±+å‰é¢ä¸€å¸§ = 2å¸§ï¼ŒBå¸§è€ƒè™‘è‡ªå·±+å‰åå¸§ = 3å¸§ // è¯´ç™½äº†ï¼ŒPå¸§å’ŒBå¸§æ˜¯å¯¹Iå¸§å‹ç¼©ã€‚ // æ¯250å¸§ï¼Œæ’å…¥1ä¸ªIå¸§ï¼ŒIå¸§è¶Šå°‘ï¼Œè§†é¢‘è¶Šå° avcodec_context->gop_size = 250; 9. è®¾ç½®é‡åŒ–å‚æ•° // 5.9 è®¾ç½®é‡åŒ–å‚æ•° // æ•°å­¦ç®—æ³•ï¼ˆé«˜çº§ç®—æ³•ï¼‰ï¼Œé‡åŒ–ç³»æ•°è¶Šå°ï¼Œè§†é¢‘è¶Šæ˜¯æ¸…æ™° // ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯é»˜è®¤å€¼ï¼Œæœ€å°é‡åŒ–ç³»æ•°é»˜è®¤å€¼æ˜¯10ï¼Œæœ€å¤§é‡åŒ–ç³»æ•°é»˜è®¤å€¼æ˜¯51 avcodec_context->qmin = 10; avcodec_context->qmax = 51; 10. è®¾ç½®bå¸§æœ€å¤§å€¼ // 5.10 è®¾ç½®bå¸§æœ€å¤§å€¼ // è®¾ç½®ä¸éœ€è¦Bå¸§ avcodec_context->max_b_frames = 0; ç¬¬å…­æ­¥ï¼šæŸ¥æ‰¾è§†é¢‘ç¼–ç å™¨ // ç¬¬å…­æ­¥ï¼šæŸ¥æ‰¾è§†é¢‘ç¼–ç å™¨ AVCodec *avcodec = avcodec_find_encoder(avcodec_context->codec_id); if (avcodec == NULL) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ‰¾ä¸åˆ°ç¼–ç å™¨\"); // iOSä½¿ç”¨ // NSLog(@\"æ‰¾ä¸åˆ°ç¼–ç å™¨\"); return; } __android_log_print(ANDROID_LOG_INFO, \"main\", \"ç¼–ç å™¨åç§°ä¸ºï¼š%s\", avcodec->name); // iOSä½¿ç”¨ // NSLog(@\"ç¼–ç å™¨åç§°ä¸ºï¼š%s\", avcodec->name); 1. å‡ºç°é—®é¢˜ æ–°å»ºæµ‹è¯•å·¥ç¨‹ï¼ˆç¨åä¼šä»‹ç»å»ºå·¥ç¨‹æµ‹è¯•ï¼‰ï¼Œä»£ç è¿è¡Œåˆ°è¿™ä¸€æ­¥ä¼šå‡ºç°â€œæ‰¾ä¸åˆ°ç¼–ç å™¨â€ï¼Œå› ä¸ºç¼–è¯‘åº“æ²¡æœ‰ä¾èµ–x264åº“ï¼ˆé»˜è®¤æƒ…å†µä¸‹FFmpegæ²¡æœ‰ç¼–è¯‘è¿›è¡Œh264åº“ï¼‰ã€‚ 2. è§£å†³é—®é¢˜ (1) ä¸‹è½½æºç  x264åº“ï¼Œç¿»å¢™æ›´å¿«ã€‚ git clone https://code.videolan.org/videolan/x264.git (2) ä¸‹è½½ndk https://developer.android.google.cn/ndk/downloads/older_releases.html æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ndkr10eã€‚ åœ¨x264æºç çš„åŒç›®å½•ä¸‹æ–°å»ºndkæ–‡ä»¶äº¤ï¼Œå°†ä¸‹è½½å¥½çš„ndkæ”¾å…¥ndkæ–‡ä»¶å¤¹ã€‚ (3) ç¼–è¯‘x264è„šæœ¬ ç¼–è¯‘x264çš„.aé™æ€åº“ï¼ŒæŒ‡å®šç¼–è¯‘å¹³å°ç±»å‹ï¼šiOSå¹³å°ã€å®‰å“å¹³å°ã€Macå¹³å°ã€Windowså¹³å°ç­‰ç­‰ã€‚ android_build_x264.shæ˜¯ç¼–è¯‘è„šæœ¬ï¼Œå°†ç¼–è¯‘è„šæœ¬æ”¾åœ¨å’Œæºç çš„åŒä¸€ç›®å½•ï¼Œæ‰§è¡Œï¼š sh android-build-x264.sh æ‰§è¡Œè¿‡ç¨‹ä¼šæç¤ºå¼€æœºå¯†ç ï¼Œçœ‹åˆ°Android h264 builds finishedè¯´æ˜ç¼–è¯‘æˆåŠŸã€‚ (4) ç¼–è¯‘FFmpeg ä¿®æ”¹Androidçš„FFmpegåŠ¨æ€åº“ç¼–è¯‘è„šæœ¬ï¼Œå°†x264åº“å…¶ç¼–è¯‘è¿›å»ã€‚android-build-ffmpeg.shæ˜¯åŸæ¥çš„ç¼–è¯‘è„šæœ¬ï¼Œåœ¨åŸæ¥çš„ç¼–è¯‘è„šæœ¬./configureå¢åŠ å¦‚ä¸‹é€‰é¡¹ã€‚ # ä»¥ä¸‹æ˜¯ç¼–è¯‘x264åº“å¢åŠ çš„ # ç¦ç”¨æ‰€æœ‰ç¼–ç å™¨ --disable-encoders \\ # é€šè¿‡libx264åº“å¯ç”¨H.264ç¼–ç  --enable-libx264 \\ # å¯ç”¨ç¼–ç å™¨åç§° --enable-encoder=libx264 \\ # å¯ç”¨å‡ ä¸ªå›¾ç‰‡ç¼–ç ï¼Œç”±äºç”Ÿæˆè§†é¢‘é¢„è§ˆ --enable-encoder=mjpeg \\ --enable-encoder=png \\ #å’ŒFFmpegåŠ¨æ€åº“ä¸€èµ·ç¼–è¯‘ï¼ŒæŒ‡å®šä½ ä¹‹å‰ç¼–è¯‘å¥½çš„x264é™æ€åº“å’Œå¤´æ–‡ä»¶ --extra-cflags=\"-I/Users/chenchangqing/Documents/code/ffmpeg/06_ffmpeg_video_encoding/android_build_x264/include\" \\ --extra-ldflags=\"-L/Users/chenchangqing/Documents/code/ffmpeg/06_ffmpeg_video_encoding/android_build_x264/lib\" \\ android-build-ffmpeg-x264.shæ˜¯ä¿®æ”¹åçš„è„šæœ¬ï¼Œå†æ¬¡ç¼–è¯‘FFmpegåº“ï¼Œé‡æ–°ç”Ÿæˆ.soåŠ¨æ€åº“ã€‚ é‡æ–°ç¼–è¯‘ï¼Œå‘ç°é”™è¯¯ï¼š libavcodec/libx264.c: In function 'X264_frame': libavcodec/libx264.c:282:9: error: 'x264_bit_depth' undeclared (first use in this function) if (x264_bit_depth > 8) ^ libavcodec/libx264.c:282:9: note: each undeclared identifier is reported only once for each function it appears in libavcodec/libx264.c: In function 'X264_init_static': libavcodec/libx264.c:892:9: error: 'x264_bit_depth' undeclared (first use in this function) if (x264_bit_depth == 8) ^ make: *** [libavcodec/libx264.o] Error 1 æŸ¥è¯¢èµ„æ–™ï¼ˆâ€œx264_bit_depthâ€æœªå£°æ˜ï¼‰ï¼Œæ˜¯å› ä¸ºffmpegå’Œx264ä¸å…¼å®¹ï¼Œè¿™é‡Œä¸ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„x264ï¼Œå°è¯•å¦ä¸€ä¸ªç‰ˆæœ¬çš„x264ï¼Œé‡æ–°ç¼–è¯‘ï¼Œå†é‡æ–°ç”Ÿæˆ.soåŠ¨æ€åº“ã€‚ å†æ¬¡è¿è¡Œæµ‹è¯•å·¥ç¨‹ï¼ŒæˆåŠŸè¾“å‡ºï¼š I/main: ç¼–ç å™¨åç§°ä¸ºï¼šlibx264 é—®é¢˜è§£å†³ã€‚ 3. è§£å†³é—®é¢˜ï¼ˆiOSï¼‰ è¿™ä¸ªé—®é¢˜åœ¨iOSä¸Šä¹Ÿæ˜¯å­˜åœ¨çš„ï¼Œè¿™é‡Œä¹Ÿåˆ—å‡ºè§£å†³æ­¥éª¤ã€‚ (1) ä¸‹è½½æºç  x264åº“ï¼Œç¿»å¢™æ›´å¿«ã€‚ git clone https://code.videolan.org/videolan/x264.git (2) ç¼–è¯‘x264è„šæœ¬ ios-build-x264.shæ˜¯ç¼–è¯‘è„šæœ¬ï¼Œå°†ç¼–è¯‘è„šæœ¬æ”¾åœ¨å’Œæºç çš„åŒä¸€ç›®å½•ï¼Œæ‰§è¡Œï¼š sh ios-build-x264.sh æ³¨æ„ï¼šå¦‚æœä½¿ç”¨æ—§ç‰ˆæœ¬çš„x264ï¼Œæ¯”å¦‚è¿™ä¸ªx264ï¼Œä¼šå‡ºç°ä¸‹é¢çš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œä½¿ç”¨çš„å½“æ—¶æœ€æ–°çš„x264ã€‚ Out of tree builds are impossible with config.h/x264_config.h in source dir. (3) ç¼–è¯‘FFmpeg ä¿®æ”¹iOSçš„FFmpegåº“ç¼–è¯‘è„šæœ¬ï¼Œå°†x264åº“å…¶ç¼–è¯‘è¿›å»ã€‚ios-build-ffmpeg.shæ˜¯åŸæ¥çš„ç¼–è¯‘è„šæœ¬ï¼Œåœ¨åŸæ¥çš„ç¼–è¯‘è„šæœ¬./configureå¢åŠ å¦‚ä¸‹é€‰é¡¹ã€‚ # ä»¥ä¸‹æ˜¯ç¼–è¯‘x264åº“å¢åŠ çš„ --enable-gpl \\ --disable-encoders \\ --enable-libx264 \\ --enable-encoder=libx264 \\ --enable-encoder=mjpeg \\ --enable-encoder=png \\ --extra-cflags=\"-I/Users/yangshaohong/Desktop/ffmpeg-test/test/thin-x264/arm64/include\" \\ --extra-ldflags=\"-L/Users/yangshaohong/Desktop/ffmpeg-test/test/thin-x264/arm64/lib\" \\ ios-build-ffmpeg-x264.shæ˜¯ä¿®æ”¹åçš„è„šæœ¬ï¼Œå†æ¬¡ç¼–è¯‘FFmpegåº“ï¼Œé‡æ–°ç”Ÿæˆ.aé™æ€åº“ã€‚ ç”¨äº†æœ€æ–°çš„x264ï¼Œè¿˜æ˜¯å‡ºç°äº†é—®é¢˜ï¼š src/libavcodec/libx264.c:282:9: error: use of undeclared identifier 'x264_bit_depth' if (x264_bit_depth > 8) ^ src/libavcodec/libx264.c:892:9: error: use of undeclared identifier 'x264_bit_depth' if (x264_bit_depth == 8) ^ src/libavcodec/libx264.c:894:14: error: use of undeclared identifier 'x264_bit_depth' else if (x264_bit_depth == 9) ^ src/libavcodec/libx264.c:896:14: error: use of undeclared identifier 'x264_bit_depth' else if (x264_bit_depth == 10) ^ 4 errors generated. make: *** [libavcodec/libx264.o] Error 1 make: *** Waiting for unfinished jobs.... æŸ¥è¯¢èµ„æ–™ï¼ˆâ€œx264_bit_depthâ€æœªå£°æ˜ï¼‰ï¼Œæ˜¯å› ä¸ºffmpegå’Œx264ä¸å…¼å®¹ï¼Œè¿™é‡Œä¸ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„x264ï¼Œå°è¯•å¦ä¸€ä¸ªç‰ˆæœ¬çš„x264-snapshot-20180730-2245-stable.tar.bz2ï¼Œé‡æ–°ç¼–è¯‘ï¼ŒæˆåŠŸç”Ÿæˆäº†æ”¯æŒh264ç¼–ç çš„FFmpegé™æ€åº“ã€‚ æ³¨æ„ï¼šè¿™é‡Œx264å’Œffmpegéƒ½æŒ‡å®šäº†arm64çš„æ¶æ„ã€‚ ç¬¬ä¸ƒæ­¥ï¼šæ‰“å¼€è§†é¢‘ç¼–ç å™¨ æ³¨æ„ï¼šä»£ç ä¸­çš„â€œä¼˜åŒ–æ­¥éª¤â€æ˜¯å¿…é¡»çš„ï¼Œè¦ä¸ç„¶ç¼–ç è¿‡ç¨‹ä¼šæœ‰å‘ã€‚ // ç¬¬ä¸ƒæ­¥ï¼šæ‰“å¼€è§†é¢‘ç¼–ç å™¨ // ä»¥ä¸‹æ˜¯ç¼–ç ä¼˜åŒ–æ­¥éª¤ï¼Œå¿…é¡»æœ‰ï¼Œè¦ä¸ç„¶ç¼–ç ä¼šå‡ºé—®é¢˜ // ç¼–ç å»¶æ—¶é—®é¢˜ï¼Œç¼–ç é€‰é¡¹->ç¼–ç è®¾ç½® AVDictionary *param = 0; if (avcodec_context->codec_id == AV_CODEC_ID_H264) { // éœ€è¦æŸ¥çœ‹x264æºç ->x264.cæ–‡ä»¶ // ç¬¬ä¸€ä¸ªå€¼ï¼šé¢„å¤‡å‚æ•° // key: preset // value: slow->æ…¢ // value: superfast->è¶…å¿« av_dict_set(&param, \"preset\", \"slow\", 0); // ç¬¬äºŒä¸ªå€¼ï¼šè°ƒä¼˜ // key: tune->è°ƒä¼˜ // value: zerolatency->é›¶å»¶è¿Ÿ av_dict_set(&param, \"tune\", \"zerolatency\", 0); } // æ‰“å¼€ç¼–ç å™¨ if (avcodec_open2(avcodec_context, avcodec, &param) ç¬¬å…«æ­¥ï¼šå†™å…¥æ–‡ä»¶å¤´ä¿¡æ¯ // ç¬¬å…«æ­¥ï¼šå†™å…¥æ–‡ä»¶å¤´ä¿¡æ¯ avformat_write_header(avformat_context, NULL); ç¬¬ä¹æ­¥ï¼šæ‰“å¼€yuvæ–‡ä»¶ // ç¬¬ä¹æ­¥ï¼šæ‰“å¼€yuvæ–‡ä»¶ // é‡åˆ°é—®é¢˜ï¼šfopen Permission denied const char *cinFilePath = env->GetStringUTFChars(in_file_path, NULL); // iOSä½¿ç”¨ // const char *cinFilePath = [inFilePath UTF8String]; int errNum = 0; FILE *in_file = fopen(cinFilePath, \"rb\"); if (in_file == NULL) { errNum = errno; __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ–‡ä»¶ä¸å­˜åœ¨:%s,in_file:%s,errNum:%d,reason:%s\", cinFilePath, in_file, errNum, strerror(errNum)); // iOSä½¿ç”¨ // NSLog(@\"æ–‡ä»¶ä¸å­˜åœ¨\"); return; } è¿™ä¸€æ­¥æœ‰å‘ï¼Œæ‰“å¼€yuvæ–‡ä»¶ï¼ˆfopenï¼‰ä¸€ç›´å‡ºç°â€œPermission deniedâ€é”™è¯¯ï¼Œå›°æ‰°äº†æœ‰ä¸€å¤©ï¼Œæœ€åè¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°å¾ˆå¥½çš„åŠæ³•ï¼Œä½†æ˜¯æœ‰ä¸ªä¸´æ—¶è§£å†³åŠæ³•ï¼Œå°±æ˜¯å…ˆæ‰§è¡Œè§†é¢‘è§£ç ä¸º.yuvæ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å»æ‰“å¼€ï¼ˆfopenï¼‰åˆšç”Ÿæˆçš„.yuvæ–‡ä»¶ï¼Œæ˜¯å¯ä»¥æˆåŠŸçš„ã€‚ ç¬¬åæ­¥ï¼šè§†é¢‘ç¼–ç å‡†å¤‡ // ç¬¬åæ­¥ï¼šè§†é¢‘ç¼–ç å‡†å¤‡ // 10.1 åˆ›å»ºè§†é¢‘åŸå§‹æ•°æ®å¸§ // ä½œç”¨ï¼šå­˜å‚¨è§†é¢‘åŸå§‹æ•°æ®å¸§ AVFrame *av_frame = av_frame_alloc(); // 10.2 åˆ›å»ºä¸€ä¸ªç¼“å†²åŒº // ä½œç”¨ï¼šç”¨äºç¼“å­˜è¯»å–è§†é¢‘æ•°æ® // å…ˆè·å–ç¼“å†²åŒºå¤§å° int buffer_size = av_image_get_buffer_size(avcodec_context->pix_fmt, avcodec_context->width, avcodec_context->height, 1); // åˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œä½œç”¨æ˜¯ç¼“å­˜ä¸€å¸§è§†é¢‘åƒç´ æ•°æ® uint8_t *out_buffer = (uint8_t *) av_malloc(buffer_size); // 10.3 å¡«å……è§†é¢‘åŸå§‹æ•°æ®å¸§ av_image_fill_arrays(av_frame->data, av_frame->linesize, out_buffer, avcodec_context->pix_fmt, avcodec_context->width, avcodec_context->height, 1); // 10.4 åˆ›å»ºå‹ç¼©æ•°æ®å¸§æ•°æ® // ä½œç”¨ï¼šæ¥æ”¶å‹ç¼©æ•°æ®å¸§æ•°æ® AVPacket *av_packet = (AVPacket *) av_malloc(buffer_size); ç¬¬åä¸€æ­¥ï¼šå¾ªç¯è¯»å–è§†é¢‘åƒç´ æ•°æ® è§†é¢‘ç¼–ç è¯»å–è§†é¢‘åƒç´ æ•°æ®é—®é¢˜åˆ†æï¼Ÿ ç­”æ¡ˆå¦‚ä¸‹ï¼š æ¯”ä¾‹è§„èŒƒï¼šy : u : v = 4 : 1 : 1 ç„¶åè§„èŒƒï¼šy = widthï¼ˆè§†é¢‘å®½ï¼‰* heightï¼ˆé«˜ï¼‰ å‡è®¾ï¼šwidth = 100ï¼Œheight = 10 æ‰€ä»¥ï¼šy = width * height = 1000 æ‰€ä»¥ï¼šu = y / 4 = 1000 / 4 = 250ï¼Œv = y / 4 = 1000 / 4 = 250 ä¹Ÿå°±æ˜¯è¯´ï¼šä¸€å¸§yuvå¤§å° = 1500 ç¼–ç çš„æ—¶å€™è¯»å–ä¸€å¸§æ•°æ®ï¼šfread(out_buffer, 1, y_size * 3 / 2, in_file) y_size * 3 / 2 = 1000 * 3 / 2 = 1500 ä»£ç ï¼šav_frame->data[0] = out_buffer è§£é‡Šï¼šæŒ‡é’ˆæ˜¯ä»out_buffer = 0å¼€å§‹ï¼Œæ‰€ä»¥data[0]è¯»å–èŒƒå›´ï¼š0-1000 ä»£ç ï¼šav_frame->data[1] = out_buffer + y_size è§£é‡Šï¼šæŒ‡é’ˆæ˜¯ä»out_buffer + y_size = 0 + 1000 = 1000å¼€å§‹ï¼Œæ‰€ä»¥data[1]è¯»å–èŒƒå›´ï¼š1000-1250 ä»£ç ï¼šav_frame->data[2] = out_buffer + y_size * 5 / 4 è§£é‡Šï¼šæŒ‡é’ˆæ˜¯ä»out_buffer + y_size * 5 / 4 = 0 + 1000 * 5 / 4 = 1250å¼€å§‹ï¼Œæ‰€ä»¥data[2]è¯»å–èŒƒå›´ï¼š1250-1500 ä¸€å¸§æ•°æ®->å¤§å° = Yå¤§å° + Uå¤§å° + Vå¤§å° å‡è®¾ï¼šwidth = 100ï¼Œheight = 10 Yå¤§å°ï¼šy = width * height = 100 * 10 = 1000 Uå¤§å°ï¼šu = y / 4 = 1000 / 4 = 250 Vå¤§å°ï¼šv = y / 4 = 1000 / 4 = 250 ä¸€å¸§æ•°æ®å¤§å° = Y + U + V = 1500 è§†é¢‘è§£ç è®¡ç®—->æŒ‡é’ˆä½ç§»å¤„ç† ä¿å­˜Yå¤§å°ï¼š fwrite(avframe_yuv420p->data[0], 1, y_size, file_yuv420p); avframe_yuv420p->data[0]->è¡¨ç¤ºYå€¼ è¯»å–ï¼š0->1000 ä¿å­˜Uå¤§å° fwrite(avframe_yuv420p->data[1], 1, u_size, file_yuv420p); avframe_yuv420p->data[1]->è¡¨ç¤ºUå€¼ è¯»å–ï¼š1000->1250 ä¿å­˜Vå¤§å° fwrite(avframe_yuv420p->data[2], 1, v_size, file_yuv420p); avframe_yuv420p->data[2]->è¡¨ç¤ºVå€¼ è¯»å–ï¼š1250->1500 è§†é¢‘ç¼–ç è®¡ç®—->æŒ‡é’ˆä½ç§»è®¡ç®— åˆ†æè¯»å–æ•°æ®å¤§å°ï¼Ÿ y = 1000 æ•°æ®å¤§å° = ä¸€å¸§YUVæ•°æ® = Y + U + V = 1500 æ•°æ®å¤§å° = y * 3 / 2 = 1000 * 3 / 2 = 1500 ç°åœ¨æˆ‘ä»¬è§†é¢‘ç¼–ç æ ¹æ®Yå¤§å°ï¼Œæ±‚å‡ºYUVå¤§å°è®¡ç®—å…¬å¼ out_buffer = 1500ï¼ˆæ€»çš„æ•°æ®é‡ï¼‰ ä¿å­˜Yå¤§å° av_frame->data[0] = out_buffer; è¯»å–Yæ•°æ®->1000 è¯»å–ï¼š0->1000 ä¿å­˜Uå¤§å° av_frame->data[1] = out_buffer + y_size; è¯»å–Uæ•°æ®->250 è¯»å–ï¼š0 + 1000 -> 1250 ä¿å­˜Vå¤§å° av_frame->data[2] = out_buffer + y_size * 5 / 4; è¯»å–Væ•°æ®->250 è¯»å–ï¼š0 + 1000 * 5 / 4 = 1250->1500 è¯´ç™½äº†ï¼šé€šè¿‡Yå€¼å¾—åˆ°Vè¯»å–èµ·ç‚¹ä½ç½® // ç¬¬åä¸€æ­¥ï¼šå¾ªç¯è¯»å–è§†é¢‘åƒç´ æ•°æ® // ç¼–ç æ˜¯å¦æˆåŠŸ int result = 0; int current_frame_index = 1; int i = 0; // è®¡ç®—yçš„å¤§å° int y_size = avcodec_context->width * avcodec_context->height; while (true) { // ä»yuvæ–‡ä»¶é‡Œé¢è¯»å–ç¼“å†²åŒº // è¯»å–å¤§å°ï¼šy_size * 3 / 2 if (fread(out_buffer, 1, y_size * 3 / 2, in_file) data[0] = out_buffer; // Uå€¼ av_frame->data[1] = out_buffer + y_size; // Vå€¼ av_frame->data[2] = out_buffer + y_size * 5 / 4; // å¸§æ•° av_frame->pts = i; // æ³¨æ„æ—¶é—´æˆ³ i++; // ç¬¬åäºŒæ­¥ï¼šè§†é¢‘ç¼–ç å¤„ç† // ... current_frame_index++; } ç¬¬åäºŒæ­¥ï¼šè§†é¢‘ç¼–ç å¤„ç† ä»£ç ä½ç½®åœ¨ç¬¬åä¸€æ­¥ã€‚ // ç¬¬åäºŒæ­¥ï¼šè§†é¢‘ç¼–ç å¤„ç† // å‘é€ä¸€å¸§è§†é¢‘åƒç´ æ•°æ® avcodec_send_frame(avcodec_context, av_frame); // æ¥æ”¶ä¸€å¸§è§†é¢‘åƒç´ æ•°æ®ï¼Œç¼–ç ä¸ºè§†é¢‘å‹ç¼©æ•°æ®æ ¼å¼ result = avcodec_receive_packet(avcodec_context, av_packet); // åˆ¤å®šæ˜¯å¦ç¼–ç æˆåŠŸ if (result == 0) { // ç¼–ç æˆåŠŸ // ç¬¬åä¸‰æ­¥ï¼šå°†è§†é¢‘å‹ç¼©æ•°æ®å†™å…¥åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ // ... } else { __android_log_print(ANDROID_LOG_INFO, \"main\", \"ç¼–ç ç¬¬%då¸§å¤±è´¥2\", current_frame_index); // iOSä½¿ç”¨ // NSLog(@\"ç¼–ç ç¬¬%då¸§å¤±è´¥2\", current_frame_index); return; } ç¬¬åä¸‰æ­¥ï¼šå°†è§†é¢‘å‹ç¼©æ•°æ®å†™å…¥åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ ä»£ç ä½ç½®åœ¨ç¬¬åäºŒæ­¥ã€‚ // ç¬¬åä¸‰æ­¥ï¼šå°†è§†é¢‘å‹ç¼©æ•°æ®å†™å…¥åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ av_packet->stream_index = av_video_stream->index; result = av_write_frame(avformat_context, av_packet); current_frame_index++; // æ˜¯å¦è¾“å‡ºæˆåŠŸ if (result ç¬¬åå››æ­¥ï¼šå†™å…¥å‰©ä½™å¸§æ•°æ® // ç¬¬åå››æ­¥ï¼šå†™å…¥å‰©ä½™å¸§æ•°æ® // ä½œç”¨ï¼šè¾“å‡ºç¼–ç å™¨ä¸­å‰©ä½™AVPacketï¼Œå¯èƒ½æ²¡æœ‰ flush_encoder(avformat_context, 0); ç¬¬åäº”æ­¥ï¼šå†™å…¥æ–‡ä»¶å°¾éƒ¨ä¿¡æ¯ // ç¬¬åäº”æ­¥ï¼šå†™å…¥æ–‡ä»¶å°¾éƒ¨ä¿¡æ¯ av_write_trailer(avformat_context); ç¬¬åå…­æ­¥ï¼šé‡Šæ”¾å†…å­˜ï¼Œå…³é—­ç¼–ç å™¨ // ç¬¬åå…­æ­¥ï¼šé‡Šæ”¾å†…å­˜ï¼Œå…³é—­ç¼–ç å™¨ avcodec_close(avcodec_context); av_free(av_frame); av_free(out_buffer); av_packet_free(&av_packet); avio_close(avformat_context->pb); avformat_free_context(avformat_context); fclose(in_file); äºŒã€æ–°å»ºAndroidè§†é¢‘ç¼–ç å·¥ç¨‹ 1. æ–°å»ºå·¥ç¨‹ å‚è€ƒä¹‹å‰FFmpegé›†æˆï¼Œæ–°å»ºndkå·¥ç¨‹AndroidFFmpegEncodingVideoã€‚ 2. å®šä¹‰javaæ–¹æ³• å¯»æ‰¾MainActivityï¼šapp->src->main->java->MainActivityï¼Œå¢åŠ ä»£ç å¦‚ä¸‹ï¼š public native void ffmpegVideoEncode(String inFilePath, String outFilePath); public native void ffmepgDecodeVideo(String inFilePath, String outFilePath); 3. å®šä¹‰NDKæ–¹æ³• å¢åŠ androidæ‰“å°ã€‚ #include åœ¨native-lib.cppä¸­ï¼Œå¯¼å…¥FFmpegå¤´æ–‡ä»¶ã€‚ extern \"C\" { // å¼•å…¥å¤´æ–‡ä»¶ // æ ¸å¿ƒåº“->éŸ³è§†é¢‘ç¼–è§£ç åº“ #include // å°è£…æ ¼å¼å¤„ç†åº“ #include \"libavformat/avformat.h\" // å·¥å…·åº“ #include \"libavutil/imgutils.h\" // è§†é¢‘åƒç´ æ•°æ®æ ¼å¼åº“ #include \"libswscale/swscale.h\"} åœ¨native-lib.cppä¸­æ–°å¢javaæ–¹æ³•flush_encoderã€ffmepgVideoEncodeã€ffmepgDecodeVideoçš„C++å®ç°ï¼Œè¾“å…¥MainActivity.å°±ä¼šæœ‰ä»£ç æç¤ºï¼Œé€‰æ‹©æ­£ç¡®ffmepgVideoEncodeæ–¹æ³•è¡¥å…¨ä»£ç ã€‚ ffmepgDecodeVideoæ–¹æ³•å®ç°å‚è€ƒFFmpegè§†é¢‘è§£ç ã€‚ int flush_encoder(AVFormatContext *fmt_ctx, unsigned int stream_index) { int ret; int got_frame; AVPacket enc_pkt; if (!(fmt_ctx->streams[stream_index]->codec->codec->capabilities & CODEC_CAP_DELAY)) return 0; while (1) { enc_pkt.data = NULL; enc_pkt.size = 0; av_init_packet(&enc_pkt); ret = avcodec_encode_video2(fmt_ctx->streams[stream_index]->codec, &enc_pkt, NULL, &got_frame); av_frame_free(NULL); if (ret ä¸‰ã€æµ‹è¯•Androidè§†é¢‘ç¼–ç å·¥ç¨‹ å‡†å¤‡è§†é¢‘æ–‡ä»¶ï¼štest.mov åœ¨AndroidManifest.xmlå¢åŠ SDå¡çš„è¯»å†™æƒé™ã€‚ MainActivityå¢åŠ æµ‹è¯•ä»£ç ï¼Œè¿™é‡Œå…ˆè¿›è¡Œè§†é¢‘è§£ç ï¼Œç”Ÿæˆçš„.yuvæ–‡ä»¶åï¼Œç›´æ¥å¯¹.yuvæ–‡ä»¶å†è¿›è¡Œç¼–ç ã€‚ æ³¨æ„ï¼šå¦‚æœæ‰“å¼€å¤±è´¥ï¼Œå¯èƒ½è¯»å†™å­˜å‚¨è®¾å¤‡çš„æƒé™è¢«ç¦ç”¨ã€‚ æ‘©æ‰˜ç½—æ‹‰Â·åˆ€é”‹ï¼šè®¾ç½®->åº”ç”¨å’Œé€šçŸ¥->é«˜çº§->æƒé™ç®¡ç†å™¨->éšç§ç›¸å…³Â·è¯»å†™å­˜å‚¨è®¾å¤‡->æ‰¾åˆ°åº”ç”¨->å¦‚æœç¦ç”¨ï¼Œåˆ™ä¿®æ”¹ä¸ºå…è®¸ã€‚ import android.os.Environment; import java.io.File; import java.io.IOException; import android.util.Log; private void ffmpegVideoEncode() { String rootPath = Environment.getExternalStorageDirectory().getAbsolutePath(); String downloadPath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS).getAbsolutePath(); String inFilePath = downloadPath.concat(\"/test.yuv\"); String outFilePath = downloadPath.concat(\"/test.h264\"); // æ–‡ä»¶ä¸å­˜åœ¨æˆ‘åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ File file = new File(outFilePath); if (file.exists()) { Log.i(\"æ—¥å¿—ï¼š\",\"å­˜åœ¨\"); } else { try { file.createNewFile(); } catch (IOException e) { e.printStackTrace(); } } ffmpegVideoEncode(inFilePath, outFilePath); } private void ffmepgDecodeVideo() { String rootPath = Environment.getExternalStorageDirectory().getAbsolutePath(); String downloadPath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS).getAbsolutePath(); String inFilePath = downloadPath.concat(\"/test.mov\"); String outFilePath = downloadPath.concat(\"/test.yuv\"); // æ–‡ä»¶ä¸å­˜åœ¨æˆ‘åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ File file = new File(outFilePath); if (file.exists()){ Log.i(\"æ—¥å¿—ï¼š\",\"å­˜åœ¨\"); }else { try { file.createNewFile(); } catch (IOException e) { e.printStackTrace(); } } ffmepgDecodeVideo(inFilePath, outFilePath); } ffmepgDecodeVideo(); ffmpegVideoEncode(); runå·¥ç¨‹ä»£ç ï¼Œæ­£ç¡®æ‰“å°ï¼ŒåŒæ—¶æ­£ç¡®ç”Ÿæˆ.h264æ–‡ä»¶ã€‚ I/æ—¥å¿—ï¼š: å­˜åœ¨ I/main: è§£ç å™¨åç§°ï¼šh264 I/main: å½“å‰è§£ç ç¬¬1å¸§ . . . I/main: å½“å‰è§£ç ç¬¬600å¸§ I/æ—¥å¿—ï¼š: å­˜åœ¨ I/main: ç¼–ç å™¨åç§°ä¸ºï¼šlibx264 I/main: ç¼–ç ç¬¬1å¸§æˆåŠŸ . . . I/main: ç¼–ç ç¬¬598å¸§æˆåŠŸ è¯»å–å®Œæ¯•... h264æ–‡ä»¶æ’­æ”¾ï¼š ffplay test.h264 å››ã€æ–°å»ºiOSè§†é¢‘ç¼–ç å·¥ç¨‹ 1. æ–°å»ºå·¥ç¨‹ å‚è€ƒä¹‹å‰FFmpegé›†æˆï¼Œæ–°å»ºndkå·¥ç¨‹iOSFFmpegEncodingVideoã€‚ æ³¨æ„ï¼šå·¥ç¨‹ä½¿ç”¨çš„æ˜¯æ”¯æŒh264ç¼–ç çš„FFmpegåº“æ–‡ä»¶ã€‚ 2. å¯¼å…¥èµ„æºæ–‡ä»¶ èµ„æºæ–‡ä»¶å°±æ˜¯è§†é¢‘è§£ç åçš„.yuvæ–‡ä»¶ã€‚å…ˆå°†.yuvæ–‡ä»¶æ‹·è´è‡³å·¥ç¨‹ç›®å½•ä¸‹ï¼Œå†é€šè¿‡add filesçš„æ–¹å¼åŠ å…¥å·¥ç¨‹ã€‚ 3. å¯¼å…¥x264é™æ€åº“ åœ¨å·¥ç¨‹ç›®å½•æ–°å»ºx264ï¼Œæ‹·è´ç¼–è¯‘å¥½çš„thin-x264æ–‡ä»¶å¤¹è‡³x264ç›®å½•ï¼Œåªä¿ç•™arm64çš„æ–‡ä»¶å¤¹ï¼Œåˆ é™¤libæ–‡ä»¶å¤¹ä¸­çš„pkgconfigï¼Œå†é€šè¿‡add filesçš„æ–¹å¼åŠ å…¥å·¥ç¨‹ã€‚ é…ç½®x264å¤´æ–‡ä»¶ï¼Œå‚è€ƒFFmpegé›†æˆã€‚ 4. å¢åŠ è§†é¢‘ç¼–ç æ–¹æ³• (1) å¯¼å…¥FFmpegå¤´æ–‡ä»¶ ä¿®æ”¹FFmpegTest.hï¼Œæ–°å¢å¦‚ä¸‹ï¼š //æ ¸å¿ƒåº“ #include \"libavcodec/avcodec.h\" //å°è£…æ ¼å¼å¤„ç†åº“ #include \"libavformat/avformat.h\" //å·¥å…·åº“ #include \"libavutil/imgutils.h\" (2) æ–°å¢è§†é¢‘ç¼–ç æ–¹æ³• ä¿®æ”¹FFmpegTest.hï¼Œæ–°å¢å¦‚ä¸‹ï¼š /// FFmpegè§†é¢‘ç¼–ç  + (void)ffmpegVideoEncode:(NSString*)filePath outFilePath:(NSString*)outFilePath; ä¿®æ”¹FFmpegTest.mï¼Œæ–°å¢å¦‚ä¸‹ï¼š int flush_encoder(AVFormatContext *fmt_ctx, unsigned int stream_index) { int ret; int got_frame; AVPacket enc_pkt; if (!(fmt_ctx->streams[stream_index]->codec->codec->capabilities & CODEC_CAP_DELAY)) return 0; while (1) { enc_pkt.data = NULL; enc_pkt.size = 0; av_init_packet(&enc_pkt); ret = avcodec_encode_video2(fmt_ctx->streams[stream_index]->codec, &enc_pkt, NULL, &got_frame); av_frame_free(NULL); if (ret (3) å¢åŠ æ–¹æ³•æµ‹è¯• ä¿®æ”¹ViewController.mï¼Œæ–°å¢æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š NSString* inPath = [[NSBundle mainBundle] pathForResource:@\"test\" ofType:@\"yuv\"]; NSArray* paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES); NSString* path = [paths objectAtIndex:0]; NSString* tmpPath = [path stringByAppendingPathComponent:@\"temp\"]; [[NSFileManager defaultManager] createDirectoryAtPath:tmpPath withIntermediateDirectories:YES attributes:nil error:NULL]; NSString* outFilePath = [tmpPath stringByAppendingPathComponent:[NSString stringWithFormat:@\"test.h264\"]]; [FFmpegTest ffmpegVideoEncode:inPath outFilePath:outFilePath]; runå·¥ç¨‹ä»£ç ï¼Œæ­£ç¡®æ‰“å°ï¼ŒåŒæ—¶æ­£ç¡®ç”Ÿæˆ.h264æ–‡ä»¶ã€‚ iOSFFmpegEncodingVideo[828:210395] ç¼–ç å™¨åç§°ä¸ºï¼šlibx264 [libx264 @ 0x107021e00] using cpu capabilities: ARMv8 NEON [libx264 @ 0x107021e00] profile High, level 3.0 [h264 @ 0x10701c200] Using AVStream.codec.time_base as a timebase hint to the muxer is deprecated. Set AVStream.time_base instead. [h264 @ 0x10701c200] Using AVStream.codec to pass codec parameters to muxers is deprecated, use AVStream.codecpar instead. [libx264 @ 0x107021e00] AVFrame.format is not set [libx264 @ 0x107021e00] AVFrame.width or height is not set 2022-04-23 00:16:34.170713+0800 iOSFFmpegEncodingVideo[828:210395] ç¼–ç ç¬¬1å¸§æˆåŠŸ [libx264 @ 0x107021e00] AVFrame.format is not set [libx264 @ 0x107021e00] AVFrame.width or height is not set 2022-04-23 00:16:34.175975+0800 iOSFFmpegEncodingVideo[828:210395] ç¼–ç ç¬¬2å¸§æˆåŠŸ [libx264 @ 0x107021e00] AVFrame.format is not set [libx264 @ 0x107021e00] AVFrame.width or height is not set . . . 2022-04-23 00:16:39.831069+0800 iOSFFmpegEncodingVideo[828:210395] ç¼–ç ç¬¬598å¸§æˆåŠŸ 2022-04-23 00:16:39.831365+0800 iOSFFmpegEncodingVideo[828:210395] è¯»å–å®Œæ¯•... [libx264 @ 0x107021e00] frame I:3 Avg QP:24.64 size: 20162 [libx264 @ 0x107021e00] frame P:595 Avg QP:25.38 size: 2245 [libx264 @ 0x107021e00] mb I I16..4: 13.5% 50.9% 35.6% [libx264 @ 0x107021e00] mb P I16..4: 0.3% 0.5% 0.4% P16..4: 40.8% 12.2% 4.0% 0.0% 0.0% skip:41.7% [libx264 @ 0x107021e00] final ratefactor: 23.64 [libx264 @ 0x107021e00] 8x8 transform intra:43.8% inter:54.5% [libx264 @ 0x107021e00] coded y,uvDC,uvAC intra: 64.8% 75.5% 30.8% inter: 9.9% 13.2% 0.3% [libx264 @ 0x107021e00] i16 v,h,dc,p: 21% 21% 7% 52% [libx264 @ 0x107021e00] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 15% 13% 8% 8% 10% 11% 11% 10% 14% [libx264 @ 0x107021e00] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 17% 15% 8% 9% 10% 11% 11% 8% 11% [libx264 @ 0x107021e00] i8c dc,h,v,p: 46% 21% 24% 10% [libx264 @ 0x107021e00] Weighted P-Frames: Y:0.3% UV:0.2% [libx264 @ 0x107021e00] kb/s:466.92 "},"pages/FFmpeg/FFmpegéŸ³é¢‘ç¼–ç .html":{"url":"pages/FFmpeg/FFmpegéŸ³é¢‘ç¼–ç .html","title":"FFmpegéŸ³é¢‘ç¼–ç ","keywords":"","body":"FFmpegéŸ³é¢‘ç¼–ç  Androidä»£ç å·¥ç¨‹ iOSä»£ç å·¥ç¨‹ ä¸€ã€éŸ³é¢‘ç¼–ç æµç¨‹ ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ av_register_allï¼šä¾‹å¦‚ï¼šç¼–ç å™¨ã€è§£ç å™¨ç­‰ç­‰ã€‚ // ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ av_register_all(); ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–å°è£…æ ¼å¼ä¸Šä¸‹æ–‡ // ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–å°è£…æ ¼å¼ä¸Šä¸‹æ–‡ AVFormatContext *avformat_context = avformat_alloc_context(); const char *coutFilePath = env->GetStringUTFChars(out_file_path, NULL); // iOSä½¿ç”¨ // const char *coutFilePath = [outFilePath UTF8String]; AVOutputFormat *avoutput_format = av_guess_format(NULL, coutFilePath, NULL); // è®¾ç½®éŸ³é¢‘å‹ç¼©æ•°æ®æ ¼å¼ç±»å‹(aacã€mp3ç­‰ç­‰...) avformat_context->oformat = avoutput_format; ç¬¬ä¸‰æ­¥ï¼šæ‰“å¼€è¾“å‡ºæ–‡ä»¶ // ç¬¬ä¸‰æ­¥ï¼šæ‰“å¼€è¾“å‡ºæ–‡ä»¶ // å‚æ•°ä¸€ï¼šè¾“å‡ºæµ // å‚æ•°äºŒï¼šè¾“å‡ºæ–‡ä»¶ // å‚æ•°ä¸‰ï¼šæƒé™->è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ if (avio_open(&avformat_context->pb, coutFilePath, AVIO_FLAG_WRITE) ç¬¬å››æ­¥ï¼šåˆ›å»ºè¾“å‡ºç æµ // ç¬¬å››æ­¥ï¼šåˆ›å»ºè¾“å‡ºç æµ // æ³¨æ„ï¼šåˆ›å»ºäº†ä¸€å—å†…å­˜ç©ºé—´ï¼Œå¹¶ä¸çŸ¥é“ä»–æ˜¯ä»€ä¹ˆç±»å‹æµï¼Œå¸Œæœ›ä»–æ˜¯éŸ³é¢‘æµ AVStream *av_audio_stream = avformat_new_stream(avformat_context, NULL); ç¬¬äº”æ­¥ï¼šåˆå§‹åŒ–ç¼–ç å™¨ä¸Šä¸‹æ–‡ 1. è·å–ç¼–ç å™¨ä¸Šä¸‹æ–‡ // ç¬¬äº”æ­¥ï¼šåˆå§‹åŒ–ç¼–ç å™¨ä¸Šä¸‹æ–‡ // 5.1 è·å–ç¼–ç å™¨ä¸Šä¸‹æ–‡ AVCodecContext *avcodec_context = av_audio_stream->codec; 2. è®¾ç½®éŸ³é¢‘ç¼–ç å™¨ID // 5.2 è®¾ç½®éŸ³é¢‘ç¼–ç å™¨ID avcodec_context->codec_id = avoutput_format->audio_codec; runå·¥ç¨‹æ—¶ï¼Œè¿™ä¸€æ­¥å‡ºç°äº†é—®é¢˜ï¼š A/libc: Fatal signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x10 in tid 13086 (egencodingaudio), pid 13086 (egencodingaudio) å›°æŒ äº†å¥½å‡ ä¸ªå°æ—¶ï¼Œç»ˆäºæ‰¾åˆ°åŸå› äº†ï¼Œæˆ‘æŠŠç¼–ç éŸ³é¢‘çš„è¾“å‡ºæ–‡ä»¶åç¼€å†™æˆäº†accï¼Œå°†åç¼€æ”¹æˆaacå°±è§£å†³äº†ã€‚ // é”™è¯¯ String outFilePath = downloadPath.concat(\"/test.acc\"); // æ­£ç¡® String outFilePath = downloadPath.concat(\"/test.aac\"); 3. è®¾ç½®ä¸ºéŸ³é¢‘ç¼–ç å™¨ // 5.3 è®¾ç½®ä¸ºè§†é¢‘ç¼–ç å™¨ avcodec_context->codec_type = AVMEDIA_TYPE_AUDIO; 4. è®¾ç½®éŸ³é¢‘æ•°æ®æ ¼å¼ç­‰ // 5.4 è®¾ç½®åƒç´ æ•°æ®æ ¼å¼ // ç¼–ç çš„æ˜¯éŸ³é¢‘é‡‡æ ·æ•°æ®æ ¼å¼ï¼Œè§†é¢‘åƒç´ æ•°æ®æ ¼å¼ä¸ºPCM // æ³¨æ„ï¼šè¿™ä¸ªç±»å‹æ˜¯æ ¹æ®ä½ è§£ç çš„æ—¶å€™æŒ‡å®šçš„è§£ç çš„éŸ³é¢‘é‡‡æ ·æ•°æ®æ ¼å¼ç±»å‹ avcodec_context->sample_fmt = AV_SAMPLE_FMT_S16; // è®¾ç½®é‡‡æ ·ç‡ avcodec_context->sample_rate = 44100; // ç«‹ä½“å£° avcodec_context->channel_layout = AV_CH_LAYOUT_STEREO; // å£°é“æ•°é‡ int channels = av_get_channel_layout_nb_channels(avcodec_context->channel_layout); avcodec_context->channels = channels; // è®¾ç½®ç ç‡ // åŸºæœ¬çš„ç®—æ³•æ˜¯ï¼šã€ç ç‡ã€‘(kbps)=ã€è§†é¢‘å¤§å° - éŸ³é¢‘å¤§å°ã€‘(bitä½) /ã€æ—¶é—´ã€‘(ç§’) avcodec_context->bit_rate = 128000; ç¬¬å…­æ­¥ï¼šæŸ¥æ‰¾éŸ³é¢‘ç¼–ç å™¨ // ç¬¬å…­æ­¥ï¼šæŸ¥æ‰¾éŸ³é¢‘ç¼–ç å™¨ AVCodec *avcodec = avcodec_find_encoder(avcodec_context->codec_id); if (avcodec == NULL) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ‰¾ä¸åˆ°ç¼–ç å™¨\"); // iOSä½¿ç”¨ // NSLog(@\"æ‰¾ä¸åˆ°ç¼–ç å™¨\"); return; } __android_log_print(ANDROID_LOG_INFO, \"main\", \"ç¼–ç å™¨åç§°ä¸ºï¼š%s\", avcodec->name); // iOSä½¿ç”¨ // NSLog(@\"ç¼–ç å™¨åç§°ä¸ºï¼š%s\", avcodec->name); ç¬¬ä¸ƒæ­¥ï¼šæ‰“å¼€éŸ³é¢‘ç¼–ç å™¨ // ç¬¬ä¸ƒæ­¥ï¼šæ‰“å¼€éŸ³é¢‘ç¼–ç å™¨ // æ‰“å¼€ç¼–ç å™¨ if (avcodec_open2(avcodec_context, avcodec, NULL) 1. å‡ºç°é—®é¢˜ æ–°å»ºæµ‹è¯•å·¥ç¨‹ï¼ˆç¨åä¼šä»‹ç»å»ºå·¥ç¨‹æµ‹è¯•ï¼‰ï¼Œä»£ç è¿è¡Œåˆ°è¿™ä¸€æ­¥ä¼šå‡ºç°â€œæ‰“å¼€ç¼–ç å™¨å¤±è´¥â€ï¼Œå› ä¸ºè™½ç„¶æ‰¾åˆ°äº†aacç¼–ç å™¨ï¼Œä½†æ˜¯æ— æ³•æ‰“å¼€ã€‚ I/main: ç¼–ç å™¨åç§°ä¸ºï¼šaac I/main: æ‰“å¼€ç¼–ç å™¨å¤±è´¥ 2. æŸ¥æ‰¾åŸå›  ä¸‹é¢æˆ‘ä»¬é€šè¿‡æ‰“å°é”™è¯¯æ—¥å¿—å®šä½é”™è¯¯åŸå› ã€‚ ä¿®æ”¹MainActivity.javaï¼Œæ–°å¢æ–¹æ³•ï¼š private void createAVLogFile() { // String rootPath = Environment.getExternalStorageDirectory().getAbsolutePath(); String downloadPath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS).getAbsolutePath(); String logFilePath = downloadPath.concat(\"/av_log.txt\"); // æ–‡ä»¶ä¸å­˜åœ¨æˆ‘åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ File file = new File(logFilePath); if (file.exists()) { Log.i(\"æ—¥å¿—ï¼š\",\"å­˜åœ¨\"); } else { try { file.createNewFile(); } catch (IOException e) { e.printStackTrace(); } } } ä¿®æ”¹native-lib.cppï¼Œæ–°å¢æ–¹æ³•ï¼š // è¿™ä¸ªå‡½æ•°ä½œç”¨ï¼šç»Ÿè®¡ç¨‹åºæŠ¥é”™ä¿¡æ¯ï¼ŒFFmpegæŠ¥é”™ä¿¡æ¯æ‰“å°åˆ°av_logæ–‡ä»¶ä¸­ // æˆ‘ä»¬å°†av_logä¿å­˜åˆ°äº†sdcardï¼ˆå¤–éƒ¨å­˜å‚¨ï¼‰ // æˆ–è€…ä½ æ‰“å°åˆ°æ§åˆ¶å°ä¹Ÿå¯ä»¥ï¼Œè¿™é‡Œæˆ‘ä»¬å°†é”™è¯¯ä¿¡æ¯æ‰“å°åˆ°æ–‡ä»¶ä¸­ void custom_log(void *ptr, int level, const char* fmt, va_list vl) { __android_log_print(ANDROID_LOG_INFO, \"main\", fmt, vl); // ç”±äºæƒé™é—®é¢˜ï¼Œè¿˜æ˜¯æ— æ³•å°†æ—¥å¿—æ‰“å°è‡³sdcardï¼Œä¸´æ—¶è§£å†³æ–¹æ¡ˆå°±æ˜¯æ¯æ¬¡éƒ½å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„av_log.txtã€‚ FILE *fp=fopen(\"/storage/emulated/0/Download/av_log.txt\",\"a+\"); if(fp){ vfprintf(fp,fmt,vl); fflush(fp); fclose(fp); } } ä¿®æ”¹ç¬¬ä¸ƒæ­¥ï¼Œè¿™æ ·å°±å¯ä»¥æ‰“å°æ—¥å¿—è‡³av_log.txtã€‚ // ç¬¬ä¸ƒæ­¥ï¼šæ‰“å¼€éŸ³é¢‘ç¼–ç å™¨ // è®¾ç½®logé”™è¯¯ç›‘å¬å‡½æ•° av_log_set_callback(custom_log); // æ‰“å¼€ç¼–ç å™¨ if (avcodec_open2(avcodec_context, avcodec, NULL) runæµ‹è¯•å·¥ç¨‹ï¼ŒæŸ¥çœ‹av_log.txtï¼Œå‘ç°ç¼–ç å™¨æœ‰é—®é¢˜ï¼Œä¸æ”¯æŒs16ï¼ˆAV_SAMPLE_FMT_S16ï¼‰æ ¼å¼ã€‚ Specified sample format s16 is invalid or not supported 3. è§£å†³é—®é¢˜ é€šè¿‡åˆ†æï¼Œæˆ‘ä»¬å‘ç°ç¼–ç å™¨æœ‰é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ¢ä¸€ä¸ªç¼–ç å™¨ã€‚è€å¾—FFmpegæ¡†æ¶é‡Œé¢æ”¯æŒfaacæ ¼å¼ï¼Œæ–°çš„FFmpegæ¡†æ¶é‡Œé¢fdk_aacæ ¼å¼ã€‚ faacå’Œfdk_aacåŒºåˆ«ï¼šfdk_aacç¼–ç å‡ºæ¥éŸ³é¢‘è´¨é‡é«˜ï¼Œå ç”¨å†…å­˜å°‘ã€‚ è¿™é‡Œæˆ‘ä»¬éœ€è¦æ›´æ¢ç¼–ç å™¨ä¸ºlibfdk_aacï¼Œfdk_aacåŒæ—¶ä¹Ÿæ”¯æŒs16ï¼ˆAV_SAMPLE_FMT_S16ï¼‰æ ¼å¼ã€‚ (1) ä¸‹è½½æºç  fdk-aacã€‚ æˆ‘ä½¿ç”¨çš„æ˜¯fdk-aac-0.1.4.zipã€‚ æ³¨æ„ï¼šç¼–è¯‘0.1.5æ˜¯æœ‰é—®é¢˜ã€‚ (2) ä¸‹è½½ndk https://developer.android.google.cn/ndk/downloads/older_releases.html æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ndkr10eã€‚ åœ¨fdkaacæºç çš„åŒç›®å½•ä¸‹æ–°å»ºndkæ–‡ä»¶äº¤ï¼Œå°†ä¸‹è½½å¥½çš„ndkæ”¾å…¥ndkæ–‡ä»¶å¤¹ã€‚ (3) ç¼–è¯‘fdk-aac ç¼–è¯‘fdk-aacçš„.aé™æ€åº“ã€‚ android-build-fdkaac.shæ˜¯ç¼–è¯‘è„šæœ¬ï¼Œå°†ç¼–è¯‘è„šæœ¬æ”¾åœ¨å’Œæºç çš„åŒä¸€ç›®å½•ï¼Œæ‰§è¡Œï¼š sh android-build-fdkaac.sh æ‰§è¡Œè¿‡ç¨‹ä¼šæç¤ºå¼€æœºå¯†ç ï¼Œçœ‹åˆ°Android aac builds finishedè¯´æ˜ç¼–è¯‘æˆåŠŸã€‚ (4) ç¼–è¯‘FFmpeg ä¿®æ”¹Androidçš„FFmpegåŠ¨æ€åº“ç¼–è¯‘è„šæœ¬ï¼Œå°†fdkaacåº“å…¶ç¼–è¯‘è¿›å»ã€‚android-build-ffmpeg.shæ˜¯åŸæ¥çš„ç¼–è¯‘è„šæœ¬ï¼Œåœ¨åŸæ¥çš„ç¼–è¯‘è„šæœ¬./configureå¢åŠ å¦‚ä¸‹é€‰é¡¹ã€‚ # ä»¥ä¸‹æ˜¯ç¼–è¯‘fdkaacåº“å¢åŠ çš„ # ç¦ç”¨æ‰€æœ‰ç¼–ç å™¨ --disable-encoders \\ --enable-libfdk-aac \\ --enable-encoder=libfdk_aac \\ --enable-decoder=libfdk_aac \\ # å’ŒFFmpegåŠ¨æ€åº“ä¸€èµ·ç¼–è¯‘ï¼ŒæŒ‡å®šä½ ä¹‹å‰ç¼–è¯‘å¥½çš„fdkaacé™æ€åº“å’Œå¤´æ–‡ä»¶ --extra-cflags=\"-I/Users/chenchangqing/Documents/code/ffmpeg/07_ffmpeg_audio_encoding/android_build_fdkaac/include\" \\ --extra-ldflags=\"-L/Users/chenchangqing/Documents/code/ffmpeg/07_ffmpeg_audio_encoding/android_build_fdkaac/lib\" \\ android-build-ffmpeg-fdkaac.shæ˜¯ä¿®æ”¹åçš„è„šæœ¬ï¼Œå†æ¬¡ç¼–è¯‘FFmpegåº“ï¼Œé‡æ–°ç”Ÿæˆ.soåŠ¨æ€åº“ã€‚ é‡æ–°ç¼–è¯‘ï¼Œå‘ç°é”™è¯¯ï¼Œåˆ é™¤--enable-gpl \\ã€‚ libfdk_aac is incompatible with the gpl and --enable-nonfree is not specified. æŸ¥çœ‹ffmpeg-3.4/ffbuild/config.logé‡æ–°ç¼–è¯‘ï¼Œå‘ç°é”™è¯¯ï¼š /var/folders/vx/w486nkxn1dx05w199n5dl76m0000gn/T//ffconf.C7cXMk2x/test.o:test.c:function check_aacEncOpen: error: undefined reference to 'aacEncOpen' collect2: error: ld returned 1 exit status ERROR: libfdk_aac not found å“ˆå“ˆï¼Œæœ€åè§£å†³æ–¹æ¡ˆè¿˜æ˜¯è®©æˆ‘æ‰¾åˆ°äº†ï¼Œåˆè€—è´¹äº†å‡ ä¸ªå°æ—¶ï¼Œèµ„æ–™åœ¨è¿™macä¸‹ç¼–è¯‘androidä¸‹aac,ä¸æ„¿å­¤ç‹¬-Mac ä¸Šç”¨NDKç¼–è¯‘libåº“çš„é—®é¢˜ no archive symbol table (run ran lib)...ã€‚ è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œæ‰‹åŠ¨è°ƒç”¨$NDK_HOME/toolchains/arm-linux-androideabi-4.9/prebuilt/darwin-x86_64/bin/arm-linux-androideabi-runlibï¼Œå¯¹ç”Ÿæˆçš„.aè¿›è¡Œæ¥å£çš„å¯¼å‡ºã€‚ ./arm-linux-androideabi-runlib libfdk-aac.a ç»è¿‡è¿™ä¹ˆä¸€æ­¥ï¼Œå°±å¯ä»¥é¡ºåˆ©çš„æ‰§è¡Œæ”¯æŒfdk-aacçš„FFmpegè„šæœ¬ï¼ˆandroid-build-ffmpeg-fdkaac.shï¼‰äº†ã€‚ æ³¨æ„ï¼šè¿™é‡Œæœ‰ä¸ªç»†èŠ‚ï¼Œåœ¨fdk-aacç¼–è¯‘åçš„å®‰è£…ç›®å½•æ‰§è¡Œranlibå‘½ä»¤æ˜¯æ— æ•ˆçš„ï¼Œæ‰€ä»¥æˆ‘æ–°å»ºäº†android_build_fdkaac2æ–‡ä»¶å¤¹ï¼Œå°†libå’Œincludeæ–‡ä»¶å¤¹å¤åˆ¶è¿›æ¥ï¼Œåœ¨æ‰§è¡Œranlibå‘½ä»¤å°±å¯ä»¥äº†ï¼Œç¼–è¯‘ffmpegæ—¶æŒ‡å®šfdk-aacçš„ç›®å½•ä¸ºandroid_build_fdkaac2å³å¯ã€‚ 4. è§£å†³é—®é¢˜ï¼ˆiOSï¼‰ è¿™ä¸ªé—®é¢˜åœ¨iOSä¸Šä¹Ÿæ˜¯å­˜åœ¨çš„ï¼Œè¿™é‡Œä¹Ÿåˆ—å‡ºè§£å†³æ­¥éª¤ã€‚ (1) ä¸‹è½½æºç  fdk-aacã€‚ æˆ‘ä½¿ç”¨çš„æ˜¯fdk-aac-0.1.4.zipã€‚ æ³¨æ„ï¼šç¼–è¯‘0.1.5æ˜¯æœ‰é—®é¢˜ã€‚ (2) ç¼–è¯‘fdk-aac ios-build-fdkaac.shæ˜¯ç¼–è¯‘è„šæœ¬ï¼Œå°†ç¼–è¯‘è„šæœ¬æ”¾åœ¨å’Œæºç çš„åŒä¸€ç›®å½•ï¼Œæ‰§è¡Œï¼š sh ios-build-fdkaac.sh å‡ºç°é”™è¯¯ï¼š configure: error: source directory already configured; run \"make distclean\" there first make: *** No rule to make target `install'. Stop. æ ¹æ®æç¤ºï¼Œæ‰§è¡Œmake distcleanå¯ä»¥è§£å†³ã€‚ (3) ç¼–è¯‘FFmpeg ä¿®æ”¹iOSçš„FFmpegåº“ç¼–è¯‘è„šæœ¬ï¼Œå°†fdkaacåº“å…¶ç¼–è¯‘è¿›å»ã€‚ios-build-ffmpeg.shæ˜¯åŸæ¥çš„ç¼–è¯‘è„šæœ¬ï¼Œåœ¨åŸæ¥çš„ç¼–è¯‘è„šæœ¬./configureå¢åŠ å¦‚ä¸‹é€‰é¡¹ã€‚ # ä»¥ä¸‹æ˜¯ç¼–è¯‘fdkaacåº“å¢åŠ çš„ # ç¦ç”¨æ‰€æœ‰ç¼–ç å™¨ --disable-encoders \\ --enable-libfdk-aac \\ --enable-encoder=libfdk_aac \\ --enable-decoder=libfdk_aac \\ # å’ŒFFmpegåŠ¨æ€åº“ä¸€èµ·ç¼–è¯‘ï¼ŒæŒ‡å®šä½ ä¹‹å‰ç¼–è¯‘å¥½çš„fdkaacé™æ€åº“å’Œå¤´æ–‡ä»¶ --extra-cflags=\"-I/Users/chenchangqing/Documents/code/ffmpeg/07_ffmpeg_audio_encoding/ios_build_fdkaac/include\" \\ --extra-ldflags=\"-L/Users/chenchangqing/Documents/code/ffmpeg/07_ffmpeg_audio_encoding/ios_build_fdkaac/lib\" \\ ios-build-ffmpeg-fdkaac.shæ˜¯ä¿®æ”¹åçš„è„šæœ¬ï¼Œå†æ¬¡ç¼–è¯‘FFmpegåº“ï¼Œé‡æ–°ç”Ÿæˆ.aé™æ€åº“ã€‚ sh ios-build-ffmpeg-fdkaac.sh arm64 å‡ºç°ä¸‹é¢çš„é”™è¯¯ï¼Œé‡æ–°ä¸‹è½½FFmpegå°±å¯ä»¥è§£å†³äº†ã€‚ Out of tree builds are impossible with config.h in source dir. æ³¨æ„ï¼šè¿™é‡Œfdkaacå’Œffmpegéƒ½æŒ‡å®šäº†arm64çš„æ¶æ„ã€‚ 5. ä½¿ç”¨fdk-aacç¼–ç å™¨ // é”™è¯¯ // AVCodec *avcodec = avcodec_find_encoder(avcodec_context->codec_id); // æ­£ç¡® AVCodec *avcodec = avcodec_find_encoder_by_name(\"libfdk_aac\"); runå·¥ç¨‹ï¼Œæ­£å¸¸æ‰“å¼€ç¼–ç å™¨ã€‚ I/main: ç¼–ç å™¨åç§°ä¸ºï¼šlibfdk_aac ç¬¬å…«æ­¥ï¼šå†™å…¥æ–‡ä»¶å¤´ä¿¡æ¯ // ç¬¬å…«æ­¥ï¼šå†™å…¥æ–‡ä»¶å¤´ä¿¡æ¯ avformat_write_header(avformat_context, NULL); ç¬¬ä¹æ­¥ï¼šæ‰“å¼€pcmæ–‡ä»¶ // ç¬¬ä¹æ­¥ï¼šæ‰“å¼€pcmæ–‡ä»¶ // é‡åˆ°é—®é¢˜ï¼šfopen Permission denied const char *cinFilePath = env->GetStringUTFChars(in_file_path, NULL); // iOSä½¿ç”¨ // const char *cinFilePath = [inFilePath UTF8String]; int errNum = 0; FILE *in_file = fopen(cinFilePath, \"rb\"); if (in_file == NULL) { errNum = errno; __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ–‡ä»¶ä¸å­˜åœ¨:%s,in_file:%s,errNum:%d,reason:%s\", cinFilePath, in_file, errNum, strerror(errNum)); // iOSä½¿ç”¨ // NSLog(@\"æ–‡ä»¶ä¸å­˜åœ¨\"); return; } è¿™ä¸€æ­¥æœ‰å‘ï¼Œæ‰“å¼€pcmæ–‡ä»¶ï¼ˆfopenï¼‰ä¸€ç›´å‡ºç°â€œPermission deniedâ€é”™è¯¯ï¼Œå›°æ‰°äº†æœ‰ä¸€å¤©ï¼Œæœ€åè¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°å¾ˆå¥½çš„åŠæ³•ï¼Œä½†æ˜¯æœ‰ä¸ªä¸´æ—¶è§£å†³åŠæ³•ï¼Œå°±æ˜¯å…ˆæ‰§è¡ŒéŸ³é¢‘è§£ç ä¸º.pcmæ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å»æ‰“å¼€ï¼ˆfopenï¼‰åˆšç”Ÿæˆçš„.pcmæ–‡ä»¶ï¼Œæ˜¯å¯ä»¥æˆåŠŸçš„ã€‚ ç¬¬åæ­¥ï¼šéŸ³é¢‘ç¼–ç å‡†å¤‡ // ç¬¬åæ­¥ï¼šéŸ³é¢‘ç¼–ç å‡†å¤‡ // 10.1 åˆ›å»ºéŸ³é¢‘åŸå§‹æ•°æ®å¸§ // ä½œç”¨ï¼šå­˜å‚¨éŸ³é¢‘åŸå§‹æ•°æ®å¸§ AVFrame *av_frame = av_frame_alloc(); av_frame->nb_samples = avcodec_context->frame_size; av_frame->format = avcodec_context->sample_fmt; // 10.2 åˆ›å»ºä¸€ä¸ªç¼“å†²åŒº // ä½œç”¨ï¼šç”¨äºç¼“å­˜è¯»å–éŸ³é¢‘æ•°æ® // å…ˆè·å–ç¼“å†²åŒºå¤§å° int buffer_size = av_samples_get_buffer_size(NULL, avcodec_context->channels, avcodec_context->frame_size, avcodec_context->sample_fmt, 1); // åˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼Œä½œç”¨æ˜¯ç¼“å­˜ä¸€å¸§éŸ³é¢‘åƒç´ æ•°æ® uint8_t *out_buffer = (uint8_t *) av_malloc(buffer_size); // 10.3 å¡«å……éŸ³é¢‘åŸå§‹æ•°æ®å¸§ avcodec_fill_audio_frame(av_frame, avcodec_context->channels, avcodec_context->sample_fmt, (const uint8_t *)out_buffer, buffer_size, 1); // 10.4 åˆ›å»ºå‹ç¼©æ•°æ®å¸§æ•°æ® // ä½œç”¨ï¼šæ¥æ”¶å‹ç¼©æ•°æ®å¸§æ•°æ® AVPacket *av_packet = (AVPacket *) av_malloc(buffer_size); ç¬¬åä¸€æ­¥ï¼šå¾ªç¯è¯»å–è§†é¢‘åƒç´ æ•°æ® // ç¬¬åä¸€æ­¥ï¼šå¾ªç¯è¯»å–éŸ³é¢‘æ•°æ® // ç¼–ç æ˜¯å¦æˆåŠŸ int result = 0; int current_frame_index = 1; int i = 0; while (true) { // ä»pcmæ–‡ä»¶é‡Œé¢è¯»å–ç¼“å†²åŒº if (fread(out_buffer, 1, buffer_size, in_file) data[0] = out_buffer; av_frame->pts = i; // æ³¨æ„æ—¶é—´æˆ³ i++; // ç¬¬åäºŒæ­¥ï¼šéŸ³é¢‘ç¼–ç å¤„ç† // ... current_frame_index++; } ç¬¬åäºŒæ­¥ï¼šéŸ³é¢‘ç¼–ç å¤„ç† ä»£ç ä½ç½®åœ¨ç¬¬åä¸€æ­¥ã€‚ // ç¬¬åäºŒæ­¥ï¼šéŸ³é¢‘ç¼–ç å¤„ç† // å‘é€ä¸€å¸§éŸ³é¢‘æ•°æ® avcodec_send_frame(avcodec_context, av_frame); if (result != 0) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"Failed to send frame!\"); // iOSä½¿ç”¨ // NSLog(@\"Failed to send frame!\", current_frame_index); return; } // æ¥æ”¶ä¸€å¸§éŸ³é¢‘æ•°æ®ï¼Œç¼–ç ä¸ºéŸ³é¢‘å‹ç¼©æ•°æ®æ ¼å¼ result = avcodec_receive_packet(avcodec_context, av_packet); // åˆ¤å®šæ˜¯å¦ç¼–ç æˆåŠŸ if (result == 0) { // ç¼–ç æˆåŠŸ // ç¬¬åä¸‰æ­¥ï¼šå°†éŸ³é¢‘å‹ç¼©æ•°æ®å†™å…¥åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ // ... } else { __android_log_print(ANDROID_LOG_INFO, \"main\", \"ç¼–ç ç¬¬%då¸§å¤±è´¥2\", current_frame_index); // iOSä½¿ç”¨ // NSLog(@\"ç¼–ç ç¬¬%då¸§å¤±è´¥2\", current_frame_index); return; } ç¬¬åä¸‰æ­¥ï¼šå°†éŸ³é¢‘å‹ç¼©æ•°æ®å†™å…¥åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ ä»£ç ä½ç½®åœ¨ç¬¬åäºŒæ­¥ã€‚ // ç¬¬åä¸‰æ­¥ï¼šå°†éŸ³é¢‘å‹ç¼©æ•°æ®å†™å…¥åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ av_packet->stream_index = av_audio_stream->index; result = av_write_frame(avformat_context, av_packet); // æ˜¯å¦è¾“å‡ºæˆåŠŸ if (result ç¬¬åå››æ­¥ï¼šå†™å…¥å‰©ä½™å¸§æ•°æ® å¢åŠ flush_encoderæ–¹æ³•ï¼š int flush_encoder(AVFormatContext *fmt_ctx, unsigned int stream_index) { int ret; int got_frame; AVPacket enc_pkt; if (!(fmt_ctx->streams[stream_index]->codec->codec->capabilities & CODEC_CAP_DELAY)) return 0; while (1) { enc_pkt.data = NULL; enc_pkt.size = 0; av_init_packet(&enc_pkt); ret = avcodec_encode_audio2(fmt_ctx->streams[stream_index]->codec, &enc_pkt, NULL, &got_frame); av_frame_free(NULL); if (ret è°ƒç”¨flush_encoderæ–¹æ³•ï¼š // ç¬¬åå››æ­¥ï¼šå†™å…¥å‰©ä½™å¸§æ•°æ® // ä½œç”¨ï¼šè¾“å‡ºç¼–ç å™¨ä¸­å‰©ä½™AVPacketï¼Œå¯èƒ½æ²¡æœ‰ result = flush_encoder(avformat_context, 0); if (result ç¬¬åäº”æ­¥ï¼šå†™å…¥æ–‡ä»¶å°¾éƒ¨ä¿¡æ¯ // ç¬¬åäº”æ­¥ï¼šå†™å…¥æ–‡ä»¶å°¾éƒ¨ä¿¡æ¯ av_write_trailer(avformat_context); ç¬¬åå…­æ­¥ï¼šé‡Šæ”¾å†…å­˜ï¼Œå…³é—­ç¼–ç å™¨ // ç¬¬åå…­æ­¥ï¼šé‡Šæ”¾å†…å­˜ï¼Œå…³é—­ç¼–ç å™¨ avcodec_close(avcodec_context); av_free(av_frame); av_free(out_buffer); av_packet_free(&av_packet); avio_close(avformat_context->pb); avformat_free_context(avformat_context); fclose(in_file); äºŒã€æ–°å»ºAndroidéŸ³é¢‘ç¼–ç å·¥ç¨‹ 1. æ–°å»ºå·¥ç¨‹ å‚è€ƒä¹‹å‰FFmpegé›†æˆï¼Œæ–°å»ºndkå·¥ç¨‹AndroidFFmpegEncodingAudioã€‚ 2. å®šä¹‰javaæ–¹æ³• å¯»æ‰¾MainActivityï¼šapp->src->main->java->MainActivityï¼Œå¢åŠ ä»£ç å¦‚ä¸‹ï¼š public native void ffmpegDecodeAudio(String inFilePath, String outFilePath); public native void ffmpegEncodeAudio(String inFilePath, String outFilePath); 3. å®šä¹‰NDKæ–¹æ³• å¢åŠ androidæ‰“å°ã€‚ #include åœ¨native-lib.cppä¸­ï¼Œå¯¼å…¥FFmpegå¤´æ–‡ä»¶ã€‚ extern \"C\" { // å¼•å…¥å¤´æ–‡ä»¶ // æ ¸å¿ƒåº“->éŸ³è§†é¢‘ç¼–è§£ç åº“ #include // å°è£…æ ¼å¼å¤„ç†åº“ #include \"libavformat/avformat.h\" // å·¥å…·åº“ #include \"libavutil/imgutils.h\" // éŸ³é¢‘é‡‡æ ·æ•°æ®æ ¼å¼åº“ #include \"libswresample/swresample.h\" } åœ¨native-lib.cppä¸­æ–°å¢javaæ–¹æ³•flush_encoderã€ffmpegDecodeAudioã€ffmpegEncodeVideoçš„C++å®ç°ï¼Œè¾“å…¥MainActivity.å°±ä¼šæœ‰ä»£ç æç¤ºï¼Œé€‰æ‹©æ­£ç¡®ffmepgEncodeAudioæ–¹æ³•è¡¥å…¨ä»£ç ã€‚ ffmpegDecodeAudioæ–¹æ³•å®ç°å‚è€ƒFFmpegè§†é¢‘è§£ç ã€‚ extern \"C\" JNIEXPORT void JNICALL Java_com_ccq_androidffmpegencodingaudio_MainActivity_ffmpegEncodeAudio(JNIEnv *env, jobject thiz, jstring in_file_path, jstring out_file_path) { // è¿™é‡Œæ‹·è´ä¸Šé¢çš„éŸ³é¢‘ç¼–ç æµç¨‹çš„ä»£ç å³å¯ã€‚ } extern \"C\" JNIEXPORT void JNICALL Java_com_ccq_androidffmpegencodingaudio_MainActivity_ffmpegDecodeAudio(JNIEnv *env, jobject thiz, jstring in_file_path, jstring out_file_path) { } ä¸‰ã€æµ‹è¯•AndroidéŸ³é¢‘ç¼–ç å·¥ç¨‹ å‡†å¤‡è§†é¢‘æ–‡ä»¶ï¼štest.mov åœ¨AndroidManifest.xmlå¢åŠ SDå¡çš„è¯»å†™æƒé™ã€‚ MainActivityå¢åŠ æµ‹è¯•ä»£ç ï¼Œè¿™é‡Œå…ˆè¿›è¡Œè§†é¢‘è§£ç ï¼Œç”Ÿæˆçš„.pcmæ–‡ä»¶åï¼Œç›´æ¥å¯¹.pcmæ–‡ä»¶å†è¿›è¡Œç¼–ç ã€‚ æ³¨æ„ï¼šå¦‚æœæ‰“å¼€å¤±è´¥ï¼Œå¯èƒ½è¯»å†™å­˜å‚¨è®¾å¤‡çš„æƒé™è¢«ç¦ç”¨ã€‚ æ‘©æ‰˜ç½—æ‹‰Â·åˆ€é”‹ï¼šè®¾ç½®->åº”ç”¨å’Œé€šçŸ¥->é«˜çº§->æƒé™ç®¡ç†å™¨->éšç§ç›¸å…³Â·è¯»å†™å­˜å‚¨è®¾å¤‡->æ‰¾åˆ°åº”ç”¨->å¦‚æœç¦ç”¨ï¼Œåˆ™ä¿®æ”¹ä¸ºå…è®¸ã€‚ import android.os.Environment; import java.io.File; import java.io.IOException; import android.util.Log; private void ffmpegEncodeAudio() { // String rootPath = Environment.getExternalStorageDirectory().getAbsolutePath(); String downloadPath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS).getAbsolutePath(); String inFilePath = downloadPath.concat(\"/test.pcm\"); // é”™è¯¯ï¼Œä¼šå¯¼è‡´ç¨‹åºå´©æºƒ // String outFilePath = downloadPath.concat(\"/test.aac\"); // æ­£ç¡® String outFilePath = downloadPath.concat(\"/test.aac\"); // æ–‡ä»¶ä¸å­˜åœ¨æˆ‘åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ File file = new File(outFilePath); if (file.exists()) { Log.i(\"æ—¥å¿—ï¼š\",\"å­˜åœ¨\"); } else { try { file.createNewFile(); } catch (IOException e) { e.printStackTrace(); } } ffmpegEncodeAudio(inFilePath, outFilePath); } private void createAVLogFile() { // String rootPath = Environment.getExternalStorageDirectory().getAbsolutePath(); String downloadPath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS).getAbsolutePath(); String logFilePath = downloadPath.concat(\"/av_log.txt\"); // æ–‡ä»¶ä¸å­˜åœ¨æˆ‘åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ File file = new File(logFilePath); if (file.exists()) { Log.i(\"æ—¥å¿—ï¼š\",\"å­˜åœ¨\"); } else { try { file.createNewFile(); } catch (IOException e) { e.printStackTrace(); } } } private void ffmepgDecodeAudio() { // String rootPath = Environment.getExternalStorageDirectory().getAbsolutePath(); String downloadPath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS).getAbsolutePath(); String inFilePath = downloadPath.concat(\"/test.mov\"); String outFilePath = downloadPath.concat(\"/test.pcm\"); // æ–‡ä»¶ä¸å­˜åœ¨æˆ‘åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ File file = new File(outFilePath); if (file.exists()) { Log.i(\"æ—¥å¿—ï¼š\",\"å­˜åœ¨\"); } else { try { file.createNewFile(); } catch (IOException e) { e.printStackTrace(); } } ffmpegDecodeAudio(inFilePath, outFilePath); } ffmepgDecodeAudio(); createAVLogFile(); ffmpegEncodeAudio(); runå·¥ç¨‹ä»£ç ï¼Œæ­£ç¡®æ‰“å°ï¼ŒåŒæ—¶æ­£ç¡®ç”Ÿæˆ.h264æ–‡ä»¶ã€‚ I/æ—¥å¿—ï¼š: å­˜åœ¨ I/main: è§£ç å™¨åç§°ï¼šaac I/main: å½“å‰è§£ç ç¬¬1å¸§ . . . I/main: å½“å‰è§£ç ç¬¬1036å¸§ I/æ—¥å¿—ï¼š: å­˜åœ¨ I/main: ç¼–ç å™¨åç§°ä¸ºï¼šlibfdk_aac I/main: Using AVStream.codec.time_base as a timebase hint to the muxer is deprecated. Set AVStream.time_base instead. I/main: Using AVStream.codec to pass codec parameters to muxers is deprecated, use AVStream.codecpar instead. I/main: ç¼–ç ç¬¬1å¸§æˆåŠŸ . . . I/main: ç¼–ç ç¬¬1035å¸§æˆåŠŸ è¯»å–å®Œæ¯•... I/main: Flush Encoder: Succeed to encode 1 frame! size: 363 I/main: Flush Encoder: Succeed to encode 1 frame! size: 95 I/main: Statistics: -2770196 seeks, -498852848 writeouts aacæ–‡ä»¶æ’­æ”¾ï¼š ffplay test.aac å››ã€æ–°å»ºiOSè§†é¢‘ç¼–ç å·¥ç¨‹ 1. æ–°å»ºå·¥ç¨‹ å‚è€ƒä¹‹å‰FFmpegé›†æˆï¼Œæ–°å»ºndkå·¥ç¨‹iOSFFmpegEncodingAudioã€‚ æ³¨æ„ï¼šå·¥ç¨‹ä½¿ç”¨çš„æ˜¯æ”¯æŒfdkaccç¼–ç çš„FFmpegåº“æ–‡ä»¶ã€‚ 2. å¯¼å…¥èµ„æºæ–‡ä»¶ èµ„æºæ–‡ä»¶å°±æ˜¯éŸ³é¢‘è§£ç åçš„.pcmæ–‡ä»¶ã€‚å…ˆå°†.pcmæ–‡ä»¶æ‹·è´è‡³å·¥ç¨‹ç›®å½•ä¸‹ï¼Œå†é€šè¿‡add filesçš„æ–¹å¼åŠ å…¥å·¥ç¨‹ã€‚ 3. å¯¼å…¥fdkaccé™æ€åº“ åœ¨å·¥ç¨‹ç›®å½•æ–°å»ºfdk-aacï¼Œæ‹·è´ç¼–è¯‘å¥½çš„ios_build_fdkaac/thinæ–‡ä»¶å¤¹è‡³fdkaac-0.1.4ç›®å½•ï¼Œåªä¿ç•™arm64çš„æ–‡ä»¶å¤¹ï¼Œåˆ é™¤libæ–‡ä»¶å¤¹ä¸­çš„pkgconfigå’Œlibfdk-aac.laï¼Œå†é€šè¿‡add filesçš„æ–¹å¼åŠ å…¥å·¥ç¨‹ã€‚ é…ç½®fdkaacå¤´æ–‡ä»¶ï¼Œå‚è€ƒFFmpegé›†æˆã€‚ 4. å¢åŠ éŸ³ç¼–ç æ–¹æ³• (1) å¯¼å…¥FFmpegå¤´æ–‡ä»¶ ä¿®æ”¹FFmpegTest.hï¼Œæ–°å¢å¦‚ä¸‹ï¼š //æ ¸å¿ƒåº“ #include \"libavcodec/avcodec.h\" //å°è£…æ ¼å¼å¤„ç†åº“ #include \"libavformat/avformat.h\" //å·¥å…·åº“ #include \"libavutil/imgutils.h\" #include \"libswresample/swresample.h\" (2) æ–°å¢éŸ³é¢‘ç¼–ç æ–¹æ³• ä¿®æ”¹FFmpegTest.hï¼Œæ–°å¢å¦‚ä¸‹ï¼š /// FFmpegéŸ³é¢‘ç¼–ç  + (void)ffmpegAudioEncode: (NSString *)inFilePath outFilePath: (NSString *)outFilePath; ä¿®æ”¹FFmpegTest.mï¼Œæ–°å¢å¦‚ä¸‹ï¼š + (void)ffmpegAudioEncode: (NSString *)inFilePath outFilePath: (NSString *)outFilePath { // ä»£ç å¤åˆ¶éŸ³é¢‘ç¼–ç æµç¨‹ä¸­çš„ä»£ç  // å°†å¤‡æ³¨`iOSä½¿ç”¨`çš„ä»£ç æ‰“å¼€ } (3) å¢åŠ æ–¹æ³•æµ‹è¯• ä¿®æ”¹ViewController.mï¼Œæ–°å¢æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š NSString* inPath = [[NSBundle mainBundle] pathForResource:@\"test\" ofType:@\"pcm\"]; NSArray* paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES); NSString* path = [paths objectAtIndex:0]; NSString* tmpPath = [path stringByAppendingPathComponent:@\"temp\"]; [[NSFileManager defaultManager] createDirectoryAtPath:tmpPath withIntermediateDirectories:YES attributes:nil error:NULL]; NSString* outFilePath = [tmpPath stringByAppendingPathComponent:[NSString stringWithFormat:@\"test.aac\"]]; [FFmpegTest ffmpegAudioEncode:inPath outFilePath:outFilePath]; runå·¥ç¨‹ä»£ç ï¼Œæ­£ç¡®æ‰“å°ï¼ŒåŒæ—¶æ­£ç¡®ç”Ÿæˆ.aacæ–‡ä»¶ã€‚ "},"pages/FFmpeg/SDLæ’­æ”¾YUV.html":{"url":"pages/FFmpeg/SDLæ’­æ”¾YUV.html","title":"SDLæ’­æ”¾YUV","keywords":"","body":"SDLæ’­æ”¾YUV Androidä»£ç å·¥ç¨‹ Macä»£ç å·¥ç¨‹ iOSä»£ç å·¥ç¨‹ ä¸€ã€SDLæ’­æ”¾æµç¨‹ ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ–SDLå¤šåª’ä½“æ¡†æ¶ // ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ–SDLå¤šåª’ä½“æ¡†æ¶ if (SDL_Init( SDL_INIT_VIDEO | SDL_INIT_AUDIO | SDL_INIT_TIMER ) == -1) { LOG_I_ARGS(\"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); return -1; } ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–SDLçª—å£ // ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–SDLçª—å£ // å‚æ•°ä¸€ï¼šçª—å£åç§° // å‚æ•°äºŒï¼šçª—å£åœ¨å±å¹•ä¸Šçš„xåæ ‡ // å‚æ•°ä¸‰ï¼šçª—å£åœ¨å±å¹•ä¸Šçš„yåæ ‡ // å‚æ•°å››ï¼šçª—å£åœ¨å±å¹•ä¸Šå®½ // å‚æ•°äº”ï¼šçª—å£åœ¨å±å¹•ä¸Šé«˜ // å‚æ•°å…­ï¼šçª—å£çŠ¶æ€(æ‰“å¼€) int width = 640; int height = 352; SDL_Window* sdl_window = SDL_CreateWindow(\"SDLæ’­æ”¾YUVè§†é¢‘\", SDL_WINDOWPOS_CENTERED, SDL_WINDOWPOS_CENTERED, width, height, SDL_WINDOW_OPENGL); if (sdl_window == NULL) { LOG_I_ARGS(\"çª—å£åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çª—å£åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºæ¸²æŸ“å™¨->æ¸²æŸ“çª—å£ // ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºæ¸²æŸ“å™¨->æ¸²æŸ“çª—å£ // å‚æ•°ä¸€ï¼šæ¸²æŸ“ç›®æ ‡åˆ›å»º->ç›®æ ‡ // å‚æ•°äºŒï¼šä»é‚£é‡Œå¼€å§‹æ¸²æŸ“(-1:è¡¨ç¤ºä»ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹) // å‚æ•°ä¸‰ï¼šæ¸²æŸ“ç±»å‹(è½¯ä»¶æ¸²æŸ“) SDL_Renderer* sdl_renderer = SDL_CreateRenderer(sdl_window, -1, 0); if (sdl_renderer == NULL) { LOG_I_ARGS(\"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } ç¬¬å››æ­¥ï¼šåˆ›å»ºçº¹ç† // ç¬¬å››æ­¥ï¼šåˆ›å»ºçº¹ç† // å‚æ•°ä¸€ï¼šçº¹ç†->ç›®æ ‡æ¸²æŸ“å™¨ // å‚æ•°äºŒï¼šæ¸²æŸ“æ ¼å¼->YUVæ ¼å¼->åƒç´ æ•°æ®æ ¼å¼(è§†é¢‘)æˆ–è€…æ˜¯éŸ³é¢‘é‡‡æ ·æ•°æ®æ ¼å¼(éŸ³é¢‘) // å‚æ•°ä¸‰ï¼šç»˜åˆ¶æ–¹å¼->é¢‘ç¹ç»˜åˆ¶->SDL_TEXTUREACCESS_STREAMING // å‚æ•°å››ï¼šçº¹ç†å®½ // å‚æ•°äº”ï¼šçº¹ç†é«˜ SDL_Texture* sdl_texture = SDL_CreateTexture(sdl_renderer, SDL_PIXELFORMAT_IYUV, SDL_TEXTUREACCESS_STREAMING, width, height); if (sdl_texture == NULL) { LOG_I_ARGS(\"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } ç¬¬äº”æ­¥ï¼šæ‰“å¼€yuvæ–‡ä»¶ // ç¬¬äº”æ­¥ï¼šæ‰“å¼€yuvæ–‡ä»¶ int errNum = 0; FILE* yuv_file = fopen(\"/storage/emulated/0/Download/test.yuv\", \"rb\"); // MACä½¿ç”¨ // FILE* yuv_file = fopen(\"/Users/chenchangqing/Documents/code/ffmpeg/resources/test.yuv\", \"rb\"); // iOS // NSString* inPath = [[NSBundle mainBundle] pathForResource:@\"test\" ofType:@\"yuv\"]; // FILE* yuv_file = fopen([inPath UTF8String], \"rb\"); if (yuv_file == NULL) { errNum = errno; LOG_I_ARGS(\"æ‰“å¼€æ–‡ä»¶å¤±è´¥ï¼šerrNum:%d,reason:%s\", errNum, strerror(errNum)); // Macä½¿ç”¨ // printf(\"æ‰“å¼€æ–‡ä»¶å¤±è´¥ï¼šerrNum:%d,reason:%s\", errNum, strerror(errNum)); // é€€å‡ºç¨‹åº SDL_Quit(); return 0; } ç¬¬å…­æ­¥ï¼šå¾ªç¯è¯»å–yuvè§†é¢‘åƒç´ æ•°æ®å¸§ // ç¬¬å…­æ­¥ï¼šå¾ªç¯è¯»å–yuvè§†é¢‘åƒç´ æ•°æ®å¸§ int y_size = width * height; // å®šä¹‰ç¼“å†²åŒº(å†…å­˜ç©ºé—´å¼€è¾Ÿå¤šå¤§?) // ç¼“å­˜ä¸€å¸§è§†é¢‘åƒç´ æ•°æ® = Y + U + V // Y:U:V = 4 : 1 : 1 // å‡è®¾ï¼šY = 1.0 U = 0.25 V = 0.25 // å®½åº¦ï¼šY + U + V = 1.5 // æ¢ç®—ï¼šY + U + V = width * height * 1.5 char buffer_pix[y_size * 3 / 2]; // å®šä¹‰æ¸²æŸ“å™¨åŒºåŸŸ SDL_Rect sdl_rect; int currentIndex = 1; while (true) { // ä¸€å¸§ä¸€å¸§è¯»å– fread(buffer_pix, 1, y_size * 3 / 2, yuv_file); // åˆ¤å®šæ˜¯å¦è¯»å–å®Œæ¯• if (feof(yuv_file)){ break; } // ç¬¬ä¸ƒæ­¥ï¼šè®¾ç½®çº¹ç†æ•°æ® // ... // ç¬¬å…«æ­¥ï¼šå°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // ... // ç¬¬ä¹æ­¥ï¼šå‘ˆç°ç”»é¢å¸§ // ... // ç¬¬åæ­¥ï¼šæ¸²æŸ“æ¯ä¸€å¸§ç›´æ¥é—´éš”æ—¶é—´ // ... printf(\"å½“å‰åˆ°äº†ç¬¬%då¸§\\n\", currentIndex); currentIndex++; } ç¬¬ä¸ƒæ­¥ï¼šè®¾ç½®çº¹ç†æ•°æ® // ç¬¬ä¸ƒæ­¥ï¼šè®¾ç½®çº¹ç†æ•°æ® // å‚æ•°ä¸€ï¼šçº¹ç† // å‚æ•°äºŒï¼šæ¸²æŸ“åŒºåŸŸ // å‚æ•°ä¸‰ï¼šéœ€è¦æ¸²æŸ“æ•°æ®->è§†é¢‘åƒç´ æ•°æ®å¸§ // å‚æ•°å››ï¼šå¸§å®½ SDL_UpdateTexture(sdl_texture, NULL, buffer_pix, width); ç¬¬å…«æ­¥ï¼šå°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // ç¬¬å…«æ­¥ï¼šå°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // è®¾ç½®å·¦ä¸Šè§’ä½ç½®(å…¨å±) sdl_rect.x = 100; sdl_rect.y = 100; sdl_rect.w = width; sdl_rect.h = height; SDL_RenderClear(sdl_renderer); SDL_RenderCopy(sdl_renderer, sdl_texture, NULL, &sdl_rect); ç¬¬ä¹æ­¥ï¼šå‘ˆç°ç”»é¢å¸§ // ç¬¬ä¹æ­¥ï¼šå‘ˆç°ç”»é¢å¸§ SDL_RenderPresent(sdl_renderer); ç¬¬åæ­¥ï¼šæ¸²æŸ“æ¯ä¸€å¸§ç›´æ¥é—´éš”æ—¶é—´ // ç¬¬åæ­¥ï¼šæ¸²æŸ“æ¯ä¸€å¸§ç›´æ¥é—´éš”æ—¶é—´ SDL_Delay(30); ç¬¬åä¸€æ­¥ï¼šé‡Šæ”¾èµ„æº // ç¬¬åä¸€æ­¥ï¼šé‡Šæ”¾èµ„æº fclose(yuv_file); SDL_DestroyTexture(sdl_texture); SDL_DestroyRenderer(sdl_renderer); ç¬¬åäºŒæ­¥ï¼šé€€å‡ºç¨‹åº // ç¬¬åäºŒæ­¥ï¼šé€€å‡ºç¨‹åº SDL_Quit(); äºŒã€Androidç¼–è¯‘SDL 1. ä¸‹è½½å·¥å…·åŒ… (1) SDL http://www.libsdl.org/release/SDL2-2.0.5.tar.gz /Users/chenchangqing/Documents/code/ffmpeg/08_ffmpeg_sdl/SDL2-2.0.5 æ³¨æ„ï¼šç”±äºæœ€æ–°çš„SDLç¼–è¯‘åä½¿ç”¨é‡åˆ°æ— æ³•æ˜¾ç¤ºè§†é¢‘çš„é—®é¢˜ï¼Œè¿™é‡Œä½¿ç”¨SDL2-2.0.5ã€‚ é—®é¢˜ï¼šeglSwapBuffersWithDamageKHRImpl:1402 error 300d (EGL_BAD_SURFACE) (2) NDK https://dl.google.com/android/repository/android-ndk-r10e-darwin-x86_64.zip /Users/chenchangqing/Documents/code/ffmpeg/resources/ndk/android-ndk-r10e (3) SDK https://dl.google.com/android/adt/adt-bundle-linux-x86_64-20140702.zip /Users/chenchangqing/Documents/code/ffmpeg/resources/sdk/adt-bundle-linux-x86_64-20140702 (3) ANT https://dlcdn.apache.org//ant/binaries/apache-ant-1.10.12-bin.tar.gz /Users/chenchangqing/Documents/code/ffmpeg/resources/ant/apache-ant-1.10.12 2. ä¿®æ”¹androidbuild.sh æŸ¥çœ‹SDL2-2.0.5/docs/README-android.mdå¾—çŸ¥åˆ†åˆ«éœ€è¦é…ç½®NDKã€SDKã€ANTï¼Œå¹¶ä¸”å¦‚æœç¼–è¯‘APKæ–‡ä»¶éœ€è¦javaç¯å¢ƒï¼Œè¿™é‡Œæˆ‘ä»¬æš‚æ—¶ä¸éœ€è¦ç¼–è¯‘APKï¼Œå¿½ç•¥javaç¯å¢ƒå³å¯ã€‚androidbuild.shæ–‡ä»¶åœ¨SDL-2.0.5/build-scriptsã€‚ æ³¨æ„ï¼šæœ€æ–°ç‰ˆï¼ˆç›®å‰2.0.20ï¼‰æ˜¯ä¸éœ€è¦ä¿®æ”¹androidbuild.shçš„ï¼Œä½†æ˜¯éœ€è¦é…ç½®SDKã€NDKçš„ç¯å¢ƒå˜é‡ã€‚ (1) é…ç½®NDK # NDKBUILD=`which ndk-build` NDKBUILD=\"/Users/chenchangqing/Documents/code/ffmpeg/resources/ndk/android-ndk-r10e/ndk-build\" (2) é…ç½®SDK # ANDROID=`which android` ANDROID=\"/Users/chenchangqing/Documents/code/ffmpeg/resources/sdk/adt-bundle-linux-x86_64-20140702/sdk\" (3) é…ç½®ANT # ANT=`which ant` ANT=\"/Users/chenchangqing/Documents/code/ffmpeg/resources/ant/apache-ant-1.10.12/bin/ant\" 3. è¿è¡Œè„šæœ¬ ./androidbuild.sh org.libsdl.testgles ../test/testgles.c è„šæœ¬æ‰§è¡Œå®Œæ¯•ï¼Œåˆ†åˆ«ç”Ÿæˆäº†armeabiã€armeabi-v7aã€x86çš„.soåŠ¨æ€åº“ï¼ŒSDL2-2.0.5/build/org.libsdl.testgles/libsæ˜¯åŠ¨æ€åº“çš„è·¯å¾„ã€‚ æ³¨æ„ï¼šæœ€æ–°ç‰ˆï¼ˆç›®å‰2.0.20ï¼‰è„šæœ¬æ‰§è¡Œå®Œæ¯•ç”Ÿæˆçš„æ˜¯ä¸€ä¸ªAndroidå·¥ç¨‹ï¼Œç¼–è¯‘åç”ŸæˆåŠ¨æ€åº“æ–‡ä»¶ï¼Œæš‚æ—¶æ²¡ç ”ç©¶å¥½åŠ¨æ€åº“æ–‡ä»¶çš„è·¯å¾„åœ¨å“ªé‡Œã€‚ ä¸‰ã€Androidé›†æˆSDL ç¬¬ä¸€æ­¥ï¼šæ–°å»ºå·¥ç¨‹ File->NewProject->Native C++->è¾“å…¥å·¥ç¨‹ä¿¡æ¯->Next->Finishã€‚ å·¥ç¨‹åç§°ï¼šAndroidSDLPlayYUVã€‚ ç¬¬äºŒæ­¥ï¼šå¯¼å…¥åº“æ–‡ä»¶ã€‚ 1. æ–°å»ºjniLibsæ–‡ä»¶å¤¹ é¡¹ç›®é€‰ä¸­Projectæ¨¡å¼->app->src->main->å³é”®new->Directory->è¾“å…¥jniLibs->enterã€‚ åŒæ ·çš„æ–¹å¼åœ¨jniLibsä¸‹å¿ƒé—´libæ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾.soåº“æ–‡ä»¶ã€‚ 2. æ‹·è´æ–‡ä»¶è‡³jniLibs æ‹·è´SDL2-2.0.5/build/org.libsdl.testgles/libs/armeabi-v7a/libSDL2.soè‡³jniLibs/libã€‚ æ‹·è´SDL2-2.0.5/srcè‡³jniLibsã€‚ æ‹·è´SDL2-2.0.5/includeè‡³jniLibsã€‚ ç¬¬ä¸‰æ­¥ï¼šé…ç½®SDLåº“ ä¿®æ”¹CMakeLists.txtã€‚ 1. è®¾ç½®jniLibs # 1. è®¾ç½®jniLibs set(JNILIBS_DIR ${CMAKE_SOURCE_DIR}/../jniLibs) 2. SDLæ ¸å¿ƒåº“ # 2. SDLæ ¸å¿ƒåº“ add_library( SDL2 SHARED IMPORTED) set_target_properties( SDL2 PROPERTIES IMPORTED_LOCATION ${JNILIBS_DIR}/lib/libSDL2.so) 3. é…ç½®SDL_android_main.c ä¿®æ”¹androidsdlplayyuvä¸ºSDL2mainï¼Œå¢åŠ ${JNILIBS_DIR}/src/main/android/SDL_android_main.cã€‚ androidsdlplayyuvä¸ºå·¥ç¨‹åç§°ã€‚ # 3. é…ç½®SDL_android_main.c add_library( # Sets the name of the library. SDL2main # Sets the library as a shared library. SHARED # Provides a relative path to your source file(s). ${JNILIBS_DIR}/src/main/android/SDL_android_main.c native-lib.cpp) 4. é“¾æ¥SDL2mianå’ŒSDL2åº“ ä¿®æ”¹androidsdlplayyuvä¸ºSDL2mainï¼Œå¢åŠ SDL2ã€‚ androidsdlplayyuvä¸ºå·¥ç¨‹åç§°ã€‚ # 4. é“¾æ¥SDL2mianå’ŒSDL2åº“ target_link_libraries( # Specifies the target library. SDL2main SDL2 # Links the target library to the log library # included in the NDK. ${log-lib}) æ³¨æ„1ï¼š3ï¼Œ4æ­¥å®Œæˆåï¼Œç„¶åé©¬ä¸Šç¼–è¯‘ï¼Œä¼šå‡ºç°error: undefined reference to 'SDL_main'é”™è¯¯ï¼Œæ˜¯å› ä¸ºnative-lib.cppè¿˜æ²¡å†™mainå‡½æ•°ï¼Œè¿™é‡Œå…ˆå¿½ç•¥ã€‚æ³¨æ„2: androidsdlplayyuvåº“å·²ç»æ”¹æˆäº†SDL2mainï¼ŒMainActivity.javaçš„loadLibraryä¹Ÿåº”è¯¥æ”¹ä¸‹åç§°ã€‚ 5. SDLå¤´æ–‡ä»¶å’Œæºç  # 5. SDLå¤´æ–‡ä»¶å’Œæºç  include_directories(${JNILIBS_DIR}/src) include_directories(${JNILIBS_DIR}/include) ç¬¬å››æ­¥ï¼šé…ç½®CPUæ¶æ„ç±»å‹ ä¿®æ”¹app->build.gradleï¼ŒdefaultConfigå¢åŠ ndké…ç½®ã€‚ ndk { abiFilters 'armeabi-v7a' } ç¬¬äº”æ­¥ï¼šä¿®æ”¹native-lib.cpp å¼•å…¥å¤´æ–‡ä»¶ï¼Œå¢åŠ SDLå…¥å£ï¼Œæ–°å¢mainå‡½æ•°ï¼Œå®ç°SDLæ’­æ”¾YUVã€‚ #include #include #include \"SDL.h\" #define LOG_I_ARGS(FORMAT,...) __android_log_print(ANDROID_LOG_INFO,\"main\",FORMAT,__VA_ARGS__); #define LOG_I(FORMAT) LOG_I_ARGS(FORMAT,0); // SDLå…¥å£ extern \"C\" int main(int argc, char *argv[]) { // SDLæ’­æ”¾YUVå®ç° // æ‹·è´SDLæ’­æ”¾æµç¨‹çš„ä»£ç  return 0; } ç¬¬å…­æ­¥ï¼šå¢åŠ æ’­æ”¾ç•Œé¢ æ‹·è´SDL2-2.0.5/build/org.libsdl.testgles/src/orgè‡³javaã€‚ ä¿®æ”¹SDLActivity.javaï¼ŒåŸæ¥ protected String[] getLibraries() { return new String[] { \"SDL2\", // \"SDL2_image\", // \"SDL2_mixer\", // \"SDL2_net\", // \"SDL2_ttf\", \"main\" }; } ä¿®æ”¹ä¸º protected String[] getLibraries() { return new String[] { \"SDL2\", // \"SDL2_image\", // \"SDL2_mixer\", // \"SDL2_net\", // \"SDL2_ttf\", \"SDL2main\"// è¿™é‡Œçš„åå­—æ˜¯ä¸Šä¸€æ­¥é€šè¿‡add_libraryé…ç½®å¥½çš„ã€‚ }; } ç¬¬ä¸ƒæ­¥ï¼šä¿®æ”¹AndroidManifest.xml åœ¨AndroidManifest.xmlä¸­å£°æ˜MANAGE_EXTERNAL_STORAGEæƒé™ã€‚ ç¬¬å…«æ­¥ï¼šå¢åŠ æ’­æ”¾æŒ‰é’® æ‰“å¼€main->res->layout->activity_main.xmlï¼Œç‚¹å‡»å³ä¸Šè§’çš„Codeï¼Œå°†åŸæ¥çš„Textæ”¹ä¸ºç°åœ¨çš„Buttonã€‚ ç¬¬ä¹æ­¥ï¼šä¿®æ”¹MainActivity.java è¿™æ˜¯æœ€åä¸€æ­¥ï¼Œå®Œæˆè¿™ä¸€æ­¥ï¼Œè¿è¡Œå·¥ç¨‹ç‚¹å‡»æ’­æ”¾æŒ‰é’®å°±å¯ä»¥ç›´æ¥æ’­æ”¾äº†ã€‚ æ³¨æ„ï¼šåœ¨/storage/emulated/0/Downloadæ–‡ä»¶å¤¹ä¸‹æ”¾test.yuvã€‚ // ä¿®æ”¹1ï¼šå¢åŠ import import android.view.View; import android.content.Intent; import org.libsdl.app.SDLActivity; import android.widget.Toast; import android.os.Build; import android.provider.Settings; import android.os.Environment; public class MainActivity extends AppCompatActivity { // Used to load the 'androidsdlplayyuv' library on application startup. static { // ä¿®æ”¹2ï¼šandroidsdlplayyuvæ”¹ä¸ºSDL2main System.loadLibrary(\"SDL2main\"); } private ActivityMainBinding binding; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); binding = ActivityMainBinding.inflate(getLayoutInflater()); setContentView(binding.getRoot()); // ä¿®æ”¹3ï¼šæ³¨é‡ŠTextViewï¼Œå¢åŠ checkPermission // Example of a call to a native method // TextView tv = binding.sampleText; // tv.setText(stringFromJNI()); checkPermission(); } /** * ä¿®æ”¹4ï¼šæ–°å¢checkPermissionæ–¹æ³• * æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶çš„æƒé™ */ public void checkPermission() { if (Build.VERSION.SDK_INT å››ã€Macé›†æˆSDL ç¬¬ä¸€æ­¥ï¼šé…ç½®SDLå¼€å‘ç¯å¢ƒ 1. ä¸‹è½½SDL2.dmg https://www.libsdl.org/release/SDL2-2.0.5.dmg ä¸‹è½½å¥½äº†ï¼Œç‚¹å‡»å®‰è£…ï¼Œä¼šå¾—åˆ°SDL2.frameworkã€‚ ä¸ºäº†é¿å…ä¸å¿…è¦çš„éº»çƒ¦ï¼Œè¿™é‡Œæˆ‘ä»¬ä¾ç„¶ä½¿ç”¨2.0.5çš„ç‰ˆæœ¬ã€‚ 2. å®‰è£…SDL2 å°†SDL2.Frameworkæ‹·è´åˆ°/Library/Frameworksç›®å½•ä¸‹ã€‚ ç¬¬äºŒæ­¥ï¼šæ–°å»ºMacå·¥ç¨‹ æ–°å»ºå‘½ä»¤è¡Œé¡¹ç›®ï¼šNew->Project->macOS->Command Line Toolï¼Œé¡¹ç›®åç§°MacSDLPlayYUVã€‚ ç¬¬ä¸‰æ­¥ï¼šå¯¼å…¥SDLåº“ åœ¨å·¥ç¨‹ç›®å½•æ–°å»ºSDLFrameworkï¼Œå°†SDL2.Frameworkæ‹·è´åˆ°SDLFrameworkï¼Œé€šè¿‡Addçš„æ–¹å¼åŠ å…¥å·¥ç¨‹ã€‚ ç¬¬å››æ­¥ï¼šä¿®æ”¹main.m å¼•å…¥SDLå¤´æ–‡ä»¶ï¼Œåœ¨mainå‡½æ•°æ‹·è´â€œSDLæ’­æ”¾æµç¨‹â€çš„ä»£ç å³å¯ã€‚ æ³¨æ„ï¼šæ‰“å°æ—¥å¿—çš„æ–¹å¼éœ€è¦ä¿®æ”¹ä¸ºMacçš„æ–¹å¼ã€‚ #import #include // å¼•å…¥SDLå¤´æ–‡ä»¶ #include // SDLå…¥å£ int main(int argc, const char * argv[]) { // SDLæ’­æ”¾YUVå®ç° // ... return 0; } äº”ã€iOSé›†æˆSDL ç¬¬ä¸€æ­¥ï¼šç¼–è¯‘.aé™æ€åº“ 1. ä¸‹è½½SDLæºç  http://www.libsdl.org/release/SDL2-2.0.5.tar.gz /Users/chenchangqing/Documents/code/ffmpeg/08_ffmpeg_sdl/SDL2-2.0.5 2. ç¼–è¯‘SDLé™æ€åº“ æ‰“å¼€SDL2-2.0.5/Xcode-iOS/SDLå·¥ç¨‹ï¼Œé€‰æ‹©libSDLç›®æ ‡ï¼Œå†é€‰æ‹©Any iOS DeviceçœŸæœºç¼–è¯‘ï¼Œç¼–è¯‘å®Œæˆåå¯ä»¥åœ¨å·¥ç¨‹çš„Productsçœ‹åˆ°libSDL2.aç”±çº¢è‰²å˜ä¸ºäº†ç™½è‰²ï¼Œè¯´æ˜é™æ€åº“å·²ç»ç¼–è¯‘å¥½äº†ï¼Œå³é”®show in Finderè·å–ç”Ÿæˆå¥½çš„é™æ€åº“ã€‚ æ³¨æ„ï¼šå¦‚æœç¼–è¯‘å¤±è´¥ï¼Œå¯èƒ½æ˜¯iOSç¼–è¯‘ç‰ˆæœ¬ä¸æ”¯æŒï¼Œä¿®æ”¹SDLçš„iOS Deployment Targetä¸º9.0å³å¯ï¼Œé»˜è®¤æ˜¯5.1.1ã€‚ ç¬¬äºŒæ­¥ï¼šæ–°å»ºiOSå·¥ç¨‹ åˆ é™¤Scenedelegateï¼Œå‚è€ƒï¼šXcode 11æ–°å»ºé¡¹ç›®å¤šäº†Scenedelegateã€‚ å·¥ç¨‹åç§°ä¸ºiOSSDLPlayYUVã€‚ ç¬¬ä¸‰æ­¥ï¼šå¯¼å…¥åº“æ–‡ä»¶ã€‚ åœ¨å·¥ç¨‹ç›®å½•æ–°å»ºSDLFrameworkï¼Œæ‹·è´libSDL2.aã€SDL2-2.0.5/includeè‡³SDLFrameworkï¼Œæœ€åå°†SDLFrameworkè¿›å…¥å·¥ç¨‹ã€‚ ç¬¬å››æ­¥ï¼šæ·»åŠ ä¾èµ–åº“ CoreGraphics.framework AudioToolbox.framework AVFoundation.framework CoreAudio.framework OpenGLES.framework CoreMotion.framework GameController.framework ç¬¬äº”æ­¥ï¼šé…ç½®å¤´æ–‡ä»¶ 1. å¤åˆ¶å¤´æ–‡ä»¶è·¯å¾„ é€‰ä¸­Target>Build Setting>æœç´¢Library Search>åŒå‡»Library Search Pathså¤åˆ¶SDLFrameworkè·¯å¾„>è¿½åŠ /includeå°±æ˜¯SDLå¤´æ–‡ä»¶è·¯å¾„ï¼š $(PROJECT_DIR)/iOSSDLPlayYUV/SDLFramework/include 2. é…ç½®å¤´æ–‡ä»¶è·¯å¾„ é€‰ä¸­Target>Build Setting>æœç´¢Header Search>é€‰ä¸­Header Search Paths>å¢åŠ ä¸Šé¢å¤åˆ¶å¥½å¤´æ–‡ä»¶è·¯å¾„ã€‚ ç¬¬å…­æ­¥ï¼šä¿®æ”¹main.m å¼•å…¥SDLå¤´æ–‡ä»¶ï¼Œåœ¨mainå‡½æ•°æ‹·è´â€œSDLæ’­æ”¾æµç¨‹â€çš„ä»£ç å³å¯ã€‚ æ³¨æ„ï¼šæ‰“å°æ—¥å¿—çš„æ–¹å¼éœ€è¦ä¿®æ”¹ä¸ºiOSçš„æ–¹å¼ï¼Œéœ€è¦æ£€æŸ¥ä¸‹yuvçš„è·¯å¾„ã€‚ç›®å‰æ’­æ”¾è¿˜æ˜¯é»‘å±ï¼Œå¾…è§£å†³ã€‚ #import #include // å¼•å…¥SDLå¤´æ–‡ä»¶ #include \"SDL.h\" // SDLå…¥å£ int main(int argc, char * argv[]) { // SDLæ’­æ”¾YUVå®ç° // æ‹·è´SDLæ’­æ”¾æµç¨‹çš„ä»£ç  return 0; } "},"pages/FFmpeg/iOSé›†æˆSDL.html":{"url":"pages/FFmpeg/iOSé›†æˆSDL.html","title":"iOSé›†æˆSDL","keywords":"","body":"iOSé›†æˆSDL ä»£ç å·¥ç¨‹ ä¸‹è½½SDLæºç  SDL2-2.0.5ä¸‹è½½è„šæœ¬ï¼šdownload-sdl.shã€‚ sh download-sdl.sh ç¼–è¯‘SDL æ‰“å¼€SDL2-2.0.5/Xcode-iOS/SDLå·¥ç¨‹ï¼Œé€‰æ‹©libSDLç›®æ ‡ï¼Œå†é€‰æ‹©Any iOS DeviceçœŸæœºç¼–è¯‘ï¼Œç¼–è¯‘å®Œæˆåå¯ä»¥åœ¨å·¥ç¨‹çš„Productsçœ‹åˆ°libSDL2.aç”±çº¢è‰²å˜ä¸ºäº†ç™½è‰²ï¼Œè¯´æ˜é™æ€åº“å·²ç»ç¼–è¯‘å¥½äº†ï¼Œå³é”®show in Finderè·å–ç”Ÿæˆå¥½çš„é™æ€åº“ã€‚ iOSæ–‡æ¡£ä½ç½®ï¼šæºç /docs/README-ios.mdã€‚ æ–°å»ºå·¥ç¨‹ åˆ é™¤Scenedelegateï¼Œå‚è€ƒï¼šXcode 11æ–°å»ºé¡¹ç›®å¤šäº†Scenedelegateã€‚ å¯¼å…¥åº“æ–‡ä»¶ åœ¨å·¥ç¨‹ç›®å½•æ–°å»ºSDL2-2.0.5/libï¼Œæ‹·è´å·²ç»ç¼–è¯‘å¥½çš„libSDL2.aè‡³SDL2-2.0.5/libï¼Œç»§ç»­æ‹·è´SDL2-2.0.5/includeè‡³SDL2-2.0.5ï¼Œæœ€åå°†SDL2-2.0.5é€šè¿‡Add FilesåŠ å…¥å·¥ç¨‹ã€‚ é…ç½®å¤´æ–‡ä»¶ 1) å¤åˆ¶å¤´æ–‡ä»¶è·¯å¾„ é€‰ä¸­Target>Build Setting>æœç´¢Library Search>åŒå‡»Library Search Pathså¤åˆ¶SDL libè·¯å¾„>ä¿®æ”¹libä¸ºincludeå°±æ˜¯SDLå¤´æ–‡ä»¶è·¯å¾„ï¼š $(PROJECT_DIR)/iOSIntegrationWithSDLï¼ˆå·¥ç¨‹åï¼‰/SDL2-2.0.5/include 2) é…ç½®å¤´æ–‡ä»¶è·¯å¾„ é€‰ä¸­Target>Build Setting>æœç´¢Header Search>é€‰ä¸­Header Search Paths>å¢åŠ ä¸Šé¢å¤åˆ¶å¥½å¤´æ–‡ä»¶è·¯å¾„ã€‚ æ·»åŠ ä¾èµ–åº“ AudioToolbox.framework AVFoundation.framework CoreAudio.framework CoreGraphics.framework CoreMotion.framework Foundation.framework GameController.framework OpenGLES.framework QuartzCore.framework UIKit.framework æ·»åŠ å®Œæ¯•ï¼Œç¼–è¯‘æˆåŠŸã€‚ ç®€å•æµ‹è¯• åœ¨main.mä¸­å¼•å…¥SDLå¤´æ–‡ä»¶ï¼Œç¼–è¯‘ï¼Œç¼–è¯‘æˆåŠŸå°±å¯ä»¥ä½¿ç”¨SDLå¼€å‘äº†ã€‚ import \"SDL.h\" "},"pages/FFmpeg/iOSé›†æˆSDL_æºç .html":{"url":"pages/FFmpeg/iOSé›†æˆSDL_æºç .html","title":"iOSé›†æˆSDLï¼ˆæºç ï¼‰","keywords":"","body":"iOSé›†æˆSDLï¼ˆæºç ï¼‰ ä»£ç å·¥ç¨‹ ä¸‹è½½SDLæºç  SDL2-2.0.5ä¸‹è½½è„šæœ¬ï¼šdownload-sdl.shã€‚ sh download-sdl.sh iOSæ–‡æ¡£ä½ç½®ï¼šæºç /docs/README-ios.mdã€‚ æ–°å»ºå·¥ç¨‹ åˆ é™¤Scenedelegateï¼Œå‚è€ƒï¼šXcode 11æ–°å»ºé¡¹ç›®å¤šäº†Scenedelegateã€‚ å¯¼å…¥SDLå·¥ç¨‹ 1ï¼‰å°†SDL2-2.0.5/Xcode-iOS/SDL/SDL.xcodeprojå·¥ç¨‹é€šè¿‡Add FilesåŠ å…¥å·¥ç¨‹ã€‚ 2ï¼‰é€‰ä¸­Target->Build Phases->Link Binary With Libraries->ç‚¹å‡»+å¢åŠ libSDL2.aã€‚ 3ï¼‰é€‰ä¸­Target>Build Setting>æœç´¢Header Search>é€‰ä¸­User Header Search Paths>æºç includeç›¸å¯¹ä½ç½®ï¼ˆä¾‹ï¼š../SDL2-2.0.5/includeï¼‰ã€‚ æ·»åŠ ä¾èµ–åº“ AudioToolbox.framework AVFoundation.framework CoreAudio.framework CoreGraphics.framework CoreMotion.framework Foundation.framework GameController.framework OpenGLES.framework QuartzCore.framework UIKit.framework æ·»åŠ å®Œæ¯•ï¼Œç¼–è¯‘æˆåŠŸã€‚ ç®€å•æµ‹è¯• åœ¨main.mä¸­å¼•å…¥SDLå¤´æ–‡ä»¶ï¼Œç¼–è¯‘ï¼Œç¼–è¯‘æˆåŠŸå°±å¯ä»¥ä½¿ç”¨SDLå¼€å‘äº†ã€‚ import \"SDL.h\" é‡åˆ°é—®é¢˜ 1ï¼‰SDLå·¥ç¨‹ç¼–è¯‘ï¼ŒGCDeviceæŠ¥é”™ è§£å†³ï¼šé€‰ä¸­SDLçš„PROJECT->iOS Deployment Target->ä¿®æ”¹ä¸º9.0ï¼ˆæºç é‡Œçš„å¥½åƒæ˜¯5.1ï¼‰ã€‚ GCDeviceç¼–è¯‘é”™è¯¯ 2ï¼‰å¼•å…¥SDL.håæ— æ³•ç¼–è¯‘ è§£å†³ï¼šUser Header Search Pathsé…ç½®çš„SDLå¤´æ–‡ä»¶ä½ç½®é”™è¯¯ï¼Œä¿®æ”¹æ­£ç¡®å³å¯ã€‚ "},"pages/FFmpeg/FFmpeg_SDLæ’­æ”¾è§†é¢‘.html":{"url":"pages/FFmpeg/FFmpeg_SDLæ’­æ”¾è§†é¢‘.html","title":"FFmpeg+SDLæ’­æ”¾è§†é¢‘","keywords":"","body":"FFmpeg+SDLæ’­æ”¾è§†é¢‘ Androidå·¥ç¨‹ä»£ç  ä¸€ã€ä»£ç å®ç° ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ // ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ av_register_all(); ç¬¬äºŒæ­¥ï¼šæ‰“å¼€å°è£…æ ¼å¼ // ç¬¬äºŒæ­¥ï¼šæ‰“å¼€å°è£…æ ¼å¼ // æ‰“å¼€è§†é¢‘æ–‡ä»¶ï¼Œè¯»æ–‡ä»¶å¤´å†…å®¹ï¼Œå–å¾—æ–‡ä»¶å®¹å™¨çš„å°è£…ä¿¡æ¯åŠç æµå‚æ•°å¹¶å­˜å‚¨åœ¨avformat_contextä¸­ // å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ // ä½œç”¨ï¼šä¿å­˜æ•´ä¸ªè§†é¢‘ä¿¡æ¯(è§£ç å™¨ã€ç¼–ç å™¨ç­‰ç­‰...) // ä¿¡æ¯ï¼šç ç‡ã€å¸§ç‡ç­‰... AVFormatContext* avformat_context = avformat_alloc_context(); // å‚æ•°äºŒï¼šè§†é¢‘è·¯å¾„ const char *url = \"/storage/emulated/0/Download/test.mov\"; // å‚æ•°ä¸‰ï¼šæŒ‡å®šè¾“å…¥çš„æ ¼å¼ // å‚æ•°å››ï¼šè®¾ç½®é»˜è®¤å‚æ•° int avformat_open_input_result = avformat_open_input(&avformat_context, url, NULL, NULL); if (avformat_open_input_result != 0){ // å®‰å“å¹³å°ä¸‹log __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ‰“å¼€æ–‡ä»¶å¤±è´¥\"); // iOSå¹³å°ä¸‹log // NSLog(\"æ‰“å¼€æ–‡ä»¶å¤±è´¥\"); // ä¸åŒçš„å¹³å°æ›¿æ¢ä¸åŒå¹³å°logæ—¥å¿— return -1; } ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾è§†é¢‘æµï¼Œæ‹¿åˆ°è§†é¢‘ä¿¡æ¯ // ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾è§†é¢‘æµï¼Œæ‹¿åˆ°è§†é¢‘ä¿¡æ¯ // å–å¾—æ–‡ä»¶ä¸­ä¿å­˜çš„ç æµä¿¡æ¯ï¼Œå¹¶å¡«å……åˆ°avformat_context->stream å­—æ®µ // å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ // å‚æ•°äºŒï¼šæŒ‡å®šé»˜è®¤é…ç½® int avformat_find_stream_info_result = avformat_find_stream_info(avformat_context, NULL); if (avformat_find_stream_info_result ç¬¬å››æ­¥ï¼šæŸ¥æ‰¾è§†é¢‘è§£ç å™¨ // ç¬¬å››æ­¥ï¼šæŸ¥æ‰¾è§†é¢‘è§£ç å™¨ // 4.1 æŸ¥æ‰¾è§†é¢‘æµç´¢å¼•ä½ç½® int av_stream_index = -1; for (int i = 0; i nb_streams; ++i) { // åˆ¤æ–­æµç±»å‹ï¼šè§†é¢‘æµã€éŸ³é¢‘æµã€å­—æ¯æµç­‰ç­‰... if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_VIDEO){ av_stream_index = i; break; } } // 4.2 æ ¹æ®è§†é¢‘æµç´¢å¼•ï¼Œè·å–è§£ç å™¨ä¸Šä¸‹æ–‡ AVCodecContext *avcodec_context = avformat_context->streams[av_stream_index]->codec; // 4.3 æ ¹æ®è§£ç å™¨ä¸Šä¸‹æ–‡ï¼Œè·å¾—è§£ç å™¨IDï¼Œç„¶åæŸ¥æ‰¾è§£ç å™¨ AVCodec *avcodec = avcodec_find_decoder(avcodec_context->codec_id); ç¬¬äº”æ­¥ï¼šæ‰“å¼€è§£ç å™¨ // ç¬¬äº”æ­¥ï¼šæ‰“å¼€è§£ç å™¨ int avcodec_open2_result = avcodec_open2(avcodec_context, avcodec, NULL); if (avcodec_open2_result != 0){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ‰“å¼€è§£ç å™¨å¤±è´¥\"); return -1; } // æµ‹è¯•ä¸€ä¸‹ // æ‰“å°ä¿¡æ¯ __android_log_print(ANDROID_LOG_INFO, \"main\", \"è§£ç å™¨åç§°ï¼š%s\", avcodec->name); ç¬¬å…­æ­¥ï¼šå®šä¹‰ç±»å‹è½¬æ¢å‚æ•° // ç¬¬å…­æ­¥ï¼šå®šä¹‰ç±»å‹è½¬æ¢å‚æ•° // 6.1 è®¾ç½®å›¾åƒè½¬æ¢åƒç´ æ ¼å¼ä¸ºAV_PIX_FMT_YUV420P // å‚æ•°ä¸€ï¼šæºæ–‡ä»¶->åŸå§‹è§†é¢‘åƒç´ æ•°æ®æ ¼å¼å®½ // å‚æ•°äºŒï¼šæºæ–‡ä»¶->åŸå§‹è§†é¢‘åƒç´ æ•°æ®æ ¼å¼é«˜ // å‚æ•°ä¸‰ï¼šæºæ–‡ä»¶->åŸå§‹è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ // å‚æ•°å››ï¼šç›®æ ‡æ–‡ä»¶->ç›®æ ‡è§†é¢‘åƒç´ æ•°æ®æ ¼å¼å®½ // å‚æ•°äº”ï¼šç›®æ ‡æ–‡ä»¶->ç›®æ ‡è§†é¢‘åƒç´ æ•°æ®æ ¼å¼é«˜ // å‚æ•°å…­ï¼šç›®æ ‡æ–‡ä»¶->ç›®æ ‡è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ SwsContext *swscontext = sws_getContext(avcodec_context->width, avcodec_context->height, avcodec_context->pix_fmt, avcodec_context->width, avcodec_context->height, AV_PIX_FMT_YUV420P, SWS_BICUBIC, NULL, NULL, NULL); // 6.2 è§£ç åçš„è§†é¢‘ä¿¡æ¯ç»“æ„ä½“ // è§†é¢‘å‹ç¼©æ•°æ®ï¼šH264 AVFrame* avframe_in = av_frame_alloc(); // å®šä¹‰è§£ç ç»“æœ int decode_result = 0; // 6.3 ä¿å­˜è½¬æ¢ä¸ºAV_PIX_FMT_YUV420Pæ ¼å¼çš„è§†é¢‘å¸§ // è§†é¢‘é‡‡æ ·æ•°æ®ï¼šYUVæ ¼å¼ AVFrame* avframe_yuv420p = av_frame_alloc(); // ç»™ç¼“å†²åŒºè®¾ç½®ç±»å‹->yuv420ç±»å‹ // å¾—åˆ°YUV420Pç¼“å†²åŒºå¤§å° // å‚æ•°ä¸€ï¼šè§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹->YUV420Pæ ¼å¼ // å‚æ•°äºŒï¼šä¸€å¸§è§†é¢‘åƒç´ æ•°æ®å®½ = è§†é¢‘å®½ // å‚æ•°ä¸‰ï¼šä¸€å¸§è§†é¢‘åƒç´ æ•°æ®é«˜ = è§†é¢‘é«˜ // å‚æ•°å››ï¼šå­—èŠ‚å¯¹é½æ–¹å¼->é»˜è®¤æ˜¯1 int buffer_size = av_image_get_buffer_size(AV_PIX_FMT_YUV420P, avcodec_context->width, avcodec_context->height, 1); // å¼€è¾Ÿä¸€å—å†…å­˜ç©ºé—´ uint8_t *out_buffer = (uint8_t *)av_malloc(buffer_size); // å‘avframe_yuv420på¡«å……æ•°æ® // å‚æ•°ä¸€ï¼šç›®æ ‡->å¡«å……æ•°æ®(avframe_yuv420p) // å‚æ•°äºŒï¼šç›®æ ‡->æ¯ä¸€è¡Œå¤§å° // å‚æ•°ä¸‰ï¼šåŸå§‹æ•°æ® // å‚æ•°å››ï¼šç›®æ ‡->æ ¼å¼ç±»å‹ // å‚æ•°äº”ï¼šå®½ // å‚æ•°å…­ï¼šé«˜ // å‚æ•°ä¸ƒï¼šå­—èŠ‚å¯¹é½æ–¹å¼ av_image_fill_arrays(avframe_yuv420p->data, avframe_yuv420p->linesize, out_buffer, AV_PIX_FMT_YUV420P, avcodec_context->width, avcodec_context->height, 1); ç¬¬ä¸ƒæ­¥ï¼šåˆå§‹åŒ–SDLå¤šåª’ä½“æ¡†æ¶ // ç¬¬ä¸ƒæ­¥ï¼šåˆå§‹åŒ–SDLå¤šåª’ä½“æ¡†æ¶ if (SDL_Init( SDL_INIT_VIDEO | SDL_INIT_AUDIO | SDL_INIT_TIMER ) == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); return -1; } ç¬¬å…«æ­¥ï¼šåˆå§‹åŒ–SDLçª—å£ // ç¬¬å…«æ­¥ï¼šåˆå§‹åŒ–SDLçª—å£ // å‚æ•°ä¸€ï¼šçª—å£åç§° // å‚æ•°äºŒï¼šçª—å£åœ¨å±å¹•ä¸Šçš„xåæ ‡ // å‚æ•°ä¸‰ï¼šçª—å£åœ¨å±å¹•ä¸Šçš„yåæ ‡ // å‚æ•°å››ï¼šçª—å£åœ¨å±å¹•ä¸Šå®½ // å‚æ•°äº”ï¼šçª—å£åœ¨å±å¹•ä¸Šé«˜ // å‚æ•°å…­ï¼šçª—å£çŠ¶æ€(æ‰“å¼€) SDL_Window* sdl_window = SDL_CreateWindow(\"SDLæ’­æ”¾YUVè§†é¢‘\", SDL_WINDOWPOS_CENTERED, SDL_WINDOWPOS_CENTERED, avcodec_context->width, avcodec_context->height, SDL_WINDOW_OPENGL); if (sdl_window == NULL){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"çª—å£åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çª—å£åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } __android_log_print(ANDROID_LOG_INFO, \"main\", \"çª—å£åˆ›å»ºæˆåŠŸwidthï¼š%dï¼Œheightï¼š%d\", avcodec_context->width,avcodec_context->height); ç¬¬ä¹æ­¥ï¼šåˆ›å»ºæ¸²æŸ“å™¨->æ¸²æŸ“çª—å£ // ç¬¬ä¹æ­¥ï¼šåˆ›å»ºæ¸²æŸ“å™¨->æ¸²æŸ“çª—å£ // å‚æ•°ä¸€ï¼šæ¸²æŸ“ç›®æ ‡åˆ›å»º->ç›®æ ‡ // å‚æ•°äºŒï¼šä»é‚£é‡Œå¼€å§‹æ¸²æŸ“(-1:è¡¨ç¤ºä»ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹) // å‚æ•°ä¸‰ï¼šæ¸²æŸ“ç±»å‹(è½¯ä»¶æ¸²æŸ“) SDL_Renderer* sdl_renderer = SDL_CreateRenderer(sdl_window, -1, 0); if (sdl_renderer == NULL){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } // å®šä¹‰æ¸²æŸ“å™¨åŒºåŸŸ SDL_Rect sdl_rect; ç¬¬åæ­¥ï¼šåˆ›å»ºçº¹ç† // ç¬¬åæ­¥ï¼šåˆ›å»ºçº¹ç† // å‚æ•°ä¸€ï¼šçº¹ç†->ç›®æ ‡æ¸²æŸ“å™¨ // å‚æ•°äºŒï¼šæ¸²æŸ“æ ¼å¼->YUVæ ¼å¼->åƒç´ æ•°æ®æ ¼å¼(è§†é¢‘)æˆ–è€…æ˜¯éŸ³é¢‘é‡‡æ ·æ•°æ®æ ¼å¼(éŸ³é¢‘) // å‚æ•°ä¸‰ï¼šç»˜åˆ¶æ–¹å¼->é¢‘ç¹ç»˜åˆ¶->SDL_TEXTUREACCESS_STREAMING // å‚æ•°å››ï¼šçº¹ç†å®½ // å‚æ•°äº”ï¼šçº¹ç†é«˜ SDL_Texture* sdl_texture = SDL_CreateTexture(sdl_renderer, SDL_PIXELFORMAT_IYUV, SDL_TEXTUREACCESS_STREAMING, avcodec_context->width, avcodec_context->height); if (sdl_texture == NULL) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } ç¬¬åä¸€æ­¥ï¼šè¯»å–è§†é¢‘å‹ç¼©æ•°æ®å¸§ // ç¬¬åä¸€æ­¥ï¼šè¯»å–è§†é¢‘å‹ç¼©æ•°æ®å¸§ int current_index = 0; // å†™å…¥æ—¶yuvæ•°æ®ä½ç½® int y_size, u_size, v_size; // åˆ†æav_read_frameå‚æ•°ã€‚ // å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ // å‚æ•°äºŒï¼šä¸€å¸§å‹ç¼©æ•°æ® // å¦‚æœæ˜¯è§£ç è§†é¢‘æµï¼Œæ˜¯è§†é¢‘å‹ç¼©å¸§æ•°æ®ï¼Œä¾‹å¦‚H264 AVPacket* packet = (AVPacket*)av_malloc(sizeof(AVPacket)); while (av_read_frame(avformat_context, packet) >= 0) { // >=:è¯»å–åˆ°äº† // stream_index == av_stream_index) { // ç¬¬åäºŒæ­¥ï¼šå¼€å§‹è§†é¢‘è§£ç  // ... current_index++; __android_log_print(ANDROID_LOG_INFO, \"main\", \"å½“å‰è§£ç ç¬¬%då¸§\", current_index); } } ç¬¬åäºŒæ­¥ï¼šå¼€å§‹è§†é¢‘è§£ç  // ç¬¬åäºŒæ­¥ï¼šå¼€å§‹è§†é¢‘è§£ç  // å‘é€ä¸€å¸§è§†é¢‘å‹ç¼©æ•°æ® avcodec_send_packet(avcodec_context, packet); // è§£ç ä¸€å¸§è§†é¢‘æ•°æ® decode_result = avcodec_receive_frame(avcodec_context, avframe_in); if (decode_result == 0) { // è§†é¢‘è§£ç æˆåŠŸ // ç¬¬åä¸‰æ­¥ï¼šå¼€å§‹ç±»å‹è½¬æ¢ // ... // ç¬¬åå››æ­¥ï¼šè®¾ç½®çº¹ç†æ•°æ® // ... // ç¬¬åäº”æ­¥ï¼šå°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // ... // ç¬¬åå…­æ­¥ï¼šå‘ˆç°ç”»é¢å¸§ // ... // ç¬¬åä¸ƒæ­¥ï¼šæ¸²æŸ“æ¯ä¸€å¸§ç›´æ¥é—´éš”æ—¶é—´ // ... } ç¬¬åä¸‰æ­¥ï¼šå¼€å§‹ç±»å‹è½¬æ¢ // ç¬¬åä¸‰æ­¥ï¼šå¼€å§‹ç±»å‹è½¬æ¢ // å°†è§£ç å‡ºæ¥çš„è§†é¢‘åƒç´ ç‚¹æ•°æ®æ ¼å¼ç»Ÿä¸€è½¬ç±»å‹ä¸ºyuv420P // å‚æ•°ä¸€ï¼šè§†é¢‘åƒç´ æ•°æ®æ ¼å¼ä¸Šä¸‹æ–‡ // å‚æ•°äºŒï¼šåŸæ¥çš„è§†é¢‘åƒç´ æ•°æ®æ ¼å¼->è¾“å…¥æ•°æ® // å‚æ•°ä¸‰ï¼šåŸæ¥çš„è§†é¢‘åƒç´ æ•°æ®æ ¼å¼->è¾“å…¥ç”»é¢æ¯ä¸€è¡Œå¤§å° // å‚æ•°å››ï¼šåŸæ¥çš„è§†é¢‘åƒç´ æ•°æ®æ ¼å¼->è¾“å…¥ç”»é¢æ¯ä¸€è¡Œå¼€å§‹ä½ç½®(å¡«å†™ï¼š0->è¡¨ç¤ºä»åŸç‚¹å¼€å§‹è¯»å–) // å‚æ•°äº”ï¼šåŸæ¥çš„è§†é¢‘åƒç´ æ•°æ®æ ¼å¼->è¾“å…¥æ•°æ®è¡Œæ•° // å‚æ•°å…­ï¼šè½¬æ¢ç±»å‹åè§†é¢‘åƒç´ æ•°æ®æ ¼å¼->è¾“å‡ºæ•°æ® // å‚æ•°ä¸ƒï¼šè½¬æ¢ç±»å‹åè§†é¢‘åƒç´ æ•°æ®æ ¼å¼->è¾“å‡ºç”»é¢æ¯ä¸€è¡Œå¤§å° sws_scale(swscontext, (const uint8_t *const *)avframe_in->data, avframe_in->linesize, 0, avcodec_context->height, avframe_yuv420p->data, avframe_yuv420p->linesize); ç¬¬åå››æ­¥ï¼šè®¾ç½®çº¹ç†æ•°æ® // ç¬¬åå››æ­¥ï¼šè®¾ç½®çº¹ç†æ•°æ® // å‚æ•°ä¸€ï¼šçº¹ç† // å‚æ•°äºŒï¼šæ¸²æŸ“åŒºåŸŸ // å‚æ•°ä¸‰ï¼šéœ€è¦æ¸²æŸ“æ•°æ®->è§†é¢‘åƒç´ æ•°æ®å¸§ // å‚æ•°å››ï¼šå¸§å®½ SDL_UpdateTexture(sdl_texture, NULL, avframe_yuv420p->data[0], avframe_yuv420p->linesize[0]); ç¬¬åäº”æ­¥ï¼šå°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // ç¬¬åäº”æ­¥ï¼šå°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // è®¾ç½®å·¦ä¸Šè§’ä½ç½®(å…¨å±) sdl_rect.x = 100; sdl_rect.y = 100; sdl_rect.w = avcodec_context->width; sdl_rect.h = avcodec_context->height; SDL_RenderClear(sdl_renderer); SDL_RenderCopy(sdl_renderer, sdl_texture, NULL, &sdl_rect); ç¬¬åå…­æ­¥ï¼šå‘ˆç°ç”»é¢å¸§ // ç¬¬åå…­æ­¥ï¼šå‘ˆç°ç”»é¢å¸§ SDL_RenderPresent(sdl_renderer); ç¬¬åä¸ƒæ­¥ï¼šæ¸²æŸ“æ¯ä¸€å¸§ç›´æ¥é—´éš”æ—¶é—´ // ç¬¬åä¸ƒæ­¥ï¼šæ¸²æŸ“æ¯ä¸€å¸§ç›´æ¥é—´éš”æ—¶é—´ SDL_Delay(30); ç¬¬åå…«æ­¥ï¼šé‡Šæ”¾èµ„æº // ç¬¬åå…«æ­¥ï¼šé‡Šæ”¾èµ„æº SDL_DestroyTexture(sdl_texture); SDL_DestroyRenderer(sdl_renderer); ç¬¬åä¹æ­¥ï¼šé€€å‡ºç¨‹åº // ç¬¬åä¹æ­¥ï¼šé€€å‡ºç¨‹åº SDL_Quit(); ç¬¬äºŒåæ­¥ï¼šé‡Šæ”¾å†…å­˜èµ„æºï¼Œå…³é—­è§£ç å™¨ // ç¬¬äºŒåæ­¥ï¼šé‡Šæ”¾å†…å­˜èµ„æºï¼Œå…³é—­è§£ç å™¨ av_packet_free(&packet); av_frame_free(&avframe_in); av_frame_free(&avframe_yuv420p); free(out_buffer); avcodec_close(avcodec_context); avformat_free_context(avformat_context); ä¸€ã€Androidå®ç° ç¬¬ä¸€æ­¥ï¼šAndroidé›†æˆSDL å‚è€ƒï¼šhttp://www.1221.site/FFmpeg/08_SDL%E6%92%AD%E6%94%BEYUV.html æ–°å»ºå·¥ç¨‹åç§°ä¸ºAndroidDisplayVideoWhileDecodingï¼ŒæŒ‰ä¸Šé¢æ–‡ç« é…ç½®ï¼Œèƒ½æ­£å¸¸æ’­æ”¾YUVæ–‡ä»¶å°±ç®—æˆåŠŸå®Œæˆäº†ç¬¬ä¸€æ­¥ã€‚ ç¬¬äºŒæ­¥ï¼šAndroidé›†æˆFFmpeg å‚è€ƒï¼šhttp://www.1221.site/FFmpeg/02_FFmpeg%E9%9B%86%E6%88%90.html ç¬¬ä¸‰æ­¥ï¼šä¿®æ”¹native-lib.cpp #include #include #include #include #include \"SDL.h\" extern \"C\" { // å¼•å…¥å¤´æ–‡ä»¶ // æ ¸å¿ƒåº“->éŸ³è§†é¢‘ç¼–è§£ç åº“ #include #include \"libavformat/avformat.h\" #include #include } // SDLå…¥å£ extern \"C\" int main(int argc, char *argv[]) { // è¾¹è§£ç è¾¹æ˜¾ç¤ºè§†é¢‘å®ç° // å¤åˆ¶ä»£ç å®ç° } "},"pages/FFmpeg/FFmpeg_SDLæ’­æ”¾éŸ³é¢‘.html":{"url":"pages/FFmpeg/FFmpeg_SDLæ’­æ”¾éŸ³é¢‘.html","title":"FFmpeg+SDLæ’­æ”¾éŸ³é¢‘","keywords":"","body":"FFmpeg+SDLæ’­æ”¾éŸ³é¢‘ Androidå·¥ç¨‹ä»£ç  ä¸€ã€ä»£ç å®ç° å¢åŠ å¤´æ–‡ä»¶ #include å®šä¹‰ä¸€ // å®šä¹‰ä¸€ // SDLè¯»éŸ³é¢‘ç¼“å­˜çš„å¤§å° #define SDL_AUDIO_BUFFER_SIZE 1024 #define MAX_AUDIO_FRAME_SIZE 192000 int quit = 0;// å…¨å±€é€€å‡ºè¿›ç¨‹æ ‡è¯†ï¼Œåœ¨ç•Œé¢ä¸Šç‚¹äº†é€€å‡ºåï¼Œå‘Šè¯‰çº¿ç¨‹é€€å‡º å®šä¹‰äºŒï¼šæ•°æ®åŒ…é˜Ÿåˆ—(é“¾è¡¨)ç»“æ„ä½“ // å®šä¹‰äºŒï¼šæ•°æ®åŒ…é˜Ÿåˆ—(é“¾è¡¨)ç»“æ„ä½“ /*-------é“¾è¡¨èŠ‚ç‚¹ç»“æ„ä½“------- typedef struct AVPacketList { AVPacket pkt;//é“¾è¡¨æ•°æ® struct AVPacketList *next;//é“¾è¡¨åç»§èŠ‚ç‚¹ } AVPacketList; ---------------------------*/ typedef struct PacketQueue { AVPacketList *first_pkt, *last_pkt;// é˜Ÿåˆ—é¦–å°¾èŠ‚ç‚¹æŒ‡é’ˆ int nb_packets;// é˜Ÿåˆ—é•¿åº¦ int size;// ä¿å­˜ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ï¼Œsize=packet->size SDL_mutex *qlock;// é˜Ÿåˆ—äº’æ–¥é‡ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® SDL_cond *qready;// é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å˜é‡ } PacketQueue; PacketQueue audioq;// å®šä¹‰å…¨å±€é˜Ÿåˆ—å¯¹è±¡ å®šä¹‰ä¸‰ï¼šé˜Ÿåˆ—åˆå§‹åŒ–å‡½æ•° // å®šä¹‰ä¸‰ï¼šé˜Ÿåˆ—åˆå§‹åŒ–å‡½æ•° void packet_queue_init(PacketQueue *q) { memset(q, 0, sizeof(PacketQueue));//å…¨é›¶åˆå§‹åŒ–é˜Ÿåˆ—ç»“æ„ä½“å¯¹è±¡ q->qlock = SDL_CreateMutex();//åˆ›å»ºäº’æ–¥é‡å¯¹è±¡ q->qready = SDL_CreateCond();//åˆ›å»ºæ¡ä»¶å˜é‡å¯¹è±¡ } å®šä¹‰å››ï¼šå‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… // å®šä¹‰å››ï¼šå‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… int packet_queue_put(PacketQueue *q, AVPacket *pkt) { /*-------å‡†å¤‡é˜Ÿåˆ—(é“¾è¡¨)èŠ‚ç‚¹å¯¹è±¡------*/ AVPacketList *pktlist;// åˆ›å»ºé“¾è¡¨èŠ‚ç‚¹å¯¹è±¡æŒ‡é’ˆ pktlist = static_cast(av_malloc(sizeof(AVPacketList)));// åœ¨å †ä¸Šåˆ›å»ºé“¾è¡¨èŠ‚ç‚¹å¯¹è±¡ if (!pktlist) {// æ£€æŸ¥é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡æ˜¯å¦åˆ›å»ºæˆåŠŸ return -1; } pktlist->pkt = *pkt;// å°†è¾“å…¥æ•°æ®åŒ…èµ‹å€¼ç»™æ–°å»ºé“¾è¡¨èŠ‚ç‚¹å¯¹è±¡ä¸­çš„æ•°æ®åŒ…å¯¹è±¡ pktlist->next = NULL;// é“¾è¡¨åç»§æŒ‡é’ˆä¸ºç©º // if (av_packet_ref(pkt, pkt)qlock);// é˜Ÿåˆ—äº’æ–¥é‡åŠ é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® if (!q->last_pkt) {// æ£€æŸ¥é˜Ÿåˆ—å°¾èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨(æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º) q->first_pkt = pktlist;// è‹¥ä¸å­˜åœ¨(é˜Ÿåˆ—å°¾ç©º)ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹ä½œé˜Ÿåˆ—ä¸ºé¦–èŠ‚ç‚¹ } else { q->last_pkt->next = pktlist;// è‹¥å·²å­˜åœ¨å°¾èŠ‚ç‚¹ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹æŒ‚åˆ°å°¾èŠ‚ç‚¹çš„åç»§æŒ‡é’ˆä¸Šï¼Œå¹¶ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ } q->last_pkt = pktlist;// å°†å½“å‰èŠ‚ç‚¹ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ q->nb_packets++;// é˜Ÿåˆ—é•¿åº¦+1 q->size += pktlist->pkt.size;// æ›´æ–°é˜Ÿåˆ—ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ SDL_CondSignal(q->qready);// ç»™ç­‰å¾…çº¿ç¨‹å‘å‡ºæ¶ˆæ¯ï¼Œé€šçŸ¥é˜Ÿåˆ—å·²å°±ç»ª SDL_UnlockMutex(q->qlock);// é‡Šæ”¾äº’æ–¥é‡ return 0; } å®šä¹‰äº”ï¼šä»é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ï¼Œå¹¶å°†æå–çš„æ•°æ®åŒ…å‡ºé˜Ÿåˆ— // å®šä¹‰äº”ï¼šä»é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ï¼Œå¹¶å°†æå–çš„æ•°æ®åŒ…å‡ºé˜Ÿåˆ— static int packet_queue_get(PacketQueue *q, AVPacket *pkt, int block) { AVPacketList *pktlist;// ä¸´æ—¶é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡æŒ‡é’ˆ int ret;// æ“ä½œç»“æœ SDL_LockMutex(q->qlock);// é˜Ÿåˆ—äº’æ–¥é‡åŠ é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® for (;;) { if (quit) {// æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† ret = -1;// æ“ä½œå¤±è´¥ break; } pktlist = q->first_pkt;// ä¼ é€’å°†é˜Ÿåˆ—é¦–ä¸ªæ•°æ®åŒ…æŒ‡é’ˆ if (pktlist) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºç©º(é˜Ÿåˆ—æ˜¯å¦æœ‰æ•°æ®) q->first_pkt = pktlist->next;// é˜Ÿåˆ—é¦–èŠ‚ç‚¹æŒ‡é’ˆåç§» if (!q->first_pkt) {// æ£€æŸ¥é¦–èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ q->last_pkt = NULL;// è‹¥ä¸å­˜åœ¨ï¼Œåˆ™å°†å°¾èŠ‚ç‚¹æŒ‡é’ˆç½®ç©º } q->nb_packets--;// é˜Ÿåˆ—é•¿åº¦-1 q->size -= pktlist->pkt.size;// æ›´æ–°é˜Ÿåˆ—ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ *pkt = pktlist->pkt;// å°†é˜Ÿåˆ—é¦–èŠ‚ç‚¹æ•°æ®è¿”å› av_free(pktlist);// æ¸…ç©ºä¸´æ—¶èŠ‚ç‚¹æ•°æ®(æ¸…ç©ºé¦–èŠ‚ç‚¹æ•°æ®ï¼Œé¦–èŠ‚ç‚¹å‡ºé˜Ÿåˆ—) ret = 1;// æ“ä½œæˆåŠŸ break; } else if (!block) { ret = 0; break; } else {// é˜Ÿåˆ—å¤„äºæœªå°±ç»ªçŠ¶æ€ï¼Œæ­¤æ—¶é€šè¿‡SDL_CondWaitå‡½æ•°ç­‰å¾…qreadyå°±ç»ªä¿¡å·ï¼Œå¹¶æš‚æ—¶å¯¹äº’æ–¥é‡è§£é” /*--------------------- * ç­‰å¾…é˜Ÿåˆ—å°±ç»ªä¿¡å·qreadyï¼Œå¹¶å¯¹äº’æ–¥é‡æš‚æ—¶è§£é” * æ­¤æ—¶çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œå¹¶ç½®äºç­‰å¾…æ¡ä»¶å°±ç»ªçš„çº¿ç¨‹åˆ—è¡¨ä¸Š * ä½¿å¾—è¯¥çº¿ç¨‹åªåœ¨ä¸´ç•ŒåŒºèµ„æºå°±ç»ªåæ‰è¢«å”¤é†’ï¼Œè€Œä¸è‡³äºçº¿ç¨‹è¢«é¢‘ç¹åˆ‡æ¢ * è¯¥å‡½æ•°è¿”å›æ—¶ï¼Œäº’æ–¥é‡å†æ¬¡è¢«é”ä½ï¼Œå¹¶æ‰§è¡Œåç»­æ“ä½œ --------------------*/ SDL_CondWait(q->qready, q->qlock);// æš‚æ—¶è§£é”äº’æ–¥é‡å¹¶å°†è‡ªå·±é˜»å¡ï¼Œç­‰å¾…ä¸´ç•ŒåŒºèµ„æºå°±ç»ª(ç­‰å¾…SDL_CondSignalå‘å‡ºä¸´ç•ŒåŒºèµ„æºå°±ç»ªçš„ä¿¡å·) } }// end for for-loop SDL_UnlockMutex(q->qlock);// é‡Šæ”¾äº’æ–¥é‡ return ret; } å®šä¹‰å…­ï¼šéŸ³é¢‘è§£ç  /*--------------------------- * å®šä¹‰å…­ï¼šéŸ³é¢‘è§£ç  * ä»ç¼“å­˜é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ã€è§£ç ï¼Œå¹¶è¿”å›è§£ç åçš„æ•°æ®é•¿åº¦(å¯¹ä¸€ä¸ªå®Œæ•´çš„packetè§£ç ï¼Œå°†è§£ç æ•°æ®å†™å…¥audio_bufç¼“å­˜ï¼Œå¹¶è¿”å›å¤šå¸§è§£ç æ•°æ®çš„æ€»é•¿åº¦) * aCodecCtx:éŸ³é¢‘è§£ç å™¨ä¸Šä¸‹æ–‡ * audio_bufï¼šä¿å­˜è§£ç ä¸€ä¸ªå®Œæ•´çš„packeåçš„åŸå§‹éŸ³é¢‘æ•°æ®(ç¼“å­˜ä¸­å¯èƒ½åŒ…å«å¤šå¸§è§£ç åçš„éŸ³é¢‘æ•°æ®) * buf_sizeï¼šè§£ç åçš„éŸ³é¢‘æ•°æ®é•¿åº¦ï¼Œæœªä½¿ç”¨ --------------------------*/ int audio_decode_frame(AVCodecContext *aCodecCtx, uint8_t *audio_buf, int buf_size) { static AVPacket pkt;// ä¿å­˜ä»é˜Ÿåˆ—ä¸­æå–çš„æ•°æ®åŒ… static AVFrame frame;// ä¿å­˜ä»æ•°æ®åŒ…ä¸­è§£ç çš„éŸ³é¢‘æ•°æ® static uint8_t *audio_pkt_data = NULL;// ä¿å­˜æ•°æ®åŒ…ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆ static int audio_pkt_size = 0;// æ•°æ®åŒ…ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦ int coded_consumed_size, data_size = 0;// æ¯æ¬¡æ¶ˆè€—çš„ç¼–ç æ•°æ®é•¿åº¦[input](len1)ï¼Œè¾“å‡ºåŸå§‹éŸ³é¢‘æ•°æ®çš„ç¼“å­˜é•¿åº¦[output] for (;;) { while(audio_pkt_size>0) {// æ£€æŸ¥ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦(æ˜¯å¦å·²å®Œæˆä¸€ä¸ªå®Œæ•´çš„pakcetåŒ…çš„è§£ç ï¼Œä¸€ä¸ªæ•°æ®åŒ…ä¸­å¯èƒ½åŒ…å«å¤šä¸ªéŸ³é¢‘ç¼–ç å¸§) int got_frame = 0;// è§£ç æ“ä½œæˆåŠŸæ ‡è¯†ï¼ŒæˆåŠŸè¿”å›éé›¶å€¼ coded_consumed_size=avcodec_decode_audio4(aCodecCtx,&frame,&got_frame,&pkt);//è§£ç ä¸€å¸§éŸ³é¢‘æ•°æ®ï¼Œå¹¶è¿”å›æ¶ˆè€—çš„ç¼–ç æ•°æ®é•¿åº¦ if (coded_consumed_size channels,frame.nb_samples,aCodecCtx->sample_fmt,1); memcpy(audio_buf, frame.data[0], data_size);// å°†è§£ç æ•°æ®å¤åˆ¶åˆ°è¾“å‡ºç¼“å­˜ } if (data_size å®šä¹‰ä¸ƒï¼šéŸ³é¢‘è¾“å‡ºå›è°ƒå‡½æ•° /*------Audio Callback------- * å®šä¹‰ä¸ƒï¼šéŸ³é¢‘è¾“å‡ºå›è°ƒå‡½æ•° * sdlé€šè¿‡è¯¥å›è°ƒå‡½æ•°å°†è§£ç åçš„pcmæ•°æ®é€å…¥å£°å¡æ’­æ”¾, * sdlé€šå¸¸ä¸€æ¬¡ä¼šå‡†å¤‡ä¸€ç»„ç¼“å­˜pcmæ•°æ®ï¼Œé€šè¿‡è¯¥å›è°ƒé€å…¥å£°å¡ï¼Œå£°å¡æ ¹æ®éŸ³é¢‘ptsä¾æ¬¡æ’­æ”¾pcmæ•°æ® * å¾…é€å…¥ç¼“å­˜çš„pcmæ•°æ®å®Œæˆæ’­æ”¾åï¼Œå†è½½å…¥ä¸€ç»„æ–°çš„pcmç¼“å­˜æ•°æ®(æ¯æ¬¡éŸ³é¢‘è¾“å‡ºç¼“å­˜ä¸ºç©ºæ—¶ï¼Œsdlå°±è°ƒç”¨æ­¤å‡½æ•°å¡«å……éŸ³é¢‘è¾“å‡ºç¼“å­˜ï¼Œå¹¶é€å…¥å£°å¡æ’­æ”¾) * When we begin playing audio, SDL will continually call this callback function * and ask it to fill the audio buffer with a certain number of bytes * The audio function callback takes the following parameters: * stream: A pointer to the audio buffer to be filledï¼Œè¾“å‡ºéŸ³é¢‘æ•°æ®åˆ°å£°å¡ç¼“å­˜ * len: The length (in bytes) of the audio buffer,ç¼“å­˜é•¿åº¦wanted_spec.samples=SDL_AUDIO_BUFFER_SIZE(1024) --------------------------*/ void audio_callback(void *userdata, Uint8 *stream, int len) { AVCodecContext *aCodecCtx = (AVCodecContext *)userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® int wt_stream_len, audio_size;// æ¯æ¬¡å†™å…¥streamçš„æ•°æ®é•¿åº¦ï¼Œè§£ç åçš„æ•°æ®é•¿åº¦ static uint8_t audio_buf[(MAX_AUDIO_FRAME_SIZE*3)/2];// ä¿å­˜è§£ç ä¸€ä¸ªpacketåçš„å¤šå¸§åŸå§‹éŸ³é¢‘æ•°æ® static unsigned int audio_buf_size = 0;// è§£ç åçš„å¤šå¸§éŸ³é¢‘æ•°æ®é•¿åº¦ static unsigned int audio_buf_index = 0;// ç´¯è®¡å†™å…¥streamçš„é•¿åº¦ while (len>0) {// æ£€æŸ¥éŸ³é¢‘ç¼“å­˜çš„å‰©ä½™é•¿åº¦ if (audio_buf_index >= audio_buf_size) {// æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰§è¡Œè§£ç æ“ä½œ // We have already sent all our data; get moreï¼Œä»ç¼“å­˜é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ã€è§£ç ï¼Œå¹¶è¿”å›è§£ç åçš„æ•°æ®é•¿åº¦ï¼Œaudio_bufç¼“å­˜ä¸­å¯èƒ½åŒ…å«å¤šå¸§è§£ç åçš„éŸ³é¢‘æ•°æ® audio_size = audio_decode_frame(aCodecCtx, audio_buf, audio_buf_size); if (audio_size len) {// æ£€æŸ¥æ¯æ¬¡å†™å…¥ç¼“å­˜çš„æ•°æ®é•¿åº¦æ˜¯å¦è¶…è¿‡æŒ‡å®šé•¿åº¦(1024) wt_stream_len = len;// æŒ‡å®šé•¿åº¦ä»è§£ç çš„ç¼“å­˜ä¸­å–æ•°æ® } // æ¯æ¬¡ä»è§£ç çš„ç¼“å­˜æ•°æ®ä¸­ä»¥æŒ‡å®šé•¿åº¦æŠ½å–æ•°æ®å¹¶å†™å…¥streamä¼ é€’ç»™å£°å¡ memcpy(stream,(uint8_t*)audio_buf+audio_buf_index,wt_stream_len); len -= wt_stream_len;// æ›´æ–°è§£ç éŸ³é¢‘ç¼“å­˜çš„å‰©ä½™é•¿åº¦ stream += wt_stream_len;// æ›´æ–°ç¼“å­˜å†™å…¥ä½ç½® audio_buf_index += wt_stream_len;// æ›´æ–°ç´¯è®¡å†™å…¥ç¼“å­˜æ•°æ®é•¿åº¦ }// end for while } ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ /*------------------------- * ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œç»„ä»¶ * æ³¨å†Œæ‰€æœ‰ffmpegæ”¯æŒçš„å¤šåª’ä½“æ ¼å¼åŠç¼–è§£ç å™¨ -------------------------*/ av_register_all(); ç¬¬äºŒæ­¥ï¼šæ‰“å¼€å°è£…æ ¼å¼ /*------------------------- * ç¬¬äºŒæ­¥ï¼šæ‰“å¼€å°è£…æ ¼å¼ * æ‰“å¼€è§†é¢‘æ–‡ä»¶ï¼Œè¯»æ–‡ä»¶å¤´å†…å®¹ï¼Œå–å¾—æ–‡ä»¶å®¹å™¨çš„å°è£…ä¿¡æ¯åŠç æµå‚æ•°å¹¶å­˜å‚¨åœ¨avformat_contextä¸­ * å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ * å‚æ•°äºŒï¼šè§†é¢‘è·¯å¾„ * å‚æ•°ä¸‰ï¼šæŒ‡å®šè¾“å…¥çš„æ ¼å¼ * å‚æ•°å››ï¼šè®¾ç½®é»˜è®¤å‚æ•° --------------------------*/ AVFormatContext* avformat_context = avformat_alloc_context();// å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ const char *url = \"/storage/emulated/0/Download/test.mov\";// å‚æ•°äºŒï¼šè§†é¢‘è·¯å¾„ int avformat_open_input_result = avformat_open_input(&avformat_context, url, NULL, NULL); if (avformat_open_input_result != 0){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æŸ¥æ‰¾éŸ³è§†é¢‘æµ\\n\"); return -1; } ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾ç æµ /*------------------------- * ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾ç æµ * å–å¾—æ–‡ä»¶ä¸­ä¿å­˜çš„ç æµä¿¡æ¯ï¼Œå¹¶å¡«å……åˆ°avformat_context->stream å­—æ®µ * å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ * å‚æ•°äºŒï¼šæŒ‡å®šé»˜è®¤é…ç½® -------------------------*/ int avformat_find_stream_info_result = avformat_find_stream_info(avformat_context, NULL); if (avformat_find_stream_info_result ç¬¬å››æ­¥ï¼šæŸ¥æ‰¾è§£ç å™¨ // ç¬¬å››æ­¥ï¼šæŸ¥æ‰¾è§£ç å™¨ // è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 int av_video_stream_index = -1; // éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 int av_audio_stream_index = -1; for (int i = 0; i nb_streams; ++i) { // è‹¥æ–‡ä»¶ä¸­åŒ…å«æœ‰è§†é¢‘æµ if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_VIDEO){ av_video_stream_index = i; } // è‹¥æ–‡ä»¶ä¸­åŒ…å«æœ‰éŸ³é¢‘æµ if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_AUDIO){ av_audio_stream_index = i; } } // æ£€æŸ¥æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨è§†é¢‘æµ if (av_video_stream_index == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ²¡æœ‰æ‰¾åˆ°è§†é¢‘æµ\\n\"); return -1; } // æ£€æŸ¥æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨éŸ³é¢‘æµ if (av_audio_stream_index == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ²¡æœ‰æ‰¾åˆ°éŸ³é¢‘æµ\\n\"); return -1; } // æ ¹æ®æµç±»å‹æ ‡å·ä»avformat_context->streamsä¸­å–å¾—æµå¯¹åº”çš„è§£ç å™¨ä¸Šä¸‹æ–‡ AVCodecContext *video_avcodec_context = avformat_context->streams[av_video_stream_index]->codec; AVCodecContext *audio_avcodec_context = avformat_context->streams[av_audio_stream_index]->codec; // æ ¹æ®æµå¯¹åº”çš„è§£ç å™¨ä¸Šä¸‹æ–‡æŸ¥æ‰¾å¯¹åº”çš„è§£ç å™¨ï¼Œè¿”å›å¯¹åº”çš„è§£ç å™¨(ä¿¡æ¯ç»“æ„ä½“) AVCodec *video_avcodec = avcodec_find_decoder(video_avcodec_context->codec_id); AVCodec *audio_avcodec = avcodec_find_decoder(audio_avcodec_context->codec_id); // æ£€æŸ¥è§†é¢‘è§£ç å™¨ if (!video_avcodec) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ²¡æ‰¾åˆ°è§†é¢‘è§£ç å™¨\\n\"); return -1; } // æ£€æŸ¥éŸ³é¢‘è§£ç å™¨ if (!audio_avcodec) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ²¡æ‰¾åˆ°éŸ³é¢‘è§£ç å™¨\\n\"); return -1; } ç¬¬äº”æ­¥ï¼šæ‰“å¼€è§£ç å™¨ // ç¬¬äº”æ­¥ï¼šæ‰“å¼€è§£ç å™¨ // æ‰“å¼€è§†é¢‘è§£ç å™¨ int avcodec_open2_result = avcodec_open2(video_avcodec_context, video_avcodec, NULL); if (avcodec_open2_result != 0){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ‰“å¼€è§†é¢‘è§£ç å™¨å¤±è´¥\\n\"); return -1; } // æ‰“å¼€éŸ³é¢‘è§£ç å™¨ avcodec_open2_result = avcodec_open2(audio_avcodec_context, audio_avcodec, NULL); if (avcodec_open2_result != 0){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ‰“å¼€éŸ³é¢‘è§£ç å™¨å¤±è´¥\\n\"); return -1; } // æ‰“å°è§£ç å™¨ä¿¡æ¯ __android_log_print(ANDROID_LOG_INFO, \"main\", \"è§†é¢‘è§£ç å™¨ï¼š%s\\n\", video_avcodec->name); __android_log_print(ANDROID_LOG_INFO, \"main\", \"éŸ³é¢‘è§£ç å™¨ï¼š%s\\n\", audio_avcodec->name); ç¬¬å…­æ­¥ï¼šå®šä¹‰ç±»å‹è½¬æ¢å‚æ•° /*------------------------- * ç¬¬å…­æ­¥ï¼šå®šä¹‰ç±»å‹è½¬æ¢å‚æ•° * å‚æ•°ä¸€ï¼šåŸå§‹è§†é¢‘åƒç´ æ•°æ®æ ¼å¼å®½ * å‚æ•°äºŒï¼šåŸå§‹è§†é¢‘åƒç´ æ•°æ®æ ¼å¼é«˜ * å‚æ•°ä¸‰ï¼šåŸå§‹è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ * å‚æ•°å››ï¼šç›®æ ‡è§†é¢‘åƒç´ æ•°æ®æ ¼å¼å®½ * å‚æ•°äº”ï¼šç›®æ ‡è§†é¢‘åƒç´ æ•°æ®æ ¼å¼é«˜ * å‚æ•°å…­ï¼šç›®æ ‡è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ -------------------------*/ // è®¾ç½®å›¾åƒè½¬æ¢åƒç´ æ ¼å¼ä¸ºAV_PIX_FMT_YUV420P SwsContext *swscontext = sws_getContext(video_avcodec_context->width, video_avcodec_context->height, video_avcodec_context->pix_fmt, video_avcodec_context->width, video_avcodec_context->height, AV_PIX_FMT_YUV420P, SWS_BICUBIC, NULL, NULL, NULL); // ä¿å­˜éŸ³è§†é¢‘è§£ç åçš„æ•°æ®ï¼Œå¦‚çŠ¶æ€ä¿¡æ¯ã€ç¼–è§£ç å™¨ä¿¡æ¯ã€å®å—ç±»å‹è¡¨ï¼ŒQPè¡¨ï¼Œè¿åŠ¨çŸ¢é‡è¡¨ç­‰æ•°æ® AVFrame* avframe_in = av_frame_alloc(); // å®šä¹‰è§£ç ç»“æœ int decode_result = 0; // AV_PIX_FMT_YUV420Pæ ¼å¼çš„è§†é¢‘å¸§ AVFrame* avframe_yuv420p = av_frame_alloc(); // ç»™ç¼“å†²åŒºè®¾ç½®ç±»å‹ int buffer_size =av_image_get_buffer_size(AV_PIX_FMT_YUV420P,// è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ video_avcodec_context->width,// ä¸€å¸§è§†é¢‘åƒç´ æ•°æ®å®½ = è§†é¢‘å®½ video_avcodec_context->height,// ä¸€å¸§è§†é¢‘åƒç´ æ•°æ®é«˜ = è§†é¢‘é«˜ 1);// å­—èŠ‚å¯¹é½æ–¹å¼ï¼Œé»˜è®¤æ˜¯1 // å¼€è¾Ÿä¸€å—å†…å­˜ç©ºé—´ uint8_t *out_buffer = (uint8_t *)av_malloc(buffer_size); // å‘avframe_yuv420på¡«å……æ•°æ® av_image_fill_arrays(avframe_yuv420p->data,// ç›®æ ‡è§†é¢‘å¸§æ•°æ® avframe_yuv420p->linesize,// ç›®æ ‡è§†é¢‘å¸§è¡Œå¤§å° out_buffer,// åŸå§‹æ•°æ® AV_PIX_FMT_YUV420P,// è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ video_avcodec_context->width,// è§†é¢‘å®½ video_avcodec_context->height,//è§†é¢‘é«˜ 1);// å­—èŠ‚å¯¹é½æ–¹å¼ ç¬¬ä¸ƒæ­¥ï¼šåˆå§‹åŒ–SDLå¤šåª’ä½“æ¡†æ¶ // ç¬¬ä¸ƒæ­¥ï¼šåˆå§‹åŒ–SDLå¤šåª’ä½“æ¡†æ¶ if (SDL_Init( SDL_INIT_VIDEO | SDL_INIT_AUDIO | SDL_INIT_TIMER ) == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); return -1; } ç¬¬å…«æ­¥ï¼šç¼“å­˜é˜Ÿåˆ—åˆå§‹åŒ– // ç¬¬å…«æ­¥ï¼šç¼“å­˜é˜Ÿåˆ—åˆå§‹åŒ– packet_queue_init(&audioq); ç¬¬ä¹æ­¥ï¼šè®¾ç½®éŸ³é¢‘æ’­æ”¾å‚æ•° // ç¬¬ä¹æ­¥ï¼šè®¾ç½®éŸ³é¢‘æ’­æ”¾å‚æ•° // SDL_AudioSpec a structure that contains the audio output formatï¼Œåˆ›å»º SDL_AudioSpec ç»“æ„ä½“ï¼Œè®¾ç½®éŸ³é¢‘æ’­æ”¾æ•°æ® SDL_AudioSpec wanted_spec, spec; // åˆ›å»ºSDL_AudioSpecç»“æ„ä½“ï¼Œè®¾ç½®éŸ³é¢‘æ’­æ”¾å‚æ•° // é‡‡æ ·é¢‘ç‡ DSP frequency -- samples per second wanted_spec.freq = audio_avcodec_context->sample_rate; // é‡‡æ ·æ ¼å¼ Audio data format wanted_spec.format = AUDIO_S16SYS; // å£°é“æ•° Number of channels: 1 mono, 2 stereo wanted_spec.channels = audio_avcodec_context->channels; wanted_spec.silence = 0;// æ— è¾“å‡ºæ—¶æ˜¯å¦é™éŸ³ // é»˜è®¤æ¯æ¬¡è¯»éŸ³é¢‘ç¼“å­˜çš„å¤§å°ï¼Œæ¨èå€¼ä¸º 512~8192ï¼Œffplayä½¿ç”¨çš„æ˜¯1024 wanted_spec.samples = SDL_AUDIO_BUFFER_SIZE; // è®¾ç½®å–éŸ³é¢‘æ•°æ®çš„å›è°ƒæ¥å£å‡½æ•° the function to call when the audio device needs more data wanted_spec.callback = audio_callback; // ä¼ é€’ç”¨æˆ·æ•°æ® wanted_spec.userdata = audio_avcodec_context; ç¬¬åæ­¥ï¼šæ‰“å¼€éŸ³é¢‘è®¾å¤‡ /*-------------------------- * ç¬¬åæ­¥ï¼šæ‰“å¼€éŸ³é¢‘è®¾å¤‡ * ä»¥æŒ‡å®šå‚æ•°æ‰“å¼€éŸ³é¢‘è®¾å¤‡ï¼Œå¹¶è¿”å›ä¸æŒ‡å®šå‚æ•°æœ€ä¸ºæ¥è¿‘çš„å‚æ•°ï¼Œè¯¥å‚æ•°ä¸ºè®¾å¤‡å®é™…æ”¯æŒçš„éŸ³é¢‘å‚æ•° * Opens the audio device with the desired parameters(wanted_spec) * return another specs we actually be using * and not guaranteed to get what we asked for --------------------------*/ if (SDL_OpenAudio(&wanted_spec, &spec) ç¬¬åä¸€æ­¥ï¼šåˆå§‹åŒ–SDLçª—å£ // ç¬¬åä¸€æ­¥ï¼šåˆå§‹åŒ–SDLçª—å£ SDL_Window* sdl_window = SDL_CreateWindow(\"FFmpeg+SDLæ’­æ”¾è§†é¢‘\",// å‚æ•°ä¸€ï¼šçª—å£åç§° SDL_WINDOWPOS_CENTERED,// å‚æ•°äºŒï¼šçª—å£åœ¨å±å¹•ä¸Šçš„xåæ ‡ SDL_WINDOWPOS_CENTERED,// å‚æ•°ä¸‰ï¼šçª—å£åœ¨å±å¹•ä¸Šçš„yåæ ‡ video_avcodec_context->width,// å‚æ•°å››ï¼šçª—å£åœ¨å±å¹•ä¸Šå®½ video_avcodec_context->height,// å‚æ•°äº”ï¼šçª—å£åœ¨å±å¹•ä¸Šé«˜ SDL_WINDOW_OPENGL);// å‚æ•°å…­ï¼šçª—å£çŠ¶æ€(æ‰“å¼€) if (sdl_window == NULL){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"çª—å£åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çª—å£åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } __android_log_print(ANDROID_LOG_INFO, \"main\", \"çª—å£åˆ›å»ºæˆåŠŸï¼Œwidthï¼š%dï¼Œheightï¼š%d\", video_avcodec_context->width, video_avcodec_context->height); ç¬¬åäºŒæ­¥ï¼šåˆ›å»ºæ¸²æŸ“å™¨ // ç¬¬åäºŒæ­¥ï¼šåˆ›å»ºæ¸²æŸ“å™¨ // å®šä¹‰æ¸²æŸ“å™¨åŒºåŸŸ SDL_Rect sdl_rect; SDL_Renderer* sdl_renderer = SDL_CreateRenderer(sdl_window,// æ¸²æŸ“ç›®æ ‡åˆ›å»º -1, // ä»é‚£é‡Œå¼€å§‹æ¸²æŸ“(-1:è¡¨ç¤ºä»ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹) 0);// æ¸²æŸ“ç±»å‹(è½¯ä»¶æ¸²æŸ“) if (sdl_renderer == NULL){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } ç¬¬åä¸‰æ­¥ï¼šåˆ›å»ºçº¹ç† // ç¬¬åä¸‰æ­¥ï¼šåˆ›å»ºçº¹ç† SDL_Texture* sdl_texture = SDL_CreateTexture(sdl_renderer,// æ¸²æŸ“å™¨ SDL_PIXELFORMAT_IYUV,// åƒç´ æ•°æ®æ ¼å¼ SDL_TEXTUREACCESS_STREAMING,// ç»˜åˆ¶æ–¹å¼ï¼šé¢‘ç¹ç»˜åˆ¶- video_avcodec_context->width,// çº¹ç†å®½ video_avcodec_context->height);// çº¹ç†é«˜ if (sdl_texture == NULL) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } ç¬¬åå››æ­¥ï¼šè¯»å–è§†é¢‘å‹ç¼©æ•°æ®å¸§ // ç¬¬åå››æ­¥ï¼šè¯»å–è§†é¢‘å‹ç¼©æ•°æ®å¸§ int video_current_index = 0; // è´Ÿè´£ä¿å­˜å‹ç¼©ç¼–ç æ•°æ®ç›¸å…³ä¿¡æ¯çš„ç»“æ„ä½“,æ¯å¸§å›¾åƒç”±ä¸€åˆ°å¤šä¸ªpacketåŒ…ç»„æˆ AVPacket* packet = (AVPacket*)av_malloc(sizeof(AVPacket)); // ä»æ–‡ä»¶ä¸­ä¾æ¬¡è¯»å–æ¯ä¸ªå›¾åƒç¼–ç æ•°æ®åŒ…ï¼Œå¹¶å­˜å‚¨åœ¨AVPacketæ•°æ®ç»“æ„ä¸­ï¼Œ>=:è¯»å–åˆ°äº†ï¼Œ= 0) { // æ£€æŸ¥æ•°æ®åŒ…ç±»å‹æ˜¯å¦æ˜¯è§†é¢‘æµ if (packet->stream_index == av_video_stream_index) { /*----------------------- * ç¬¬åäº”æ­¥ï¼šè§†é¢‘è§£ç  * è§£ç å®Œæ•´çš„ä¸€å¸§æ•°æ®ï¼Œdecode_resultè¿”å›true * å¯èƒ½æ— æ³•é€šè¿‡åªè§£ç ä¸€ä¸ªpacketå°±è·å¾—ä¸€ä¸ªå®Œæ•´çš„è§†é¢‘å¸§frameï¼Œå¯èƒ½éœ€è¦è¯»å–å¤šä¸ªpacketæ‰è¡Œ * avcodec_receive_frame()ä¼šåœ¨è§£ç åˆ°å®Œæ•´çš„ä¸€å¸§æ—¶ï¼Œdecode_resultä¸ºtrue -----------------------*/ // ... video_current_index++; __android_log_print(ANDROID_LOG_INFO, \"main\", \"å½“å‰è§£ç è§†é¢‘ç¬¬%då¸§\", video_current_index); } // æ£€æŸ¥æ•°æ®åŒ…ç±»å‹æ˜¯å¦æ˜¯éŸ³é¢‘æµ else if (packet->stream_index == av_audio_stream_index) { // ç¬¬äºŒåä¸€æ­¥ï¼šå‘ç¼“å­˜é˜Ÿåˆ—ä¸­å¡«å……ç¼–ç æ•°æ®åŒ… // ... } // å­—å¹•æµç±»å‹æ ‡è¯† else { // é‡Šæ”¾AVPacketæ•°æ®ç»“æ„ä¸­ç¼–ç æ•°æ®æŒ‡é’ˆ av_packet_free(&packet); } /*------------------------ * ç¬¬äºŒåäºŒæ­¥ï¼šè·å–SDLäº‹ä»¶ * åœ¨æ¯æ¬¡å¾ªç¯ä¸­ä»SDLåå°é˜Ÿåˆ—å–äº‹ä»¶å¹¶å¡«å……åˆ°SDL_Eventå¯¹è±¡ä¸­ * SDLçš„äº‹ä»¶ç³»ç»Ÿä½¿å¾—ä½ å¯ä»¥æ¥æ”¶ç”¨æˆ·çš„è¾“å…¥ï¼Œä»è€Œå®Œæˆä¸€äº›æ§åˆ¶æ“ä½œ ------------------------*/ // ... } ç¬¬åäº”æ­¥ï¼šè§†é¢‘è§£ç  /*----------------------- * ç¬¬åäº”æ­¥ï¼šè§†é¢‘è§£ç  * è§£ç å®Œæ•´çš„ä¸€å¸§æ•°æ®ï¼Œdecode_resultè¿”å›true * å¯èƒ½æ— æ³•é€šè¿‡åªè§£ç ä¸€ä¸ªpacketå°±è·å¾—ä¸€ä¸ªå®Œæ•´çš„è§†é¢‘å¸§frameï¼Œå¯èƒ½éœ€è¦è¯»å–å¤šä¸ªpacketæ‰è¡Œ * avcodec_receive_frame()ä¼šåœ¨è§£ç åˆ°å®Œæ•´çš„ä¸€å¸§æ—¶ï¼Œdecode_resultä¸ºtrue -----------------------*/ // å‘é€ä¸€å¸§è§†é¢‘å‹ç¼©æ•°æ® avcodec_send_packet(video_avcodec_context, packet); // è§£ç ä¸€å¸§è§†é¢‘æ•°æ® decode_result = avcodec_receive_frame(video_avcodec_context, avframe_in); if (decode_result == 0) { // è§†é¢‘è§£ç æˆåŠŸ // ç¬¬åå…­æ­¥ï¼šå¼€å§‹ç±»å‹è½¬æ¢ // ... // ç¬¬åä¸ƒæ­¥ï¼šè®¾ç½®çº¹ç†æ•°æ® // ... // ç¬¬åå…«æ­¥ï¼šå°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // ... // ç¬¬åä¹æ­¥ï¼šå‘ˆç°ç”»é¢å¸§ // ... // ç¬¬äºŒåæ­¥ï¼šæ¸²æŸ“æ¯ä¸€å¸§ç›´æ¥é—´éš”æ—¶é—´ // ... } ç¬¬åå…­æ­¥ï¼šå¼€å§‹ç±»å‹è½¬æ¢ // ç¬¬åå…­æ­¥ï¼šå¼€å§‹ç±»å‹è½¬æ¢ // å°†è§£ç å‡ºæ¥çš„è§†é¢‘åƒç´ ç‚¹æ•°æ®æ ¼å¼ç»Ÿä¸€è½¬ç±»å‹ä¸ºyuv420P sws_scale(swscontext,// è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ä¸Šä¸‹æ–‡ (const uint8_t *const *)avframe_in->data,// è¾“å…¥æ•°æ® avframe_in->linesize,// è¾“å…¥ç”»é¢æ¯ä¸€è¡Œå¤§å° 0,// è¾“å…¥ç”»é¢æ¯ä¸€è¡Œå¼€å§‹ä½ç½®(0è¡¨ç¤ºä»åŸç‚¹å¼€å§‹è¯»å–) video_avcodec_context->height,// è¾“å…¥æ•°æ®è¡Œæ•° avframe_yuv420p->data,// è¾“å‡ºæ•°æ® avframe_yuv420p->linesize);// è¾“å‡ºç”»é¢æ¯ä¸€è¡Œå¤§å° ç¬¬åä¸ƒæ­¥ï¼šè®¾ç½®çº¹ç†æ•°æ® // ç¬¬åä¸ƒæ­¥ï¼šè®¾ç½®çº¹ç†æ•°æ® SDL_UpdateTexture(sdl_texture, // çº¹ç† NULL,// æ¸²æŸ“åŒºåŸŸ avframe_yuv420p->data[0],// éœ€è¦æ¸²æŸ“æ•°æ®ï¼šè§†é¢‘åƒç´ æ•°æ®å¸§ avframe_yuv420p->linesize[0]);// å¸§å®½ ç¬¬åå…«æ­¥ï¼šå°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // ç¬¬åå…«æ­¥ï¼šå°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // è®¾ç½®å·¦ä¸Šè§’ä½ç½®(å…¨å±) sdl_rect.x = 100; sdl_rect.y = 100; sdl_rect.w = video_avcodec_context->width; sdl_rect.h = video_avcodec_context->height; SDL_RenderClear(sdl_renderer); SDL_RenderCopy(sdl_renderer, sdl_texture, NULL, &sdl_rect); ç¬¬åä¹æ­¥ï¼šå‘ˆç°ç”»é¢å¸§ // ç¬¬åä¹æ­¥ï¼šå‘ˆç°ç”»é¢å¸§ SDL_RenderPresent(sdl_renderer); ç¬¬äºŒåæ­¥ï¼šæ¸²æŸ“æ¯ä¸€å¸§ç›´æ¥é—´éš”æ—¶é—´ // ç¬¬äºŒåæ­¥ï¼šæ¸²æŸ“æ¯ä¸€å¸§ç›´æ¥é—´éš”æ—¶é—´ SDL_Delay(30); ç¬¬äºŒåä¸€æ­¥ï¼šå‘ç¼“å­˜é˜Ÿåˆ—ä¸­å¡«å……ç¼–ç æ•°æ®åŒ… // ç¬¬äºŒåä¸€æ­¥ï¼šå‘ç¼“å­˜é˜Ÿåˆ—ä¸­å¡«å……ç¼–ç æ•°æ®åŒ… packet_queue_put(&audioq, packet); ç¬¬äºŒåäºŒæ­¥ï¼šè·å–SDLäº‹ä»¶ /*------------------------ * ç¬¬äºŒåäºŒæ­¥ï¼šè·å–SDLäº‹ä»¶ * åœ¨æ¯æ¬¡å¾ªç¯ä¸­ä»SDLåå°é˜Ÿåˆ—å–äº‹ä»¶å¹¶å¡«å……åˆ°SDL_Eventå¯¹è±¡ä¸­ * SDLçš„äº‹ä»¶ç³»ç»Ÿä½¿å¾—ä½ å¯ä»¥æ¥æ”¶ç”¨æˆ·çš„è¾“å…¥ï¼Œä»è€Œå®Œæˆä¸€äº›æ§åˆ¶æ“ä½œ ------------------------*/ SDL_Event event;//SDLäº‹ä»¶å¯¹è±¡ SDL_PollEvent(&event); switch (event.type) {//æ£€æŸ¥SDLäº‹ä»¶å¯¹è±¡ case SDL_QUIT://é€€å‡ºäº‹ä»¶ quit = 1;//é€€å‡ºè¿›ç¨‹æ ‡è¯†ç½®1 SDL_Quit();//é€€å‡ºæ“ä½œ exit(0);//ç»“æŸè¿›ç¨‹ break; default: break; }// end for switch ç¬¬äºŒåä¸‰æ­¥ï¼šé‡Šæ”¾èµ„æºï¼Œé€€å‡ºç¨‹åº // ç¬¬äºŒåä¸‰æ­¥ï¼šé‡Šæ”¾èµ„æºï¼Œé€€å‡ºç¨‹åº av_packet_free(&packet); av_frame_free(&avframe_in); av_frame_free(&avframe_yuv420p); free(out_buffer); avcodec_close(video_avcodec_context); avformat_free_context(avformat_context); SDL_DestroyTexture(sdl_texture); SDL_DestroyRenderer(sdl_renderer); SDL_Quit(); ä¸€ã€Androidå®ç° ç¬¬ä¸€æ­¥ï¼šAndroidé›†æˆSDL å‚è€ƒï¼šhttp://www.1221.site/FFmpeg/08_SDL%E6%92%AD%E6%94%BEYUV.html æ–°å»ºå·¥ç¨‹åç§°ä¸ºAndroidDisplayVideoWhileDecodingï¼ŒæŒ‰ä¸Šé¢æ–‡ç« é…ç½®ï¼Œèƒ½æ­£å¸¸æ’­æ”¾YUVæ–‡ä»¶å°±ç®—æˆåŠŸå®Œæˆäº†ç¬¬ä¸€æ­¥ã€‚ ç¬¬äºŒæ­¥ï¼šAndroidé›†æˆFFmpeg å‚è€ƒï¼šhttp://www.1221.site/FFmpeg/02_FFmpeg%E9%9B%86%E6%88%90.html ç¬¬ä¸‰æ­¥ï¼šä¿®æ”¹native-lib.cpp #include #include #include #include #include \"SDL.h\" #include extern \"C\" { // å¼•å…¥å¤´æ–‡ä»¶ // æ ¸å¿ƒåº“->éŸ³è§†é¢‘ç¼–è§£ç åº“ #include #include \"libavformat/avformat.h\" #include #include } // å®šä¹‰ä¸€ // SDLè¯»éŸ³é¢‘ç¼“å­˜çš„å¤§å° #define SDL_AUDIO_BUFFER_SIZE 1024 #define MAX_AUDIO_FRAME_SIZE 192000 int quit = 0;// å…¨å±€é€€å‡ºè¿›ç¨‹æ ‡è¯†ï¼Œåœ¨ç•Œé¢ä¸Šç‚¹äº†é€€å‡ºåï¼Œå‘Šè¯‰çº¿ç¨‹é€€å‡º // SDLå…¥å£ extern \"C\" int main(int argc, char *argv[]) { // è¾¹è§£ç è¾¹æ’­æ”¾éŸ³è§†é¢‘å®ç° // å¤åˆ¶ä»£ç å®ç° } "},"pages/FFmpeg/FFmpeg_SDLåˆ›å»ºçº¿ç¨‹.html":{"url":"pages/FFmpeg/FFmpeg_SDLåˆ›å»ºçº¿ç¨‹.html","title":"FFmpeg+SDLåˆ›å»ºçº¿ç¨‹","keywords":"","body":"FFmpeg+SDLåˆ›å»ºçº¿ç¨‹ Androidå·¥ç¨‹ä»£ç  ffmpegæ’­æ”¾å™¨å®ç°è¯¦è§£ - åˆ›å»ºçº¿ç¨‹ï¼šhttps://www.cnblogs.com/breakpointlab/p/13508271.html æºä»£ç ä¸€è§ˆ #include #include #include #include #include \"SDL.h\" #include #define SDL_AUDIO_BUFFER_SIZE 1024 #define MAX_AUDIO_FRAME_SIZE 192000 #define MAX_AUDIOQ_SIZE (5 * 16 * 1024) #define MAX_VIDEOQ_SIZE (5 * 256 * 1024) #define FF_ALLOC_EVENT (SDL_USEREVENT) #define FF_REFRESH_EVENT (SDL_USEREVENT + 1) #define FF_QUIT_EVENT (SDL_USEREVENT + 2) #define VIDEO_PICTURE_QUEUE_SIZE 1 extern \"C\" { #include #include \"libavformat/avformat.h\" #include #include #include } /*-------é“¾è¡¨èŠ‚ç‚¹ç»“æ„ä½“-------- typedef struct AVPacketList { AVPacket pkt;//é“¾è¡¨æ•°æ® struct AVPacketList *next;//é“¾è¡¨åç»§èŠ‚ç‚¹ } AVPacketList; ---------------------------*/ // æ•°æ®åŒ…é˜Ÿåˆ—(é“¾è¡¨)ç»“æ„ä½“ typedef struct PacketQueue { AVPacketList *first_pkt, *last_pkt;// é˜Ÿåˆ—é¦–å°¾èŠ‚ç‚¹æŒ‡é’ˆ int nb_packets;// é˜Ÿåˆ—é•¿åº¦ int size;// ä¿å­˜ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ï¼Œsize=packet->size SDL_mutex *qlock;// é˜Ÿåˆ—äº’æ–¥é‡ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® SDL_cond *qready;// é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å˜é‡ } PacketQueue; // å›¾åƒå¸§ç»“æ„ä½“ typedef struct VideoPicture { AVFrame *avframe_yuv420p; int width, height;//Source height & width. int allocated;//æ˜¯å¦åˆ†é…å†…å­˜ç©ºé—´ï¼Œè§†é¢‘å¸§è½¬æ¢ä¸ºSDL overlayæ ‡è¯† } VideoPicture; typedef struct VideoState { AVFormatContext *pFormatCtx;// ä¿å­˜æ–‡ä»¶å®¹å™¨å°è£…ä¿¡æ¯åŠç æµå‚æ•°çš„ç»“æ„ä½“ AVStream *video_st;// è§†é¢‘æµä¿¡æ¯ç»“æ„ä½“ AVStream *audio_st;//éŸ³é¢‘æµä¿¡æ¯ç»“æ„ä½“ struct SwsContext *sws_ctx;// æè¿°è½¬æ¢å™¨å‚æ•°çš„ç»“æ„ä½“ PacketQueue videoq;// è§†é¢‘ç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—(ç¼–ç æ•°æ®é˜Ÿåˆ—ï¼Œä»¥é“¾è¡¨æ–¹å¼å®ç°) VideoPicture pictq[VIDEO_PICTURE_QUEUE_SIZE]; int pictq_size, pictq_rindex, pictq_windex;// é˜Ÿåˆ—é•¿åº¦ï¼Œè¯»/å†™ä½ç½®ç´¢å¼• SDL_mutex *pictq_lock;// é˜Ÿåˆ—è¯»å†™é”å¯¹è±¡ï¼Œä¿æŠ¤å›¾åƒå¸§é˜Ÿåˆ—æ•°æ® SDL_cond *pictq_ready;// é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å˜é‡ SDL_Rect sdl_rect; SDL_Renderer* sdl_renderer; SDL_Texture* sdl_texture; PacketQueue audioq;// éŸ³é¢‘ç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—(ç¼–ç æ•°æ®é˜Ÿåˆ—ï¼Œä»¥é“¾è¡¨æ–¹å¼å®ç°) uint8_t audio_buf[(MAX_AUDIO_FRAME_SIZE*3)/2];//ä¿å­˜è§£ç ä¸€ä¸ªpacketåçš„å¤šå¸§åŸå§‹éŸ³é¢‘æ•°æ®(è§£ç æ•°æ®é˜Ÿåˆ—ï¼Œä»¥æ•°ç»„æ–¹å¼å®ç°) unsigned int audio_buf_size;//è§£ç åçš„å¤šå¸§éŸ³é¢‘æ•°æ®é•¿åº¦ unsigned int audio_buf_index;//ç´¯è®¡å†™å…¥streamçš„é•¿åº¦ uint8_t *audio_pkt_data;//ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆä½ç½® int audio_pkt_size;//ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦(æ˜¯å¦å·²å®Œæˆä¸€ä¸ªå®Œæ•´çš„pakcetåŒ…çš„è§£ç ï¼Œä¸€ä¸ªæ•°æ®åŒ…ä¸­å¯èƒ½åŒ…å«å¤šä¸ªéŸ³é¢‘ç¼–ç å¸§) AVPacket audio_pkt;//ä¿å­˜ä»é˜Ÿåˆ—ä¸­æå–çš„æ•°æ®åŒ… AVFrame audio_frame;//ä¿å­˜ä»æ•°æ®åŒ…ä¸­è§£ç çš„éŸ³é¢‘æ•°æ® int video_width; int video_height; char filename[1024];// è¾“å…¥æ–‡ä»¶å®Œæ•´è·¯å¾„å int videoStream, audioStream;// éŸ³è§†é¢‘æµç±»å‹æ ‡å· SDL_Thread *parse_tid;// ç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹id SDL_Thread *decode_tid;// è§£ç çº¿ç¨‹id int quit;// å…¨å±€é€€å‡ºè¿›ç¨‹æ ‡è¯†ï¼Œåœ¨ç•Œé¢ä¸Šç‚¹äº†é€€å‡ºåï¼Œå‘Šè¯‰çº¿ç¨‹é€€å‡º } VideoState;// Since we only have one decoding thread, the Big Struct can be global in case we need it. VideoState *global_video_state; // å®šæ—¶å™¨è§¦å‘çš„å›è°ƒå‡½æ•° static Uint32 sdl_refresh_timer_cb(Uint32 interval, void *opaque) { SDL_Event event;//SDLäº‹ä»¶å¯¹è±¡ event.type = FF_REFRESH_EVENT;//è§†é¢‘æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶ event.user.data1 = opaque;//ä¼ é€’ç”¨æˆ·æ•°æ® SDL_PushEvent(&event);//å‘é€äº‹ä»¶ return 0; // 0 means stop timer. } /*--------------------------- * Schedule a video refresh in 'delay' ms. * å‘Šè¯‰sdlåœ¨æŒ‡å®šçš„å»¶æ—¶åæ¥æ¨é€ä¸€ä¸ª FF_REFRESH_EVENT äº‹ä»¶ * è¿™ä¸ªäº‹ä»¶å°†åœ¨äº‹ä»¶é˜Ÿåˆ—é‡Œè§¦å‘sdl_refresh_timer_cbå‡½æ•°çš„è°ƒç”¨ --------------------------*/ static void schedule_refresh(VideoState *is, int delay) { SDL_AddTimer(delay, sdl_refresh_timer_cb, is);//åœ¨æŒ‡å®šçš„æ—¶é—´(ms)åå›è°ƒç”¨æˆ·æŒ‡å®šçš„å‡½æ•° } // è§†é¢‘(å›¾åƒ)å¸§æ¸²æŸ“ void video_display(VideoState *is) { SDL_Rect rect;// SDLçŸ©å½¢å¯¹è±¡ VideoPicture *vp;// å›¾åƒå¸§ç»“æ„ä½“æŒ‡é’ˆ vp = &is->pictq[is->pictq_rindex];//ä»å›¾åƒå¸§é˜Ÿåˆ—(æ•°ç»„)ä¸­æå–å›¾åƒå¸§ç»“æ„å¯¹è±¡ if (vp->avframe_yuv420p) {//æ£€æŸ¥åƒç´ æ•°æ®æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆ // è®¾ç½®çº¹ç†æ•°æ® SDL_UpdateTexture(is->sdl_texture, // çº¹ç† NULL,// æ¸²æŸ“åŒºåŸŸ vp->avframe_yuv420p->data[0],// éœ€è¦æ¸²æŸ“æ•°æ®ï¼šè§†é¢‘åƒç´ æ•°æ®å¸§ vp->avframe_yuv420p->linesize[0]);// å¸§å®½ // å°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // è®¾ç½®å·¦ä¸Šè§’ä½ç½®(å…¨å±) is->sdl_rect.x = 100; is->sdl_rect.y = 100; is->sdl_rect.w = vp->width; is->sdl_rect.h = vp->height; SDL_RenderClear(is->sdl_renderer); SDL_RenderCopy(is->sdl_renderer, is->sdl_texture, NULL, &is->sdl_rect); // å‘ˆç°ç”»é¢å¸§ SDL_RenderPresent(is->sdl_renderer); }// end for if }// end for video_display // æ˜¾ç¤ºåˆ·æ–°å‡½æ•°(FF_REFRESH_EVENTå“åº”å‡½æ•°) void video_refresh_timer(void *userdata) { VideoState *is = (VideoState *)userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® // vp is used in later tutorials for synchronization. if (is->video_st) { if (is->pictq_size == 0) {// æ£€æŸ¥å›¾åƒå¸§é˜Ÿåˆ—æ˜¯å¦æœ‰å¾…æ˜¾ç¤ºå›¾åƒ schedule_refresh(is, 1); } else {// åˆ·æ–°å›¾åƒ /*------------------------- * Now, normally here goes a ton of code about timing, etc. * we're just going to guess at a delay for now. * You can increase and decrease this value and hard code the timing * but I don't suggest that ;) We'll learn how to do it for real later.. ------------------------*/ schedule_refresh(is, 40);// è®¾ç½®æ˜¾ç¤ºä¸‹ä¸€å¸§å›¾åƒçš„åˆ·æ–°æ—¶é—´ï¼Œé€šè¿‡å®šæ—¶å™¨timeræ–¹å¼è§¦å‘ // Show the picture! video_display(is);// å›¾åƒå¸§æ¸²æŸ“ // Update queue for next picture! if (++is->pictq_rindex == VIDEO_PICTURE_QUEUE_SIZE) {// æ›´æ–°å¹¶æ£€æŸ¥å›¾åƒå¸§é˜Ÿåˆ—è¯»ä½ç½®ç´¢å¼• is->pictq_rindex = 0;// é‡ç½®è¯»ä½ç½®ç´¢å¼• } SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤ç”»å¸ƒçš„åƒç´ æ•°æ® is->pictq_size--;// æ›´æ–°å›¾åƒå¸§é˜Ÿåˆ—é•¿åº¦ SDL_CondSignal(is->pictq_ready);// å‘é€é˜Ÿåˆ—å°±ç»ªä¿¡å· SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ } } else { schedule_refresh(is, 100); } } // æ•°æ®åŒ…é˜Ÿåˆ—åˆå§‹åŒ–å‡½æ•° void packet_queue_init(PacketQueue *q) { memset(q, 0, sizeof(PacketQueue));// å…¨é›¶åˆå§‹åŒ–é˜Ÿåˆ—ç»“æ„ä½“å¯¹è±¡ q->qlock = SDL_CreateMutex();// åˆ›å»ºäº’æ–¥é‡å¯¹è±¡ q->qready = SDL_CreateCond();// åˆ›å»ºæ¡ä»¶å˜é‡å¯¹è±¡ } // å‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… int packet_queue_put(PacketQueue *q, AVPacket *pkt) { /*-------å‡†å¤‡é˜Ÿåˆ—(é“¾è¡¨)èŠ‚ç‚¹å¯¹è±¡------*/ AVPacketList *pktlist=(AVPacketList *)av_malloc(sizeof(AVPacketList));// åœ¨å †ä¸Šåˆ›å»ºé“¾è¡¨èŠ‚ç‚¹å¯¹è±¡ if (!pktlist) {// æ£€æŸ¥é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡æ˜¯å¦åˆ›å»ºæˆåŠŸ return -1; } pktlist->pkt = *pkt;// å°†è¾“å…¥æ•°æ®åŒ…èµ‹å€¼ç»™æ–°å»ºé“¾è¡¨èŠ‚ç‚¹å¯¹è±¡ä¸­çš„æ•°æ®åŒ…å¯¹è±¡ pktlist->next = NULL;// é“¾è¡¨åç»§æŒ‡é’ˆä¸ºç©º // if (av_packet_ref(pkt, pkt) qlock);// é˜Ÿåˆ—äº’æ–¥é‡åŠ é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® if (!q->last_pkt) {// æ£€æŸ¥é˜Ÿåˆ—å°¾èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨(æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º) q->first_pkt = pktlist;// è‹¥ä¸å­˜åœ¨(é˜Ÿåˆ—å°¾ç©º)ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹ä½œé˜Ÿåˆ—ä¸ºé¦–èŠ‚ç‚¹ } else { q->last_pkt->next = pktlist;// è‹¥å·²å­˜åœ¨å°¾èŠ‚ç‚¹ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹æŒ‚åˆ°å°¾èŠ‚ç‚¹çš„åç»§æŒ‡é’ˆä¸Šï¼Œå¹¶ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ } q->last_pkt = pktlist;// å°†å½“å‰èŠ‚ç‚¹ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ q->nb_packets++;// é˜Ÿåˆ—é•¿åº¦+1 q->size += pktlist->pkt.size;// æ›´æ–°é˜Ÿåˆ—ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ SDL_CondSignal(q->qready);// ç»™ç­‰å¾…çº¿ç¨‹å‘å‡ºæ¶ˆæ¯ï¼Œé€šçŸ¥é˜Ÿåˆ—å·²å°±ç»ª SDL_UnlockMutex(q->qlock);// é‡Šæ”¾äº’æ–¥é‡ return 0; } // ä»é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ï¼Œå¹¶å°†æå–çš„æ•°æ®åŒ…å‡ºé˜Ÿåˆ— static int packet_queue_get(PacketQueue *q, AVPacket *pkt, int block) { AVPacketList *pktlist;// ä¸´æ—¶é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡æŒ‡é’ˆ int ret;// æ“ä½œç»“æœ SDL_LockMutex(q->qlock);// é˜Ÿåˆ—äº’æ–¥é‡åŠ é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® for (;;) { if (global_video_state->quit) {// æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† ret = -1;// æ“ä½œå¤±è´¥ break; }//end for if pktlist = q->first_pkt;// ä¼ é€’å°†é˜Ÿåˆ—é¦–ä¸ªæ•°æ®åŒ…æŒ‡é’ˆ if (pktlist) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºç©º(é˜Ÿåˆ—æ˜¯å¦æœ‰æ•°æ®) q->first_pkt = pktlist->next;// é˜Ÿåˆ—é¦–èŠ‚ç‚¹æŒ‡é’ˆåç§» if (!q->first_pkt) {// æ£€æŸ¥é¦–èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ q->last_pkt = NULL;// è‹¥ä¸å­˜åœ¨ï¼Œåˆ™å°†å°¾èŠ‚ç‚¹æŒ‡é’ˆç½®ç©º } q->nb_packets--;// é˜Ÿåˆ—é•¿åº¦-1 q->size -= pktlist->pkt.size;// æ›´æ–°é˜Ÿåˆ—ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ *pkt = pktlist->pkt;// å°†é˜Ÿåˆ—é¦–èŠ‚ç‚¹æ•°æ®è¿”å› av_free(pktlist);// æ¸…ç©ºä¸´æ—¶èŠ‚ç‚¹æ•°æ®(æ¸…ç©ºé¦–èŠ‚ç‚¹æ•°æ®ï¼Œé¦–èŠ‚ç‚¹å‡ºé˜Ÿåˆ—) ret = 1;// æ“ä½œæˆåŠŸ break; } else if (!block) { ret = 0; break; } else {// é˜Ÿåˆ—å¤„äºæœªå°±ç»ªçŠ¶æ€ï¼Œæ­¤æ—¶é€šè¿‡SDL_CondWaitå‡½æ•°ç­‰å¾…qreadyå°±ç»ªä¿¡å·ï¼Œå¹¶æš‚æ—¶å¯¹äº’æ–¥é‡è§£é” /*--------------------- * ç­‰å¾…é˜Ÿåˆ—å°±ç»ªä¿¡å·qreadyï¼Œå¹¶å¯¹äº’æ–¥é‡æš‚æ—¶è§£é” * æ­¤æ—¶çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œå¹¶ç½®äºç­‰å¾…æ¡ä»¶å°±ç»ªçš„çº¿ç¨‹åˆ—è¡¨ä¸Š * ä½¿å¾—è¯¥çº¿ç¨‹åªåœ¨ä¸´ç•ŒåŒºèµ„æºå°±ç»ªåæ‰è¢«å”¤é†’ï¼Œè€Œä¸è‡³äºçº¿ç¨‹è¢«é¢‘ç¹åˆ‡æ¢ * è¯¥å‡½æ•°è¿”å›æ—¶ï¼Œäº’æ–¥é‡å†æ¬¡è¢«é”ä½ï¼Œå¹¶æ‰§è¡Œåç»­æ“ä½œ --------------------*/ SDL_CondWait(q->qready, q->qlock);// æš‚æ—¶è§£é”äº’æ–¥é‡å¹¶å°†è‡ªå·±é˜»å¡ï¼Œç­‰å¾…ä¸´ç•ŒåŒºèµ„æºå°±ç»ª(ç­‰å¾…SDL_CondSignalå‘å‡ºä¸´ç•ŒåŒºèµ„æºå°±ç»ªçš„ä¿¡å·) } }//end for for-loop SDL_UnlockMutex(q->qlock);// é‡Šæ”¾äº’æ–¥é‡ return ret; } // åˆ›å»º/é‡ç½®å›¾åƒå¸§ï¼Œä¸ºå›¾åƒå¸§åˆ†é…å†…å­˜ç©ºé—´ void alloc_picture(void *userdata) { VideoState *is = (VideoState *)userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® VideoPicture *vp=&is->pictq[is->pictq_windex];// ä»å›¾åƒå¸§é˜Ÿåˆ—(æ•°ç»„)ä¸­æå–å›¾åƒå¸§ç»“æ„å¯¹è±¡ if (vp->avframe_yuv420p) {// æ£€æŸ¥å›¾åƒå¸§æ˜¯å¦å·²å­˜åœ¨ // We already have one make another, bigger/smaller. av_frame_free(&vp->avframe_yuv420p); } vp->width = is->video_st->codec->width;// è®¾ç½®å›¾åƒå¸§å®½åº¦ vp->height = is->video_st->codec->height;// è®¾ç½®å›¾åƒå¸§é«˜åº¦ SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤ç”»å¸ƒçš„åƒç´ æ•°æ® vp->allocated = 1;// å›¾åƒå¸§åƒç´ ç¼“å†²åŒºå·²åˆ†é…å†…å­˜ // AV_PIX_FMT_YUV420Pæ ¼å¼çš„è§†é¢‘å¸§ vp->avframe_yuv420p = av_frame_alloc(); // ç»™ç¼“å†²åŒºè®¾ç½®ç±»å‹ int buffer_size =av_image_get_buffer_size(AV_PIX_FMT_YUV420P,// è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ is->video_st->codec->width,// ä¸€å¸§è§†é¢‘åƒç´ æ•°æ®å®½ = è§†é¢‘å®½ is->video_st->codec->height,// ä¸€å¸§è§†é¢‘åƒç´ æ•°æ®é«˜ = è§†é¢‘é«˜ 1);// å­—èŠ‚å¯¹é½æ–¹å¼ï¼Œé»˜è®¤æ˜¯1 // å¼€è¾Ÿä¸€å—å†…å­˜ç©ºé—´ uint8_t *out_buffer = (uint8_t *)av_malloc(buffer_size); // å‘avframe_yuv420på¡«å……æ•°æ® av_image_fill_arrays(vp->avframe_yuv420p->data,// ç›®æ ‡è§†é¢‘å¸§æ•°æ® vp->avframe_yuv420p->linesize,// ç›®æ ‡è§†é¢‘å¸§è¡Œå¤§å° out_buffer,// åŸå§‹æ•°æ® AV_PIX_FMT_YUV420P,// è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ is->video_st->codec->width,// è§†é¢‘å®½ is->video_st->codec->height,//è§†é¢‘é«˜ 1);// å­—èŠ‚å¯¹é½æ–¹å¼ SDL_CondSignal(is->pictq_ready);// ç»™ç­‰å¾…çº¿ç¨‹å‘å‡ºæ¶ˆæ¯ï¼Œé€šçŸ¥é˜Ÿåˆ—å·²å°±ç»ª SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ } /*--------------------------- * queue_pictureï¼šå›¾åƒå¸§æ’å…¥é˜Ÿåˆ—ç­‰å¾…æ¸²æŸ“ * @isï¼šå…¨å±€çŠ¶æ€å‚æ•°é›† * @pFrameï¼šä¿å­˜å›¾åƒè§£ç æ•°æ®çš„ç»“æ„ä½“ * 1ã€é¦–å…ˆæ£€æŸ¥å›¾åƒå¸§é˜Ÿåˆ—(æ•°ç»„)æ˜¯å¦å­˜åœ¨ç©ºé—´æ’å…¥æ–°çš„å›¾åƒï¼Œè‹¥æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ’å…¥å›¾åƒåˆ™ä½¿å½“å‰çº¿ç¨‹ä¼‘çœ ç­‰å¾… * 2ã€åœ¨åˆå§‹åŒ–çš„æ¡ä»¶ä¸‹ï¼Œé˜Ÿåˆ—(æ•°ç»„)ä¸­VideoPictureçš„bmpå¯¹è±¡(YUV overlay)å°šæœªåˆ†é…ç©ºé—´ï¼Œé€šè¿‡FF_ALLOC_EVENTäº‹ä»¶çš„æ–¹æ³•è°ƒç”¨alloc_pictureåˆ†é…ç©ºé—´ * 3ã€å½“é˜Ÿåˆ—(æ•°ç»„)ä¸­æ‰€æœ‰VideoPictureçš„bmpå¯¹è±¡(YUV overlay)å‡å·²åˆ†é…ç©ºé—´çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è·³è¿‡æ­¥éª¤2å‘bmpå¯¹è±¡æ‹·è´åƒç´ æ•°æ®ï¼Œåƒç´ æ•°æ®åœ¨è¿›è¡Œæ ¼å¼è½¬æ¢åæ‰§è¡Œæ‹·è´æ“ä½œ ---------------------------*/ int queue_picture(VideoState *is, AVFrame *pFrame) { /*--------1ã€æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦æœ‰æ’å…¥ç©ºé—´-------*/ // Wait until we have space for a new pic. SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤å›¾åƒå¸§é˜Ÿåˆ— while (is->pictq_size >= VIDEO_PICTURE_QUEUE_SIZE && !is->quit) {// æ£€æŸ¥é˜Ÿåˆ—å½“å‰é•¿åº¦ SDL_CondWait(is->pictq_ready, is->pictq_lock);// çº¿ç¨‹ä¼‘çœ ç­‰å¾…pictq_readyä¿¡å· } SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ if (is->quit) {// æ£€æŸ¥è¿›ç¨‹é€€å‡ºæ ‡è¯† return -1; } /*-------2ã€åˆå§‹åŒ–/é‡ç½®YUV overlay-------*/ // windex is set to 0 initially. VideoPicture *vp=&is->pictq[is->pictq_windex];// ä»å›¾åƒå¸§é˜Ÿåˆ—ä¸­æŠ½å–å›¾åƒå¸§å¯¹è±¡ // Allocate or resize the bufferï¼Œæ£€æŸ¥YUV overlayæ˜¯å¦å·²å­˜åœ¨ï¼Œå¦åˆ™åˆå§‹åŒ–YUV overlayï¼Œåˆ†é…åƒç´ ç¼“å­˜ç©ºé—´ if (!vp->avframe_yuv420p || vp->width!=is->video_st->codec->width || vp->height!=is->video_st->codec->height) { vp->allocated = 0;// å›¾åƒå¸§æœªåˆ†é…ç©ºé—´ // We have to do it in the main thread. SDL_Event event;// SDLäº‹ä»¶å¯¹è±¡ event.type = FF_ALLOC_EVENT;//æŒ‡å®šåˆ†é…å›¾åƒå¸§å†…å­˜äº‹ä»¶ event.user.data1 = is;//ä¼ é€’ç”¨æˆ·æ•°æ® SDL_PushEvent(&event);//å‘é€SDLäº‹ä»¶ // Wait until we have a picture allocated. SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤å›¾åƒå¸§é˜Ÿåˆ— while (!vp->allocated && !is->quit) {// æ£€æŸ¥å½“å‰å›¾åƒå¸§æ˜¯å¦å·²åˆå§‹åŒ– SDL_CondWait(is->pictq_ready, is->pictq_lock);// çº¿ç¨‹ä¼‘çœ ç­‰å¾…alloc_pictureå‘é€pictq_readyä¿¡å·å”¤é†’å½“å‰çº¿ç¨‹ } SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ if (is->quit) {// æ£€æŸ¥è¿›ç¨‹é€€å‡ºæ ‡è¯† return -1; } }// end for if /*--------3ã€æ‹·è´è§†é¢‘å¸§åˆ°YUV overlay-------*/ // We have a place to put our picture on the queue. if (vp->avframe_yuv420p) {//æ£€æŸ¥åƒç´ æ•°æ®æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆ // Convert the image into YUV format that SDL usesï¼Œå°†è§£ç åçš„å›¾åƒå¸§è½¬æ¢ä¸ºAV_PIX_FMT_YUV420Pæ ¼å¼ï¼Œå¹¶æ‹·è´åˆ°å›¾åƒå¸§é˜Ÿåˆ— sws_scale(is->sws_ctx, (uint8_t const * const *)pFrame->data, pFrame->linesize, 0, is->video_st->codec->height, vp->avframe_yuv420p->data, vp->avframe_yuv420p->linesize); // Now we inform our display thread that we have a pic ready. if (++is->pictq_windex == VIDEO_PICTURE_QUEUE_SIZE) {//æ›´æ–°å¹¶æ£€æŸ¥å½“å‰å›¾åƒå¸§é˜Ÿåˆ—å†™å…¥ä½ç½® is->pictq_windex = 0;//é‡ç½®å›¾åƒå¸§é˜Ÿåˆ—å†™å…¥ä½ç½® } SDL_LockMutex(is->pictq_lock);//é”å®šé˜Ÿåˆ—è¯»å†™é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® is->pictq_size++;//æ›´æ–°å›¾åƒå¸§é˜Ÿåˆ—é•¿åº¦ SDL_UnlockMutex(is->pictq_lock);//é‡Šæ”¾é˜Ÿåˆ—è¯»å†™é” }// end for if return 0; } int video_current_index = 0; // è§†é¢‘è§£ç çº¿ç¨‹å‡½æ•° int decode_thread(void *arg) { VideoState *is = (VideoState *) arg;// ä¼ é€’ç”¨æˆ·æ•°æ® AVPacket pkt, *packet = &pkt;// åœ¨æ ˆä¸Šåˆ›å»ºä¸´æ—¶æ•°æ®åŒ…å¯¹è±¡å¹¶å…³è”æŒ‡é’ˆ int frameFinished;// è§£ç æ“ä½œæ˜¯å¦æˆåŠŸæ ‡è¯† // Allocate video frameï¼Œä¸ºè§£ç åçš„è§†é¢‘ä¿¡æ¯ç»“æ„ä½“åˆ†é…ç©ºé—´å¹¶å®Œæˆåˆå§‹åŒ–æ“ä½œ(ç»“æ„ä½“ä¸­çš„å›¾åƒç¼“å­˜æŒ‰ç…§ä¸‹é¢ä¸¤æ­¥æ‰‹åŠ¨å®‰è£…) AVFrame *pFrame = av_frame_alloc(); for (;;) { if (packet_queue_get(&is->videoq,packet,1)video_st->codec, pFrame, &frameFinished, packet); // Did we get a video frameï¼Œæ£€æŸ¥æ˜¯å¦è§£ç å‡ºå®Œæ•´ä¸€å¸§å›¾åƒ if (frameFinished) { if (queue_picture(is, pFrame)audio_pkt;// ä¿å­˜ä»é˜Ÿåˆ—ä¸­æå–çš„æ•°æ®åŒ… for (;;) { while (is->audio_pkt_size>0) {// æ£€æŸ¥ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦(æ˜¯å¦å·²å®Œæˆä¸€ä¸ªå®Œæ•´çš„pakcetåŒ…çš„è§£ç ï¼Œä¸€ä¸ªæ•°æ®åŒ…ä¸­å¯èƒ½åŒ…å«å¤šä¸ªéŸ³é¢‘ç¼–ç å¸§) int got_frame = 0;// è§£ç æ“ä½œæˆåŠŸæ ‡è¯†ï¼ŒæˆåŠŸè¿”å›éé›¶å€¼ // è§£ç ä¸€å¸§éŸ³é¢‘æ•°æ®ï¼Œå¹¶è¿”å›æ¶ˆè€—çš„ç¼–ç æ•°æ®é•¿åº¦ coded_consumed_size = avcodec_decode_audio4(is->audio_st->codec, &is->audio_frame, &got_frame, pkt); if (coded_consumed_size audio_pkt_size = 0;// æ›´æ–°ç¼–ç æ•°æ®ç¼“å­˜é•¿åº¦ break; } if (got_frame) {// æ£€æŸ¥è§£ç æ“ä½œæ˜¯å¦æˆåŠŸ // è®¡ç®—è§£ç åéŸ³é¢‘æ•°æ®é•¿åº¦[output] data_size = av_samples_get_buffer_size(NULL, is->audio_st->codec->channels, is->audio_frame.nb_samples, is->audio_st->codec->sample_fmt, 1); memcpy(is->audio_buf, is->audio_frame.data[0], data_size);// å°†è§£ç æ•°æ®å¤åˆ¶åˆ°è¾“å‡ºç¼“å­˜ } is->audio_pkt_data += coded_consumed_size;// æ›´æ–°ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆä½ç½® is->audio_pkt_size -= coded_consumed_size;// æ›´æ–°ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦ if (data_size data) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦å·²ä»é˜Ÿåˆ—ä¸­æå– av_packet_unref(pkt);// é‡Šæ”¾pktä¸­ä¿å­˜çš„ç¼–ç æ•°æ® } if (is->quit) {// æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† return -1; } // Next packetï¼Œä»é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…åˆ°pkt if (packet_queue_get(&is->audioq, pkt, 1) audio_pkt_data = pkt->data;// ä¼ é€’ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆ is->audio_pkt_size = pkt->size;// ä¼ é€’ç¼–ç æ•°æ®ç¼“å­˜é•¿åº¦ } } /*------Audio Callback------- * éŸ³é¢‘è¾“å‡ºå›è°ƒå‡½æ•°ï¼Œsdlé€šè¿‡è¯¥å›è°ƒå‡½æ•°å°†è§£ç åçš„pcmæ•°æ®é€å…¥å£°å¡æ’­æ”¾, * sdlé€šå¸¸ä¸€æ¬¡ä¼šå‡†å¤‡ä¸€ç»„ç¼“å­˜pcmæ•°æ®ï¼Œé€šè¿‡è¯¥å›è°ƒé€å…¥å£°å¡ï¼Œå£°å¡æ ¹æ®éŸ³é¢‘ptsä¾æ¬¡æ’­æ”¾pcmæ•°æ® * å¾…é€å…¥ç¼“å­˜çš„pcmæ•°æ®å®Œæˆæ’­æ”¾åï¼Œå†è½½å…¥ä¸€ç»„æ–°çš„pcmç¼“å­˜æ•°æ®(æ¯æ¬¡éŸ³é¢‘è¾“å‡ºç¼“å­˜ä¸ºç©ºæ—¶ï¼Œsdlå°±è°ƒç”¨æ­¤å‡½æ•°å¡«å……éŸ³é¢‘è¾“å‡ºç¼“å­˜ï¼Œå¹¶é€å…¥å£°å¡æ’­æ”¾) * When we begin playing audio, SDL will continually call this callback function * and ask it to fill the audio buffer with a certain number of bytes * The audio function callback takes the following parameters: * stream: A pointer to the audio buffer to be filledï¼Œè¾“å‡ºéŸ³é¢‘æ•°æ®åˆ°å£°å¡ç¼“å­˜ * len: The length (in bytes) of the audio buffer,ç¼“å­˜é•¿åº¦wanted_spec.samples=SDL_AUDIO_BUFFER_SIZE(1024) --------------------------*/ void audio_callback(void *userdata, Uint8 *stream, int len) { VideoState *is = (VideoState *) userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® int wt_stream_len, audio_size;// æ¯æ¬¡å†™å…¥streamçš„æ•°æ®é•¿åº¦ï¼Œè§£ç åçš„æ•°æ®é•¿åº¦ while (len > 0) {//æ£€æŸ¥éŸ³é¢‘ç¼“å­˜çš„å‰©ä½™é•¿åº¦ if (is->audio_buf_index >= is->audio_buf_size) {// æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰§è¡Œè§£ç æ“ä½œ // We have already sent all our data; get moreï¼Œä»ç¼“å­˜é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ã€è§£ç ï¼Œå¹¶è¿”å›è§£ç åçš„æ•°æ®é•¿åº¦ï¼Œaudio_bufç¼“å­˜ä¸­å¯èƒ½åŒ…å«å¤šå¸§è§£ç åçš„éŸ³é¢‘æ•°æ® audio_size = audio_decode_frame(is); if (audio_size audio_buf_size = 1024; memset(is->audio_buf, 0, is->audio_buf_size);// å…¨é›¶é‡ç½®ç¼“å†²åŒº } else { is->audio_buf_size = audio_size;// è¿”å›packetä¸­åŒ…å«çš„åŸå§‹éŸ³é¢‘æ•°æ®é•¿åº¦(å¤šå¸§) } is->audio_buf_index = 0;// åˆå§‹åŒ–ç´¯è®¡å†™å…¥ç¼“å­˜é•¿åº¦ }//end for if wt_stream_len=is->audio_buf_size-is->audio_buf_index;// è®¡ç®—è§£ç ç¼“å­˜å‰©ä½™é•¿åº¦ if (wt_stream_len > len) {// æ£€æŸ¥æ¯æ¬¡å†™å…¥ç¼“å­˜çš„æ•°æ®é•¿åº¦æ˜¯å¦è¶…è¿‡æŒ‡å®šé•¿åº¦(1024) wt_stream_len = len;// æŒ‡å®šé•¿åº¦ä»è§£ç çš„ç¼“å­˜ä¸­å–æ•°æ® } // æ¯æ¬¡ä»è§£ç çš„ç¼“å­˜æ•°æ®ä¸­ä»¥æŒ‡å®šé•¿åº¦æŠ½å–æ•°æ®å¹¶å†™å…¥streamä¼ é€’ç»™å£°å¡ memcpy(stream, (uint8_t *)is->audio_buf + is->audio_buf_index, wt_stream_len); len -= wt_stream_len;// æ›´æ–°è§£ç éŸ³é¢‘ç¼“å­˜çš„å‰©ä½™é•¿åº¦ stream += wt_stream_len;// æ›´æ–°ç¼“å­˜å†™å…¥ä½ç½® is->audio_buf_index += wt_stream_len;// æ›´æ–°ç´¯è®¡å†™å…¥ç¼“å­˜æ•°æ®é•¿åº¦ }//end for while } // æ ¹æ®æŒ‡å®šç±»å‹æ‰“å¼€æµï¼Œæ‰¾åˆ°å¯¹åº”çš„è§£ç å™¨ã€åˆ›å»ºå¯¹åº”çš„éŸ³é¢‘é…ç½®ã€ä¿å­˜å…³é”®ä¿¡æ¯åˆ° VideoStateã€å¯åŠ¨éŸ³é¢‘å’Œè§†é¢‘çº¿ç¨‹ int stream_component_open(VideoState *is, int stream_index) { AVFormatContext *pFormatCtx = is->pFormatCtx;// ä¼ é€’æ–‡ä»¶å®¹å™¨çš„å°è£…ä¿¡æ¯åŠç æµå‚æ•° AVCodecContext *codecCtx = NULL;// è§£ç å™¨ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œè§£ç å™¨ä¾èµ–çš„ç›¸å…³ç¯å¢ƒã€çŠ¶æ€ã€èµ„æºä»¥åŠå‚æ•°é›†çš„æ¥å£æŒ‡é’ˆ AVCodec *codec = NULL;// ä¿å­˜ç¼–è§£ç å™¨ä¿¡æ¯çš„ç»“æ„ä½“ï¼Œæä¾›ç¼–ç ä¸è§£ç çš„å…¬å…±æ¥å£ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ç¼–ç å™¨ä¸è§£ç å™¨çš„ä¸€ä¸ªå…¨å±€å˜é‡ //æ£€æŸ¥è¾“å…¥çš„æµç±»å‹æ˜¯å¦åœ¨åˆç†èŒƒå›´å†… if (stream_index = pFormatCtx->nb_streams) { return -1; } // Get a pointer to the codec context for the video stream. codecCtx = pFormatCtx->streams[stream_index]->codec;// å–å¾—è§£ç å™¨ä¸Šä¸‹æ–‡ if (codecCtx->codec_type == AVMEDIA_TYPE_AUDIO) {//æ£€æŸ¥è§£ç å™¨ç±»å‹æ˜¯å¦ä¸ºéŸ³é¢‘è§£ç å™¨ SDL_AudioSpec wanted_spec, spec;//SDL_AudioSpec a structure that contains the audio output formatï¼Œåˆ›å»º SDL_AudioSpec ç»“æ„ä½“ï¼Œè®¾ç½®éŸ³é¢‘æ’­æ”¾æ•°æ® // Set audio settings from codec info,SDL_AudioSpec a structure that contains the audio output format // åˆ›å»ºSDL_AudioSpecç»“æ„ä½“ï¼Œè®¾ç½®éŸ³é¢‘æ’­æ”¾å‚æ•° wanted_spec.freq = codecCtx->sample_rate;//é‡‡æ ·é¢‘ç‡ DSP frequency -- samples per second wanted_spec.format = AUDIO_S16SYS;//é‡‡æ ·æ ¼å¼ Audio data format wanted_spec.channels = codecCtx->channels;//å£°é“æ•° Number of channels: 1 mono, 2 stereo wanted_spec.silence = 0;//æ— è¾“å‡ºæ—¶æ˜¯å¦é™éŸ³ //é»˜è®¤æ¯æ¬¡è¯»éŸ³é¢‘ç¼“å­˜çš„å¤§å°ï¼Œæ¨èå€¼ä¸º 512~8192ï¼Œffplayä½¿ç”¨çš„æ˜¯1024 specifies a unit of audio data refers to the size of the audio buffer in sample frames wanted_spec.samples = SDL_AUDIO_BUFFER_SIZE; wanted_spec.callback = audio_callback;//è®¾ç½®è¯»å–éŸ³é¢‘æ•°æ®çš„å›è°ƒæ¥å£å‡½æ•° the function to call when the audio device needs more data wanted_spec.userdata = is;//ä¼ é€’ç”¨æˆ·æ•°æ® /*--------------------------- * ä»¥æŒ‡å®šå‚æ•°æ‰“å¼€éŸ³é¢‘è®¾å¤‡ï¼Œå¹¶è¿”å›ä¸æŒ‡å®šå‚æ•°æœ€ä¸ºæ¥è¿‘çš„å‚æ•°ï¼Œè¯¥å‚æ•°ä¸ºè®¾å¤‡å®é™…æ”¯æŒçš„éŸ³é¢‘å‚æ•° * Opens the audio device with the desired parameters(wanted_spec) * return another specs we actually be using * and not guaranteed to get what we asked for --------------------------*/ if (SDL_OpenAudio(&wanted_spec, &spec) codec_id); AVDictionary *optionsDict = NULL; if (!codec || (avcodec_open2(codecCtx, codec, &optionsDict) name); // æ£€æŸ¥è§£ç å™¨ç±»å‹ switch(codecCtx->codec_type) { case AVMEDIA_TYPE_AUDIO:// éŸ³é¢‘è§£ç å™¨ is->audioStream = stream_index;// éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ– is->audio_st = pFormatCtx->streams[stream_index]; is->audio_buf_size = 0;// è§£ç åçš„å¤šå¸§éŸ³é¢‘æ•°æ®é•¿åº¦ is->audio_buf_index = 0;//ç´¯ è®¡å†™å…¥streamçš„é•¿åº¦ memset(&is->audio_pkt, 0, sizeof(is->audio_pkt)); packet_queue_init(&is->audioq);// éŸ³é¢‘æ•°æ®åŒ…é˜Ÿåˆ—åˆå§‹åŒ– SDL_PauseAudio(0);// audio callback starts running againï¼Œå¼€å¯éŸ³é¢‘è®¾å¤‡ï¼Œå¦‚æœè¿™æ—¶å€™æ²¡æœ‰è·å¾—æ•°æ®é‚£ä¹ˆå®ƒå°±é™éŸ³ break; case AVMEDIA_TYPE_VIDEO:// è§†é¢‘è§£ç å™¨ is->videoStream = stream_index;// è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ– is->video_st = pFormatCtx->streams[stream_index]; packet_queue_init(&is->videoq);// è§†é¢‘æ•°æ®åŒ…é˜Ÿåˆ—åˆå§‹åŒ– is->decode_tid = SDL_CreateThread(decode_thread,\"è§†é¢‘è§£ç çº¿ç¨‹\" ,is);// åˆ›å»ºè§†é¢‘è§£ç çº¿ç¨‹ // Initialize SWS context for software scalingï¼Œè®¾ç½®å›¾åƒè½¬æ¢åƒç´ æ ¼å¼ä¸ºAV_PIX_FMT_YUV420P is->sws_ctx = sws_getContext(is->video_st->codec->width, is->video_st->codec->height, is->video_st->codec->pix_fmt, is->video_st->codec->width, is->video_st->codec->height, AV_PIX_FMT_YUV420P, SWS_BILINEAR, NULL, NULL, NULL); break; default: break; } return 0; } // ç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹å‡½æ•°(ä»è§†é¢‘æ–‡ä»¶ä¸­è§£æå‡ºéŸ³è§†é¢‘ç¼–ç æ•°æ®å•å…ƒï¼Œä¸€ä¸ªAVPacketçš„dataé€šå¸¸å¯¹åº”ä¸€ä¸ªNAL) int parse_thread(void *arg) { VideoState *is = (VideoState *)arg;// ä¼ é€’ç”¨æˆ·å‚æ•° global_video_state = is;// ä¼ é€’å…¨å±€çŠ¶æ€å‚é‡ç»“æ„ä½“ /*------------------------- * æ‰“å¼€å°è£…æ ¼å¼ * æ‰“å¼€è§†é¢‘æ–‡ä»¶ï¼Œè¯»æ–‡ä»¶å¤´å†…å®¹ï¼Œå–å¾—æ–‡ä»¶å®¹å™¨çš„å°è£…ä¿¡æ¯åŠç æµå‚æ•°å¹¶å­˜å‚¨åœ¨avformat_contextä¸­ * å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ * å‚æ•°äºŒï¼šè§†é¢‘è·¯å¾„ * å‚æ•°ä¸‰ï¼šæŒ‡å®šè¾“å…¥çš„æ ¼å¼ * å‚æ•°å››ï¼šè®¾ç½®é»˜è®¤å‚æ•° --------------------------*/ AVFormatContext *avformat_context = NULL;// å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ int avformat_open_input_result = avformat_open_input(&avformat_context, is->filename, NULL, NULL); if (avformat_open_input_result != 0){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æŸ¥æ‰¾éŸ³è§†é¢‘æµ\\n\"); return -1; } is->pFormatCtx = avformat_context;//ä¼ é€’æ–‡ä»¶å®¹å™¨å°è£…ä¿¡æ¯åŠç æµå‚æ•° /*------------------------- * æŸ¥æ‰¾ç æµ * å–å¾—æ–‡ä»¶ä¸­ä¿å­˜çš„ç æµä¿¡æ¯ï¼Œå¹¶å¡«å……åˆ°avformat_context->stream å­—æ®µ * å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ * å‚æ•°äºŒï¼šæŒ‡å®šé»˜è®¤é…ç½® -------------------------*/ int avformat_find_stream_info_result = avformat_find_stream_info(avformat_context, NULL); if (avformat_find_stream_info_result videoStream = -1;//è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 is->audioStream = -1;//éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 // è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 int av_video_stream_index = -1; // éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 int av_audio_stream_index = -1; for (int i = 0; i nb_streams; ++i) { // è‹¥æ–‡ä»¶ä¸­åŒ…å«æœ‰è§†é¢‘æµ if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_VIDEO){ av_video_stream_index = i; } // è‹¥æ–‡ä»¶ä¸­åŒ…å«æœ‰éŸ³é¢‘æµ if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_AUDIO){ av_audio_stream_index = i; } } // æ£€æŸ¥æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨è§†é¢‘æµ if (av_video_stream_index == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ²¡æœ‰æ‰¾åˆ°è§†é¢‘æµ\\n\"); goto fail;//è·³è½¬è‡³å¼‚å¸¸å¤„ç† return -1; } // æ£€æŸ¥æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨éŸ³é¢‘æµ if (av_audio_stream_index == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ²¡æœ‰æ‰¾åˆ°éŸ³é¢‘æµ\\n\"); goto fail;//è·³è½¬è‡³å¼‚å¸¸å¤„ç† return -1; } stream_component_open(is, av_audio_stream_index);// æ ¹æ®æŒ‡å®šç±»å‹æ‰“å¼€éŸ³é¢‘æµ stream_component_open(is, av_video_stream_index);// æ ¹æ®æŒ‡å®šç±»å‹æ‰“å¼€è§†é¢‘æµ // Main decode loop. for (;;) { if (is->quit) {//æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† break; } // Seek stuff goes hereï¼Œæ£€æŸ¥éŸ³è§†é¢‘ç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—é•¿åº¦æ˜¯å¦æº¢å‡º if (is->audioq.size > MAX_AUDIOQ_SIZE || is->videoq.size > MAX_VIDEOQ_SIZE) { SDL_Delay(10); continue; } /*----------------------- * read in a packet and store it in the AVPacket struct * ffmpeg allocates the internal data for us,which is pointed to by packet.data * this is freed by the av_free_packet() -----------------------*/ // è´Ÿè´£ä¿å­˜å‹ç¼©ç¼–ç æ•°æ®ç›¸å…³ä¿¡æ¯çš„ç»“æ„ä½“,æ¯å¸§å›¾åƒç”±ä¸€åˆ°å¤šä¸ªpacketåŒ…ç»„æˆ AVPacket pkt, *packet = &pkt;// åœ¨æ ˆä¸Šåˆ›å»ºä¸´æ—¶æ•°æ®åŒ…å¯¹è±¡å¹¶å…³è”æŒ‡é’ˆ if (av_read_frame(is->pFormatCtx, packet) pFormatCtx->pb->error == 0) { SDL_Delay(100); // No error; wait for user input. continue; } else { break; } } // Is this a packet from the video stream? if (packet->stream_index == is->videoStream) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºè§†é¢‘ç±»å‹ packet_queue_put(&is->videoq, packet);// å‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… } else if (packet->stream_index == is->audioStream) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºéŸ³é¢‘ç±»å‹ packet_queue_put(&is->audioq, packet);// å‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… } else {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºå­—å¹•ç±»å‹ av_packet_unref(packet);// é‡Šæ”¾packetä¸­ä¿å­˜çš„(å­—å¹•)ç¼–ç æ•°æ® } } // All done - wait for it. while (!is->quit) { SDL_Delay(100); } fail:// å¼‚å¸¸å¤„ç† if (1) { SDL_Event event;// SDLäº‹ä»¶å¯¹è±¡ event.type = FF_QUIT_EVENT;// æŒ‡å®šé€€å‡ºäº‹ä»¶ç±»å‹ event.user.data1 = is;// ä¼ é€’ç”¨æˆ·æ•°æ® SDL_PushEvent(&event);// å°†è¯¥äº‹ä»¶å¯¹è±¡å‹å…¥SDLåå°äº‹ä»¶é˜Ÿåˆ— } return 0; } int init_sdl(VideoState *is) { // åˆå§‹åŒ–SDLå¤šåª’ä½“æ¡†æ¶ if (SDL_Init( SDL_INIT_VIDEO | SDL_INIT_AUDIO | SDL_INIT_TIMER ) == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); return -1; } // åˆå§‹åŒ–SDLçª—å£ SDL_Window* sdl_window = SDL_CreateWindow(\"FFmpeg+SDLæ’­æ”¾è§†é¢‘\",// å‚æ•°ä¸€ï¼šçª—å£åç§° SDL_WINDOWPOS_CENTERED,// å‚æ•°äºŒï¼šçª—å£åœ¨å±å¹•ä¸Šçš„xåæ ‡ SDL_WINDOWPOS_CENTERED,// å‚æ•°ä¸‰ï¼šçª—å£åœ¨å±å¹•ä¸Šçš„yåæ ‡ is->video_width,// å‚æ•°å››ï¼šçª—å£åœ¨å±å¹•ä¸Šå®½ is->video_height,// å‚æ•°äº”ï¼šçª—å£åœ¨å±å¹•ä¸Šé«˜ SDL_WINDOW_OPENGL);// å‚æ•°å…­ï¼šçª—å£çŠ¶æ€(æ‰“å¼€) if (sdl_window == NULL){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"çª—å£åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çª—å£åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } // åˆ›å»ºæ¸²æŸ“å™¨ // å®šä¹‰æ¸²æŸ“å™¨åŒºåŸŸ SDL_Renderer* sdl_renderer = SDL_CreateRenderer(sdl_window,// æ¸²æŸ“ç›®æ ‡åˆ›å»º -1, // ä»é‚£é‡Œå¼€å§‹æ¸²æŸ“(-1:è¡¨ç¤ºä»ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹) 0);// æ¸²æŸ“ç±»å‹(è½¯ä»¶æ¸²æŸ“) if (sdl_renderer == NULL){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } // åˆ›å»ºçº¹ç† SDL_Texture* sdl_texture = SDL_CreateTexture(sdl_renderer,// æ¸²æŸ“å™¨ SDL_PIXELFORMAT_IYUV,// åƒç´ æ•°æ®æ ¼å¼ SDL_TEXTUREACCESS_STREAMING,// ç»˜åˆ¶æ–¹å¼ï¼šé¢‘ç¹ç»˜åˆ¶- is->video_width,// çº¹ç†å®½ is->video_height);// çº¹ç†é«˜ if (sdl_texture == NULL) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } is->sdl_renderer = sdl_renderer; is->sdl_texture = sdl_texture; return 0; } // SDLå…¥å£ extern \"C\" int main(int argc, char *argv[]) { /*------------------------- * æ³¨å†Œç»„ä»¶ * æ³¨å†Œæ‰€æœ‰ffmpegæ”¯æŒçš„å¤šåª’ä½“æ ¼å¼åŠç¼–è§£ç å™¨ -------------------------*/ av_register_all(); // åˆ›å»ºå…¨å±€çŠ¶æ€å¯¹è±¡ VideoState *is= (VideoState *)av_mallocz(sizeof(VideoState)); av_strlcpy(is->filename, \"/storage/emulated/0/Download/test.mov\", sizeof(is->filename));// å¤åˆ¶è§†é¢‘æ–‡ä»¶è·¯å¾„å is->video_width = 640; is->video_height = 352; is->pictq_lock = SDL_CreateMutex();// åˆ›å»ºç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—äº’æ–¥é”å¯¹è±¡ is->pictq_ready = SDL_CreateCond();// åˆ›å»ºç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å¯¹è±¡ int init_sdl_result = init_sdl(is); if (init_sdl_result parse_tid = SDL_CreateThread(parse_thread, \"ç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹\", is); if (!is->parse_tid) {// æ£€æŸ¥çº¿ç¨‹æ˜¯å¦åˆ›å»ºæˆåŠŸ av_free(is); return -1; } // SDLäº‹ä»¶å¯¹è±¡ SDL_Event event; for (;;) {// SDLäº‹ä»¶å¾ªç¯ SDL_WaitEvent(&event);// ä¸»çº¿ç¨‹é˜»å¡ï¼Œç­‰å¾…äº‹ä»¶åˆ°æ¥ switch(event.type) {// äº‹ä»¶åˆ°æ¥åå”¤é†’ä¸»çº¿ç¨‹ï¼Œæ£€æŸ¥äº‹ä»¶ç±»å‹ case FF_QUIT_EVENT: case SDL_QUIT:// é€€å‡ºè¿›ç¨‹äº‹ä»¶ is->quit = 1; // If the video has finished playing, then both the picture and audio queues are waiting for more data. // Make them stop waiting and terminate normally.. avcodec_close(is->video_st->codec); avformat_free_context(is->pFormatCtx); SDL_CondSignal(is->audioq.qready);// å‘å‡ºé˜Ÿåˆ—å°±ç»ªä¿¡å·é¿å…æ­»é” SDL_CondSignal(is->videoq.qready); SDL_DestroyTexture(is->sdl_texture); SDL_DestroyRenderer(is->sdl_renderer); SDL_Quit(); return 0; case FF_ALLOC_EVENT: alloc_picture(event.user.data1);// åˆ†é…è§†é¢‘å¸§äº‹ä»¶å“åº”å‡½æ•° break; case FF_REFRESH_EVENT:// è§†é¢‘æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶ video_refresh_timer(event.user.data1);// è§†é¢‘æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶å“åº”å‡½æ•° break; default: break; } } return 0; } "},"pages/FFmpeg/FFmpeg_SDLåŒæ­¥è§†é¢‘.html":{"url":"pages/FFmpeg/FFmpeg_SDLåŒæ­¥è§†é¢‘.html","title":"FFmpeg+SDLåŒæ­¥è§†é¢‘","keywords":"","body":"FFmpeg+SDLåŒæ­¥è§†é¢‘ Androidå·¥ç¨‹ä»£ç  ffmpegæ’­æ”¾å™¨å®ç°è¯¦è§£ - è§†é¢‘åŒæ­¥æ§åˆ¶ï¼šhttps://www.cnblogs.com/breakpointlab/p/15771348.html æºä»£ç ä¸€è§ˆ #include #include #include #include #include \"SDL.h\" #include #define SDL_AUDIO_BUFFER_SIZE 1024 #define MAX_AUDIO_FRAME_SIZE 192000 #define AV_SYNC_THRESHOLD 0.01//å‰åä¸¤å¸§é—´çš„æ˜¾ç¤ºæ—¶é—´é—´éš”çš„æœ€å°å€¼0.01s #define AV_NOSYNC_THRESHOLD 10.0//æœ€å°åˆ·æ–°é—´éš”æ—¶é—´10ms #define MAX_AUDIOQ_SIZE (5 * 16 * 1024) #define MAX_VIDEOQ_SIZE (5 * 256 * 1024) #define FF_ALLOC_EVENT (SDL_USEREVENT) #define FF_REFRESH_EVENT (SDL_USEREVENT + 1) #define FF_QUIT_EVENT (SDL_USEREVENT + 2) #define VIDEO_PICTURE_QUEUE_SIZE 1 extern \"C\" { #include #include \"libavformat/avformat.h\" #include #include #include #include } /*-------é“¾è¡¨èŠ‚ç‚¹ç»“æ„ä½“-------- typedef struct AVPacketList { AVPacket pkt;//é“¾è¡¨æ•°æ® struct AVPacketList *next;//é“¾è¡¨åç»§èŠ‚ç‚¹ } AVPacketList; ---------------------------*/ // æ•°æ®åŒ…é˜Ÿåˆ—(é“¾è¡¨)ç»“æ„ä½“ typedef struct PacketQueue { AVPacketList *first_pkt, *last_pkt;// é˜Ÿåˆ—é¦–å°¾èŠ‚ç‚¹æŒ‡é’ˆ int nb_packets;// é˜Ÿåˆ—é•¿åº¦ int size;// ä¿å­˜ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ï¼Œsize=packet->size SDL_mutex *qlock;// é˜Ÿåˆ—äº’æ–¥é‡ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® SDL_cond *qready;// é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å˜é‡ } PacketQueue; // å›¾åƒå¸§ç»“æ„ä½“ typedef struct VideoPicture { AVFrame *avframe_yuv420p; int width, height;//Source height & width. int allocated;//æ˜¯å¦åˆ†é…å†…å­˜ç©ºé—´ï¼Œè§†é¢‘å¸§è½¬æ¢ä¸ºSDL overlayæ ‡è¯† double pts;//å½“å‰å›¾åƒå¸§çš„ç»å¯¹æ˜¾ç¤ºæ—¶é—´æˆ³ } VideoPicture; typedef struct VideoState { AVFormatContext *pFormatCtx;// ä¿å­˜æ–‡ä»¶å®¹å™¨å°è£…ä¿¡æ¯åŠç æµå‚æ•°çš„ç»“æ„ä½“ AVStream *video_st;// è§†é¢‘æµä¿¡æ¯ç»“æ„ä½“ AVStream *audio_st;//éŸ³é¢‘æµä¿¡æ¯ç»“æ„ä½“ struct SwsContext *sws_ctx;// æè¿°è½¬æ¢å™¨å‚æ•°çš„ç»“æ„ä½“ PacketQueue videoq;// è§†é¢‘ç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—(ç¼–ç æ•°æ®é˜Ÿåˆ—ï¼Œä»¥é“¾è¡¨æ–¹å¼å®ç°) VideoPicture pictq[VIDEO_PICTURE_QUEUE_SIZE]; int pictq_size, pictq_rindex, pictq_windex;// é˜Ÿåˆ—é•¿åº¦ï¼Œè¯»/å†™ä½ç½®ç´¢å¼• SDL_mutex *pictq_lock;// é˜Ÿåˆ—è¯»å†™é”å¯¹è±¡ï¼Œä¿æŠ¤å›¾åƒå¸§é˜Ÿåˆ—æ•°æ® SDL_cond *pictq_ready;// é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å˜é‡ SDL_Rect sdl_rect; SDL_Renderer* sdl_renderer; SDL_Texture* sdl_texture; PacketQueue audioq;// éŸ³é¢‘ç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—(ç¼–ç æ•°æ®é˜Ÿåˆ—ï¼Œä»¥é“¾è¡¨æ–¹å¼å®ç°) uint8_t audio_buf[(MAX_AUDIO_FRAME_SIZE*3)/2];//ä¿å­˜è§£ç ä¸€ä¸ªpacketåçš„å¤šå¸§åŸå§‹éŸ³é¢‘æ•°æ®(è§£ç æ•°æ®é˜Ÿåˆ—ï¼Œä»¥æ•°ç»„æ–¹å¼å®ç°) unsigned int audio_buf_size;//è§£ç åçš„å¤šå¸§éŸ³é¢‘æ•°æ®é•¿åº¦ unsigned int audio_buf_index;//ç´¯è®¡å†™å…¥streamçš„é•¿åº¦ uint8_t *audio_pkt_data;//ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆä½ç½® int audio_pkt_size;//ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦(æ˜¯å¦å·²å®Œæˆä¸€ä¸ªå®Œæ•´çš„pakcetåŒ…çš„è§£ç ï¼Œä¸€ä¸ªæ•°æ®åŒ…ä¸­å¯èƒ½åŒ…å«å¤šä¸ªéŸ³é¢‘ç¼–ç å¸§) AVPacket audio_pkt;//ä¿å­˜ä»é˜Ÿåˆ—ä¸­æå–çš„æ•°æ®åŒ… AVFrame audio_frame;//ä¿å­˜ä»æ•°æ®åŒ…ä¸­è§£ç çš„éŸ³é¢‘æ•°æ® int video_width; int video_height; char filename[1024];// è¾“å…¥æ–‡ä»¶å®Œæ•´è·¯å¾„å int videoStream, audioStream;// éŸ³è§†é¢‘æµç±»å‹æ ‡å· SDL_Thread *parse_tid;// ç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹id SDL_Thread *decode_tid;// è§£ç çº¿ç¨‹id int quit;// å…¨å±€é€€å‡ºè¿›ç¨‹æ ‡è¯†ï¼Œåœ¨ç•Œé¢ä¸Šç‚¹äº†é€€å‡ºåï¼Œå‘Šè¯‰çº¿ç¨‹é€€å‡º //video/audio_clock save pts of last decoded frame/predicted pts of next decoded frame double video_clock;//keep track of how much time has passed according to the video double audio_clock; double frame_timer;//è§†é¢‘æ’­æ”¾åˆ°å½“å‰å¸§æ—¶çš„ç´¯è®¡å·²æ’­æ”¾æ—¶é—´ double frame_last_pts;//ä¸Šä¸€å¸§å›¾åƒçš„æ˜¾ç¤ºæ—¶é—´æˆ³ï¼Œç”¨äºåœ¨video_refersh_timerä¸­ä¿å­˜ä¸Šä¸€å¸§çš„ptså€¼ double frame_last_delay;//ä¸Šä¸€å¸§å›¾åƒçš„åŠ¨æ€åˆ·æ–°å»¶è¿Ÿæ—¶é—´ } VideoState;// Since we only have one decoding thread, the Big Struct can be global in case we need it. VideoState *global_video_state; /*------å–å¾—å½“å‰æ’­æ”¾éŸ³é¢‘æ•°æ®çš„pts------ * éŸ³è§†é¢‘åŒæ­¥çš„åŸç†æ˜¯æ ¹æ®éŸ³é¢‘çš„ptsæ¥æ§åˆ¶è§†é¢‘çš„æ’­æ”¾ * ä¹Ÿå°±æ˜¯è¯´åœ¨è§†é¢‘è§£ç ä¸€å¸§åï¼Œæ˜¯å¦æ˜¾ç¤ºä»¥åŠæ˜¾ç¤ºå¤šé•¿æ—¶é—´ï¼Œæ˜¯é€šè¿‡è¯¥å¸§çš„PTSä¸åŒæ—¶æ­£åœ¨æ’­æ”¾çš„éŸ³é¢‘çš„PTSæ¯”è¾ƒè€Œæ¥çš„ * å¦‚æœéŸ³é¢‘çš„PTSè¾ƒå¤§ï¼Œåˆ™è§†é¢‘å‡†å¤‡å®Œæ¯•ç«‹å³åˆ·æ–°ï¼Œå¦åˆ™ç­‰å¾… * * å› ä¸ºpcmæ•°æ®é‡‡ç”¨audio_callbackå›è°ƒæ–¹å¼è¿›è¡Œæ’­æ”¾ * å¯¹äºéŸ³é¢‘æ’­æ”¾æˆ‘ä»¬åªèƒ½å¾—åˆ°å†™å…¥å›è°ƒå‡½æ•°å‰ç¼“å­˜éŸ³é¢‘å¸§çš„ptsï¼Œè€Œæ— æ³•å¾—åˆ°å½“å‰æ’­æ”¾å¸§çš„pts(éœ€è¦é‡‡ç”¨å½“å‰æ’­æ”¾éŸ³é¢‘å¸§çš„ptsä½œä¸ºå‚è€ƒæ—¶é’Ÿ) * è€ƒè™‘åˆ°éŸ³é¢‘çš„å¤§å°ä¸æ’­æ”¾æ—¶é—´æˆæ­£æ¯”(ç›¸åŒé‡‡æ ·ç‡)ï¼Œé‚£ä¹ˆå½“å‰æ—¶åˆ»æ­£åœ¨æ’­æ”¾çš„éŸ³é¢‘å¸§pts(ä½äºå›è°ƒå‡½æ•°ç¼“å­˜ä¸­) * å°±å¯ä»¥æ ¹æ®å·²é€å…¥å£°å¡çš„pcmæ•°æ®é•¿åº¦ã€ç¼“å­˜ä¸­å‰©ä½™pcmæ•°æ®é•¿åº¦ï¼Œç¼“å­˜é•¿åº¦åŠé‡‡æ ·ç‡è¿›è¡Œæ¨ç®—äº† --------------------------------*/ double get_audio_clock(VideoState *is) { double pts=is->audio_clock;//Maintained in the audio threadï¼Œå–å¾—è§£ç æ“ä½œå®Œæˆæ—¶çš„å½“å‰æ’­æ”¾æ—¶é—´æˆ³ //è¿˜æœª(é€å…¥å£°å¡)æ’­æ”¾çš„å‰©ä½™åŸå§‹éŸ³é¢‘æ•°æ®é•¿åº¦ï¼Œç­‰äºè§£ç åçš„å¤šå¸§åŸå§‹éŸ³é¢‘æ•°æ®é•¿åº¦-ç´¯è®¡é€å…¥å£°å¡çš„é•¿åº¦ int hw_buf_size=is->audio_buf_size-is->audio_buf_index;//è®¡ç®—å½“å‰éŸ³é¢‘è§£ç æ•°æ®ç¼“å­˜ç´¢å¼•ä½ç½® int bytes_per_sec=0;//æ¯ç§’çš„åŸå§‹éŸ³é¢‘å­—èŠ‚æ•° int pcm_bytes=is->audio_st->codec->channels*2;//æ¯ç»„åŸå§‹éŸ³é¢‘æ•°æ®å­—èŠ‚æ•°=å£°é“æ•°*æ¯å£°é“æ•°æ®å­—èŠ‚æ•° if (is->audio_st) { bytes_per_sec=is->audio_st->codec->sample_rate*pcm_bytes;//è®¡ç®—æ¯ç§’çš„åŸå§‹éŸ³é¢‘å­—èŠ‚æ•° } if (bytes_per_sec) {//æ£€æŸ¥æ¯ç§’çš„åŸå§‹éŸ³é¢‘å­—èŠ‚æ•° pts-=(double)hw_buf_size/bytes_per_sec;//æ ¹æ®é€å…¥å£°å¡ç¼“å­˜çš„ç´¢å¼•ä½ç½®ï¼Œå¾€å‰å€’æ¨è®¡ç®—å½“å‰æ—¶åˆ»çš„éŸ³é¢‘æ’­æ”¾æ—¶é—´æˆ³pts } return pts;//è¿”å›å½“å‰æ­£åœ¨æ’­æ”¾çš„éŸ³é¢‘æ—¶é—´æˆ³ } // å®šæ—¶å™¨è§¦å‘çš„å›è°ƒå‡½æ•° static Uint32 sdl_refresh_timer_cb(Uint32 interval, void *opaque) { SDL_Event event;//SDLäº‹ä»¶å¯¹è±¡ event.type = FF_REFRESH_EVENT;//è§†é¢‘æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶ event.user.data1 = opaque;//ä¼ é€’ç”¨æˆ·æ•°æ® SDL_PushEvent(&event);//å‘é€äº‹ä»¶ return 0; // 0 means stop timer. } /*--------------------------- * Schedule a video refresh in 'delay' ms. * å‘Šè¯‰sdlåœ¨æŒ‡å®šçš„å»¶æ—¶åæ¥æ¨é€ä¸€ä¸ª FF_REFRESH_EVENT äº‹ä»¶ * è¿™ä¸ªäº‹ä»¶å°†åœ¨äº‹ä»¶é˜Ÿåˆ—é‡Œè§¦å‘sdl_refresh_timer_cbå‡½æ•°çš„è°ƒç”¨ --------------------------*/ static void schedule_refresh(VideoState *is, int delay) { SDL_AddTimer(delay, sdl_refresh_timer_cb, is);//åœ¨æŒ‡å®šçš„æ—¶é—´(ms)åå›è°ƒç”¨æˆ·æŒ‡å®šçš„å‡½æ•° } // è§†é¢‘(å›¾åƒ)å¸§æ¸²æŸ“ void video_display(VideoState *is) { SDL_Rect rect;// SDLçŸ©å½¢å¯¹è±¡ VideoPicture *vp;// å›¾åƒå¸§ç»“æ„ä½“æŒ‡é’ˆ vp = &is->pictq[is->pictq_rindex];//ä»å›¾åƒå¸§é˜Ÿåˆ—(æ•°ç»„)ä¸­æå–å›¾åƒå¸§ç»“æ„å¯¹è±¡ if (vp->avframe_yuv420p) {//æ£€æŸ¥åƒç´ æ•°æ®æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆ // è®¾ç½®çº¹ç†æ•°æ® SDL_UpdateTexture(is->sdl_texture, // çº¹ç† NULL,// æ¸²æŸ“åŒºåŸŸ vp->avframe_yuv420p->data[0],// éœ€è¦æ¸²æŸ“æ•°æ®ï¼šè§†é¢‘åƒç´ æ•°æ®å¸§ vp->avframe_yuv420p->linesize[0]);// å¸§å®½ // å°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // è®¾ç½®å·¦ä¸Šè§’ä½ç½®(å…¨å±) is->sdl_rect.x = 100; is->sdl_rect.y = 100; is->sdl_rect.w = vp->width; is->sdl_rect.h = vp->height; SDL_RenderClear(is->sdl_renderer); SDL_RenderCopy(is->sdl_renderer, is->sdl_texture, NULL, &is->sdl_rect); // å‘ˆç°ç”»é¢å¸§ SDL_RenderPresent(is->sdl_renderer); }// end for if }// end for video_display // æ˜¾ç¤ºåˆ·æ–°å‡½æ•°(FF_REFRESH_EVENTå“åº”å‡½æ•°) int video_current_index = 0; void video_refresh_timer(void *userdata) { VideoState *is = (VideoState *)userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® VideoPicture *vp;//å›¾åƒå¸§å¯¹è±¡ //delay-å‰åå¸§é—´çš„æ˜¾ç¤ºæ—¶é—´é—´éš”ï¼Œdiff-å›¾åƒå¸§æ˜¾ç¤ºä¸éŸ³é¢‘å¸§æ’­æ”¾é—´çš„æ—¶é—´å·® //sync_threshold-å‰åå¸§é—´çš„æœ€å°æ—¶é—´å·®ï¼Œactual_delay-å½“å‰å¸§-ä¸‹å·²å¸§çš„æ˜¾ç¤ºæ—¶é—´é—´éš”(åŠ¨æ€æ—¶é—´ã€çœŸå®æ—¶é—´ã€ç»å¯¹æ—¶é—´) double delay,diff,sync_threshold,actual_delay,ref_clock;//ref_clock-éŸ³é¢‘æ—¶é—´æˆ³ if (is->video_st) { if (is->pictq_size == 0) {// æ£€æŸ¥å›¾åƒå¸§é˜Ÿåˆ—æ˜¯å¦æœ‰å¾…æ˜¾ç¤ºå›¾åƒ schedule_refresh(is, 1);//è‹¥é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™å‘é€æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶å¹¶å†æ¬¡è¿›å…¥video_refresh_timerå‡½æ•° } else {// åˆ·æ–°å›¾åƒ vp = &is->pictq[is->pictq_rindex];//ä»æ˜¾ç¤ºé˜Ÿåˆ—ä¸­å–å¾—ç­‰å¾…æ˜¾ç¤ºçš„å›¾åƒå¸§ //è®¡ç®—å½“å‰å¸§å’Œå‰ä¸€å¸§æ˜¾ç¤º(pts)çš„é—´éš”æ—¶é—´(æ˜¾ç¤ºæ—¶é—´æˆ³çš„å·®å€¼) delay = vp->pts - is->frame_last_pts;//The pts from last timeï¼Œå‰åå¸§é—´çš„æ—¶é—´å·® if (delay = 1.0) {//æ£€æŸ¥æ—¶é—´é—´éš”æ˜¯å¦åœ¨åˆç†èŒƒå›´ // If incorrect delay, use previous one delay = is->frame_last_delay;//æ²¿ç”¨ä¹‹å‰çš„åŠ¨æ€åˆ·æ–°é—´éš”æ—¶é—´ } // Save for next time is->frame_last_delay = delay;//ä¿å­˜ä¸Šä¸€å¸§å›¾åƒçš„åŠ¨æ€åˆ·æ–°å»¶è¿Ÿæ—¶é—´ is->frame_last_pts = vp->pts;//ä¿å­˜ä¸Šä¸€å¸§å›¾åƒçš„æ˜¾ç¤ºæ—¶é—´æˆ³ // Update delay to sync to audioï¼Œå–å¾—å£°éŸ³æ’­æ”¾æ—¶é—´æˆ³(ä½œä¸ºè§†é¢‘åŒæ­¥çš„å‚è€ƒæ—¶é—´) ref_clock=get_audio_clock(is);//æ ¹æ®Audio clockæ¥åˆ¤æ–­Videoæ’­æ”¾çš„å¿«æ…¢ï¼Œè·å–å½“å‰æ’­æ”¾å£°éŸ³çš„æ—¶é—´æˆ³ //ä¹Ÿå°±æ˜¯è¯´åœ¨diffè¿™æ®µæ—¶é—´ä¸­å£°éŸ³æ˜¯åŒ€é€Ÿå‘ç”Ÿçš„ï¼Œä½†æ˜¯åœ¨delayè¿™æ®µæ—¶é—´frameçš„æ˜¾ç¤ºå¯èƒ½å°±ä¼šæœ‰å¿«æ…¢çš„åŒºåˆ« diff=vp->pts-ref_clock;//è®¡ç®—å›¾åƒå¸§æ˜¾ç¤ºä¸éŸ³é¢‘å¸§æ’­æ”¾é—´çš„æ—¶é—´å·® //æ ¹æ®æ—¶é—´å·®è°ƒæ•´æ’­æ”¾ä¸‹ä¸€å¸§çš„å»¶è¿Ÿæ—¶é—´ï¼Œä»¥å®ç°åŒæ­¥ Skip or repeat the frameï¼ŒTake delay into account sync_threshold=(delay>AV_SYNC_THRESHOLD) ? delay : AV_SYNC_THRESHOLD;//æ¯”è¾ƒå‰åä¸¤å¸§é—´çš„æ˜¾ç¤ºæ—¶é—´é—´éš”ä¸æœ€å°æ—¶é—´é—´éš” //åˆ¤æ–­éŸ³è§†é¢‘ä¸åŒæ­¥æ¡ä»¶ï¼Œå³éŸ³è§†é¢‘é—´çš„æ—¶é—´å·® & å‰åå¸§é—´çš„æ—¶é—´å·®è¯¥é˜ˆå€¼åˆ™ä¸ºå¿«è¿›æ¨¡å¼ï¼Œä¸å­˜åœ¨éŸ³è§†é¢‘åŒæ­¥é—®é¢˜ if (fabs(diff)=sync_threshold) {//æ¯”è¾ƒä¸¤å¸§ç”»é¢é—´çš„æ˜¾ç¤ºæ—¶é—´ä¸ä¸¤å¸§ç”»é¢é—´å£°éŸ³çš„æ’­æ”¾æ—¶é—´ï¼Œå¿«äº†ï¼ŒåŠ å€delay delay=2*delay; } }//å¦‚æœdiff(æ˜æ˜¾)å¤§äºAV_NOSYNC_THRESHOLDï¼Œå³å¿«è¿›çš„æ¨¡å¼äº†ï¼Œç”»é¢è·³åŠ¨å¤ªå¤§ï¼Œä¸å­˜åœ¨éŸ³è§†é¢‘åŒæ­¥çš„é—®é¢˜äº† //æ›´æ–°è§†é¢‘æ’­æ”¾åˆ°å½“å‰å¸§æ—¶çš„å·²æ’­æ”¾æ—¶é—´å€¼(æ‰€æœ‰å›¾åƒå¸§åŠ¨æ€æ’­æ”¾ç´¯è®¡æ—¶é—´å€¼-çœŸå®å€¼)ï¼Œframe_timerä¸€ç›´ç´¯åŠ åœ¨æ’­æ”¾è¿‡ç¨‹ä¸­æˆ‘ä»¬è®¡ç®—çš„å»¶æ—¶ is->frame_timer+=delay; //æ¯æ¬¡è®¡ç®—frame_timerä¸ç³»ç»Ÿæ—¶é—´çš„å·®å€¼(ä»¥ç³»ç»Ÿæ—¶é—´ä¸ºåŸºå‡†æ—¶é—´)ï¼Œå°†frame_timerä¸ç³»ç»Ÿæ—¶é—´(ç»å¯¹æ—¶é—´)ç›¸å…³è”çš„ç›®çš„ actual_delay=is->frame_timer-(av_gettime()/1000000.0);//Computer the REAL delay if (actual_delay pts: %fï¼Œref_clockï¼š%fï¼Œactual_delayï¼š%f\", video_current_index, vp->pts, ref_clock, actual_delay); // Update queue for next picture! if (++is->pictq_rindex == VIDEO_PICTURE_QUEUE_SIZE) {// æ›´æ–°å¹¶æ£€æŸ¥å›¾åƒå¸§é˜Ÿåˆ—è¯»ä½ç½®ç´¢å¼• is->pictq_rindex = 0;// é‡ç½®è¯»ä½ç½®ç´¢å¼• } SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤ç”»å¸ƒçš„åƒç´ æ•°æ® is->pictq_size--;// æ›´æ–°å›¾åƒå¸§é˜Ÿåˆ—é•¿åº¦ SDL_CondSignal(is->pictq_ready);// å‘é€é˜Ÿåˆ—å°±ç»ªä¿¡å· SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ } } else { schedule_refresh(is, 100); } } // æ•°æ®åŒ…é˜Ÿåˆ—åˆå§‹åŒ–å‡½æ•° void packet_queue_init(PacketQueue *q) { memset(q, 0, sizeof(PacketQueue));// å…¨é›¶åˆå§‹åŒ–é˜Ÿåˆ—ç»“æ„ä½“å¯¹è±¡ q->qlock = SDL_CreateMutex();// åˆ›å»ºäº’æ–¥é‡å¯¹è±¡ q->qready = SDL_CreateCond();// åˆ›å»ºæ¡ä»¶å˜é‡å¯¹è±¡ } // å‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… int packet_queue_put(PacketQueue *q, AVPacket *pkt) { /*-------å‡†å¤‡é˜Ÿåˆ—(é“¾è¡¨)èŠ‚ç‚¹å¯¹è±¡------*/ AVPacketList *pktlist=(AVPacketList *)av_malloc(sizeof(AVPacketList));// åœ¨å †ä¸Šåˆ›å»ºé“¾è¡¨èŠ‚ç‚¹å¯¹è±¡ if (!pktlist) {// æ£€æŸ¥é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡æ˜¯å¦åˆ›å»ºæˆåŠŸ return -1; } pktlist->pkt = *pkt;// å°†è¾“å…¥æ•°æ®åŒ…èµ‹å€¼ç»™æ–°å»ºé“¾è¡¨èŠ‚ç‚¹å¯¹è±¡ä¸­çš„æ•°æ®åŒ…å¯¹è±¡ pktlist->next = NULL;// é“¾è¡¨åç»§æŒ‡é’ˆä¸ºç©º // if (av_packet_ref(pkt, pkt) qlock);// é˜Ÿåˆ—äº’æ–¥é‡åŠ é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® if (!q->last_pkt) {// æ£€æŸ¥é˜Ÿåˆ—å°¾èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨(æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º) q->first_pkt = pktlist;// è‹¥ä¸å­˜åœ¨(é˜Ÿåˆ—å°¾ç©º)ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹ä½œé˜Ÿåˆ—ä¸ºé¦–èŠ‚ç‚¹ } else { q->last_pkt->next = pktlist;// è‹¥å·²å­˜åœ¨å°¾èŠ‚ç‚¹ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹æŒ‚åˆ°å°¾èŠ‚ç‚¹çš„åç»§æŒ‡é’ˆä¸Šï¼Œå¹¶ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ } q->last_pkt = pktlist;// å°†å½“å‰èŠ‚ç‚¹ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ q->nb_packets++;// é˜Ÿåˆ—é•¿åº¦+1 q->size += pktlist->pkt.size;// æ›´æ–°é˜Ÿåˆ—ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ SDL_CondSignal(q->qready);// ç»™ç­‰å¾…çº¿ç¨‹å‘å‡ºæ¶ˆæ¯ï¼Œé€šçŸ¥é˜Ÿåˆ—å·²å°±ç»ª SDL_UnlockMutex(q->qlock);// é‡Šæ”¾äº’æ–¥é‡ return 0; } // ä»é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ï¼Œå¹¶å°†æå–çš„æ•°æ®åŒ…å‡ºé˜Ÿåˆ— static int packet_queue_get(PacketQueue *q, AVPacket *pkt, int block) { AVPacketList *pktlist;// ä¸´æ—¶é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡æŒ‡é’ˆ int ret;// æ“ä½œç»“æœ SDL_LockMutex(q->qlock);// é˜Ÿåˆ—äº’æ–¥é‡åŠ é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® for (;;) { if (global_video_state->quit) {// æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† ret = -1;// æ“ä½œå¤±è´¥ break; }//end for if pktlist = q->first_pkt;// ä¼ é€’å°†é˜Ÿåˆ—é¦–ä¸ªæ•°æ®åŒ…æŒ‡é’ˆ if (pktlist) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºç©º(é˜Ÿåˆ—æ˜¯å¦æœ‰æ•°æ®) q->first_pkt = pktlist->next;// é˜Ÿåˆ—é¦–èŠ‚ç‚¹æŒ‡é’ˆåç§» if (!q->first_pkt) {// æ£€æŸ¥é¦–èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ q->last_pkt = NULL;// è‹¥ä¸å­˜åœ¨ï¼Œåˆ™å°†å°¾èŠ‚ç‚¹æŒ‡é’ˆç½®ç©º } q->nb_packets--;// é˜Ÿåˆ—é•¿åº¦-1 q->size -= pktlist->pkt.size;// æ›´æ–°é˜Ÿåˆ—ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ *pkt = pktlist->pkt;// å°†é˜Ÿåˆ—é¦–èŠ‚ç‚¹æ•°æ®è¿”å› av_free(pktlist);// æ¸…ç©ºä¸´æ—¶èŠ‚ç‚¹æ•°æ®(æ¸…ç©ºé¦–èŠ‚ç‚¹æ•°æ®ï¼Œé¦–èŠ‚ç‚¹å‡ºé˜Ÿåˆ—) ret = 1;// æ“ä½œæˆåŠŸ break; } else if (!block) { ret = 0; break; } else {// é˜Ÿåˆ—å¤„äºæœªå°±ç»ªçŠ¶æ€ï¼Œæ­¤æ—¶é€šè¿‡SDL_CondWaitå‡½æ•°ç­‰å¾…qreadyå°±ç»ªä¿¡å·ï¼Œå¹¶æš‚æ—¶å¯¹äº’æ–¥é‡è§£é” /*--------------------- * ç­‰å¾…é˜Ÿåˆ—å°±ç»ªä¿¡å·qreadyï¼Œå¹¶å¯¹äº’æ–¥é‡æš‚æ—¶è§£é” * æ­¤æ—¶çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œå¹¶ç½®äºç­‰å¾…æ¡ä»¶å°±ç»ªçš„çº¿ç¨‹åˆ—è¡¨ä¸Š * ä½¿å¾—è¯¥çº¿ç¨‹åªåœ¨ä¸´ç•ŒåŒºèµ„æºå°±ç»ªåæ‰è¢«å”¤é†’ï¼Œè€Œä¸è‡³äºçº¿ç¨‹è¢«é¢‘ç¹åˆ‡æ¢ * è¯¥å‡½æ•°è¿”å›æ—¶ï¼Œäº’æ–¥é‡å†æ¬¡è¢«é”ä½ï¼Œå¹¶æ‰§è¡Œåç»­æ“ä½œ --------------------*/ SDL_CondWait(q->qready, q->qlock);// æš‚æ—¶è§£é”äº’æ–¥é‡å¹¶å°†è‡ªå·±é˜»å¡ï¼Œç­‰å¾…ä¸´ç•ŒåŒºèµ„æºå°±ç»ª(ç­‰å¾…SDL_CondSignalå‘å‡ºä¸´ç•ŒåŒºèµ„æºå°±ç»ªçš„ä¿¡å·) } }//end for for-loop SDL_UnlockMutex(q->qlock);// é‡Šæ”¾äº’æ–¥é‡ return ret; } // åˆ›å»º/é‡ç½®å›¾åƒå¸§ï¼Œä¸ºå›¾åƒå¸§åˆ†é…å†…å­˜ç©ºé—´ void alloc_picture(void *userdata) { VideoState *is = (VideoState *)userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® VideoPicture *vp=&is->pictq[is->pictq_windex];// ä»å›¾åƒå¸§é˜Ÿåˆ—(æ•°ç»„)ä¸­æå–å›¾åƒå¸§ç»“æ„å¯¹è±¡ if (vp->avframe_yuv420p) {// æ£€æŸ¥å›¾åƒå¸§æ˜¯å¦å·²å­˜åœ¨ // We already have one make another, bigger/smaller. av_frame_free(&vp->avframe_yuv420p); } vp->width = is->video_st->codec->width;// è®¾ç½®å›¾åƒå¸§å®½åº¦ vp->height = is->video_st->codec->height;// è®¾ç½®å›¾åƒå¸§é«˜åº¦ SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤ç”»å¸ƒçš„åƒç´ æ•°æ® vp->allocated = 1;// å›¾åƒå¸§åƒç´ ç¼“å†²åŒºå·²åˆ†é…å†…å­˜ // AV_PIX_FMT_YUV420Pæ ¼å¼çš„è§†é¢‘å¸§ vp->avframe_yuv420p = av_frame_alloc(); // ç»™ç¼“å†²åŒºè®¾ç½®ç±»å‹ int buffer_size =av_image_get_buffer_size(AV_PIX_FMT_YUV420P,// è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ is->video_st->codec->width,// ä¸€å¸§è§†é¢‘åƒç´ æ•°æ®å®½ = è§†é¢‘å®½ is->video_st->codec->height,// ä¸€å¸§è§†é¢‘åƒç´ æ•°æ®é«˜ = è§†é¢‘é«˜ 1);// å­—èŠ‚å¯¹é½æ–¹å¼ï¼Œé»˜è®¤æ˜¯1 // å¼€è¾Ÿä¸€å—å†…å­˜ç©ºé—´ uint8_t *out_buffer = (uint8_t *)av_malloc(buffer_size); // å‘avframe_yuv420på¡«å……æ•°æ® av_image_fill_arrays(vp->avframe_yuv420p->data,// ç›®æ ‡è§†é¢‘å¸§æ•°æ® vp->avframe_yuv420p->linesize,// ç›®æ ‡è§†é¢‘å¸§è¡Œå¤§å° out_buffer,// åŸå§‹æ•°æ® AV_PIX_FMT_YUV420P,// è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ is->video_st->codec->width,// è§†é¢‘å®½ is->video_st->codec->height,//è§†é¢‘é«˜ 1);// å­—èŠ‚å¯¹é½æ–¹å¼ SDL_CondSignal(is->pictq_ready);// ç»™ç­‰å¾…çº¿ç¨‹å‘å‡ºæ¶ˆæ¯ï¼Œé€šçŸ¥é˜Ÿåˆ—å·²å°±ç»ª SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ } /*--------------------------- * queue_pictureï¼šå›¾åƒå¸§æ’å…¥é˜Ÿåˆ—ç­‰å¾…æ¸²æŸ“ * @isï¼šå…¨å±€çŠ¶æ€å‚æ•°é›† * @pFrameï¼šä¿å­˜å›¾åƒè§£ç æ•°æ®çš„ç»“æ„ä½“ * 1ã€é¦–å…ˆæ£€æŸ¥å›¾åƒå¸§é˜Ÿåˆ—(æ•°ç»„)æ˜¯å¦å­˜åœ¨ç©ºé—´æ’å…¥æ–°çš„å›¾åƒï¼Œè‹¥æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ’å…¥å›¾åƒåˆ™ä½¿å½“å‰çº¿ç¨‹ä¼‘çœ ç­‰å¾… * 2ã€åœ¨åˆå§‹åŒ–çš„æ¡ä»¶ä¸‹ï¼Œé˜Ÿåˆ—(æ•°ç»„)ä¸­VideoPictureçš„bmpå¯¹è±¡(YUV overlay)å°šæœªåˆ†é…ç©ºé—´ï¼Œé€šè¿‡FF_ALLOC_EVENTäº‹ä»¶çš„æ–¹æ³•è°ƒç”¨alloc_pictureåˆ†é…ç©ºé—´ * 3ã€å½“é˜Ÿåˆ—(æ•°ç»„)ä¸­æ‰€æœ‰VideoPictureçš„bmpå¯¹è±¡(YUV overlay)å‡å·²åˆ†é…ç©ºé—´çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è·³è¿‡æ­¥éª¤2å‘bmpå¯¹è±¡æ‹·è´åƒç´ æ•°æ®ï¼Œåƒç´ æ•°æ®åœ¨è¿›è¡Œæ ¼å¼è½¬æ¢åæ‰§è¡Œæ‹·è´æ“ä½œ ---------------------------*/ int queue_picture(VideoState *is, AVFrame *pFrame, double pts) { /*--------1ã€æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦æœ‰æ’å…¥ç©ºé—´-------*/ // Wait until we have space for a new pic. SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤å›¾åƒå¸§é˜Ÿåˆ— while (is->pictq_size >= VIDEO_PICTURE_QUEUE_SIZE && !is->quit) {// æ£€æŸ¥é˜Ÿåˆ—å½“å‰é•¿åº¦ SDL_CondWait(is->pictq_ready, is->pictq_lock);// çº¿ç¨‹ä¼‘çœ ç­‰å¾…pictq_readyä¿¡å· } SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ if (is->quit) {// æ£€æŸ¥è¿›ç¨‹é€€å‡ºæ ‡è¯† return -1; } /*-------2ã€åˆå§‹åŒ–/é‡ç½®YUV overlay-------*/ // windex is set to 0 initially. VideoPicture *vp=&is->pictq[is->pictq_windex];// ä»å›¾åƒå¸§é˜Ÿåˆ—ä¸­æŠ½å–å›¾åƒå¸§å¯¹è±¡ // Allocate or resize the bufferï¼Œæ£€æŸ¥YUV overlayæ˜¯å¦å·²å­˜åœ¨ï¼Œå¦åˆ™åˆå§‹åŒ–YUV overlayï¼Œåˆ†é…åƒç´ ç¼“å­˜ç©ºé—´ if (!vp->avframe_yuv420p || vp->width!=is->video_st->codec->width || vp->height!=is->video_st->codec->height) { vp->allocated = 0;// å›¾åƒå¸§æœªåˆ†é…ç©ºé—´ // We have to do it in the main thread. SDL_Event event;// SDLäº‹ä»¶å¯¹è±¡ event.type = FF_ALLOC_EVENT;//æŒ‡å®šåˆ†é…å›¾åƒå¸§å†…å­˜äº‹ä»¶ event.user.data1 = is;//ä¼ é€’ç”¨æˆ·æ•°æ® SDL_PushEvent(&event);//å‘é€SDLäº‹ä»¶ // Wait until we have a picture allocated. SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤å›¾åƒå¸§é˜Ÿåˆ— while (!vp->allocated && !is->quit) {// æ£€æŸ¥å½“å‰å›¾åƒå¸§æ˜¯å¦å·²åˆå§‹åŒ– SDL_CondWait(is->pictq_ready, is->pictq_lock);// çº¿ç¨‹ä¼‘çœ ç­‰å¾…alloc_pictureå‘é€pictq_readyä¿¡å·å”¤é†’å½“å‰çº¿ç¨‹ } SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ if (is->quit) {// æ£€æŸ¥è¿›ç¨‹é€€å‡ºæ ‡è¯† return -1; } }// end for if /*--------3ã€æ‹·è´è§†é¢‘å¸§åˆ°YUV overlay-------*/ // We have a place to put our picture on the queue. if (vp->avframe_yuv420p) {//æ£€æŸ¥åƒç´ æ•°æ®æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆ // Convert the image into YUV format that SDL usesï¼Œå°†è§£ç åçš„å›¾åƒå¸§è½¬æ¢ä¸ºAV_PIX_FMT_YUV420Pæ ¼å¼ï¼Œå¹¶æ‹·è´åˆ°å›¾åƒå¸§é˜Ÿåˆ— sws_scale(is->sws_ctx, (uint8_t const * const *)pFrame->data, pFrame->linesize, 0, is->video_st->codec->height, vp->avframe_yuv420p->data, vp->avframe_yuv420p->linesize); vp->pts = pts;//ä¼ é€’å½“å‰å›¾åƒå¸§çš„ç»å¯¹æ˜¾ç¤ºæ—¶é—´æˆ³ // Now we inform our display thread that we have a pic ready. if (++is->pictq_windex == VIDEO_PICTURE_QUEUE_SIZE) {//æ›´æ–°å¹¶æ£€æŸ¥å½“å‰å›¾åƒå¸§é˜Ÿåˆ—å†™å…¥ä½ç½® is->pictq_windex = 0;//é‡ç½®å›¾åƒå¸§é˜Ÿåˆ—å†™å…¥ä½ç½® } SDL_LockMutex(is->pictq_lock);//é”å®šé˜Ÿåˆ—è¯»å†™é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® is->pictq_size++;//æ›´æ–°å›¾åƒå¸§é˜Ÿåˆ—é•¿åº¦ SDL_UnlockMutex(is->pictq_lock);//é‡Šæ”¾é˜Ÿåˆ—è¯»å†™é” }// end for if return 0; } /*--------------------------- * æ›´æ–°å†…éƒ¨è§†é¢‘æ’­æ”¾è®¡æ—¶å™¨(è®°å½•è§†é¢‘å·²ç»æ’­æ—¶é—´(video_clock)ï¼‰ * @isï¼šå…¨å±€çŠ¶æ€å‚æ•°é›† * @src_frameï¼šå½“å‰(è¾“å…¥çš„)(å¾…æ›´æ–°çš„)å›¾åƒå¸§å¯¹è±¡ * @ptsï¼šå½“å‰å›¾åƒå¸§çš„æ˜¾ç¤ºæ—¶é—´æˆ³ * update the PTS to be in sync ---------------------------*/ double synchronize_video(VideoState *is, AVFrame *src_frame, double pts) { /*----------æ£€æŸ¥æ˜¾ç¤ºæ—¶é—´æˆ³----------*/ if (pts != 0) {//æ£€æŸ¥æ˜¾ç¤ºæ—¶é—´æˆ³æ˜¯å¦æœ‰æ•ˆ // If we have pts, set video clock to it. is->video_clock = pts;//ç”¨æ˜¾ç¤ºæ—¶é—´æˆ³æ›´æ–°å·²æ’­æ”¾æ—¶é—´ } else {//è‹¥è·å–ä¸åˆ°æ˜¾ç¤ºæ—¶é—´æˆ³ // If we aren't given a pts, set it to the clock. pts = is->video_clock;//ç”¨å·²æ’­æ”¾æ—¶é—´æ›´æ–°æ˜¾ç¤ºæ—¶é—´æˆ³ } /*--------æ›´æ–°è§†é¢‘å·²ç»æ’­æ—¶é—´--------*/ // Update the video clockï¼Œè‹¥è¯¥å¸§è¦é‡å¤æ˜¾ç¤º(å–å†³äºrepeat_pict)ï¼Œåˆ™å…¨å±€è§†é¢‘æ’­æ”¾æ—¶åºvideo_clockåº”åŠ ä¸Šé‡å¤æ˜¾ç¤ºçš„æ•°é‡*å¸§ç‡ double frame_delay = av_q2d(is->video_st->codec->time_base);//è¯¥å¸§æ˜¾ç¤ºå®Œå°†è¦èŠ±è´¹çš„æ—¶é—´ // If we are repeating a frame, adjust clock accordingly,è‹¥å­˜åœ¨é‡å¤å¸§ï¼Œåˆ™åœ¨æ­£å¸¸æ’­æ”¾çš„å‰åä¸¤å¸§å›¾åƒé—´å®‰æ’æ¸²æŸ“é‡å¤å¸§ frame_delay += src_frame->repeat_pict*(frame_delay*0.5);//è®¡ç®—æ¸²æŸ“é‡å¤å¸§çš„æ—¶å€¼(ç±»ä¼¼äºéŸ³ç¬¦æ—¶å€¼) is->video_clock += frame_delay;//æ›´æ–°è§†é¢‘æ’­æ”¾æ—¶é—´ // printf(\"repeat_pict=%d \\n\",src_frame->repeat_pict); return pts;//æ­¤æ—¶è¿”å›çš„å€¼å³ä¸ºä¸‹ä¸€å¸§å°†è¦å¼€å§‹æ˜¾ç¤ºçš„æ—¶é—´æˆ³ } // è§†é¢‘è§£ç çº¿ç¨‹å‡½æ•° int decode_thread(void *arg) { VideoState *is = (VideoState *) arg;// ä¼ é€’ç”¨æˆ·æ•°æ® AVPacket pkt, *packet = &pkt;// åœ¨æ ˆä¸Šåˆ›å»ºä¸´æ—¶æ•°æ®åŒ…å¯¹è±¡å¹¶å…³è”æŒ‡é’ˆ int frameFinished;// è§£ç æ“ä½œæ˜¯å¦æˆåŠŸæ ‡è¯† // Allocate video frameï¼Œä¸ºè§£ç åçš„è§†é¢‘ä¿¡æ¯ç»“æ„ä½“åˆ†é…ç©ºé—´å¹¶å®Œæˆåˆå§‹åŒ–æ“ä½œ(ç»“æ„ä½“ä¸­çš„å›¾åƒç¼“å­˜æŒ‰ç…§ä¸‹é¢ä¸¤æ­¥æ‰‹åŠ¨å®‰è£…) AVFrame *pFrame = av_frame_alloc(); double pts;//å½“å‰æ¡¢åœ¨æ•´ä¸ªè§†é¢‘ä¸­çš„(ç»å¯¹)æ—¶é—´ä½ç½® for (;;) { if (packet_queue_get(&is->videoq,packet,1)pts;// Save global pts to be stored in pFrame in first call. /*----------------------- * Decode video frameï¼Œè§£ç å®Œæ•´çš„ä¸€å¸§æ•°æ®ï¼Œå¹¶å°†frameFinishedè®¾ç½®ä¸ºtrue * å¯èƒ½æ— æ³•é€šè¿‡åªè§£ç ä¸€ä¸ªpacketå°±è·å¾—ä¸€ä¸ªå®Œæ•´çš„è§†é¢‘å¸§frameï¼Œå¯èƒ½éœ€è¦è¯»å–å¤šä¸ªpacketæ‰è¡Œ * avcodec_decode_video2()ä¼šåœ¨è§£ç åˆ°å®Œæ•´çš„ä¸€å¸§æ—¶è®¾ç½®frameFinishedä¸ºçœŸ * Technically a packet can contain partial frames or other bits of data * ffmpeg's parser ensures that the packets we get contain either complete or multiple frames * convert the packet to a frame for us and set frameFinisned for us when we have the next frame -----------------------*/ avcodec_decode_video2(is->video_st->codec, pFrame, &frameFinished, packet); //å–å¾—ç¼–ç æ•°æ®åŒ…ä¸­çš„æ˜¾ç¤ºæ—¶é—´æˆ³PTS(int64_t),å¹¶æš‚æ—¶ä¿å­˜åœ¨pts(double)ä¸­ // if (packet->dts==AV_NOPTS_VALUE && pFrame->opaque && *(uint64_t*)pFrame->opaque!=AV_NOPTS_VALUE) { // pts = *(uint64_t *)pFrame->opaque; // } else if (packet->dts != AV_NOPTS_VALUE) { // pts = packet->dts; // } else { // pts = 0; // } pts=av_frame_get_best_effort_timestamp(pFrame);//å–å¾—ç¼–ç æ•°æ®åŒ…ä¸­çš„å›¾åƒå¸§æ˜¾ç¤ºåºå·PTS(int64_t),å¹¶æš‚æ—¶ä¿å­˜åœ¨pts(double)ä¸­ /*------------------------- * åœ¨è§£ç çº¿ç¨‹å‡½æ•°ä¸­è®¡ç®—å½“å‰å›¾åƒå¸§çš„æ˜¾ç¤ºæ—¶é—´æˆ³ * 1ã€å–å¾—ç¼–ç æ•°æ®åŒ…ä¸­çš„å›¾åƒå¸§æ˜¾ç¤ºåºå·PTS(int64_t),å¹¶æš‚æ—¶ä¿å­˜åœ¨pts(double)ä¸­ * 2ã€æ ¹æ®PTS*time_baseæ¥è®¡ç®—å½“å‰æ¡¢åœ¨æ•´ä¸ªè§†é¢‘ä¸­çš„æ˜¾ç¤ºæ—¶é—´æˆ³ï¼Œå³PTS*(1/framerate) * av_q2dæŠŠAVRatioalç»“æ„è½¬æ¢æˆdoubleçš„å‡½æ•°ï¼Œ * ç”¨äºè®¡ç®—è§†é¢‘æºæ¯ä¸ªå›¾åƒå¸§æ˜¾ç¤ºçš„é—´éš”æ—¶é—´(1/framerate),å³è¿”å›(time_base->num/time_base->den) -------------------------*/ //æ ¹æ®pts=PTS*time_base={numerator=1,denominator=25}è®¡ç®—å½“å‰æ¡¢åœ¨æ•´ä¸ªè§†é¢‘ä¸­çš„æ˜¾ç¤ºæ—¶é—´æˆ³ pts*=av_q2d(is->video_st->time_base);//time_baseä¸ºAVRationalæœ‰ç†æ•°ç»“æ„ä½“{num=1,den=25}ï¼Œè®°å½•äº†è§†é¢‘æºæ¯ä¸ªå›¾åƒå¸§æ˜¾ç¤ºçš„é—´éš”æ—¶é—´ // Did we get a video frameï¼Œæ£€æŸ¥æ˜¯å¦è§£ç å‡ºå®Œæ•´ä¸€å¸§å›¾åƒ if (frameFinished) { pts = synchronize_video(is, pFrame, pts);//æ£€æŸ¥å½“å‰å¸§çš„æ˜¾ç¤ºæ—¶é—´æˆ³ptså¹¶æ›´æ–°å†…éƒ¨è§†é¢‘æ’­æ”¾è®¡æ—¶å™¨(è®°å½•è§†é¢‘å·²ç»æ’­æ—¶é—´(video_clock)ï¼‰ if (queue_picture(is, pFrame, pts)audio_pkt;// ä¿å­˜ä»é˜Ÿåˆ—ä¸­æå–çš„æ•°æ®åŒ… double pts;//éŸ³é¢‘æ’­æ”¾æ—¶é—´æˆ³ for (;;) { while (is->audio_pkt_size>0) {// æ£€æŸ¥ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦(æ˜¯å¦å·²å®Œæˆä¸€ä¸ªå®Œæ•´çš„pakcetåŒ…çš„è§£ç ï¼Œä¸€ä¸ªæ•°æ®åŒ…ä¸­å¯èƒ½åŒ…å«å¤šä¸ªéŸ³é¢‘ç¼–ç å¸§) int got_frame = 0;// è§£ç æ“ä½œæˆåŠŸæ ‡è¯†ï¼ŒæˆåŠŸè¿”å›éé›¶å€¼ // è§£ç ä¸€å¸§éŸ³é¢‘æ•°æ®ï¼Œå¹¶è¿”å›æ¶ˆè€—çš„ç¼–ç æ•°æ®é•¿åº¦ coded_consumed_size = avcodec_decode_audio4(is->audio_st->codec, &is->audio_frame, &got_frame, pkt); if (coded_consumed_size audio_pkt_size = 0;// æ›´æ–°ç¼–ç æ•°æ®ç¼“å­˜é•¿åº¦ break; } if (got_frame) {// æ£€æŸ¥è§£ç æ“ä½œæ˜¯å¦æˆåŠŸ // è®¡ç®—è§£ç åéŸ³é¢‘æ•°æ®é•¿åº¦[output] data_size = av_samples_get_buffer_size(NULL, is->audio_st->codec->channels, is->audio_frame.nb_samples, is->audio_st->codec->sample_fmt, 1); memcpy(is->audio_buf, is->audio_frame.data[0], data_size);// å°†è§£ç æ•°æ®å¤åˆ¶åˆ°è¾“å‡ºç¼“å­˜ } is->audio_pkt_data += coded_consumed_size;// æ›´æ–°ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆä½ç½® is->audio_pkt_size -= coded_consumed_size;// æ›´æ–°ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦ if (data_size audio_clock;//ç”¨æ¯æ¬¡æ›´æ–°çš„éŸ³é¢‘æ’­æ”¾æ—¶é—´æ›´æ–°éŸ³é¢‘PTS *pts_ptr=pts; /*--------------------- * å½“ä¸€ä¸ªpacketä¸­åŒ…å«å¤šä¸ªéŸ³é¢‘å¸§æ—¶ * é€šè¿‡[è§£ç åéŸ³é¢‘åŸå§‹æ•°æ®é•¿åº¦]åŠ[é‡‡æ ·ç‡]æ¥æ¨ç®—ä¸€ä¸ªpacketä¸­å…¶ä»–éŸ³é¢‘å¸§çš„æ’­æ”¾æ—¶é—´æˆ³pts * é‡‡æ ·é¢‘ç‡44.1kHzï¼Œé‡åŒ–ä½æ•°16ä½ï¼Œæ„å‘³ç€æ¯ç§’é‡‡é›†æ•°æ®44.1kä¸ªï¼Œæ¯ä¸ªæ•°æ®å 2å­—èŠ‚ --------------------*/ pcm_bytes=2*is->audio_st->codec->channels;//è®¡ç®—æ¯ç»„éŸ³é¢‘é‡‡æ ·æ•°æ®çš„å­—èŠ‚æ•°=æ¯ä¸ªå£°é“éŸ³é¢‘é‡‡æ ·å­—èŠ‚æ•°*å£°é“æ•° /*----æ›´æ–°audio_clock--- * ä¸€ä¸ªpktåŒ…å«å¤šä¸ªéŸ³é¢‘frameï¼ŒåŒæ—¶ä¸€ä¸ªpktå¯¹åº”ä¸€ä¸ªpts(pkt->pts) * å› æ­¤ï¼Œè¯¥pktä¸­åŒ…å«çš„å¤šä¸ªéŸ³é¢‘å¸§çš„æ—¶é—´æˆ³ç”±ä»¥ä¸‹å…¬å¼æ¨æ–­å¾—å‡º * bytes_per_sec=pcm_bytes*is->audio_st->codec->sample_rate * ä»pktä¸­ä¸æ–­çš„è§£ç ï¼Œæ¨æ–­(ä¸€ä¸ªpktä¸­)æ¯å¸§æ•°æ®çš„ptså¹¶ç´¯åŠ åˆ°éŸ³é¢‘æ’­æ”¾æ—¶é’Ÿ --------------------*/ is->audio_clock+=(double)data_size/(double)(pcm_bytes*is->audio_st->codec->sample_rate); // We have data, return it and come back for more later. return data_size;// è¿”å›è§£ç æ•°æ®ç¼“å­˜é•¿åº¦ } if (pkt->data) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦å·²ä»é˜Ÿåˆ—ä¸­æå– av_packet_unref(pkt);// é‡Šæ”¾pktä¸­ä¿å­˜çš„ç¼–ç æ•°æ® } if (is->quit) {// æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† return -1; } // Next packetï¼Œä»é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…åˆ°pkt if (packet_queue_get(&is->audioq, pkt, 1) audio_pkt_data = pkt->data;// ä¼ é€’ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆ is->audio_pkt_size = pkt->size;// ä¼ é€’ç¼–ç æ•°æ®ç¼“å­˜é•¿åº¦ // If update, update the audio clock w/pts if (pkt->pts != AV_NOPTS_VALUE) {//æ£€æŸ¥éŸ³é¢‘æ’­æ”¾æ—¶é—´æˆ³ //è·å¾—ä¸€ä¸ªæ–°çš„packetçš„æ—¶å€™ï¼Œæ›´æ–°audio_clockï¼Œç”¨packetä¸­çš„ptsæ›´æ–°audio_clock(ä¸€ä¸ªpktå¯¹åº”ä¸€ä¸ªpts) is->audio_clock=pkt->pts*av_q2d(is->audio_st->time_base);//æ›´æ–°éŸ³é¢‘å·²ç»æ’­çš„æ—¶é—´ } } } /*------Audio Callback------- * éŸ³é¢‘è¾“å‡ºå›è°ƒå‡½æ•°ï¼Œsdlé€šè¿‡è¯¥å›è°ƒå‡½æ•°å°†è§£ç åçš„pcmæ•°æ®é€å…¥å£°å¡æ’­æ”¾, * sdlé€šå¸¸ä¸€æ¬¡ä¼šå‡†å¤‡ä¸€ç»„ç¼“å­˜pcmæ•°æ®ï¼Œé€šè¿‡è¯¥å›è°ƒé€å…¥å£°å¡ï¼Œå£°å¡æ ¹æ®éŸ³é¢‘ptsä¾æ¬¡æ’­æ”¾pcmæ•°æ® * å¾…é€å…¥ç¼“å­˜çš„pcmæ•°æ®å®Œæˆæ’­æ”¾åï¼Œå†è½½å…¥ä¸€ç»„æ–°çš„pcmç¼“å­˜æ•°æ®(æ¯æ¬¡éŸ³é¢‘è¾“å‡ºç¼“å­˜ä¸ºç©ºæ—¶ï¼Œsdlå°±è°ƒç”¨æ­¤å‡½æ•°å¡«å……éŸ³é¢‘è¾“å‡ºç¼“å­˜ï¼Œå¹¶é€å…¥å£°å¡æ’­æ”¾) * When we begin playing audio, SDL will continually call this callback function * and ask it to fill the audio buffer with a certain number of bytes * The audio function callback takes the following parameters: * stream: A pointer to the audio buffer to be filledï¼Œè¾“å‡ºéŸ³é¢‘æ•°æ®åˆ°å£°å¡ç¼“å­˜ * len: The length (in bytes) of the audio buffer,ç¼“å­˜é•¿åº¦wanted_spec.samples=SDL_AUDIO_BUFFER_SIZE(1024) --------------------------*/ void audio_callback(void *userdata, Uint8 *stream, int len) { VideoState *is = (VideoState *) userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® int wt_stream_len, audio_size;// æ¯æ¬¡å†™å…¥streamçš„æ•°æ®é•¿åº¦ï¼Œè§£ç åçš„æ•°æ®é•¿åº¦ double pts;//éŸ³é¢‘æ—¶é—´æˆ³ while (len > 0) {//æ£€æŸ¥éŸ³é¢‘ç¼“å­˜çš„å‰©ä½™é•¿åº¦ if (is->audio_buf_index >= is->audio_buf_size) {// æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰§è¡Œè§£ç æ“ä½œ // We have already sent all our data; get moreï¼Œä»ç¼“å­˜é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ã€è§£ç ï¼Œå¹¶è¿”å›è§£ç åçš„æ•°æ®é•¿åº¦ï¼Œaudio_bufç¼“å­˜ä¸­å¯èƒ½åŒ…å«å¤šå¸§è§£ç åçš„éŸ³é¢‘æ•°æ® audio_size = audio_decode_frame(is, &pts); if (audio_size audio_buf_size = 1024; memset(is->audio_buf, 0, is->audio_buf_size);// å…¨é›¶é‡ç½®ç¼“å†²åŒº } else { is->audio_buf_size = audio_size;// è¿”å›packetä¸­åŒ…å«çš„åŸå§‹éŸ³é¢‘æ•°æ®é•¿åº¦(å¤šå¸§) } is->audio_buf_index = 0;// åˆå§‹åŒ–ç´¯è®¡å†™å…¥ç¼“å­˜é•¿åº¦ }//end for if wt_stream_len=is->audio_buf_size-is->audio_buf_index;// è®¡ç®—è§£ç ç¼“å­˜å‰©ä½™é•¿åº¦ if (wt_stream_len > len) {// æ£€æŸ¥æ¯æ¬¡å†™å…¥ç¼“å­˜çš„æ•°æ®é•¿åº¦æ˜¯å¦è¶…è¿‡æŒ‡å®šé•¿åº¦(1024) wt_stream_len = len;// æŒ‡å®šé•¿åº¦ä»è§£ç çš„ç¼“å­˜ä¸­å–æ•°æ® } // æ¯æ¬¡ä»è§£ç çš„ç¼“å­˜æ•°æ®ä¸­ä»¥æŒ‡å®šé•¿åº¦æŠ½å–æ•°æ®å¹¶å†™å…¥streamä¼ é€’ç»™å£°å¡ memcpy(stream, (uint8_t *)is->audio_buf + is->audio_buf_index, wt_stream_len); len -= wt_stream_len;// æ›´æ–°è§£ç éŸ³é¢‘ç¼“å­˜çš„å‰©ä½™é•¿åº¦ stream += wt_stream_len;// æ›´æ–°ç¼“å­˜å†™å…¥ä½ç½® is->audio_buf_index += wt_stream_len;// æ›´æ–°ç´¯è®¡å†™å…¥ç¼“å­˜æ•°æ®é•¿åº¦ }//end for while } // æ ¹æ®æŒ‡å®šç±»å‹æ‰“å¼€æµï¼Œæ‰¾åˆ°å¯¹åº”çš„è§£ç å™¨ã€åˆ›å»ºå¯¹åº”çš„éŸ³é¢‘é…ç½®ã€ä¿å­˜å…³é”®ä¿¡æ¯åˆ° VideoStateã€å¯åŠ¨éŸ³é¢‘å’Œè§†é¢‘çº¿ç¨‹ int stream_component_open(VideoState *is, int stream_index) { AVFormatContext *pFormatCtx = is->pFormatCtx;// ä¼ é€’æ–‡ä»¶å®¹å™¨çš„å°è£…ä¿¡æ¯åŠç æµå‚æ•° AVCodecContext *codecCtx = NULL;// è§£ç å™¨ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œè§£ç å™¨ä¾èµ–çš„ç›¸å…³ç¯å¢ƒã€çŠ¶æ€ã€èµ„æºä»¥åŠå‚æ•°é›†çš„æ¥å£æŒ‡é’ˆ AVCodec *codec = NULL;// ä¿å­˜ç¼–è§£ç å™¨ä¿¡æ¯çš„ç»“æ„ä½“ï¼Œæä¾›ç¼–ç ä¸è§£ç çš„å…¬å…±æ¥å£ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ç¼–ç å™¨ä¸è§£ç å™¨çš„ä¸€ä¸ªå…¨å±€å˜é‡ //æ£€æŸ¥è¾“å…¥çš„æµç±»å‹æ˜¯å¦åœ¨åˆç†èŒƒå›´å†… if (stream_index = pFormatCtx->nb_streams) { return -1; } // Get a pointer to the codec context for the video stream. codecCtx = pFormatCtx->streams[stream_index]->codec;// å–å¾—è§£ç å™¨ä¸Šä¸‹æ–‡ if (codecCtx->codec_type == AVMEDIA_TYPE_AUDIO) {//æ£€æŸ¥è§£ç å™¨ç±»å‹æ˜¯å¦ä¸ºéŸ³é¢‘è§£ç å™¨ SDL_AudioSpec wanted_spec, spec;//SDL_AudioSpec a structure that contains the audio output formatï¼Œåˆ›å»º SDL_AudioSpec ç»“æ„ä½“ï¼Œè®¾ç½®éŸ³é¢‘æ’­æ”¾æ•°æ® // Set audio settings from codec info,SDL_AudioSpec a structure that contains the audio output format // åˆ›å»ºSDL_AudioSpecç»“æ„ä½“ï¼Œè®¾ç½®éŸ³é¢‘æ’­æ”¾å‚æ•° wanted_spec.freq = codecCtx->sample_rate;//é‡‡æ ·é¢‘ç‡ DSP frequency -- samples per second wanted_spec.format = AUDIO_S16SYS;//é‡‡æ ·æ ¼å¼ Audio data format wanted_spec.channels = codecCtx->channels;//å£°é“æ•° Number of channels: 1 mono, 2 stereo wanted_spec.silence = 0;//æ— è¾“å‡ºæ—¶æ˜¯å¦é™éŸ³ //é»˜è®¤æ¯æ¬¡è¯»éŸ³é¢‘ç¼“å­˜çš„å¤§å°ï¼Œæ¨èå€¼ä¸º 512~8192ï¼Œffplayä½¿ç”¨çš„æ˜¯1024 specifies a unit of audio data refers to the size of the audio buffer in sample frames wanted_spec.samples = SDL_AUDIO_BUFFER_SIZE; wanted_spec.callback = audio_callback;//è®¾ç½®è¯»å–éŸ³é¢‘æ•°æ®çš„å›è°ƒæ¥å£å‡½æ•° the function to call when the audio device needs more data wanted_spec.userdata = is;//ä¼ é€’ç”¨æˆ·æ•°æ® /*--------------------------- * ä»¥æŒ‡å®šå‚æ•°æ‰“å¼€éŸ³é¢‘è®¾å¤‡ï¼Œå¹¶è¿”å›ä¸æŒ‡å®šå‚æ•°æœ€ä¸ºæ¥è¿‘çš„å‚æ•°ï¼Œè¯¥å‚æ•°ä¸ºè®¾å¤‡å®é™…æ”¯æŒçš„éŸ³é¢‘å‚æ•° * Opens the audio device with the desired parameters(wanted_spec) * return another specs we actually be using * and not guaranteed to get what we asked for --------------------------*/ if (SDL_OpenAudio(&wanted_spec, &spec) codec_id); AVDictionary *optionsDict = NULL; if (!codec || (avcodec_open2(codecCtx, codec, &optionsDict) name); // æ£€æŸ¥è§£ç å™¨ç±»å‹ switch(codecCtx->codec_type) { case AVMEDIA_TYPE_AUDIO:// éŸ³é¢‘è§£ç å™¨ is->audioStream = stream_index;// éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ– is->audio_st = pFormatCtx->streams[stream_index]; is->audio_buf_size = 0;// è§£ç åçš„å¤šå¸§éŸ³é¢‘æ•°æ®é•¿åº¦ is->audio_buf_index = 0;//ç´¯ è®¡å†™å…¥streamçš„é•¿åº¦ memset(&is->audio_pkt, 0, sizeof(is->audio_pkt)); packet_queue_init(&is->audioq);// éŸ³é¢‘æ•°æ®åŒ…é˜Ÿåˆ—åˆå§‹åŒ– SDL_PauseAudio(0);// audio callback starts running againï¼Œå¼€å¯éŸ³é¢‘è®¾å¤‡ï¼Œå¦‚æœè¿™æ—¶å€™æ²¡æœ‰è·å¾—æ•°æ®é‚£ä¹ˆå®ƒå°±é™éŸ³ break; case AVMEDIA_TYPE_VIDEO:// è§†é¢‘è§£ç å™¨ is->videoStream = stream_index;// è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ– is->video_st = pFormatCtx->streams[stream_index]; //ä»¥ç³»ç»Ÿæ—¶é—´ä¸ºåŸºå‡†ï¼Œåˆå§‹åŒ–æ’­æ”¾åˆ°å½“å‰å¸§çš„å·²æ’­æ”¾æ—¶é—´å€¼ï¼Œè¯¥å€¼ä¸ºçœŸå®æ—¶é—´å€¼ã€åŠ¨æ€æ—¶é—´å€¼ã€ç»å¯¹æ—¶é—´å€¼ is->frame_timer=(double)av_gettime()/1000000.0; is->frame_last_delay = 40e-3;//åˆå§‹åŒ–ä¸Šä¸€å¸§å›¾åƒçš„åŠ¨æ€åˆ·æ–°å»¶è¿Ÿæ—¶é—´ packet_queue_init(&is->videoq);// è§†é¢‘æ•°æ®åŒ…é˜Ÿåˆ—åˆå§‹åŒ– is->decode_tid = SDL_CreateThread(decode_thread,\"è§†é¢‘è§£ç çº¿ç¨‹\" ,is);// åˆ›å»ºè§†é¢‘è§£ç çº¿ç¨‹ // Initialize SWS context for software scalingï¼Œè®¾ç½®å›¾åƒè½¬æ¢åƒç´ æ ¼å¼ä¸ºAV_PIX_FMT_YUV420P is->sws_ctx = sws_getContext(is->video_st->codec->width, is->video_st->codec->height, is->video_st->codec->pix_fmt, is->video_st->codec->width, is->video_st->codec->height, AV_PIX_FMT_YUV420P, SWS_BILINEAR, NULL, NULL, NULL); break; default: break; } return 0; } // ç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹å‡½æ•°(ä»è§†é¢‘æ–‡ä»¶ä¸­è§£æå‡ºéŸ³è§†é¢‘ç¼–ç æ•°æ®å•å…ƒï¼Œä¸€ä¸ªAVPacketçš„dataé€šå¸¸å¯¹åº”ä¸€ä¸ªNAL) int parse_thread(void *arg) { VideoState *is = (VideoState *)arg;// ä¼ é€’ç”¨æˆ·å‚æ•° global_video_state = is;// ä¼ é€’å…¨å±€çŠ¶æ€å‚é‡ç»“æ„ä½“ /*------------------------- * æ‰“å¼€å°è£…æ ¼å¼ * æ‰“å¼€è§†é¢‘æ–‡ä»¶ï¼Œè¯»æ–‡ä»¶å¤´å†…å®¹ï¼Œå–å¾—æ–‡ä»¶å®¹å™¨çš„å°è£…ä¿¡æ¯åŠç æµå‚æ•°å¹¶å­˜å‚¨åœ¨avformat_contextä¸­ * å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ * å‚æ•°äºŒï¼šè§†é¢‘è·¯å¾„ * å‚æ•°ä¸‰ï¼šæŒ‡å®šè¾“å…¥çš„æ ¼å¼ * å‚æ•°å››ï¼šè®¾ç½®é»˜è®¤å‚æ•° --------------------------*/ AVFormatContext *avformat_context = NULL;// å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ int avformat_open_input_result = avformat_open_input(&avformat_context, is->filename, NULL, NULL); if (avformat_open_input_result != 0){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æŸ¥æ‰¾éŸ³è§†é¢‘æµ\\n\"); return -1; } is->pFormatCtx = avformat_context;//ä¼ é€’æ–‡ä»¶å®¹å™¨å°è£…ä¿¡æ¯åŠç æµå‚æ•° /*------------------------- * æŸ¥æ‰¾ç æµ * å–å¾—æ–‡ä»¶ä¸­ä¿å­˜çš„ç æµä¿¡æ¯ï¼Œå¹¶å¡«å……åˆ°avformat_context->stream å­—æ®µ * å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ * å‚æ•°äºŒï¼šæŒ‡å®šé»˜è®¤é…ç½® -------------------------*/ int avformat_find_stream_info_result = avformat_find_stream_info(avformat_context, NULL); if (avformat_find_stream_info_result videoStream = -1;//è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 is->audioStream = -1;//éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 // è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 int av_video_stream_index = -1; // éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 int av_audio_stream_index = -1; for (int i = 0; i nb_streams; ++i) { // è‹¥æ–‡ä»¶ä¸­åŒ…å«æœ‰è§†é¢‘æµ if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_VIDEO){ av_video_stream_index = i; } // è‹¥æ–‡ä»¶ä¸­åŒ…å«æœ‰éŸ³é¢‘æµ if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_AUDIO){ av_audio_stream_index = i; } } // æ£€æŸ¥æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨è§†é¢‘æµ if (av_video_stream_index == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ²¡æœ‰æ‰¾åˆ°è§†é¢‘æµ\\n\"); goto fail;//è·³è½¬è‡³å¼‚å¸¸å¤„ç† return -1; } // æ£€æŸ¥æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨éŸ³é¢‘æµ if (av_audio_stream_index == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ²¡æœ‰æ‰¾åˆ°éŸ³é¢‘æµ\\n\"); goto fail;//è·³è½¬è‡³å¼‚å¸¸å¤„ç† return -1; } stream_component_open(is, av_audio_stream_index);// æ ¹æ®æŒ‡å®šç±»å‹æ‰“å¼€éŸ³é¢‘æµ stream_component_open(is, av_video_stream_index);// æ ¹æ®æŒ‡å®šç±»å‹æ‰“å¼€è§†é¢‘æµ // Main decode loop. for (;;) { if (is->quit) {//æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† break; } // Seek stuff goes hereï¼Œæ£€æŸ¥éŸ³è§†é¢‘ç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—é•¿åº¦æ˜¯å¦æº¢å‡º if (is->audioq.size > MAX_AUDIOQ_SIZE || is->videoq.size > MAX_VIDEOQ_SIZE) { SDL_Delay(10); continue; } /*----------------------- * read in a packet and store it in the AVPacket struct * ffmpeg allocates the internal data for us,which is pointed to by packet.data * this is freed by the av_free_packet() -----------------------*/ // è´Ÿè´£ä¿å­˜å‹ç¼©ç¼–ç æ•°æ®ç›¸å…³ä¿¡æ¯çš„ç»“æ„ä½“,æ¯å¸§å›¾åƒç”±ä¸€åˆ°å¤šä¸ªpacketåŒ…ç»„æˆ AVPacket pkt, *packet = &pkt;// åœ¨æ ˆä¸Šåˆ›å»ºä¸´æ—¶æ•°æ®åŒ…å¯¹è±¡å¹¶å…³è”æŒ‡é’ˆ if (av_read_frame(is->pFormatCtx, packet) pFormatCtx->pb->error == 0) { SDL_Delay(100); // No error; wait for user input. continue; } else { break; } } // Is this a packet from the video stream? if (packet->stream_index == is->videoStream) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºè§†é¢‘ç±»å‹ packet_queue_put(&is->videoq, packet);// å‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… } else if (packet->stream_index == is->audioStream) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºéŸ³é¢‘ç±»å‹ packet_queue_put(&is->audioq, packet);// å‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… } else {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºå­—å¹•ç±»å‹ av_packet_unref(packet);// é‡Šæ”¾packetä¸­ä¿å­˜çš„(å­—å¹•)ç¼–ç æ•°æ® } } // All done - wait for it. while (!is->quit) { SDL_Delay(100); } fail:// å¼‚å¸¸å¤„ç† if (1) { SDL_Event event;// SDLäº‹ä»¶å¯¹è±¡ event.type = FF_QUIT_EVENT;// æŒ‡å®šé€€å‡ºäº‹ä»¶ç±»å‹ event.user.data1 = is;// ä¼ é€’ç”¨æˆ·æ•°æ® SDL_PushEvent(&event);// å°†è¯¥äº‹ä»¶å¯¹è±¡å‹å…¥SDLåå°äº‹ä»¶é˜Ÿåˆ— } return 0; } int init_sdl(VideoState *is) { // åˆå§‹åŒ–SDLå¤šåª’ä½“æ¡†æ¶ if (SDL_Init( SDL_INIT_VIDEO | SDL_INIT_AUDIO | SDL_INIT_TIMER ) == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); return -1; } // åˆå§‹åŒ–SDLçª—å£ SDL_Window* sdl_window = SDL_CreateWindow(\"FFmpeg+SDLæ’­æ”¾è§†é¢‘\",// å‚æ•°ä¸€ï¼šçª—å£åç§° SDL_WINDOWPOS_CENTERED,// å‚æ•°äºŒï¼šçª—å£åœ¨å±å¹•ä¸Šçš„xåæ ‡ SDL_WINDOWPOS_CENTERED,// å‚æ•°ä¸‰ï¼šçª—å£åœ¨å±å¹•ä¸Šçš„yåæ ‡ is->video_width,// å‚æ•°å››ï¼šçª—å£åœ¨å±å¹•ä¸Šå®½ is->video_height,// å‚æ•°äº”ï¼šçª—å£åœ¨å±å¹•ä¸Šé«˜ SDL_WINDOW_OPENGL);// å‚æ•°å…­ï¼šçª—å£çŠ¶æ€(æ‰“å¼€) if (sdl_window == NULL){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"çª—å£åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çª—å£åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } // åˆ›å»ºæ¸²æŸ“å™¨ // å®šä¹‰æ¸²æŸ“å™¨åŒºåŸŸ SDL_Renderer* sdl_renderer = SDL_CreateRenderer(sdl_window,// æ¸²æŸ“ç›®æ ‡åˆ›å»º -1, // ä»é‚£é‡Œå¼€å§‹æ¸²æŸ“(-1:è¡¨ç¤ºä»ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹) 0);// æ¸²æŸ“ç±»å‹(è½¯ä»¶æ¸²æŸ“) if (sdl_renderer == NULL){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } // åˆ›å»ºçº¹ç† SDL_Texture* sdl_texture = SDL_CreateTexture(sdl_renderer,// æ¸²æŸ“å™¨ SDL_PIXELFORMAT_IYUV,// åƒç´ æ•°æ®æ ¼å¼ SDL_TEXTUREACCESS_STREAMING,// ç»˜åˆ¶æ–¹å¼ï¼šé¢‘ç¹ç»˜åˆ¶- is->video_width,// çº¹ç†å®½ is->video_height);// çº¹ç†é«˜ if (sdl_texture == NULL) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } is->sdl_renderer = sdl_renderer; is->sdl_texture = sdl_texture; return 0; } // SDLå…¥å£ extern \"C\" int main(int argc, char *argv[]) { /*------------------------- * æ³¨å†Œç»„ä»¶ * æ³¨å†Œæ‰€æœ‰ffmpegæ”¯æŒçš„å¤šåª’ä½“æ ¼å¼åŠç¼–è§£ç å™¨ -------------------------*/ av_register_all(); // åˆ›å»ºå…¨å±€çŠ¶æ€å¯¹è±¡ VideoState *is= (VideoState *)av_mallocz(sizeof(VideoState)); av_strlcpy(is->filename, \"/storage/emulated/0/Download/test.mov\", sizeof(is->filename));// å¤åˆ¶è§†é¢‘æ–‡ä»¶è·¯å¾„å is->video_width = 640; is->video_height = 352; is->pictq_lock = SDL_CreateMutex();// åˆ›å»ºç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—äº’æ–¥é”å¯¹è±¡ is->pictq_ready = SDL_CreateCond();// åˆ›å»ºç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å¯¹è±¡ int init_sdl_result = init_sdl(is); if (init_sdl_result parse_tid = SDL_CreateThread(parse_thread, \"ç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹\", is); if (!is->parse_tid) {// æ£€æŸ¥çº¿ç¨‹æ˜¯å¦åˆ›å»ºæˆåŠŸ av_free(is); return -1; } // SDLäº‹ä»¶å¯¹è±¡ SDL_Event event; for (;;) {// SDLäº‹ä»¶å¾ªç¯ SDL_WaitEvent(&event);// ä¸»çº¿ç¨‹é˜»å¡ï¼Œç­‰å¾…äº‹ä»¶åˆ°æ¥ switch(event.type) {// äº‹ä»¶åˆ°æ¥åå”¤é†’ä¸»çº¿ç¨‹ï¼Œæ£€æŸ¥äº‹ä»¶ç±»å‹ case FF_QUIT_EVENT: case SDL_QUIT:// é€€å‡ºè¿›ç¨‹äº‹ä»¶ is->quit = 1; // If the video has finished playing, then both the picture and audio queues are waiting for more data. // Make them stop waiting and terminate normally.. avcodec_close(is->video_st->codec); avformat_free_context(is->pFormatCtx); SDL_CondSignal(is->audioq.qready);// å‘å‡ºé˜Ÿåˆ—å°±ç»ªä¿¡å·é¿å…æ­»é” SDL_CondSignal(is->videoq.qready); SDL_DestroyTexture(is->sdl_texture); SDL_DestroyRenderer(is->sdl_renderer); SDL_Quit(); return 0; case FF_ALLOC_EVENT: alloc_picture(event.user.data1);// åˆ†é…è§†é¢‘å¸§äº‹ä»¶å“åº”å‡½æ•° break; case FF_REFRESH_EVENT:// è§†é¢‘æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶ video_refresh_timer(event.user.data1);// è§†é¢‘æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶å“åº”å‡½æ•° break; default: break; } } return 0; } "},"pages/FFmpeg/FFmpeg_SDLåŒæ­¥éŸ³é¢‘.html":{"url":"pages/FFmpeg/FFmpeg_SDLåŒæ­¥éŸ³é¢‘.html","title":"FFmpeg+SDLåŒæ­¥éŸ³é¢‘","keywords":"","body":"FFmpeg+SDLåŒæ­¥éŸ³é¢‘ Androidå·¥ç¨‹ä»£ç  iOSå·¥ç¨‹ä»£ç  ffmpegæ’­æ”¾å™¨å®ç°è¯¦è§£ - éŸ³é¢‘åŒæ­¥æ§åˆ¶ï¼šhttps://www.cnblogs.com/breakpointlab/p/15791998.html æºä»£ç ä¸€è§ˆ #include #include #include #include #include \"SDL.h\" #include #define SDL_AUDIO_BUFFER_SIZE 1024 #define MAX_AUDIO_FRAME_SIZE 192000 #define AV_SYNC_THRESHOLD 0.01//å‰åä¸¤å¸§é—´çš„æ˜¾ç¤ºæ—¶é—´é—´éš”çš„æœ€å°å€¼0.01s #define AV_NOSYNC_THRESHOLD 10.0//æœ€å°åˆ·æ–°é—´éš”æ—¶é—´10ms #define MAX_AUDIOQ_SIZE (5 * 16 * 1024) #define MAX_VIDEOQ_SIZE (5 * 256 * 1024) #define FF_ALLOC_EVENT (SDL_USEREVENT) #define FF_REFRESH_EVENT (SDL_USEREVENT + 1) #define FF_QUIT_EVENT (SDL_USEREVENT + 2) #define VIDEO_PICTURE_QUEUE_SIZE 1 #define SAMPLE_CORRECTION_PERCENT_MAX 10 #define AUDIO_DIFF_AVG_NB 20 extern \"C\" { #include #include \"libavformat/avformat.h\" #include #include #include #include #include #include } uint64_t global_video_pkt_pts = AV_NOPTS_VALUE; enum {//åŒæ­¥æ—¶é’Ÿæº AV_SYNC_AUDIO_MASTER,//éŸ³é¢‘æ—¶é’Ÿä¸ºä¸»åŒæ­¥æº AV_SYNC_VIDEO_MASTER,//è§†é¢‘æ—¶é’Ÿä¸ºä¸»åŒæ­¥æº AV_SYNC_EXTERNAL_MASTER,//å¤–éƒ¨æ—¶é’Ÿä¸ºä¸»åŒæ­¥æº }; #define DEFAULT_AV_SYNC_TYPE AV_SYNC_AUDIO_MASTER//æŒ‡å®šä»¥è§†é¢‘æ—¶é’Ÿä¸ºä¸»åŒæ­¥æº(æ—¶é—´åŸºå‡†) /*-------é“¾è¡¨èŠ‚ç‚¹ç»“æ„ä½“-------- typedef struct AVPacketList { AVPacket pkt;//é“¾è¡¨æ•°æ® struct AVPacketList *next;//é“¾è¡¨åç»§èŠ‚ç‚¹ } AVPacketList; ---------------------------*/ // æ•°æ®åŒ…é˜Ÿåˆ—(é“¾è¡¨)ç»“æ„ä½“ typedef struct PacketQueue { AVPacketList *first_pkt, *last_pkt;// é˜Ÿåˆ—é¦–å°¾èŠ‚ç‚¹æŒ‡é’ˆ int nb_packets;// é˜Ÿåˆ—é•¿åº¦ int size;// ä¿å­˜ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ï¼Œsize=packet->size SDL_mutex *qlock;// é˜Ÿåˆ—äº’æ–¥é‡ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® SDL_cond *qready;// é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å˜é‡ } PacketQueue; // å›¾åƒå¸§ç»“æ„ä½“ typedef struct VideoPicture { AVFrame *avframe_yuv420p; int width, height;//Source height & width. int allocated;//æ˜¯å¦åˆ†é…å†…å­˜ç©ºé—´ï¼Œè§†é¢‘å¸§è½¬æ¢ä¸ºSDL overlayæ ‡è¯† double pts;//å½“å‰å›¾åƒå¸§çš„ç»å¯¹æ˜¾ç¤ºæ—¶é—´æˆ³ } VideoPicture; typedef struct VideoState { AVFormatContext *pFormatCtx;// ä¿å­˜æ–‡ä»¶å®¹å™¨å°è£…ä¿¡æ¯åŠç æµå‚æ•°çš„ç»“æ„ä½“ AVStream *video_st;// è§†é¢‘æµä¿¡æ¯ç»“æ„ä½“ AVStream *audio_st;//éŸ³é¢‘æµä¿¡æ¯ç»“æ„ä½“ struct SwsContext *sws_ctx;// æè¿°è½¬æ¢å™¨å‚æ•°çš„ç»“æ„ä½“ struct SwsContext *sws_ctx_audio; PacketQueue videoq;// è§†é¢‘ç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—(ç¼–ç æ•°æ®é˜Ÿåˆ—ï¼Œä»¥é“¾è¡¨æ–¹å¼å®ç°) VideoPicture pictq[VIDEO_PICTURE_QUEUE_SIZE]; int pictq_size, pictq_rindex, pictq_windex;// é˜Ÿåˆ—é•¿åº¦ï¼Œè¯»/å†™ä½ç½®ç´¢å¼• SDL_mutex *pictq_lock;// é˜Ÿåˆ—è¯»å†™é”å¯¹è±¡ï¼Œä¿æŠ¤å›¾åƒå¸§é˜Ÿåˆ—æ•°æ® SDL_cond *pictq_ready;// é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å˜é‡ SDL_Rect sdl_rect; SDL_Renderer* sdl_renderer; SDL_Texture* sdl_texture; PacketQueue audioq;// éŸ³é¢‘ç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—(ç¼–ç æ•°æ®é˜Ÿåˆ—ï¼Œä»¥é“¾è¡¨æ–¹å¼å®ç°) uint8_t audio_buf[(MAX_AUDIO_FRAME_SIZE*3)/2];//ä¿å­˜è§£ç ä¸€ä¸ªpacketåçš„å¤šå¸§åŸå§‹éŸ³é¢‘æ•°æ®(è§£ç æ•°æ®é˜Ÿåˆ—ï¼Œä»¥æ•°ç»„æ–¹å¼å®ç°) unsigned int audio_buf_size;//è§£ç åçš„å¤šå¸§éŸ³é¢‘æ•°æ®é•¿åº¦ unsigned int audio_buf_index;//ç´¯è®¡å†™å…¥streamçš„é•¿åº¦ uint8_t *audio_pkt_data;//ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆä½ç½® int audio_pkt_size;//ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦(æ˜¯å¦å·²å®Œæˆä¸€ä¸ªå®Œæ•´çš„pakcetåŒ…çš„è§£ç ï¼Œä¸€ä¸ªæ•°æ®åŒ…ä¸­å¯èƒ½åŒ…å«å¤šä¸ªéŸ³é¢‘ç¼–ç å¸§) AVPacket audio_pkt;//ä¿å­˜ä»é˜Ÿåˆ—ä¸­æå–çš„æ•°æ®åŒ… AVFrame audio_frame;//ä¿å­˜ä»æ•°æ®åŒ…ä¸­è§£ç çš„éŸ³é¢‘æ•°æ® int video_width; int video_height; char filename[1024];// è¾“å…¥æ–‡ä»¶å®Œæ•´è·¯å¾„å int videoStream, audioStream;// éŸ³è§†é¢‘æµç±»å‹æ ‡å· SDL_Thread *parse_tid;// ç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹id SDL_Thread *decode_tid;// è§£ç çº¿ç¨‹id int quit;// å…¨å±€é€€å‡ºè¿›ç¨‹æ ‡è¯†ï¼Œåœ¨ç•Œé¢ä¸Šç‚¹äº†é€€å‡ºåï¼Œå‘Šè¯‰çº¿ç¨‹é€€å‡º //video/audio_clock save pts of last decoded frame/predicted pts of next decoded frame double video_clock;//keep track of how much time has passed according to the video double audio_clock; double frame_timer;//è§†é¢‘æ’­æ”¾åˆ°å½“å‰å¸§æ—¶çš„ç´¯è®¡å·²æ’­æ”¾æ—¶é—´ double frame_last_pts;//ä¸Šä¸€å¸§å›¾åƒçš„æ˜¾ç¤ºæ—¶é—´æˆ³ï¼Œç”¨äºåœ¨video_refersh_timerä¸­ä¿å­˜ä¸Šä¸€å¸§çš„ptså€¼ double frame_last_delay;//ä¸Šä¸€å¸§å›¾åƒçš„åŠ¨æ€åˆ·æ–°å»¶è¿Ÿæ—¶é—´ int av_sync_type;//ä¸»åŒæ­¥æºç±»å‹ double external_clock;//External clock base int64_t external_clock_time;//å¤–éƒ¨æ—¶é’Ÿçš„ç»å¯¹æ—¶é—´ double audio_diff_cum;//éŸ³é¢‘æ—¶é’Ÿä¸åŒæ­¥æºç´¯è®¡æ—¶å·®ï¼Œsed for AV difference average computation double audio_diff_avg_coef;//éŸ³é¢‘æ—¶é’Ÿä¸åŒæ­¥æºæ—¶å·®å‡å€¼åŠ æƒç³»æ•° double audio_diff_threshold;//éŸ³é¢‘æ—¶é’Ÿä¸åŒæ­¥æºæ—¶å·®å‡å€¼é˜ˆå€¼ int audio_diff_avg_count;//éŸ³é¢‘ä¸åŒæ­¥è®¡æ•°(éŸ³é¢‘æ—¶é’Ÿä¸ä¸»åŒæ­¥æºå­˜åœ¨ä¸åŒæ­¥çš„æ¬¡æ•°) int audio_hw_buf_size; double video_current_pts;//å½“å‰å¸§æ˜¾ç¤ºæ—¶é—´æˆ³ï¼ŒCurrent displayed pts (different from video_clock if frame fifos are used) int64_t video_current_pts_time;//å–å¾—video_current_ptsçš„ç³»ç»Ÿæ—¶é—´ï¼Œtime (av_gettime) at which we updated video_current_pts - used to have running video pts } VideoState;// Since we only have one decoding thread, the Big Struct can be global in case we need it. VideoState *global_video_state; /*------å–å¾—å½“å‰æ’­æ”¾éŸ³é¢‘æ•°æ®çš„pts------ * éŸ³è§†é¢‘åŒæ­¥çš„åŸç†æ˜¯æ ¹æ®éŸ³é¢‘çš„ptsæ¥æ§åˆ¶è§†é¢‘çš„æ’­æ”¾ * ä¹Ÿå°±æ˜¯è¯´åœ¨è§†é¢‘è§£ç ä¸€å¸§åï¼Œæ˜¯å¦æ˜¾ç¤ºä»¥åŠæ˜¾ç¤ºå¤šé•¿æ—¶é—´ï¼Œæ˜¯é€šè¿‡è¯¥å¸§çš„PTSä¸åŒæ—¶æ­£åœ¨æ’­æ”¾çš„éŸ³é¢‘çš„PTSæ¯”è¾ƒè€Œæ¥çš„ * å¦‚æœéŸ³é¢‘çš„PTSè¾ƒå¤§ï¼Œåˆ™è§†é¢‘å‡†å¤‡å®Œæ¯•ç«‹å³åˆ·æ–°ï¼Œå¦åˆ™ç­‰å¾… * * å› ä¸ºpcmæ•°æ®é‡‡ç”¨audio_callbackå›è°ƒæ–¹å¼è¿›è¡Œæ’­æ”¾ * å¯¹äºéŸ³é¢‘æ’­æ”¾æˆ‘ä»¬åªèƒ½å¾—åˆ°å†™å…¥å›è°ƒå‡½æ•°å‰ç¼“å­˜éŸ³é¢‘å¸§çš„ptsï¼Œè€Œæ— æ³•å¾—åˆ°å½“å‰æ’­æ”¾å¸§çš„pts(éœ€è¦é‡‡ç”¨å½“å‰æ’­æ”¾éŸ³é¢‘å¸§çš„ptsä½œä¸ºå‚è€ƒæ—¶é’Ÿ) * è€ƒè™‘åˆ°éŸ³é¢‘çš„å¤§å°ä¸æ’­æ”¾æ—¶é—´æˆæ­£æ¯”(ç›¸åŒé‡‡æ ·ç‡)ï¼Œé‚£ä¹ˆå½“å‰æ—¶åˆ»æ­£åœ¨æ’­æ”¾çš„éŸ³é¢‘å¸§pts(ä½äºå›è°ƒå‡½æ•°ç¼“å­˜ä¸­) * å°±å¯ä»¥æ ¹æ®å·²é€å…¥å£°å¡çš„pcmæ•°æ®é•¿åº¦ã€ç¼“å­˜ä¸­å‰©ä½™pcmæ•°æ®é•¿åº¦ï¼Œç¼“å­˜é•¿åº¦åŠé‡‡æ ·ç‡è¿›è¡Œæ¨ç®—äº† --------------------------------*/ double get_audio_clock(VideoState *is) { double pts=is->audio_clock;//Maintained in the audio threadï¼Œå–å¾—è§£ç æ“ä½œå®Œæˆæ—¶çš„å½“å‰æ’­æ”¾æ—¶é—´æˆ³ //è¿˜æœª(é€å…¥å£°å¡)æ’­æ”¾çš„å‰©ä½™åŸå§‹éŸ³é¢‘æ•°æ®é•¿åº¦ï¼Œç­‰äºè§£ç åçš„å¤šå¸§åŸå§‹éŸ³é¢‘æ•°æ®é•¿åº¦-ç´¯è®¡é€å…¥å£°å¡çš„é•¿åº¦ int hw_buf_size=is->audio_buf_size-is->audio_buf_index;//è®¡ç®—å½“å‰éŸ³é¢‘è§£ç æ•°æ®ç¼“å­˜ç´¢å¼•ä½ç½® int bytes_per_sec=0;//æ¯ç§’çš„åŸå§‹éŸ³é¢‘å­—èŠ‚æ•° int pcm_bytes=is->audio_st->codec->channels*2;//æ¯ç»„åŸå§‹éŸ³é¢‘æ•°æ®å­—èŠ‚æ•°=å£°é“æ•°*æ¯å£°é“æ•°æ®å­—èŠ‚æ•° if (is->audio_st) { bytes_per_sec=is->audio_st->codec->sample_rate*pcm_bytes;//è®¡ç®—æ¯ç§’çš„åŸå§‹éŸ³é¢‘å­—èŠ‚æ•° } if (bytes_per_sec) {//æ£€æŸ¥æ¯ç§’çš„åŸå§‹éŸ³é¢‘å­—èŠ‚æ•° pts-=(double)hw_buf_size/bytes_per_sec;//æ ¹æ®é€å…¥å£°å¡ç¼“å­˜çš„ç´¢å¼•ä½ç½®ï¼Œå¾€å‰å€’æ¨è®¡ç®—å½“å‰æ—¶åˆ»çš„éŸ³é¢‘æ’­æ”¾æ—¶é—´æˆ³pts } return pts;//è¿”å›å½“å‰æ­£åœ¨æ’­æ”¾çš„éŸ³é¢‘æ—¶é—´æˆ³ } /*-----------å–å¾—è§†é¢‘æ—¶é’Ÿ----------- * å³å–å¾—å½“å‰æ’­æ”¾è§†é¢‘å¸§çš„ptsï¼Œä»¥è§†é¢‘æ—¶é’Ÿptsä½œä¸ºéŸ³è§†é¢‘åŒæ­¥åŸºå‡†ï¼Œreturn the current time offset of the video currently being played * è¯¥å€¼ä¸ºå½“å‰å¸§æ—¶é—´æˆ³pts+ä¸€ä¸ªå¾®å°çš„ä¿®æ­£å€¼delta * å› ä¸ºåœ¨msçš„çº§åˆ«ä¸Šï¼Œåœ¨æ¯«ç§’çº§åˆ«ä¸Šï¼Œè‹¥å–å¾—è§†é¢‘æ—¶é’Ÿ(å³å½“å‰å¸§pts)çš„æ—¶åˆ»ï¼Œä¸è°ƒç”¨è§†é¢‘æ—¶é’Ÿçš„æ—¶åˆ»(å¦‚å°†éŸ³é¢‘åŒæ­¥åˆ°è¯¥è§†é¢‘ptsæ—¶åˆ»)å­˜åœ¨å»¶è¿Ÿ * é‚£ä¹ˆï¼Œè§†é¢‘æ—¶é’Ÿéœ€è¦åœ¨è¢«è°ƒç”¨æ—¶è¿›è¡Œä¿®æ­£ï¼Œä¿®æ­£å€¼deltaä¸º * delta=[å–å¾—è§†é¢‘æ—¶é’Ÿçš„æ—¶åˆ»å€¼video_current_pts_time] åˆ° [è°ƒç”¨get_video_clockæ—¶åˆ»å€¼] çš„é—´éš”æ—¶é—´ * é€šå¸¸æƒ…å†µä¸‹ï¼Œéƒ½ä¼šé€‰æ‹©ä»¥å¤–éƒ¨æ—¶é’Ÿæˆ–éŸ³é¢‘æ—¶é’Ÿä½œä¸ºä¸»åŒæ­¥æºï¼Œä»¥è§†é¢‘åŒæ­¥åˆ°éŸ³é¢‘æˆ–å¤–éƒ¨æ—¶é’Ÿä¸ºé¦–é€‰åŒæ­¥æ–¹æ¡ˆ * ä»¥è§†é¢‘æ—¶é’Ÿä½œä¸ºä¸»åŒæ­¥æºçš„åŒæ­¥æ–¹æ¡ˆï¼Œå±äº3ç§åŸºæœ¬çš„åŒæ­¥æ–¹æ¡ˆ(åŒæ­¥åˆ°éŸ³é¢‘ã€åŒæ­¥åˆ°è§†é¢‘ã€åŒæ­¥åˆ°å¤–éƒ¨æ—¶é’Ÿ) * æœ¬åˆ©ä»…ä¸ºå±•ç¤ºåŒæ­¥åˆ°è§†é¢‘æ—¶é’Ÿçš„æ–¹æ³•ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åŒæ­¥åˆ°è§†é¢‘æ—¶é’Ÿä»…ä½œä¸ºè¾…åŠ©çš„åŒæ­¥æ–¹æ¡ˆ --------------------------------*/ double get_video_clock(VideoState *is) { double delta=(av_gettime()-is->video_current_pts_time)/1000000.0; //pts_of_last_frame+(Current_time-time_elapsed_since_pts_value_was_set) return is->video_current_pts+delta; } //å–å¾—ç³»ç»Ÿæ—¶é—´ï¼Œä»¥ç³»ç»Ÿæ—¶é’Ÿä½œä¸ºåŒæ­¥åŸºå‡† double get_external_clock(VideoState *is) { return av_gettime()/1000000.0;//å–å¾—ç³»ç»Ÿå½“å‰æ—¶é—´ï¼Œä»¥1/1000000ç§’ä¸ºå•ä½ï¼Œä¾¿äºåœ¨å„ä¸ªå¹³å°ç§»æ¤ } //å–å¾—ä¸»æ—¶é’Ÿ(åŸºå‡†æ—¶é’Ÿ) double get_master_clock(VideoState *is) { if (is->av_sync_type == AV_SYNC_VIDEO_MASTER) { return get_video_clock(is);//è¿”å›è§†é¢‘æ—¶é’Ÿ } else if (is->av_sync_type == AV_SYNC_AUDIO_MASTER) { return get_audio_clock(is);//è¿”å›éŸ³é¢‘æ—¶é’Ÿ } else { return get_external_clock(is);//è¿”å›ç³»ç»Ÿæ—¶é’Ÿ } } /*--------------------------- * return the wanted number of samples to get better sync if sync_type is video or external master clock * é€šå¸¸æƒ…å†µä¸‹ä¼šä»¥éŸ³é¢‘æˆ–ç³»ç»Ÿæ—¶é’Ÿä¸ºä¸»åŒæ­¥æºï¼Œåªæœ‰åœ¨éŸ³é¢‘æˆ–ç³»ç»Ÿæ—¶é’Ÿå¤±æ•ˆçš„æƒ…å†µä¸‹æ‰ä»¥è§†é¢‘ä¸ºä¸»åŒæ­¥æº * è¯¥å‡½æ•°æ¯”å¯¹éŸ³é¢‘æ—¶é’Ÿä¸ä¸»åŒæ­¥æºçš„æ—¶å·®ï¼Œé€šè¿‡åŠ¨æ€ä¸¢å¸§(æˆ–æ’å€¼)éƒ¨åˆ†éŸ³é¢‘æ•°æ®ï¼Œä»¥èµ·åˆ°å‡å°‘(æˆ–å¢åŠ )éŸ³é¢‘æ’­æ”¾æ—¶é•¿ï¼Œå‡å°‘ä¸ä¸»åŒæ­¥æºæ—¶å·®çš„ä½œç”¨ * è¯¥å‡½æ•°å¯¹éŸ³é¢‘ç¼“å­˜æ•°æ®è¿›è¡Œä¸¢å¸§(æˆ–æ’å€¼)ï¼Œè¿”å›ä¸¢å¸§(æˆ–æ’å€¼)åçš„éŸ³é¢‘æ•°æ®é•¿åº¦ * å› ä¸ºéŸ³é¢‘åŒæ­¥å¯èƒ½å¸¦æ¥è¾“å‡ºå£°éŸ³ä¸è¿ç»­ç­‰å‰¯ä½œç”¨ï¼Œè¯¥å‡½æ•°é€šè¿‡éŸ³é¢‘ä¸åŒæ­¥æ¬¡æ•°(audio_diff_avg_count)åŠæ—¶å·®å‡å€¼(avg_diff)æ¥çº¦æŸéŸ³é¢‘çš„åŒæ­¥è¿‡ç¨‹ ---------------------------*/ int synchronize_audio(VideoState *is, short *samples, int samples_size, double pts) { double ref_clock;//ä¸»åŒæ­¥æº(åŸºå‡†æ—¶é’Ÿ) int pcm_bytes=is->audio_st->codec->channels*2;//æ¯ç»„éŸ³é¢‘æ•°æ®å­—èŠ‚æ•°=å£°é“æ•°*æ¯å£°é“æ•°æ®å­—èŠ‚æ•° /* if not master, then we try to remove or add samples to correct the clock */ if (is->av_sync_type != AV_SYNC_AUDIO_MASTER) {//æ£€æŸ¥ä¸»åŒæ­¥æºï¼Œè‹¥åŒæ­¥æºä¸æ˜¯éŸ³é¢‘æ—¶é’Ÿçš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹ä»£ç  double diff, avg_diff;//diff-éŸ³é¢‘å¸§æ’­æ”¾é—´ä¸ä¸»åŒæ­¥æºæ—¶å·®ï¼Œavg_diff-é‡‡æ ·ä¸åŒæ­¥å¹³å‡å€¼ int wanted_size, min_size, max_size;//ç»è¿‡ä¸¢å¸§(æˆ–æ’å€¼)åçš„ç¼“å­˜é•¿åº¦ï¼Œç¼“å­˜é•¿åº¦æœ€å¤§/æœ€å°å€¼ ref_clock = get_master_clock(is);//å–å¾—å½“å‰ä¸»åŒæ­¥æºï¼Œä»¥ä¸»åŒæ­¥æºä¸ºåŸºå‡†æ—¶é—´ diff = get_audio_clock(is) - ref_clock;//è®¡ç®—éŸ³é¢‘æ—¶é’Ÿä¸å½“å‰ä¸»åŒæ­¥æºçš„æ—¶å·® if (diffaudio_diff_cum=diff+is->audio_diff_avg_coef*is->audio_diff_cum; if (is->audio_diff_avg_countaudio_diff_avg_count++;//éŸ³é¢‘ä¸åŒæ­¥è®¡æ•°æ›´æ–° } else {//å½“éŸ³é¢‘ä¸åŒæ­¥æ¬¡æ•°è¶…è¿‡é˜ˆå€¼é™å®šåï¼Œè§¦å‘éŸ³é¢‘åŒæ­¥æ“ä½œ avg_diff=is->audio_diff_cum*(1.0-is->audio_diff_avg_coef);//è®¡ç®—æ—¶å·®å‡å€¼(ç­‰æ¯”çº§æ•°å‡ ä½•å¹³å‡æ•°) if (fabs(avg_diff)>=is->audio_diff_threshold) {//æ¯”å¯¹æ—¶å·®å‡å€¼ä¸æ—¶å·®é˜ˆå€¼ wanted_size=samples_size+((int)(diff*is->audio_st->codec->sample_rate)*pcm_bytes);//æ ¹æ®æ—¶å·®æ¢ç®—åŒæ­¥åçš„ç¼“å­˜é•¿åº¦ min_size=samples_size*((100-SAMPLE_CORRECTION_PERCENT_MAX)/100);//åŒæ­¥åçš„ç¼“å­˜é•¿åº¦æœ€å°å€¼ max_size=samples_size*((100+SAMPLE_CORRECTION_PERCENT_MAX)/100);//åŒæ­¥åçš„ç¼“å­˜é•¿åº¦æœ€å¤§å€¼ if (wanted_sizemax_size) {//è‹¥åŒæ­¥åç¼“å­˜é•¿åº¦>æœ€å°ç¼“å­˜é•¿åº¦ wanted_size=max_size;//ç”¨æœ€å¤§ç¼“å­˜é•¿åº¦ä½œä¸ºåŒæ­¥åçš„ç¼“å­˜é•¿åº¦ } if (wanted_sizesamples_size) {//è‹¥åŒæ­¥åç¼“å­˜é•¿åº¦å¤§äºå½“å‰ç¼“å­˜é•¿åº¦ //Add samples by copying final sampleï¼Œé€šè¿‡å¤åˆ¶æœ€åä¸€ä¸ªéŸ³é¢‘æ•°æ®è¿›è¡Œæ’å€¼ //int nb=samples_size-wanted_size; int nb=wanted_size-samples_size;//è®¡ç®—æ’å€¼åç¼“å­˜é•¿åº¦ä¸åŸå§‹ç¼“å­˜é•¿åº¦é—´çš„å·®å€¼(éœ€è¦æ’å€¼çš„éŸ³é¢‘æ•°æ®ç»„æ•°) uint8_t *samples_end=(uint8_t*)samples+samples_size-pcm_bytes;//å–å¾—ç¼“å­˜æœ«ç«¯æ•°æ®æŒ‡é’ˆ uint8_t *q=samples_end+pcm_bytes;//åˆå§‹æ’å€¼ä½ç½®|||q| while (nb>0) {//æ£€æŸ¥æ’å€¼éŸ³é¢‘ç»„æ•°(æ¯ç»„åŒ…æ‹¬ä¸¤ä¸ªå£°é“çš„pcmæ•°æ®) memcpy(q,samples_end,pcm_bytes);//åœ¨samplesåŸå§‹ç¼“å­˜åè¿½åŠ æ’å€¼ q += pcm_bytes;//æ›´æ–°æ’å€¼ä½ç½® nb -= pcm_bytes;//æ›´æ–°æ’å€¼ç»„æ•° } samples_size=wanted_size;//è¿”å›éŸ³é¢‘åŒæ­¥åçš„ç¼“å­˜é•¿åº¦ } } } } else { // Difference is too big, reset diff stuffï¼Œæ—¶å·®è¿‡å¤§ï¼Œé‡ç½®æ—¶å·®ç´¯è®¡å€¼ is->audio_diff_avg_count = 0;//éŸ³é¢‘ä¸åŒæ­¥è®¡æ•°é‡ç½® is->audio_diff_cum = 0;//éŸ³é¢‘ç´¯è®¡æ—¶å·®é‡ç½® } }//end for if (is->av_sync_type != AV_SYNC_AUDIO_MASTER) return samples_size;//è¿”å›å‘é€åˆ°å£°å¡çš„éŸ³é¢‘ç¼“å­˜å­—èŠ‚æ•° } // å®šæ—¶å™¨è§¦å‘çš„å›è°ƒå‡½æ•° static Uint32 sdl_refresh_timer_cb(Uint32 interval, void *opaque) { SDL_Event event;//SDLäº‹ä»¶å¯¹è±¡ event.type = FF_REFRESH_EVENT;//è§†é¢‘æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶ event.user.data1 = opaque;//ä¼ é€’ç”¨æˆ·æ•°æ® SDL_PushEvent(&event);//å‘é€äº‹ä»¶ return 0; // 0 means stop timer. } /*--------------------------- * Schedule a video refresh in 'delay' ms. * å‘Šè¯‰sdlåœ¨æŒ‡å®šçš„å»¶æ—¶åæ¥æ¨é€ä¸€ä¸ª FF_REFRESH_EVENT äº‹ä»¶ * è¿™ä¸ªäº‹ä»¶å°†åœ¨äº‹ä»¶é˜Ÿåˆ—é‡Œè§¦å‘sdl_refresh_timer_cbå‡½æ•°çš„è°ƒç”¨ --------------------------*/ static void schedule_refresh(VideoState *is, int delay) { SDL_AddTimer(delay, sdl_refresh_timer_cb, is);//åœ¨æŒ‡å®šçš„æ—¶é—´(ms)åå›è°ƒç”¨æˆ·æŒ‡å®šçš„å‡½æ•° } // è§†é¢‘(å›¾åƒ)å¸§æ¸²æŸ“ void video_display(VideoState *is) { SDL_Rect rect;// SDLçŸ©å½¢å¯¹è±¡ VideoPicture *vp;// å›¾åƒå¸§ç»“æ„ä½“æŒ‡é’ˆ vp = &is->pictq[is->pictq_rindex];//ä»å›¾åƒå¸§é˜Ÿåˆ—(æ•°ç»„)ä¸­æå–å›¾åƒå¸§ç»“æ„å¯¹è±¡ if (vp->avframe_yuv420p) {//æ£€æŸ¥åƒç´ æ•°æ®æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆ // è®¾ç½®çº¹ç†æ•°æ® SDL_UpdateTexture(is->sdl_texture, // çº¹ç† NULL,// æ¸²æŸ“åŒºåŸŸ vp->avframe_yuv420p->data[0],// éœ€è¦æ¸²æŸ“æ•°æ®ï¼šè§†é¢‘åƒç´ æ•°æ®å¸§ vp->avframe_yuv420p->linesize[0]);// å¸§å®½ // å°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // è®¾ç½®å·¦ä¸Šè§’ä½ç½®(å…¨å±) is->sdl_rect.x = 100; is->sdl_rect.y = 100; is->sdl_rect.w = vp->width; is->sdl_rect.h = vp->height; SDL_RenderClear(is->sdl_renderer); SDL_RenderCopy(is->sdl_renderer, is->sdl_texture, NULL, &is->sdl_rect); // å‘ˆç°ç”»é¢å¸§ SDL_RenderPresent(is->sdl_renderer); }// end for if }// end for video_display // æ˜¾ç¤ºåˆ·æ–°å‡½æ•°(FF_REFRESH_EVENTå“åº”å‡½æ•°) int video_current_index = 0; void video_refresh_timer(void *userdata) { VideoState *is = (VideoState *)userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® VideoPicture *vp;//å›¾åƒå¸§å¯¹è±¡ //delay-å‰åå¸§é—´çš„æ˜¾ç¤ºæ—¶é—´é—´éš”ï¼Œdiff-å›¾åƒå¸§æ˜¾ç¤ºä¸éŸ³é¢‘å¸§æ’­æ”¾é—´çš„æ—¶é—´å·® //sync_threshold-å‰åå¸§é—´çš„æœ€å°æ—¶é—´å·®ï¼Œactual_delay-å½“å‰å¸§-ä¸‹å·²å¸§çš„æ˜¾ç¤ºæ—¶é—´é—´éš”(åŠ¨æ€æ—¶é—´ã€çœŸå®æ—¶é—´ã€ç»å¯¹æ—¶é—´) double delay,diff,sync_threshold,actual_delay,ref_clock;//ref_clock-éŸ³é¢‘æ—¶é—´æˆ³ if (is->video_st) { if (is->pictq_size == 0) {// æ£€æŸ¥å›¾åƒå¸§é˜Ÿåˆ—æ˜¯å¦æœ‰å¾…æ˜¾ç¤ºå›¾åƒ schedule_refresh(is, 1);//è‹¥é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™å‘é€æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶å¹¶å†æ¬¡è¿›å…¥video_refresh_timerå‡½æ•° } else {// åˆ·æ–°å›¾åƒ vp = &is->pictq[is->pictq_rindex];//ä»æ˜¾ç¤ºé˜Ÿåˆ—ä¸­å–å¾—ç­‰å¾…æ˜¾ç¤ºçš„å›¾åƒå¸§ is->video_current_pts = vp->pts;//å–å¾—å½“å‰å¸§çš„æ˜¾ç¤ºæ—¶é—´æˆ³ is->video_current_pts_time = av_gettime();//å–å¾—ç³»ç»Ÿæ—¶é—´ï¼Œä½œä¸ºå½“å‰å¸§æ’­æ”¾çš„æ—¶é—´åŸºå‡† //è®¡ç®—å½“å‰å¸§å’Œå‰ä¸€å¸§æ˜¾ç¤º(pts)çš„é—´éš”æ—¶é—´(æ˜¾ç¤ºæ—¶é—´æˆ³çš„å·®å€¼) //è®¡ç®—å½“å‰å¸§å’Œå‰ä¸€å¸§æ˜¾ç¤º(pts)çš„é—´éš”æ—¶é—´(æ˜¾ç¤ºæ—¶é—´æˆ³çš„å·®å€¼) delay = vp->pts - is->frame_last_pts;//The pts from last timeï¼Œå‰åå¸§é—´çš„æ—¶é—´å·® if (delay = 1.0) {//æ£€æŸ¥æ—¶é—´é—´éš”æ˜¯å¦åœ¨åˆç†èŒƒå›´ // If incorrect delay, use previous one delay = is->frame_last_delay;//æ²¿ç”¨ä¹‹å‰çš„åŠ¨æ€åˆ·æ–°é—´éš”æ—¶é—´ } // Save for next time is->frame_last_delay = delay;//ä¿å­˜ä¸Šä¸€å¸§å›¾åƒçš„åŠ¨æ€åˆ·æ–°å»¶è¿Ÿæ—¶é—´ is->frame_last_pts = vp->pts;//ä¿å­˜ä¸Šä¸€å¸§å›¾åƒçš„æ˜¾ç¤ºæ—¶é—´æˆ³ // Update delay to sync to audioï¼Œå–å¾—å£°éŸ³æ’­æ”¾æ—¶é—´æˆ³(ä½œä¸ºè§†é¢‘åŒæ­¥çš„å‚è€ƒæ—¶é—´) // Update delay to sync to audioï¼Œå–å¾—å£°éŸ³æ’­æ”¾æ—¶é—´æˆ³(ä½œä¸ºè§†é¢‘åŒæ­¥çš„å‚è€ƒæ—¶é—´) if (is->av_sync_type != AV_SYNC_VIDEO_MASTER) {//æ£€æŸ¥ä¸»åŒæ­¥æ—¶é’Ÿæº ref_clock = get_master_clock(is);//æ ¹æ®Audio clockæ¥åˆ¤æ–­Videoæ’­æ”¾çš„å¿«æ…¢ï¼Œè·å–å½“å‰æ’­æ”¾å£°éŸ³çš„æ—¶é—´æˆ³ //ä¹Ÿå°±æ˜¯è¯´åœ¨diffè¿™æ®µæ—¶é—´ä¸­å£°éŸ³æ˜¯åŒ€é€Ÿå‘ç”Ÿçš„ï¼Œä½†æ˜¯åœ¨delayè¿™æ®µæ—¶é—´frameçš„æ˜¾ç¤ºå¯èƒ½å°±ä¼šæœ‰å¿«æ…¢çš„åŒºåˆ« diff = vp->pts - ref_clock;//è®¡ç®—å›¾åƒå¸§æ˜¾ç¤ºä¸éŸ³é¢‘å¸§æ’­æ”¾é—´çš„æ—¶é—´å·® //æ ¹æ®æ—¶é—´å·®è°ƒæ•´æ’­æ”¾ä¸‹ä¸€å¸§çš„å»¶è¿Ÿæ—¶é—´ï¼Œä»¥å®ç°åŒæ­¥ Skip or repeat the frameï¼ŒTake delay into account sync_threshold = (delay > AV_SYNC_THRESHOLD) ? delay : AV_SYNC_THRESHOLD;//æ¯”è¾ƒå‰åä¸¤å¸§é—´çš„æ˜¾ç¤ºæ—¶é—´é—´éš”ä¸æœ€å°æ—¶é—´é—´éš” //åˆ¤æ–­éŸ³è§†é¢‘ä¸åŒæ­¥æ¡ä»¶ï¼Œå³éŸ³è§†é¢‘é—´çš„æ—¶é—´å·® & å‰åå¸§é—´çš„æ—¶é—´å·®è¯¥é˜ˆå€¼åˆ™ä¸ºå¿«è¿›æ¨¡å¼ï¼Œä¸å­˜åœ¨éŸ³è§†é¢‘åŒæ­¥é—®é¢˜ if (fabs(diff) = sync_threshold) {//æ¯”è¾ƒä¸¤å¸§ç”»é¢é—´çš„æ˜¾ç¤ºæ—¶é—´ä¸ä¸¤å¸§ç”»é¢é—´å£°éŸ³çš„æ’­æ”¾æ—¶é—´ï¼Œå¿«äº†ï¼ŒåŠ å€delay delay = 2 * delay; } }//å¦‚æœdiff(æ˜æ˜¾)å¤§äºAV_NOSYNC_THRESHOLDï¼Œå³å¿«è¿›çš„æ¨¡å¼äº†ï¼Œç”»é¢è·³åŠ¨å¤ªå¤§ï¼Œä¸å­˜åœ¨éŸ³è§†é¢‘åŒæ­¥çš„é—®é¢˜äº† } //æ›´æ–°è§†é¢‘æ’­æ”¾åˆ°å½“å‰å¸§æ—¶çš„å·²æ’­æ”¾æ—¶é—´å€¼(æ‰€æœ‰å›¾åƒå¸§åŠ¨æ€æ’­æ”¾ç´¯è®¡æ—¶é—´å€¼-çœŸå®å€¼)ï¼Œframe_timerä¸€ç›´ç´¯åŠ åœ¨æ’­æ”¾è¿‡ç¨‹ä¸­æˆ‘ä»¬è®¡ç®—çš„å»¶æ—¶ is->frame_timer+=delay; //æ¯æ¬¡è®¡ç®—frame_timerä¸ç³»ç»Ÿæ—¶é—´çš„å·®å€¼(ä»¥ç³»ç»Ÿæ—¶é—´ä¸ºåŸºå‡†æ—¶é—´)ï¼Œå°†frame_timerä¸ç³»ç»Ÿæ—¶é—´(ç»å¯¹æ—¶é—´)ç›¸å…³è”çš„ç›®çš„ actual_delay=is->frame_timer-(av_gettime()/1000000.0);//Computer the REAL delay if (actual_delay pts: %fï¼Œref_clockï¼š%fï¼Œactual_delayï¼š%f\", video_current_index, vp->pts, ref_clock, actual_delay); // Update queue for next picture! if (++is->pictq_rindex == VIDEO_PICTURE_QUEUE_SIZE) {// æ›´æ–°å¹¶æ£€æŸ¥å›¾åƒå¸§é˜Ÿåˆ—è¯»ä½ç½®ç´¢å¼• is->pictq_rindex = 0;// é‡ç½®è¯»ä½ç½®ç´¢å¼• } SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤ç”»å¸ƒçš„åƒç´ æ•°æ® is->pictq_size--;// æ›´æ–°å›¾åƒå¸§é˜Ÿåˆ—é•¿åº¦ SDL_CondSignal(is->pictq_ready);// å‘é€é˜Ÿåˆ—å°±ç»ªä¿¡å· SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ } } else { schedule_refresh(is, 100); } } // æ•°æ®åŒ…é˜Ÿåˆ—åˆå§‹åŒ–å‡½æ•° void packet_queue_init(PacketQueue *q) { memset(q, 0, sizeof(PacketQueue));// å…¨é›¶åˆå§‹åŒ–é˜Ÿåˆ—ç»“æ„ä½“å¯¹è±¡ q->qlock = SDL_CreateMutex();// åˆ›å»ºäº’æ–¥é‡å¯¹è±¡ q->qready = SDL_CreateCond();// åˆ›å»ºæ¡ä»¶å˜é‡å¯¹è±¡ } // å‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… int packet_queue_put(PacketQueue *q, AVPacket *pkt) { /*-------å‡†å¤‡é˜Ÿåˆ—(é“¾è¡¨)èŠ‚ç‚¹å¯¹è±¡------*/ AVPacketList *pktlist=(AVPacketList *)av_malloc(sizeof(AVPacketList));// åœ¨å †ä¸Šåˆ›å»ºé“¾è¡¨èŠ‚ç‚¹å¯¹è±¡ if (!pktlist) {// æ£€æŸ¥é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡æ˜¯å¦åˆ›å»ºæˆåŠŸ return -1; } pktlist->pkt = *pkt;// å°†è¾“å…¥æ•°æ®åŒ…èµ‹å€¼ç»™æ–°å»ºé“¾è¡¨èŠ‚ç‚¹å¯¹è±¡ä¸­çš„æ•°æ®åŒ…å¯¹è±¡ pktlist->next = NULL;// é“¾è¡¨åç»§æŒ‡é’ˆä¸ºç©º // if (av_packet_ref(pkt, pkt) qlock);// é˜Ÿåˆ—äº’æ–¥é‡åŠ é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® if (!q->last_pkt) {// æ£€æŸ¥é˜Ÿåˆ—å°¾èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨(æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º) q->first_pkt = pktlist;// è‹¥ä¸å­˜åœ¨(é˜Ÿåˆ—å°¾ç©º)ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹ä½œé˜Ÿåˆ—ä¸ºé¦–èŠ‚ç‚¹ } else { q->last_pkt->next = pktlist;// è‹¥å·²å­˜åœ¨å°¾èŠ‚ç‚¹ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹æŒ‚åˆ°å°¾èŠ‚ç‚¹çš„åç»§æŒ‡é’ˆä¸Šï¼Œå¹¶ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ } q->last_pkt = pktlist;// å°†å½“å‰èŠ‚ç‚¹ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ q->nb_packets++;// é˜Ÿåˆ—é•¿åº¦+1 q->size += pktlist->pkt.size;// æ›´æ–°é˜Ÿåˆ—ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ SDL_CondSignal(q->qready);// ç»™ç­‰å¾…çº¿ç¨‹å‘å‡ºæ¶ˆæ¯ï¼Œé€šçŸ¥é˜Ÿåˆ—å·²å°±ç»ª SDL_UnlockMutex(q->qlock);// é‡Šæ”¾äº’æ–¥é‡ return 0; } // ä»é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ï¼Œå¹¶å°†æå–çš„æ•°æ®åŒ…å‡ºé˜Ÿåˆ— static int packet_queue_get(PacketQueue *q, AVPacket *pkt, int block) { AVPacketList *pktlist;// ä¸´æ—¶é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡æŒ‡é’ˆ int ret;// æ“ä½œç»“æœ SDL_LockMutex(q->qlock);// é˜Ÿåˆ—äº’æ–¥é‡åŠ é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® for (;;) { if (global_video_state->quit) {// æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† ret = -1;// æ“ä½œå¤±è´¥ break; }//end for if pktlist = q->first_pkt;// ä¼ é€’å°†é˜Ÿåˆ—é¦–ä¸ªæ•°æ®åŒ…æŒ‡é’ˆ if (pktlist) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºç©º(é˜Ÿåˆ—æ˜¯å¦æœ‰æ•°æ®) q->first_pkt = pktlist->next;// é˜Ÿåˆ—é¦–èŠ‚ç‚¹æŒ‡é’ˆåç§» if (!q->first_pkt) {// æ£€æŸ¥é¦–èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ q->last_pkt = NULL;// è‹¥ä¸å­˜åœ¨ï¼Œåˆ™å°†å°¾èŠ‚ç‚¹æŒ‡é’ˆç½®ç©º } q->nb_packets--;// é˜Ÿåˆ—é•¿åº¦-1 q->size -= pktlist->pkt.size;// æ›´æ–°é˜Ÿåˆ—ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ *pkt = pktlist->pkt;// å°†é˜Ÿåˆ—é¦–èŠ‚ç‚¹æ•°æ®è¿”å› av_free(pktlist);// æ¸…ç©ºä¸´æ—¶èŠ‚ç‚¹æ•°æ®(æ¸…ç©ºé¦–èŠ‚ç‚¹æ•°æ®ï¼Œé¦–èŠ‚ç‚¹å‡ºé˜Ÿåˆ—) ret = 1;// æ“ä½œæˆåŠŸ break; } else if (!block) { ret = 0; break; } else {// é˜Ÿåˆ—å¤„äºæœªå°±ç»ªçŠ¶æ€ï¼Œæ­¤æ—¶é€šè¿‡SDL_CondWaitå‡½æ•°ç­‰å¾…qreadyå°±ç»ªä¿¡å·ï¼Œå¹¶æš‚æ—¶å¯¹äº’æ–¥é‡è§£é” /*--------------------- * ç­‰å¾…é˜Ÿåˆ—å°±ç»ªä¿¡å·qreadyï¼Œå¹¶å¯¹äº’æ–¥é‡æš‚æ—¶è§£é” * æ­¤æ—¶çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œå¹¶ç½®äºç­‰å¾…æ¡ä»¶å°±ç»ªçš„çº¿ç¨‹åˆ—è¡¨ä¸Š * ä½¿å¾—è¯¥çº¿ç¨‹åªåœ¨ä¸´ç•ŒåŒºèµ„æºå°±ç»ªåæ‰è¢«å”¤é†’ï¼Œè€Œä¸è‡³äºçº¿ç¨‹è¢«é¢‘ç¹åˆ‡æ¢ * è¯¥å‡½æ•°è¿”å›æ—¶ï¼Œäº’æ–¥é‡å†æ¬¡è¢«é”ä½ï¼Œå¹¶æ‰§è¡Œåç»­æ“ä½œ --------------------*/ SDL_CondWait(q->qready, q->qlock);// æš‚æ—¶è§£é”äº’æ–¥é‡å¹¶å°†è‡ªå·±é˜»å¡ï¼Œç­‰å¾…ä¸´ç•ŒåŒºèµ„æºå°±ç»ª(ç­‰å¾…SDL_CondSignalå‘å‡ºä¸´ç•ŒåŒºèµ„æºå°±ç»ªçš„ä¿¡å·) } }//end for for-loop SDL_UnlockMutex(q->qlock);// é‡Šæ”¾äº’æ–¥é‡ return ret; } // åˆ›å»º/é‡ç½®å›¾åƒå¸§ï¼Œä¸ºå›¾åƒå¸§åˆ†é…å†…å­˜ç©ºé—´ void alloc_picture(void *userdata) { VideoState *is = (VideoState *)userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® VideoPicture *vp=&is->pictq[is->pictq_windex];// ä»å›¾åƒå¸§é˜Ÿåˆ—(æ•°ç»„)ä¸­æå–å›¾åƒå¸§ç»“æ„å¯¹è±¡ if (vp->avframe_yuv420p) {// æ£€æŸ¥å›¾åƒå¸§æ˜¯å¦å·²å­˜åœ¨ // We already have one make another, bigger/smaller. av_frame_free(&vp->avframe_yuv420p); } vp->width = is->video_st->codec->width;// è®¾ç½®å›¾åƒå¸§å®½åº¦ vp->height = is->video_st->codec->height;// è®¾ç½®å›¾åƒå¸§é«˜åº¦ SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤ç”»å¸ƒçš„åƒç´ æ•°æ® vp->allocated = 1;// å›¾åƒå¸§åƒç´ ç¼“å†²åŒºå·²åˆ†é…å†…å­˜ // AV_PIX_FMT_YUV420Pæ ¼å¼çš„è§†é¢‘å¸§ vp->avframe_yuv420p = av_frame_alloc(); // ç»™ç¼“å†²åŒºè®¾ç½®ç±»å‹ int buffer_size =av_image_get_buffer_size(AV_PIX_FMT_YUV420P,// è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ is->video_st->codec->width,// ä¸€å¸§è§†é¢‘åƒç´ æ•°æ®å®½ = è§†é¢‘å®½ is->video_st->codec->height,// ä¸€å¸§è§†é¢‘åƒç´ æ•°æ®é«˜ = è§†é¢‘é«˜ 1);// å­—èŠ‚å¯¹é½æ–¹å¼ï¼Œé»˜è®¤æ˜¯1 // å¼€è¾Ÿä¸€å—å†…å­˜ç©ºé—´ uint8_t *out_buffer = (uint8_t *)av_malloc(buffer_size); // å‘avframe_yuv420på¡«å……æ•°æ® av_image_fill_arrays(vp->avframe_yuv420p->data,// ç›®æ ‡è§†é¢‘å¸§æ•°æ® vp->avframe_yuv420p->linesize,// ç›®æ ‡è§†é¢‘å¸§è¡Œå¤§å° out_buffer,// åŸå§‹æ•°æ® AV_PIX_FMT_YUV420P,// è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ is->video_st->codec->width,// è§†é¢‘å®½ is->video_st->codec->height,//è§†é¢‘é«˜ 1);// å­—èŠ‚å¯¹é½æ–¹å¼ SDL_CondSignal(is->pictq_ready);// ç»™ç­‰å¾…çº¿ç¨‹å‘å‡ºæ¶ˆæ¯ï¼Œé€šçŸ¥é˜Ÿåˆ—å·²å°±ç»ª SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ } /*--------------------------- * queue_pictureï¼šå›¾åƒå¸§æ’å…¥é˜Ÿåˆ—ç­‰å¾…æ¸²æŸ“ * @isï¼šå…¨å±€çŠ¶æ€å‚æ•°é›† * @pFrameï¼šä¿å­˜å›¾åƒè§£ç æ•°æ®çš„ç»“æ„ä½“ * 1ã€é¦–å…ˆæ£€æŸ¥å›¾åƒå¸§é˜Ÿåˆ—(æ•°ç»„)æ˜¯å¦å­˜åœ¨ç©ºé—´æ’å…¥æ–°çš„å›¾åƒï¼Œè‹¥æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ’å…¥å›¾åƒåˆ™ä½¿å½“å‰çº¿ç¨‹ä¼‘çœ ç­‰å¾… * 2ã€åœ¨åˆå§‹åŒ–çš„æ¡ä»¶ä¸‹ï¼Œé˜Ÿåˆ—(æ•°ç»„)ä¸­VideoPictureçš„bmpå¯¹è±¡(YUV overlay)å°šæœªåˆ†é…ç©ºé—´ï¼Œé€šè¿‡FF_ALLOC_EVENTäº‹ä»¶çš„æ–¹æ³•è°ƒç”¨alloc_pictureåˆ†é…ç©ºé—´ * 3ã€å½“é˜Ÿåˆ—(æ•°ç»„)ä¸­æ‰€æœ‰VideoPictureçš„bmpå¯¹è±¡(YUV overlay)å‡å·²åˆ†é…ç©ºé—´çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è·³è¿‡æ­¥éª¤2å‘bmpå¯¹è±¡æ‹·è´åƒç´ æ•°æ®ï¼Œåƒç´ æ•°æ®åœ¨è¿›è¡Œæ ¼å¼è½¬æ¢åæ‰§è¡Œæ‹·è´æ“ä½œ ---------------------------*/ int queue_picture(VideoState *is, AVFrame *pFrame, double pts) { /*--------1ã€æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦æœ‰æ’å…¥ç©ºé—´-------*/ // Wait until we have space for a new pic. SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤å›¾åƒå¸§é˜Ÿåˆ— while (is->pictq_size >= VIDEO_PICTURE_QUEUE_SIZE && !is->quit) {// æ£€æŸ¥é˜Ÿåˆ—å½“å‰é•¿åº¦ SDL_CondWait(is->pictq_ready, is->pictq_lock);// çº¿ç¨‹ä¼‘çœ ç­‰å¾…pictq_readyä¿¡å· } SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ if (is->quit) {// æ£€æŸ¥è¿›ç¨‹é€€å‡ºæ ‡è¯† return -1; } /*-------2ã€åˆå§‹åŒ–/é‡ç½®YUV overlay-------*/ // windex is set to 0 initially. VideoPicture *vp=&is->pictq[is->pictq_windex];// ä»å›¾åƒå¸§é˜Ÿåˆ—ä¸­æŠ½å–å›¾åƒå¸§å¯¹è±¡ // Allocate or resize the bufferï¼Œæ£€æŸ¥YUV overlayæ˜¯å¦å·²å­˜åœ¨ï¼Œå¦åˆ™åˆå§‹åŒ–YUV overlayï¼Œåˆ†é…åƒç´ ç¼“å­˜ç©ºé—´ if (!vp->avframe_yuv420p || vp->width!=is->video_st->codec->width || vp->height!=is->video_st->codec->height) { vp->allocated = 0;// å›¾åƒå¸§æœªåˆ†é…ç©ºé—´ // We have to do it in the main thread. SDL_Event event;// SDLäº‹ä»¶å¯¹è±¡ event.type = FF_ALLOC_EVENT;//æŒ‡å®šåˆ†é…å›¾åƒå¸§å†…å­˜äº‹ä»¶ event.user.data1 = is;//ä¼ é€’ç”¨æˆ·æ•°æ® SDL_PushEvent(&event);//å‘é€SDLäº‹ä»¶ // Wait until we have a picture allocated. SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤å›¾åƒå¸§é˜Ÿåˆ— while (!vp->allocated && !is->quit) {// æ£€æŸ¥å½“å‰å›¾åƒå¸§æ˜¯å¦å·²åˆå§‹åŒ– SDL_CondWait(is->pictq_ready, is->pictq_lock);// çº¿ç¨‹ä¼‘çœ ç­‰å¾…alloc_pictureå‘é€pictq_readyä¿¡å·å”¤é†’å½“å‰çº¿ç¨‹ } SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ if (is->quit) {// æ£€æŸ¥è¿›ç¨‹é€€å‡ºæ ‡è¯† return -1; } }// end for if /*--------3ã€æ‹·è´è§†é¢‘å¸§åˆ°YUV overlay-------*/ // We have a place to put our picture on the queue. if (vp->avframe_yuv420p) {//æ£€æŸ¥åƒç´ æ•°æ®æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆ // Convert the image into YUV format that SDL usesï¼Œå°†è§£ç åçš„å›¾åƒå¸§è½¬æ¢ä¸ºAV_PIX_FMT_YUV420Pæ ¼å¼ï¼Œå¹¶æ‹·è´åˆ°å›¾åƒå¸§é˜Ÿåˆ— sws_scale(is->sws_ctx, (uint8_t const * const *)pFrame->data, pFrame->linesize, 0, is->video_st->codec->height, vp->avframe_yuv420p->data, vp->avframe_yuv420p->linesize); vp->pts = pts;//ä¼ é€’å½“å‰å›¾åƒå¸§çš„ç»å¯¹æ˜¾ç¤ºæ—¶é—´æˆ³ // Now we inform our display thread that we have a pic ready. if (++is->pictq_windex == VIDEO_PICTURE_QUEUE_SIZE) {//æ›´æ–°å¹¶æ£€æŸ¥å½“å‰å›¾åƒå¸§é˜Ÿåˆ—å†™å…¥ä½ç½® is->pictq_windex = 0;//é‡ç½®å›¾åƒå¸§é˜Ÿåˆ—å†™å…¥ä½ç½® } SDL_LockMutex(is->pictq_lock);//é”å®šé˜Ÿåˆ—è¯»å†™é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® is->pictq_size++;//æ›´æ–°å›¾åƒå¸§é˜Ÿåˆ—é•¿åº¦ SDL_UnlockMutex(is->pictq_lock);//é‡Šæ”¾é˜Ÿåˆ—è¯»å†™é” }// end for if return 0; } /*--------------------------- * æ›´æ–°å†…éƒ¨è§†é¢‘æ’­æ”¾è®¡æ—¶å™¨(è®°å½•è§†é¢‘å·²ç»æ’­æ—¶é—´(video_clock)ï¼‰ * @isï¼šå…¨å±€çŠ¶æ€å‚æ•°é›† * @src_frameï¼šå½“å‰(è¾“å…¥çš„)(å¾…æ›´æ–°çš„)å›¾åƒå¸§å¯¹è±¡ * @ptsï¼šå½“å‰å›¾åƒå¸§çš„æ˜¾ç¤ºæ—¶é—´æˆ³ * update the PTS to be in sync ---------------------------*/ double synchronize_video(VideoState *is, AVFrame *src_frame, double pts) { /*----------æ£€æŸ¥æ˜¾ç¤ºæ—¶é—´æˆ³----------*/ if (pts != 0) {//æ£€æŸ¥æ˜¾ç¤ºæ—¶é—´æˆ³æ˜¯å¦æœ‰æ•ˆ // If we have pts, set video clock to it. is->video_clock = pts;//ç”¨æ˜¾ç¤ºæ—¶é—´æˆ³æ›´æ–°å·²æ’­æ”¾æ—¶é—´ } else {//è‹¥è·å–ä¸åˆ°æ˜¾ç¤ºæ—¶é—´æˆ³ // If we aren't given a pts, set it to the clock. pts = is->video_clock;//ç”¨å·²æ’­æ”¾æ—¶é—´æ›´æ–°æ˜¾ç¤ºæ—¶é—´æˆ³ } /*--------æ›´æ–°è§†é¢‘å·²ç»æ’­æ—¶é—´--------*/ // Update the video clockï¼Œè‹¥è¯¥å¸§è¦é‡å¤æ˜¾ç¤º(å–å†³äºrepeat_pict)ï¼Œåˆ™å…¨å±€è§†é¢‘æ’­æ”¾æ—¶åºvideo_clockåº”åŠ ä¸Šé‡å¤æ˜¾ç¤ºçš„æ•°é‡*å¸§ç‡ double frame_delay = av_q2d(is->video_st->codec->time_base);//è¯¥å¸§æ˜¾ç¤ºå®Œå°†è¦èŠ±è´¹çš„æ—¶é—´ // If we are repeating a frame, adjust clock accordingly,è‹¥å­˜åœ¨é‡å¤å¸§ï¼Œåˆ™åœ¨æ­£å¸¸æ’­æ”¾çš„å‰åä¸¤å¸§å›¾åƒé—´å®‰æ’æ¸²æŸ“é‡å¤å¸§ frame_delay += src_frame->repeat_pict*(frame_delay*0.5);//è®¡ç®—æ¸²æŸ“é‡å¤å¸§çš„æ—¶å€¼(ç±»ä¼¼äºéŸ³ç¬¦æ—¶å€¼) is->video_clock += frame_delay;//æ›´æ–°è§†é¢‘æ’­æ”¾æ—¶é—´ // printf(\"repeat_pict=%d \\n\",src_frame->repeat_pict); return pts;//æ­¤æ—¶è¿”å›çš„å€¼å³ä¸ºä¸‹ä¸€å¸§å°†è¦å¼€å§‹æ˜¾ç¤ºçš„æ—¶é—´æˆ³ } // These are called whenever we allocate a frame buffer. We use this to store the global_pts in a frame at the time it is allocated. int our_get_buffer(struct AVCodecContext *c, AVFrame *pic, int flags) { int ret = avcodec_default_get_buffer2(c, pic, 0); uint64_t *pts = (uint64_t *)av_malloc(sizeof(uint64_t)); *pts = global_video_pkt_pts; pic->opaque = pts; return ret; } // è§†é¢‘è§£ç çº¿ç¨‹å‡½æ•° int decode_thread(void *arg) { VideoState *is = (VideoState *) arg;// ä¼ é€’ç”¨æˆ·æ•°æ® AVPacket pkt, *packet = &pkt;// åœ¨æ ˆä¸Šåˆ›å»ºä¸´æ—¶æ•°æ®åŒ…å¯¹è±¡å¹¶å…³è”æŒ‡é’ˆ int frameFinished;// è§£ç æ“ä½œæ˜¯å¦æˆåŠŸæ ‡è¯† // Allocate video frameï¼Œä¸ºè§£ç åçš„è§†é¢‘ä¿¡æ¯ç»“æ„ä½“åˆ†é…ç©ºé—´å¹¶å®Œæˆåˆå§‹åŒ–æ“ä½œ(ç»“æ„ä½“ä¸­çš„å›¾åƒç¼“å­˜æŒ‰ç…§ä¸‹é¢ä¸¤æ­¥æ‰‹åŠ¨å®‰è£…) AVFrame *pFrame = av_frame_alloc(); double pts;//å½“å‰æ¡¢åœ¨æ•´ä¸ªè§†é¢‘ä¸­çš„(ç»å¯¹)æ—¶é—´ä½ç½® for (;;) { if (packet_queue_get(&is->videoq,packet,1)pts;// Save global pts to be stored in pFrame in first call. /*----------------------- * Decode video frameï¼Œè§£ç å®Œæ•´çš„ä¸€å¸§æ•°æ®ï¼Œå¹¶å°†frameFinishedè®¾ç½®ä¸ºtrue * å¯èƒ½æ— æ³•é€šè¿‡åªè§£ç ä¸€ä¸ªpacketå°±è·å¾—ä¸€ä¸ªå®Œæ•´çš„è§†é¢‘å¸§frameï¼Œå¯èƒ½éœ€è¦è¯»å–å¤šä¸ªpacketæ‰è¡Œ * avcodec_decode_video2()ä¼šåœ¨è§£ç åˆ°å®Œæ•´çš„ä¸€å¸§æ—¶è®¾ç½®frameFinishedä¸ºçœŸ * Technically a packet can contain partial frames or other bits of data * ffmpeg's parser ensures that the packets we get contain either complete or multiple frames * convert the packet to a frame for us and set frameFinisned for us when we have the next frame -----------------------*/ avcodec_decode_video2(is->video_st->codec, pFrame, &frameFinished, packet); //å–å¾—ç¼–ç æ•°æ®åŒ…ä¸­çš„æ˜¾ç¤ºæ—¶é—´æˆ³PTS(int64_t),å¹¶æš‚æ—¶ä¿å­˜åœ¨pts(double)ä¸­ // if (packet->dts==AV_NOPTS_VALUE && pFrame->opaque && *(uint64_t*)pFrame->opaque!=AV_NOPTS_VALUE) { // pts = *(uint64_t *)pFrame->opaque; // } else if (packet->dts != AV_NOPTS_VALUE) { // pts = packet->dts; // } else { // pts = 0; // } pts=av_frame_get_best_effort_timestamp(pFrame);//å–å¾—ç¼–ç æ•°æ®åŒ…ä¸­çš„å›¾åƒå¸§æ˜¾ç¤ºåºå·PTS(int64_t),å¹¶æš‚æ—¶ä¿å­˜åœ¨pts(double)ä¸­ /*------------------------- * åœ¨è§£ç çº¿ç¨‹å‡½æ•°ä¸­è®¡ç®—å½“å‰å›¾åƒå¸§çš„æ˜¾ç¤ºæ—¶é—´æˆ³ * 1ã€å–å¾—ç¼–ç æ•°æ®åŒ…ä¸­çš„å›¾åƒå¸§æ˜¾ç¤ºåºå·PTS(int64_t),å¹¶æš‚æ—¶ä¿å­˜åœ¨pts(double)ä¸­ * 2ã€æ ¹æ®PTS*time_baseæ¥è®¡ç®—å½“å‰æ¡¢åœ¨æ•´ä¸ªè§†é¢‘ä¸­çš„æ˜¾ç¤ºæ—¶é—´æˆ³ï¼Œå³PTS*(1/framerate) * av_q2dæŠŠAVRatioalç»“æ„è½¬æ¢æˆdoubleçš„å‡½æ•°ï¼Œ * ç”¨äºè®¡ç®—è§†é¢‘æºæ¯ä¸ªå›¾åƒå¸§æ˜¾ç¤ºçš„é—´éš”æ—¶é—´(1/framerate),å³è¿”å›(time_base->num/time_base->den) -------------------------*/ //æ ¹æ®pts=PTS*time_base={numerator=1,denominator=25}è®¡ç®—å½“å‰æ¡¢åœ¨æ•´ä¸ªè§†é¢‘ä¸­çš„æ˜¾ç¤ºæ—¶é—´æˆ³ pts*=av_q2d(is->video_st->time_base);//time_baseä¸ºAVRationalæœ‰ç†æ•°ç»“æ„ä½“{num=1,den=25}ï¼Œè®°å½•äº†è§†é¢‘æºæ¯ä¸ªå›¾åƒå¸§æ˜¾ç¤ºçš„é—´éš”æ—¶é—´ // Did we get a video frameï¼Œæ£€æŸ¥æ˜¯å¦è§£ç å‡ºå®Œæ•´ä¸€å¸§å›¾åƒ if (frameFinished) { pts = synchronize_video(is, pFrame, pts);//æ£€æŸ¥å½“å‰å¸§çš„æ˜¾ç¤ºæ—¶é—´æˆ³ptså¹¶æ›´æ–°å†…éƒ¨è§†é¢‘æ’­æ”¾è®¡æ—¶å™¨(è®°å½•è§†é¢‘å·²ç»æ’­æ—¶é—´(video_clock)ï¼‰ if (queue_picture(is, pFrame, pts)sws_ctx_audio, \"in_channel_layout\", src_ch_layout, 0); av_opt_set_int(is->sws_ctx_audio, \"out_channel_layout\", dst_ch_layout, 0); av_opt_set_int(is->sws_ctx_audio, \"in_sample_rate\", src_rate, 0); av_opt_set_int(is->sws_ctx_audio, \"out_sample_rate\", dst_rate, 0); av_opt_set_sample_fmt(is->sws_ctx_audio, \"in_sample_fmt\", src_sample_fmt, 0); av_opt_set_sample_fmt(is->sws_ctx_audio, \"out_sample_fmt\", dst_sample_fmt, 0); int ret;//è¿”å›ç»“æœ // Initialize the resampling context. if ((ret = swr_init((struct SwrContext *) is->sws_ctx_audio)) sws_ctx_audio,src_rate)+src_nb_samples,dst_rate,src_rate,AV_ROUND_UP); //Convert to destination format. ret=swr_convert((struct SwrContext*)is->sws_ctx_audio,dst_data,dst_nb_samples,(const uint8_t **)decoded_frame.data,src_nb_samples); if (retaudio_buf, dst_data[0], dst_bufsize); if (src_data) { av_freep(&src_data[0]); } av_freep(&src_data); if (dst_data) { av_freep(&dst_data[0]); } av_freep(&dst_data); return dst_bufsize; } // éŸ³é¢‘è§£ç å‡½æ•°ï¼Œä»ç¼“å­˜é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ã€è§£ç ï¼Œå¹¶è¿”å›è§£ç åçš„æ•°æ®é•¿åº¦(å¯¹ä¸€ä¸ªå®Œæ•´çš„packetè§£ç ï¼Œå°†è§£ç æ•°æ®å†™å…¥audio_bufç¼“å­˜ï¼Œå¹¶è¿”å›å¤šå¸§è§£ç æ•°æ®çš„æ€»é•¿åº¦) int audio_decode_frame(VideoState *is, double *pts_ptr) { int coded_consumed_size,data_size=0,pcm_bytes;// æ¯æ¬¡æ¶ˆè€—çš„ç¼–ç æ•°æ®é•¿åº¦[input](len1)ï¼Œè¾“å‡ºåŸå§‹éŸ³é¢‘æ•°æ®çš„ç¼“å­˜é•¿åº¦[output]ï¼Œæ¯ç»„éŸ³é¢‘é‡‡æ ·æ•°æ®çš„å­—èŠ‚æ•° AVPacket *pkt = &is->audio_pkt;// ä¿å­˜ä»é˜Ÿåˆ—ä¸­æå–çš„æ•°æ®åŒ… double pts;//éŸ³é¢‘æ’­æ”¾æ—¶é—´æˆ³ for (;;) { while (is->audio_pkt_size>0) {// æ£€æŸ¥ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦(æ˜¯å¦å·²å®Œæˆä¸€ä¸ªå®Œæ•´çš„pakcetåŒ…çš„è§£ç ï¼Œä¸€ä¸ªæ•°æ®åŒ…ä¸­å¯èƒ½åŒ…å«å¤šä¸ªéŸ³é¢‘ç¼–ç å¸§) int got_frame = 0;// è§£ç æ“ä½œæˆåŠŸæ ‡è¯†ï¼ŒæˆåŠŸè¿”å›éé›¶å€¼ // è§£ç ä¸€å¸§éŸ³é¢‘æ•°æ®ï¼Œå¹¶è¿”å›æ¶ˆè€—çš„ç¼–ç æ•°æ®é•¿åº¦ coded_consumed_size = avcodec_decode_audio4(is->audio_st->codec, &is->audio_frame, &got_frame, pkt); if (coded_consumed_size audio_pkt_size = 0;// æ›´æ–°ç¼–ç æ•°æ®ç¼“å­˜é•¿åº¦ break; } if (got_frame) {// æ£€æŸ¥è§£ç æ“ä½œæ˜¯å¦æˆåŠŸ if (is->audio_frame.format != AV_SAMPLE_FMT_S16) {//æ£€æŸ¥éŸ³é¢‘æ•°æ®æ ¼å¼æ˜¯å¦ä¸º16ä½é‡‡æ ·æ ¼å¼ //å½“éŸ³é¢‘æ•°æ®ä¸ä¸º16ä½é‡‡æ ·æ ¼å¼æƒ…å†µä¸‹ï¼Œé‡‡ç”¨decode_frame_from_packetè®¡ç®—è§£ç æ•°æ®é•¿åº¦ data_size=decode_frame_from_packet(is, is->audio_frame); __android_log_print(ANDROID_LOG_INFO, \"main\", \"éŸ³é¢‘æ•°æ®æ ¼å¼æ˜¯é‡‡æ ·æ ¼å¼:%d\",is->audio_frame.format); } else {//è®¡ç®—è§£ç åéŸ³é¢‘æ•°æ®é•¿åº¦[output] data_size=av_samples_get_buffer_size(NULL,is->audio_st->codec->channels,is->audio_frame.nb_samples,is->audio_st->codec->sample_fmt, 1); memcpy(is->audio_buf,is->audio_frame.data[0],data_size);//å°†è§£ç æ•°æ®å¤åˆ¶åˆ°è¾“å‡ºç¼“å­˜ } } is->audio_pkt_data += coded_consumed_size;// æ›´æ–°ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆä½ç½® is->audio_pkt_size -= coded_consumed_size;// æ›´æ–°ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦ if (data_size audio_clock;//ç”¨æ¯æ¬¡æ›´æ–°çš„éŸ³é¢‘æ’­æ”¾æ—¶é—´æ›´æ–°éŸ³é¢‘PTS *pts_ptr=pts; /*--------------------- * å½“ä¸€ä¸ªpacketä¸­åŒ…å«å¤šä¸ªéŸ³é¢‘å¸§æ—¶ * é€šè¿‡[è§£ç åéŸ³é¢‘åŸå§‹æ•°æ®é•¿åº¦]åŠ[é‡‡æ ·ç‡]æ¥æ¨ç®—ä¸€ä¸ªpacketä¸­å…¶ä»–éŸ³é¢‘å¸§çš„æ’­æ”¾æ—¶é—´æˆ³pts * é‡‡æ ·é¢‘ç‡44.1kHzï¼Œé‡åŒ–ä½æ•°16ä½ï¼Œæ„å‘³ç€æ¯ç§’é‡‡é›†æ•°æ®44.1kä¸ªï¼Œæ¯ä¸ªæ•°æ®å 2å­—èŠ‚ --------------------*/ pcm_bytes=2*is->audio_st->codec->channels;//è®¡ç®—æ¯ç»„éŸ³é¢‘é‡‡æ ·æ•°æ®çš„å­—èŠ‚æ•°=æ¯ä¸ªå£°é“éŸ³é¢‘é‡‡æ ·å­—èŠ‚æ•°*å£°é“æ•° /*----æ›´æ–°audio_clock--- * ä¸€ä¸ªpktåŒ…å«å¤šä¸ªéŸ³é¢‘frameï¼ŒåŒæ—¶ä¸€ä¸ªpktå¯¹åº”ä¸€ä¸ªpts(pkt->pts) * å› æ­¤ï¼Œè¯¥pktä¸­åŒ…å«çš„å¤šä¸ªéŸ³é¢‘å¸§çš„æ—¶é—´æˆ³ç”±ä»¥ä¸‹å…¬å¼æ¨æ–­å¾—å‡º * bytes_per_sec=pcm_bytes*is->audio_st->codec->sample_rate * ä»pktä¸­ä¸æ–­çš„è§£ç ï¼Œæ¨æ–­(ä¸€ä¸ªpktä¸­)æ¯å¸§æ•°æ®çš„ptså¹¶ç´¯åŠ åˆ°éŸ³é¢‘æ’­æ”¾æ—¶é’Ÿ --------------------*/ is->audio_clock+=(double)data_size/(double)(pcm_bytes*is->audio_st->codec->sample_rate); // We have data, return it and come back for more later. return data_size;// è¿”å›è§£ç æ•°æ®ç¼“å­˜é•¿åº¦ } if (pkt->data) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦å·²ä»é˜Ÿåˆ—ä¸­æå– av_packet_unref(pkt);// é‡Šæ”¾pktä¸­ä¿å­˜çš„ç¼–ç æ•°æ® } if (is->quit) {// æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† return -1; } // Next packetï¼Œä»é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…åˆ°pkt if (packet_queue_get(&is->audioq, pkt, 1) audio_pkt_data = pkt->data;// ä¼ é€’ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆ is->audio_pkt_size = pkt->size;// ä¼ é€’ç¼–ç æ•°æ®ç¼“å­˜é•¿åº¦ // If update, update the audio clock w/pts if (pkt->pts != AV_NOPTS_VALUE) {//æ£€æŸ¥éŸ³é¢‘æ’­æ”¾æ—¶é—´æˆ³ //è·å¾—ä¸€ä¸ªæ–°çš„packetçš„æ—¶å€™ï¼Œæ›´æ–°audio_clockï¼Œç”¨packetä¸­çš„ptsæ›´æ–°audio_clock(ä¸€ä¸ªpktå¯¹åº”ä¸€ä¸ªpts) is->audio_clock=pkt->pts*av_q2d(is->audio_st->time_base);//æ›´æ–°éŸ³é¢‘å·²ç»æ’­çš„æ—¶é—´ } } } /*------Audio Callback------- * éŸ³é¢‘è¾“å‡ºå›è°ƒå‡½æ•°ï¼Œsdlé€šè¿‡è¯¥å›è°ƒå‡½æ•°å°†è§£ç åçš„pcmæ•°æ®é€å…¥å£°å¡æ’­æ”¾, * sdlé€šå¸¸ä¸€æ¬¡ä¼šå‡†å¤‡ä¸€ç»„ç¼“å­˜pcmæ•°æ®ï¼Œé€šè¿‡è¯¥å›è°ƒé€å…¥å£°å¡ï¼Œå£°å¡æ ¹æ®éŸ³é¢‘ptsä¾æ¬¡æ’­æ”¾pcmæ•°æ® * å¾…é€å…¥ç¼“å­˜çš„pcmæ•°æ®å®Œæˆæ’­æ”¾åï¼Œå†è½½å…¥ä¸€ç»„æ–°çš„pcmç¼“å­˜æ•°æ®(æ¯æ¬¡éŸ³é¢‘è¾“å‡ºç¼“å­˜ä¸ºç©ºæ—¶ï¼Œsdlå°±è°ƒç”¨æ­¤å‡½æ•°å¡«å……éŸ³é¢‘è¾“å‡ºç¼“å­˜ï¼Œå¹¶é€å…¥å£°å¡æ’­æ”¾) * When we begin playing audio, SDL will continually call this callback function * and ask it to fill the audio buffer with a certain number of bytes * The audio function callback takes the following parameters: * stream: A pointer to the audio buffer to be filledï¼Œè¾“å‡ºéŸ³é¢‘æ•°æ®åˆ°å£°å¡ç¼“å­˜ * len: The length (in bytes) of the audio buffer,ç¼“å­˜é•¿åº¦wanted_spec.samples=SDL_AUDIO_BUFFER_SIZE(1024) --------------------------*/ void audio_callback(void *userdata, Uint8 *stream, int len) { VideoState *is = (VideoState *) userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® int wt_stream_len, audio_size;// æ¯æ¬¡å†™å…¥streamçš„æ•°æ®é•¿åº¦ï¼Œè§£ç åçš„æ•°æ®é•¿åº¦ double pts;//éŸ³é¢‘æ—¶é—´æˆ³ while (len > 0) {//æ£€æŸ¥éŸ³é¢‘ç¼“å­˜çš„å‰©ä½™é•¿åº¦ if (is->audio_buf_index >= is->audio_buf_size) {// æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰§è¡Œè§£ç æ“ä½œ // We have already sent all our data; get moreï¼Œä»ç¼“å­˜é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ã€è§£ç ï¼Œå¹¶è¿”å›è§£ç åçš„æ•°æ®é•¿åº¦ï¼Œaudio_bufç¼“å­˜ä¸­å¯èƒ½åŒ…å«å¤šå¸§è§£ç åçš„éŸ³é¢‘æ•°æ® audio_size = audio_decode_frame(is, &pts); if (audio_size audio_buf_size = 1024; memset(is->audio_buf, 0, is->audio_buf_size);// å…¨é›¶é‡ç½®ç¼“å†²åŒº } else { //åœ¨å›è°ƒå‡½æ•°ä¸­å¢åŠ éŸ³é¢‘åŒæ­¥è¿‡ç¨‹ï¼Œå³å¯¹éŸ³é¢‘æ•°æ®ç¼“å­˜è¿›è¡Œä¸¢å¸§(æˆ–æ’å€¼)ï¼Œä»¥èµ·åˆ°é™ä½éŸ³é¢‘æ—¶é’Ÿä¸ä¸»åŒæ­¥æºæ—¶å·®çš„ç›®çš„ audio_size=synchronize_audio(is,(int16_t*)is->audio_buf,audio_size,pts);//è¿”å›éŸ³é¢‘åŒæ­¥åçš„ç¼“å­˜é•¿åº¦ is->audio_buf_size = audio_size;// è¿”å›packetä¸­åŒ…å«çš„åŸå§‹éŸ³é¢‘æ•°æ®é•¿åº¦(å¤šå¸§) } is->audio_buf_index = 0;// åˆå§‹åŒ–ç´¯è®¡å†™å…¥ç¼“å­˜é•¿åº¦ }//end for if wt_stream_len=is->audio_buf_size-is->audio_buf_index;// è®¡ç®—è§£ç ç¼“å­˜å‰©ä½™é•¿åº¦ if (wt_stream_len > len) {// æ£€æŸ¥æ¯æ¬¡å†™å…¥ç¼“å­˜çš„æ•°æ®é•¿åº¦æ˜¯å¦è¶…è¿‡æŒ‡å®šé•¿åº¦(1024) wt_stream_len = len;// æŒ‡å®šé•¿åº¦ä»è§£ç çš„ç¼“å­˜ä¸­å–æ•°æ® } // æ¯æ¬¡ä»è§£ç çš„ç¼“å­˜æ•°æ®ä¸­ä»¥æŒ‡å®šé•¿åº¦æŠ½å–æ•°æ®å¹¶å†™å…¥streamä¼ é€’ç»™å£°å¡ memcpy(stream, (uint8_t *)is->audio_buf + is->audio_buf_index, wt_stream_len); len -= wt_stream_len;// æ›´æ–°è§£ç éŸ³é¢‘ç¼“å­˜çš„å‰©ä½™é•¿åº¦ stream += wt_stream_len;// æ›´æ–°ç¼“å­˜å†™å…¥ä½ç½® is->audio_buf_index += wt_stream_len;// æ›´æ–°ç´¯è®¡å†™å…¥ç¼“å­˜æ•°æ®é•¿åº¦ }//end for while } // æ ¹æ®æŒ‡å®šç±»å‹æ‰“å¼€æµï¼Œæ‰¾åˆ°å¯¹åº”çš„è§£ç å™¨ã€åˆ›å»ºå¯¹åº”çš„éŸ³é¢‘é…ç½®ã€ä¿å­˜å…³é”®ä¿¡æ¯åˆ° VideoStateã€å¯åŠ¨éŸ³é¢‘å’Œè§†é¢‘çº¿ç¨‹ int stream_component_open(VideoState *is, int stream_index) { AVFormatContext *pFormatCtx = is->pFormatCtx;// ä¼ é€’æ–‡ä»¶å®¹å™¨çš„å°è£…ä¿¡æ¯åŠç æµå‚æ•° AVCodecContext *codecCtx = NULL;// è§£ç å™¨ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œè§£ç å™¨ä¾èµ–çš„ç›¸å…³ç¯å¢ƒã€çŠ¶æ€ã€èµ„æºä»¥åŠå‚æ•°é›†çš„æ¥å£æŒ‡é’ˆ AVCodec *codec = NULL;// ä¿å­˜ç¼–è§£ç å™¨ä¿¡æ¯çš„ç»“æ„ä½“ï¼Œæä¾›ç¼–ç ä¸è§£ç çš„å…¬å…±æ¥å£ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ç¼–ç å™¨ä¸è§£ç å™¨çš„ä¸€ä¸ªå…¨å±€å˜é‡ //æ£€æŸ¥è¾“å…¥çš„æµç±»å‹æ˜¯å¦åœ¨åˆç†èŒƒå›´å†… if (stream_index = pFormatCtx->nb_streams) { return -1; } // Get a pointer to the codec context for the video stream. codecCtx = pFormatCtx->streams[stream_index]->codec;// å–å¾—è§£ç å™¨ä¸Šä¸‹æ–‡ if (codecCtx->codec_type == AVMEDIA_TYPE_AUDIO) {//æ£€æŸ¥è§£ç å™¨ç±»å‹æ˜¯å¦ä¸ºéŸ³é¢‘è§£ç å™¨ SDL_AudioSpec wanted_spec, spec;//SDL_AudioSpec a structure that contains the audio output formatï¼Œåˆ›å»º SDL_AudioSpec ç»“æ„ä½“ï¼Œè®¾ç½®éŸ³é¢‘æ’­æ”¾æ•°æ® // Set audio settings from codec info,SDL_AudioSpec a structure that contains the audio output format // åˆ›å»ºSDL_AudioSpecç»“æ„ä½“ï¼Œè®¾ç½®éŸ³é¢‘æ’­æ”¾å‚æ•° wanted_spec.freq = codecCtx->sample_rate;//é‡‡æ ·é¢‘ç‡ DSP frequency -- samples per second wanted_spec.format = AUDIO_S16SYS;//é‡‡æ ·æ ¼å¼ Audio data format wanted_spec.channels = codecCtx->channels;//å£°é“æ•° Number of channels: 1 mono, 2 stereo wanted_spec.silence = 0;//æ— è¾“å‡ºæ—¶æ˜¯å¦é™éŸ³ //é»˜è®¤æ¯æ¬¡è¯»éŸ³é¢‘ç¼“å­˜çš„å¤§å°ï¼Œæ¨èå€¼ä¸º 512~8192ï¼Œffplayä½¿ç”¨çš„æ˜¯1024 specifies a unit of audio data refers to the size of the audio buffer in sample frames wanted_spec.samples = SDL_AUDIO_BUFFER_SIZE; wanted_spec.callback = audio_callback;//è®¾ç½®è¯»å–éŸ³é¢‘æ•°æ®çš„å›è°ƒæ¥å£å‡½æ•° the function to call when the audio device needs more data wanted_spec.userdata = is;//ä¼ é€’ç”¨æˆ·æ•°æ® /*--------------------------- * ä»¥æŒ‡å®šå‚æ•°æ‰“å¼€éŸ³é¢‘è®¾å¤‡ï¼Œå¹¶è¿”å›ä¸æŒ‡å®šå‚æ•°æœ€ä¸ºæ¥è¿‘çš„å‚æ•°ï¼Œè¯¥å‚æ•°ä¸ºè®¾å¤‡å®é™…æ”¯æŒçš„éŸ³é¢‘å‚æ•° * Opens the audio device with the desired parameters(wanted_spec) * return another specs we actually be using * and not guaranteed to get what we asked for --------------------------*/ if (SDL_OpenAudio(&wanted_spec, &spec) audio_hw_buf_size = spec.size; } /*----------------------- * Find the decoder for the video streamï¼Œæ ¹æ®è§†é¢‘æµå¯¹åº”çš„è§£ç å™¨ä¸Šä¸‹æ–‡æŸ¥æ‰¾å¯¹åº”çš„è§£ç å™¨ï¼Œè¿”å›å¯¹åº”çš„è§£ç å™¨(ä¿¡æ¯ç»“æ„ä½“) * The stream's information about the codec is in what we call the \"codec context. * This contains all the information about the codec that the stream is using -----------------------*/ codec = avcodec_find_decoder(codecCtx->codec_id); AVDictionary *optionsDict = NULL; if (!codec || (avcodec_open2(codecCtx, codec, &optionsDict) name); // æ£€æŸ¥è§£ç å™¨ç±»å‹ switch(codecCtx->codec_type) { case AVMEDIA_TYPE_AUDIO:// éŸ³é¢‘è§£ç å™¨ is->audioStream = stream_index;// éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ– is->audio_st = pFormatCtx->streams[stream_index]; is->audio_buf_size = 0;// è§£ç åçš„å¤šå¸§éŸ³é¢‘æ•°æ®é•¿åº¦ is->audio_buf_index = 0;//ç´¯ è®¡å†™å…¥streamçš„é•¿åº¦ // Averaging filter for audio sync. is->audio_diff_avg_coef=exp(log(0.01/AUDIO_DIFF_AVG_NB));//éŸ³é¢‘æ—¶é’Ÿä¸ä¸»åŒæ­¥æºç´¯è®¡æ—¶å·®åŠ æƒç³»æ•° is->audio_diff_avg_count=0;//éŸ³é¢‘ä¸åŒæ­¥è®¡æ•°åˆå§‹åŒ– // Correct audio only if larger error than this. is->audio_diff_threshold=2.0*SDL_AUDIO_BUFFER_SIZE/codecCtx->sample_rate; is->sws_ctx_audio = (struct SwsContext *) swr_alloc(); if (!is->sws_ctx_audio) { fprintf(stderr, \"Could not allocate resampler context\\n\"); return -1; } memset(&is->audio_pkt, 0, sizeof(is->audio_pkt)); packet_queue_init(&is->audioq);// éŸ³é¢‘æ•°æ®åŒ…é˜Ÿåˆ—åˆå§‹åŒ– SDL_PauseAudio(0);// audio callback starts running againï¼Œå¼€å¯éŸ³é¢‘è®¾å¤‡ï¼Œå¦‚æœè¿™æ—¶å€™æ²¡æœ‰è·å¾—æ•°æ®é‚£ä¹ˆå®ƒå°±é™éŸ³ break; case AVMEDIA_TYPE_VIDEO:// è§†é¢‘è§£ç å™¨ is->videoStream = stream_index;// è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ– is->video_st = pFormatCtx->streams[stream_index]; //ä»¥ç³»ç»Ÿæ—¶é—´ä¸ºåŸºå‡†ï¼Œåˆå§‹åŒ–æ’­æ”¾åˆ°å½“å‰å¸§çš„å·²æ’­æ”¾æ—¶é—´å€¼ï¼Œè¯¥å€¼ä¸ºçœŸå®æ—¶é—´å€¼ã€åŠ¨æ€æ—¶é—´å€¼ã€ç»å¯¹æ—¶é—´å€¼ is->frame_timer=(double)av_gettime()/1000000.0; is->frame_last_delay = 40e-3;//åˆå§‹åŒ–ä¸Šä¸€å¸§å›¾åƒçš„åŠ¨æ€åˆ·æ–°å»¶è¿Ÿæ—¶é—´ is->video_current_pts_time = av_gettime();//å–å¾—ç³»ç»Ÿå½“å‰æ—¶é—´ packet_queue_init(&is->videoq);// è§†é¢‘æ•°æ®åŒ…é˜Ÿåˆ—åˆå§‹åŒ– is->decode_tid = SDL_CreateThread(decode_thread,\"è§†é¢‘è§£ç çº¿ç¨‹\" ,is);// åˆ›å»ºè§†é¢‘è§£ç çº¿ç¨‹ // Initialize SWS context for software scalingï¼Œè®¾ç½®å›¾åƒè½¬æ¢åƒç´ æ ¼å¼ä¸ºAV_PIX_FMT_YUV420P is->sws_ctx = sws_getContext(is->video_st->codec->width, is->video_st->codec->height, is->video_st->codec->pix_fmt, is->video_st->codec->width, is->video_st->codec->height, AV_PIX_FMT_YUV420P, SWS_BILINEAR, NULL, NULL, NULL); codecCtx->get_buffer2 = our_get_buffer; break; default: break; } return 0; } // ç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹å‡½æ•°(ä»è§†é¢‘æ–‡ä»¶ä¸­è§£æå‡ºéŸ³è§†é¢‘ç¼–ç æ•°æ®å•å…ƒï¼Œä¸€ä¸ªAVPacketçš„dataé€šå¸¸å¯¹åº”ä¸€ä¸ªNAL) int parse_thread(void *arg) { VideoState *is = (VideoState *)arg;// ä¼ é€’ç”¨æˆ·å‚æ•° global_video_state = is;// ä¼ é€’å…¨å±€çŠ¶æ€å‚é‡ç»“æ„ä½“ /*------------------------- * æ‰“å¼€å°è£…æ ¼å¼ * æ‰“å¼€è§†é¢‘æ–‡ä»¶ï¼Œè¯»æ–‡ä»¶å¤´å†…å®¹ï¼Œå–å¾—æ–‡ä»¶å®¹å™¨çš„å°è£…ä¿¡æ¯åŠç æµå‚æ•°å¹¶å­˜å‚¨åœ¨avformat_contextä¸­ * å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ * å‚æ•°äºŒï¼šè§†é¢‘è·¯å¾„ * å‚æ•°ä¸‰ï¼šæŒ‡å®šè¾“å…¥çš„æ ¼å¼ * å‚æ•°å››ï¼šè®¾ç½®é»˜è®¤å‚æ•° --------------------------*/ AVFormatContext *avformat_context = NULL;// å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ int avformat_open_input_result = avformat_open_input(&avformat_context, is->filename, NULL, NULL); if (avformat_open_input_result != 0){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æŸ¥æ‰¾éŸ³è§†é¢‘æµ\\n\"); return -1; } is->pFormatCtx = avformat_context;//ä¼ é€’æ–‡ä»¶å®¹å™¨å°è£…ä¿¡æ¯åŠç æµå‚æ•° /*------------------------- * æŸ¥æ‰¾ç æµ * å–å¾—æ–‡ä»¶ä¸­ä¿å­˜çš„ç æµä¿¡æ¯ï¼Œå¹¶å¡«å……åˆ°avformat_context->stream å­—æ®µ * å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ * å‚æ•°äºŒï¼šæŒ‡å®šé»˜è®¤é…ç½® -------------------------*/ int avformat_find_stream_info_result = avformat_find_stream_info(avformat_context, NULL); if (avformat_find_stream_info_result videoStream = -1;//è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 is->audioStream = -1;//éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 // è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 int av_video_stream_index = -1; // éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 int av_audio_stream_index = -1; for (int i = 0; i nb_streams; ++i) { // è‹¥æ–‡ä»¶ä¸­åŒ…å«æœ‰è§†é¢‘æµ if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_VIDEO){ av_video_stream_index = i; } // è‹¥æ–‡ä»¶ä¸­åŒ…å«æœ‰éŸ³é¢‘æµ if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_AUDIO){ av_audio_stream_index = i; } } // æ£€æŸ¥æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨è§†é¢‘æµ if (av_video_stream_index == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ²¡æœ‰æ‰¾åˆ°è§†é¢‘æµ\\n\"); goto fail;//è·³è½¬è‡³å¼‚å¸¸å¤„ç† return -1; } // æ£€æŸ¥æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨éŸ³é¢‘æµ if (av_audio_stream_index == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ²¡æœ‰æ‰¾åˆ°éŸ³é¢‘æµ\\n\"); goto fail;//è·³è½¬è‡³å¼‚å¸¸å¤„ç† return -1; } stream_component_open(is, av_audio_stream_index);// æ ¹æ®æŒ‡å®šç±»å‹æ‰“å¼€éŸ³é¢‘æµ stream_component_open(is, av_video_stream_index);// æ ¹æ®æŒ‡å®šç±»å‹æ‰“å¼€è§†é¢‘æµ // Main decode loop. for (;;) { if (is->quit) {//æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† break; } // Seek stuff goes hereï¼Œæ£€æŸ¥éŸ³è§†é¢‘ç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—é•¿åº¦æ˜¯å¦æº¢å‡º if (is->audioq.size > MAX_AUDIOQ_SIZE || is->videoq.size > MAX_VIDEOQ_SIZE) { SDL_Delay(10); continue; } /*----------------------- * read in a packet and store it in the AVPacket struct * ffmpeg allocates the internal data for us,which is pointed to by packet.data * this is freed by the av_free_packet() -----------------------*/ // è´Ÿè´£ä¿å­˜å‹ç¼©ç¼–ç æ•°æ®ç›¸å…³ä¿¡æ¯çš„ç»“æ„ä½“,æ¯å¸§å›¾åƒç”±ä¸€åˆ°å¤šä¸ªpacketåŒ…ç»„æˆ AVPacket pkt, *packet = &pkt;// åœ¨æ ˆä¸Šåˆ›å»ºä¸´æ—¶æ•°æ®åŒ…å¯¹è±¡å¹¶å…³è”æŒ‡é’ˆ if (av_read_frame(is->pFormatCtx, packet) pFormatCtx->pb->error == 0) { SDL_Delay(100); // No error; wait for user input. continue; } else { break; } } // Is this a packet from the video stream? if (packet->stream_index == is->videoStream) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºè§†é¢‘ç±»å‹ packet_queue_put(&is->videoq, packet);// å‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… } else if (packet->stream_index == is->audioStream) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºéŸ³é¢‘ç±»å‹ packet_queue_put(&is->audioq, packet);// å‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… } else {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºå­—å¹•ç±»å‹ av_packet_unref(packet);// é‡Šæ”¾packetä¸­ä¿å­˜çš„(å­—å¹•)ç¼–ç æ•°æ® } } // All done - wait for it. while (!is->quit) { SDL_Delay(100); } fail:// å¼‚å¸¸å¤„ç† if (1) { SDL_Event event;// SDLäº‹ä»¶å¯¹è±¡ event.type = FF_QUIT_EVENT;// æŒ‡å®šé€€å‡ºäº‹ä»¶ç±»å‹ event.user.data1 = is;// ä¼ é€’ç”¨æˆ·æ•°æ® SDL_PushEvent(&event);// å°†è¯¥äº‹ä»¶å¯¹è±¡å‹å…¥SDLåå°äº‹ä»¶é˜Ÿåˆ— } return 0; } int init_sdl(VideoState *is) { // åˆå§‹åŒ–SDLå¤šåª’ä½“æ¡†æ¶ if (SDL_Init( SDL_INIT_VIDEO | SDL_INIT_AUDIO | SDL_INIT_TIMER ) == -1) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); return -1; } // åˆå§‹åŒ–SDLçª—å£ SDL_Window* sdl_window = SDL_CreateWindow(\"FFmpeg+SDLæ’­æ”¾è§†é¢‘\",// å‚æ•°ä¸€ï¼šçª—å£åç§° SDL_WINDOWPOS_CENTERED,// å‚æ•°äºŒï¼šçª—å£åœ¨å±å¹•ä¸Šçš„xåæ ‡ SDL_WINDOWPOS_CENTERED,// å‚æ•°ä¸‰ï¼šçª—å£åœ¨å±å¹•ä¸Šçš„yåæ ‡ is->video_width,// å‚æ•°å››ï¼šçª—å£åœ¨å±å¹•ä¸Šå®½ is->video_height,// å‚æ•°äº”ï¼šçª—å£åœ¨å±å¹•ä¸Šé«˜ SDL_WINDOW_OPENGL);// å‚æ•°å…­ï¼šçª—å£çŠ¶æ€(æ‰“å¼€) if (sdl_window == NULL){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"çª—å£åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çª—å£åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } // åˆ›å»ºæ¸²æŸ“å™¨ // å®šä¹‰æ¸²æŸ“å™¨åŒºåŸŸ SDL_Renderer* sdl_renderer = SDL_CreateRenderer(sdl_window,// æ¸²æŸ“ç›®æ ‡åˆ›å»º -1, // ä»é‚£é‡Œå¼€å§‹æ¸²æŸ“(-1:è¡¨ç¤ºä»ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹) 0);// æ¸²æŸ“ç±»å‹(è½¯ä»¶æ¸²æŸ“) if (sdl_renderer == NULL){ __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } // åˆ›å»ºçº¹ç† SDL_Texture* sdl_texture = SDL_CreateTexture(sdl_renderer,// æ¸²æŸ“å™¨ SDL_PIXELFORMAT_IYUV,// åƒç´ æ•°æ®æ ¼å¼ SDL_TEXTUREACCESS_STREAMING,// ç»˜åˆ¶æ–¹å¼ï¼šé¢‘ç¹ç»˜åˆ¶- is->video_width,// çº¹ç†å®½ is->video_height);// çº¹ç†é«˜ if (sdl_texture == NULL) { __android_log_print(ANDROID_LOG_INFO, \"main\", \"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } is->sdl_renderer = sdl_renderer; is->sdl_texture = sdl_texture; return 0; } // SDLå…¥å£ extern \"C\" int main(int argc, char *argv[]) { /*------------------------- * æ³¨å†Œç»„ä»¶ * æ³¨å†Œæ‰€æœ‰ffmpegæ”¯æŒçš„å¤šåª’ä½“æ ¼å¼åŠç¼–è§£ç å™¨ -------------------------*/ av_register_all(); // åˆ›å»ºå…¨å±€çŠ¶æ€å¯¹è±¡ VideoState *is= (VideoState *)av_mallocz(sizeof(VideoState)); av_strlcpy(is->filename, \"/storage/emulated/0/Download/test.mov\", sizeof(is->filename));// å¤åˆ¶è§†é¢‘æ–‡ä»¶è·¯å¾„å is->video_width = 640; is->video_height = 352; av_strlcpy(is->filename, \"/storage/emulated/0/DCIM/Camera/TG-2022-04-13-160703582.mp4\", sizeof(is->filename));// å¤åˆ¶è§†é¢‘æ–‡ä»¶è·¯å¾„å is->video_width = 720; is->video_height = 1280; is->pictq_lock = SDL_CreateMutex();// åˆ›å»ºç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—äº’æ–¥é”å¯¹è±¡ is->pictq_ready = SDL_CreateCond();// åˆ›å»ºç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å¯¹è±¡ int init_sdl_result = init_sdl(is); if (init_sdl_result av_sync_type = DEFAULT_AV_SYNC_TYPE;//æŒ‡å®šä¸»åŒæ­¥æº // åˆ›å»ºç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹ is->parse_tid = SDL_CreateThread(parse_thread, \"ç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹\", is); if (!is->parse_tid) {// æ£€æŸ¥çº¿ç¨‹æ˜¯å¦åˆ›å»ºæˆåŠŸ av_free(is); return -1; } // SDLäº‹ä»¶å¯¹è±¡ SDL_Event event; for (;;) {// SDLäº‹ä»¶å¾ªç¯ SDL_WaitEvent(&event);// ä¸»çº¿ç¨‹é˜»å¡ï¼Œç­‰å¾…äº‹ä»¶åˆ°æ¥ switch(event.type) {// äº‹ä»¶åˆ°æ¥åå”¤é†’ä¸»çº¿ç¨‹ï¼Œæ£€æŸ¥äº‹ä»¶ç±»å‹ case FF_QUIT_EVENT: case SDL_QUIT:// é€€å‡ºè¿›ç¨‹äº‹ä»¶ is->quit = 1; // If the video has finished playing, then both the picture and audio queues are waiting for more data. // Make them stop waiting and terminate normally.. avcodec_close(is->video_st->codec); avformat_free_context(is->pFormatCtx); SDL_CondSignal(is->audioq.qready);// å‘å‡ºé˜Ÿåˆ—å°±ç»ªä¿¡å·é¿å…æ­»é” SDL_CondSignal(is->videoq.qready); SDL_DestroyTexture(is->sdl_texture); SDL_DestroyRenderer(is->sdl_renderer); SDL_Quit(); return 0; case FF_ALLOC_EVENT: alloc_picture(event.user.data1);// åˆ†é…è§†é¢‘å¸§äº‹ä»¶å“åº”å‡½æ•° break; case FF_REFRESH_EVENT:// è§†é¢‘æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶ video_refresh_timer(event.user.data1);// è§†é¢‘æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶å“åº”å‡½æ•° break; default: break; } } return 0; } "},"pages/FFmpeg/FFmpeg_SDLå¿«è¿›å¿«é€€.html":{"url":"pages/FFmpeg/FFmpeg_SDLå¿«è¿›å¿«é€€.html","title":"FFmpeg+SDLå¿«è¿›å¿«é€€","keywords":"","body":"FFmpeg+SDLå¿«è¿›å¿«é€€ iOSå·¥ç¨‹ä»£ç  ffmpegæ’­æ”¾å™¨å®ç°è¯¦è§£ - å¿«è¿›å¿«é€€æ§åˆ¶ï¼šhttps://www.cnblogs.com/breakpointlab/p/15807316.html æºä»£ç ä¸€è§ˆ #import #import \"AppDelegate.h\" #import \"SDL.h\" //#include //#include //#include #include #include \"SDL.h\" #include \"SDL_thread.h\" #include \"SDL_syswm.h\" #import \"ViewController.h\" #define SDL_AUDIO_BUFFER_SIZE 1024 #define MAX_AUDIO_FRAME_SIZE 192000 #define AV_SYNC_THRESHOLD 0.01//å‰åä¸¤å¸§é—´çš„æ˜¾ç¤ºæ—¶é—´é—´éš”çš„æœ€å°å€¼0.01s #define AV_NOSYNC_THRESHOLD 10.0//æœ€å°åˆ·æ–°é—´éš”æ—¶é—´10ms #define MAX_AUDIOQ_SIZE (5 * 16 * 1024) #define MAX_VIDEOQ_SIZE (5 * 256 * 1024) #define FF_ALLOC_EVENT (SDL_USEREVENT) #define FF_REFRESH_EVENT (SDL_USEREVENT + 1) #define FF_QUIT_EVENT (SDL_USEREVENT + 2) #define VIDEO_PICTURE_QUEUE_SIZE 1 #define SAMPLE_CORRECTION_PERCENT_MAX 10 #define AUDIO_DIFF_AVG_NB 20 //extern \"C\" { #include #include \"libavformat/avformat.h\" #include #include #include #include #include #include //} AVPacket flush_pkt;//åœ¨æ‰§è¡Œ[å¿«è¿›]/[å¿«é€€]æ“ä½œåï¼Œffmpegéœ€è¦æ‰§è¡Œé‡ç½®è§£ç å™¨æ“ä½œ uint64_t global_video_pkt_pts = AV_NOPTS_VALUE; enum {//åŒæ­¥æ—¶é’Ÿæº AV_SYNC_AUDIO_MASTER,//éŸ³é¢‘æ—¶é’Ÿä¸ºä¸»åŒæ­¥æº AV_SYNC_VIDEO_MASTER,//è§†é¢‘æ—¶é’Ÿä¸ºä¸»åŒæ­¥æº AV_SYNC_EXTERNAL_MASTER,//å¤–éƒ¨æ—¶é’Ÿä¸ºä¸»åŒæ­¥æº }; #define DEFAULT_AV_SYNC_TYPE AV_SYNC_AUDIO_MASTER//æŒ‡å®šä»¥è§†é¢‘æ—¶é’Ÿä¸ºä¸»åŒæ­¥æº(æ—¶é—´åŸºå‡†) SDL_Window *screen;//SDLç»˜å›¾è¡¨é¢ /*-------é“¾è¡¨èŠ‚ç‚¹ç»“æ„ä½“-------- typedef struct AVPacketList { AVPacket pkt;//é“¾è¡¨æ•°æ® struct AVPacketList *next;//é“¾è¡¨åç»§èŠ‚ç‚¹ } AVPacketList; ---------------------------*/ // æ•°æ®åŒ…é˜Ÿåˆ—(é“¾è¡¨)ç»“æ„ä½“ typedef struct PacketQueue { AVPacketList *first_pkt, *last_pkt;// é˜Ÿåˆ—é¦–å°¾èŠ‚ç‚¹æŒ‡é’ˆ int nb_packets;// é˜Ÿåˆ—é•¿åº¦ int size;// ä¿å­˜ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ï¼Œsize=packet->size SDL_mutex *qlock;// é˜Ÿåˆ—äº’æ–¥é‡ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® SDL_cond *qready;// é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å˜é‡ } PacketQueue; // å›¾åƒå¸§ç»“æ„ä½“ typedef struct VideoPicture { AVFrame *avframe_yuv420p; int width, height;//Source height & width. int allocated;//æ˜¯å¦åˆ†é…å†…å­˜ç©ºé—´ï¼Œè§†é¢‘å¸§è½¬æ¢ä¸ºSDL overlayæ ‡è¯† double pts;//å½“å‰å›¾åƒå¸§çš„ç»å¯¹æ˜¾ç¤ºæ—¶é—´æˆ³ } VideoPicture; typedef struct VideoState { AVFormatContext *pFormatCtx;// ä¿å­˜æ–‡ä»¶å®¹å™¨å°è£…ä¿¡æ¯åŠç æµå‚æ•°çš„ç»“æ„ä½“ AVStream *video_st;// è§†é¢‘æµä¿¡æ¯ç»“æ„ä½“ AVStream *audio_st;//éŸ³é¢‘æµä¿¡æ¯ç»“æ„ä½“ struct SwsContext *sws_ctx;// æè¿°è½¬æ¢å™¨å‚æ•°çš„ç»“æ„ä½“ struct SwsContext *sws_ctx_audio; PacketQueue videoq;// è§†é¢‘ç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—(ç¼–ç æ•°æ®é˜Ÿåˆ—ï¼Œä»¥é“¾è¡¨æ–¹å¼å®ç°) VideoPicture pictq[VIDEO_PICTURE_QUEUE_SIZE]; int pictq_size, pictq_rindex, pictq_windex;// é˜Ÿåˆ—é•¿åº¦ï¼Œè¯»/å†™ä½ç½®ç´¢å¼• SDL_mutex *pictq_lock;// é˜Ÿåˆ—è¯»å†™é”å¯¹è±¡ï¼Œä¿æŠ¤å›¾åƒå¸§é˜Ÿåˆ—æ•°æ® SDL_cond *pictq_ready;// é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å˜é‡ SDL_Rect sdl_rect; SDL_Renderer* sdl_renderer; SDL_Texture* sdl_texture; PacketQueue audioq;// éŸ³é¢‘ç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—(ç¼–ç æ•°æ®é˜Ÿåˆ—ï¼Œä»¥é“¾è¡¨æ–¹å¼å®ç°) uint8_t audio_buf[(MAX_AUDIO_FRAME_SIZE*3)/2];//ä¿å­˜è§£ç ä¸€ä¸ªpacketåçš„å¤šå¸§åŸå§‹éŸ³é¢‘æ•°æ®(è§£ç æ•°æ®é˜Ÿåˆ—ï¼Œä»¥æ•°ç»„æ–¹å¼å®ç°) unsigned int audio_buf_size;//è§£ç åçš„å¤šå¸§éŸ³é¢‘æ•°æ®é•¿åº¦ unsigned int audio_buf_index;//ç´¯è®¡å†™å…¥streamçš„é•¿åº¦ uint8_t *audio_pkt_data;//ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆä½ç½® int audio_pkt_size;//ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦(æ˜¯å¦å·²å®Œæˆä¸€ä¸ªå®Œæ•´çš„pakcetåŒ…çš„è§£ç ï¼Œä¸€ä¸ªæ•°æ®åŒ…ä¸­å¯èƒ½åŒ…å«å¤šä¸ªéŸ³é¢‘ç¼–ç å¸§) AVPacket audio_pkt;//ä¿å­˜ä»é˜Ÿåˆ—ä¸­æå–çš„æ•°æ®åŒ… AVFrame audio_frame;//ä¿å­˜ä»æ•°æ®åŒ…ä¸­è§£ç çš„éŸ³é¢‘æ•°æ® int video_width; int video_height; char filename[1024];// è¾“å…¥æ–‡ä»¶å®Œæ•´è·¯å¾„å int videoStream, audioStream;// éŸ³è§†é¢‘æµç±»å‹æ ‡å· SDL_Thread *parse_tid;// ç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹id SDL_Thread *decode_tid;// è§£ç çº¿ç¨‹id int quit;// å…¨å±€é€€å‡ºè¿›ç¨‹æ ‡è¯†ï¼Œåœ¨ç•Œé¢ä¸Šç‚¹äº†é€€å‡ºåï¼Œå‘Šè¯‰çº¿ç¨‹é€€å‡º //video/audio_clock save pts of last decoded frame/predicted pts of next decoded frame double video_clock;//keep track of how much time has passed according to the video double audio_clock; double frame_timer;//è§†é¢‘æ’­æ”¾åˆ°å½“å‰å¸§æ—¶çš„ç´¯è®¡å·²æ’­æ”¾æ—¶é—´ double frame_last_pts;//ä¸Šä¸€å¸§å›¾åƒçš„æ˜¾ç¤ºæ—¶é—´æˆ³ï¼Œç”¨äºåœ¨video_refersh_timerä¸­ä¿å­˜ä¸Šä¸€å¸§çš„ptså€¼ double frame_last_delay;//ä¸Šä¸€å¸§å›¾åƒçš„åŠ¨æ€åˆ·æ–°å»¶è¿Ÿæ—¶é—´ int av_sync_type;//ä¸»åŒæ­¥æºç±»å‹ double external_clock;//External clock base int64_t external_clock_time;//å¤–éƒ¨æ—¶é’Ÿçš„ç»å¯¹æ—¶é—´ double audio_diff_cum;//éŸ³é¢‘æ—¶é’Ÿä¸åŒæ­¥æºç´¯è®¡æ—¶å·®ï¼Œsed for AV difference average computation double audio_diff_avg_coef;//éŸ³é¢‘æ—¶é’Ÿä¸åŒæ­¥æºæ—¶å·®å‡å€¼åŠ æƒç³»æ•° double audio_diff_threshold;//éŸ³é¢‘æ—¶é’Ÿä¸åŒæ­¥æºæ—¶å·®å‡å€¼é˜ˆå€¼ int audio_diff_avg_count;//éŸ³é¢‘ä¸åŒæ­¥è®¡æ•°(éŸ³é¢‘æ—¶é’Ÿä¸ä¸»åŒæ­¥æºå­˜åœ¨ä¸åŒæ­¥çš„æ¬¡æ•°) int audio_hw_buf_size; double video_current_pts;//å½“å‰å¸§æ˜¾ç¤ºæ—¶é—´æˆ³ï¼ŒCurrent displayed pts (different from video_clock if frame fifos are used) int64_t video_current_pts_time;//å–å¾—video_current_ptsçš„ç³»ç»Ÿæ—¶é—´ï¼Œtime (av_gettime) at which we updated video_current_pts - used to have running video pts int seek_req;//[å¿«è¿›]/[åé€€]æ“ä½œå¼€å¯æ ‡å¿—ä½ int seek_flags;//[å¿«è¿›]/[åé€€]æ“ä½œç±»å‹æ ‡å¿—ä½ int64_t seek_pos;//[å¿«è¿›]/[åé€€]æ“ä½œåçš„å‚è€ƒæ—¶é—´æˆ³ } VideoState;// Since we only have one decoding thread, the Big Struct can be global in case we need it. VideoState *global_video_state; /*------å–å¾—å½“å‰æ’­æ”¾éŸ³é¢‘æ•°æ®çš„pts------ * éŸ³è§†é¢‘åŒæ­¥çš„åŸç†æ˜¯æ ¹æ®éŸ³é¢‘çš„ptsæ¥æ§åˆ¶è§†é¢‘çš„æ’­æ”¾ * ä¹Ÿå°±æ˜¯è¯´åœ¨è§†é¢‘è§£ç ä¸€å¸§åï¼Œæ˜¯å¦æ˜¾ç¤ºä»¥åŠæ˜¾ç¤ºå¤šé•¿æ—¶é—´ï¼Œæ˜¯é€šè¿‡è¯¥å¸§çš„PTSä¸åŒæ—¶æ­£åœ¨æ’­æ”¾çš„éŸ³é¢‘çš„PTSæ¯”è¾ƒè€Œæ¥çš„ * å¦‚æœéŸ³é¢‘çš„PTSè¾ƒå¤§ï¼Œåˆ™è§†é¢‘å‡†å¤‡å®Œæ¯•ç«‹å³åˆ·æ–°ï¼Œå¦åˆ™ç­‰å¾… * * å› ä¸ºpcmæ•°æ®é‡‡ç”¨audio_callbackå›è°ƒæ–¹å¼è¿›è¡Œæ’­æ”¾ * å¯¹äºéŸ³é¢‘æ’­æ”¾æˆ‘ä»¬åªèƒ½å¾—åˆ°å†™å…¥å›è°ƒå‡½æ•°å‰ç¼“å­˜éŸ³é¢‘å¸§çš„ptsï¼Œè€Œæ— æ³•å¾—åˆ°å½“å‰æ’­æ”¾å¸§çš„pts(éœ€è¦é‡‡ç”¨å½“å‰æ’­æ”¾éŸ³é¢‘å¸§çš„ptsä½œä¸ºå‚è€ƒæ—¶é’Ÿ) * è€ƒè™‘åˆ°éŸ³é¢‘çš„å¤§å°ä¸æ’­æ”¾æ—¶é—´æˆæ­£æ¯”(ç›¸åŒé‡‡æ ·ç‡)ï¼Œé‚£ä¹ˆå½“å‰æ—¶åˆ»æ­£åœ¨æ’­æ”¾çš„éŸ³é¢‘å¸§pts(ä½äºå›è°ƒå‡½æ•°ç¼“å­˜ä¸­) * å°±å¯ä»¥æ ¹æ®å·²é€å…¥å£°å¡çš„pcmæ•°æ®é•¿åº¦ã€ç¼“å­˜ä¸­å‰©ä½™pcmæ•°æ®é•¿åº¦ï¼Œç¼“å­˜é•¿åº¦åŠé‡‡æ ·ç‡è¿›è¡Œæ¨ç®—äº† --------------------------------*/ double get_audio_clock(VideoState *is) { double pts=is->audio_clock;//Maintained in the audio threadï¼Œå–å¾—è§£ç æ“ä½œå®Œæˆæ—¶çš„å½“å‰æ’­æ”¾æ—¶é—´æˆ³ //è¿˜æœª(é€å…¥å£°å¡)æ’­æ”¾çš„å‰©ä½™åŸå§‹éŸ³é¢‘æ•°æ®é•¿åº¦ï¼Œç­‰äºè§£ç åçš„å¤šå¸§åŸå§‹éŸ³é¢‘æ•°æ®é•¿åº¦-ç´¯è®¡é€å…¥å£°å¡çš„é•¿åº¦ int hw_buf_size=is->audio_buf_size-is->audio_buf_index;//è®¡ç®—å½“å‰éŸ³é¢‘è§£ç æ•°æ®ç¼“å­˜ç´¢å¼•ä½ç½® int bytes_per_sec=0;//æ¯ç§’çš„åŸå§‹éŸ³é¢‘å­—èŠ‚æ•° int pcm_bytes=is->audio_st->codec->channels*2;//æ¯ç»„åŸå§‹éŸ³é¢‘æ•°æ®å­—èŠ‚æ•°=å£°é“æ•°*æ¯å£°é“æ•°æ®å­—èŠ‚æ•° if (is->audio_st) { bytes_per_sec=is->audio_st->codec->sample_rate*pcm_bytes;//è®¡ç®—æ¯ç§’çš„åŸå§‹éŸ³é¢‘å­—èŠ‚æ•° } if (bytes_per_sec) {//æ£€æŸ¥æ¯ç§’çš„åŸå§‹éŸ³é¢‘å­—èŠ‚æ•° pts-=(double)hw_buf_size/bytes_per_sec;//æ ¹æ®é€å…¥å£°å¡ç¼“å­˜çš„ç´¢å¼•ä½ç½®ï¼Œå¾€å‰å€’æ¨è®¡ç®—å½“å‰æ—¶åˆ»çš„éŸ³é¢‘æ’­æ”¾æ—¶é—´æˆ³pts } return pts;//è¿”å›å½“å‰æ­£åœ¨æ’­æ”¾çš„éŸ³é¢‘æ—¶é—´æˆ³ } /*-----------å–å¾—è§†é¢‘æ—¶é’Ÿ----------- * å³å–å¾—å½“å‰æ’­æ”¾è§†é¢‘å¸§çš„ptsï¼Œä»¥è§†é¢‘æ—¶é’Ÿptsä½œä¸ºéŸ³è§†é¢‘åŒæ­¥åŸºå‡†ï¼Œreturn the current time offset of the video currently being played * è¯¥å€¼ä¸ºå½“å‰å¸§æ—¶é—´æˆ³pts+ä¸€ä¸ªå¾®å°çš„ä¿®æ­£å€¼delta * å› ä¸ºåœ¨msçš„çº§åˆ«ä¸Šï¼Œåœ¨æ¯«ç§’çº§åˆ«ä¸Šï¼Œè‹¥å–å¾—è§†é¢‘æ—¶é’Ÿ(å³å½“å‰å¸§pts)çš„æ—¶åˆ»ï¼Œä¸è°ƒç”¨è§†é¢‘æ—¶é’Ÿçš„æ—¶åˆ»(å¦‚å°†éŸ³é¢‘åŒæ­¥åˆ°è¯¥è§†é¢‘ptsæ—¶åˆ»)å­˜åœ¨å»¶è¿Ÿ * é‚£ä¹ˆï¼Œè§†é¢‘æ—¶é’Ÿéœ€è¦åœ¨è¢«è°ƒç”¨æ—¶è¿›è¡Œä¿®æ­£ï¼Œä¿®æ­£å€¼deltaä¸º * delta=[å–å¾—è§†é¢‘æ—¶é’Ÿçš„æ—¶åˆ»å€¼video_current_pts_time] åˆ° [è°ƒç”¨get_video_clockæ—¶åˆ»å€¼] çš„é—´éš”æ—¶é—´ * é€šå¸¸æƒ…å†µä¸‹ï¼Œéƒ½ä¼šé€‰æ‹©ä»¥å¤–éƒ¨æ—¶é’Ÿæˆ–éŸ³é¢‘æ—¶é’Ÿä½œä¸ºä¸»åŒæ­¥æºï¼Œä»¥è§†é¢‘åŒæ­¥åˆ°éŸ³é¢‘æˆ–å¤–éƒ¨æ—¶é’Ÿä¸ºé¦–é€‰åŒæ­¥æ–¹æ¡ˆ * ä»¥è§†é¢‘æ—¶é’Ÿä½œä¸ºä¸»åŒæ­¥æºçš„åŒæ­¥æ–¹æ¡ˆï¼Œå±äº3ç§åŸºæœ¬çš„åŒæ­¥æ–¹æ¡ˆ(åŒæ­¥åˆ°éŸ³é¢‘ã€åŒæ­¥åˆ°è§†é¢‘ã€åŒæ­¥åˆ°å¤–éƒ¨æ—¶é’Ÿ) * æœ¬åˆ©ä»…ä¸ºå±•ç¤ºåŒæ­¥åˆ°è§†é¢‘æ—¶é’Ÿçš„æ–¹æ³•ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åŒæ­¥åˆ°è§†é¢‘æ—¶é’Ÿä»…ä½œä¸ºè¾…åŠ©çš„åŒæ­¥æ–¹æ¡ˆ --------------------------------*/ double get_video_clock(VideoState *is) { double delta=(av_gettime()-is->video_current_pts_time)/1000000.0; //pts_of_last_frame+(Current_time-time_elapsed_since_pts_value_was_set) return is->video_current_pts+delta; } //å–å¾—ç³»ç»Ÿæ—¶é—´ï¼Œä»¥ç³»ç»Ÿæ—¶é’Ÿä½œä¸ºåŒæ­¥åŸºå‡† double get_external_clock(VideoState *is) { return av_gettime()/1000000.0;//å–å¾—ç³»ç»Ÿå½“å‰æ—¶é—´ï¼Œä»¥1/1000000ç§’ä¸ºå•ä½ï¼Œä¾¿äºåœ¨å„ä¸ªå¹³å°ç§»æ¤ } //å–å¾—ä¸»æ—¶é’Ÿ(åŸºå‡†æ—¶é’Ÿ) double get_master_clock(VideoState *is) { if (is->av_sync_type == AV_SYNC_VIDEO_MASTER) { return get_video_clock(is);//è¿”å›è§†é¢‘æ—¶é’Ÿ } else if (is->av_sync_type == AV_SYNC_AUDIO_MASTER) { return get_audio_clock(is);//è¿”å›éŸ³é¢‘æ—¶é’Ÿ } else { return get_external_clock(is);//è¿”å›ç³»ç»Ÿæ—¶é’Ÿ } } /*--------------------------- * return the wanted number of samples to get better sync if sync_type is video or external master clock * é€šå¸¸æƒ…å†µä¸‹ä¼šä»¥éŸ³é¢‘æˆ–ç³»ç»Ÿæ—¶é’Ÿä¸ºä¸»åŒæ­¥æºï¼Œåªæœ‰åœ¨éŸ³é¢‘æˆ–ç³»ç»Ÿæ—¶é’Ÿå¤±æ•ˆçš„æƒ…å†µä¸‹æ‰ä»¥è§†é¢‘ä¸ºä¸»åŒæ­¥æº * è¯¥å‡½æ•°æ¯”å¯¹éŸ³é¢‘æ—¶é’Ÿä¸ä¸»åŒæ­¥æºçš„æ—¶å·®ï¼Œé€šè¿‡åŠ¨æ€ä¸¢å¸§(æˆ–æ’å€¼)éƒ¨åˆ†éŸ³é¢‘æ•°æ®ï¼Œä»¥èµ·åˆ°å‡å°‘(æˆ–å¢åŠ )éŸ³é¢‘æ’­æ”¾æ—¶é•¿ï¼Œå‡å°‘ä¸ä¸»åŒæ­¥æºæ—¶å·®çš„ä½œç”¨ * è¯¥å‡½æ•°å¯¹éŸ³é¢‘ç¼“å­˜æ•°æ®è¿›è¡Œä¸¢å¸§(æˆ–æ’å€¼)ï¼Œè¿”å›ä¸¢å¸§(æˆ–æ’å€¼)åçš„éŸ³é¢‘æ•°æ®é•¿åº¦ * å› ä¸ºéŸ³é¢‘åŒæ­¥å¯èƒ½å¸¦æ¥è¾“å‡ºå£°éŸ³ä¸è¿ç»­ç­‰å‰¯ä½œç”¨ï¼Œè¯¥å‡½æ•°é€šè¿‡éŸ³é¢‘ä¸åŒæ­¥æ¬¡æ•°(audio_diff_avg_count)åŠæ—¶å·®å‡å€¼(avg_diff)æ¥çº¦æŸéŸ³é¢‘çš„åŒæ­¥è¿‡ç¨‹ ---------------------------*/ int synchronize_audio(VideoState *is, short *samples, int samples_size, double pts) { double ref_clock;//ä¸»åŒæ­¥æº(åŸºå‡†æ—¶é’Ÿ) int pcm_bytes=is->audio_st->codec->channels*2;//æ¯ç»„éŸ³é¢‘æ•°æ®å­—èŠ‚æ•°=å£°é“æ•°*æ¯å£°é“æ•°æ®å­—èŠ‚æ•° /* if not master, then we try to remove or add samples to correct the clock */ if (is->av_sync_type != AV_SYNC_AUDIO_MASTER) {//æ£€æŸ¥ä¸»åŒæ­¥æºï¼Œè‹¥åŒæ­¥æºä¸æ˜¯éŸ³é¢‘æ—¶é’Ÿçš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹ä»£ç  double diff, avg_diff;//diff-éŸ³é¢‘å¸§æ’­æ”¾é—´ä¸ä¸»åŒæ­¥æºæ—¶å·®ï¼Œavg_diff-é‡‡æ ·ä¸åŒæ­¥å¹³å‡å€¼ int wanted_size, min_size, max_size;//ç»è¿‡ä¸¢å¸§(æˆ–æ’å€¼)åçš„ç¼“å­˜é•¿åº¦ï¼Œç¼“å­˜é•¿åº¦æœ€å¤§/æœ€å°å€¼ ref_clock = get_master_clock(is);//å–å¾—å½“å‰ä¸»åŒæ­¥æºï¼Œä»¥ä¸»åŒæ­¥æºä¸ºåŸºå‡†æ—¶é—´ diff = get_audio_clock(is) - ref_clock;//è®¡ç®—éŸ³é¢‘æ—¶é’Ÿä¸å½“å‰ä¸»åŒæ­¥æºçš„æ—¶å·® if (diffaudio_diff_cum=diff+is->audio_diff_avg_coef*is->audio_diff_cum; if (is->audio_diff_avg_countaudio_diff_avg_count++;//éŸ³é¢‘ä¸åŒæ­¥è®¡æ•°æ›´æ–° } else {//å½“éŸ³é¢‘ä¸åŒæ­¥æ¬¡æ•°è¶…è¿‡é˜ˆå€¼é™å®šåï¼Œè§¦å‘éŸ³é¢‘åŒæ­¥æ“ä½œ avg_diff=is->audio_diff_cum*(1.0-is->audio_diff_avg_coef);//è®¡ç®—æ—¶å·®å‡å€¼(ç­‰æ¯”çº§æ•°å‡ ä½•å¹³å‡æ•°) if (fabs(avg_diff)>=is->audio_diff_threshold) {//æ¯”å¯¹æ—¶å·®å‡å€¼ä¸æ—¶å·®é˜ˆå€¼ wanted_size=samples_size+((int)(diff*is->audio_st->codec->sample_rate)*pcm_bytes);//æ ¹æ®æ—¶å·®æ¢ç®—åŒæ­¥åçš„ç¼“å­˜é•¿åº¦ min_size=samples_size*((100-SAMPLE_CORRECTION_PERCENT_MAX)/100);//åŒæ­¥åçš„ç¼“å­˜é•¿åº¦æœ€å°å€¼ max_size=samples_size*((100+SAMPLE_CORRECTION_PERCENT_MAX)/100);//åŒæ­¥åçš„ç¼“å­˜é•¿åº¦æœ€å¤§å€¼ if (wanted_sizemax_size) {//è‹¥åŒæ­¥åç¼“å­˜é•¿åº¦>æœ€å°ç¼“å­˜é•¿åº¦ wanted_size=max_size;//ç”¨æœ€å¤§ç¼“å­˜é•¿åº¦ä½œä¸ºåŒæ­¥åçš„ç¼“å­˜é•¿åº¦ } if (wanted_sizesamples_size) {//è‹¥åŒæ­¥åç¼“å­˜é•¿åº¦å¤§äºå½“å‰ç¼“å­˜é•¿åº¦ //Add samples by copying final sampleï¼Œé€šè¿‡å¤åˆ¶æœ€åä¸€ä¸ªéŸ³é¢‘æ•°æ®è¿›è¡Œæ’å€¼ //int nb=samples_size-wanted_size; int nb=wanted_size-samples_size;//è®¡ç®—æ’å€¼åç¼“å­˜é•¿åº¦ä¸åŸå§‹ç¼“å­˜é•¿åº¦é—´çš„å·®å€¼(éœ€è¦æ’å€¼çš„éŸ³é¢‘æ•°æ®ç»„æ•°) uint8_t *samples_end=(uint8_t*)samples+samples_size-pcm_bytes;//å–å¾—ç¼“å­˜æœ«ç«¯æ•°æ®æŒ‡é’ˆ uint8_t *q=samples_end+pcm_bytes;//åˆå§‹æ’å€¼ä½ç½®|||q| while (nb>0) {//æ£€æŸ¥æ’å€¼éŸ³é¢‘ç»„æ•°(æ¯ç»„åŒ…æ‹¬ä¸¤ä¸ªå£°é“çš„pcmæ•°æ®) memcpy(q,samples_end,pcm_bytes);//åœ¨samplesåŸå§‹ç¼“å­˜åè¿½åŠ æ’å€¼ q += pcm_bytes;//æ›´æ–°æ’å€¼ä½ç½® nb -= pcm_bytes;//æ›´æ–°æ’å€¼ç»„æ•° } samples_size=wanted_size;//è¿”å›éŸ³é¢‘åŒæ­¥åçš„ç¼“å­˜é•¿åº¦ } } } } else { // Difference is too big, reset diff stuffï¼Œæ—¶å·®è¿‡å¤§ï¼Œé‡ç½®æ—¶å·®ç´¯è®¡å€¼ is->audio_diff_avg_count = 0;//éŸ³é¢‘ä¸åŒæ­¥è®¡æ•°é‡ç½® is->audio_diff_cum = 0;//éŸ³é¢‘ç´¯è®¡æ—¶å·®é‡ç½® } }//end for if (is->av_sync_type != AV_SYNC_AUDIO_MASTER) return samples_size;//è¿”å›å‘é€åˆ°å£°å¡çš„éŸ³é¢‘ç¼“å­˜å­—èŠ‚æ•° } // å®šæ—¶å™¨è§¦å‘çš„å›è°ƒå‡½æ•° static Uint32 sdl_refresh_timer_cb(Uint32 interval, void *opaque) { SDL_Event event;//SDLäº‹ä»¶å¯¹è±¡ event.type = FF_REFRESH_EVENT;//è§†é¢‘æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶ event.user.data1 = opaque;//ä¼ é€’ç”¨æˆ·æ•°æ® SDL_PushEvent(&event);//å‘é€äº‹ä»¶ return 0; // 0 means stop timer. } /*--------------------------- * Schedule a video refresh in 'delay' ms. * å‘Šè¯‰sdlåœ¨æŒ‡å®šçš„å»¶æ—¶åæ¥æ¨é€ä¸€ä¸ª FF_REFRESH_EVENT äº‹ä»¶ * è¿™ä¸ªäº‹ä»¶å°†åœ¨äº‹ä»¶é˜Ÿåˆ—é‡Œè§¦å‘sdl_refresh_timer_cbå‡½æ•°çš„è°ƒç”¨ --------------------------*/ static void schedule_refresh(VideoState *is, int delay) { SDL_AddTimer(delay, sdl_refresh_timer_cb, is);//åœ¨æŒ‡å®šçš„æ—¶é—´(ms)åå›è°ƒç”¨æˆ·æŒ‡å®šçš„å‡½æ•° } // è§†é¢‘(å›¾åƒ)å¸§æ¸²æŸ“ void video_display(VideoState *is) { SDL_Rect rect;// SDLçŸ©å½¢å¯¹è±¡ VideoPicture *vp;// å›¾åƒå¸§ç»“æ„ä½“æŒ‡é’ˆ float aspect_ratio;//å®½åº¦/é«˜åº¦æ¯” int w, h, x, y;//çª—å£å°ºå¯¸åŠèµ·å§‹ä½ç½® vp = &is->pictq[is->pictq_rindex];//ä»å›¾åƒå¸§é˜Ÿåˆ—(æ•°ç»„)ä¸­æå–å›¾åƒå¸§ç»“æ„å¯¹è±¡ if (vp->avframe_yuv420p) {//æ£€æŸ¥åƒç´ æ•°æ®æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆ if (is->video_st->codec->sample_aspect_ratio.num == 0) { aspect_ratio = 0; } else { aspect_ratio = av_q2d(is->video_st->codec->sample_aspect_ratio) * is->video_st->codec->width / is->video_st->codec->height; } if (aspect_ratio video_st->codec->width / (float) is->video_st->codec->height; } // SDLä¸­è·å–å±å¹•å°ºå¯¸ SDL_DisplayMode DM; SDL_GetCurrentDisplayMode(0, &DM); h = DM.h; w = ((int) rint(h * aspect_ratio)) & -3; if (w > DM.w) { w = DM.w; h = ((int) rint(w / aspect_ratio)) & -3; } x = (DM.w - w) / 2; y = (DM.h - h) / 2; // è®¾ç½®çº¹ç†æ•°æ® SDL_UpdateTexture(is->sdl_texture, // çº¹ç† NULL,// æ¸²æŸ“åŒºåŸŸ vp->avframe_yuv420p->data[0],// éœ€è¦æ¸²æŸ“æ•°æ®ï¼šè§†é¢‘åƒç´ æ•°æ®å¸§ vp->avframe_yuv420p->linesize[0]);// å¸§å®½ // å°†çº¹ç†æ•°æ®æ‹·è´ç»™æ¸²æŸ“å™¨ // è®¾ç½®å·¦ä¸Šè§’ä½ç½®(å…¨å±) is->sdl_rect.x = x; is->sdl_rect.y = y; is->sdl_rect.w = w; is->sdl_rect.h = h; SDL_RenderClear(is->sdl_renderer); SDL_RenderCopy(is->sdl_renderer, is->sdl_texture, NULL, &is->sdl_rect); // å‘ˆç°ç”»é¢å¸§ SDL_RenderPresent(is->sdl_renderer); }// end for if }// end for video_display // æ˜¾ç¤ºåˆ·æ–°å‡½æ•°(FF_REFRESH_EVENTå“åº”å‡½æ•°) int video_current_index = 0; void video_refresh_timer(void *userdata) { VideoState *is = (VideoState *)userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® VideoPicture *vp;//å›¾åƒå¸§å¯¹è±¡ //delay-å‰åå¸§é—´çš„æ˜¾ç¤ºæ—¶é—´é—´éš”ï¼Œdiff-å›¾åƒå¸§æ˜¾ç¤ºä¸éŸ³é¢‘å¸§æ’­æ”¾é—´çš„æ—¶é—´å·® //sync_threshold-å‰åå¸§é—´çš„æœ€å°æ—¶é—´å·®ï¼Œactual_delay-å½“å‰å¸§-ä¸‹å·²å¸§çš„æ˜¾ç¤ºæ—¶é—´é—´éš”(åŠ¨æ€æ—¶é—´ã€çœŸå®æ—¶é—´ã€ç»å¯¹æ—¶é—´) double delay,diff,sync_threshold,actual_delay,ref_clock;//ref_clock-éŸ³é¢‘æ—¶é—´æˆ³ if (is->video_st) { if (is->pictq_size == 0) {// æ£€æŸ¥å›¾åƒå¸§é˜Ÿåˆ—æ˜¯å¦æœ‰å¾…æ˜¾ç¤ºå›¾åƒ schedule_refresh(is, 1);//è‹¥é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™å‘é€æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶å¹¶å†æ¬¡è¿›å…¥video_refresh_timerå‡½æ•° } else {// åˆ·æ–°å›¾åƒ vp = &is->pictq[is->pictq_rindex];//ä»æ˜¾ç¤ºé˜Ÿåˆ—ä¸­å–å¾—ç­‰å¾…æ˜¾ç¤ºçš„å›¾åƒå¸§ is->video_current_pts = vp->pts;//å–å¾—å½“å‰å¸§çš„æ˜¾ç¤ºæ—¶é—´æˆ³ is->video_current_pts_time = av_gettime();//å–å¾—ç³»ç»Ÿæ—¶é—´ï¼Œä½œä¸ºå½“å‰å¸§æ’­æ”¾çš„æ—¶é—´åŸºå‡† //è®¡ç®—å½“å‰å¸§å’Œå‰ä¸€å¸§æ˜¾ç¤º(pts)çš„é—´éš”æ—¶é—´(æ˜¾ç¤ºæ—¶é—´æˆ³çš„å·®å€¼) //è®¡ç®—å½“å‰å¸§å’Œå‰ä¸€å¸§æ˜¾ç¤º(pts)çš„é—´éš”æ—¶é—´(æ˜¾ç¤ºæ—¶é—´æˆ³çš„å·®å€¼) delay = vp->pts - is->frame_last_pts;//The pts from last timeï¼Œå‰åå¸§é—´çš„æ—¶é—´å·® if (delay = 1.0) {//æ£€æŸ¥æ—¶é—´é—´éš”æ˜¯å¦åœ¨åˆç†èŒƒå›´ // If incorrect delay, use previous one delay = is->frame_last_delay;//æ²¿ç”¨ä¹‹å‰çš„åŠ¨æ€åˆ·æ–°é—´éš”æ—¶é—´ } // Save for next time is->frame_last_delay = delay;//ä¿å­˜ä¸Šä¸€å¸§å›¾åƒçš„åŠ¨æ€åˆ·æ–°å»¶è¿Ÿæ—¶é—´ is->frame_last_pts = vp->pts;//ä¿å­˜ä¸Šä¸€å¸§å›¾åƒçš„æ˜¾ç¤ºæ—¶é—´æˆ³ // Update delay to sync to audioï¼Œå–å¾—å£°éŸ³æ’­æ”¾æ—¶é—´æˆ³(ä½œä¸ºè§†é¢‘åŒæ­¥çš„å‚è€ƒæ—¶é—´) // Update delay to sync to audioï¼Œå–å¾—å£°éŸ³æ’­æ”¾æ—¶é—´æˆ³(ä½œä¸ºè§†é¢‘åŒæ­¥çš„å‚è€ƒæ—¶é—´) if (is->av_sync_type != AV_SYNC_VIDEO_MASTER) {//æ£€æŸ¥ä¸»åŒæ­¥æ—¶é’Ÿæº ref_clock = get_master_clock(is);//æ ¹æ®Audio clockæ¥åˆ¤æ–­Videoæ’­æ”¾çš„å¿«æ…¢ï¼Œè·å–å½“å‰æ’­æ”¾å£°éŸ³çš„æ—¶é—´æˆ³ //ä¹Ÿå°±æ˜¯è¯´åœ¨diffè¿™æ®µæ—¶é—´ä¸­å£°éŸ³æ˜¯åŒ€é€Ÿå‘ç”Ÿçš„ï¼Œä½†æ˜¯åœ¨delayè¿™æ®µæ—¶é—´frameçš„æ˜¾ç¤ºå¯èƒ½å°±ä¼šæœ‰å¿«æ…¢çš„åŒºåˆ« diff = vp->pts - ref_clock;//è®¡ç®—å›¾åƒå¸§æ˜¾ç¤ºä¸éŸ³é¢‘å¸§æ’­æ”¾é—´çš„æ—¶é—´å·® //æ ¹æ®æ—¶é—´å·®è°ƒæ•´æ’­æ”¾ä¸‹ä¸€å¸§çš„å»¶è¿Ÿæ—¶é—´ï¼Œä»¥å®ç°åŒæ­¥ Skip or repeat the frameï¼ŒTake delay into account sync_threshold = (delay > AV_SYNC_THRESHOLD) ? delay : AV_SYNC_THRESHOLD;//æ¯”è¾ƒå‰åä¸¤å¸§é—´çš„æ˜¾ç¤ºæ—¶é—´é—´éš”ä¸æœ€å°æ—¶é—´é—´éš” //åˆ¤æ–­éŸ³è§†é¢‘ä¸åŒæ­¥æ¡ä»¶ï¼Œå³éŸ³è§†é¢‘é—´çš„æ—¶é—´å·® & å‰åå¸§é—´çš„æ—¶é—´å·®è¯¥é˜ˆå€¼åˆ™ä¸ºå¿«è¿›æ¨¡å¼ï¼Œä¸å­˜åœ¨éŸ³è§†é¢‘åŒæ­¥é—®é¢˜ if (fabs(diff) = sync_threshold) {//æ¯”è¾ƒä¸¤å¸§ç”»é¢é—´çš„æ˜¾ç¤ºæ—¶é—´ä¸ä¸¤å¸§ç”»é¢é—´å£°éŸ³çš„æ’­æ”¾æ—¶é—´ï¼Œå¿«äº†ï¼ŒåŠ å€delay delay = 2 * delay; } }//å¦‚æœdiff(æ˜æ˜¾)å¤§äºAV_NOSYNC_THRESHOLDï¼Œå³å¿«è¿›çš„æ¨¡å¼äº†ï¼Œç”»é¢è·³åŠ¨å¤ªå¤§ï¼Œä¸å­˜åœ¨éŸ³è§†é¢‘åŒæ­¥çš„é—®é¢˜äº† } //æ›´æ–°è§†é¢‘æ’­æ”¾åˆ°å½“å‰å¸§æ—¶çš„å·²æ’­æ”¾æ—¶é—´å€¼(æ‰€æœ‰å›¾åƒå¸§åŠ¨æ€æ’­æ”¾ç´¯è®¡æ—¶é—´å€¼-çœŸå®å€¼)ï¼Œframe_timerä¸€ç›´ç´¯åŠ åœ¨æ’­æ”¾è¿‡ç¨‹ä¸­æˆ‘ä»¬è®¡ç®—çš„å»¶æ—¶ is->frame_timer+=delay; //æ¯æ¬¡è®¡ç®—frame_timerä¸ç³»ç»Ÿæ—¶é—´çš„å·®å€¼(ä»¥ç³»ç»Ÿæ—¶é—´ä¸ºåŸºå‡†æ—¶é—´)ï¼Œå°†frame_timerä¸ç³»ç»Ÿæ—¶é—´(ç»å¯¹æ—¶é—´)ç›¸å…³è”çš„ç›®çš„ actual_delay=is->frame_timer-(av_gettime()/1000000.0);//Computer the REAL delay if (actual_delay pts: %fï¼Œref_clockï¼š%fï¼Œactual_delayï¼š%f\", video_current_index, vp->pts, ref_clock, actual_delay); // Update queue for next picture! if (++is->pictq_rindex == VIDEO_PICTURE_QUEUE_SIZE) {// æ›´æ–°å¹¶æ£€æŸ¥å›¾åƒå¸§é˜Ÿåˆ—è¯»ä½ç½®ç´¢å¼• is->pictq_rindex = 0;// é‡ç½®è¯»ä½ç½®ç´¢å¼• } SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤ç”»å¸ƒçš„åƒç´ æ•°æ® is->pictq_size--;// æ›´æ–°å›¾åƒå¸§é˜Ÿåˆ—é•¿åº¦ SDL_CondSignal(is->pictq_ready);// å‘é€é˜Ÿåˆ—å°±ç»ªä¿¡å· SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ } } else { schedule_refresh(is, 100); } } // æ•°æ®åŒ…é˜Ÿåˆ—åˆå§‹åŒ–å‡½æ•° void packet_queue_init(PacketQueue *q) { memset(q, 0, sizeof(PacketQueue));// å…¨é›¶åˆå§‹åŒ–é˜Ÿåˆ—ç»“æ„ä½“å¯¹è±¡ q->qlock = SDL_CreateMutex();// åˆ›å»ºäº’æ–¥é‡å¯¹è±¡ q->qready = SDL_CreateCond();// åˆ›å»ºæ¡ä»¶å˜é‡å¯¹è±¡ } // å‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… int packet_queue_put(PacketQueue *q, AVPacket *pkt) { /*-------å‡†å¤‡é˜Ÿåˆ—(é“¾è¡¨)èŠ‚ç‚¹å¯¹è±¡------*/ AVPacketList *pktlist=(AVPacketList *)av_malloc(sizeof(AVPacketList));// åœ¨å †ä¸Šåˆ›å»ºé“¾è¡¨èŠ‚ç‚¹å¯¹è±¡ if (!pktlist) {// æ£€æŸ¥é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡æ˜¯å¦åˆ›å»ºæˆåŠŸ return -1; } pktlist->pkt = *pkt;// å°†è¾“å…¥æ•°æ®åŒ…èµ‹å€¼ç»™æ–°å»ºé“¾è¡¨èŠ‚ç‚¹å¯¹è±¡ä¸­çš„æ•°æ®åŒ…å¯¹è±¡ pktlist->next = NULL;// é“¾è¡¨åç»§æŒ‡é’ˆä¸ºç©º // if (av_packet_ref(pkt, pkt) qlock);// é˜Ÿåˆ—äº’æ–¥é‡åŠ é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® if (!q->last_pkt) {// æ£€æŸ¥é˜Ÿåˆ—å°¾èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨(æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º) q->first_pkt = pktlist;// è‹¥ä¸å­˜åœ¨(é˜Ÿåˆ—å°¾ç©º)ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹ä½œé˜Ÿåˆ—ä¸ºé¦–èŠ‚ç‚¹ } else { q->last_pkt->next = pktlist;// è‹¥å·²å­˜åœ¨å°¾èŠ‚ç‚¹ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹æŒ‚åˆ°å°¾èŠ‚ç‚¹çš„åç»§æŒ‡é’ˆä¸Šï¼Œå¹¶ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ } q->last_pkt = pktlist;// å°†å½“å‰èŠ‚ç‚¹ä½œä¸ºæ–°çš„å°¾èŠ‚ç‚¹ q->nb_packets++;// é˜Ÿåˆ—é•¿åº¦+1 q->size += pktlist->pkt.size;// æ›´æ–°é˜Ÿåˆ—ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ SDL_CondSignal(q->qready);// ç»™ç­‰å¾…çº¿ç¨‹å‘å‡ºæ¶ˆæ¯ï¼Œé€šçŸ¥é˜Ÿåˆ—å·²å°±ç»ª SDL_UnlockMutex(q->qlock);// é‡Šæ”¾äº’æ–¥é‡ return 0; } // ä»é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ï¼Œå¹¶å°†æå–çš„æ•°æ®åŒ…å‡ºé˜Ÿåˆ— static int packet_queue_get(PacketQueue *q, AVPacket *pkt, int block) { AVPacketList *pktlist;// ä¸´æ—¶é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡æŒ‡é’ˆ int ret;// æ“ä½œç»“æœ SDL_LockMutex(q->qlock);// é˜Ÿåˆ—äº’æ–¥é‡åŠ é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® for (;;) { if (global_video_state->quit) {// æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† ret = -1;// æ“ä½œå¤±è´¥ break; }//end for if pktlist = q->first_pkt;// ä¼ é€’å°†é˜Ÿåˆ—é¦–ä¸ªæ•°æ®åŒ…æŒ‡é’ˆ if (pktlist) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºç©º(é˜Ÿåˆ—æ˜¯å¦æœ‰æ•°æ®) q->first_pkt = pktlist->next;// é˜Ÿåˆ—é¦–èŠ‚ç‚¹æŒ‡é’ˆåç§» if (!q->first_pkt) {// æ£€æŸ¥é¦–èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ q->last_pkt = NULL;// è‹¥ä¸å­˜åœ¨ï¼Œåˆ™å°†å°¾èŠ‚ç‚¹æŒ‡é’ˆç½®ç©º } q->nb_packets--;// é˜Ÿåˆ—é•¿åº¦-1 q->size -= pktlist->pkt.size;// æ›´æ–°é˜Ÿåˆ—ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ *pkt = pktlist->pkt;// å°†é˜Ÿåˆ—é¦–èŠ‚ç‚¹æ•°æ®è¿”å› av_free(pktlist);// æ¸…ç©ºä¸´æ—¶èŠ‚ç‚¹æ•°æ®(æ¸…ç©ºé¦–èŠ‚ç‚¹æ•°æ®ï¼Œé¦–èŠ‚ç‚¹å‡ºé˜Ÿåˆ—) ret = 1;// æ“ä½œæˆåŠŸ break; } else if (!block) { ret = 0; break; } else {// é˜Ÿåˆ—å¤„äºæœªå°±ç»ªçŠ¶æ€ï¼Œæ­¤æ—¶é€šè¿‡SDL_CondWaitå‡½æ•°ç­‰å¾…qreadyå°±ç»ªä¿¡å·ï¼Œå¹¶æš‚æ—¶å¯¹äº’æ–¥é‡è§£é” /*--------------------- * ç­‰å¾…é˜Ÿåˆ—å°±ç»ªä¿¡å·qreadyï¼Œå¹¶å¯¹äº’æ–¥é‡æš‚æ—¶è§£é” * æ­¤æ—¶çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œå¹¶ç½®äºç­‰å¾…æ¡ä»¶å°±ç»ªçš„çº¿ç¨‹åˆ—è¡¨ä¸Š * ä½¿å¾—è¯¥çº¿ç¨‹åªåœ¨ä¸´ç•ŒåŒºèµ„æºå°±ç»ªåæ‰è¢«å”¤é†’ï¼Œè€Œä¸è‡³äºçº¿ç¨‹è¢«é¢‘ç¹åˆ‡æ¢ * è¯¥å‡½æ•°è¿”å›æ—¶ï¼Œäº’æ–¥é‡å†æ¬¡è¢«é”ä½ï¼Œå¹¶æ‰§è¡Œåç»­æ“ä½œ --------------------*/ SDL_CondWait(q->qready, q->qlock);// æš‚æ—¶è§£é”äº’æ–¥é‡å¹¶å°†è‡ªå·±é˜»å¡ï¼Œç­‰å¾…ä¸´ç•ŒåŒºèµ„æºå°±ç»ª(ç­‰å¾…SDL_CondSignalå‘å‡ºä¸´ç•ŒåŒºèµ„æºå°±ç»ªçš„ä¿¡å·) } }//end for for-loop SDL_UnlockMutex(q->qlock);// é‡Šæ”¾äº’æ–¥é‡ return ret; } // åˆ›å»º/é‡ç½®å›¾åƒå¸§ï¼Œä¸ºå›¾åƒå¸§åˆ†é…å†…å­˜ç©ºé—´ void alloc_picture(void *userdata) { VideoState *is = (VideoState *)userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® VideoPicture *vp=&is->pictq[is->pictq_windex];// ä»å›¾åƒå¸§é˜Ÿåˆ—(æ•°ç»„)ä¸­æå–å›¾åƒå¸§ç»“æ„å¯¹è±¡ if (vp->avframe_yuv420p) {// æ£€æŸ¥å›¾åƒå¸§æ˜¯å¦å·²å­˜åœ¨ // We already have one make another, bigger/smaller. av_frame_free(&vp->avframe_yuv420p); } vp->width = is->video_st->codec->width;// è®¾ç½®å›¾åƒå¸§å®½åº¦ vp->height = is->video_st->codec->height;// è®¾ç½®å›¾åƒå¸§é«˜åº¦ SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤ç”»å¸ƒçš„åƒç´ æ•°æ® vp->allocated = 1;// å›¾åƒå¸§åƒç´ ç¼“å†²åŒºå·²åˆ†é…å†…å­˜ // AV_PIX_FMT_YUV420Pæ ¼å¼çš„è§†é¢‘å¸§ vp->avframe_yuv420p = av_frame_alloc(); // ç»™ç¼“å†²åŒºè®¾ç½®ç±»å‹ int buffer_size =av_image_get_buffer_size(AV_PIX_FMT_YUV420P,// è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ is->video_st->codec->width,// ä¸€å¸§è§†é¢‘åƒç´ æ•°æ®å®½ = è§†é¢‘å®½ is->video_st->codec->height,// ä¸€å¸§è§†é¢‘åƒç´ æ•°æ®é«˜ = è§†é¢‘é«˜ 1);// å­—èŠ‚å¯¹é½æ–¹å¼ï¼Œé»˜è®¤æ˜¯1 // å¼€è¾Ÿä¸€å—å†…å­˜ç©ºé—´ uint8_t *out_buffer = (uint8_t *)av_malloc(buffer_size); // å‘avframe_yuv420på¡«å……æ•°æ® av_image_fill_arrays(vp->avframe_yuv420p->data,// ç›®æ ‡è§†é¢‘å¸§æ•°æ® vp->avframe_yuv420p->linesize,// ç›®æ ‡è§†é¢‘å¸§è¡Œå¤§å° out_buffer,// åŸå§‹æ•°æ® AV_PIX_FMT_YUV420P,// è§†é¢‘åƒç´ æ•°æ®æ ¼å¼ç±»å‹ is->video_st->codec->width,// è§†é¢‘å®½ is->video_st->codec->height,//è§†é¢‘é«˜ 1);// å­—èŠ‚å¯¹é½æ–¹å¼ SDL_CondSignal(is->pictq_ready);// ç»™ç­‰å¾…çº¿ç¨‹å‘å‡ºæ¶ˆæ¯ï¼Œé€šçŸ¥é˜Ÿåˆ—å·²å°±ç»ª SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ } /*--------------------------- * queue_pictureï¼šå›¾åƒå¸§æ’å…¥é˜Ÿåˆ—ç­‰å¾…æ¸²æŸ“ * @isï¼šå…¨å±€çŠ¶æ€å‚æ•°é›† * @pFrameï¼šä¿å­˜å›¾åƒè§£ç æ•°æ®çš„ç»“æ„ä½“ * 1ã€é¦–å…ˆæ£€æŸ¥å›¾åƒå¸§é˜Ÿåˆ—(æ•°ç»„)æ˜¯å¦å­˜åœ¨ç©ºé—´æ’å…¥æ–°çš„å›¾åƒï¼Œè‹¥æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ’å…¥å›¾åƒåˆ™ä½¿å½“å‰çº¿ç¨‹ä¼‘çœ ç­‰å¾… * 2ã€åœ¨åˆå§‹åŒ–çš„æ¡ä»¶ä¸‹ï¼Œé˜Ÿåˆ—(æ•°ç»„)ä¸­VideoPictureçš„bmpå¯¹è±¡(YUV overlay)å°šæœªåˆ†é…ç©ºé—´ï¼Œé€šè¿‡FF_ALLOC_EVENTäº‹ä»¶çš„æ–¹æ³•è°ƒç”¨alloc_pictureåˆ†é…ç©ºé—´ * 3ã€å½“é˜Ÿåˆ—(æ•°ç»„)ä¸­æ‰€æœ‰VideoPictureçš„bmpå¯¹è±¡(YUV overlay)å‡å·²åˆ†é…ç©ºé—´çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è·³è¿‡æ­¥éª¤2å‘bmpå¯¹è±¡æ‹·è´åƒç´ æ•°æ®ï¼Œåƒç´ æ•°æ®åœ¨è¿›è¡Œæ ¼å¼è½¬æ¢åæ‰§è¡Œæ‹·è´æ“ä½œ ---------------------------*/ int queue_picture(VideoState *is, AVFrame *pFrame, double pts) { /*--------1ã€æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦æœ‰æ’å…¥ç©ºé—´-------*/ // Wait until we have space for a new pic. SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤å›¾åƒå¸§é˜Ÿåˆ— while (is->pictq_size >= VIDEO_PICTURE_QUEUE_SIZE && !is->quit) {// æ£€æŸ¥é˜Ÿåˆ—å½“å‰é•¿åº¦ SDL_CondWait(is->pictq_ready, is->pictq_lock);// çº¿ç¨‹ä¼‘çœ ç­‰å¾…pictq_readyä¿¡å· } SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ if (is->quit) {// æ£€æŸ¥è¿›ç¨‹é€€å‡ºæ ‡è¯† return -1; } /*-------2ã€åˆå§‹åŒ–/é‡ç½®YUV overlay-------*/ // windex is set to 0 initially. VideoPicture *vp=&is->pictq[is->pictq_windex];// ä»å›¾åƒå¸§é˜Ÿåˆ—ä¸­æŠ½å–å›¾åƒå¸§å¯¹è±¡ // Allocate or resize the bufferï¼Œæ£€æŸ¥YUV overlayæ˜¯å¦å·²å­˜åœ¨ï¼Œå¦åˆ™åˆå§‹åŒ–YUV overlayï¼Œåˆ†é…åƒç´ ç¼“å­˜ç©ºé—´ if (!vp->avframe_yuv420p || vp->width!=is->video_st->codec->width || vp->height!=is->video_st->codec->height) { vp->allocated = 0;// å›¾åƒå¸§æœªåˆ†é…ç©ºé—´ // We have to do it in the main thread. SDL_Event event;// SDLäº‹ä»¶å¯¹è±¡ event.type = FF_ALLOC_EVENT;//æŒ‡å®šåˆ†é…å›¾åƒå¸§å†…å­˜äº‹ä»¶ event.user.data1 = is;//ä¼ é€’ç”¨æˆ·æ•°æ® SDL_PushEvent(&event);//å‘é€SDLäº‹ä»¶ // Wait until we have a picture allocated. SDL_LockMutex(is->pictq_lock);// é”å®šäº’æ–¥é‡ï¼Œä¿æŠ¤å›¾åƒå¸§é˜Ÿåˆ— while (!vp->allocated && !is->quit) {// æ£€æŸ¥å½“å‰å›¾åƒå¸§æ˜¯å¦å·²åˆå§‹åŒ– SDL_CondWait(is->pictq_ready, is->pictq_lock);// çº¿ç¨‹ä¼‘çœ ç­‰å¾…alloc_pictureå‘é€pictq_readyä¿¡å·å”¤é†’å½“å‰çº¿ç¨‹ } SDL_UnlockMutex(is->pictq_lock);// é‡Šæ”¾äº’æ–¥é‡ if (is->quit) {// æ£€æŸ¥è¿›ç¨‹é€€å‡ºæ ‡è¯† return -1; } }// end for if /*--------3ã€æ‹·è´è§†é¢‘å¸§åˆ°YUV overlay-------*/ // We have a place to put our picture on the queue. if (vp->avframe_yuv420p) {//æ£€æŸ¥åƒç´ æ•°æ®æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆ // Convert the image into YUV format that SDL usesï¼Œå°†è§£ç åçš„å›¾åƒå¸§è½¬æ¢ä¸ºAV_PIX_FMT_YUV420Pæ ¼å¼ï¼Œå¹¶æ‹·è´åˆ°å›¾åƒå¸§é˜Ÿåˆ— sws_scale(is->sws_ctx, (uint8_t const * const *)pFrame->data, pFrame->linesize, 0, is->video_st->codec->height, vp->avframe_yuv420p->data, vp->avframe_yuv420p->linesize); vp->pts = pts;//ä¼ é€’å½“å‰å›¾åƒå¸§çš„ç»å¯¹æ˜¾ç¤ºæ—¶é—´æˆ³ // Now we inform our display thread that we have a pic ready. if (++is->pictq_windex == VIDEO_PICTURE_QUEUE_SIZE) {//æ›´æ–°å¹¶æ£€æŸ¥å½“å‰å›¾åƒå¸§é˜Ÿåˆ—å†™å…¥ä½ç½® is->pictq_windex = 0;//é‡ç½®å›¾åƒå¸§é˜Ÿåˆ—å†™å…¥ä½ç½® } SDL_LockMutex(is->pictq_lock);//é”å®šé˜Ÿåˆ—è¯»å†™é”ï¼Œä¿æŠ¤é˜Ÿåˆ—æ•°æ® is->pictq_size++;//æ›´æ–°å›¾åƒå¸§é˜Ÿåˆ—é•¿åº¦ SDL_UnlockMutex(is->pictq_lock);//é‡Šæ”¾é˜Ÿåˆ—è¯»å†™é” }// end for if return 0; } /*--------------------------- * æ›´æ–°å†…éƒ¨è§†é¢‘æ’­æ”¾è®¡æ—¶å™¨(è®°å½•è§†é¢‘å·²ç»æ’­æ—¶é—´(video_clock)ï¼‰ * @isï¼šå…¨å±€çŠ¶æ€å‚æ•°é›† * @src_frameï¼šå½“å‰(è¾“å…¥çš„)(å¾…æ›´æ–°çš„)å›¾åƒå¸§å¯¹è±¡ * @ptsï¼šå½“å‰å›¾åƒå¸§çš„æ˜¾ç¤ºæ—¶é—´æˆ³ * update the PTS to be in sync ---------------------------*/ double synchronize_video(VideoState *is, AVFrame *src_frame, double pts) { /*----------æ£€æŸ¥æ˜¾ç¤ºæ—¶é—´æˆ³----------*/ if (pts != 0) {//æ£€æŸ¥æ˜¾ç¤ºæ—¶é—´æˆ³æ˜¯å¦æœ‰æ•ˆ // If we have pts, set video clock to it. is->video_clock = pts;//ç”¨æ˜¾ç¤ºæ—¶é—´æˆ³æ›´æ–°å·²æ’­æ”¾æ—¶é—´ } else {//è‹¥è·å–ä¸åˆ°æ˜¾ç¤ºæ—¶é—´æˆ³ // If we aren't given a pts, set it to the clock. pts = is->video_clock;//ç”¨å·²æ’­æ”¾æ—¶é—´æ›´æ–°æ˜¾ç¤ºæ—¶é—´æˆ³ } /*--------æ›´æ–°è§†é¢‘å·²ç»æ’­æ—¶é—´--------*/ // Update the video clockï¼Œè‹¥è¯¥å¸§è¦é‡å¤æ˜¾ç¤º(å–å†³äºrepeat_pict)ï¼Œåˆ™å…¨å±€è§†é¢‘æ’­æ”¾æ—¶åºvideo_clockåº”åŠ ä¸Šé‡å¤æ˜¾ç¤ºçš„æ•°é‡*å¸§ç‡ double frame_delay = av_q2d(is->video_st->codec->time_base);//è¯¥å¸§æ˜¾ç¤ºå®Œå°†è¦èŠ±è´¹çš„æ—¶é—´ // If we are repeating a frame, adjust clock accordingly,è‹¥å­˜åœ¨é‡å¤å¸§ï¼Œåˆ™åœ¨æ­£å¸¸æ’­æ”¾çš„å‰åä¸¤å¸§å›¾åƒé—´å®‰æ’æ¸²æŸ“é‡å¤å¸§ frame_delay += src_frame->repeat_pict*(frame_delay*0.5);//è®¡ç®—æ¸²æŸ“é‡å¤å¸§çš„æ—¶å€¼(ç±»ä¼¼äºéŸ³ç¬¦æ—¶å€¼) is->video_clock += frame_delay;//æ›´æ–°è§†é¢‘æ’­æ”¾æ—¶é—´ // printf(\"repeat_pict=%d \\n\",src_frame->repeat_pict); return pts;//æ­¤æ—¶è¿”å›çš„å€¼å³ä¸ºä¸‹ä¸€å¸§å°†è¦å¼€å§‹æ˜¾ç¤ºçš„æ—¶é—´æˆ³ } // These are called whenever we allocate a frame buffer. We use this to store the global_pts in a frame at the time it is allocated. int our_get_buffer(struct AVCodecContext *c, AVFrame *pic, int flags) { int ret = avcodec_default_get_buffer2(c, pic, 0); uint64_t *pts = (uint64_t *)av_malloc(sizeof(uint64_t)); *pts = global_video_pkt_pts; pic->opaque = pts; return ret; } // è§†é¢‘è§£ç çº¿ç¨‹å‡½æ•° int decode_thread(void *arg) { VideoState *is = (VideoState *) arg;// ä¼ é€’ç”¨æˆ·æ•°æ® AVPacket pkt, *packet = &pkt;// åœ¨æ ˆä¸Šåˆ›å»ºä¸´æ—¶æ•°æ®åŒ…å¯¹è±¡å¹¶å…³è”æŒ‡é’ˆ int frameFinished;// è§£ç æ“ä½œæ˜¯å¦æˆåŠŸæ ‡è¯† // Allocate video frameï¼Œä¸ºè§£ç åçš„è§†é¢‘ä¿¡æ¯ç»“æ„ä½“åˆ†é…ç©ºé—´å¹¶å®Œæˆåˆå§‹åŒ–æ“ä½œ(ç»“æ„ä½“ä¸­çš„å›¾åƒç¼“å­˜æŒ‰ç…§ä¸‹é¢ä¸¤æ­¥æ‰‹åŠ¨å®‰è£…) AVFrame *pFrame = av_frame_alloc(); double pts;//å½“å‰æ¡¢åœ¨æ•´ä¸ªè§†é¢‘ä¸­çš„(ç»å¯¹)æ—¶é—´ä½ç½® for (;;) { if (packet_queue_get(&is->videoq,packet,1)data == flush_pkt.data) {//æ£€æŸ¥æ˜¯å¦éœ€è¦é‡æ–°è§£ç  avcodec_flush_buffers(is->video_st->codec);//é‡æ–°è§£ç å‰éœ€è¦é‡ç½®è§£ç å™¨ continue; } pts = 0;//(ç»å¯¹)æ˜¾ç¤ºæ—¶é—´æˆ³åˆå§‹åŒ– global_video_pkt_pts = packet->pts;// Save global pts to be stored in pFrame in first call. /*----------------------- * Decode video frameï¼Œè§£ç å®Œæ•´çš„ä¸€å¸§æ•°æ®ï¼Œå¹¶å°†frameFinishedè®¾ç½®ä¸ºtrue * å¯èƒ½æ— æ³•é€šè¿‡åªè§£ç ä¸€ä¸ªpacketå°±è·å¾—ä¸€ä¸ªå®Œæ•´çš„è§†é¢‘å¸§frameï¼Œå¯èƒ½éœ€è¦è¯»å–å¤šä¸ªpacketæ‰è¡Œ * avcodec_decode_video2()ä¼šåœ¨è§£ç åˆ°å®Œæ•´çš„ä¸€å¸§æ—¶è®¾ç½®frameFinishedä¸ºçœŸ * Technically a packet can contain partial frames or other bits of data * ffmpeg's parser ensures that the packets we get contain either complete or multiple frames * convert the packet to a frame for us and set frameFinisned for us when we have the next frame -----------------------*/ avcodec_decode_video2(is->video_st->codec, pFrame, &frameFinished, packet); //å–å¾—ç¼–ç æ•°æ®åŒ…ä¸­çš„æ˜¾ç¤ºæ—¶é—´æˆ³PTS(int64_t),å¹¶æš‚æ—¶ä¿å­˜åœ¨pts(double)ä¸­ // if (packet->dts==AV_NOPTS_VALUE && pFrame->opaque && *(uint64_t*)pFrame->opaque!=AV_NOPTS_VALUE) { // pts = *(uint64_t *)pFrame->opaque; // } else if (packet->dts != AV_NOPTS_VALUE) { // pts = packet->dts; // } else { // pts = 0; // } pts=av_frame_get_best_effort_timestamp(pFrame);//å–å¾—ç¼–ç æ•°æ®åŒ…ä¸­çš„å›¾åƒå¸§æ˜¾ç¤ºåºå·PTS(int64_t),å¹¶æš‚æ—¶ä¿å­˜åœ¨pts(double)ä¸­ /*------------------------- * åœ¨è§£ç çº¿ç¨‹å‡½æ•°ä¸­è®¡ç®—å½“å‰å›¾åƒå¸§çš„æ˜¾ç¤ºæ—¶é—´æˆ³ * 1ã€å–å¾—ç¼–ç æ•°æ®åŒ…ä¸­çš„å›¾åƒå¸§æ˜¾ç¤ºåºå·PTS(int64_t),å¹¶æš‚æ—¶ä¿å­˜åœ¨pts(double)ä¸­ * 2ã€æ ¹æ®PTS*time_baseæ¥è®¡ç®—å½“å‰æ¡¢åœ¨æ•´ä¸ªè§†é¢‘ä¸­çš„æ˜¾ç¤ºæ—¶é—´æˆ³ï¼Œå³PTS*(1/framerate) * av_q2dæŠŠAVRatioalç»“æ„è½¬æ¢æˆdoubleçš„å‡½æ•°ï¼Œ * ç”¨äºè®¡ç®—è§†é¢‘æºæ¯ä¸ªå›¾åƒå¸§æ˜¾ç¤ºçš„é—´éš”æ—¶é—´(1/framerate),å³è¿”å›(time_base->num/time_base->den) -------------------------*/ //æ ¹æ®pts=PTS*time_base={numerator=1,denominator=25}è®¡ç®—å½“å‰æ¡¢åœ¨æ•´ä¸ªè§†é¢‘ä¸­çš„æ˜¾ç¤ºæ—¶é—´æˆ³ pts*=av_q2d(is->video_st->time_base);//time_baseä¸ºAVRationalæœ‰ç†æ•°ç»“æ„ä½“{num=1,den=25}ï¼Œè®°å½•äº†è§†é¢‘æºæ¯ä¸ªå›¾åƒå¸§æ˜¾ç¤ºçš„é—´éš”æ—¶é—´ // Did we get a video frameï¼Œæ£€æŸ¥æ˜¯å¦è§£ç å‡ºå®Œæ•´ä¸€å¸§å›¾åƒ if (frameFinished) { pts = synchronize_video(is, pFrame, pts);//æ£€æŸ¥å½“å‰å¸§çš„æ˜¾ç¤ºæ—¶é—´æˆ³ptså¹¶æ›´æ–°å†…éƒ¨è§†é¢‘æ’­æ”¾è®¡æ—¶å™¨(è®°å½•è§†é¢‘å·²ç»æ’­æ—¶é—´(video_clock)ï¼‰ if (queue_picture(is, pFrame, pts)sws_ctx_audio, \"in_channel_layout\", src_ch_layout, 0); av_opt_set_int(is->sws_ctx_audio, \"out_channel_layout\", dst_ch_layout, 0); av_opt_set_int(is->sws_ctx_audio, \"in_sample_rate\", src_rate, 0); av_opt_set_int(is->sws_ctx_audio, \"out_sample_rate\", dst_rate, 0); av_opt_set_sample_fmt(is->sws_ctx_audio, \"in_sample_fmt\", src_sample_fmt, 0); av_opt_set_sample_fmt(is->sws_ctx_audio, \"out_sample_fmt\", dst_sample_fmt, 0); int ret;//è¿”å›ç»“æœ // Initialize the resampling context. if ((ret = swr_init((struct SwrContext *) is->sws_ctx_audio)) sws_ctx_audio,src_rate)+src_nb_samples,dst_rate,src_rate,AV_ROUND_UP); //Convert to destination format. ret=swr_convert((struct SwrContext*)is->sws_ctx_audio,dst_data,dst_nb_samples,(const uint8_t **)decoded_frame.data,src_nb_samples); if (retaudio_buf, dst_data[0], dst_bufsize); if (src_data) { av_freep(&src_data[0]); } av_freep(&src_data); if (dst_data) { av_freep(&dst_data[0]); } av_freep(&dst_data); return dst_bufsize; } // éŸ³é¢‘è§£ç å‡½æ•°ï¼Œä»ç¼“å­˜é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ã€è§£ç ï¼Œå¹¶è¿”å›è§£ç åçš„æ•°æ®é•¿åº¦(å¯¹ä¸€ä¸ªå®Œæ•´çš„packetè§£ç ï¼Œå°†è§£ç æ•°æ®å†™å…¥audio_bufç¼“å­˜ï¼Œå¹¶è¿”å›å¤šå¸§è§£ç æ•°æ®çš„æ€»é•¿åº¦) int audio_decode_frame(VideoState *is, double *pts_ptr) { int coded_consumed_size,data_size=0,pcm_bytes;// æ¯æ¬¡æ¶ˆè€—çš„ç¼–ç æ•°æ®é•¿åº¦[input](len1)ï¼Œè¾“å‡ºåŸå§‹éŸ³é¢‘æ•°æ®çš„ç¼“å­˜é•¿åº¦[output]ï¼Œæ¯ç»„éŸ³é¢‘é‡‡æ ·æ•°æ®çš„å­—èŠ‚æ•° AVPacket *pkt = &is->audio_pkt;// ä¿å­˜ä»é˜Ÿåˆ—ä¸­æå–çš„æ•°æ®åŒ… double pts;//éŸ³é¢‘æ’­æ”¾æ—¶é—´æˆ³ for (;;) { while (is->audio_pkt_size>0) {// æ£€æŸ¥ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦(æ˜¯å¦å·²å®Œæˆä¸€ä¸ªå®Œæ•´çš„pakcetåŒ…çš„è§£ç ï¼Œä¸€ä¸ªæ•°æ®åŒ…ä¸­å¯èƒ½åŒ…å«å¤šä¸ªéŸ³é¢‘ç¼–ç å¸§) int got_frame = 0;// è§£ç æ“ä½œæˆåŠŸæ ‡è¯†ï¼ŒæˆåŠŸè¿”å›éé›¶å€¼ // è§£ç ä¸€å¸§éŸ³é¢‘æ•°æ®ï¼Œå¹¶è¿”å›æ¶ˆè€—çš„ç¼–ç æ•°æ®é•¿åº¦ coded_consumed_size = avcodec_decode_audio4(is->audio_st->codec, &is->audio_frame, &got_frame, pkt); if (coded_consumed_size audio_pkt_size = 0;// æ›´æ–°ç¼–ç æ•°æ®ç¼“å­˜é•¿åº¦ break; } if (got_frame) {// æ£€æŸ¥è§£ç æ“ä½œæ˜¯å¦æˆåŠŸ if (is->audio_frame.format != AV_SAMPLE_FMT_S16) {//æ£€æŸ¥éŸ³é¢‘æ•°æ®æ ¼å¼æ˜¯å¦ä¸º16ä½é‡‡æ ·æ ¼å¼ //å½“éŸ³é¢‘æ•°æ®ä¸ä¸º16ä½é‡‡æ ·æ ¼å¼æƒ…å†µä¸‹ï¼Œé‡‡ç”¨decode_frame_from_packetè®¡ç®—è§£ç æ•°æ®é•¿åº¦ data_size=decode_frame_from_packet(is, is->audio_frame); } else {//è®¡ç®—è§£ç åéŸ³é¢‘æ•°æ®é•¿åº¦[output] data_size=av_samples_get_buffer_size(NULL,is->audio_st->codec->channels,is->audio_frame.nb_samples,is->audio_st->codec->sample_fmt, 1); memcpy(is->audio_buf,is->audio_frame.data[0],data_size);//å°†è§£ç æ•°æ®å¤åˆ¶åˆ°è¾“å‡ºç¼“å­˜ } } is->audio_pkt_data += coded_consumed_size;// æ›´æ–°ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆä½ç½® is->audio_pkt_size -= coded_consumed_size;// æ›´æ–°ç¼“å­˜ä¸­å‰©ä½™çš„ç¼–ç æ•°æ®é•¿åº¦ if (data_size audio_clock;//ç”¨æ¯æ¬¡æ›´æ–°çš„éŸ³é¢‘æ’­æ”¾æ—¶é—´æ›´æ–°éŸ³é¢‘PTS *pts_ptr=pts; /*--------------------- * å½“ä¸€ä¸ªpacketä¸­åŒ…å«å¤šä¸ªéŸ³é¢‘å¸§æ—¶ * é€šè¿‡[è§£ç åéŸ³é¢‘åŸå§‹æ•°æ®é•¿åº¦]åŠ[é‡‡æ ·ç‡]æ¥æ¨ç®—ä¸€ä¸ªpacketä¸­å…¶ä»–éŸ³é¢‘å¸§çš„æ’­æ”¾æ—¶é—´æˆ³pts * é‡‡æ ·é¢‘ç‡44.1kHzï¼Œé‡åŒ–ä½æ•°16ä½ï¼Œæ„å‘³ç€æ¯ç§’é‡‡é›†æ•°æ®44.1kä¸ªï¼Œæ¯ä¸ªæ•°æ®å 2å­—èŠ‚ --------------------*/ pcm_bytes=2*is->audio_st->codec->channels;//è®¡ç®—æ¯ç»„éŸ³é¢‘é‡‡æ ·æ•°æ®çš„å­—èŠ‚æ•°=æ¯ä¸ªå£°é“éŸ³é¢‘é‡‡æ ·å­—èŠ‚æ•°*å£°é“æ•° /*----æ›´æ–°audio_clock--- * ä¸€ä¸ªpktåŒ…å«å¤šä¸ªéŸ³é¢‘frameï¼ŒåŒæ—¶ä¸€ä¸ªpktå¯¹åº”ä¸€ä¸ªpts(pkt->pts) * å› æ­¤ï¼Œè¯¥pktä¸­åŒ…å«çš„å¤šä¸ªéŸ³é¢‘å¸§çš„æ—¶é—´æˆ³ç”±ä»¥ä¸‹å…¬å¼æ¨æ–­å¾—å‡º * bytes_per_sec=pcm_bytes*is->audio_st->codec->sample_rate * ä»pktä¸­ä¸æ–­çš„è§£ç ï¼Œæ¨æ–­(ä¸€ä¸ªpktä¸­)æ¯å¸§æ•°æ®çš„ptså¹¶ç´¯åŠ åˆ°éŸ³é¢‘æ’­æ”¾æ—¶é’Ÿ --------------------*/ is->audio_clock+=(double)data_size/(double)(pcm_bytes*is->audio_st->codec->sample_rate); // We have data, return it and come back for more later. return data_size;// è¿”å›è§£ç æ•°æ®ç¼“å­˜é•¿åº¦ } if (pkt->data) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦å·²ä»é˜Ÿåˆ—ä¸­æå– av_packet_unref(pkt);// é‡Šæ”¾pktä¸­ä¿å­˜çš„ç¼–ç æ•°æ® } if (is->quit) {// æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† return -1; } // Next packetï¼Œä»é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…åˆ°pkt if (packet_queue_get(&is->audioq, pkt, 1) data == flush_pkt.data) {//æ£€æŸ¥æ˜¯å¦éœ€è¦é‡æ–°è§£ç  avcodec_flush_buffers(is->audio_st->codec);//é‡æ–°è§£ç å‰éœ€è¦é‡ç½®è§£ç å™¨ continue; } is->audio_pkt_data = pkt->data;// ä¼ é€’ç¼–ç æ•°æ®ç¼“å­˜æŒ‡é’ˆ is->audio_pkt_size = pkt->size;// ä¼ é€’ç¼–ç æ•°æ®ç¼“å­˜é•¿åº¦ // If update, update the audio clock w/pts if (pkt->pts != AV_NOPTS_VALUE) {//æ£€æŸ¥éŸ³é¢‘æ’­æ”¾æ—¶é—´æˆ³ //è·å¾—ä¸€ä¸ªæ–°çš„packetçš„æ—¶å€™ï¼Œæ›´æ–°audio_clockï¼Œç”¨packetä¸­çš„ptsæ›´æ–°audio_clock(ä¸€ä¸ªpktå¯¹åº”ä¸€ä¸ªpts) is->audio_clock=pkt->pts*av_q2d(is->audio_st->time_base);//æ›´æ–°éŸ³é¢‘å·²ç»æ’­çš„æ—¶é—´ } } } /*------Audio Callback------- * éŸ³é¢‘è¾“å‡ºå›è°ƒå‡½æ•°ï¼Œsdlé€šè¿‡è¯¥å›è°ƒå‡½æ•°å°†è§£ç åçš„pcmæ•°æ®é€å…¥å£°å¡æ’­æ”¾, * sdlé€šå¸¸ä¸€æ¬¡ä¼šå‡†å¤‡ä¸€ç»„ç¼“å­˜pcmæ•°æ®ï¼Œé€šè¿‡è¯¥å›è°ƒé€å…¥å£°å¡ï¼Œå£°å¡æ ¹æ®éŸ³é¢‘ptsä¾æ¬¡æ’­æ”¾pcmæ•°æ® * å¾…é€å…¥ç¼“å­˜çš„pcmæ•°æ®å®Œæˆæ’­æ”¾åï¼Œå†è½½å…¥ä¸€ç»„æ–°çš„pcmç¼“å­˜æ•°æ®(æ¯æ¬¡éŸ³é¢‘è¾“å‡ºç¼“å­˜ä¸ºç©ºæ—¶ï¼Œsdlå°±è°ƒç”¨æ­¤å‡½æ•°å¡«å……éŸ³é¢‘è¾“å‡ºç¼“å­˜ï¼Œå¹¶é€å…¥å£°å¡æ’­æ”¾) * When we begin playing audio, SDL will continually call this callback function * and ask it to fill the audio buffer with a certain number of bytes * The audio function callback takes the following parameters: * stream: A pointer to the audio buffer to be filledï¼Œè¾“å‡ºéŸ³é¢‘æ•°æ®åˆ°å£°å¡ç¼“å­˜ * len: The length (in bytes) of the audio buffer,ç¼“å­˜é•¿åº¦wanted_spec.samples=SDL_AUDIO_BUFFER_SIZE(1024) --------------------------*/ void audio_callback(void *userdata, Uint8 *stream, int len) { VideoState *is = (VideoState *) userdata;// ä¼ é€’ç”¨æˆ·æ•°æ® int wt_stream_len, audio_size;// æ¯æ¬¡å†™å…¥streamçš„æ•°æ®é•¿åº¦ï¼Œè§£ç åçš„æ•°æ®é•¿åº¦ double pts;//éŸ³é¢‘æ—¶é—´æˆ³ while (len > 0) {//æ£€æŸ¥éŸ³é¢‘ç¼“å­˜çš„å‰©ä½™é•¿åº¦ if (is->audio_buf_index >= is->audio_buf_size) {// æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰§è¡Œè§£ç æ“ä½œ // We have already sent all our data; get moreï¼Œä»ç¼“å­˜é˜Ÿåˆ—ä¸­æå–æ•°æ®åŒ…ã€è§£ç ï¼Œå¹¶è¿”å›è§£ç åçš„æ•°æ®é•¿åº¦ï¼Œaudio_bufç¼“å­˜ä¸­å¯èƒ½åŒ…å«å¤šå¸§è§£ç åçš„éŸ³é¢‘æ•°æ® audio_size = audio_decode_frame(is, &pts); if (audio_size audio_buf_size = 1024; memset(is->audio_buf, 0, is->audio_buf_size);// å…¨é›¶é‡ç½®ç¼“å†²åŒº } else { //åœ¨å›è°ƒå‡½æ•°ä¸­å¢åŠ éŸ³é¢‘åŒæ­¥è¿‡ç¨‹ï¼Œå³å¯¹éŸ³é¢‘æ•°æ®ç¼“å­˜è¿›è¡Œä¸¢å¸§(æˆ–æ’å€¼)ï¼Œä»¥èµ·åˆ°é™ä½éŸ³é¢‘æ—¶é’Ÿä¸ä¸»åŒæ­¥æºæ—¶å·®çš„ç›®çš„ audio_size=synchronize_audio(is,(int16_t*)is->audio_buf,audio_size,pts);//è¿”å›éŸ³é¢‘åŒæ­¥åçš„ç¼“å­˜é•¿åº¦ is->audio_buf_size = audio_size;// è¿”å›packetä¸­åŒ…å«çš„åŸå§‹éŸ³é¢‘æ•°æ®é•¿åº¦(å¤šå¸§) } is->audio_buf_index = 0;// åˆå§‹åŒ–ç´¯è®¡å†™å…¥ç¼“å­˜é•¿åº¦ }//end for if wt_stream_len=is->audio_buf_size-is->audio_buf_index;// è®¡ç®—è§£ç ç¼“å­˜å‰©ä½™é•¿åº¦ if (wt_stream_len > len) {// æ£€æŸ¥æ¯æ¬¡å†™å…¥ç¼“å­˜çš„æ•°æ®é•¿åº¦æ˜¯å¦è¶…è¿‡æŒ‡å®šé•¿åº¦(1024) wt_stream_len = len;// æŒ‡å®šé•¿åº¦ä»è§£ç çš„ç¼“å­˜ä¸­å–æ•°æ® } // æ¯æ¬¡ä»è§£ç çš„ç¼“å­˜æ•°æ®ä¸­ä»¥æŒ‡å®šé•¿åº¦æŠ½å–æ•°æ®å¹¶å†™å…¥streamä¼ é€’ç»™å£°å¡ memcpy(stream, (uint8_t *)is->audio_buf + is->audio_buf_index, wt_stream_len); len -= wt_stream_len;// æ›´æ–°è§£ç éŸ³é¢‘ç¼“å­˜çš„å‰©ä½™é•¿åº¦ stream += wt_stream_len;// æ›´æ–°ç¼“å­˜å†™å…¥ä½ç½® is->audio_buf_index += wt_stream_len;// æ›´æ–°ç´¯è®¡å†™å…¥ç¼“å­˜æ•°æ®é•¿åº¦ }//end for while } // æ ¹æ®æŒ‡å®šç±»å‹æ‰“å¼€æµï¼Œæ‰¾åˆ°å¯¹åº”çš„è§£ç å™¨ã€åˆ›å»ºå¯¹åº”çš„éŸ³é¢‘é…ç½®ã€ä¿å­˜å…³é”®ä¿¡æ¯åˆ° VideoStateã€å¯åŠ¨éŸ³é¢‘å’Œè§†é¢‘çº¿ç¨‹ int stream_component_open(VideoState *is, int stream_index) { AVFormatContext *pFormatCtx = is->pFormatCtx;// ä¼ é€’æ–‡ä»¶å®¹å™¨çš„å°è£…ä¿¡æ¯åŠç æµå‚æ•° AVCodecContext *codecCtx = NULL;// è§£ç å™¨ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œè§£ç å™¨ä¾èµ–çš„ç›¸å…³ç¯å¢ƒã€çŠ¶æ€ã€èµ„æºä»¥åŠå‚æ•°é›†çš„æ¥å£æŒ‡é’ˆ AVCodec *codec = NULL;// ä¿å­˜ç¼–è§£ç å™¨ä¿¡æ¯çš„ç»“æ„ä½“ï¼Œæä¾›ç¼–ç ä¸è§£ç çš„å…¬å…±æ¥å£ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ç¼–ç å™¨ä¸è§£ç å™¨çš„ä¸€ä¸ªå…¨å±€å˜é‡ //æ£€æŸ¥è¾“å…¥çš„æµç±»å‹æ˜¯å¦åœ¨åˆç†èŒƒå›´å†… if (stream_index = pFormatCtx->nb_streams) { return -1; } // Get a pointer to the codec context for the video stream. codecCtx = pFormatCtx->streams[stream_index]->codec;// å–å¾—è§£ç å™¨ä¸Šä¸‹æ–‡ if (codecCtx->codec_type == AVMEDIA_TYPE_AUDIO) {//æ£€æŸ¥è§£ç å™¨ç±»å‹æ˜¯å¦ä¸ºéŸ³é¢‘è§£ç å™¨ SDL_AudioSpec wanted_spec, spec;//SDL_AudioSpec a structure that contains the audio output formatï¼Œåˆ›å»º SDL_AudioSpec ç»“æ„ä½“ï¼Œè®¾ç½®éŸ³é¢‘æ’­æ”¾æ•°æ® // Set audio settings from codec info,SDL_AudioSpec a structure that contains the audio output format // åˆ›å»ºSDL_AudioSpecç»“æ„ä½“ï¼Œè®¾ç½®éŸ³é¢‘æ’­æ”¾å‚æ•° wanted_spec.freq = codecCtx->sample_rate;//é‡‡æ ·é¢‘ç‡ DSP frequency -- samples per second wanted_spec.format = AUDIO_S16SYS;//é‡‡æ ·æ ¼å¼ Audio data format wanted_spec.channels = codecCtx->channels;//å£°é“æ•° Number of channels: 1 mono, 2 stereo wanted_spec.silence = 0;//æ— è¾“å‡ºæ—¶æ˜¯å¦é™éŸ³ //é»˜è®¤æ¯æ¬¡è¯»éŸ³é¢‘ç¼“å­˜çš„å¤§å°ï¼Œæ¨èå€¼ä¸º 512~8192ï¼Œffplayä½¿ç”¨çš„æ˜¯1024 specifies a unit of audio data refers to the size of the audio buffer in sample frames wanted_spec.samples = SDL_AUDIO_BUFFER_SIZE; wanted_spec.callback = audio_callback;//è®¾ç½®è¯»å–éŸ³é¢‘æ•°æ®çš„å›è°ƒæ¥å£å‡½æ•° the function to call when the audio device needs more data wanted_spec.userdata = is;//ä¼ é€’ç”¨æˆ·æ•°æ® /*--------------------------- * ä»¥æŒ‡å®šå‚æ•°æ‰“å¼€éŸ³é¢‘è®¾å¤‡ï¼Œå¹¶è¿”å›ä¸æŒ‡å®šå‚æ•°æœ€ä¸ºæ¥è¿‘çš„å‚æ•°ï¼Œè¯¥å‚æ•°ä¸ºè®¾å¤‡å®é™…æ”¯æŒçš„éŸ³é¢‘å‚æ•° * Opens the audio device with the desired parameters(wanted_spec) * return another specs we actually be using * and not guaranteed to get what we asked for --------------------------*/ if (SDL_OpenAudio(&wanted_spec, &spec) audio_hw_buf_size = spec.size; } /*----------------------- * Find the decoder for the video streamï¼Œæ ¹æ®è§†é¢‘æµå¯¹åº”çš„è§£ç å™¨ä¸Šä¸‹æ–‡æŸ¥æ‰¾å¯¹åº”çš„è§£ç å™¨ï¼Œè¿”å›å¯¹åº”çš„è§£ç å™¨(ä¿¡æ¯ç»“æ„ä½“) * The stream's information about the codec is in what we call the \"codec context. * This contains all the information about the codec that the stream is using -----------------------*/ codec = avcodec_find_decoder(codecCtx->codec_id); AVDictionary *optionsDict = NULL; if (!codec || (avcodec_open2(codecCtx, codec, &optionsDict) name); // æ£€æŸ¥è§£ç å™¨ç±»å‹ switch(codecCtx->codec_type) { case AVMEDIA_TYPE_AUDIO:// éŸ³é¢‘è§£ç å™¨ is->audioStream = stream_index;// éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ– is->audio_st = pFormatCtx->streams[stream_index]; is->audio_buf_size = 0;// è§£ç åçš„å¤šå¸§éŸ³é¢‘æ•°æ®é•¿åº¦ is->audio_buf_index = 0;//ç´¯ è®¡å†™å…¥streamçš„é•¿åº¦ // Averaging filter for audio sync. is->audio_diff_avg_coef=exp(log(0.01/AUDIO_DIFF_AVG_NB));//éŸ³é¢‘æ—¶é’Ÿä¸ä¸»åŒæ­¥æºç´¯è®¡æ—¶å·®åŠ æƒç³»æ•° is->audio_diff_avg_count=0;//éŸ³é¢‘ä¸åŒæ­¥è®¡æ•°åˆå§‹åŒ– // Correct audio only if larger error than this. is->audio_diff_threshold=2.0*SDL_AUDIO_BUFFER_SIZE/codecCtx->sample_rate; is->sws_ctx_audio = (struct SwsContext *) swr_alloc(); if (!is->sws_ctx_audio) { fprintf(stderr, \"Could not allocate resampler context\\n\"); return -1; } memset(&is->audio_pkt, 0, sizeof(is->audio_pkt)); packet_queue_init(&is->audioq);// éŸ³é¢‘æ•°æ®åŒ…é˜Ÿåˆ—åˆå§‹åŒ– SDL_PauseAudio(0);// audio callback starts running againï¼Œå¼€å¯éŸ³é¢‘è®¾å¤‡ï¼Œå¦‚æœè¿™æ—¶å€™æ²¡æœ‰è·å¾—æ•°æ®é‚£ä¹ˆå®ƒå°±é™éŸ³ break; case AVMEDIA_TYPE_VIDEO:// è§†é¢‘è§£ç å™¨ is->videoStream = stream_index;// è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ– is->video_st = pFormatCtx->streams[stream_index]; //ä»¥ç³»ç»Ÿæ—¶é—´ä¸ºåŸºå‡†ï¼Œåˆå§‹åŒ–æ’­æ”¾åˆ°å½“å‰å¸§çš„å·²æ’­æ”¾æ—¶é—´å€¼ï¼Œè¯¥å€¼ä¸ºçœŸå®æ—¶é—´å€¼ã€åŠ¨æ€æ—¶é—´å€¼ã€ç»å¯¹æ—¶é—´å€¼ is->frame_timer=(double)av_gettime()/1000000.0; is->frame_last_delay = 40e-3;//åˆå§‹åŒ–ä¸Šä¸€å¸§å›¾åƒçš„åŠ¨æ€åˆ·æ–°å»¶è¿Ÿæ—¶é—´ is->video_current_pts_time = av_gettime();//å–å¾—ç³»ç»Ÿå½“å‰æ—¶é—´ packet_queue_init(&is->videoq);// è§†é¢‘æ•°æ®åŒ…é˜Ÿåˆ—åˆå§‹åŒ– is->decode_tid = SDL_CreateThread(decode_thread,\"è§†é¢‘è§£ç çº¿ç¨‹\" ,is);// åˆ›å»ºè§†é¢‘è§£ç çº¿ç¨‹ // Initialize SWS context for software scalingï¼Œè®¾ç½®å›¾åƒè½¬æ¢åƒç´ æ ¼å¼ä¸ºAV_PIX_FMT_YUV420P is->sws_ctx = sws_getContext(is->video_st->codec->width, is->video_st->codec->height, is->video_st->codec->pix_fmt, is->video_st->codec->width, is->video_st->codec->height, AV_PIX_FMT_YUV420P, SWS_BILINEAR, NULL, NULL, NULL); codecCtx->get_buffer2 = our_get_buffer; break; default: break; } return 0; } //æ¸…é™¤é˜Ÿåˆ—ç¼“å­˜ï¼Œé‡Šæ”¾é˜Ÿåˆ—ä¸­æ‰€æœ‰åŠ¨æ€åˆ†é…çš„å†…å­˜ static void packet_queue_flush(PacketQueue *q) { AVPacketList *pkt, *pkttmp;//é˜Ÿåˆ—å½“å‰èŠ‚ç‚¹ï¼Œä¸´æ—¶èŠ‚ç‚¹ SDL_LockMutex(q->qlock);//é”å®šäº’æ–¥é‡ for (pkt = q->first_pkt; pkt != NULL; pkt = pkttmp) {//éå†é˜Ÿåˆ—æ‰€æœ‰èŠ‚ç‚¹ pkttmp = pkt->next;//é˜Ÿåˆ—å¤´èŠ‚ç‚¹åç§» av_packet_unref(&pkt->pkt);//å½“å‰èŠ‚ç‚¹å¼•ç”¨è®¡æ•°-1 av_freep(&pkt);//é‡Šæ”¾å½“å‰èŠ‚ç‚¹ç¼“å­˜ } q->last_pkt = NULL;//é˜Ÿåˆ—å°¾èŠ‚ç‚¹æŒ‡é’ˆç½®é›¶ q->first_pkt = NULL;//é˜Ÿåˆ—å¤´èŠ‚ç‚¹æŒ‡é’ˆç½®é›¶ q->nb_packets = 0;//é˜Ÿåˆ—é•¿åº¦ç½®é›¶ q->size = 0;//é˜Ÿåˆ—ç¼–ç æ•°æ®çš„ç¼“å­˜é•¿åº¦ç½®é›¶ SDL_UnlockMutex(q->qlock);//äº’æ–¥é‡è§£é” } // ç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹å‡½æ•°(ä»è§†é¢‘æ–‡ä»¶ä¸­è§£æå‡ºéŸ³è§†é¢‘ç¼–ç æ•°æ®å•å…ƒï¼Œä¸€ä¸ªAVPacketçš„dataé€šå¸¸å¯¹åº”ä¸€ä¸ªNAL) int parse_thread(void *arg) { VideoState *is = (VideoState *)arg;// ä¼ é€’ç”¨æˆ·å‚æ•° global_video_state = is;// ä¼ é€’å…¨å±€çŠ¶æ€å‚é‡ç»“æ„ä½“ /*------------------------- * æ‰“å¼€å°è£…æ ¼å¼ * æ‰“å¼€è§†é¢‘æ–‡ä»¶ï¼Œè¯»æ–‡ä»¶å¤´å†…å®¹ï¼Œå–å¾—æ–‡ä»¶å®¹å™¨çš„å°è£…ä¿¡æ¯åŠç æµå‚æ•°å¹¶å­˜å‚¨åœ¨avformat_contextä¸­ * å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ * å‚æ•°äºŒï¼šè§†é¢‘è·¯å¾„ * å‚æ•°ä¸‰ï¼šæŒ‡å®šè¾“å…¥çš„æ ¼å¼ * å‚æ•°å››ï¼šè®¾ç½®é»˜è®¤å‚æ•° --------------------------*/ AVFormatContext *avformat_context = NULL;// å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ int avformat_open_input_result = avformat_open_input(&avformat_context, is->filename, NULL, NULL); if (avformat_open_input_result != 0){ // __android_log_print(ANDROID_LOG_INFO, \"main\", \"æŸ¥æ‰¾éŸ³è§†é¢‘æµ\\n\"); return -1; } is->pFormatCtx = avformat_context;//ä¼ é€’æ–‡ä»¶å®¹å™¨å°è£…ä¿¡æ¯åŠç æµå‚æ•° /*------------------------- * æŸ¥æ‰¾ç æµ * å–å¾—æ–‡ä»¶ä¸­ä¿å­˜çš„ç æµä¿¡æ¯ï¼Œå¹¶å¡«å……åˆ°avformat_context->stream å­—æ®µ * å‚æ•°ä¸€ï¼šå°è£…æ ¼å¼ä¸Šä¸‹æ–‡ * å‚æ•°äºŒï¼šæŒ‡å®šé»˜è®¤é…ç½® -------------------------*/ int avformat_find_stream_info_result = avformat_find_stream_info(avformat_context, NULL); if (avformat_find_stream_info_result videoStream = -1;//è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 is->audioStream = -1;//éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 // è§†é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 int av_video_stream_index = -1; // éŸ³é¢‘æµç±»å‹æ ‡å·åˆå§‹åŒ–ä¸º-1 int av_audio_stream_index = -1; for (int i = 0; i nb_streams; ++i) { // è‹¥æ–‡ä»¶ä¸­åŒ…å«æœ‰è§†é¢‘æµ if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_VIDEO){ av_video_stream_index = i; } // è‹¥æ–‡ä»¶ä¸­åŒ…å«æœ‰éŸ³é¢‘æµ if (avformat_context->streams[i]->codec->codec_type == AVMEDIA_TYPE_AUDIO){ av_audio_stream_index = i; } } // æ£€æŸ¥æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨è§†é¢‘æµ if (av_video_stream_index == -1) { // __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ²¡æœ‰æ‰¾åˆ°è§†é¢‘æµ\\n\"); goto fail;//è·³è½¬è‡³å¼‚å¸¸å¤„ç† return -1; } // æ£€æŸ¥æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨éŸ³é¢‘æµ if (av_audio_stream_index == -1) { // __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ²¡æœ‰æ‰¾åˆ°éŸ³é¢‘æµ\\n\"); goto fail;//è·³è½¬è‡³å¼‚å¸¸å¤„ç† return -1; } stream_component_open(is, av_audio_stream_index);// æ ¹æ®æŒ‡å®šç±»å‹æ‰“å¼€éŸ³é¢‘æµ stream_component_open(is, av_video_stream_index);// æ ¹æ®æŒ‡å®šç±»å‹æ‰“å¼€è§†é¢‘æµ // Main decode loop. for (;;) { if (is->quit) {//æ£€æŸ¥é€€å‡ºè¿›ç¨‹æ ‡è¯† break; } // Seek stuff goes here if (is->seek_req) {//æ£€æŸ¥[å¿«è¿›]/[å¿«é€€]æ“ä½œæ ‡å¿—ä½æ˜¯å¦å¼€å¯ int stream_index= -1;//åˆå§‹åŒ–éŸ³è§†é¢‘æµç±»å‹æ ‡å· int64_t seek_target = is->seek_pos;//å–å¾—[å¿«è¿›]/[å¿«é€€]æ“ä½œåçš„å‚è€ƒæ—¶é—´æˆ³ if (is->videoStream >= 0) {//æ£€æŸ¥æ˜¯å¦å–å¾—è§†é¢‘æµç±»å‹æ ‡å· stream_index = is->videoStream;//å–å¾—è§†é¢‘æµç±»å‹æ ‡å· } else if (is->audioStream >= 0) {//æ£€æŸ¥æ˜¯å¦å–å¾—éŸ³é¢‘æµç±»å‹æ ‡å· stream_index = is->audioStream;//å–å¾—éŸ³é¢‘æµç±»å‹æ ‡å· } if (stream_index >= 0){//æ£€æŸ¥æ˜¯å¦å–å¾—éŸ³è§†é¢‘æµç±»å‹æ ‡å· //æ—¶é—´å•ä½è½¬æ¢ï¼Œå°†seek_targetçš„å•ä½ç”±AV_TIME_BASE_Qè½¬æ¢ä¸ºtime_base seek_target= av_rescale_q(seek_target, AV_TIME_BASE_Q, avformat_context->streams[stream_index]->time_base); } //æ ¹æ®[å¿«è¿›]/[å¿«é€€]æ“ä½œåçš„æ—¶é—´æˆ³ï¼Œè·³åˆ°æŒ‡å®šå¸§(è¯¥å‡½æ•°åªèƒ½è·³åˆ°ç¦»æŒ‡å®šå¸§æœ€è¿‘çš„å…³é”®å¸§) if (av_seek_frame(is->pFormatCtx, stream_index, seek_target, is->seek_flags) pFormatCtx->filename); } else {//åœ¨æ‰§è¡Œ[å¿«è¿›]/[å¿«é€€]æ“ä½œåï¼Œç«‹åˆ»æ¸…ç©ºç¼“å­˜é˜Ÿåˆ—ï¼Œå¹¶é‡ç½®éŸ³è§†é¢‘è§£ç å™¨ if (is->audioStream >= 0) {//æ£€æŸ¥æ˜¯å¦å–å¾—éŸ³é¢‘æµç±»å‹æ ‡å· packet_queue_flush(&is->audioq);//æ¸…é™¤éŸ³é¢‘é˜Ÿåˆ—ç¼“å­˜ï¼Œé‡Šæ”¾é˜Ÿåˆ—ä¸­æ‰€æœ‰åŠ¨æ€åˆ†é…çš„å†…å­˜ packet_queue_put(&is->audioq, &flush_pkt);//å°†flush_pktæ’å…¥éŸ³é¢‘æ•°æ®åŒ…é˜Ÿåˆ—ï¼Œæ‰§è¡Œé‡ç½®éŸ³é¢‘è§£ç å™¨æ“ä½œavcodec_flush_buffers } if (is->videoStream >= 0) {//å–å¾—è§†é¢‘æµç±»å‹æ ‡å· packet_queue_flush(&is->videoq);//æ¸…é™¤è§†é¢‘é˜Ÿåˆ—ç¼“å­˜ï¼Œé‡Šæ”¾é˜Ÿåˆ—ä¸­æ‰€æœ‰åŠ¨æ€åˆ†é…çš„å†…å­˜ packet_queue_put(&is->videoq, &flush_pkt);//å°†flush_pktæ’å…¥è§†é¢‘æ•°æ®åŒ…é˜Ÿåˆ—ï¼Œæ‰§è¡Œé‡ç½®è§†é¢‘è§£ç å™¨æ“ä½œavcodec_flush_buffers } } is->seek_req = 0;//å…³é—­[å¿«è¿›]/[å¿«é€€]æ“ä½œæ ‡å¿—ä½ }//end for if (is->seek_req) // Seek stuff goes hereï¼Œæ£€æŸ¥éŸ³è§†é¢‘ç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—é•¿åº¦æ˜¯å¦æº¢å‡º if (is->audioq.size > MAX_AUDIOQ_SIZE || is->videoq.size > MAX_VIDEOQ_SIZE) { SDL_Delay(10); continue; } /*----------------------- * read in a packet and store it in the AVPacket struct * ffmpeg allocates the internal data for us,which is pointed to by packet.data * this is freed by the av_free_packet() -----------------------*/ // è´Ÿè´£ä¿å­˜å‹ç¼©ç¼–ç æ•°æ®ç›¸å…³ä¿¡æ¯çš„ç»“æ„ä½“,æ¯å¸§å›¾åƒç”±ä¸€åˆ°å¤šä¸ªpacketåŒ…ç»„æˆ AVPacket pkt, *packet = &pkt;// åœ¨æ ˆä¸Šåˆ›å»ºä¸´æ—¶æ•°æ®åŒ…å¯¹è±¡å¹¶å…³è”æŒ‡é’ˆ if (av_read_frame(is->pFormatCtx, packet) pFormatCtx->pb->error == 0) { SDL_Delay(100); // No error; wait for user input. continue; } else { break; } } // Is this a packet from the video stream? if (packet->stream_index == is->videoStream) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºè§†é¢‘ç±»å‹ packet_queue_put(&is->videoq, packet);// å‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… } else if (packet->stream_index == is->audioStream) {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºéŸ³é¢‘ç±»å‹ packet_queue_put(&is->audioq, packet);// å‘é˜Ÿåˆ—ä¸­æ’å…¥æ•°æ®åŒ… } else {// æ£€æŸ¥æ•°æ®åŒ…æ˜¯å¦ä¸ºå­—å¹•ç±»å‹ av_packet_unref(packet);// é‡Šæ”¾packetä¸­ä¿å­˜çš„(å­—å¹•)ç¼–ç æ•°æ® } } // All done - wait for it. while (!is->quit) { SDL_Delay(100); } fail:// å¼‚å¸¸å¤„ç† if (1) { SDL_Event event;// SDLäº‹ä»¶å¯¹è±¡ event.type = FF_QUIT_EVENT;// æŒ‡å®šé€€å‡ºäº‹ä»¶ç±»å‹ event.user.data1 = is;// ä¼ é€’ç”¨æˆ·æ•°æ® SDL_PushEvent(&event);// å°†è¯¥äº‹ä»¶å¯¹è±¡å‹å…¥SDLåå°äº‹ä»¶é˜Ÿåˆ— } return 0; } int init_sdl(VideoState *is) { // åˆå§‹åŒ–SDLå¤šåª’ä½“æ¡†æ¶ if (SDL_Init( SDL_INIT_VIDEO | SDL_INIT_AUDIO | SDL_INIT_TIMER ) == -1) { // __android_log_print(ANDROID_LOG_INFO, \"main\", \"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"åˆå§‹åŒ–å¤±è´¥ï¼š%s\", SDL_GetError()); return -1; } // SDLä¸­è·å–å±å¹•å°ºå¯¸ SDL_DisplayMode DM; SDL_GetCurrentDisplayMode(0, &DM); // åˆå§‹åŒ–SDLçª—å£ SDL_Window* sdl_window = SDL_CreateWindow(\"FFmpeg+SDLæ’­æ”¾è§†é¢‘\",// å‚æ•°ä¸€ï¼šçª—å£åç§° SDL_WINDOWPOS_CENTERED,// å‚æ•°äºŒï¼šçª—å£åœ¨å±å¹•ä¸Šçš„xåæ ‡ SDL_WINDOWPOS_CENTERED,// å‚æ•°ä¸‰ï¼šçª—å£åœ¨å±å¹•ä¸Šçš„yåæ ‡ DM.w,// å‚æ•°å››ï¼šçª—å£åœ¨å±å¹•ä¸Šå®½ DM.h,// å‚æ•°äº”ï¼šçª—å£åœ¨å±å¹•ä¸Šé«˜ SDL_WINDOW_OPENGL);// å‚æ•°å…­ï¼šçª—å£çŠ¶æ€(æ‰“å¼€) if (sdl_window == NULL){ // __android_log_print(ANDROID_LOG_INFO, \"main\", \"çª—å£åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çª—å£åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } screen = sdl_window; // åˆ›å»ºæ¸²æŸ“å™¨ // å®šä¹‰æ¸²æŸ“å™¨åŒºåŸŸ SDL_Renderer* sdl_renderer = SDL_CreateRenderer(sdl_window,// æ¸²æŸ“ç›®æ ‡åˆ›å»º -1, // ä»é‚£é‡Œå¼€å§‹æ¸²æŸ“(-1:è¡¨ç¤ºä»ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹) 0);// æ¸²æŸ“ç±»å‹(è½¯ä»¶æ¸²æŸ“) if (sdl_renderer == NULL){ // __android_log_print(ANDROID_LOG_INFO, \"main\", \"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"æ¸²æŸ“å™¨åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } // åˆ›å»ºçº¹ç† SDL_Texture* sdl_texture = SDL_CreateTexture(sdl_renderer,// æ¸²æŸ“å™¨ SDL_PIXELFORMAT_IYUV,// åƒç´ æ•°æ®æ ¼å¼ SDL_TEXTUREACCESS_STREAMING,// ç»˜åˆ¶æ–¹å¼ï¼šé¢‘ç¹ç»˜åˆ¶- is->video_width,// çº¹ç†å®½ is->video_height);// çº¹ç†é«˜ if (sdl_texture == NULL) { // __android_log_print(ANDROID_LOG_INFO, \"main\", \"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š%s\", SDL_GetError()); // Macä½¿ç”¨ // printf(\"çº¹ç†åˆ›å»ºå¤±è´¥ï¼š %s\\n\", SDL_GetError()); // é€€å‡ºç¨‹åº SDL_Quit(); return -1; } is->sdl_renderer = sdl_renderer; is->sdl_texture = sdl_texture; return 0; } //è®¾ç½®[å¿«è¿›]/[å¿«é€€]çŠ¶æ€å‚æ•° void stream_seek(VideoState *is, int64_t pos, int rel) { if (!is->seek_req) {//æ£€æŸ¥[å¿«è¿›]/[å¿«é€€]æ“ä½œæ ‡å¿—ä½æ˜¯å¦å¼€å¯ is->seek_pos = pos;//æ›´æ–°[å¿«è¿›]/[å¿«é€€]åçš„å‚è€ƒæ—¶é—´æˆ³ is->seek_flags = rel seek_req = 1;//å¼€å¯[å¿«è¿›]/[å¿«é€€]æ ‡å¿—ä½ } } int init_controller(VideoState *is) { SDL_Window *sdl_window2 = SDL_GL_GetCurrentWindow(); SDL_SysWMinfo systemWindowInfo; SDL_VERSION(&systemWindowInfo.version); if (!SDL_GetWindowWMInfo(sdl_window2, &systemWindowInfo)) { return -1; } ViewController *vc = [ViewController new]; vc.tapFastForwardButtonBlock = ^{ printf(\"å‰è¿›10ç§’\\n\"); if (global_video_state) { double incr, pos; incr = 10.0; pos = get_master_clock(global_video_state);//å–å¾—å½“å‰ä¸»åŒæ­¥æºæ—¶é—´æˆ³ pos += incr;//æ ¹æ®é”®ç›˜æ“ä½œæ›´æ–°ä¸»åŒæ­¥æºæ—¶é—´æˆ³(AV_TIME_BASEä¸ºæ—¶é—´æˆ³åŸºå‡†å€¼) stream_seek(global_video_state,(int64_t)(pos*AV_TIME_BASE),incr);//æ ¹æ®ä¸»åŒæ­¥æºæ—¶é—´æˆ³è®¾ç½®æŸ¥æ‰¾ä½ç½® } }; vc.tapFastBackwardButtonBlock = ^{ printf(\"åé€€10ç§’\\n\"); if (global_video_state) { double incr, pos; incr = -10.0; pos = get_master_clock(global_video_state);//å–å¾—å½“å‰ä¸»åŒæ­¥æºæ—¶é—´æˆ³ pos += incr;//æ ¹æ®é”®ç›˜æ“ä½œæ›´æ–°ä¸»åŒæ­¥æºæ—¶é—´æˆ³(AV_TIME_BASEä¸ºæ—¶é—´æˆ³åŸºå‡†å€¼) stream_seek(global_video_state,(int64_t)(pos*AV_TIME_BASE),incr);//æ ¹æ®ä¸»åŒæ­¥æºæ—¶é—´æˆ³è®¾ç½®æŸ¥æ‰¾ä½ç½® } }; UIWindow *customWindow = [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds]; customWindow.rootViewController = vc; [customWindow makeKeyAndVisible]; [systemWindowInfo.info.uikit.window addSubview:customWindow]; return 0; } // SDLå…¥å£ //extern \"C\" int main(int argc, char *argv[]) { /*------------------------- * æ³¨å†Œç»„ä»¶ * æ³¨å†Œæ‰€æœ‰ffmpegæ”¯æŒçš„å¤šåª’ä½“æ ¼å¼åŠç¼–è§£ç å™¨ -------------------------*/ av_register_all(); // åˆ›å»ºå…¨å±€çŠ¶æ€å¯¹è±¡ VideoState *is= (VideoState *)av_mallocz(sizeof(VideoState)); NSString* inPath = [[NSBundle mainBundle] pathForResource:@\"test\" ofType:@\"mov\"]; av_strlcpy(is->filename, [inPath UTF8String], sizeof(is->filename));// å¤åˆ¶è§†é¢‘æ–‡ä»¶è·¯å¾„å is->video_width = 640; is->video_height = 352; // av_strlcpy(is->filename, \"/storage/emulated/0/DCIM/Camera/TG-2022-04-13-160703582.mp4\", sizeof(is->filename));// å¤åˆ¶è§†é¢‘æ–‡ä»¶è·¯å¾„å // is->video_width = 720; // is->video_height = 1280; is->pictq_lock = SDL_CreateMutex();// åˆ›å»ºç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—äº’æ–¥é”å¯¹è±¡ is->pictq_ready = SDL_CreateCond();// åˆ›å»ºç¼–ç æ•°æ®åŒ…é˜Ÿåˆ—å°±ç»ªæ¡ä»¶å¯¹è±¡ int init_sdl_result = init_sdl(is); if (init_sdl_result av_sync_type = DEFAULT_AV_SYNC_TYPE;//æŒ‡å®šä¸»åŒæ­¥æº // åˆ›å»ºç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹ is->parse_tid = SDL_CreateThread(parse_thread, \"ç¼–ç æ•°æ®åŒ…è§£æçº¿ç¨‹\", is); if (!is->parse_tid) {// æ£€æŸ¥çº¿ç¨‹æ˜¯å¦åˆ›å»ºæˆåŠŸ av_free(is); return -1; } av_init_packet(&flush_pkt);//åˆå§‹åŒ–flush_pkt //å°†flush_pktçš„dataæˆå‘˜æŒ‡å®šä¸º\"FLUSH\"ï¼Œå½“æ•°æ®åŒ…é˜Ÿåˆ—ä¸­æŸä¸ªåŒ…çš„dataæˆå‘˜å–å€¼ä¸º\"FLUSH\"ï¼Œæ‰§è¡Œé‡ç½®è§£ç å™¨æ“ä½œ flush_pkt.data = (unsigned char *) \"FLUSH\"; // SDLäº‹ä»¶å¯¹è±¡ SDL_Event event; for (;;) {// SDLäº‹ä»¶å¾ªç¯ SDL_WaitEvent(&event);// ä¸»çº¿ç¨‹é˜»å¡ï¼Œç­‰å¾…äº‹ä»¶åˆ°æ¥ switch(event.type) {// äº‹ä»¶åˆ°æ¥åå”¤é†’ä¸»çº¿ç¨‹ï¼Œæ£€æŸ¥äº‹ä»¶ç±»å‹ case FF_QUIT_EVENT: case SDL_QUIT:// é€€å‡ºè¿›ç¨‹äº‹ä»¶ is->quit = 1; // If the video has finished playing, then both the picture and audio queues are waiting for more data. // Make them stop waiting and terminate normally.. avcodec_close(is->video_st->codec); avformat_free_context(is->pFormatCtx); SDL_CondSignal(is->audioq.qready);// å‘å‡ºé˜Ÿåˆ—å°±ç»ªä¿¡å·é¿å…æ­»é” SDL_CondSignal(is->videoq.qready); SDL_DestroyTexture(is->sdl_texture); SDL_DestroyRenderer(is->sdl_renderer); SDL_Quit(); return 0; case FF_ALLOC_EVENT: alloc_picture(event.user.data1);// åˆ†é…è§†é¢‘å¸§äº‹ä»¶å“åº”å‡½æ•° break; case FF_REFRESH_EVENT:// è§†é¢‘æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶ video_refresh_timer(event.user.data1);// è§†é¢‘æ˜¾ç¤ºåˆ·æ–°äº‹ä»¶å“åº”å‡½æ•° break; default: break; } } return 0; } "},"pages/FFmpeg/ffplayæºç .html":{"url":"pages/FFmpeg/ffplayæºç .html","title":"ffplayæºç ","keywords":"","body":"ffplayæºç  æºä»£ç ä¸€è§ˆ /* * Copyright (c) 2003 Fabrice Bellard * * This file is part of FFmpeg. * * FFmpeg is free software; you can redistribute it and/or * modify it under the terms of the GNU Lesser General Public * License as published by the Free Software Foundation; either * version 2.1 of the License, or (at your option) any later version. * * FFmpeg is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU * Lesser General Public License for more details. * * You should have received a copy of the GNU Lesser General Public * License along with FFmpeg; if not, write to the Free Software * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA */ /** * @file * simple media player based on the FFmpeg libraries */ #include \"config.h\" #include #include #include #include #include #include \"libavutil/avstring.h\" #include \"libavutil/eval.h\" #include \"libavutil/mathematics.h\" #include \"libavutil/pixdesc.h\" #include \"libavutil/imgutils.h\" #include \"libavutil/dict.h\" #include \"libavutil/parseutils.h\" #include \"libavutil/samplefmt.h\" #include \"libavutil/avassert.h\" #include \"libavutil/time.h\" #include \"libavformat/avformat.h\" #include \"libavdevice/avdevice.h\" #include \"libswscale/swscale.h\" #include \"libavutil/opt.h\" #include \"libavcodec/avfft.h\" #include \"libswresample/swresample.h\" #if CONFIG_AVFILTER # include \"libavfilter/avfilter.h\" # include \"libavfilter/buffersink.h\" # include \"libavfilter/buffersrc.h\" #endif #include #include #include \"cmdutils.h\" #include const char program_name[] = \"ffplay\"; const int program_birth_year = 2003; #define MAX_QUEUE_SIZE (15 * 1024 * 1024) #define MIN_FRAMES 25 #define EXTERNAL_CLOCK_MIN_FRAMES 2 #define EXTERNAL_CLOCK_MAX_FRAMES 10 /* Minimum SDL audio buffer size, in samples. */ #define SDL_AUDIO_MIN_BUFFER_SIZE 512 /* Calculate actual buffer size keeping in mind not cause too frequent audio callbacks */ #define SDL_AUDIO_MAX_CALLBACKS_PER_SEC 30 /* Step size for volume control in dB */ #define SDL_VOLUME_STEP (0.75) /* no AV sync correction is done if below the minimum AV sync threshold */ #define AV_SYNC_THRESHOLD_MIN 0.04 /* AV sync correction is done if above the maximum AV sync threshold */ #define AV_SYNC_THRESHOLD_MAX 0.1 /* If a frame duration is longer than this, it will not be duplicated to compensate AV sync */ #define AV_SYNC_FRAMEDUP_THRESHOLD 0.1 /* no AV correction is done if too big error */ #define AV_NOSYNC_THRESHOLD 10.0 /* maximum audio speed change to get correct sync */ #define SAMPLE_CORRECTION_PERCENT_MAX 10 /* external clock speed adjustment constants for realtime sources based on buffer fullness */ #define EXTERNAL_CLOCK_SPEED_MIN 0.900 #define EXTERNAL_CLOCK_SPEED_MAX 1.010 #define EXTERNAL_CLOCK_SPEED_STEP 0.001 /* we use about AUDIO_DIFF_AVG_NB A-V differences to make the average */ #define AUDIO_DIFF_AVG_NB 20 /* polls for possible required screen refresh at least this often, should be less than 1/fps */ #define REFRESH_RATE 0.01 /* NOTE: the size must be big enough to compensate the hardware audio buffersize size */ /* TODO: We assume that a decoded and resampled frame fits into this buffer */ #define SAMPLE_ARRAY_SIZE (8 * 65536) #define CURSOR_HIDE_DELAY 1000000 #define USE_ONEPASS_SUBTITLE_RENDER 1 static unsigned sws_flags = SWS_BICUBIC; typedef struct MyAVPacketList { AVPacket pkt; struct MyAVPacketList *next; int serial; } MyAVPacketList; typedef struct PacketQueue { MyAVPacketList *first_pkt, *last_pkt; int nb_packets; int size; int64_t duration; int abort_request; int serial; SDL_mutex *mutex; SDL_cond *cond; } PacketQueue; #define VIDEO_PICTURE_QUEUE_SIZE 3 #define SUBPICTURE_QUEUE_SIZE 16 #define SAMPLE_QUEUE_SIZE 9 #define FRAME_QUEUE_SIZE FFMAX(SAMPLE_QUEUE_SIZE, FFMAX(VIDEO_PICTURE_QUEUE_SIZE, SUBPICTURE_QUEUE_SIZE)) typedef struct AudioParams { int freq; int channels; int64_t channel_layout; enum AVSampleFormat fmt; int frame_size; int bytes_per_sec; } AudioParams; typedef struct Clock { double pts; /* clock base */ double pts_drift; /* clock base minus time at which we updated the clock */ double last_updated; double speed; int serial; /* clock is based on a packet with this serial */ int paused; int *queue_serial; /* pointer to the current packet queue serial, used for obsolete clock detection */ } Clock; /* Common struct for handling all types of decoded data and allocated render buffers. */ typedef struct Frame { AVFrame *frame; AVSubtitle sub; int serial; double pts; /* presentation timestamp for the frame */ double duration; /* estimated duration of the frame */ int64_t pos; /* byte position of the frame in the input file */ int width; int height; int format; AVRational sar; int uploaded; int flip_v; } Frame; typedef struct FrameQueue { Frame queue[FRAME_QUEUE_SIZE]; int rindex; int windex; int size; int max_size; int keep_last; int rindex_shown; SDL_mutex *mutex; SDL_cond *cond; PacketQueue *pktq; } FrameQueue; enum { AV_SYNC_AUDIO_MASTER, /* default choice */ AV_SYNC_VIDEO_MASTER, AV_SYNC_EXTERNAL_CLOCK, /* synchronize to an external clock */ }; typedef struct Decoder { AVPacket pkt; PacketQueue *queue; AVCodecContext *avctx; int pkt_serial; int finished; int packet_pending; SDL_cond *empty_queue_cond; int64_t start_pts; AVRational start_pts_tb; int64_t next_pts; AVRational next_pts_tb; SDL_Thread *decoder_tid; } Decoder; typedef struct VideoState { SDL_Thread *read_tid; AVInputFormat *iformat; int abort_request; int force_refresh; int paused; int last_paused; int queue_attachments_req; int seek_req; int seek_flags; int64_t seek_pos; int64_t seek_rel; int read_pause_return; AVFormatContext *ic; int realtime; Clock audclk; Clock vidclk; Clock extclk; FrameQueue pictq; FrameQueue subpq; FrameQueue sampq; Decoder auddec; Decoder viddec; Decoder subdec; int audio_stream; int av_sync_type; double audio_clock; int audio_clock_serial; double audio_diff_cum; /* used for AV difference average computation */ double audio_diff_avg_coef; double audio_diff_threshold; int audio_diff_avg_count; AVStream *audio_st; PacketQueue audioq; int audio_hw_buf_size; uint8_t *audio_buf; uint8_t *audio_buf1; unsigned int audio_buf_size; /* in bytes */ unsigned int audio_buf1_size; int audio_buf_index; /* in bytes */ int audio_write_buf_size; int audio_volume; int muted; struct AudioParams audio_src; #if CONFIG_AVFILTER struct AudioParams audio_filter_src; #endif struct AudioParams audio_tgt; struct SwrContext *swr_ctx; int frame_drops_early; int frame_drops_late; enum ShowMode { SHOW_MODE_NONE = -1, SHOW_MODE_VIDEO = 0, SHOW_MODE_WAVES, SHOW_MODE_RDFT, SHOW_MODE_NB } show_mode; int16_t sample_array[SAMPLE_ARRAY_SIZE]; int sample_array_index; int last_i_start; RDFTContext *rdft; int rdft_bits; FFTSample *rdft_data; int xpos; double last_vis_time; SDL_Texture *vis_texture; SDL_Texture *sub_texture; SDL_Texture *vid_texture; int subtitle_stream; AVStream *subtitle_st; PacketQueue subtitleq; double frame_timer; double frame_last_returned_time; double frame_last_filter_delay; int video_stream; AVStream *video_st; PacketQueue videoq; double max_frame_duration; // maximum duration of a frame - above this, we consider the jump a timestamp discontinuity struct SwsContext *img_convert_ctx; struct SwsContext *sub_convert_ctx; int eof; char *filename; int width, height, xleft, ytop; int step; #if CONFIG_AVFILTER int vfilter_idx; AVFilterContext *in_video_filter; // the first filter in the video chain AVFilterContext *out_video_filter; // the last filter in the video chain AVFilterContext *in_audio_filter; // the first filter in the audio chain AVFilterContext *out_audio_filter; // the last filter in the audio chain AVFilterGraph *agraph; // audio filter graph #endif int last_video_stream, last_audio_stream, last_subtitle_stream; SDL_cond *continue_read_thread; } VideoState; /* options specified by the user */ static AVInputFormat *file_iformat; static const char *input_filename; static const char *window_title; static int default_width = 640; static int default_height = 480; static int screen_width = 0; static int screen_height = 0; static int screen_left = SDL_WINDOWPOS_CENTERED; static int screen_top = SDL_WINDOWPOS_CENTERED; static int audio_disable; static int video_disable; static int subtitle_disable; static const char* wanted_stream_spec[AVMEDIA_TYPE_NB] = {0}; static int seek_by_bytes = -1; static float seek_interval = 10; static int display_disable; static int borderless; static int alwaysontop; static int startup_volume = 100; static int show_status = 1; static int av_sync_type = AV_SYNC_AUDIO_MASTER; static int64_t start_time = AV_NOPTS_VALUE; static int64_t duration = AV_NOPTS_VALUE; static int fast = 0; static int genpts = 0; static int lowres = 0; static int decoder_reorder_pts = -1; static int autoexit; static int exit_on_keydown; static int exit_on_mousedown; static int loop = 1; static int framedrop = -1; static int infinite_buffer = -1; static enum ShowMode show_mode = SHOW_MODE_NONE; static const char *audio_codec_name; static const char *subtitle_codec_name; static const char *video_codec_name; double rdftspeed = 0.02; static int64_t cursor_last_shown; static int cursor_hidden = 0; #if CONFIG_AVFILTER static const char **vfilters_list = NULL; static int nb_vfilters = 0; static char *afilters = NULL; #endif static int autorotate = 1; static int find_stream_info = 1; static int filter_nbthreads = 0; /* current context */ static int is_full_screen; static int64_t audio_callback_time; static AVPacket flush_pkt; #define FF_QUIT_EVENT (SDL_USEREVENT + 2) static SDL_Window *window; static SDL_Renderer *renderer; static SDL_RendererInfo renderer_info = {0}; static SDL_AudioDeviceID audio_dev; static const struct TextureFormatEntry { enum AVPixelFormat format; int texture_fmt; } sdl_texture_format_map[] = { { AV_PIX_FMT_RGB8, SDL_PIXELFORMAT_RGB332 }, { AV_PIX_FMT_RGB444, SDL_PIXELFORMAT_RGB444 }, { AV_PIX_FMT_RGB555, SDL_PIXELFORMAT_RGB555 }, { AV_PIX_FMT_BGR555, SDL_PIXELFORMAT_BGR555 }, { AV_PIX_FMT_RGB565, SDL_PIXELFORMAT_RGB565 }, { AV_PIX_FMT_BGR565, SDL_PIXELFORMAT_BGR565 }, { AV_PIX_FMT_RGB24, SDL_PIXELFORMAT_RGB24 }, { AV_PIX_FMT_BGR24, SDL_PIXELFORMAT_BGR24 }, { AV_PIX_FMT_0RGB32, SDL_PIXELFORMAT_RGB888 }, { AV_PIX_FMT_0BGR32, SDL_PIXELFORMAT_BGR888 }, { AV_PIX_FMT_NE(RGB0, 0BGR), SDL_PIXELFORMAT_RGBX8888 }, { AV_PIX_FMT_NE(BGR0, 0RGB), SDL_PIXELFORMAT_BGRX8888 }, { AV_PIX_FMT_RGB32, SDL_PIXELFORMAT_ARGB8888 }, { AV_PIX_FMT_RGB32_1, SDL_PIXELFORMAT_RGBA8888 }, { AV_PIX_FMT_BGR32, SDL_PIXELFORMAT_ABGR8888 }, { AV_PIX_FMT_BGR32_1, SDL_PIXELFORMAT_BGRA8888 }, { AV_PIX_FMT_YUV420P, SDL_PIXELFORMAT_IYUV }, { AV_PIX_FMT_YUYV422, SDL_PIXELFORMAT_YUY2 }, { AV_PIX_FMT_UYVY422, SDL_PIXELFORMAT_UYVY }, { AV_PIX_FMT_NONE, SDL_PIXELFORMAT_UNKNOWN }, }; #if CONFIG_AVFILTER static int opt_add_vfilter(void *optctx, const char *opt, const char *arg) { GROW_ARRAY(vfilters_list, nb_vfilters); vfilters_list[nb_vfilters - 1] = arg; return 0; } #endif static inline int cmp_audio_fmts(enum AVSampleFormat fmt1, int64_t channel_count1, enum AVSampleFormat fmt2, int64_t channel_count2) { /* If channel count == 1, planar and non-planar formats are the same */ if (channel_count1 == 1 && channel_count2 == 1) return av_get_packed_sample_fmt(fmt1) != av_get_packed_sample_fmt(fmt2); else return channel_count1 != channel_count2 || fmt1 != fmt2; } static inline int64_t get_valid_channel_layout(int64_t channel_layout, int channels) { if (channel_layout && av_get_channel_layout_nb_channels(channel_layout) == channels) return channel_layout; else return 0; } static int packet_queue_put_private(PacketQueue *q, AVPacket *pkt) { MyAVPacketList *pkt1; if (q->abort_request) return -1; pkt1 = av_malloc(sizeof(MyAVPacketList)); if (!pkt1) return -1; pkt1->pkt = *pkt; pkt1->next = NULL; if (pkt == &flush_pkt) q->serial++; pkt1->serial = q->serial; if (!q->last_pkt) q->first_pkt = pkt1; else q->last_pkt->next = pkt1; q->last_pkt = pkt1; q->nb_packets++; q->size += pkt1->pkt.size + sizeof(*pkt1); q->duration += pkt1->pkt.duration; /* XXX: should duplicate packet data in DV case */ SDL_CondSignal(q->cond); return 0; } static int packet_queue_put(PacketQueue *q, AVPacket *pkt) { int ret; SDL_LockMutex(q->mutex); ret = packet_queue_put_private(q, pkt); SDL_UnlockMutex(q->mutex); if (pkt != &flush_pkt && ret data = NULL; pkt->size = 0; pkt->stream_index = stream_index; return packet_queue_put(q, pkt); } /* packet queue handling */ static int packet_queue_init(PacketQueue *q) { memset(q, 0, sizeof(PacketQueue)); q->mutex = SDL_CreateMutex(); if (!q->mutex) { av_log(NULL, AV_LOG_FATAL, \"SDL_CreateMutex(): %s\\n\", SDL_GetError()); return AVERROR(ENOMEM); } q->cond = SDL_CreateCond(); if (!q->cond) { av_log(NULL, AV_LOG_FATAL, \"SDL_CreateCond(): %s\\n\", SDL_GetError()); return AVERROR(ENOMEM); } q->abort_request = 1; return 0; } static void packet_queue_flush(PacketQueue *q) { MyAVPacketList *pkt, *pkt1; SDL_LockMutex(q->mutex); for (pkt = q->first_pkt; pkt; pkt = pkt1) { pkt1 = pkt->next; av_packet_unref(&pkt->pkt); av_freep(&pkt); } q->last_pkt = NULL; q->first_pkt = NULL; q->nb_packets = 0; q->size = 0; q->duration = 0; SDL_UnlockMutex(q->mutex); } static void packet_queue_destroy(PacketQueue *q) { packet_queue_flush(q); SDL_DestroyMutex(q->mutex); SDL_DestroyCond(q->cond); } static void packet_queue_abort(PacketQueue *q) { SDL_LockMutex(q->mutex); q->abort_request = 1; SDL_CondSignal(q->cond); SDL_UnlockMutex(q->mutex); } static void packet_queue_start(PacketQueue *q) { SDL_LockMutex(q->mutex); q->abort_request = 0; packet_queue_put_private(q, &flush_pkt); SDL_UnlockMutex(q->mutex); } /* return 0 if packet. */ static int packet_queue_get(PacketQueue *q, AVPacket *pkt, int block, int *serial) { MyAVPacketList *pkt1; int ret; SDL_LockMutex(q->mutex); for (;;) { if (q->abort_request) { ret = -1; break; } pkt1 = q->first_pkt; if (pkt1) { q->first_pkt = pkt1->next; if (!q->first_pkt) q->last_pkt = NULL; q->nb_packets--; q->size -= pkt1->pkt.size + sizeof(*pkt1); q->duration -= pkt1->pkt.duration; *pkt = pkt1->pkt; if (serial) *serial = pkt1->serial; av_free(pkt1); ret = 1; break; } else if (!block) { ret = 0; break; } else { SDL_CondWait(q->cond, q->mutex); } } SDL_UnlockMutex(q->mutex); return ret; } static void decoder_init(Decoder *d, AVCodecContext *avctx, PacketQueue *queue, SDL_cond *empty_queue_cond) { memset(d, 0, sizeof(Decoder)); d->avctx = avctx; d->queue = queue; d->empty_queue_cond = empty_queue_cond; d->start_pts = AV_NOPTS_VALUE; d->pkt_serial = -1; } static int decoder_decode_frame(Decoder *d, AVFrame *frame, AVSubtitle *sub) { int ret = AVERROR(EAGAIN); for (;;) { AVPacket pkt; if (d->queue->serial == d->pkt_serial) { do { if (d->queue->abort_request) return -1; switch (d->avctx->codec_type) { case AVMEDIA_TYPE_VIDEO: ret = avcodec_receive_frame(d->avctx, frame); if (ret >= 0) { if (decoder_reorder_pts == -1) { frame->pts = frame->best_effort_timestamp; } else if (!decoder_reorder_pts) { frame->pts = frame->pkt_dts; } } break; case AVMEDIA_TYPE_AUDIO: ret = avcodec_receive_frame(d->avctx, frame); if (ret >= 0) { AVRational tb = (AVRational){1, frame->sample_rate}; if (frame->pts != AV_NOPTS_VALUE) frame->pts = av_rescale_q(frame->pts, d->avctx->pkt_timebase, tb); else if (d->next_pts != AV_NOPTS_VALUE) frame->pts = av_rescale_q(d->next_pts, d->next_pts_tb, tb); if (frame->pts != AV_NOPTS_VALUE) { d->next_pts = frame->pts + frame->nb_samples; d->next_pts_tb = tb; } } break; } if (ret == AVERROR_EOF) { d->finished = d->pkt_serial; avcodec_flush_buffers(d->avctx); return 0; } if (ret >= 0) return 1; } while (ret != AVERROR(EAGAIN)); } do { if (d->queue->nb_packets == 0) SDL_CondSignal(d->empty_queue_cond); if (d->packet_pending) { av_packet_move_ref(&pkt, &d->pkt); d->packet_pending = 0; } else { if (packet_queue_get(d->queue, &pkt, 1, &d->pkt_serial) queue->serial != d->pkt_serial); if (pkt.data == flush_pkt.data) { avcodec_flush_buffers(d->avctx); d->finished = 0; d->next_pts = d->start_pts; d->next_pts_tb = d->start_pts_tb; } else { if (d->avctx->codec_type == AVMEDIA_TYPE_SUBTITLE) { int got_frame = 0; ret = avcodec_decode_subtitle2(d->avctx, sub, &got_frame, &pkt); if (ret packet_pending = 1; av_packet_move_ref(&d->pkt, &pkt); } ret = got_frame ? 0 : (pkt.data ? AVERROR(EAGAIN) : AVERROR_EOF); } } else { if (avcodec_send_packet(d->avctx, &pkt) == AVERROR(EAGAIN)) { av_log(d->avctx, AV_LOG_ERROR, \"Receive_frame and send_packet both returned EAGAIN, which is an API violation.\\n\"); d->packet_pending = 1; av_packet_move_ref(&d->pkt, &pkt); } } av_packet_unref(&pkt); } } } static void decoder_destroy(Decoder *d) { av_packet_unref(&d->pkt); avcodec_free_context(&d->avctx); } static void frame_queue_unref_item(Frame *vp) { av_frame_unref(vp->frame); avsubtitle_free(&vp->sub); } static int frame_queue_init(FrameQueue *f, PacketQueue *pktq, int max_size, int keep_last) { int i; memset(f, 0, sizeof(FrameQueue)); if (!(f->mutex = SDL_CreateMutex())) { av_log(NULL, AV_LOG_FATAL, \"SDL_CreateMutex(): %s\\n\", SDL_GetError()); return AVERROR(ENOMEM); } if (!(f->cond = SDL_CreateCond())) { av_log(NULL, AV_LOG_FATAL, \"SDL_CreateCond(): %s\\n\", SDL_GetError()); return AVERROR(ENOMEM); } f->pktq = pktq; f->max_size = FFMIN(max_size, FRAME_QUEUE_SIZE); f->keep_last = !!keep_last; for (i = 0; i max_size; i++) if (!(f->queue[i].frame = av_frame_alloc())) return AVERROR(ENOMEM); return 0; } static void frame_queue_destory(FrameQueue *f) { int i; for (i = 0; i max_size; i++) { Frame *vp = &f->queue[i]; frame_queue_unref_item(vp); av_frame_free(&vp->frame); } SDL_DestroyMutex(f->mutex); SDL_DestroyCond(f->cond); } static void frame_queue_signal(FrameQueue *f) { SDL_LockMutex(f->mutex); SDL_CondSignal(f->cond); SDL_UnlockMutex(f->mutex); } static Frame *frame_queue_peek(FrameQueue *f) { return &f->queue[(f->rindex + f->rindex_shown) % f->max_size]; } static Frame *frame_queue_peek_next(FrameQueue *f) { return &f->queue[(f->rindex + f->rindex_shown + 1) % f->max_size]; } static Frame *frame_queue_peek_last(FrameQueue *f) { return &f->queue[f->rindex]; } static Frame *frame_queue_peek_writable(FrameQueue *f) { /* wait until we have space to put a new frame */ SDL_LockMutex(f->mutex); while (f->size >= f->max_size && !f->pktq->abort_request) { SDL_CondWait(f->cond, f->mutex); } SDL_UnlockMutex(f->mutex); if (f->pktq->abort_request) return NULL; return &f->queue[f->windex]; } static Frame *frame_queue_peek_readable(FrameQueue *f) { /* wait until we have a readable a new frame */ SDL_LockMutex(f->mutex); while (f->size - f->rindex_shown pktq->abort_request) { SDL_CondWait(f->cond, f->mutex); } SDL_UnlockMutex(f->mutex); if (f->pktq->abort_request) return NULL; return &f->queue[(f->rindex + f->rindex_shown) % f->max_size]; } static void frame_queue_push(FrameQueue *f) { if (++f->windex == f->max_size) f->windex = 0; SDL_LockMutex(f->mutex); f->size++; SDL_CondSignal(f->cond); SDL_UnlockMutex(f->mutex); } static void frame_queue_next(FrameQueue *f) { if (f->keep_last && !f->rindex_shown) { f->rindex_shown = 1; return; } frame_queue_unref_item(&f->queue[f->rindex]); if (++f->rindex == f->max_size) f->rindex = 0; SDL_LockMutex(f->mutex); f->size--; SDL_CondSignal(f->cond); SDL_UnlockMutex(f->mutex); } /* return the number of undisplayed frames in the queue */ static int frame_queue_nb_remaining(FrameQueue *f) { return f->size - f->rindex_shown; } /* return last shown position */ static int64_t frame_queue_last_pos(FrameQueue *f) { Frame *fp = &f->queue[f->rindex]; if (f->rindex_shown && fp->serial == f->pktq->serial) return fp->pos; else return -1; } static void decoder_abort(Decoder *d, FrameQueue *fq) { packet_queue_abort(d->queue); frame_queue_signal(fq); SDL_WaitThread(d->decoder_tid, NULL); d->decoder_tid = NULL; packet_queue_flush(d->queue); } static inline void fill_rectangle(int x, int y, int w, int h) { SDL_Rect rect; rect.x = x; rect.y = y; rect.w = w; rect.h = h; if (w && h) SDL_RenderFillRect(renderer, &rect); } static int realloc_texture(SDL_Texture **texture, Uint32 new_format, int new_width, int new_height, SDL_BlendMode blendmode, int init_texture) { Uint32 format; int access, w, h; if (!*texture || SDL_QueryTexture(*texture, &format, &access, &w, &h) scr_width) { width = scr_width; height = av_rescale(width, aspect_ratio.den, aspect_ratio.num) & ~1; } x = (scr_width - width) / 2; y = (scr_height - height) / 2; rect->x = scr_xleft + x; rect->y = scr_ytop + y; rect->w = FFMAX((int)width, 1); rect->h = FFMAX((int)height, 1); } static void get_sdl_pix_fmt_and_blendmode(int format, Uint32 *sdl_pix_fmt, SDL_BlendMode *sdl_blendmode) { int i; *sdl_blendmode = SDL_BLENDMODE_NONE; *sdl_pix_fmt = SDL_PIXELFORMAT_UNKNOWN; if (format == AV_PIX_FMT_RGB32 || format == AV_PIX_FMT_RGB32_1 || format == AV_PIX_FMT_BGR32 || format == AV_PIX_FMT_BGR32_1) *sdl_blendmode = SDL_BLENDMODE_BLEND; for (i = 0; i format, &sdl_pix_fmt, &sdl_blendmode); if (realloc_texture(tex, sdl_pix_fmt == SDL_PIXELFORMAT_UNKNOWN ? SDL_PIXELFORMAT_ARGB8888 : sdl_pix_fmt, frame->width, frame->height, sdl_blendmode, 0) width, frame->height, frame->format, frame->width, frame->height, AV_PIX_FMT_BGRA, sws_flags, NULL, NULL, NULL); if (*img_convert_ctx != NULL) { uint8_t *pixels[4]; int pitch[4]; if (!SDL_LockTexture(*tex, NULL, (void **)pixels, pitch)) { sws_scale(*img_convert_ctx, (const uint8_t * const *)frame->data, frame->linesize, 0, frame->height, pixels, pitch); SDL_UnlockTexture(*tex); } } else { av_log(NULL, AV_LOG_FATAL, \"Cannot initialize the conversion context\\n\"); ret = -1; } break; case SDL_PIXELFORMAT_IYUV: if (frame->linesize[0] > 0 && frame->linesize[1] > 0 && frame->linesize[2] > 0) { ret = SDL_UpdateYUVTexture(*tex, NULL, frame->data[0], frame->linesize[0], frame->data[1], frame->linesize[1], frame->data[2], frame->linesize[2]); } else if (frame->linesize[0] linesize[1] linesize[2] data[0] + frame->linesize[0] * (frame->height - 1), -frame->linesize[0], frame->data[1] + frame->linesize[1] * (AV_CEIL_RSHIFT(frame->height, 1) - 1), -frame->linesize[1], frame->data[2] + frame->linesize[2] * (AV_CEIL_RSHIFT(frame->height, 1) - 1), -frame->linesize[2]); } else { av_log(NULL, AV_LOG_ERROR, \"Mixed negative and positive linesizes are not supported.\\n\"); return -1; } break; default: if (frame->linesize[0] data[0] + frame->linesize[0] * (frame->height - 1), -frame->linesize[0]); } else { ret = SDL_UpdateTexture(*tex, NULL, frame->data[0], frame->linesize[0]); } break; } return ret; } static void set_sdl_yuv_conversion_mode(AVFrame *frame) { #if SDL_VERSION_ATLEAST(2,0,8) SDL_YUV_CONVERSION_MODE mode = SDL_YUV_CONVERSION_AUTOMATIC; if (frame && (frame->format == AV_PIX_FMT_YUV420P || frame->format == AV_PIX_FMT_YUYV422 || frame->format == AV_PIX_FMT_UYVY422)) { if (frame->color_range == AVCOL_RANGE_JPEG) mode = SDL_YUV_CONVERSION_JPEG; else if (frame->colorspace == AVCOL_SPC_BT709) mode = SDL_YUV_CONVERSION_BT709; else if (frame->colorspace == AVCOL_SPC_BT470BG || frame->colorspace == AVCOL_SPC_SMPTE170M || frame->colorspace == AVCOL_SPC_SMPTE240M) mode = SDL_YUV_CONVERSION_BT601; } SDL_SetYUVConversionMode(mode); #endif } static void video_image_display(VideoState *is) { Frame *vp; Frame *sp = NULL; SDL_Rect rect; vp = frame_queue_peek_last(&is->pictq); if (is->subtitle_st) { if (frame_queue_nb_remaining(&is->subpq) > 0) { sp = frame_queue_peek(&is->subpq); if (vp->pts >= sp->pts + ((float) sp->sub.start_display_time / 1000)) { if (!sp->uploaded) { uint8_t* pixels[4]; int pitch[4]; int i; if (!sp->width || !sp->height) { sp->width = vp->width; sp->height = vp->height; } if (realloc_texture(&is->sub_texture, SDL_PIXELFORMAT_ARGB8888, sp->width, sp->height, SDL_BLENDMODE_BLEND, 1) sub.num_rects; i++) { AVSubtitleRect *sub_rect = sp->sub.rects[i]; sub_rect->x = av_clip(sub_rect->x, 0, sp->width ); sub_rect->y = av_clip(sub_rect->y, 0, sp->height); sub_rect->w = av_clip(sub_rect->w, 0, sp->width - sub_rect->x); sub_rect->h = av_clip(sub_rect->h, 0, sp->height - sub_rect->y); is->sub_convert_ctx = sws_getCachedContext(is->sub_convert_ctx, sub_rect->w, sub_rect->h, AV_PIX_FMT_PAL8, sub_rect->w, sub_rect->h, AV_PIX_FMT_BGRA, 0, NULL, NULL, NULL); if (!is->sub_convert_ctx) { av_log(NULL, AV_LOG_FATAL, \"Cannot initialize the conversion context\\n\"); return; } if (!SDL_LockTexture(is->sub_texture, (SDL_Rect *)sub_rect, (void **)pixels, pitch)) { sws_scale(is->sub_convert_ctx, (const uint8_t * const *)sub_rect->data, sub_rect->linesize, 0, sub_rect->h, pixels, pitch); SDL_UnlockTexture(is->sub_texture); } } sp->uploaded = 1; } } else sp = NULL; } } calculate_display_rect(&rect, is->xleft, is->ytop, is->width, is->height, vp->width, vp->height, vp->sar); if (!vp->uploaded) { if (upload_texture(&is->vid_texture, vp->frame, &is->img_convert_ctx) uploaded = 1; vp->flip_v = vp->frame->linesize[0] frame); SDL_RenderCopyEx(renderer, is->vid_texture, NULL, &rect, 0, NULL, vp->flip_v ? SDL_FLIP_VERTICAL : 0); set_sdl_yuv_conversion_mode(NULL); if (sp) { #if USE_ONEPASS_SUBTITLE_RENDER SDL_RenderCopy(renderer, is->sub_texture, NULL, &rect); #else int i; double xratio = (double)rect.w / (double)sp->width; double yratio = (double)rect.h / (double)sp->height; for (i = 0; i sub.num_rects; i++) { SDL_Rect *sub_rect = (SDL_Rect*)sp->sub.rects[i]; SDL_Rect target = {.x = rect.x + sub_rect->x * xratio, .y = rect.y + sub_rect->y * yratio, .w = sub_rect->w * xratio, .h = sub_rect->h * yratio}; SDL_RenderCopy(renderer, is->sub_texture, sub_rect, &target); } #endif } } static inline int compute_mod(int a, int b) { return a height; rdft_bits++) ; nb_freq = 1 audio_tgt.channels; nb_display_channels = channels; if (!s->paused) { int data_used= s->show_mode == SHOW_MODE_WAVES ? s->width : (2*nb_freq); n = 2 * channels; delay = s->audio_write_buf_size; delay /= n; /* to be more precise, we take into account the time spent since the last buffer computation */ if (audio_callback_time) { time_diff = av_gettime_relative() - audio_callback_time; delay -= (time_diff * s->audio_tgt.freq) / 1000000; } delay += 2 * data_used; if (delay sample_array_index - delay * channels, SAMPLE_ARRAY_SIZE); if (s->show_mode == SHOW_MODE_WAVES) { h = INT_MIN; for (i = 0; i sample_array[idx]; int b = s->sample_array[(idx + 4 * channels) % SAMPLE_ARRAY_SIZE]; int c = s->sample_array[(idx + 5 * channels) % SAMPLE_ARRAY_SIZE]; int d = s->sample_array[(idx + 9 * channels) % SAMPLE_ARRAY_SIZE]; int score = a - d; if (h last_i_start = i_start; } else { i_start = s->last_i_start; } if (s->show_mode == SHOW_MODE_WAVES) { SDL_SetRenderDrawColor(renderer, 255, 255, 255, 255); /* total height for one channel */ h = s->height / nb_display_channels; /* graph height / 2 */ h2 = (h * 9) / 20; for (ch = 0; ch ytop + ch * h + (h / 2); /* position of center line */ for (x = 0; x width; x++) { y = (s->sample_array[i] * h2) >> 15; if (y xleft + x, ys, 1, y); i += channels; if (i >= SAMPLE_ARRAY_SIZE) i -= SAMPLE_ARRAY_SIZE; } } SDL_SetRenderDrawColor(renderer, 0, 0, 255, 255); for (ch = 1; ch ytop + ch * h; fill_rectangle(s->xleft, y, s->width, 1); } } else { if (realloc_texture(&s->vis_texture, SDL_PIXELFORMAT_ARGB8888, s->width, s->height, SDL_BLENDMODE_NONE, 1) rdft_bits) { av_rdft_end(s->rdft); av_free(s->rdft_data); s->rdft = av_rdft_init(rdft_bits, DFT_R2C); s->rdft_bits = rdft_bits; s->rdft_data = av_malloc_array(nb_freq, 4 *sizeof(*s->rdft_data)); } if (!s->rdft || !s->rdft_data){ av_log(NULL, AV_LOG_ERROR, \"Failed to allocate buffers for RDFT, switching to waves display\\n\"); s->show_mode = SHOW_MODE_WAVES; } else { FFTSample *data[2]; SDL_Rect rect = {.x = s->xpos, .y = 0, .w = 1, .h = s->height}; uint32_t *pixels; int pitch; for (ch = 0; ch rdft_data + 2 * nb_freq * ch; i = i_start + ch; for (x = 0; x sample_array[i] * (1.0 - w * w); i += channels; if (i >= SAMPLE_ARRAY_SIZE) i -= SAMPLE_ARRAY_SIZE; } av_rdft_calc(s->rdft, data[ch]); } /* Least efficient way to do this, we should of course * directly access it but it is more than fast enough. */ if (!SDL_LockTexture(s->vis_texture, &rect, (void **)&pixels, &pitch)) { pitch >>= 2; pixels += pitch * s->height; for (y = 0; y height; y++) { double w = 1 / sqrt(nb_freq); int a = sqrt(w * sqrt(data[0][2 * y + 0] * data[0][2 * y + 0] + data[0][2 * y + 1] * data[0][2 * y + 1])); int b = (nb_display_channels == 2 ) ? sqrt(w * hypot(data[1][2 * y + 0], data[1][2 * y + 1])) : a; a = FFMIN(a, 255); b = FFMIN(b, 255); pixels -= pitch; *pixels = (a > 1); } SDL_UnlockTexture(s->vis_texture); } SDL_RenderCopy(renderer, s->vis_texture, NULL, NULL); } if (!s->paused) s->xpos++; if (s->xpos >= s->width) s->xpos= s->xleft; } } static void stream_component_close(VideoState *is, int stream_index) { AVFormatContext *ic = is->ic; AVCodecParameters *codecpar; if (stream_index = ic->nb_streams) return; codecpar = ic->streams[stream_index]->codecpar; switch (codecpar->codec_type) { case AVMEDIA_TYPE_AUDIO: decoder_abort(&is->auddec, &is->sampq); SDL_CloseAudioDevice(audio_dev); decoder_destroy(&is->auddec); swr_free(&is->swr_ctx); av_freep(&is->audio_buf1); is->audio_buf1_size = 0; is->audio_buf = NULL; if (is->rdft) { av_rdft_end(is->rdft); av_freep(&is->rdft_data); is->rdft = NULL; is->rdft_bits = 0; } break; case AVMEDIA_TYPE_VIDEO: decoder_abort(&is->viddec, &is->pictq); decoder_destroy(&is->viddec); break; case AVMEDIA_TYPE_SUBTITLE: decoder_abort(&is->subdec, &is->subpq); decoder_destroy(&is->subdec); break; default: break; } ic->streams[stream_index]->discard = AVDISCARD_ALL; switch (codecpar->codec_type) { case AVMEDIA_TYPE_AUDIO: is->audio_st = NULL; is->audio_stream = -1; break; case AVMEDIA_TYPE_VIDEO: is->video_st = NULL; is->video_stream = -1; break; case AVMEDIA_TYPE_SUBTITLE: is->subtitle_st = NULL; is->subtitle_stream = -1; break; default: break; } } static void stream_close(VideoState *is) { /* XXX: use a special url_shutdown call to abort parse cleanly */ is->abort_request = 1; SDL_WaitThread(is->read_tid, NULL); /* close each stream */ if (is->audio_stream >= 0) stream_component_close(is, is->audio_stream); if (is->video_stream >= 0) stream_component_close(is, is->video_stream); if (is->subtitle_stream >= 0) stream_component_close(is, is->subtitle_stream); avformat_close_input(&is->ic); packet_queue_destroy(&is->videoq); packet_queue_destroy(&is->audioq); packet_queue_destroy(&is->subtitleq); /* free all pictures */ frame_queue_destory(&is->pictq); frame_queue_destory(&is->sampq); frame_queue_destory(&is->subpq); SDL_DestroyCond(is->continue_read_thread); sws_freeContext(is->img_convert_ctx); sws_freeContext(is->sub_convert_ctx); av_free(is->filename); if (is->vis_texture) SDL_DestroyTexture(is->vis_texture); if (is->vid_texture) SDL_DestroyTexture(is->vid_texture); if (is->sub_texture) SDL_DestroyTexture(is->sub_texture); av_free(is); } static void do_exit(VideoState *is) { if (is) { stream_close(is); } if (renderer) SDL_DestroyRenderer(renderer); if (window) SDL_DestroyWindow(window); uninit_opts(); #if CONFIG_AVFILTER av_freep(&vfilters_list); #endif avformat_network_deinit(); if (show_status) printf(\"\\n\"); SDL_Quit(); av_log(NULL, AV_LOG_QUIET, \"%s\", \"\"); exit(0); } static void sigterm_handler(int sig) { exit(123); } static void set_default_window_size(int width, int height, AVRational sar) { SDL_Rect rect; int max_width = screen_width ? screen_width : INT_MAX; int max_height = screen_height ? screen_height : INT_MAX; if (max_width == INT_MAX && max_height == INT_MAX) max_height = height; calculate_display_rect(&rect, 0, 0, max_width, max_height, width, height, sar); default_width = rect.w; default_height = rect.h; } static int video_open(VideoState *is) { int w,h; w = screen_width ? screen_width : default_width; h = screen_height ? screen_height : default_height; if (!window_title) window_title = input_filename; SDL_SetWindowTitle(window, window_title); SDL_SetWindowSize(window, w, h); SDL_SetWindowPosition(window, screen_left, screen_top); if (is_full_screen) SDL_SetWindowFullscreen(window, SDL_WINDOW_FULLSCREEN_DESKTOP); SDL_ShowWindow(window); is->width = w; is->height = h; return 0; } /* display the current picture, if any */ static void video_display(VideoState *is) { if (!is->width) video_open(is); SDL_SetRenderDrawColor(renderer, 0, 0, 0, 255); SDL_RenderClear(renderer); if (is->audio_st && is->show_mode != SHOW_MODE_VIDEO) video_audio_display(is); else if (is->video_st) video_image_display(is); SDL_RenderPresent(renderer); } static double get_clock(Clock *c) { if (*c->queue_serial != c->serial) return NAN; if (c->paused) { return c->pts; } else { double time = av_gettime_relative() / 1000000.0; return c->pts_drift + time - (time - c->last_updated) * (1.0 - c->speed); } } static void set_clock_at(Clock *c, double pts, int serial, double time) { c->pts = pts; c->last_updated = time; c->pts_drift = c->pts - time; c->serial = serial; } static void set_clock(Clock *c, double pts, int serial) { double time = av_gettime_relative() / 1000000.0; set_clock_at(c, pts, serial, time); } static void set_clock_speed(Clock *c, double speed) { set_clock(c, get_clock(c), c->serial); c->speed = speed; } static void init_clock(Clock *c, int *queue_serial) { c->speed = 1.0; c->paused = 0; c->queue_serial = queue_serial; set_clock(c, NAN, -1); } static void sync_clock_to_slave(Clock *c, Clock *slave) { double clock = get_clock(c); double slave_clock = get_clock(slave); if (!isnan(slave_clock) && (isnan(clock) || fabs(clock - slave_clock) > AV_NOSYNC_THRESHOLD)) set_clock(c, slave_clock, slave->serial); } static int get_master_sync_type(VideoState *is) { if (is->av_sync_type == AV_SYNC_VIDEO_MASTER) { if (is->video_st) return AV_SYNC_VIDEO_MASTER; else return AV_SYNC_AUDIO_MASTER; } else if (is->av_sync_type == AV_SYNC_AUDIO_MASTER) { if (is->audio_st) return AV_SYNC_AUDIO_MASTER; else return AV_SYNC_EXTERNAL_CLOCK; } else { return AV_SYNC_EXTERNAL_CLOCK; } } /* get the current master clock value */ static double get_master_clock(VideoState *is) { double val; switch (get_master_sync_type(is)) { case AV_SYNC_VIDEO_MASTER: val = get_clock(&is->vidclk); break; case AV_SYNC_AUDIO_MASTER: val = get_clock(&is->audclk); break; default: val = get_clock(&is->extclk); break; } return val; } static void check_external_clock_speed(VideoState *is) { if (is->video_stream >= 0 && is->videoq.nb_packets audio_stream >= 0 && is->audioq.nb_packets extclk, FFMAX(EXTERNAL_CLOCK_SPEED_MIN, is->extclk.speed - EXTERNAL_CLOCK_SPEED_STEP)); } else if ((is->video_stream videoq.nb_packets > EXTERNAL_CLOCK_MAX_FRAMES) && (is->audio_stream audioq.nb_packets > EXTERNAL_CLOCK_MAX_FRAMES)) { set_clock_speed(&is->extclk, FFMIN(EXTERNAL_CLOCK_SPEED_MAX, is->extclk.speed + EXTERNAL_CLOCK_SPEED_STEP)); } else { double speed = is->extclk.speed; if (speed != 1.0) set_clock_speed(&is->extclk, speed + EXTERNAL_CLOCK_SPEED_STEP * (1.0 - speed) / fabs(1.0 - speed)); } } /* seek in the stream */ static void stream_seek(VideoState *is, int64_t pos, int64_t rel, int seek_by_bytes) { if (!is->seek_req) { is->seek_pos = pos; is->seek_rel = rel; is->seek_flags &= ~AVSEEK_FLAG_BYTE; if (seek_by_bytes) is->seek_flags |= AVSEEK_FLAG_BYTE; is->seek_req = 1; SDL_CondSignal(is->continue_read_thread); } } /* pause or resume the video */ static void stream_toggle_pause(VideoState *is) { if (is->paused) { is->frame_timer += av_gettime_relative() / 1000000.0 - is->vidclk.last_updated; if (is->read_pause_return != AVERROR(ENOSYS)) { is->vidclk.paused = 0; } set_clock(&is->vidclk, get_clock(&is->vidclk), is->vidclk.serial); } set_clock(&is->extclk, get_clock(&is->extclk), is->extclk.serial); is->paused = is->audclk.paused = is->vidclk.paused = is->extclk.paused = !is->paused; } static void toggle_pause(VideoState *is) { stream_toggle_pause(is); is->step = 0; } static void toggle_mute(VideoState *is) { is->muted = !is->muted; } static void update_volume(VideoState *is, int sign, double step) { double volume_level = is->audio_volume ? (20 * log(is->audio_volume / (double)SDL_MIX_MAXVOLUME) / log(10)) : -1000.0; int new_volume = lrint(SDL_MIX_MAXVOLUME * pow(10.0, (volume_level + sign * step) / 20.0)); is->audio_volume = av_clip(is->audio_volume == new_volume ? (is->audio_volume + sign) : new_volume, 0, SDL_MIX_MAXVOLUME); } static void step_to_next_frame(VideoState *is) { /* if the stream is paused unpause it, then step */ if (is->paused) stream_toggle_pause(is); is->step = 1; } static double compute_target_delay(double delay, VideoState *is) { double sync_threshold, diff = 0; /* update delay to follow master synchronisation source */ if (get_master_sync_type(is) != AV_SYNC_VIDEO_MASTER) { /* if video is slave, we try to correct big delays by duplicating or deleting a frame */ diff = get_clock(&is->vidclk) - get_master_clock(is); /* skip or repeat frame. We take into account the delay to compute the threshold. I still don't know if it is the best guess */ sync_threshold = FFMAX(AV_SYNC_THRESHOLD_MIN, FFMIN(AV_SYNC_THRESHOLD_MAX, delay)); if (!isnan(diff) && fabs(diff) max_frame_duration) { if (diff = sync_threshold && delay > AV_SYNC_FRAMEDUP_THRESHOLD) delay = delay + diff; else if (diff >= sync_threshold) delay = 2 * delay; } } av_log(NULL, AV_LOG_TRACE, \"video: delay=%0.3f A-V=%f\\n\", delay, -diff); return delay; } static double vp_duration(VideoState *is, Frame *vp, Frame *nextvp) { if (vp->serial == nextvp->serial) { double duration = nextvp->pts - vp->pts; if (isnan(duration) || duration is->max_frame_duration) return vp->duration; else return duration; } else { return 0.0; } } static void update_video_pts(VideoState *is, double pts, int64_t pos, int serial) { /* update current video pts */ set_clock(&is->vidclk, pts, serial); sync_clock_to_slave(&is->extclk, &is->vidclk); } /* called to display each frame */ static void video_refresh(void *opaque, double *remaining_time) { VideoState *is = opaque; double time; Frame *sp, *sp2; if (!is->paused && get_master_sync_type(is) == AV_SYNC_EXTERNAL_CLOCK && is->realtime) check_external_clock_speed(is); if (!display_disable && is->show_mode != SHOW_MODE_VIDEO && is->audio_st) { time = av_gettime_relative() / 1000000.0; if (is->force_refresh || is->last_vis_time + rdftspeed last_vis_time = time; } *remaining_time = FFMIN(*remaining_time, is->last_vis_time + rdftspeed - time); } if (is->video_st) { retry: if (frame_queue_nb_remaining(&is->pictq) == 0) { // nothing to do, no picture to display in the queue } else { double last_duration, duration, delay; Frame *vp, *lastvp; /* dequeue the picture */ lastvp = frame_queue_peek_last(&is->pictq); vp = frame_queue_peek(&is->pictq); if (vp->serial != is->videoq.serial) { frame_queue_next(&is->pictq); goto retry; } if (lastvp->serial != vp->serial) is->frame_timer = av_gettime_relative() / 1000000.0; if (is->paused) goto display; /* compute nominal last_duration */ last_duration = vp_duration(is, lastvp, vp); delay = compute_target_delay(last_duration, is); time= av_gettime_relative()/1000000.0; if (time frame_timer + delay) { *remaining_time = FFMIN(is->frame_timer + delay - time, *remaining_time); goto display; } is->frame_timer += delay; if (delay > 0 && time - is->frame_timer > AV_SYNC_THRESHOLD_MAX) is->frame_timer = time; SDL_LockMutex(is->pictq.mutex); if (!isnan(vp->pts)) update_video_pts(is, vp->pts, vp->pos, vp->serial); SDL_UnlockMutex(is->pictq.mutex); if (frame_queue_nb_remaining(&is->pictq) > 1) { Frame *nextvp = frame_queue_peek_next(&is->pictq); duration = vp_duration(is, vp, nextvp); if(!is->step && (framedrop>0 || (framedrop && get_master_sync_type(is) != AV_SYNC_VIDEO_MASTER)) && time > is->frame_timer + duration){ is->frame_drops_late++; frame_queue_next(&is->pictq); goto retry; } } if (is->subtitle_st) { while (frame_queue_nb_remaining(&is->subpq) > 0) { sp = frame_queue_peek(&is->subpq); if (frame_queue_nb_remaining(&is->subpq) > 1) sp2 = frame_queue_peek_next(&is->subpq); else sp2 = NULL; if (sp->serial != is->subtitleq.serial || (is->vidclk.pts > (sp->pts + ((float) sp->sub.end_display_time / 1000))) || (sp2 && is->vidclk.pts > (sp2->pts + ((float) sp2->sub.start_display_time / 1000)))) { if (sp->uploaded) { int i; for (i = 0; i sub.num_rects; i++) { AVSubtitleRect *sub_rect = sp->sub.rects[i]; uint8_t *pixels; int pitch, j; if (!SDL_LockTexture(is->sub_texture, (SDL_Rect *)sub_rect, (void **)&pixels, &pitch)) { for (j = 0; j h; j++, pixels += pitch) memset(pixels, 0, sub_rect->w sub_texture); } } } frame_queue_next(&is->subpq); } else { break; } } } frame_queue_next(&is->pictq); is->force_refresh = 1; if (is->step && !is->paused) stream_toggle_pause(is); } display: /* display picture */ if (!display_disable && is->force_refresh && is->show_mode == SHOW_MODE_VIDEO && is->pictq.rindex_shown) video_display(is); } is->force_refresh = 0; if (show_status) { static int64_t last_time; int64_t cur_time; int aqsize, vqsize, sqsize; double av_diff; cur_time = av_gettime_relative(); if (!last_time || (cur_time - last_time) >= 30000) { aqsize = 0; vqsize = 0; sqsize = 0; if (is->audio_st) aqsize = is->audioq.size; if (is->video_st) vqsize = is->videoq.size; if (is->subtitle_st) sqsize = is->subtitleq.size; av_diff = 0; if (is->audio_st && is->video_st) av_diff = get_clock(&is->audclk) - get_clock(&is->vidclk); else if (is->video_st) av_diff = get_master_clock(is) - get_clock(&is->vidclk); else if (is->audio_st) av_diff = get_master_clock(is) - get_clock(&is->audclk); av_log(NULL, AV_LOG_INFO, \"%7.2f %s:%7.3f fd=%4d aq=%5dKB vq=%5dKB sq=%5dB f=%\"PRId64\"/%\"PRId64\" \\r\", get_master_clock(is), (is->audio_st && is->video_st) ? \"A-V\" : (is->video_st ? \"M-V\" : (is->audio_st ? \"M-A\" : \" \")), av_diff, is->frame_drops_early + is->frame_drops_late, aqsize / 1024, vqsize / 1024, sqsize, is->video_st ? is->viddec.avctx->pts_correction_num_faulty_dts : 0, is->video_st ? is->viddec.avctx->pts_correction_num_faulty_pts : 0); fflush(stdout); last_time = cur_time; } } } static int queue_picture(VideoState *is, AVFrame *src_frame, double pts, double duration, int64_t pos, int serial) { Frame *vp; #if defined(DEBUG_SYNC) printf(\"frame_type=%c pts=%0.3f\\n\", av_get_picture_type_char(src_frame->pict_type), pts); #endif if (!(vp = frame_queue_peek_writable(&is->pictq))) return -1; vp->sar = src_frame->sample_aspect_ratio; vp->uploaded = 0; vp->width = src_frame->width; vp->height = src_frame->height; vp->format = src_frame->format; vp->pts = pts; vp->duration = duration; vp->pos = pos; vp->serial = serial; set_default_window_size(vp->width, vp->height, vp->sar); av_frame_move_ref(vp->frame, src_frame); frame_queue_push(&is->pictq); return 0; } static int get_video_frame(VideoState *is, AVFrame *frame) { int got_picture; if ((got_picture = decoder_decode_frame(&is->viddec, frame, NULL)) pts != AV_NOPTS_VALUE) dpts = av_q2d(is->video_st->time_base) * frame->pts; frame->sample_aspect_ratio = av_guess_sample_aspect_ratio(is->ic, is->video_st, frame); if (framedrop>0 || (framedrop && get_master_sync_type(is) != AV_SYNC_VIDEO_MASTER)) { if (frame->pts != AV_NOPTS_VALUE) { double diff = dpts - get_master_clock(is); if (!isnan(diff) && fabs(diff) frame_last_filter_delay viddec.pkt_serial == is->vidclk.serial && is->videoq.nb_packets) { is->frame_drops_early++; av_frame_unref(frame); got_picture = 0; } } } } return got_picture; } #if CONFIG_AVFILTER static int configure_filtergraph(AVFilterGraph *graph, const char *filtergraph, AVFilterContext *source_ctx, AVFilterContext *sink_ctx) { int ret, i; int nb_filters = graph->nb_filters; AVFilterInOut *outputs = NULL, *inputs = NULL; if (filtergraph) { outputs = avfilter_inout_alloc(); inputs = avfilter_inout_alloc(); if (!outputs || !inputs) { ret = AVERROR(ENOMEM); goto fail; } outputs->name = av_strdup(\"in\"); outputs->filter_ctx = source_ctx; outputs->pad_idx = 0; outputs->next = NULL; inputs->name = av_strdup(\"out\"); inputs->filter_ctx = sink_ctx; inputs->pad_idx = 0; inputs->next = NULL; if ((ret = avfilter_graph_parse_ptr(graph, filtergraph, &inputs, &outputs, NULL)) nb_filters - nb_filters; i++) FFSWAP(AVFilterContext*, graph->filters[i], graph->filters[i + nb_filters]); ret = avfilter_graph_config(graph, NULL); fail: avfilter_inout_free(&outputs); avfilter_inout_free(&inputs); return ret; } static int configure_video_filters(AVFilterGraph *graph, VideoState *is, const char *vfilters, AVFrame *frame) { enum AVPixelFormat pix_fmts[FF_ARRAY_ELEMS(sdl_texture_format_map)]; char sws_flags_str[512] = \"\"; char buffersrc_args[256]; int ret; AVFilterContext *filt_src = NULL, *filt_out = NULL, *last_filter = NULL; AVCodecParameters *codecpar = is->video_st->codecpar; AVRational fr = av_guess_frame_rate(is->ic, is->video_st, NULL); AVDictionaryEntry *e = NULL; int nb_pix_fmts = 0; int i, j; for (i = 0; i key, \"sws_flags\")) { av_strlcatf(sws_flags_str, sizeof(sws_flags_str), \"%s=%s:\", \"flags\", e->value); } else av_strlcatf(sws_flags_str, sizeof(sws_flags_str), \"%s=%s:\", e->key, e->value); } if (strlen(sws_flags_str)) sws_flags_str[strlen(sws_flags_str)-1] = '\\0'; graph->scale_sws_opts = av_strdup(sws_flags_str); snprintf(buffersrc_args, sizeof(buffersrc_args), \"video_size=%dx%d:pix_fmt=%d:time_base=%d/%d:pixel_aspect=%d/%d\", frame->width, frame->height, frame->format, is->video_st->time_base.num, is->video_st->time_base.den, codecpar->sample_aspect_ratio.num, FFMAX(codecpar->sample_aspect_ratio.den, 1)); if (fr.num && fr.den) av_strlcatf(buffersrc_args, sizeof(buffersrc_args), \":frame_rate=%d/%d\", fr.num, fr.den); if ((ret = avfilter_graph_create_filter(&filt_src, avfilter_get_by_name(\"buffer\"), \"ffplay_buffer\", buffersrc_args, NULL, graph)) video_st); if (fabs(theta - 90) 1.0) { char rotate_buf[64]; snprintf(rotate_buf, sizeof(rotate_buf), \"%f*PI/180\", theta); INSERT_FILT(\"rotate\", rotate_buf); } } if ((ret = configure_filtergraph(graph, vfilters, filt_src, last_filter)) in_video_filter = filt_src; is->out_video_filter = filt_out; fail: return ret; } static int configure_audio_filters(VideoState *is, const char *afilters, int force_output_format) { static const enum AVSampleFormat sample_fmts[] = { AV_SAMPLE_FMT_S16, AV_SAMPLE_FMT_NONE }; int sample_rates[2] = { 0, -1 }; int64_t channel_layouts[2] = { 0, -1 }; int channels[2] = { 0, -1 }; AVFilterContext *filt_asrc = NULL, *filt_asink = NULL; char aresample_swr_opts[512] = \"\"; AVDictionaryEntry *e = NULL; char asrc_args[256]; int ret; avfilter_graph_free(&is->agraph); if (!(is->agraph = avfilter_graph_alloc())) return AVERROR(ENOMEM); is->agraph->nb_threads = filter_nbthreads; while ((e = av_dict_get(swr_opts, \"\", e, AV_DICT_IGNORE_SUFFIX))) av_strlcatf(aresample_swr_opts, sizeof(aresample_swr_opts), \"%s=%s:\", e->key, e->value); if (strlen(aresample_swr_opts)) aresample_swr_opts[strlen(aresample_swr_opts)-1] = '\\0'; av_opt_set(is->agraph, \"aresample_swr_opts\", aresample_swr_opts, 0); ret = snprintf(asrc_args, sizeof(asrc_args), \"sample_rate=%d:sample_fmt=%s:channels=%d:time_base=%d/%d\", is->audio_filter_src.freq, av_get_sample_fmt_name(is->audio_filter_src.fmt), is->audio_filter_src.channels, 1, is->audio_filter_src.freq); if (is->audio_filter_src.channel_layout) snprintf(asrc_args + ret, sizeof(asrc_args) - ret, \":channel_layout=0x%\"PRIx64, is->audio_filter_src.channel_layout); ret = avfilter_graph_create_filter(&filt_asrc, avfilter_get_by_name(\"abuffer\"), \"ffplay_abuffer\", asrc_args, NULL, is->agraph); if (ret agraph); if (ret audio_tgt.channel_layout; channels [0] = is->audio_tgt.channels; sample_rates [0] = is->audio_tgt.freq; if ((ret = av_opt_set_int(filt_asink, \"all_channel_counts\", 0, AV_OPT_SEARCH_CHILDREN)) agraph, afilters, filt_asrc, filt_asink)) in_audio_filter = filt_asrc; is->out_audio_filter = filt_asink; end: if (ret agraph); return ret; } #endif /* CONFIG_AVFILTER */ static int audio_thread(void *arg) { VideoState *is = arg; AVFrame *frame = av_frame_alloc(); Frame *af; #if CONFIG_AVFILTER int last_serial = -1; int64_t dec_channel_layout; int reconfigure; #endif int got_frame = 0; AVRational tb; int ret = 0; if (!frame) return AVERROR(ENOMEM); do { if ((got_frame = decoder_decode_frame(&is->auddec, frame, NULL)) sample_rate}; #if CONFIG_AVFILTER dec_channel_layout = get_valid_channel_layout(frame->channel_layout, frame->channels); reconfigure = cmp_audio_fmts(is->audio_filter_src.fmt, is->audio_filter_src.channels, frame->format, frame->channels) || is->audio_filter_src.channel_layout != dec_channel_layout || is->audio_filter_src.freq != frame->sample_rate || is->auddec.pkt_serial != last_serial; if (reconfigure) { char buf1[1024], buf2[1024]; av_get_channel_layout_string(buf1, sizeof(buf1), -1, is->audio_filter_src.channel_layout); av_get_channel_layout_string(buf2, sizeof(buf2), -1, dec_channel_layout); av_log(NULL, AV_LOG_DEBUG, \"Audio frame changed from rate:%d ch:%d fmt:%s layout:%s serial:%d to rate:%d ch:%d fmt:%s layout:%s serial:%d\\n\", is->audio_filter_src.freq, is->audio_filter_src.channels, av_get_sample_fmt_name(is->audio_filter_src.fmt), buf1, last_serial, frame->sample_rate, frame->channels, av_get_sample_fmt_name(frame->format), buf2, is->auddec.pkt_serial); is->audio_filter_src.fmt = frame->format; is->audio_filter_src.channels = frame->channels; is->audio_filter_src.channel_layout = dec_channel_layout; is->audio_filter_src.freq = frame->sample_rate; last_serial = is->auddec.pkt_serial; if ((ret = configure_audio_filters(is, afilters, 1)) in_audio_filter, frame)) out_audio_filter, frame, 0)) >= 0) { tb = av_buffersink_get_time_base(is->out_audio_filter); #endif if (!(af = frame_queue_peek_writable(&is->sampq))) goto the_end; af->pts = (frame->pts == AV_NOPTS_VALUE) ? NAN : frame->pts * av_q2d(tb); af->pos = frame->pkt_pos; af->serial = is->auddec.pkt_serial; af->duration = av_q2d((AVRational){frame->nb_samples, frame->sample_rate}); av_frame_move_ref(af->frame, frame); frame_queue_push(&is->sampq); #if CONFIG_AVFILTER if (is->audioq.serial != is->auddec.pkt_serial) break; } if (ret == AVERROR_EOF) is->auddec.finished = is->auddec.pkt_serial; #endif } } while (ret >= 0 || ret == AVERROR(EAGAIN) || ret == AVERROR_EOF); the_end: #if CONFIG_AVFILTER avfilter_graph_free(&is->agraph); #endif av_frame_free(&frame); return ret; } static int decoder_start(Decoder *d, int (*fn)(void *), const char *thread_name, void* arg) { packet_queue_start(d->queue); d->decoder_tid = SDL_CreateThread(fn, thread_name, arg); if (!d->decoder_tid) { av_log(NULL, AV_LOG_ERROR, \"SDL_CreateThread(): %s\\n\", SDL_GetError()); return AVERROR(ENOMEM); } return 0; } static int video_thread(void *arg) { VideoState *is = arg; AVFrame *frame = av_frame_alloc(); double pts; double duration; int ret; AVRational tb = is->video_st->time_base; AVRational frame_rate = av_guess_frame_rate(is->ic, is->video_st, NULL); #if CONFIG_AVFILTER AVFilterGraph *graph = NULL; AVFilterContext *filt_out = NULL, *filt_in = NULL; int last_w = 0; int last_h = 0; enum AVPixelFormat last_format = -2; int last_serial = -1; int last_vfilter_idx = 0; #endif if (!frame) return AVERROR(ENOMEM); for (;;) { ret = get_video_frame(is, frame); if (ret width || last_h != frame->height || last_format != frame->format || last_serial != is->viddec.pkt_serial || last_vfilter_idx != is->vfilter_idx) { av_log(NULL, AV_LOG_DEBUG, \"Video frame changed from size:%dx%d format:%s serial:%d to size:%dx%d format:%s serial:%d\\n\", last_w, last_h, (const char *)av_x_if_null(av_get_pix_fmt_name(last_format), \"none\"), last_serial, frame->width, frame->height, (const char *)av_x_if_null(av_get_pix_fmt_name(frame->format), \"none\"), is->viddec.pkt_serial); avfilter_graph_free(&graph); graph = avfilter_graph_alloc(); if (!graph) { ret = AVERROR(ENOMEM); goto the_end; } graph->nb_threads = filter_nbthreads; if ((ret = configure_video_filters(graph, is, vfilters_list ? vfilters_list[is->vfilter_idx] : NULL, frame)) in_video_filter; filt_out = is->out_video_filter; last_w = frame->width; last_h = frame->height; last_format = frame->format; last_serial = is->viddec.pkt_serial; last_vfilter_idx = is->vfilter_idx; frame_rate = av_buffersink_get_frame_rate(filt_out); } ret = av_buffersrc_add_frame(filt_in, frame); if (ret = 0) { is->frame_last_returned_time = av_gettime_relative() / 1000000.0; ret = av_buffersink_get_frame_flags(filt_out, frame, 0); if (ret viddec.finished = is->viddec.pkt_serial; ret = 0; break; } is->frame_last_filter_delay = av_gettime_relative() / 1000000.0 - is->frame_last_returned_time; if (fabs(is->frame_last_filter_delay) > AV_NOSYNC_THRESHOLD / 10.0) is->frame_last_filter_delay = 0; tb = av_buffersink_get_time_base(filt_out); #endif duration = (frame_rate.num && frame_rate.den ? av_q2d((AVRational){frame_rate.den, frame_rate.num}) : 0); pts = (frame->pts == AV_NOPTS_VALUE) ? NAN : frame->pts * av_q2d(tb); ret = queue_picture(is, frame, pts, duration, frame->pkt_pos, is->viddec.pkt_serial); av_frame_unref(frame); #if CONFIG_AVFILTER if (is->videoq.serial != is->viddec.pkt_serial) break; } #endif if (ret subpq))) return 0; if ((got_subtitle = decoder_decode_frame(&is->subdec, NULL, &sp->sub)) sub.format == 0) { if (sp->sub.pts != AV_NOPTS_VALUE) pts = sp->sub.pts / (double)AV_TIME_BASE; sp->pts = pts; sp->serial = is->subdec.pkt_serial; sp->width = is->subdec.avctx->width; sp->height = is->subdec.avctx->height; sp->uploaded = 0; /* now we can update the picture count */ frame_queue_push(&is->subpq); } else if (got_subtitle) { avsubtitle_free(&sp->sub); } } return 0; } /* copy samples for viewing in editor window */ static void update_sample_display(VideoState *is, short *samples, int samples_size) { int size, len; size = samples_size / sizeof(short); while (size > 0) { len = SAMPLE_ARRAY_SIZE - is->sample_array_index; if (len > size) len = size; memcpy(is->sample_array + is->sample_array_index, samples, len * sizeof(short)); samples += len; is->sample_array_index += len; if (is->sample_array_index >= SAMPLE_ARRAY_SIZE) is->sample_array_index = 0; size -= len; } } /* return the wanted number of samples to get better sync if sync_type is video * or external master clock */ static int synchronize_audio(VideoState *is, int nb_samples) { int wanted_nb_samples = nb_samples; /* if not master, then we try to remove or add samples to correct the clock */ if (get_master_sync_type(is) != AV_SYNC_AUDIO_MASTER) { double diff, avg_diff; int min_nb_samples, max_nb_samples; diff = get_clock(&is->audclk) - get_master_clock(is); if (!isnan(diff) && fabs(diff) audio_diff_cum = diff + is->audio_diff_avg_coef * is->audio_diff_cum; if (is->audio_diff_avg_count audio_diff_avg_count++; } else { /* estimate the A-V difference */ avg_diff = is->audio_diff_cum * (1.0 - is->audio_diff_avg_coef); if (fabs(avg_diff) >= is->audio_diff_threshold) { wanted_nb_samples = nb_samples + (int)(diff * is->audio_src.freq); min_nb_samples = ((nb_samples * (100 - SAMPLE_CORRECTION_PERCENT_MAX) / 100)); max_nb_samples = ((nb_samples * (100 + SAMPLE_CORRECTION_PERCENT_MAX) / 100)); wanted_nb_samples = av_clip(wanted_nb_samples, min_nb_samples, max_nb_samples); } av_log(NULL, AV_LOG_TRACE, \"diff=%f adiff=%f sample_diff=%d apts=%0.3f %f\\n\", diff, avg_diff, wanted_nb_samples - nb_samples, is->audio_clock, is->audio_diff_threshold); } } else { /* too big difference : may be initial PTS errors, so reset A-V filter */ is->audio_diff_avg_count = 0; is->audio_diff_cum = 0; } } return wanted_nb_samples; } /** * Decode one audio frame and return its uncompressed size. * * The processed audio frame is decoded, converted if required, and * stored in is->audio_buf, with size in bytes given by the return * value. */ static int audio_decode_frame(VideoState *is) { int data_size, resampled_data_size; int64_t dec_channel_layout; av_unused double audio_clock0; int wanted_nb_samples; Frame *af; if (is->paused) return -1; do { #if defined(_WIN32) while (frame_queue_nb_remaining(&is->sampq) == 0) { if ((av_gettime_relative() - audio_callback_time) > 1000000LL * is->audio_hw_buf_size / is->audio_tgt.bytes_per_sec / 2) return -1; av_usleep (1000); } #endif if (!(af = frame_queue_peek_readable(&is->sampq))) return -1; frame_queue_next(&is->sampq); } while (af->serial != is->audioq.serial); data_size = av_samples_get_buffer_size(NULL, af->frame->channels, af->frame->nb_samples, af->frame->format, 1); dec_channel_layout = (af->frame->channel_layout && af->frame->channels == av_get_channel_layout_nb_channels(af->frame->channel_layout)) ? af->frame->channel_layout : av_get_default_channel_layout(af->frame->channels); wanted_nb_samples = synchronize_audio(is, af->frame->nb_samples); if (af->frame->format != is->audio_src.fmt || dec_channel_layout != is->audio_src.channel_layout || af->frame->sample_rate != is->audio_src.freq || (wanted_nb_samples != af->frame->nb_samples && !is->swr_ctx)) { swr_free(&is->swr_ctx); is->swr_ctx = swr_alloc_set_opts(NULL, is->audio_tgt.channel_layout, is->audio_tgt.fmt, is->audio_tgt.freq, dec_channel_layout, af->frame->format, af->frame->sample_rate, 0, NULL); if (!is->swr_ctx || swr_init(is->swr_ctx) frame->sample_rate, av_get_sample_fmt_name(af->frame->format), af->frame->channels, is->audio_tgt.freq, av_get_sample_fmt_name(is->audio_tgt.fmt), is->audio_tgt.channels); swr_free(&is->swr_ctx); return -1; } is->audio_src.channel_layout = dec_channel_layout; is->audio_src.channels = af->frame->channels; is->audio_src.freq = af->frame->sample_rate; is->audio_src.fmt = af->frame->format; } if (is->swr_ctx) { const uint8_t **in = (const uint8_t **)af->frame->extended_data; uint8_t **out = &is->audio_buf1; int out_count = (int64_t)wanted_nb_samples * is->audio_tgt.freq / af->frame->sample_rate + 256; int out_size = av_samples_get_buffer_size(NULL, is->audio_tgt.channels, out_count, is->audio_tgt.fmt, 0); int len2; if (out_size frame->nb_samples) { if (swr_set_compensation(is->swr_ctx, (wanted_nb_samples - af->frame->nb_samples) * is->audio_tgt.freq / af->frame->sample_rate, wanted_nb_samples * is->audio_tgt.freq / af->frame->sample_rate) audio_buf1, &is->audio_buf1_size, out_size); if (!is->audio_buf1) return AVERROR(ENOMEM); len2 = swr_convert(is->swr_ctx, out, out_count, in, af->frame->nb_samples); if (len2 swr_ctx) swr_ctx); } is->audio_buf = is->audio_buf1; resampled_data_size = len2 * is->audio_tgt.channels * av_get_bytes_per_sample(is->audio_tgt.fmt); } else { is->audio_buf = af->frame->data[0]; resampled_data_size = data_size; } audio_clock0 = is->audio_clock; /* update the audio clock with the pts */ if (!isnan(af->pts)) is->audio_clock = af->pts + (double) af->frame->nb_samples / af->frame->sample_rate; else is->audio_clock = NAN; is->audio_clock_serial = af->serial; #ifdef DEBUG { static double last_clock; printf(\"audio: delay=%0.3f clock=%0.3f clock0=%0.3f\\n\", is->audio_clock - last_clock, is->audio_clock, audio_clock0); last_clock = is->audio_clock; } #endif return resampled_data_size; } /* prepare a new audio buffer */ static void sdl_audio_callback(void *opaque, Uint8 *stream, int len) { VideoState *is = opaque; int audio_size, len1; audio_callback_time = av_gettime_relative(); while (len > 0) { if (is->audio_buf_index >= is->audio_buf_size) { audio_size = audio_decode_frame(is); if (audio_size audio_buf = NULL; is->audio_buf_size = SDL_AUDIO_MIN_BUFFER_SIZE / is->audio_tgt.frame_size * is->audio_tgt.frame_size; } else { if (is->show_mode != SHOW_MODE_VIDEO) update_sample_display(is, (int16_t *)is->audio_buf, audio_size); is->audio_buf_size = audio_size; } is->audio_buf_index = 0; } len1 = is->audio_buf_size - is->audio_buf_index; if (len1 > len) len1 = len; if (!is->muted && is->audio_buf && is->audio_volume == SDL_MIX_MAXVOLUME) memcpy(stream, (uint8_t *)is->audio_buf + is->audio_buf_index, len1); else { memset(stream, 0, len1); if (!is->muted && is->audio_buf) SDL_MixAudioFormat(stream, (uint8_t *)is->audio_buf + is->audio_buf_index, AUDIO_S16SYS, len1, is->audio_volume); } len -= len1; stream += len1; is->audio_buf_index += len1; } is->audio_write_buf_size = is->audio_buf_size - is->audio_buf_index; /* Let's assume the audio driver that is used by SDL has two periods. */ if (!isnan(is->audio_clock)) { set_clock_at(&is->audclk, is->audio_clock - (double)(2 * is->audio_hw_buf_size + is->audio_write_buf_size) / is->audio_tgt.bytes_per_sec, is->audio_clock_serial, audio_callback_time / 1000000.0); sync_clock_to_slave(&is->extclk, &is->audclk); } } static int audio_open(void *opaque, int64_t wanted_channel_layout, int wanted_nb_channels, int wanted_sample_rate, struct AudioParams *audio_hw_params) { SDL_AudioSpec wanted_spec, spec; const char *env; static const int next_nb_channels[] = {0, 0, 1, 6, 2, 6, 4, 6}; static const int next_sample_rates[] = {0, 44100, 48000, 96000, 192000}; int next_sample_rate_idx = FF_ARRAY_ELEMS(next_sample_rates) - 1; env = SDL_getenv(\"SDL_AUDIO_CHANNELS\"); if (env) { wanted_nb_channels = atoi(env); wanted_channel_layout = av_get_default_channel_layout(wanted_nb_channels); } if (!wanted_channel_layout || wanted_nb_channels != av_get_channel_layout_nb_channels(wanted_channel_layout)) { wanted_channel_layout = av_get_default_channel_layout(wanted_nb_channels); wanted_channel_layout &= ~AV_CH_LAYOUT_STEREO_DOWNMIX; } wanted_nb_channels = av_get_channel_layout_nb_channels(wanted_channel_layout); wanted_spec.channels = wanted_nb_channels; wanted_spec.freq = wanted_sample_rate; if (wanted_spec.freq = wanted_spec.freq) next_sample_rate_idx--; wanted_spec.format = AUDIO_S16SYS; wanted_spec.silence = 0; wanted_spec.samples = FFMAX(SDL_AUDIO_MIN_BUFFER_SIZE, 2 fmt = AV_SAMPLE_FMT_S16; audio_hw_params->freq = spec.freq; audio_hw_params->channel_layout = wanted_channel_layout; audio_hw_params->channels = spec.channels; audio_hw_params->frame_size = av_samples_get_buffer_size(NULL, audio_hw_params->channels, 1, audio_hw_params->fmt, 1); audio_hw_params->bytes_per_sec = av_samples_get_buffer_size(NULL, audio_hw_params->channels, audio_hw_params->freq, audio_hw_params->fmt, 1); if (audio_hw_params->bytes_per_sec frame_size ic; AVCodecContext *avctx; AVCodec *codec; const char *forced_codec_name = NULL; AVDictionary *opts = NULL; AVDictionaryEntry *t = NULL; int sample_rate, nb_channels; int64_t channel_layout; int ret = 0; int stream_lowres = lowres; if (stream_index = ic->nb_streams) return -1; avctx = avcodec_alloc_context3(NULL); if (!avctx) return AVERROR(ENOMEM); ret = avcodec_parameters_to_context(avctx, ic->streams[stream_index]->codecpar); if (ret pkt_timebase = ic->streams[stream_index]->time_base; codec = avcodec_find_decoder(avctx->codec_id); switch(avctx->codec_type){ case AVMEDIA_TYPE_AUDIO : is->last_audio_stream = stream_index; forced_codec_name = audio_codec_name; break; case AVMEDIA_TYPE_SUBTITLE: is->last_subtitle_stream = stream_index; forced_codec_name = subtitle_codec_name; break; case AVMEDIA_TYPE_VIDEO : is->last_video_stream = stream_index; forced_codec_name = video_codec_name; break; } if (forced_codec_name) codec = avcodec_find_decoder_by_name(forced_codec_name); if (!codec) { if (forced_codec_name) av_log(NULL, AV_LOG_WARNING, \"No codec could be found with name '%s'\\n\", forced_codec_name); else av_log(NULL, AV_LOG_WARNING, \"No decoder could be found for codec %s\\n\", avcodec_get_name(avctx->codec_id)); ret = AVERROR(EINVAL); goto fail; } avctx->codec_id = codec->id; if (stream_lowres > codec->max_lowres) { av_log(avctx, AV_LOG_WARNING, \"The maximum value for lowres supported by the decoder is %d\\n\", codec->max_lowres); stream_lowres = codec->max_lowres; } avctx->lowres = stream_lowres; if (fast) avctx->flags2 |= AV_CODEC_FLAG2_FAST; opts = filter_codec_opts(codec_opts, avctx->codec_id, ic, ic->streams[stream_index], codec); if (!av_dict_get(opts, \"threads\", NULL, 0)) av_dict_set(&opts, \"threads\", \"auto\", 0); if (stream_lowres) av_dict_set_int(&opts, \"lowres\", stream_lowres, 0); if (avctx->codec_type == AVMEDIA_TYPE_VIDEO || avctx->codec_type == AVMEDIA_TYPE_AUDIO) av_dict_set(&opts, \"refcounted_frames\", \"1\", 0); if ((ret = avcodec_open2(avctx, codec, &opts)) key); ret = AVERROR_OPTION_NOT_FOUND; goto fail; } is->eof = 0; ic->streams[stream_index]->discard = AVDISCARD_DEFAULT; switch (avctx->codec_type) { case AVMEDIA_TYPE_AUDIO: #if CONFIG_AVFILTER { AVFilterContext *sink; is->audio_filter_src.freq = avctx->sample_rate; is->audio_filter_src.channels = avctx->channels; is->audio_filter_src.channel_layout = get_valid_channel_layout(avctx->channel_layout, avctx->channels); is->audio_filter_src.fmt = avctx->sample_fmt; if ((ret = configure_audio_filters(is, afilters, 0)) out_audio_filter; sample_rate = av_buffersink_get_sample_rate(sink); nb_channels = av_buffersink_get_channels(sink); channel_layout = av_buffersink_get_channel_layout(sink); } #else sample_rate = avctx->sample_rate; nb_channels = avctx->channels; channel_layout = avctx->channel_layout; #endif /* prepare audio output */ if ((ret = audio_open(is, channel_layout, nb_channels, sample_rate, &is->audio_tgt)) audio_hw_buf_size = ret; is->audio_src = is->audio_tgt; is->audio_buf_size = 0; is->audio_buf_index = 0; /* init averaging filter */ is->audio_diff_avg_coef = exp(log(0.01) / AUDIO_DIFF_AVG_NB); is->audio_diff_avg_count = 0; /* since we do not have a precise anough audio FIFO fullness, we correct audio sync only if larger than this threshold */ is->audio_diff_threshold = (double)(is->audio_hw_buf_size) / is->audio_tgt.bytes_per_sec; is->audio_stream = stream_index; is->audio_st = ic->streams[stream_index]; decoder_init(&is->auddec, avctx, &is->audioq, is->continue_read_thread); if ((is->ic->iformat->flags & (AVFMT_NOBINSEARCH | AVFMT_NOGENSEARCH | AVFMT_NO_BYTE_SEEK)) && !is->ic->iformat->read_seek) { is->auddec.start_pts = is->audio_st->start_time; is->auddec.start_pts_tb = is->audio_st->time_base; } if ((ret = decoder_start(&is->auddec, audio_thread, \"audio_decoder\", is)) video_stream = stream_index; is->video_st = ic->streams[stream_index]; decoder_init(&is->viddec, avctx, &is->videoq, is->continue_read_thread); if ((ret = decoder_start(&is->viddec, video_thread, \"video_decoder\", is)) queue_attachments_req = 1; break; case AVMEDIA_TYPE_SUBTITLE: is->subtitle_stream = stream_index; is->subtitle_st = ic->streams[stream_index]; decoder_init(&is->subdec, avctx, &is->subtitleq, is->continue_read_thread); if ((ret = decoder_start(&is->subdec, subtitle_thread, \"subtitle_decoder\", is)) abort_request; } static int stream_has_enough_packets(AVStream *st, int stream_id, PacketQueue *queue) { return stream_id abort_request || (st->disposition & AV_DISPOSITION_ATTACHED_PIC) || queue->nb_packets > MIN_FRAMES && (!queue->duration || av_q2d(st->time_base) * queue->duration > 1.0); } static int is_realtime(AVFormatContext *s) { if( !strcmp(s->iformat->name, \"rtp\") || !strcmp(s->iformat->name, \"rtsp\") || !strcmp(s->iformat->name, \"sdp\") ) return 1; if(s->pb && ( !strncmp(s->url, \"rtp:\", 4) || !strncmp(s->url, \"udp:\", 4) ) ) return 1; return 0; } /* this thread gets the stream from the disk or the network */ static int read_thread(void *arg) { VideoState *is = arg; AVFormatContext *ic = NULL; int err, i, ret; int st_index[AVMEDIA_TYPE_NB]; AVPacket pkt1, *pkt = &pkt1; int64_t stream_start_time; int pkt_in_play_range = 0; AVDictionaryEntry *t; SDL_mutex *wait_mutex = SDL_CreateMutex(); int scan_all_pmts_set = 0; int64_t pkt_ts; if (!wait_mutex) { av_log(NULL, AV_LOG_FATAL, \"SDL_CreateMutex(): %s\\n\", SDL_GetError()); ret = AVERROR(ENOMEM); goto fail; } memset(st_index, -1, sizeof(st_index)); is->eof = 0; ic = avformat_alloc_context(); if (!ic) { av_log(NULL, AV_LOG_FATAL, \"Could not allocate context.\\n\"); ret = AVERROR(ENOMEM); goto fail; } ic->interrupt_callback.callback = decode_interrupt_cb; ic->interrupt_callback.opaque = is; if (!av_dict_get(format_opts, \"scan_all_pmts\", NULL, AV_DICT_MATCH_CASE)) { av_dict_set(&format_opts, \"scan_all_pmts\", \"1\", AV_DICT_DONT_OVERWRITE); scan_all_pmts_set = 1; } err = avformat_open_input(&ic, is->filename, is->iformat, &format_opts); if (err filename, err); ret = -1; goto fail; } if (scan_all_pmts_set) av_dict_set(&format_opts, \"scan_all_pmts\", NULL, AV_DICT_MATCH_CASE); if ((t = av_dict_get(format_opts, \"\", NULL, AV_DICT_IGNORE_SUFFIX))) { av_log(NULL, AV_LOG_ERROR, \"Option %s not found.\\n\", t->key); ret = AVERROR_OPTION_NOT_FOUND; goto fail; } is->ic = ic; if (genpts) ic->flags |= AVFMT_FLAG_GENPTS; av_format_inject_global_side_data(ic); if (find_stream_info) { AVDictionary **opts = setup_find_stream_info_opts(ic, codec_opts); int orig_nb_streams = ic->nb_streams; err = avformat_find_stream_info(ic, opts); for (i = 0; i filename); ret = -1; goto fail; } } if (ic->pb) ic->pb->eof_reached = 0; // FIXME hack, ffplay maybe should not use avio_feof() to test for the end if (seek_by_bytes iformat->flags & AVFMT_TS_DISCONT) && strcmp(\"ogg\", ic->iformat->name); is->max_frame_duration = (ic->iformat->flags & AVFMT_TS_DISCONT) ? 10.0 : 3600.0; if (!window_title && (t = av_dict_get(ic->metadata, \"title\", NULL, 0))) window_title = av_asprintf(\"%s - %s\", t->value, input_filename); /* if seeking requested, we execute it */ if (start_time != AV_NOPTS_VALUE) { int64_t timestamp; timestamp = start_time; /* add the stream start time */ if (ic->start_time != AV_NOPTS_VALUE) timestamp += ic->start_time; ret = avformat_seek_file(ic, -1, INT64_MIN, timestamp, INT64_MAX, 0); if (ret filename, (double)timestamp / AV_TIME_BASE); } } is->realtime = is_realtime(ic); if (show_status) av_dump_format(ic, 0, is->filename, 0); for (i = 0; i nb_streams; i++) { AVStream *st = ic->streams[i]; enum AVMediaType type = st->codecpar->codec_type; st->discard = AVDISCARD_ALL; if (type >= 0 && wanted_stream_spec[type] && st_index[type] == -1) if (avformat_match_stream_specifier(ic, st, wanted_stream_spec[type]) > 0) st_index[type] = i; } for (i = 0; i = 0 ? st_index[AVMEDIA_TYPE_AUDIO] : st_index[AVMEDIA_TYPE_VIDEO]), NULL, 0); is->show_mode = show_mode; if (st_index[AVMEDIA_TYPE_VIDEO] >= 0) { AVStream *st = ic->streams[st_index[AVMEDIA_TYPE_VIDEO]]; AVCodecParameters *codecpar = st->codecpar; AVRational sar = av_guess_sample_aspect_ratio(ic, st, NULL); if (codecpar->width) set_default_window_size(codecpar->width, codecpar->height, sar); } /* open the streams */ if (st_index[AVMEDIA_TYPE_AUDIO] >= 0) { stream_component_open(is, st_index[AVMEDIA_TYPE_AUDIO]); } ret = -1; if (st_index[AVMEDIA_TYPE_VIDEO] >= 0) { ret = stream_component_open(is, st_index[AVMEDIA_TYPE_VIDEO]); } if (is->show_mode == SHOW_MODE_NONE) is->show_mode = ret >= 0 ? SHOW_MODE_VIDEO : SHOW_MODE_RDFT; if (st_index[AVMEDIA_TYPE_SUBTITLE] >= 0) { stream_component_open(is, st_index[AVMEDIA_TYPE_SUBTITLE]); } if (is->video_stream audio_stream filename); ret = -1; goto fail; } if (infinite_buffer realtime) infinite_buffer = 1; for (;;) { if (is->abort_request) break; if (is->paused != is->last_paused) { is->last_paused = is->paused; if (is->paused) is->read_pause_return = av_read_pause(ic); else av_read_play(ic); } #if CONFIG_RTSP_DEMUXER || CONFIG_MMSH_PROTOCOL if (is->paused && (!strcmp(ic->iformat->name, \"rtsp\") || (ic->pb && !strncmp(input_filename, \"mmsh:\", 5)))) { /* wait 10 ms to avoid trying to get another packet */ /* XXX: horrible */ SDL_Delay(10); continue; } #endif if (is->seek_req) { int64_t seek_target = is->seek_pos; int64_t seek_min = is->seek_rel > 0 ? seek_target - is->seek_rel + 2: INT64_MIN; int64_t seek_max = is->seek_rel seek_rel - 2: INT64_MAX; // FIXME the +-2 is due to rounding being not done in the correct direction in generation // of the seek_pos/seek_rel variables ret = avformat_seek_file(is->ic, -1, seek_min, seek_target, seek_max, is->seek_flags); if (ret ic->url); } else { if (is->audio_stream >= 0) { packet_queue_flush(&is->audioq); packet_queue_put(&is->audioq, &flush_pkt); } if (is->subtitle_stream >= 0) { packet_queue_flush(&is->subtitleq); packet_queue_put(&is->subtitleq, &flush_pkt); } if (is->video_stream >= 0) { packet_queue_flush(&is->videoq); packet_queue_put(&is->videoq, &flush_pkt); } if (is->seek_flags & AVSEEK_FLAG_BYTE) { set_clock(&is->extclk, NAN, 0); } else { set_clock(&is->extclk, seek_target / (double)AV_TIME_BASE, 0); } } is->seek_req = 0; is->queue_attachments_req = 1; is->eof = 0; if (is->paused) step_to_next_frame(is); } if (is->queue_attachments_req) { if (is->video_st && is->video_st->disposition & AV_DISPOSITION_ATTACHED_PIC) { AVPacket copy = { 0 }; if ((ret = av_packet_ref(&copy, &is->video_st->attached_pic)) videoq, &copy); packet_queue_put_nullpacket(&is->videoq, is->video_stream); } is->queue_attachments_req = 0; } /* if the queue are full, no need to read more */ if (infinite_bufferaudioq.size + is->videoq.size + is->subtitleq.size > MAX_QUEUE_SIZE || (stream_has_enough_packets(is->audio_st, is->audio_stream, &is->audioq) && stream_has_enough_packets(is->video_st, is->video_stream, &is->videoq) && stream_has_enough_packets(is->subtitle_st, is->subtitle_stream, &is->subtitleq)))) { /* wait 10 ms */ SDL_LockMutex(wait_mutex); SDL_CondWaitTimeout(is->continue_read_thread, wait_mutex, 10); SDL_UnlockMutex(wait_mutex); continue; } if (!is->paused && (!is->audio_st || (is->auddec.finished == is->audioq.serial && frame_queue_nb_remaining(&is->sampq) == 0)) && (!is->video_st || (is->viddec.finished == is->videoq.serial && frame_queue_nb_remaining(&is->pictq) == 0))) { if (loop != 1 && (!loop || --loop)) { stream_seek(is, start_time != AV_NOPTS_VALUE ? start_time : 0, 0, 0); } else if (autoexit) { ret = AVERROR_EOF; goto fail; } } ret = av_read_frame(ic, pkt); if (ret pb)) && !is->eof) { if (is->video_stream >= 0) packet_queue_put_nullpacket(&is->videoq, is->video_stream); if (is->audio_stream >= 0) packet_queue_put_nullpacket(&is->audioq, is->audio_stream); if (is->subtitle_stream >= 0) packet_queue_put_nullpacket(&is->subtitleq, is->subtitle_stream); is->eof = 1; } if (ic->pb && ic->pb->error) break; SDL_LockMutex(wait_mutex); SDL_CondWaitTimeout(is->continue_read_thread, wait_mutex, 10); SDL_UnlockMutex(wait_mutex); continue; } else { is->eof = 0; } /* check if packet is in play range specified by user, then queue, otherwise discard */ stream_start_time = ic->streams[pkt->stream_index]->start_time; pkt_ts = pkt->pts == AV_NOPTS_VALUE ? pkt->dts : pkt->pts; pkt_in_play_range = duration == AV_NOPTS_VALUE || (pkt_ts - (stream_start_time != AV_NOPTS_VALUE ? stream_start_time : 0)) * av_q2d(ic->streams[pkt->stream_index]->time_base) - (double)(start_time != AV_NOPTS_VALUE ? start_time : 0) / 1000000 stream_index == is->audio_stream && pkt_in_play_range) { packet_queue_put(&is->audioq, pkt); } else if (pkt->stream_index == is->video_stream && pkt_in_play_range && !(is->video_st->disposition & AV_DISPOSITION_ATTACHED_PIC)) { packet_queue_put(&is->videoq, pkt); } else if (pkt->stream_index == is->subtitle_stream && pkt_in_play_range) { packet_queue_put(&is->subtitleq, pkt); } else { av_packet_unref(pkt); } } ret = 0; fail: if (ic && !is->ic) avformat_close_input(&ic); if (ret != 0) { SDL_Event event; event.type = FF_QUIT_EVENT; event.user.data1 = is; SDL_PushEvent(&event); } SDL_DestroyMutex(wait_mutex); return 0; } static VideoState *stream_open(const char *filename, AVInputFormat *iformat) { VideoState *is; is = av_mallocz(sizeof(VideoState)); if (!is) return NULL; is->last_video_stream = is->video_stream = -1; is->last_audio_stream = is->audio_stream = -1; is->last_subtitle_stream = is->subtitle_stream = -1; is->filename = av_strdup(filename); if (!is->filename) goto fail; is->iformat = iformat; is->ytop = 0; is->xleft = 0; /* start video display */ if (frame_queue_init(&is->pictq, &is->videoq, VIDEO_PICTURE_QUEUE_SIZE, 1) subpq, &is->subtitleq, SUBPICTURE_QUEUE_SIZE, 0) sampq, &is->audioq, SAMPLE_QUEUE_SIZE, 1) videoq) audioq) subtitleq) continue_read_thread = SDL_CreateCond())) { av_log(NULL, AV_LOG_FATAL, \"SDL_CreateCond(): %s\\n\", SDL_GetError()); goto fail; } init_clock(&is->vidclk, &is->videoq.serial); init_clock(&is->audclk, &is->audioq.serial); init_clock(&is->extclk, &is->extclk.serial); is->audio_clock_serial = -1; if (startup_volume 100) av_log(NULL, AV_LOG_WARNING, \"-volume=%d > 100, setting to 100\\n\", startup_volume); startup_volume = av_clip(startup_volume, 0, 100); startup_volume = av_clip(SDL_MIX_MAXVOLUME * startup_volume / 100, 0, SDL_MIX_MAXVOLUME); is->audio_volume = startup_volume; is->muted = 0; is->av_sync_type = av_sync_type; is->read_tid = SDL_CreateThread(read_thread, \"read_thread\", is); if (!is->read_tid) { av_log(NULL, AV_LOG_FATAL, \"SDL_CreateThread(): %s\\n\", SDL_GetError()); fail: stream_close(is); return NULL; } return is; } static void stream_cycle_channel(VideoState *is, int codec_type) { AVFormatContext *ic = is->ic; int start_index, stream_index; int old_index; AVStream *st; AVProgram *p = NULL; int nb_streams = is->ic->nb_streams; if (codec_type == AVMEDIA_TYPE_VIDEO) { start_index = is->last_video_stream; old_index = is->video_stream; } else if (codec_type == AVMEDIA_TYPE_AUDIO) { start_index = is->last_audio_stream; old_index = is->audio_stream; } else { start_index = is->last_subtitle_stream; old_index = is->subtitle_stream; } stream_index = start_index; if (codec_type != AVMEDIA_TYPE_VIDEO && is->video_stream != -1) { p = av_find_program_from_stream(ic, NULL, is->video_stream); if (p) { nb_streams = p->nb_stream_indexes; for (start_index = 0; start_index stream_index[start_index] == stream_index) break; if (start_index == nb_streams) start_index = -1; stream_index = start_index; } } for (;;) { if (++stream_index >= nb_streams) { if (codec_type == AVMEDIA_TYPE_SUBTITLE) { stream_index = -1; is->last_subtitle_stream = -1; goto the_end; } if (start_index == -1) return; stream_index = 0; } if (stream_index == start_index) return; st = is->ic->streams[p ? p->stream_index[stream_index] : stream_index]; if (st->codecpar->codec_type == codec_type) { /* check that parameters are OK */ switch (codec_type) { case AVMEDIA_TYPE_AUDIO: if (st->codecpar->sample_rate != 0 && st->codecpar->channels != 0) goto the_end; break; case AVMEDIA_TYPE_VIDEO: case AVMEDIA_TYPE_SUBTITLE: goto the_end; default: break; } } } the_end: if (p && stream_index != -1) stream_index = p->stream_index[stream_index]; av_log(NULL, AV_LOG_INFO, \"Switch %s stream from #%d to #%d\\n\", av_get_media_type_string(codec_type), old_index, stream_index); stream_component_close(is, old_index); stream_component_open(is, stream_index); } static void toggle_full_screen(VideoState *is) { is_full_screen = !is_full_screen; SDL_SetWindowFullscreen(window, is_full_screen ? SDL_WINDOW_FULLSCREEN_DESKTOP : 0); } static void toggle_audio_display(VideoState *is) { int next = is->show_mode; do { next = (next + 1) % SHOW_MODE_NB; } while (next != is->show_mode && (next == SHOW_MODE_VIDEO && !is->video_st || next != SHOW_MODE_VIDEO && !is->audio_st)); if (is->show_mode != next) { is->force_refresh = 1; is->show_mode = next; } } static void refresh_loop_wait_event(VideoState *is, SDL_Event *event) { double remaining_time = 0.0; SDL_PumpEvents(); while (!SDL_PeepEvents(event, 1, SDL_GETEVENT, SDL_FIRSTEVENT, SDL_LASTEVENT)) { if (!cursor_hidden && av_gettime_relative() - cursor_last_shown > CURSOR_HIDE_DELAY) { SDL_ShowCursor(0); cursor_hidden = 1; } if (remaining_time > 0.0) av_usleep((int64_t)(remaining_time * 1000000.0)); remaining_time = REFRESH_RATE; if (is->show_mode != SHOW_MODE_NONE && (!is->paused || is->force_refresh)) video_refresh(is, &remaining_time); SDL_PumpEvents(); } } static void seek_chapter(VideoState *is, int incr) { int64_t pos = get_master_clock(is) * AV_TIME_BASE; int i; if (!is->ic->nb_chapters) return; /* find the current chapter */ for (i = 0; i ic->nb_chapters; i++) { AVChapter *ch = is->ic->chapters[i]; if (av_compare_ts(pos, AV_TIME_BASE_Q, ch->start, ch->time_base) = is->ic->nb_chapters) return; av_log(NULL, AV_LOG_VERBOSE, \"Seeking to chapter %d.\\n\", i); stream_seek(is, av_rescale_q(is->ic->chapters[i]->start, is->ic->chapters[i]->time_base, AV_TIME_BASE_Q), 0, 0); } /* handle an event sent by the GUI */ static void event_loop(VideoState *cur_stream) { SDL_Event event; double incr, pos, frac; for (;;) { double x; refresh_loop_wait_event(cur_stream, &event); switch (event.type) { case SDL_KEYDOWN: if (exit_on_keydown || event.key.keysym.sym == SDLK_ESCAPE || event.key.keysym.sym == SDLK_q) { do_exit(cur_stream); break; } // If we don't yet have a window, skip all key events, because read_thread might still be initializing... if (!cur_stream->width) continue; switch (event.key.keysym.sym) { case SDLK_f: toggle_full_screen(cur_stream); cur_stream->force_refresh = 1; break; case SDLK_p: case SDLK_SPACE: toggle_pause(cur_stream); break; case SDLK_m: toggle_mute(cur_stream); break; case SDLK_KP_MULTIPLY: case SDLK_0: update_volume(cur_stream, 1, SDL_VOLUME_STEP); break; case SDLK_KP_DIVIDE: case SDLK_9: update_volume(cur_stream, -1, SDL_VOLUME_STEP); break; case SDLK_s: // S: Step to next frame step_to_next_frame(cur_stream); break; case SDLK_a: stream_cycle_channel(cur_stream, AVMEDIA_TYPE_AUDIO); break; case SDLK_v: stream_cycle_channel(cur_stream, AVMEDIA_TYPE_VIDEO); break; case SDLK_c: stream_cycle_channel(cur_stream, AVMEDIA_TYPE_VIDEO); stream_cycle_channel(cur_stream, AVMEDIA_TYPE_AUDIO); stream_cycle_channel(cur_stream, AVMEDIA_TYPE_SUBTITLE); break; case SDLK_t: stream_cycle_channel(cur_stream, AVMEDIA_TYPE_SUBTITLE); break; case SDLK_w: #if CONFIG_AVFILTER if (cur_stream->show_mode == SHOW_MODE_VIDEO && cur_stream->vfilter_idx vfilter_idx >= nb_vfilters) cur_stream->vfilter_idx = 0; } else { cur_stream->vfilter_idx = 0; toggle_audio_display(cur_stream); } #else toggle_audio_display(cur_stream); #endif break; case SDLK_PAGEUP: if (cur_stream->ic->nb_chapters ic->nb_chapters video_stream >= 0) pos = frame_queue_last_pos(&cur_stream->pictq); if (pos audio_stream >= 0) pos = frame_queue_last_pos(&cur_stream->sampq); if (pos ic->pb); if (cur_stream->ic->bit_rate) incr *= cur_stream->ic->bit_rate / 8.0; else incr *= 180000.0; pos += incr; stream_seek(cur_stream, pos, incr, 1); } else { pos = get_master_clock(cur_stream); if (isnan(pos)) pos = (double)cur_stream->seek_pos / AV_TIME_BASE; pos += incr; if (cur_stream->ic->start_time != AV_NOPTS_VALUE && pos ic->start_time / (double)AV_TIME_BASE) pos = cur_stream->ic->start_time / (double)AV_TIME_BASE; stream_seek(cur_stream, (int64_t)(pos * AV_TIME_BASE), (int64_t)(incr * AV_TIME_BASE), 0); } break; default: break; } break; case SDL_MOUSEBUTTONDOWN: if (exit_on_mousedown) { do_exit(cur_stream); break; } if (event.button.button == SDL_BUTTON_LEFT) { static int64_t last_mouse_left_click = 0; if (av_gettime_relative() - last_mouse_left_click force_refresh = 1; last_mouse_left_click = 0; } else { last_mouse_left_click = av_gettime_relative(); } } case SDL_MOUSEMOTION: if (cursor_hidden) { SDL_ShowCursor(1); cursor_hidden = 0; } cursor_last_shown = av_gettime_relative(); if (event.type == SDL_MOUSEBUTTONDOWN) { if (event.button.button != SDL_BUTTON_RIGHT) break; x = event.button.x; } else { if (!(event.motion.state & SDL_BUTTON_RMASK)) break; x = event.motion.x; } if (seek_by_bytes || cur_stream->ic->duration ic->pb); stream_seek(cur_stream, size*x/cur_stream->width, 0, 1); } else { int64_t ts; int ns, hh, mm, ss; int tns, thh, tmm, tss; tns = cur_stream->ic->duration / 1000000LL; thh = tns / 3600; tmm = (tns % 3600) / 60; tss = (tns % 60); frac = x / cur_stream->width; ns = frac * tns; hh = ns / 3600; mm = (ns % 3600) / 60; ss = (ns % 60); av_log(NULL, AV_LOG_INFO, \"Seek to %2.0f%% (%2d:%02d:%02d) of total duration (%2d:%02d:%02d) \\n\", frac*100, hh, mm, ss, thh, tmm, tss); ts = frac * cur_stream->ic->duration; if (cur_stream->ic->start_time != AV_NOPTS_VALUE) ts += cur_stream->ic->start_time; stream_seek(cur_stream, ts, 0, 0); } break; case SDL_WINDOWEVENT: switch (event.window.event) { case SDL_WINDOWEVENT_SIZE_CHANGED: screen_width = cur_stream->width = event.window.data1; screen_height = cur_stream->height = event.window.data2; if (cur_stream->vis_texture) { SDL_DestroyTexture(cur_stream->vis_texture); cur_stream->vis_texture = NULL; } case SDL_WINDOWEVENT_EXPOSED: cur_stream->force_refresh = 1; } break; case SDL_QUIT: case FF_QUIT_EVENT: do_exit(cur_stream); break; default: break; } } } static int opt_frame_size(void *optctx, const char *opt, const char *arg) { av_log(NULL, AV_LOG_WARNING, \"Option -s is deprecated, use -video_size.\\n\"); return opt_default(NULL, \"video_size\", arg); } static int opt_width(void *optctx, const char *opt, const char *arg) { screen_width = parse_number_or_die(opt, arg, OPT_INT64, 1, INT_MAX); return 0; } static int opt_height(void *optctx, const char *opt, const char *arg) { screen_height = parse_number_or_die(opt, arg, OPT_INT64, 1, INT_MAX); return 0; } static int opt_format(void *optctx, const char *opt, const char *arg) { file_iformat = av_find_input_format(arg); if (!file_iformat) { av_log(NULL, AV_LOG_FATAL, \"Unknown input format: %s\\n\", arg); return AVERROR(EINVAL); } return 0; } static int opt_frame_pix_fmt(void *optctx, const char *opt, const char *arg) { av_log(NULL, AV_LOG_WARNING, \"Option -pix_fmt is deprecated, use -pixel_format.\\n\"); return opt_default(NULL, \"pixel_format\", arg); } static int opt_sync(void *optctx, const char *opt, const char *arg) { if (!strcmp(arg, \"audio\")) av_sync_type = AV_SYNC_AUDIO_MASTER; else if (!strcmp(arg, \"video\")) av_sync_type = AV_SYNC_VIDEO_MASTER; else if (!strcmp(arg, \"ext\")) av_sync_type = AV_SYNC_EXTERNAL_CLOCK; else { av_log(NULL, AV_LOG_ERROR, \"Unknown value for %s: %s\\n\", opt, arg); exit(1); } return 0; } static int opt_seek(void *optctx, const char *opt, const char *arg) { start_time = parse_time_or_die(opt, arg, 1); return 0; } static int opt_duration(void *optctx, const char *opt, const char *arg) { duration = parse_time_or_die(opt, arg, 1); return 0; } static int opt_show_mode(void *optctx, const char *opt, const char *arg) { show_mode = !strcmp(arg, \"video\") ? SHOW_MODE_VIDEO : !strcmp(arg, \"waves\") ? SHOW_MODE_WAVES : !strcmp(arg, \"rdft\" ) ? SHOW_MODE_RDFT : parse_number_or_die(opt, arg, OPT_INT, 0, SHOW_MODE_NB-1); return 0; } static void opt_input_file(void *optctx, const char *filename) { if (input_filename) { av_log(NULL, AV_LOG_FATAL, \"Argument '%s' provided as input filename, but '%s' was already specified.\\n\", filename, input_filename); exit(1); } if (!strcmp(filename, \"-\")) filename = \"pipe:\"; input_filename = filename; } static int opt_codec(void *optctx, const char *opt, const char *arg) { const char *spec = strchr(opt, ':'); if (!spec) { av_log(NULL, AV_LOG_ERROR, \"No media specifier was specified in '%s' in option '%s'\\n\", arg, opt); return AVERROR(EINVAL); } spec++; switch (spec[0]) { case 'a' : audio_codec_name = arg; break; case 's' : subtitle_codec_name = arg; break; case 'v' : video_codec_name = arg; break; default: av_log(NULL, AV_LOG_ERROR, \"Invalid media specifier '%s' in option '%s'\\n\", spec, opt); return AVERROR(EINVAL); } return 0; } static int dummy; static const OptionDef options[] = { CMDUTILS_COMMON_OPTIONS { \"x\", HAS_ARG, { .func_arg = opt_width }, \"force displayed width\", \"width\" }, { \"y\", HAS_ARG, { .func_arg = opt_height }, \"force displayed height\", \"height\" }, { \"s\", HAS_ARG | OPT_VIDEO, { .func_arg = opt_frame_size }, \"set frame size (WxH or abbreviation)\", \"size\" }, { \"fs\", OPT_BOOL, { &is_full_screen }, \"force full screen\" }, { \"an\", OPT_BOOL, { &audio_disable }, \"disable audio\" }, { \"vn\", OPT_BOOL, { &video_disable }, \"disable video\" }, { \"sn\", OPT_BOOL, { &subtitle_disable }, \"disable subtitling\" }, { \"ast\", OPT_STRING | HAS_ARG | OPT_EXPERT, { &wanted_stream_spec[AVMEDIA_TYPE_AUDIO] }, \"select desired audio stream\", \"stream_specifier\" }, { \"vst\", OPT_STRING | HAS_ARG | OPT_EXPERT, { &wanted_stream_spec[AVMEDIA_TYPE_VIDEO] }, \"select desired video stream\", \"stream_specifier\" }, { \"sst\", OPT_STRING | HAS_ARG | OPT_EXPERT, { &wanted_stream_spec[AVMEDIA_TYPE_SUBTITLE] }, \"select desired subtitle stream\", \"stream_specifier\" }, { \"ss\", HAS_ARG, { .func_arg = opt_seek }, \"seek to a given position in seconds\", \"pos\" }, { \"t\", HAS_ARG, { .func_arg = opt_duration }, \"play \\\"duration\\\" seconds of audio/video\", \"duration\" }, { \"bytes\", OPT_INT | HAS_ARG, { &seek_by_bytes }, \"seek by bytes 0=off 1=on -1=auto\", \"val\" }, { \"seek_interval\", OPT_FLOAT | HAS_ARG, { &seek_interval }, \"set seek interval for left/right keys, in seconds\", \"seconds\" }, { \"nodisp\", OPT_BOOL, { &display_disable }, \"disable graphical display\" }, { \"noborder\", OPT_BOOL, { &borderless }, \"borderless window\" }, { \"alwaysontop\", OPT_BOOL, { &alwaysontop }, \"window always on top\" }, { \"volume\", OPT_INT | HAS_ARG, { &startup_volume}, \"set startup volume 0=min 100=max\", \"volume\" }, { \"f\", HAS_ARG, { .func_arg = opt_format }, \"force format\", \"fmt\" }, { \"pix_fmt\", HAS_ARG | OPT_EXPERT | OPT_VIDEO, { .func_arg = opt_frame_pix_fmt }, \"set pixel format\", \"format\" }, { \"stats\", OPT_BOOL | OPT_EXPERT, { &show_status }, \"show status\", \"\" }, { \"fast\", OPT_BOOL | OPT_EXPERT, { &fast }, \"non spec compliant optimizations\", \"\" }, { \"genpts\", OPT_BOOL | OPT_EXPERT, { &genpts }, \"generate pts\", \"\" }, { \"drp\", OPT_INT | HAS_ARG | OPT_EXPERT, { &decoder_reorder_pts }, \"let decoder reorder pts 0=off 1=on -1=auto\", \"\"}, { \"lowres\", OPT_INT | HAS_ARG | OPT_EXPERT, { &lowres }, \"\", \"\" }, { \"sync\", HAS_ARG | OPT_EXPERT, { .func_arg = opt_sync }, \"set audio-video sync. type (type=audio/video/ext)\", \"type\" }, { \"autoexit\", OPT_BOOL | OPT_EXPERT, { &autoexit }, \"exit at the end\", \"\" }, { \"exitonkeydown\", OPT_BOOL | OPT_EXPERT, { &exit_on_keydown }, \"exit on key down\", \"\" }, { \"exitonmousedown\", OPT_BOOL | OPT_EXPERT, { &exit_on_mousedown }, \"exit on mouse down\", \"\" }, { \"loop\", OPT_INT | HAS_ARG | OPT_EXPERT, { &loop }, \"set number of times the playback shall be looped\", \"loop count\" }, { \"framedrop\", OPT_BOOL | OPT_EXPERT, { &framedrop }, \"drop frames when cpu is too slow\", \"\" }, { \"infbuf\", OPT_BOOL | OPT_EXPERT, { &infinite_buffer }, \"don't limit the input buffer size (useful with realtime streams)\", \"\" }, { \"window_title\", OPT_STRING | HAS_ARG, { &window_title }, \"set window title\", \"window title\" }, { \"left\", OPT_INT | HAS_ARG | OPT_EXPERT, { &screen_left }, \"set the x position for the left of the window\", \"x pos\" }, { \"top\", OPT_INT | HAS_ARG | OPT_EXPERT, { &screen_top }, \"set the y position for the top of the window\", \"y pos\" }, #if CONFIG_AVFILTER { \"vf\", OPT_EXPERT | HAS_ARG, { .func_arg = opt_add_vfilter }, \"set video filters\", \"filter_graph\" }, { \"af\", OPT_STRING | HAS_ARG, { &afilters }, \"set audio filters\", \"filter_graph\" }, #endif { \"rdftspeed\", OPT_INT | HAS_ARG| OPT_AUDIO | OPT_EXPERT, { &rdftspeed }, \"rdft speed\", \"msecs\" }, { \"showmode\", HAS_ARG, { .func_arg = opt_show_mode}, \"select show mode (0 = video, 1 = waves, 2 = RDFT)\", \"mode\" }, { \"default\", HAS_ARG | OPT_AUDIO | OPT_VIDEO | OPT_EXPERT, { .func_arg = opt_default }, \"generic catch all option\", \"\" }, { \"i\", OPT_BOOL, { &dummy}, \"read specified file\", \"input_file\"}, { \"codec\", HAS_ARG, { .func_arg = opt_codec}, \"force decoder\", \"decoder_name\" }, { \"acodec\", HAS_ARG | OPT_STRING | OPT_EXPERT, { &audio_codec_name }, \"force audio decoder\", \"decoder_name\" }, { \"scodec\", HAS_ARG | OPT_STRING | OPT_EXPERT, { &subtitle_codec_name }, \"force subtitle decoder\", \"decoder_name\" }, { \"vcodec\", HAS_ARG | OPT_STRING | OPT_EXPERT, { &video_codec_name }, \"force video decoder\", \"decoder_name\" }, { \"autorotate\", OPT_BOOL, { &autorotate }, \"automatically rotate video\", \"\" }, { \"find_stream_info\", OPT_BOOL | OPT_INPUT | OPT_EXPERT, { &find_stream_info }, \"read and decode the streams to fill missing information with heuristics\" }, { \"filter_threads\", HAS_ARG | OPT_INT | OPT_EXPERT, { &filter_nbthreads }, \"number of filter threads per graph\" }, { NULL, }, }; static void show_usage(void) { av_log(NULL, AV_LOG_INFO, \"Simple media player\\n\"); av_log(NULL, AV_LOG_INFO, \"usage: %s [options] input_file\\n\", program_name); av_log(NULL, AV_LOG_INFO, \"\\n\"); } void show_help_default(const char *opt, const char *arg) { av_log_set_callback(log_callback_help); show_usage(); show_help_options(options, \"Main options:\", 0, OPT_EXPERT, 0); show_help_options(options, \"Advanced options:\", OPT_EXPERT, 0, 0); printf(\"\\n\"); show_help_children(avcodec_get_class(), AV_OPT_FLAG_DECODING_PARAM); show_help_children(avformat_get_class(), AV_OPT_FLAG_DECODING_PARAM); #if !CONFIG_AVFILTER show_help_children(sws_get_class(), AV_OPT_FLAG_ENCODING_PARAM); #else show_help_children(avfilter_get_class(), AV_OPT_FLAG_FILTERING_PARAM); #endif printf(\"\\nWhile playing:\\n\" \"q, ESC quit\\n\" \"f toggle full screen\\n\" \"p, SPC pause\\n\" \"m toggle mute\\n\" \"9, 0 decrease and increase volume respectively\\n\" \"/, * decrease and increase volume respectively\\n\" \"a cycle audio channel in the current program\\n\" \"v cycle video channel\\n\" \"t cycle subtitle channel in the current program\\n\" \"c cycle program\\n\" \"w cycle video filters or show modes\\n\" \"s activate frame-step mode\\n\" \"left/right seek backward/forward 10 seconds or to custom interval if -seek_interval is set\\n\" \"down/up seek backward/forward 1 minute\\n\" \"page down/page up seek backward/forward 10 minutes\\n\" \"right mouse click seek to percentage in file corresponding to fraction of width\\n\" \"left double-click toggle full screen\\n\" ); } /* Called from the main */ int main(int argc, char **argv) { int flags; VideoState *is; init_dynload(); av_log_set_flags(AV_LOG_SKIP_REPEATED); parse_loglevel(argc, argv, options); /* register all codecs, demux and protocols */ #if CONFIG_AVDEVICE avdevice_register_all(); #endif avformat_network_init(); init_opts(); signal(SIGINT , sigterm_handler); /* Interrupt (ANSI). */ signal(SIGTERM, sigterm_handler); /* Termination (ANSI). */ show_banner(argc, argv, options); parse_options(NULL, argc, argv, options, opt_input_file); if (!input_filename) { show_usage(); av_log(NULL, AV_LOG_FATAL, \"An input file must be specified\\n\"); av_log(NULL, AV_LOG_FATAL, \"Use -h to get full help or, even better, run 'man %s'\\n\", program_name); exit(1); } if (display_disable) { video_disable = 1; } flags = SDL_INIT_VIDEO | SDL_INIT_AUDIO | SDL_INIT_TIMER; if (audio_disable) flags &= ~SDL_INIT_AUDIO; else { /* Try to work around an occasional ALSA buffer underflow issue when the * period size is NPOT due to ALSA resampling by forcing the buffer size. */ if (!SDL_getenv(\"SDL_AUDIO_ALSA_SET_BUFFER_SIZE\")) SDL_setenv(\"SDL_AUDIO_ALSA_SET_BUFFER_SIZE\",\"1\", 1); } if (display_disable) flags &= ~SDL_INIT_VIDEO; if (SDL_Init (flags)) { av_log(NULL, AV_LOG_FATAL, \"Could not initialize SDL - %s\\n\", SDL_GetError()); av_log(NULL, AV_LOG_FATAL, \"(Did you set the DISPLAY variable?)\\n\"); exit(1); } SDL_EventState(SDL_SYSWMEVENT, SDL_IGNORE); SDL_EventState(SDL_USEREVENT, SDL_IGNORE); av_init_packet(&flush_pkt); flush_pkt.data = (uint8_t *)&flush_pkt; if (!display_disable) { int flags = SDL_WINDOW_HIDDEN; if (alwaysontop) #if SDL_VERSION_ATLEAST(2,0,5) flags |= SDL_WINDOW_ALWAYS_ON_TOP; #else av_log(NULL, AV_LOG_WARNING, \"Your SDL version doesn't support SDL_WINDOW_ALWAYS_ON_TOP. Feature will be inactive.\\n\"); #endif if (borderless) flags |= SDL_WINDOW_BORDERLESS; else flags |= SDL_WINDOW_RESIZABLE; window = SDL_CreateWindow(program_name, SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, default_width, default_height, flags); SDL_SetHint(SDL_HINT_RENDER_SCALE_QUALITY, \"linear\"); if (window) { renderer = SDL_CreateRenderer(window, -1, SDL_RENDERER_ACCELERATED | SDL_RENDERER_PRESENTVSYNC); if (!renderer) { av_log(NULL, AV_LOG_WARNING, \"Failed to initialize a hardware accelerated renderer: %s\\n\", SDL_GetError()); renderer = SDL_CreateRenderer(window, -1, 0); } if (renderer) { if (!SDL_GetRendererInfo(renderer, &renderer_info)) av_log(NULL, AV_LOG_VERBOSE, \"Initialized %s renderer.\\n\", renderer_info.name); } } if (!window || !renderer || !renderer_info.num_texture_formats) { av_log(NULL, AV_LOG_FATAL, \"Failed to create window or renderer: %s\", SDL_GetError()); do_exit(NULL); } } is = stream_open(input_filename, file_iformat); if (!is) { av_log(NULL, AV_LOG_FATAL, \"Failed to initialize VideoState!\\n\"); do_exit(NULL); } event_loop(is); /* never returns */ return 0; } "},"pages/FFmpeg/ffplayæºç _mainå‡½æ•°_do_exitå‡½æ•°.html":{"url":"pages/FFmpeg/ffplayæºç _mainå‡½æ•°_do_exitå‡½æ•°.html","title":"ffplayæºç -mainå‡½æ•°ï¼Œdo_exitå‡½æ•°","keywords":"","body":"ffplayæºç -mainå‡½æ•°ï¼Œdo_exitå‡½æ•° iOSå·¥ç¨‹ä»£ç  æºä»£ç ä¸€è§ˆ #import #include \"libavutil/avstring.h\" #include \"libavutil/eval.h\" #include \"libavutil/mathematics.h\" #include \"libavutil/pixdesc.h\" #include \"libavutil/imgutils.h\" #include \"libavutil/dict.h\" #include \"libavutil/parseutils.h\" #include \"libavutil/samplefmt.h\" #include \"libavutil/avassert.h\" #include \"libavutil/time.h\" #include \"libavformat/avformat.h\" #include \"libavdevice/avdevice.h\" #include \"libswscale/swscale.h\" #include \"libavutil/opt.h\" #include \"libavcodec/avfft.h\" #include \"libswresample/swresample.h\" #include #include const char program_name[] = \"ffplay\"; /* options specified by the user */ static AVInputFormat *file_iformat; static const char *input_filename; static int default_width = 640; static int default_height = 480; /* current context */ static AVPacket flush_pkt; static SDL_Window *window; static SDL_Renderer *renderer; static SDL_RendererInfo renderer_info = {0}; typedef struct VideoState { } VideoState; static void stream_close(VideoState *is) { // TODO: stream_close } static void do_exit(VideoState *is) { if (is) { stream_close(is); } if (renderer) SDL_DestroyRenderer(renderer); if (window) SDL_DestroyWindow(window); // uninit_opts(); //#if CONFIG_AVFILTER // av_freep(&vfilters_list); //#endif // avformat_network_deinit(); // if (show_status) // printf(\"\\n\"); SDL_Quit(); av_log(NULL, AV_LOG_QUIET, \"%s\", \"\"); exit(0); } static VideoState *stream_open(const char *filename, AVInputFormat *iformat) { // TODO: stream_open return NULL; } /* handle an event sent by the GUI */ static void event_loop(VideoState *cur_stream) { // TODO: event_loop } int main(int argc, char *argv[]) { int flags; VideoState *is; // åŠ¨æ€åŠ è½½çš„åˆå§‹åŒ–ï¼Œè¿™æ˜¯Windowså¹³å°çš„dllåº“ç›¸å…³å¤„ç†ï¼› // https://blog.csdn.net/ericbar/article/details/79541420 // init_dynload(); // è®¾ç½®æ‰“å°çš„æ ‡è®°ï¼ŒAV_LOG_SKIP_REPEATEDè¡¨ç¤ºå¯¹äºé‡å¤æ‰“å°çš„è¯­å¥ï¼Œä¸é‡å¤è¾“å‡ºï¼› // https://blog.csdn.net/ericbar/article/details/79541420 av_log_set_flags(AV_LOG_SKIP_REPEATED); // ä½¿å‘½ä»¤è¡Œ'-loglevel'ç”Ÿæ•ˆ // parse_loglevel(argc, argv, options); /* register all codecs, demux and protocols */ //#if CONFIG_AVDEVICE // åœ¨ä½¿ç”¨libavdeviceä¹‹å‰ï¼Œå¿…é¡»å…ˆè¿è¡Œavdevice_register_all()å¯¹è®¾å¤‡è¿›è¡Œæ³¨å†Œï¼Œå¦åˆ™å°±ä¼šå‡ºé”™ // https://blog.csdn.net/leixiaohua1020/article/details/41211121 avdevice_register_all(); //#endif // æ‰“å¼€ç½‘ç»œæµçš„è¯ï¼Œå‰é¢è¦åŠ ä¸Šå‡½æ•° // avformat_network_init(); // Initialize the cmdutils option system, in particular allocate the *_opts contexts. // åˆå§‹åŒ– cmdutils é€‰é¡¹ç³»ç»Ÿï¼Œç‰¹åˆ«æ˜¯åˆ†é… *_opts ä¸Šä¸‹æ–‡ã€‚ // init_opts(); // signal(SIGINT , sigterm_handler); /* Interrupt (ANSI). */ // signal(SIGTERM, sigterm_handler); /* Termination (ANSI). */ // å°†ç¨‹åºæ¨ªå¹…æ‰“å°åˆ° stderrã€‚ æ¨ªå¹…å†…å®¹å–å†³äºå½“å‰ç‰ˆæœ¬çš„å­˜å‚¨åº“å’Œç¨‹åºä½¿ç”¨çš„ libav* åº“ã€‚ // Print the program banner to stderr. The banner contents depend // on the current version of the repository and of the libav* libraries used by // the program. // show_banner(argc, argv, options); // parse_options(NULL, argc, argv, options, opt_input_file); // input_filenameï¼šå‘½ä»¤è¡Œ -i æŒ‡å®šï¼Œè§†é¢‘è·¯å¾„ NSString *inPath = [[NSBundle mainBundle] pathForResource:@\"test\" ofType:@\"mov\"]; input_filename = [inPath UTF8String]; if (!input_filename) { // show_usage(); // av_log(NULL, AV_LOG_FATAL, \"An input file must be specified\\n\"); // av_log(NULL, AV_LOG_FATAL, // \"Use -h to get full help or, even better, run 'man %s'\\n\", program_name); exit(1); } // display_disableï¼šå‘½ä»¤è¡Œ -nodisp æŒ‡å®šï¼Œä¸æ¸²æŸ“ç”»é¢ä¸æ’­æ”¾å£°éŸ³ // if (display_disable) { // video_disable = 1; // } flags = SDL_INIT_VIDEO | SDL_INIT_AUDIO | SDL_INIT_TIMER; // audio_disableï¼šå‘½ä»¤è¡Œ -an æŒ‡å®šï¼Œæ¸²æŸ“ç”»é¢ä¸æ’­æ”¾å£°éŸ³ // if (audio_disable) // flags &= ~SDL_INIT_AUDIO; // else { // /* Try to work around an occasional ALSA buffer underflow issue when the // * period size is NPOT due to ALSA resampling by forcing the buffer size. */ // if (!SDL_getenv(\"SDL_AUDIO_ALSA_SET_BUFFER_SIZE\")) // SDL_setenv(\"SDL_AUDIO_ALSA_SET_BUFFER_SIZE\",\"1\", 1); // } // if (display_disable) // flags &= ~SDL_INIT_VIDEO; // æŒ‡å®šflagsï¼ŒSDLåˆå§‹åŒ– if (SDL_Init (flags)) { av_log(NULL, AV_LOG_FATAL, \"Could not initialize SDL - %s\\n\", SDL_GetError()); av_log(NULL, AV_LOG_FATAL, \"(Did you set the DISPLAY variable?)\\n\"); exit(1); } // ç¦ç”¨ä¸€äº›äº‹ä»¶ SDL_EventState(SDL_SYSWMEVENT, SDL_IGNORE); SDL_EventState(SDL_USEREVENT, SDL_IGNORE); av_init_packet(&flush_pkt); flush_pkt.data = (uint8_t *)&flush_pkt; if (1/**!display_disable*/) { int flags = SDL_WINDOW_HIDDEN; // if (alwaysontop) #if SDL_VERSION_ATLEAST(2,0,5) flags |= SDL_WINDOW_ALWAYS_ON_TOP; #else av_log(NULL, AV_LOG_WARNING, \"Your SDL version doesn't support SDL_WINDOW_ALWAYS_ON_TOP. Feature will be inactive.\\n\"); #endif // borderlessï¼šå‘½ä»¤è¡Œ -noborder æŒ‡å®šï¼Œæ²¡æœ‰è¾¹æ¡† // if (borderless) // flags |= SDL_WINDOW_BORDERLESS; // else // å¯ä»¥è‡ªç”±æ‹‰ä¼¸ flags |= SDL_WINDOW_RESIZABLE; window = SDL_CreateWindow(program_name, SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, default_width, default_height, flags); // \"0\" or \"nearest\" - Nearest pixel sampling // \"1\" or \"linear\" - Linear filtering (supported by OpenGL and Direct3D) // \"2\" or \"best\" - Currently this is the same as \"linear\" SDL_SetHint(SDL_HINT_RENDER_SCALE_QUALITY, \"linear\"); if (window) { renderer = SDL_CreateRenderer(window, -1, SDL_RENDERER_ACCELERATED | SDL_RENDERER_PRESENTVSYNC); if (!renderer) { av_log(NULL, AV_LOG_WARNING, \"Failed to initialize a hardware accelerated renderer: %s\\n\", SDL_GetError()); renderer = SDL_CreateRenderer(window, -1, 0); } if (renderer) { if (!SDL_GetRendererInfo(renderer, &renderer_info)) av_log(NULL, AV_LOG_VERBOSE, \"Initialized %s renderer.\\n\", renderer_info.name); } } if (!window || !renderer || !renderer_info.num_texture_formats) { av_log(NULL, AV_LOG_FATAL, \"Failed to create window or renderer: %s\", SDL_GetError()); do_exit(NULL); } } is = stream_open(input_filename, file_iformat); if (!is) { av_log(NULL, AV_LOG_FATAL, \"Failed to initialize VideoState!\\n\"); do_exit(NULL); } event_loop(is); /* never returns */ return 0; } "},"pages/FFmpeg/ffplayæºç _event_loopå‡½æ•°_refresh_loop_wait_eventå‡½æ•°.html":{"url":"pages/FFmpeg/ffplayæºç _event_loopå‡½æ•°_refresh_loop_wait_eventå‡½æ•°.html","title":"ffplayæºç -event_loopå‡½æ•°ã€refresh_loop_wait_eventå‡½æ•°","keywords":"","body":"ffplayæºç -event_loopå‡½æ•°ã€refresh_loop_wait_eventå‡½æ•° iOSå·¥ç¨‹ä»£ç  æºä»£ç ä¸€è§ˆ // // main.m // iOSFFmpegSDLFastForwardAndBackward // // Created by é™ˆé•¿é’ on 2022/5/8. // #import #include \"libavutil/avstring.h\" #include \"libavutil/eval.h\" #include \"libavutil/mathematics.h\" #include \"libavutil/pixdesc.h\" #include \"libavutil/imgutils.h\" #include \"libavutil/dict.h\" #include \"libavutil/parseutils.h\" #include \"libavutil/samplefmt.h\" #include \"libavutil/avassert.h\" #include \"libavutil/time.h\" #include \"libavformat/avformat.h\" #include \"libavdevice/avdevice.h\" #include \"libswscale/swscale.h\" #include \"libavutil/opt.h\" #include \"libavcodec/avfft.h\" #include \"libswresample/swresample.h\" #include #include const char program_name[] = \"ffplay\"; /* Step size for volume control in dB */ #define SDL_VOLUME_STEP (0.75) /* polls for possible required screen refresh at least this often, should be less than 1/fps */ #define REFRESH_RATE 0.01 #define CURSOR_HIDE_DELAY 1000000 /* options specified by the user */ static AVInputFormat *file_iformat; static const char *input_filename; static int default_width = 640; static int default_height = 480; static int screen_width = 0; static int screen_height = 0; static int cursor_hidden = 0; static int64_t cursor_last_shown; /* current context */ // å‘½ä»¤è¡Œ -fs æŒ‡å®šï¼Œæ§åˆ¶æ˜¯å¦å…¨å±æ˜¾ç¤º static int is_full_screen; static AVPacket flush_pkt; #define FF_QUIT_EVENT (SDL_USEREVENT + 2) static SDL_Window *window; static SDL_Renderer *renderer; static SDL_RendererInfo renderer_info = {0}; // MARK: è§†é¢‘çŠ¶æ€ typedef struct VideoState { int force_refresh; int paused; int seek_req; int seek_flags; int64_t seek_pos; int64_t seek_rel; AVFormatContext *ic; int muted; int width, height, xleft, ytop; int step; // å‘½ä»¤è¡Œ -showmode æŒ‡å®š enum ShowMode { SHOW_MODE_NONE = -1, SHOW_MODE_VIDEO = 0, SHOW_MODE_WAVES, SHOW_MODE_RDFT, SHOW_MODE_NB } show_mode; SDL_Texture *vis_texture; SDL_cond *continue_read_thread; } VideoState; // MARK: å…³é—­ç æµ static void stream_close(VideoState *is) { // TODO: stream_close } // MARK: æ‰“å¼€ç æµ static VideoState *stream_open(const char *filename, AVInputFormat *iformat) { // TODO: stream_open VideoState *is; is = av_mallocz(sizeof(VideoState)); if (!is) return NULL; return is; } // MARK: åˆ‡æ¢ç æµ static void stream_cycle_channel(VideoState *is, int codec_type) { // TODO: stream_cycle_channel } // MARK: é€€å‡º static void do_exit(VideoState *is) { if (is) { stream_close(is); } if (renderer) SDL_DestroyRenderer(renderer); if (window) SDL_DestroyWindow(window); // uninit_opts(); //#if CONFIG_AVFILTER // av_freep(&vfilters_list); //#endif // avformat_network_deinit(); // if (show_status) // printf(\"\\n\"); SDL_Quit(); av_log(NULL, AV_LOG_QUIET, \"%s\", \"\"); exit(0); } // MARK: åˆ·æ–°è§†é¢‘ /* called to display each frame */ static void video_refresh(void *opaque, double *remaining_time) { // TODO: video_refresh // av_log(NULL, AV_LOG_INFO, \"playerï¼Œåˆ·æ–°è§†é¢‘\\n\"); } static void toggle_full_screen(VideoState *is) { is_full_screen = !is_full_screen; SDL_SetWindowFullscreen(window, is_full_screen ? SDL_WINDOW_FULLSCREEN_DESKTOP : 0); } // MARK: ä¸»æ—¶é’Ÿ /* get the current master clock value */ static double get_master_clock(VideoState *is) { // TODO: get_master_clock return 0; } // MARK: Seek /* seek in the stream */ static void stream_seek(VideoState *is, int64_t pos, int64_t rel, int seek_by_bytes) { if (!is->seek_req) { is->seek_pos = pos; is->seek_rel = rel; is->seek_flags &= ~AVSEEK_FLAG_BYTE; if (seek_by_bytes) is->seek_flags |= AVSEEK_FLAG_BYTE; is->seek_req = 1; SDL_CondSignal(is->continue_read_thread); } } // MARK: æš‚åœ2 /* pause or resume the video */ static void stream_toggle_pause(VideoState *is) { // TODO: stream_toggle_pause } // MARK: æš‚åœ static void toggle_pause(VideoState *is) { stream_toggle_pause(is); is->step = 0; } // MARK: ç¦éŸ³ static void toggle_mute(VideoState *is) { is->muted = !is->muted; } // MARK: è°ƒå£°éŸ³ static void update_volume(VideoState *is, int sign, double step) { // TODO: update_volume } // MARK: è¿›å…¥ä¸‹ä¸€å¸§ static void step_to_next_frame(VideoState *is) { /* if the stream is paused unpause it, then step */ if (is->paused) stream_toggle_pause(is); is->step = 1; } // MARK: SDLäº‹ä»¶ /** * SDL äº‹ä»¶ * * å¾ªç¯æ£€æµ‹å¹¶ä¼˜å…ˆå¤„ç†ç”¨æˆ·è¾“å…¥äº‹ä»¶ * å†…ç½®åˆ·æ–°ç‡æ§åˆ¶ï¼Œçº¦10msåˆ·æ–°ä¸€æ¬¡ * https://blog.csdn.net/qq_36783046/article/details/88706162 */ static void refresh_loop_wait_event(VideoState *is, SDL_Event *event) { double remaining_time = 0.0; /* ä»è¾“å…¥è®¾å¤‡æ”¶é›†äº‹ä»¶å¹¶æ”¾åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ */ SDL_PumpEvents(); /** * SDL_PeepEvents * ä»äº‹ä»¶é˜Ÿåˆ—ä¸­æå–äº‹ä»¶ï¼Œç”±äºè¿™é‡Œä½¿ç”¨çš„æ˜¯SDL_GETEVENT, æ‰€ä»¥è·å–äº‹ä»¶æ—¶ä¼šä»é˜Ÿåˆ—ä¸­ç§»é™¤ * å¦‚æœæœ‰äº‹ä»¶å‘ç”Ÿï¼Œè¿”å›äº‹ä»¶æ•°é‡ï¼Œåˆ™whileå¾ªç¯ä¸æ‰§è¡Œã€‚ * å¦‚æœå‡ºé”™ï¼Œè¿”å›è´Ÿæ•°çš„é”™è¯¯ç ï¼Œåˆ™whileå¾ªç¯ä¸æ‰§è¡Œã€‚ * å¦‚æœå½“å‰æ²¡æœ‰äº‹ä»¶å‘ç”Ÿï¼Œä¸”æ²¡æœ‰å‡ºé”™ï¼Œè¿”å›0ï¼Œè¿›å…¥whileå¾ªç¯ã€‚ */ while (!SDL_PeepEvents(event, 1, SDL_GETEVENT, SDL_FIRSTEVENT, SDL_LASTEVENT)) { /* éšè—é¼ æ ‡æŒ‡é’ˆï¼Œ CURSOR_HIDE_DELAY = 1s */ if (!cursor_hidden && av_gettime_relative() - cursor_last_shown > CURSOR_HIDE_DELAY) { SDL_ShowCursor(0); cursor_hidden = 1; } /* é»˜è®¤å±å¹•åˆ·æ–°ç‡æ§åˆ¶ï¼ŒREFRESH_RATE = 10ms */ if (remaining_time > 0.0) av_usleep((int64_t)(remaining_time * 1000000.0)); remaining_time = REFRESH_RATE; /* æ˜¾ç¤ºè§†é¢‘ */ if (is->show_mode != SHOW_MODE_NONE && (!is->paused || is->force_refresh)) video_refresh(is, &remaining_time); /* å†æ¬¡æ£€æµ‹è¾“å…¥äº‹ä»¶ */ SDL_PumpEvents(); } } // MARK: äº‹ä»¶å¾ªç¯ /* handle an event sent by the GUI */ static void event_loop(VideoState *cur_stream) { SDL_Event event; double incr, pos, frac; for (;;) { double x; refresh_loop_wait_event(cur_stream, &event); switch (event.type) { // æŒ‰é”®æŒ‰ä¸‹äº‹ä»¶ case SDL_KEYDOWN: // æŒ‰esc,qé€€å‡º if (1/**exit_on_keydown*/ || event.key.keysym.sym == SDLK_ESCAPE || event.key.keysym.sym == SDLK_q) { do_exit(cur_stream); break; } // If we don't yet have a window, skip all key events, because read_thread might still be initializing... if (!cur_stream->width) continue; switch (event.key.keysym.sym) { // æŒ‰Fé”®ï¼Œå…¨å± case SDLK_f: toggle_full_screen(cur_stream); // è°ƒç”¨video_refresh()åˆ·æ–°è§†é¢‘ cur_stream->force_refresh = 1; break; // æŒ‰Pã€SPACEé”®ï¼Œæš‚åœ case SDLK_p: case SDLK_SPACE: toggle_pause(cur_stream); break; // æŒ‰Mé”®ï¼Œé™éŸ³ case SDLK_m: toggle_mute(cur_stream); break; // æŒ‰+ã€0é”®ï¼Œå¢åŠ éŸ³é‡ // https://blog.csdn.net/huzhifei/article/details/112682390 case SDLK_KP_MULTIPLY: case SDLK_0: update_volume(cur_stream, 1, SDL_VOLUME_STEP); break; // æŒ‰-ã€9é”®ï¼Œå‡å°éŸ³é‡ case SDLK_KP_DIVIDE: case SDLK_9: update_volume(cur_stream, -1, SDL_VOLUME_STEP); break; // æŒ‰Sé”®ï¼Œä¸‹ä¸€å¸§ case SDLK_s: // S: Step to next frame step_to_next_frame(cur_stream); break; // æŒ‰Aé”®ï¼Œåˆ‡æ¢éŸ³é¢‘æµ case SDLK_a: stream_cycle_channel(cur_stream, AVMEDIA_TYPE_AUDIO); break; // æŒ‰Vé”®ï¼Œåˆ‡æ¢è§†é¢‘æµ case SDLK_v: stream_cycle_channel(cur_stream, AVMEDIA_TYPE_VIDEO); break; // æŒ‰Cé”®ï¼Œå¾ªç¯åˆ‡æ¢èŠ‚ç›®ï¼ˆåˆ‡æ¢éŸ³é¢‘ã€è§†é¢‘ã€å­—å¹•æµï¼‰ case SDLK_c: stream_cycle_channel(cur_stream, AVMEDIA_TYPE_VIDEO); stream_cycle_channel(cur_stream, AVMEDIA_TYPE_AUDIO); stream_cycle_channel(cur_stream, AVMEDIA_TYPE_SUBTITLE); break; // æŒ‰Té”®ï¼Œåˆ‡æ¢å­—å¹•æµ case SDLK_t: stream_cycle_channel(cur_stream, AVMEDIA_TYPE_SUBTITLE); break; // æŒ‰Wé”®ï¼Œå¾ªç¯åˆ‡æ¢è¿‡æ»¤å™¨æˆ–æ˜¾ç¤ºæ¨¡å¼ case SDLK_w: //#if CONFIG_AVFILTER // if (cur_stream->show_mode == SHOW_MODE_VIDEO && cur_stream->vfilter_idx vfilter_idx >= nb_vfilters) // cur_stream->vfilter_idx = 0; // } else { // cur_stream->vfilter_idx = 0; // toggle_audio_display(cur_stream); // } //#else // toggle_audio_display(cur_stream); //#endif break; // macä¸Šå¥½åƒæ²¡æ‰¾åˆ°è¿™ä¸ªé”® case SDLK_PAGEUP: // å¦‚æœåªæœ‰ä¸€ä¸ªè§†é¢‘åˆ™å‘å‰10åˆ†é’Ÿ // if (cur_stream->ic->nb_chapters ic->nb_chapters video_stream >= 0) // pos = frame_queue_last_pos(&cur_stream->pictq); // if (pos audio_stream >= 0) // pos = frame_queue_last_pos(&cur_stream->sampq); // if (pos ic->pb); // if (cur_stream->ic->bit_rate) // incr *= cur_stream->ic->bit_rate / 8.0; // else // incr *= 180000.0; // pos += incr; // stream_seek(cur_stream, pos, incr, 1); // } else { pos = get_master_clock(cur_stream); if (isnan(pos)) pos = (double)cur_stream->seek_pos / AV_TIME_BASE; pos += incr; if (cur_stream->ic->start_time != AV_NOPTS_VALUE && pos ic->start_time / (double)AV_TIME_BASE) pos = cur_stream->ic->start_time / (double)AV_TIME_BASE; stream_seek(cur_stream, (int64_t)(pos * AV_TIME_BASE), (int64_t)(incr * AV_TIME_BASE), 0); // } break; default: break; } break; case SDL_MOUSEBUTTONDOWN: // exit_on_mousedownï¼šå‘½ä»¤è¡Œ -exitonmousedown æŒ‡å®šï¼Œé¼ æ ‡å•å‡»å·¦é”®é€€å‡º // if (exit_on_mousedown) { // do_exit(cur_stream); // break; // } // åŒå‡»å·¦é”®å…¨å± if (event.button.button == SDL_BUTTON_LEFT) { static int64_t last_mouse_left_click = 0; if (av_gettime_relative() - last_mouse_left_click force_refresh = 1; last_mouse_left_click = 0; } else { last_mouse_left_click = av_gettime_relative(); } } // é¼ æ ‡ç§»åŠ¨äº‹ä»¶ï¼Œæ‰§è¡ŒSeekï¼ˆæš‚æ—¶ä¸ä¼šç”¨ï¼‰ case SDL_MOUSEMOTION: // if (cursor_hidden) { // SDL_ShowCursor(1); // cursor_hidden = 0; // } // cursor_last_shown = av_gettime_relative(); // if (event.type == SDL_MOUSEBUTTONDOWN) { // if (event.button.button != SDL_BUTTON_RIGHT) // break; // x = event.button.x; // } else { // if (!(event.motion.state & SDL_BUTTON_RMASK)) // break; // x = event.motion.x; // } // if (seek_by_bytes || cur_stream->ic->duration ic->pb); // stream_seek(cur_stream, size*x/cur_stream->width, 0, 1); // } else { // int64_t ts; // int ns, hh, mm, ss; // int tns, thh, tmm, tss; // tns = cur_stream->ic->duration / 1000000LL; // thh = tns / 3600; // tmm = (tns % 3600) / 60; // tss = (tns % 60); // frac = x / cur_stream->width; // ns = frac * tns; // hh = ns / 3600; // mm = (ns % 3600) / 60; // ss = (ns % 60); // av_log(NULL, AV_LOG_INFO, // \"Seek to %2.0f%% (%2d:%02d:%02d) of total duration (%2d:%02d:%02d) \\n\", frac*100, // hh, mm, ss, thh, tmm, tss); // ts = frac * cur_stream->ic->duration; // if (cur_stream->ic->start_time != AV_NOPTS_VALUE) // ts += cur_stream->ic->start_time; // stream_seek(cur_stream, ts, 0, 0); // } break; case SDL_WINDOWEVENT: switch (event.window.event) { case SDL_WINDOWEVENT_SIZE_CHANGED: screen_width = cur_stream->width = event.window.data1; screen_height = cur_stream->height = event.window.data2; if (cur_stream->vis_texture) { SDL_DestroyTexture(cur_stream->vis_texture); cur_stream->vis_texture = NULL; } case SDL_WINDOWEVENT_EXPOSED: cur_stream->force_refresh = 1; } break; case SDL_QUIT: case FF_QUIT_EVENT: do_exit(cur_stream); break; default: break; } } } // MARK: å…¥å£å‡½æ•° int main(int argc, char *argv[]) { int flags; VideoState *is; // åŠ¨æ€åŠ è½½çš„åˆå§‹åŒ–ï¼Œè¿™æ˜¯Windowså¹³å°çš„dllåº“ç›¸å…³å¤„ç†ï¼› // https://blog.csdn.net/ericbar/article/details/79541420 // init_dynload(); // è®¾ç½®æ‰“å°çš„æ ‡è®°ï¼ŒAV_LOG_SKIP_REPEATEDè¡¨ç¤ºå¯¹äºé‡å¤æ‰“å°çš„è¯­å¥ï¼Œä¸é‡å¤è¾“å‡ºï¼› // https://blog.csdn.net/ericbar/article/details/79541420 av_log_set_flags(AV_LOG_SKIP_REPEATED); // ä½¿å‘½ä»¤è¡Œ'-loglevel'ç”Ÿæ•ˆ // parse_loglevel(argc, argv, options); /* register all codecs, demux and protocols */ //#if CONFIG_AVDEVICE // åœ¨ä½¿ç”¨libavdeviceä¹‹å‰ï¼Œå¿…é¡»å…ˆè¿è¡Œavdevice_register_all()å¯¹è®¾å¤‡è¿›è¡Œæ³¨å†Œï¼Œå¦åˆ™å°±ä¼šå‡ºé”™ // https://blog.csdn.net/leixiaohua1020/article/details/41211121 avdevice_register_all(); //#endif // æ‰“å¼€ç½‘ç»œæµçš„è¯ï¼Œå‰é¢è¦åŠ ä¸Šå‡½æ•° // avformat_network_init(); // Initialize the cmdutils option system, in particular allocate the *_opts contexts. // åˆå§‹åŒ– cmdutils é€‰é¡¹ç³»ç»Ÿï¼Œç‰¹åˆ«æ˜¯åˆ†é… *_opts ä¸Šä¸‹æ–‡ã€‚ // init_opts(); // signal(SIGINT , sigterm_handler); /* Interrupt (ANSI). */ // signal(SIGTERM, sigterm_handler); /* Termination (ANSI). */ // å°†ç¨‹åºæ¨ªå¹…æ‰“å°åˆ° stderrã€‚ æ¨ªå¹…å†…å®¹å–å†³äºå½“å‰ç‰ˆæœ¬çš„å­˜å‚¨åº“å’Œç¨‹åºä½¿ç”¨çš„ libav* åº“ã€‚ // Print the program banner to stderr. The banner contents depend // on the current version of the repository and of the libav* libraries used by // the program. // show_banner(argc, argv, options); // parse_options(NULL, argc, argv, options, opt_input_file); // input_filenameï¼šå‘½ä»¤è¡Œ -i æŒ‡å®šï¼Œè§†é¢‘è·¯å¾„ NSString *inPath = [[NSBundle mainBundle] pathForResource:@\"test\" ofType:@\"mov\"]; input_filename = [inPath UTF8String]; if (!input_filename) { // show_usage(); // av_log(NULL, AV_LOG_FATAL, \"An input file must be specified\\n\"); // av_log(NULL, AV_LOG_FATAL, // \"Use -h to get full help or, even better, run 'man %s'\\n\", program_name); exit(1); } // display_disableï¼šå‘½ä»¤è¡Œ -nodisp æŒ‡å®šï¼Œä¸æ¸²æŸ“ç”»é¢ä¸æ’­æ”¾å£°éŸ³ // if (display_disable) { // video_disable = 1; // } flags = SDL_INIT_VIDEO | SDL_INIT_AUDIO | SDL_INIT_TIMER; // audio_disableï¼šå‘½ä»¤è¡Œ -an æŒ‡å®šï¼Œæ¸²æŸ“ç”»é¢ä¸æ’­æ”¾å£°éŸ³ // if (audio_disable) // flags &= ~SDL_INIT_AUDIO; // else { // /* Try to work around an occasional ALSA buffer underflow issue when the // * period size is NPOT due to ALSA resampling by forcing the buffer size. */ // if (!SDL_getenv(\"SDL_AUDIO_ALSA_SET_BUFFER_SIZE\")) // SDL_setenv(\"SDL_AUDIO_ALSA_SET_BUFFER_SIZE\",\"1\", 1); // } // if (display_disable) // flags &= ~SDL_INIT_VIDEO; // æŒ‡å®šflagsï¼ŒSDLåˆå§‹åŒ– if (SDL_Init (flags)) { av_log(NULL, AV_LOG_FATAL, \"Could not initialize SDL - %s\\n\", SDL_GetError()); av_log(NULL, AV_LOG_FATAL, \"(Did you set the DISPLAY variable?)\\n\"); exit(1); } // ç¦ç”¨ä¸€äº›äº‹ä»¶ SDL_EventState(SDL_SYSWMEVENT, SDL_IGNORE); SDL_EventState(SDL_USEREVENT, SDL_IGNORE); av_init_packet(&flush_pkt); flush_pkt.data = (uint8_t *)&flush_pkt; if (1/**!display_disable*/) { int flags = SDL_WINDOW_HIDDEN; // if (alwaysontop) #if SDL_VERSION_ATLEAST(2,0,5) flags |= SDL_WINDOW_ALWAYS_ON_TOP; #else av_log(NULL, AV_LOG_WARNING, \"Your SDL version doesn't support SDL_WINDOW_ALWAYS_ON_TOP. Feature will be inactive.\\n\"); #endif // borderlessï¼šå‘½ä»¤è¡Œ -noborder æŒ‡å®šï¼Œæ²¡æœ‰è¾¹æ¡† // if (borderless) // flags |= SDL_WINDOW_BORDERLESS; // else // å¯ä»¥è‡ªç”±æ‹‰ä¼¸ flags |= SDL_WINDOW_RESIZABLE; window = SDL_CreateWindow(program_name, SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, default_width, default_height, flags); // \"0\" or \"nearest\" - Nearest pixel sampling // \"1\" or \"linear\" - Linear filtering (supported by OpenGL and Direct3D) // \"2\" or \"best\" - Currently this is the same as \"linear\" SDL_SetHint(SDL_HINT_RENDER_SCALE_QUALITY, \"linear\"); if (window) { renderer = SDL_CreateRenderer(window, -1, SDL_RENDERER_ACCELERATED | SDL_RENDERER_PRESENTVSYNC); if (!renderer) { av_log(NULL, AV_LOG_WARNING, \"Failed to initialize a hardware accelerated renderer: %s\\n\", SDL_GetError()); renderer = SDL_CreateRenderer(window, -1, 0); } if (renderer) { if (!SDL_GetRendererInfo(renderer, &renderer_info)) av_log(NULL, AV_LOG_VERBOSE, \"Initialized %s renderer.\\n\", renderer_info.name); } } if (!window || !renderer || !renderer_info.num_texture_formats) { av_log(NULL, AV_LOG_FATAL, \"Failed to create window or renderer: %s\", SDL_GetError()); do_exit(NULL); } } is = stream_open(input_filename, file_iformat); if (!is) { av_log(NULL, AV_LOG_FATAL, \"Failed to initialize VideoState!\\n\"); do_exit(NULL); } event_loop(is); /* never returns */ return 0; } "},"pages/OpenGLç³»åˆ—/01_OpenGLæ¸²æŸ“ç»“æ„ä¸å¸¸ç”¨å›¾å…ƒ.html":{"url":"pages/OpenGLç³»åˆ—/01_OpenGLæ¸²æŸ“ç»“æ„ä¸å¸¸ç”¨å›¾å…ƒ.html","title":"1.OpenGLæ¸²æŸ“ç»“æ„ä¸å¸¸ç”¨å›¾å…ƒ","keywords":"","body":"1.OpenGLæ¸²æŸ“ç»“æ„ä¸å¸¸ç”¨å›¾å…ƒ å­¦ä¹ å†…å®¹ æŒæ¡OpenGLæ¸²æŸ“åŸºç¡€æ¶æ„ å¦‚ä½•ä½¿ç”¨7ç§OpenGLå‡ ä½•å›¾å…ƒ å¦‚ä½•ä½¿â½¤å­˜å‚¨ç€â¾Šå™¨ å¦‚ä½•ä½¿ç”¨Uniformå±æ€§ å¦‚ä½•ä½¿ç”¨GLBatchå¸®åŠ©ç±»åˆ›å»ºâ¼ä½•å›¾å½¢ ä¸€ã€OpenGL ä¸ ç€è‰²å™¨ åœ¨OpenGL 3.0ä¹‹å‰ï¼ŒOpenGL åŒ…å«ä¸€ä¸ªå›ºå®šåŠŸèƒ½çš„ç®¡çº¿ï¼Œå®ƒå¯ä»¥åœ¨ä¸ä½¿ç”¨ ç€â¾Šå™¨çš„æƒ…å†µä¸‹å¤„ç†ç†â¼ä½•ä¸åƒç´ æ•°æ®ã€‚åœ¨3.1ç‰ˆæœ¬å¼€å§‹ï¼Œå›ºå®šç®¡çº¿ä»æ ¸å¿ƒ æ¨¡å¼å»æ‰ã€‚å› æ­¤ç°åœ¨éœ€è¦ä½¿ç”¨ç€è‰²å™¨æ¥å®Œæˆâ¼¯ä½œã€‚ ä½¿â½¤ç”¨OpenGL æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨GLSL,(OpenGL Shading Langruageï¼Œå®ƒæ˜¯ åœ¨OpenGL 2.0ç‰ˆæœ¬å‘å¸ƒçš„)ã€‚ è¯­æ³•ä¸â€œCã€C++â€ç±»ä¼¼ã€‚ äºŒã€åŸºç¡€å›¾å½¢ç®¡çº¿ OpenGL ä¸­çš„å›¾å…ƒåªä¸è¿‡æ˜¯é¡¶ç‚¹çš„é›†åˆä»¥é¢„å®šä¹‰çš„æ–¹å¼ç»“åˆä¸€èµ·ç½¢äº†ã€‚ ä¾‹å¦‚:â¼€ä¸ªå•ç‹¬çš„ç‚¹å°±æ˜¯â¼€ä¸ªå›¾å…ƒã€‚å®ƒåªéœ€è¦â¼€ä¸ªé¡¶ç‚¹ 2.1 OpenGL æ¸²æŸ“ç®¡çº¿ç®€åŒ–ç‰ˆæœ¬ å®¢æˆ·æœºã€æœåŠ¡å™¨ ç®¡çº¿åˆ†ä¸ºä¸Šä¸‹2éƒ¨åˆ†ï¼Œä¸Šéƒ¨åˆ†æ˜¯å®¢æˆ·ç«¯ï¼Œè€Œä¸‹åŠéƒ¨åˆ†åˆ™æ˜¯æœåŠ¡ç«¯ã€‚ å®¢æˆ·ç«¯æ˜¯å­˜å‚¨åœ¨CPUå­˜å‚¨å™¨ä¸­çš„ï¼Œå¹¶ä¸”åœ¨åº”ç”¨ç¨‹åºä¸­æ‰§è¡Œï¼Œæˆ–è€…åœ¨ä¸»ç³» ç»Ÿå†…å­˜çš„é©±åŠ¨ç¨‹åºä¸­æ‰§â¾ã€‚é©±åŠ¨ç¨‹åºä¼šå°†æ¸²æŸ“å‘½ä»¤å’Œæ•°ç»„ç»„åˆèµ·æ¥ï¼Œå‘é€ç»™æœåŠ¡å™¨å™¨æ‰§â¾!(åœ¨â¼€å°å…¸å‹çš„ä¸ªäººè®¡ç®—æœºä¸Šï¼ŒæœåŠ¡å™¨å°±æ˜¯å®é™…ä¸Šå°± æ˜¯å›¾å½¢åŠ é€Ÿå¡ä¸Šçš„ç¡¬ä»¶å’Œå†…å­˜) æœåŠ¡å™¨ å’Œ å®¢æˆ·æœºåœ¨åŠŸèƒ½ä¸Šä¹Ÿæ˜¯å¼‚æ­¥çš„ã€‚ å®ƒä»¬æ˜¯å„â¾ƒç‹¬ç«‹çš„è½¯ä»¶å—æˆ–ç¡¬ä»¶å—ã€‚æˆ‘ä»¬æ˜¯å¸Œæœ›å®ƒä»¬2ä¸ªç«¯éƒ½å°½é‡åœ¨ä¸åœçš„å·¥ä½œã€‚å®¢æˆ·ç«¯ä¸æ–­çš„æŠŠæ•°æ®å—å’Œå‘½ä»¤å—ç»„åˆåœ¨ä¸€èµ·è¾“é€åˆ°ç¼“å†²åŒºï¼Œç„¶åç¼“å†²åŒºå°±ä¼šå‘é€åˆ°æœåŠ¡å™¨ æ‰§è¡Œã€‚ å¦‚æœæœåŠ¡å™¨åœæ­¢â¼¯ä½œç­‰å¾…å®¢æˆ·æœºï¼Œæˆ–è€…å®¢æˆ·æœºåœæ­¢å·¥ä½œæ¥ç­‰å¾…æœåŠ¡å™¨åš å¥½æ¥å—æ›´å¤šçš„å‘½ä»¤å’Œå‡†å¤‡ï¼Œæˆ‘ä»¬æŠŠè¿™ç§æƒ…å†µæˆä¸ºç®¡çº¿åœæ»ã€‚ ç€è‰²å™¨ ä¸Šå›¾çš„Vertex Shader(é¡¶ç‚¹ç€â¾Šå™¨) å’Œ Fragment Shader(â½šæ®µç€è‰²å™¨)ã€‚ ç€â¾Šå™¨æ˜¯ä½¿â½¤ç”¨GLSLç¼–å†™çš„ç¨‹åºï¼Œçœ‹èµ·æ¥ä¸Cè¯­â¾”éå¸¸ç±»ä¼¼ã€‚ ç€â¾Šå™¨å¿… é¡»ä»æºä»£ç ä¸­ç¼–è¯‘å’Œé“¾æ¥åœ¨ä¸€èµ·ã€‚æœ€ç»ˆå‡†å¤‡å°±ç»ªçš„ç€â¾Šå™¨ç¨‹åº é¡¶ç‚¹ç€â¾Šå™¨-->å¤„ç†ä»å®¢æˆ·æœºè¾“â¼Šçš„æ•°æ®ã€åº”â½¤å˜æ¢ã€è¿›è¡Œå…¶ä»–çš„ç±»å‹ çš„æ•°å­¦è¿ç®—æ¥è®¡ç®—å…³ç…§æ•ˆæœã€ä½ç§»ã€é¢œè‰²å€¼ç­‰ã€‚(**ä¸ºäº†æ¸²æŸ“å…±æœ‰3ä¸ªé¡¶ç‚¹çš„ä¸‰â»†å½¢ï¼Œé¡¶ç‚¹ç€â¾Šå™¨å°†æ‰§è¡Œ3æ¬¡ï¼Œä¹Ÿå°±æ˜¯ä¸ºäº†æ¯ä¸ªé¡¶ç‚¹æ‰§è¡Œâ¼€æ¬¡)åœ¨â½¬å‰çš„ç¡¬ä»¶ä¸Šæœ‰å¤šä¸ªæ‰§è¡Œå•å…ƒåŒæ—¶è¿è¡Œï¼Œå°±æ„å‘³ç€æ‰€æœ‰çš„3ä¸ªé¡¶ç‚¹å¯ä»¥åŒæ—¶è¿›â¾å¤„ç†! å›¾ä¸Š(primitive Assembly è¯´æ˜çš„æ˜¯:3ä¸ªé¡¶ç‚¹å·²ç»ç»„åˆåœ¨ä¸€èµ·ï¼Œâ½½ä¸‰â»† å½¢å·²ç»é€ä¸ªç‰‡æ®µçš„è¿›â¾äº†å…‰æ …åŒ–ã€‚æ¯ä¸ªâ½šæ®µé€šè¿‡æ‰§â¾â½šå…ƒç€â¾Šå™¨è¿›è¡Œ å¡«å……ã€‚â½šå…ƒç€â¾Šå™¨ä¼šè¾“å‡ºæˆ‘ä»¬å°†å±å¹•ä¸Šçœ‹åˆ°çš„æœ€ç»ˆé¢œè‰²å€¼ã€‚ é‡ç‚¹! æˆ‘ä»¬å¿…é¡»åœ¨è¿™ä¹‹å‰ä¸ºç€â¾Šè‰²å™¨å™¨æä¾›æ•°æ®ï¼Œå¦åˆ™ä»€ä»€ä¹ˆéƒ½â½†æ— æ³•å®ç°! æœ‰3ç§å‘OpenGL ç€â¾Šè‰²å™¨å™¨ä¼ é€’æ¸²æŸ“æ•°æ®çš„â½…æ–¹æ³•å¯ä¾›æˆ‘ä»¬é€‰æ‹© 1.å±æ€§ 2.uniform å€¼ 3.çº¹ç†ç† ä¸‰ã€å±æ€§ã€uniformå€¼ã€çº¹ç†ç†ã€è¾“å‡º 3.1 å±æ€§ å±æ€§:å°±æ˜¯å¯¹æ¯â¼€ä¸ªé¡¶ç‚¹éƒ½è¦ä½œæ”¹å˜çš„æ•°æ®å…ƒç´ ã€‚å®é™…ä¸Šï¼Œé¡¶ç‚¹ä½ç½®æœ¬èº« å°±æ˜¯â¼€ä¸ªå±æ€§ã€‚å±æ€§å€¼å¯ä»¥æ˜¯æµ®ç‚¹æ•°ã€æ•´æ•°ã€å¸ƒå°”æ•°æ®ã€‚ å±æ€§æ€»æ˜¯ä»¥å››ç»´å‘é‡é‡çš„å½¢å¼è¿›è¡Œå†…éƒ¨å­˜å‚¨çš„ï¼Œå³ä½¿æˆ‘ä»¬ä¸ä¼šä½¿ç”¨æ‰€æœ‰çš„ 4ä¸ªåˆ†é‡é‡ã€‚â¼€ä¸ªé¡¶ç‚¹ä½ç½®å¯èƒ½å­˜å‚¨(x,y,z)ï¼Œå°†å æœ‰4ä¸ªåˆ†é‡ä¸­çš„3ä¸ªã€‚ å®é™…ä¸Šå¦‚æœæ˜¯åœ¨å¹³â¾¯æƒ…å†µä¸‹:åªè¦åœ¨xyå¹³â¾¯ä¸Šå°±èƒ½ç»˜åˆ¶ï¼Œé‚£ä¹ˆZåˆ†é‡å°± ä¼šè‡ªåŠ¨è®¾ç½®ä¸º0; å±æ€§è¿˜å¯ä»¥æ˜¯:çº¹ç†åæ ‡ã€é¢œâ¾Šå€¼ã€å…‰ç…§è®¡ç®—è¡¨â¾¯æ³•çº¿ åœ¨é¡¶ç‚¹ç¨‹åº(shaderæ¸²æŸ“)å¯ä»¥ä»£è¡¨ä½ æƒ³è¦çš„ä»»ä½•æ„ä¹‰ã€‚å› ä¸ºéƒ½æ˜¯ä½ è®¾ å®šçš„ã€‚ å±æ€§ä¼šä»æœ¬åœ°å®¢æˆ·æœºå†…å­˜ä¸­å¤åˆ¶å­˜å‚¨åœ¨å›¾å½¢ç¡¬ä»¶ä¸­çš„â¼€ä¸ªç¼“å†²åŒºä¸Šã€‚è¿™äº›å±æ€§åªæä¾›ç»™é¡¶ç‚¹ç€â¾Šå™¨ä½¿ç”¨ï¼Œå¯¹äºâ½šå…ƒç€è‰²å™¨â½Šæœ‰å¤ªå¤§æ„ä¹‰ã€‚ å£°æ˜:è¿™äº›å±æ€§å¯¹æ¯ä¸ªé¡¶ç‚¹éƒ½è¦åšæ”¹å˜ï¼Œä½†å¹¶ä¸æ„å‘³ç€å®ƒä»¬çš„å€¼ä¸èƒ½é‡å¤ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå®ƒä»¬éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æœ‰å¯èƒ½æ•´ä¸ªæ•°ç»„éƒ½æ˜¯åŒä¸€å€¼çš„ æƒ…å†µã€‚ 3.2 Uniformå€¼ å±æ€§æ˜¯â¼€ç§å¯¹æ•´ä¸ªæ‰¹æ¬¡å±æ€§éƒ½å–ç»Ÿä¸€å€¼çš„å•â¼€å€¼ã€‚å®ƒæ˜¯ä¸å˜çš„ã€‚é€šè¿‡è®¾ç½®uniformå˜é‡å°±ç´§æ¥ç€å‘é€ä¸€ä¸ªå›¾å…ƒæ‰¹æ¬¡å‘½ä»¤ï¼ŒUniformå˜é‡å®é™…ä¸Šå¯ä»¥æ— æ•°æ¬¡é™åˆ¶åœ°ä½¿â½¤ç”¨ï¼Œè®¾ç½®ä¸€ä¸ªåº”ç”¨äºæ•´ä¸ªè¡¨â¾¯çš„å•ä¸ªé¢œè‰²å€¼ï¼Œè¿˜å¯ä»¥è®¾ç½®â¼€ ä¸ªæ—¶é—´å€¼ã€‚åœ¨æ¯æ¬¡æ¸²æŸ“æŸç§ç±»å‹çš„é¡¶ç‚¹åŠ¨ç”»æ—¶ä¿®æ”¹å®ƒã€‚ æ³¨æ„:è¿™â¾¥çš„uniformå˜é‡æ¯ä¸ªæ‰¹æ¬¡æ”¹å˜ä¸€æ¬¡ï¼Œâ½½ä¸æ˜¯æ¯ä¸ªé¡¶ç‚¹æ”¹å˜ä¸€æ¬¡ã€‚ uniformå˜é‡æœ€å¸¸è§çš„åº”â½¤æ˜¯åœ¨é¡¶ç‚¹æ¸²æŸ“ä¸­è®¾ç½®å˜æ¢çŸ©é˜µ åâ¾¯çš„è¯¾ç¨‹ä¼šè¯¦ç»†è®²è§£ ä¸å±æ€§ç›¸åŒç‚¹:å¯ä»¥æ˜¯æµ®ç‚¹å€¼ã€æ•´æ•°ã€å¸ƒå°”å€¼ ä¸å±æ€§ä¸åŒç‚¹:é¡¶ç‚¹ç€â¾Šå™¨å’Œç‰‡å…ƒç€è‰²å™¨éƒ½å¯ä»¥ä½¿ç”¨uniformå˜é‡ã€‚uniform å˜é‡è¿˜å¯ä»¥æ˜¯æ ‡é‡ç±»å‹ã€â½®é‡ç±»å‹ã€uniformçŸ©é˜µã€‚ 3.3 çº¹ç† ä¼ é€’ç»™ç€â¾Šå™¨çš„ç¬¬ä¸‰ç§æ•°æ®ç±»å‹:çº¹ç†æ•°æ® ç°åœ¨å°±æ•™å¤§å®¶å¦‚æœå¤„ç†çº¹ç†æ•°æ®å¹¶å°†å…¶ä¼ é€’ç»™ç€â¾Šå™¨çš„ç»†èŠ‚è¿˜ä¸ºæ—¶è¿‡æ—©ã€‚ æˆ‘ä»¬å…ˆåœ¨å‰â¾¯çš„è¯¾ç¨‹ä¸­ï¼Œäº†è§£ä»€ä¹ˆå«åšçº¹ç†! åœ¨é¡¶ç‚¹ç€â¾Šå™¨ã€â½šæ®µç€â¾Šå™¨ä¸­éƒ½å¯ä»¥å¯¹çº¹ç†æ•°æ®è¿›â¾é‡‡æ ·å’Œç­›é€‰ã€‚ å…¸å‹çš„åº”â½¤åœºæ™¯:â½šæ®µç€â¾Šå™¨å¯¹â¼€ä¸ªçº¹ç†å€¼è¿›è¡Œé‡‡æ ·ï¼Œç„¶ååœ¨â¼€ä¸ªä¸‰â»†å½¢è¡¨â¾¯åº”â½¤æ¸²æŸ“çº¹ç†æ•°æ®ã€‚ çº¹ç†æ•°æ®ï¼Œä¸ä»…ä»…è¡¨ç°åœ¨å›¾å½¢ï¼Œå¾ˆå¤šå›¾å½¢â½‚ä»¶æ ¼å¼éƒ½æ˜¯ä»¥æ— ç¬¦å·å­—èŠ‚(æ¯ä¸ªé¢œâ¾Šé€šé“8ä½)å½¢å¼å¯¹é¢œâ¾Šåˆ†é‡è¿›â¾å­˜å‚¨çš„ã€‚ 3.4 è¾“å‡º åœ¨å›¾è¡¨ä¸­ç¬¬å››ç§æ•°æ®ç±»å‹æ˜¯è¾“å‡º(out);è¾“å‡ºæ•°æ®æ˜¯ä½œä¸ºâ¼€ä¸ªé˜¶æ®µç€â¾Š å™¨çš„è¾“å‡ºå®šä¹‰çš„ï¼Œâ¼†åç»­é˜¶æ®µçš„ç€â¾Šå™¨åˆ™ä½œä¸ºè¾“â¼Šå®šä¹‰ã€‚ è¾“å‡ºæ•°æ®å¯ä»¥ç®€å•çš„ä»â¼€ä¸ªé˜¶æ®µä¼ é€’åˆ°ä¸‹â¼€ä¸ªé˜¶æ®µï¼Œä¹Ÿå¯ä»¥â½¤ä¸åŒçš„â½…å¼æ’â¼Šã€‚ å®¢æˆ·ç«¯çš„ä»£ç æ¥è§¦ä¸åˆ°è¿™äº›å†…éƒ¨å˜é‡ æˆ‘ä»¬çš„OpenGLå¼€å‘æš‚æ—¶æ¥è§¦ä¸åˆ°ã€‚ å››ã€åˆ›å»ºåæ ‡ç³» 4.1 æ­£æŠ•å½± è¿™å°±æ˜¯â¼€ä¸ªæ­£æŠ•å½±çš„ä¾‹å­ï¼Œåœ¨æ‰€åœ¨3ä¸ªè½´(X,Y,Z)ä¸­ï¼Œå®ƒä»¬çš„èŒƒå›´éƒ½æ˜¯ ä»-100åˆ°+100ã€‚è¿™ä¸ªè§†æ™¯ä½“å°†åŒ…æ‹¬æ‰€æœ‰çš„â¼ä½•å›¾å½¢ã€‚ å¦‚æœä½ æŒ‡å®šäº†è§†æ™¯ä½“å¤–çš„â¼ä½•å›¾å½¢ï¼Œå°±ä¼šè¢«è£å‡æ‰!(å®ƒå°†æ²¿ç€è§†æ™¯ä½“çš„è¾¹ç•Œè¿›è¡Œå‰ªåˆ‡) åœ¨æ­£æŠ•å½±ä¸­ï¼Œæ‰€æœ‰åœ¨è¿™ä¸ªç©ºé—´èŒƒå›´å†…çš„æ‰€æœ‰ä¸œâ»„éƒ½å°†è¢«å‘ˆç°åœ¨å±å¹•ä¸Šã€‚â½½ ä¸å­˜åœ¨ç…§ç›¸æœºæˆ–è§†ç‚¹åæ ‡ç³»çš„æ¦‚å¿µã€‚ 4.2 é€è§†æŠ•å½± é€è§†æŠ•å½±ä¼šè¿›è¡Œé€è§†é™¤æ³•å¯¹è·ç¦»è§‚å¯Ÿè€…å¾ˆè¿œçš„å¯¹è±¡è¿›â¾ç¼©çŸ­å’Œæ”¶ç¼©ã€‚åœ¨æŠ• å½±åˆ°å±å¹•ä¹‹åï¼Œè§†æ™¯ä½“èƒŒâ¾¯ä¸è§†æ™¯ä½“æ­£â¾¯çš„å®½åº¦æµ‹é‡æ ‡å‡†ä¸åŒã€‚ ä¸Šå›¾æ‰€ç¤º:å¹³æˆªå¤´ä½“(frustum)çš„â¼ä½•ä½“ï¼Œå®ƒçš„è§‚å¯Ÿâ½…å‘æ˜¯ä»â¾¦å­—å¡”çš„ å°–ç«¯åˆ°å®½é˜”ç«¯ã€‚è§‚å¯Ÿè€…çš„è§†ç‚¹ä¸â¾¦å­—å¡”çš„å°–ç«¯æ‹‰å¼€â¼€å®šè·ç¦»ã€‚ GLFrustumç±»é€šè¿‡setPerspectiveâ½…æ³•ä¸ºæˆ‘ä»¬æ„å»ºâ¼€ä¸ªå¹³æˆªå¤´ä½“ã€‚ CLFrustum::SetPerspective(float fFov,float fAspect,float fNear ,float fFar); å‚æ•°: fFov:å‚ç›´â½…å‘ä¸Šçš„è§†åœºâ»†åº¦ fAspect:çª—â¼çš„å®½åº¦ä¸â¾¼åº¦çš„çºµæ¨ªâ½ fNear:è¿‘è£å‰ªâ¾¯è·ç¦» fFar:è¿œè£å‰ªâ¾¯è·ç¦» çºµæ¨ªâ½æ¯” = å®½(w)/â¾¼(h) äº”ã€ä½¿â½¤å­˜å‚¨ç€â¾Šå™¨ 5.1 ä½¿â½¤èƒŒæ™¯ åœ¨OpenGLæ ¸â¼¼æ¡†æ¶ä¸­ï¼Œå¹¶æ²¡æœ‰æä¾›ä»»ä½•å†…å»ºæ¸²æŸ“ç®¡çº¿ï¼Œåœ¨æäº¤ä¸€ä¸ªâ¼ä½•å›¾å½¢è¿›è¡Œæ¸²æŸ“ä¹‹å‰ï¼Œå¿…é¡»å®ç°â¼€ä¸ªç€â¾Šå™¨ã€‚ åœ¨å‰â¾¯çš„è¯¾ç¨‹å¯ä»¥ä½¿ç”¨å­˜å‚¨ç€â¾Šå™¨ã€‚è¿™äº›å­˜å‚¨ç€â¾Šå™¨ç”±GLToolsçš„C++ç±» GLShaderManagerç®¡ç†ã€‚å®ƒä»¬èƒ½å¤Ÿæ»¡â¾œè¿›è¡ŒåŸºæœ¬æ¸²æŸ“çš„åŸºæœ¬è¦æ±‚ã€‚è¦æ±‚ä¸é«˜çš„ç¨‹åºå‘˜ï¼Œè¿™äº›å­˜å‚¨ç€â¾Šå™¨å·²ç»â¾œä»¥æ»¡è¶³ä»–ä»¬çš„éœ€æ±‚ã€‚ä½†æ˜¯ï¼Œéšç€æ—¶é—´å’Œç»éªŒçš„æå‡ï¼Œâ¼¤éƒ¨åˆ†å¼€å‘è€…å¯èƒ½ä¸æ»¡â¾œäºæ­¤ã€‚ ä¼šå¼€å§‹â¾ƒè‡ªå·±ç€â¼¿å»å†™ç€â¾Šå™¨ã€‚ 5.2 å­˜å‚¨ç€â¾Šå™¨çš„ä½¿â½¤ GLShaderManager çš„åˆå§‹åŒ– // GLShaderManager çš„åˆå§‹åŒ– GLShaderManager shaderManager; shaderManager.InitializeStockShaders() GLShaderManager å±æ€§ å­˜å‚¨ç€â¾Šå™¨ä¸ºæ¯â¼€ä¸ªå˜é‡éƒ½ä½¿ç”¨ä¸€è‡´çš„å†…éƒ¨å˜é‡å‘½åè§„åˆ™å’Œç›¸åŒçš„å±æ€§ æ§½ã€‚ä»¥ä¸Šå°±æ˜¯å­˜å‚¨ç€è‰²å™¨çš„å±æ€§åˆ—åˆ—è¡¨ GLShanderManager çš„ uniformå€¼ â¼€èˆ¬æƒ…å†µï¼Œè¦å¯¹â¼ä½•å›¾å½¢è¿›è¡Œæ¸²æŸ“ï¼Œæˆ‘ä»¬éœ€è¦ç»™å¯¹è±¡é€’å±æ€§çŸ©é˜µï¼Œâ¾¸ å…ˆè¦ç»‘å®šæˆ‘ä»¬æƒ³è¦ä½¿â½¤çš„ç€â¾Šç¨‹åºä¸Šï¼Œå¹¶æä¾›ç¨‹åºçš„uniformå€¼ã€‚ä½†æ˜¯GLShanderManager ç±»å¯ä»¥æš‚æ—¶ä¸ºæˆ‘ä»¬å®Œæˆå·¥ä½œã€‚ userStockShaderå‡½æ•°ä¼šé€‰æ‹©â¼€ä¸ªå­˜å‚¨ç€â¾Šå™¨å¹¶æä¾›è¿™ä¸ªç€â¾Šå™¨çš„ uniformå€¼ã€‚ GLShaderManager::UserStockShader(GLeunm shader...); å•ä½(Identity ç€â¾Šå™¨) GLShaderManager::UserStockShader(GLT_ATTRIBUTE_VERTEX,GLfloat vColor[4]); å•ä½ç€â¾Šå™¨:åªæ˜¯ç®€å•åœ°ä½¿â½¤é»˜è®¤ç¬›å¡å°”åæ ‡ç³»(åæ ‡èŒƒå›´(-1.0ï¼Œ 1.0))ã€‚æ‰€æœ‰çš„â½šæ®µéƒ½åº”â½¤åŒä¸€ç§é¢œè‰²ï¼Œå‡ ä½•å›¾å½¢ä¸ºå®â¼¼å’Œæœªæ¸²æŸ“çš„ã€‚ éœ€è¦è®¾ç½®å­˜å‚¨ç€è‰²å™¨â¼€ä¸ªå±æ€§: GLT_ATTRIBUTE_VERTEX(é¡¶ç‚¹åˆ†é‡) å‚æ•°2:vColor[4],ä½ éœ€è¦çš„é¢œè‰²ã€‚ å¹³â¾¯ç€â¾Šå™¨ GLShaderManager::UserStockShader(GLT_SHADER_FLAT,GLfloat mvp[1 6],GLfloat vColor[4]); å‚æ•°1:å¹³â¾¯ç€â¾Šå™¨ å‚æ•°2:å…è®¸å˜åŒ–çš„4*4çŸ©é˜µ å‚æ•°3:é¢œâ¾Š å®ƒå°†ç»Ÿâ¼€ç€â¾Šå™¨å™¨è¿›è¡Œäº†æ‹“å±•ã€‚å…è®¸ä¸ºâ¼ä½•å›¾å½¢å˜æ¢æŒ‡å®šä¸€ä¸ª 4 * 4 å˜æ¢çŸ© é˜µã€‚ç»å¸¸è¢«ç§°ä¸ºâ€œæ¨¡å‹è§†å›¾æŠ•å½±çŸ©é˜µâ€ ä¸Šâ¾Šç€â¾Šå™¨ GLShaderManager::UserStockShader(GLT_SHADER_SHADED,GLfloat mvp [16]); åœ¨â¼å‡ ä½•å›¾å½¢ä¸­åº”â½¤ç”¨çš„å˜æ¢çŸ©é˜µã€‚ éœ€è¦è®¾ç½®å­˜å‚¨ç€è‰²å™¨çš„ GLT_ATTRIBUTE_VERTEX(é¡¶ç‚¹åˆ†é‡) å’Œ GLT_ATTRIBUTE_COLOR(é¢œâ¾Šè‰²åˆ†é‡é‡) 2ä¸ªå±æ€§ã€‚é¢œâ¾Šå€¼å°†è¢«å¹³æ»‘åœ°æ’â¼Šé¡¶ç‚¹ä¹‹é—´(å¹³æ»‘ç€è‰²) é»˜è®¤å…‰æºç€â¾Šå™¨ GLShaderManager::UserStockShader(GLT_SHADER_DEFAULT_LIGHT,GLfloat mvMatrix[16],GLfloat pMatrix[16],GLfloat vColor[4]); å‚æ•°1:é»˜è®¤å…‰æºç€è‰²å™¨ å‚æ•°2:æ¨¡å‹è§†å›¾çŸ©é˜µ å‚æ•°3:æŠ•å½±çŸ©é˜µ å‚æ•°4:é¢œè‰²å€¼ è¿™ç§ç€â¾Šå™¨ï¼Œæ˜¯å¯¹è±¡äº§â½£é˜´å½±å’Œå…‰ç…§çš„æ•ˆæœã€‚éœ€è¦è®¾ç½®å­˜å‚¨ç€â¾Šå™¨çš„ GLT_ATTRIBUTE_VERTEX(é¡¶ç‚¹åˆ†é‡) å’Œ GLT_ATTRIBUTE_NORMAL(è¡¨â¾¯é¢æ³•çº¿) ç‚¹å…‰æºç€â¾Šè‰²å™¨å™¨ GLShaderManager::UserStockShader(GLT_SHADER_DEFAULT_LIGHT_DIEF ,GLfloat mvMatrix[16],GLfloat pMatrix[16],GLfloat vLightPos[3] ,GLfloat vColor[4]); å‚æ•°1:ç‚¹å…‰æºç€â¾Šå™¨ å‚æ•°2:æ¨¡å‹è§†å›¾çŸ©é˜µ å‚æ•°3:æŠ•å½±çŸ©é˜µ å‚æ•°4:è§†ç‚¹åæ ‡å…‰æºä½ç½® å‚æ•°5:é¢œâ¾Šå€¼ ç‚¹å…‰æºç€â¾Šå™¨å’Œé»˜è®¤å…‰æºç€è‰²å™¨å¾ˆç›¸ä¼¼ï¼ŒåŒºåˆ«åœ¨äº:å…‰æºä½ç½®æ˜¯ç‰¹å®šçš„ã€‚ åŒæ ·éœ€è¦è®¾ç½®å­˜å‚¨ç€è‰²å™¨çš„ GLT_ATTRIBUTE_VERTEX(é¡¶ç‚¹åˆ†é‡) å’Œ GLT_ATTRIBUTE_NORMAL(è¡¨â¾¯æ³•çº¿) çº¹ç†æ›¿æ¢çŸ©é˜µ GLShaderManager::UserStockShader(GLT_SHADER_TEXTURE_REPLACE,GL float mvMatrix[16],GLint nTextureUnit); ç€â¾Šå™¨é€šè¿‡ç»™å®šçš„æ¨¡å‹è§†å›¾æŠ•å½±çŸ©é˜µï¼Œä½¿â½¤ç»‘å®šåˆ° nTextureUnit (çº¹ç†å•å…ƒ) æŒ‡å®šçº¹ç†å•å…ƒçš„çº¹ç†å¯¹å‡ ä½•å›¾å½¢è¿›è¡Œå˜åŒ–ã€‚ â½šæ®µé¢œè‰²:æ˜¯ç›´æ¥ä»çº¹ç†æ ·æœ¬ä¸­ç›´æ¥è·å–çš„ã€‚ éœ€è¦è®¾ç½®å­˜å‚¨ç€â¾Šå™¨çš„ GLT_ATTRIBUTE_VERTEX(é¡¶ç‚¹åˆ†é‡) å’Œ GLT_ATTRIBUTE_NORMAL(è¡¨â¾¯æ³•çº¿) çº¹ç†è°ƒæ•´ç€â¾Šå™¨ GLShaderManager::UserStockShader(GLT_SHADER_TEXTURE_MODULATE,GLfloat mvMatrix[16],GLfloat vColor[4],GLint nTextureUnit); å°†â¼€ä¸ªåŸºæœ¬â¾Šä¹˜ä»¥ä¸€ä¸ªå–â¾ƒçº¹ç†å•å…ƒ nTextureUnit çš„çº¹ç†ã€‚ éœ€è¦è®¾ç½®å­˜å‚¨ç€è‰²å™¨çš„ GLT_ATTRIBUTE_VERTEX(é¡¶ç‚¹åˆ†é‡) å’Œ GLT_ATTRIBUTE_TEXTURE0(çº¹ç†åæ ‡) çº¹ç†å…‰æºç€â¾Šå™¨ GLShaderManager::UserStockShader(GLT_SHADER_TEXTURE_POINT_LIGH T_DIEF,GLfloat mvMatrix[16],GLfloat pMatrix[16],GLfloat vLight Pos[3],GLfloat vBaseColor[4],GLint nTextureUnit); å‚æ•°1:çº¹ç†å…‰æºç€â¾Šå™¨ å‚æ•°2:æŠ•å½±çŸ©é˜µ å‚æ•°3:è§†è§‰ç©ºé—´ä¸­çš„å…‰æºä½ç½® å‚æ•°4:â¼ä½•å›¾å½¢çš„åŸºæœ¬â¾Š å‚æ•°5:å°†è¦ä½¿ç”¨çš„çº¹ç†å•å…ƒ å°†â¼€ä¸ªçº¹ç†é€šè¿‡æ¼«åå°„ç…§æ˜è®¡ç®—æœºè¿›è¡Œè°ƒæ•´(ç›¸ä¹˜)ã€‚å…‰çº¿åœ¨è§†è§‰ç©ºé—´ä¸­çš„ä½ç½®æ˜¯ç»™å®šçš„ã€‚ éœ€è¦è®¾ç½®å­˜å‚¨ç€â¾Šå™¨çš„ GLT_ATTRIBUTE_VERTEX(é¡¶ç‚¹åˆ†é‡) å’Œ GLT_ATTRIBUTE_TEXTURE0(çº¹ç†åæ ‡)ã€GLT_ATTRIBUTE_NORMAL(è¡¨â¾¯æ³•çº¿) "},"pages/OpenGLç³»åˆ—/02_OpenGLåŸºç¡€æ¸²æŸ“.html":{"url":"pages/OpenGLç³»åˆ—/02_OpenGLåŸºç¡€æ¸²æŸ“.html","title":"2.OpenGLåŸºç¡€æ¸²æŸ“","keywords":"","body":"2.OpenGLåŸºç¡€æ¸²æŸ“ This browser does not support PDFs. Please download the PDF to view it: Download PDF. "},"pages/OpenGLç³»åˆ—/03_OpenGLæ¸²æŸ“é—®é¢˜çš„å¤„ç†æ–¹æ³•.html":{"url":"pages/OpenGLç³»åˆ—/03_OpenGLæ¸²æŸ“é—®é¢˜çš„å¤„ç†æ–¹æ³•.html","title":"3.OpenGLæ¸²æŸ“é—®é¢˜çš„å¤„ç†æ–¹æ³•","keywords":"","body":"3.OpenGLæ¸²æŸ“é—®é¢˜çš„å¤„ç†æ–¹æ³• å­¦ä¹ å†…å®¹ æ¸²æŸ“è¿‡ç¨‹ä¸­å¯èƒ½äº§â½£çš„é—®é¢˜ æ²¹ç”»æ¸²æŸ“ æ­£â¾¯é¢&èƒŒâ¾¯é¢å‰”é™¤ æ·±åº¦æµ‹è¯• å¤šè¾¹å½¢æ¨¡å‹ å¤šè¾¹å½¢åç§» è£å‰ª ä¸€ã€åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­å¯èƒ½äº§â½£çš„é—®é¢˜ åœ¨ç»˜åˆ¶3Dåœºæ™¯çš„æ—¶å€™,æˆ‘ä»¬éœ€è¦å†³å®šå“ªäº›éƒ¨åˆ†æ˜¯å¯¹è§‚å¯Ÿè€… å¯â»…çš„,æˆ–è€…å“ªäº›éƒ¨åˆ†æ˜¯å¯¹è§‚å¯Ÿè€…ä¸å¯â»…çš„.å¯¹äºä¸å¯â»…çš„ éƒ¨åˆ†,åº”è¯¥åŠæ—©ä¸¢å¼ƒ.ä¾‹å¦‚åœ¨â¼€ä¸ªä¸é€æ˜çš„å¢™å£å,å°±ä¸åº”è¯¥ æ¸²æŸ“.è¿™ç§æƒ…å†µå«åšâ€œéšè—â¾¯æ¶ˆé™¤â€(Hidden surface elimination). äºŒã€æ²¹ç”»ç®—æ³• 2.1 è§£é‡Š å…ˆç»˜åˆ¶åœºæ™¯ä¸­çš„ç¦»è§‚å¯Ÿè€…è¾ƒè¿œçš„ç‰©ä½“,å†ç»˜åˆ¶è¾ƒè¿‘çš„ç‰©ä½“. ä¾‹å¦‚ä¸‹â¾¯çš„å›¾ä¾‹ï¼šå…ˆç»˜åˆ¶çº¢â¾Šéƒ¨åˆ†,å†ç»˜åˆ¶â»©â¾Šéƒ¨åˆ†,æœ€åå†ç»˜åˆ¶ç°è‰²éƒ¨åˆ†,å³å¯è§£å†³éšè—â¾¯æ¶ˆé™¤çš„ é—®é¢˜ã€‚ 2.2 å¼Šç«¯ ä½¿â½¤æ²¹ç”»ç®—æ³•,åªè¦å°†åœºæ™¯æŒ‰ç…§ç‰©ç†è·ç¦»è§‚å¯Ÿè€…çš„è·ç¦»è¿œè¿‘æ’åº,ç”±è¿œåŠè¿‘çš„ç»˜åˆ¶å³å¯.é‚£ä¹ˆä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜? å¦‚æœä¸‰ä¸ªä¸‰è§’å½¢æ˜¯å åŠ çš„æƒ…å†µ,æ²¹ç”»ç®—æ³•å°†â½†æ³•å¤„ç†. ä¸‰ã€æ­£èƒŒâ¾¯å‰”é™¤(Face Culling) 3.1 æ€è€ƒ â¼€ä¸ª3Då›¾å½¢,ä½ ä»ä»»ä½•â¼€ä¸ªâ½…å‘å»è§‚å¯Ÿ,æœ€å¤šå¯ä»¥çœ‹åˆ°å‡ ä¸ªé¢? ç­”æ¡ˆï¼šæœ€å¤š3â¾¯. ä»â¼€ä¸ªâ½´â½…ä½“çš„ä»»æ„ä½ç½®å’Œâ½…å‘ä¸Šçœ‹,ä½ ç”¨è¿‡ä¸å¯èƒ½çœ‹åˆ°å¤šäº3ä¸ªé¢. é‚£ä¹ˆæ€è€ƒ? æˆ‘ä»¬ä¸ºä½•è¦å¤šä½™çš„å»ç»˜åˆ¶é‚£æ ¹æœ¬çœ‹ä¸åˆ°çš„3ä¸ªé¢? å¦‚æœæˆ‘ä»¬èƒ½ä»¥æŸç§æ–¹å¼å»ä¸¢å¼ƒè¿™éƒ¨åˆ†æ•°æ®,OpenGLåœ¨æ¸²æŸ“çš„æ€§èƒ½å³å¯æâ¾¼è¶…è¿‡50%. å¦‚ä½•çŸ¥é“æŸä¸ªé¢åœ¨è§‚å¯Ÿè€…çš„è§†ô°€ä¸­ä¸ä¼šå‡ºç°? ä»»ä½•å¹³â¾¯éƒ½æœ‰2ä¸ªé¢,æ­£é¢/èƒŒé¢.æ„å‘³ç€ä½ â¼€ä¸ªæ—¶åˆ»åªèƒ½çœ‹åˆ°ä¸€â¾¯.OpenGL å¯ä»¥åšåˆ°æ£€æŸ¥æ‰€æœ‰æ­£é¢æœå‘è§‚å¯Ÿè€…çš„é¢,å¹¶æ¸²æŸ“å®ƒä»¬.ä»â½½ä¸¢å¼ƒèƒŒâ¾¯æœå‘çš„â¾¯. è¿™æ ·å¯ä»¥ èŠ‚çº¦â½šå…ƒç€â¾Šå™¨çš„æ€§èƒ½. å¦‚æœå‘Šè¯‰OpenGLä½ ç»˜åˆ¶çš„å›¾å½¢,å“ªä¸ªé¢æ˜¯æ­£é¢,å“ªä¸ªé¢æ˜¯èƒŒé¢? ç­”æ¡ˆï¼šé€šè¿‡åˆ†æé¡¶ç‚¹æ•°æ®çš„é¡ºåº 3.2 åˆ†æé¡¶ç‚¹é¡ºåº æ­£â¾¯: æŒ‰ç…§é€†æ—¶é’ˆé¡¶ç‚¹è¿æ¥é¡ºåºçš„ä¸‰â»†å½¢â¾¯ èƒŒâ¾¯: æŒ‰ç…§é¡ºæ—¶é’ˆé¡¶ç‚¹è¿æ¥é¡ºåºçš„ä¸‰â»†å½¢â¾¯ 3.3 åˆ†æâ½´æ–¹ä½“ä¸­çš„æ­£èƒŒâ¾¯ åˆ†æ å·¦ä¾§ä¸‰â»†å½¢é¡¶ç‚¹é¡ºåºä¸º: 1â€”> 2â€”> 3; å³ä¾§ä¸‰â»†å½¢çš„é¡¶ç‚¹é¡ºåºä¸º: 1â€”> 2â€”> 3 . å½“è§‚å¯Ÿè€…åœ¨å³ä¾§æ—¶,åˆ™å³è¾¹çš„ä¸‰â»†å½¢â½…å‘ä¸ºé€†æ—¶é’ˆâ½…æ–¹å‘åˆ¤å®šä¸ºæ­£â¾¯,â½½å·¦ä¾§çš„ä¸‰â»†å½¢ä¸ºé¡ºæ—¶é’ˆåˆ™ä¸ºèƒŒé¢ å½“è§‚å¯Ÿè€…åœ¨å·¦ä¾§æ—¶,åˆ™å·¦è¾¹çš„ä¸‰è§’å½¢â½…å‘ä¸ºé€†æ—¶é’ˆâ½…æ–¹å‘åˆ¤å®šä¸ºæ­£â¾¯,â½½å³ä¾§çš„ä¸‰â»†å½¢ä¸ºé¡ºæ—¶é’ˆåˆ™ä¸ºèƒŒé¢ æ€»ç»“ æ­£â¾¯å’ŒèƒŒé¢æ˜¯ç”±ä¸‰â»†å½¢çš„é¡¶ç‚¹å®šä¹‰é¡ºåºå’Œè§‚å¯Ÿè€…æ–¹å‘å…±åŒå†³å®šçš„.éšç€è§‚å¯Ÿè€…çš„â»†åº¦â½…å‘çš„æ”¹å˜,æ­£é¢èƒŒé¢ä¹Ÿ ä¼šè·Ÿç€æ”¹å˜ã€‚ 3.4 å¼€å¯æ­£èƒŒé¢å‰”é™¤å‡½æ•° å¼€å¯è¡¨â¾¯å‰”é™¤(é»˜è®¤èƒŒâ¾¯å‰”é™¤) void glEnable(GL_CULL_FACE); å…³é—­è¡¨é¢å‰”é™¤(é»˜è®¤èƒŒâ¾¯å‰”é™¤) void glDisable(GL_CULL_FACE); â½¤æˆ·é€‰æ‹©å‰”é™¤é‚£ä¸ªé¢(æ­£é¢/èƒŒé¢) // modeå‚æ•°ä¸º: GL_FRONT,GL_BACK,GL_FRONT_AND_BACK ,é»˜è®¤GL_BACK void glCullFace(GLenum mode); â½¤æˆ·æŒ‡å®šç»•åºå“ªä¸ªä¸ºæ­£â¾¯ // modeå‚æ•°ä¸º: GL_CW,GL_CCW,é»˜è®¤å€¼:GL_CCW oid glFrontFace(GLenum mode); ä¾‹å¦‚,å‰”é™¤æ­£é¢å®ç°(1) glCullFace(GL_BACK); glFrontFace(GL_CW); ä¾‹å¦‚,å‰”é™¤æ­£é¢å®ç°(1) glCullFace(GL_FRONT); å››ã€æ·±åº¦æµ‹è¯• æ·±åº¦ç¼“å†²åŒº(DepthBuffer)å’Œé¢œâ¾Šç¼“å­˜åŒº(ColorBuffer)æ˜¯å¯¹åº”çš„.é¢œâ¾Šç¼“å­˜åŒºå­˜å‚¨åƒç´ çš„é¢œè‰²ä¿¡æ¯,â½½æ·±åº¦ç¼“å†²åŒºå­˜å‚¨åƒç´ çš„æ·±åº¦ä¿¡æ¯.åœ¨å†³å®šæ˜¯å¦ç»˜åˆ¶ä¸€ä¸ªç‰©ä½“è¡¨â¾¯æ—¶,é¦–å…ˆè¦å°†è¡¨â¾¯é¢å¯¹åº”çš„åƒç´ çš„æ·±åº¦å€¼ä¸å½“å‰æ·±åº¦ç¼“å†²åŒºä¸­çš„å€¼è¿›â¾æ¯”è¾ƒ.å¦‚æœâ¼¤äºæ·±åº¦ç¼“å†²åŒºä¸­çš„å€¼,åˆ™ä¸¢å¼ƒè¿™éƒ¨åˆ†.å¦åˆ™åˆ©ç”¨è¿™ä¸ªåƒç´ å¯¹åº”çš„æ·±åº¦å€¼å’Œé¢œâ¾Šå€¼.åˆ†åˆ«æ›´æ–°æ·±åº¦ç¼“å†²åŒºå’Œé¢œè‰²ç¼“å­˜åŒº. è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºâ€æ·±åº¦æµ‹ è¯•â€ã€‚ 4.1 ä»€ä¹ˆæ˜¯æ·±åº¦ï¼Ÿ æ·±åº¦å…¶å®å°±æ˜¯è¯¥åƒç´ ç‚¹åœ¨3Dä¸–ç•Œä¸­è·ç¦»æ‘„åƒæœºçš„è·ç¦»,Zå€¼ 4.2 ä»€ä¹ˆæ˜¯æ·±åº¦ç¼“å†²åŒº? æ·±åº¦ç¼“å­˜åŒº,å°±æ˜¯ä¸€å—å†…å­˜åŒºåŸŸ,ä¸“â»”å­˜å‚¨ç€æ¯ä¸ªåƒç´ ç‚¹(ç»˜åˆ¶åœ¨å±å¹•ä¸Šçš„)æ·±åº¦å€¼.æ·±åº¦å€¼(Zå€¼)è¶Šâ¼¤, åˆ™ç¦»æ‘„åƒæœºå°±è¶Šè¿œ. 4.3 ä¸ºä»€ä¹ˆéœ€è¦æ·±åº¦ç¼“å†²åŒº? åœ¨ä¸ä½¿â½¤æ·±åº¦æµ‹è¯•çš„æ—¶å€™,å¦‚æœæˆ‘ä»¬å…ˆç»˜åˆ¶ä¸€ä¸ªè·ç¦»â½è¾ƒè¿‘çš„ç‰©ä½“,å†ç»˜åˆ¶è·ç¦»è¾ƒè¿œçš„ç‰©ä½“,åˆ™è·ç¦»è¿œçš„ä½å›¾å› ä¸ºåç»˜åˆ¶,ä¼šæŠŠè·ç¦»è¿‘çš„ç‰©ä½“è¦†ç›–æ‰.æœ‰äº†æ·±åº¦ç¼“å†²åŒºå,ç»˜åˆ¶ç‰©ä½“çš„é¡ºåºå°±ä¸é‚£ä¹ˆô°€é‡è¦çš„. å®é™…ä¸Š,åªè¦å­˜åœ¨æ·±åº¦ç¼“å†²åŒº,OpenGLéƒ½ä¼šæŠŠåƒç´ çš„æ·±åº¦å€¼å†™â¼Šåˆ°ç¼“å†²åŒºä¸­. é™¤éè°ƒç”¨ glDepthMask(GL_FALSE).æ¥ç¦â½Œå†™å…¥. 4.4 ä½¿â½¤æ·±åº¦æµ‹è¯• æ·±åº¦ç¼“å†²åŒº,â¼€èˆ¬ç”±çª—â¼ç®¡ç†ç†ç³»ç»Ÿ,GLFWåˆ›å»º.æ·±åº¦å€¼â¼€èˆ¬ç”±16ä½,24ä½,32ä½å€¼è¡¨ç¤º.é€šå¸¸æ˜¯24ä½.æ•°è¶Šé«˜,æ·±åº¦ç²¾ç¡®åº¦æ›´å¥½. å¼€å¯æ·±åº¦æµ‹è¯•glEnable(GL_DEPTH_TEST); åœ¨ç»˜åˆ¶åœºæ™¯å‰,æ¸…é™¤é¢œâ¾Šç¼“å­˜åŒº,æ·±åº¦ç¼“å†²glClearColor(0.0f,0.0f,0.0f,1.0f); glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); æ¸…é™¤æ·±åº¦ç¼“å†²åŒºé»˜è®¤å€¼ä¸º1.0,è¡¨ç¤ºæœ€å¤§çš„æ·±åº¦å€¼,æ·±åº¦å€¼çš„èŒƒå›´ä¸º(0,1)ä¹‹é—´.å€¼è¶Šå°è¡¨ç¤ºè¶Šé è¿‘è§‚å¯Ÿè€…,å€¼è¶Šå¤§è¡¨ç¤ºè¶Šè¿œç¦»è§‚å¯Ÿè€… æŒ‡å®šæ·±åº¦æµ‹è¯•åˆ¤æ–­æ¨¡å¼ æ‰“å¼€/é˜»æ–­æ·±åº¦ç¼“å­˜åŒºå†™â¼Š//value : GL_TURE å¼€å¯æ·±åº¦ç¼“å†²åŒºå†™â¼Šå…¥; GL_FALSE å…³é—­æ·±åº¦ç¼“å†²åŒºå†™â¼Šå…¥ void glDepthMask(GLBool value); 4.5 ZFightingé—ªçƒé—®é¢˜å‡ºç° å› ä¸ºå¼€å¯æ·±åº¦æµ‹è¯•å,OpenGLå°±ä¸ä¼šå†å»ç»˜åˆ¶æ¨¡å‹è¢«é®æŒ¡çš„éƒ¨åˆ†.è¿™æ ·å®ç°çš„æ˜¾ç¤ºæ›´åŠ çœŸå®.ä½†æ˜¯ ç”±äºæ·±åº¦ç¼“å†²åŒºç²¾åº¦çš„é™åˆ¶å¯¹äºæ·±åº¦ç›¸å·®â¾®å¸¸å°çš„æƒ…å†µä¸‹.(ä¾‹å¦‚åœ¨åŒä¸€å¹³â¾¯ä¸Šè¿›è¡Œ2æ¬¡ç»˜åˆ¶),OpenGLå°±å¯èƒ½å‡ºç°ä¸èƒ½æ­£ç¡®åˆ¤æ–­ä¸¤è€…çš„æ·±åº¦å€¼,ä¼šå¯¼è‡´æ·±åº¦æµ‹è¯•çš„ç»“æœä¸å¯é¢„æµ‹.æ˜¾ç¤ºå‡ºæ¥çš„ç°è±¡æ—¶äº¤é”™é—ªçƒçš„å‰é¢2ä¸ªç”»é¢,äº¤é”™å‡ºç°. 4.6 ZFightingé—ªçƒé—®é¢˜è§£å†³ ç¬¬â¼€æ­¥: å¯â½¤ç”¨ Polygon Offset â½…å¼è§£å†³ è®©æ·±åº¦å€¼ä¹‹é—´äº§â½£ç”Ÿé—´éš”.å¦‚æœ2ä¸ªå›¾å½¢ä¹‹é—´æœ‰é—´éš”,æ˜¯ä¸æ˜¯æ„å‘³ç€å°±ä¸ä¼šäº§â½£å¹²æ¶‰.å¯ä»¥ç†è§£ä¸ºåœ¨æ‰§â¾æ·±åº¦æµ‹è¯•å‰å°†â½´æ–¹ä½“çš„æ·±åº¦å€¼åšâ¼€äº›ç»†å¾®çš„å¢åŠ .äºæ˜¯å°±èƒ½å°†ô°€å çš„2ä¸ªå›¾å½¢æ·±åº¦å€¼ä¹‹é—´æœ‰æ‰€åŒºåˆ†. // å¯â½¤ç”¨Polygon Offsetâ½…å¼ // å‚æ•°åˆ—åˆ—è¡¨: // GL_POLYGON_OFFSET_POINT GL_POLYGON_OFFSET_LINE GL_POLYGON_OFFSET_FILL // å¯¹åº”å…‰æ …åŒ–æ¨¡å¼: GL_POINT // å¯¹åº”å…‰æ …åŒ–æ¨¡å¼: GL_LINE // å¯¹åº”å…‰æ …åŒ–æ¨¡å¼: GL_FILL glEnable(GL_POLYGON_OFFSET_FILL) ç¬¬â¼†æ­¥: æŒ‡å®šåç§»é‡ é€šè¿‡glPolygonOffsetæ¥æŒ‡å®š.glPolygonOffsetéœ€è¦2ä¸ªå‚æ•°: factor , unitsvoid glPolygonOffset(Glfloat factor,Glfloat units); æ¯ä¸ªFragmentçš„æ·±åº¦å€¼éƒ½ä¼šå¢åŠ å¦‚ä¸‹æ‰€ç¤ºçš„åç§»é‡Offset = ( m * factor ) + ( r * units) m(æ·±åº¦å€¼(Zå€¼)) : å¤šè¾¹å½¢çš„æ·±åº¦çš„æ–œç‡çš„æœ€â¼¤å€¼,ç†è§£ä¸€ä¸ªå¤šè¾¹å½¢è¶Šæ˜¯ä¸è¿‘è£å‰ªé¢å¹³â¾,m å°±è¶Šæ¥è¿‘äº0. r(ä½¿å¾—æ·±åº¦ç¼“å†²åŒºäº§â½£ç”Ÿå˜åŒ–çš„æœ€å°å€¼) : èƒ½äº§â½£äºçª—â¼åæ ‡ç³»çš„æ·±åº¦å€¼ä¸­å¯åˆ†è¾¨çš„å·®å¼‚æœ€å°å€¼.ræ˜¯ç”±å…·ä½“OpenGLå¹³å°æŒ‡å®šçš„â¼€ä¸ªå¸¸é‡. â¼€ä¸ªâ¼¤äº0çš„Offset ä¼šæŠŠæ¨¡å‹æ¨åˆ°ç¦»ä½ (æ‘„åƒæœº)æ›´è¿œçš„ä½ç½®,ç›¸åº”çš„ä¸€ä¸ªâ¼©äº0çš„Offsetä¼šæŠŠæ¨¡å‹æ‹‰è¿‘ â¼€èˆ¬â½½è¨€,åªéœ€è¦å°†-1.0 å’Œ 0.0 è¿™æ ·ç®€å•èµ‹å€¼ç»™glPolygonOffsetåŸºæœ¬å¯ä»¥æ»¡â¾œéœ€æ±‚. ç¬¬ä¸‰æ­¥: å…³é—­Polygon Offset glDisable(GL_POLYGON_OFFSET_FILL) 4.7 ZFightingé—ªçƒé—®é¢˜é¢„é˜² ä¸è¦å°†ä¸¤ä¸ªç‰©ä½“é çš„å¤ªè¿‘ï¼Œé¿å…æ¸²æŸ“æ—¶ä¸‰â»†å½¢å åœ¨â¼€èµ·ã€‚è¿™ç§æ–¹å¼è¦æ±‚å¯¹åœºæ™¯ä¸­ç‰©ä½“æ’å…¥â¼€ä¸ªå°‘é‡çš„åç§»ï¼Œé‚£ä¹ˆå°±å¯èƒ½é¿å…ZFightingç°è±¡ã€‚ä¾‹å¦‚ä¸Šé¢çš„â½´æ–¹ä½“å’Œå¹³â¾¯é—®é¢˜ä¸­ï¼Œå°†å¹³â¾¯ä¸‹ç§»0.001få°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å½“ç„¶â¼¿åŠ¨å»æ’â¼Šè¿™ä¸ªâ¼©çš„åç§»æ˜¯è¦ä»˜å‡ºä»£ä»·çš„ã€‚ å°½å¯èƒ½å°†è¿‘è£å‰ªâ¾¯è®¾ç½®å¾—ç¦»è§‚å¯Ÿè€…è¿œâ¼€äº›ã€‚ä¸Šâ¾¯æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨è¿‘è£å‰ªå¹³é¢é™„è¿‘ï¼Œæ·±åº¦çš„ç²¾ç¡®åº¦æ˜¯å¾ˆé«˜çš„ï¼Œå› æ­¤å°½å¯èƒ½è®©è¿‘è£å‰ªâ¾¯è¿œâ¼€äº›çš„è¯ï¼Œä¼šä½¿æ•´ä¸ªè£å‰ªèŒƒå›´å†…çš„ç²¾ç¡®åº¦å˜é«˜â¼€äº›ã€‚ä½†æ˜¯è¿™ç§â½…å¼ä¼šä½¿ç¦»è§‚å¯Ÿè€…è¾ƒè¿‘çš„ç‰©ä½“è¢«è£å‡æ‰ï¼Œå› æ­¤éœ€è¦è°ƒè¯•å¥½è£å‰ªâ¾¯å‚æ•°ã€‚ ä½¿â½¤æ›´â¾¼ä½æ•°çš„æ·±åº¦ç¼“å†²åŒºï¼Œé€šå¸¸ä½¿â½¤çš„æ·±åº¦ç¼“å†²åŒºæ˜¯24ä½çš„ï¼Œç°åœ¨æœ‰ä¸€äº›ç¡¬ä»¶ä½¿ç”¨32ä½çš„ç¼“å†²åŒºï¼Œä½¿ç²¾ç¡®åº¦å¾—åˆ°æâ¾¼ äº”ã€è£å‰ª åœ¨OpenGLä¸­æé«˜æ¸²æŸ“çš„ä¸€ç§â½…å¼.åªåˆ·æ–°å±å¹•ä¸Šå‘ç”Ÿå˜åŒ–çš„éƒ¨åˆ†.OpenGLå…è®¸å°†è¦è¿›è¡Œæ¸²æŸ“çš„çª—å£åª å»æŒ‡å®šä¸€ä¸ªè£å‰ªæ¡†. åŸºæœ¬åŸç†:â½¤äºæ¸²æŸ“æ—¶é™åˆ¶ç»˜åˆ¶åŒºåŸŸï¼Œé€šè¿‡æ­¤æŠ€æœ¯å¯ä»¥å†å±å¹•(å¸§ç¼“å†²)æŒ‡å®šä¸€ä¸ªçŸ©å½¢åŒºåŸŸã€‚å¯â½¤å‰ªè£æµ‹è¯•ä¹‹åï¼Œä¸åœ¨æ­¤çŸ©å½¢åŒºåŸŸå†…çš„â½šå…ƒè¢«ä¸¢å¼ƒï¼Œåªæœ‰åœ¨æ­¤çŸ©å½¢åŒºåŸŸå†…çš„â½šå…ƒæ‰æœ‰å¯èƒ½è¿›å…¥å¸§ç¼“å†²ã€‚å› æ­¤å®é™…è¾¾åˆ°çš„æ•ˆæœå°±æ˜¯åœ¨å±å¹•ä¸Šå¼€è¾Ÿäº†äº†ä¸€ä¸ªâ¼©çª—å£ï¼Œå¯ä»¥å†å…¶ä¸­è¿›â¾æŒ‡å®šå†…å®¹çš„ç»˜åˆ¶ã€‚ //1 å¼€å¯è£å‰ªæµ‹è¯• glEnable(GL_SCISSOR_TEST); //2.å…³é—­è£å‰ªæµ‹è¯• glDisable(GL_SCISSOR_TEST); //3.æŒ‡å®šè£å‰ªçª—â¼å£ void glScissor(Glint x,Glint y,GLSize width,GLSize height); x,y:æŒ‡å®šè£å‰ªæ¡†å·¦ä¸‹â»†è§’ä½ç½®; width , height:æŒ‡å®šè£å‰ªå°ºâ¼¨ 5.1 ç†è§£çª—å£ å°±æ˜¯æ˜¾ç¤ºç•Œâ¾¯ 5.2 è§†å£ å°±æ˜¯çª—â¼ä¸­â½¤æ¥æ˜¾ç¤ºå›¾å½¢çš„ä¸€å—çŸ©å½¢åŒºåŸŸï¼Œå®ƒå¯ä»¥å’Œçª—å£ç­‰å¤§ï¼Œä¹Ÿå¯ä»¥â½çª—å£â¼¤æˆ–è€…å°ã€‚åªæœ‰ç»˜åˆ¶åœ¨è§†å£åŒºåŸŸä¸­çš„å›¾å½¢æ‰èƒ½è¢«æ˜¾ç¤ºï¼Œå¦‚æœå›¾å½¢æœ‰ä¸€éƒ¨åˆ†è¶…å‡ºäº†è§†å£åŒºåŸŸï¼Œé‚£ä¹ˆé‚£ä¸€éƒ¨åˆ†æ˜¯çœ‹ä¸åˆ°çš„ã€‚ 5.3 è£å‰ªåŒºåŸŸï¼ˆå¹³è¡ŒæŠ•å½±ï¼‰ å°±æ˜¯è§†â¼çŸ©å½¢åŒºåŸŸçš„æœ€å°æœ€å¤§xåæ ‡(left,right)å’Œæœ€å°æœ€å¤§yåæ ‡ (bottom,topï¼‰ï¼Œâ½½ä¸æ˜¯çª—å£çš„æœ€å°æœ€å¤§xåæ ‡å’Œyåæ ‡ã€‚é€šè¿‡glOrtho()å‡½æ•°è®¾ç½®ï¼Œè¿™ä¸ªå‡½æ•°è¿˜éœ€æŒ‡å®šæœ€è¿‘ æœ€è¿œzåæ ‡ï¼Œå½¢æˆâ¼€ä¸ªç«‹ä½“çš„è£å‰ªåŒºåŸŸã€‚ å…­ã€æ··åˆ æˆ‘ä»¬æŠŠOpenGLæ¸²æŸ“æ—¶ä¼šæŠŠé¢œè‰²å€¼å­˜åœ¨é¢œâ¾Šç¼“å­˜åŒºä¸­ï¼Œæ¯ä¸ªâ½šæ®µçš„æ·±åº¦å€¼ä¹Ÿæ˜¯æ”¾åœ¨æ·±åº¦ç¼“å†²åŒºã€‚å½“æ·±åº¦ç¼“å†²åŒºè¢«å…³é—­æ—¶ï¼Œæ–°çš„é¢œè‰²å°†ç®€å•çš„è¦†ç›–åŸæ¥é¢œè‰²ç¼“å­˜åŒºå­˜åœ¨çš„é¢œè‰²å€¼ï¼Œå½“æ·±åº¦ç¼“å†²åŒºå†æ¬¡æ‰“å¼€æ—¶ï¼Œæ–°çš„é¢œè‰²â½šæ®µåªæ˜¯å½“å®ƒä»¬â½åŸæ¥çš„å€¼æ›´æ¥è¿‘é‚»è¿‘çš„è£å‰ªå¹³â¾¯æ‰ä¼šæ›¿æ¢åŸæ¥çš„é¢œè‰²â½šæ®µã€‚ glEnable(GL_BlEND); 6.1 ç»„åˆé¢œâ¾Š â½¬æ ‡é¢œè‰²:å·²ç»å­˜å‚¨åœ¨é¢œâ¾Šç¼“å­˜åŒºçš„é¢œâ¾Šå€¼ æºé¢œâ¾Š:ä½œä¸ºå½“å‰æ¸²æŸ“å‘½ä»¤ç»“æœè¿›â¼Šé¢œè‰²ç¼“å­˜åŒºçš„é¢œâ¾Šå€¼ å½“æ··åˆåŠŸèƒ½è¢«å¯åŠ¨æ—¶ï¼Œæºé¢œâ¾Šå’Œâ½¬æ ‡é¢œâ¾Šçš„ç»„åˆâ½…å¼æ˜¯æ··åˆæ–¹ç¨‹å¼æ§åˆ¶çš„ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ æ··åˆæ–¹ç¨‹å¼å¦‚ä¸‹æ‰€ç¤º: // Cf: æœ€ç»ˆè®¡ç®—å‚æ•°çš„é¢œâ¾Šè‰² // Cs: æºé¢œâ¾Šè‰² // Cd:â½¬ç›®æ ‡é¢œâ¾Šè‰² // S: æºæ··åˆå› â¼¦å­ // D: â½¬ç›®æ ‡æ··åˆå› â¼¦å­ Cf = (Cs * S) + (Cd * D) 6.2 è®¾ç½®æ··åˆå› â¼¦ å‡½æ•°ä»‹ç» è®¾ç½®æ··åˆå› â¼¦å­ï¼Œéœ€è¦â½¤ç”¨åˆ°glBlendFunå‡½æ•° // S:æºæ··åˆå› â¼¦å­ // D:â½¬ç›®æ ‡æ··åˆå› â¼¦å­ glBlendFunc(GLenum S,GLenum D); è¡¨ä¸­Rã€Gã€Bã€A åˆ†åˆ«ä»£è¡¨ çº¢ã€ç»¿ã€è“ã€alphaã€‚ è¡¨ä¸­ä¸‹æ ‡Sã€Dï¼Œåˆ†åˆ«ä»£è¡¨æºã€â½¬ç›®æ ‡ã€‚ è¡¨ä¸­C ä»£è¡¨å¸¸é‡é‡é¢œâ¾Šè‰²(é»˜è®¤â¿Šé»‘â¾Šè‰²)ã€‚ å‡½æ•°ä½¿ç”¨ ä¸‹â¾¯é¢é€šè¿‡â¼€ä¸ªå¸¸â»…çš„æ··åˆå‡½æ•°ç»„åˆæ¥è¯´æ˜é—®é¢˜: glBlendFunc(GL_SRC_ALPHA,GL_ONE_MINUS_SRC_ALPHA); å¦‚æœé¢œâ¾Šç¼“å­˜åŒºå·²ç»æœ‰ä¸€ç§é¢œè‰²çº¢è‰²(1.0f,0.0f,0.0f,0.0f),è¿™ä¸ªç›®æ ‡é¢œè‰²Cdï¼Œå¦‚æœåœ¨è¿™ä¸Šé¢ç”¨â¼€ç§alphaä¸º0.6çš„è“è‰²(0.0f,0.0f,1.0f,0.6f) Cd (â½¬æ ‡é¢œè‰²) = (1.0f,0.0f,0.0f,0.0f); Cs (æºé¢œâ¾Šè‰²) = (0.0f,0.0f,1.0f,0.6f); S = æºalphaå€¼ = 0.6f D = 1 - æºalphaå€¼= 1-0.6f = 0.4f æ–¹ç¨‹å¼Cf = (Cs * S) + (Cd * D) ç­‰ä»·äº = (Blue 0.6f) + (Red 0.4f) æ€»ç»“ æœ€ç»ˆé¢œè‰²æ˜¯ä»¥åŸå…ˆçš„çº¢è‰²(ç›®æ ‡é¢œè‰²)ä¸ åæ¥çš„è“è‰²(æºé¢œè‰²)è¿›è¡Œç»„åˆã€‚æºé¢œâ¾Šçš„alphaå€¼è¶Šâ¾¼ï¼Œæ·»åŠ çš„è“â¾Šè‰²é¢œè‰²æˆåˆ†è¶Šé«˜ï¼Œâ½¬æ ‡é¢œâ¾Šæ‰€ä¿ç•™çš„æˆåˆ†å°±ä¼šè¶Šå°‘ã€‚æ··åˆå‡½æ•°ç»å¸¸â½¤äºå®ç°åœ¨å…¶ä»–ä¸€äº›ä¸é€æ˜çš„ç‰©ä½“å‰â¾¯ç»˜åˆ¶ä¸€ä¸ªé€æ˜ç‰©ä½“çš„æ•ˆæœã€‚ 6.3 æ”¹å˜ç»„åˆâ½…ç¨‹å¼ é»˜è®¤æ··åˆâ½…æ–¹ç¨‹å¼: Cf = (CsS)+(CdD) å®é™…ä¸Šè¿œä¸æ­¢è¿™ä¸€ç§æ··åˆâ½…ç¨‹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä»5ä¸ªä¸åŒçš„æ–¹ç¨‹å¼ä¸­è¿›è¡Œé€‰æ‹© é€‰æ‹©æ··åˆâ½…æ–¹ç¨‹å¼çš„å‡½æ•°: glbBlendEquation(GLenum mode); 6.4 glBlendFuncSeparate å‡½æ•° é™¤äº†èƒ½ä½¿â½¤glBlendFuncæ¥è®¾ç½®æ··åˆå› å­ï¼Œè¿˜å¯ä»¥æœ‰æ›´çµæ´»çš„é€‰æ‹©ã€‚ // strRGB: æºé¢œâ¾Šçš„æ··åˆå› â¼¦ // dstRGB: â½¬æ ‡é¢œâ¾Šçš„æ··åˆå› â¼¦ // strAlpha: æºé¢œè‰²çš„Alphaå› â¼¦ // dstAlpha: â½¬æ ‡é¢œè‰²çš„Alphaå› â¼¦ void glBlendFuncSeparate(GLenum strRGB,GLenum dstRGB ,GLenum strAlpha,GLenum dstAlpha); glBlendFunc æŒ‡å®šæºå’Œâ½¬æ ‡RGBAå€¼çš„æ··åˆå‡½æ•°;ä½†æ˜¯glBlendFuncSeparateå‡½æ•°åˆ™å…è®¸ä¸ºRGB å’Œ Alpha æˆåˆ†å•ç‹¬æŒ‡å®šæ··åˆå‡½æ•°ã€‚ åœ¨æ··åˆå› â¼¦å­è¡¨ä¸­ï¼ŒGL_CONSTANT_COLOR,GL_ONE_MINUS_CONSTANT_COLOR,GL_CONSTANT_ALPHA,GL_ONE_MINUS_CONSTANTå€¼å…è®¸æ··åˆæ–¹ç¨‹å¼ä¸­å¼•â¼Šä¸€ä¸ªå¸¸é‡æ··åˆé¢œâ¾Šã€‚ 6.5 å¸¸é‡æ··åˆé¢œâ¾Š å¸¸é‡æ··åˆé¢œâ¾Šè‰²ï¼Œé»˜è®¤åˆå§‹åŒ–ä¸ºâ¿Šâ¾Š(0.0f,0.0f,0.0f,0.0f)ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥ä¿®æ”¹è¿™ä¸ªå¸¸é‡æ··åˆé¢œè‰²ã€‚ void glBlendColor(GLclampf red ,GLclampf green ,GLclampf blue ,GLclampf alpha); ä¸ƒã€æ¡ˆä¾‹ æºç  7.1 æ·±åº¦æµ‹è¯•+æ­£èƒŒé¢å‰”é™¤ //æ¼”ç¤ºäº†OpenGLèƒŒé¢å‰”é™¤ï¼Œæ·±åº¦æµ‹è¯•ï¼Œå’Œå¤šè¾¹å½¢æ¨¡å¼ #include \"GLTools.h\" #include \"GLMatrixStack.h\" #include \"GLFrame.h\" #include \"GLFrustum.h\" #include \"GLGeometryTransform.h\" #include #ifdef __APPLE__ #include #else #define FREEGLUT_STATIC #include #endif ////è®¾ç½®è§’è‰²å¸§ï¼Œä½œä¸ºç›¸æœº GLFrame viewFrame; //ä½¿ç”¨GLFrustumç±»æ¥è®¾ç½®é€è§†æŠ•å½± GLFrustum viewFrustum; GLTriangleBatch torusBatch; GLMatrixStack modelViewMatix; GLMatrixStack projectionMatrix; GLGeometryTransform transformPipeline; GLShaderManager shaderManager; //æ ‡è®°ï¼šèƒŒé¢å‰”é™¤ã€æ·±åº¦æµ‹è¯• int iCull = 0; int iDepth = 0; //å³é”®èœå•æ é€‰é¡¹ void ProcessMenu(int value) { switch(value) { case 1: iDepth = !iDepth; break; case 2: iCull = !iCull; break; case 3: glPolygonMode(GL_FRONT_AND_BACK, GL_FILL); break; case 4: glPolygonMode(GL_FRONT_AND_BACK, GL_LINE); break; case 5: glPolygonMode(GL_FRONT_AND_BACK, GL_POINT); break; } glutPostRedisplay(); } // å¬å”¤åœºæ™¯ void RenderScene(void) { //æ¸…é™¤çª—å£å’Œæ·±åº¦ç¼“å†²åŒº glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); //æ ¹æ®è®¾ç½®iCullæ ‡è®°æ¥åˆ¤æ–­æ˜¯å¦å¼€å¯èƒŒé¢å‰”é™¤ if(iCull) { glEnable(GL_CULL_FACE); glFrontFace(GL_CCW); glCullFace(GL_BACK); } else glDisable(GL_CULL_FACE); //æ ¹æ®è®¾ç½®iDepthæ ‡è®°æ¥åˆ¤æ–­æ˜¯å¦å¼€å¯æ·±åº¦æµ‹è¯• if(iDepth) glEnable(GL_DEPTH_TEST); else glDisable(GL_DEPTH_TEST); //æŠŠæ‘„åƒæœºçŸ©é˜µå‹å…¥æ¨¡å‹çŸ©é˜µä¸­ modelViewMatix.PushMatrix(viewFrame); GLfloat vRed[] = { 1.0f, 0.0f, 0.0f, 1.0f }; //ä½¿ç”¨å¹³é¢ç€è‰²å™¨ //å‚æ•°1ï¼šå¹³é¢ç€è‰²å™¨ //å‚æ•°2ï¼šæ¨¡å‹è§†å›¾æŠ•å½±çŸ©é˜µ //å‚æ•°3ï¼šé¢œè‰² //shaderManager.UseStockShader(GLT_SHADER_FLAT, transformPipeline.GetModelViewProjectionMatrix(), vRed); //ä½¿ç”¨é»˜è®¤å…‰æºç€è‰²å™¨ //é€šè¿‡å…‰æºã€é˜´å½±æ•ˆæœè·Ÿæç°ç«‹ä½“æ•ˆæœ //å‚æ•°1ï¼šGLT_SHADER_DEFAULT_LIGHT é»˜è®¤å…‰æºç€è‰²å™¨ //å‚æ•°2ï¼šæ¨¡å‹è§†å›¾çŸ©é˜µ //å‚æ•°3ï¼šæŠ•å½±çŸ©é˜µ //å‚æ•°4ï¼šåŸºæœ¬é¢œè‰²å€¼ shaderManager.UseStockShader(GLT_SHADER_DEFAULT_LIGHT, transformPipeline.GetModelViewMatrix(), transformPipeline.GetProjectionMatrix(), vRed); //ç»˜åˆ¶ torusBatch.Draw(); //å‡ºæ ˆ modelViewMatix.PopMatrix(); glutSwapBuffers(); } // è¿™ä¸ªå‡½æ•°ä¸éœ€è¦åˆå§‹åŒ–æ¸²æŸ“ // context. å›¾åƒä¸Šä¸‹æ–‡ void SetupRC() { // è®¾ç½®èƒŒæ™¯é¢œè‰² glClearColor(0.3f, 0.3f, 0.3f, 1.0f ); //åˆå§‹åŒ–ç€è‰²å™¨ç®¡ç†å™¨ shaderManager.InitializeStockShaders(); //å°†ç›¸æœºå‘åç§»åŠ¨7ä¸ªå•å…ƒï¼šè‚‰çœ¼åˆ°ç‰©ä½“ä¹‹é—´çš„è·ç¦» viewFrame.MoveForward(7.0); //åˆ›å»ºä¸€ä¸ªç”œç”œåœˆ //void gltMakeTorus(GLTriangleBatch& torusBatch, GLfloat majorRadius, GLfloat minorRadius, GLint numMajor, GLint numMinor); //å‚æ•°1ï¼šGLTriangleBatch å®¹å™¨å¸®åŠ©ç±» //å‚æ•°2ï¼šå¤–è¾¹ç¼˜åŠå¾„ //å‚æ•°3ï¼šå†…è¾¹ç¼˜åŠå¾„ //å‚æ•°4ã€5ï¼šä¸»åŠå¾„å’Œä»åŠå¾„çš„ç»†åˆ†å•å…ƒæ•°é‡ gltMakeTorus(torusBatch, 1.0f, 0.3f, 52, 26); //ç‚¹çš„å¤§å° glPointSize(4.0f); } //é”®ä½è®¾ç½®ï¼Œé€šè¿‡ä¸åŒçš„é”®ä½å¯¹å…¶è¿›è¡Œè®¾ç½® //æ§åˆ¶Cameraçš„ç§»åŠ¨ï¼Œä»è€Œæ”¹å˜è§†å£ void SpecialKeys(int key, int x, int y) { if(key == GLUT_KEY_UP) viewFrame.RotateWorld(m3dDegToRad(-5.0), 1.0f, 0.0f, 0.0f); if(key == GLUT_KEY_DOWN) viewFrame.RotateWorld(m3dDegToRad(5.0), 1.0f, 0.0f, 0.0f); if(key == GLUT_KEY_LEFT) viewFrame.RotateWorld(m3dDegToRad(-5.0), 0.0f, 1.0f, 0.0f); if(key == GLUT_KEY_RIGHT) viewFrame.RotateWorld(m3dDegToRad(5.0), 0.0f, 1.0f, 0.0f); //é‡æ–°åˆ·æ–°window glutPostRedisplay(); } void ChangeSize(int w, int h) { //é˜²æ­¢hå˜ä¸º0 if(h == 0) h = 1; //è®¾ç½®è§†å£çª—å£å°ºå¯¸ glViewport(0, 0, w, h); //setPerspectiveå‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªä»é¡¶ç‚¹æ–¹å‘çœ‹å»çš„è§†åœºè§’åº¦ï¼ˆç”¨è§’åº¦å€¼è¡¨ç¤ºï¼‰ // è®¾ç½®é€è§†æ¨¡å¼ï¼Œåˆå§‹åŒ–å…¶é€è§†çŸ©é˜µ viewFrustum.SetPerspective(35.0f, float(w)/float(h), 1.0f, 100.0f); //æŠŠé€è§†çŸ©é˜µåŠ è½½åˆ°é€è§†çŸ©é˜µå¯¹é˜µä¸­ projectionMatrix.LoadMatrix(viewFrustum.GetProjectionMatrix()); // åˆå§‹åŒ–æ¸²æŸ“ç®¡çº¿ transformPipeline.SetMatrixStacks(modelViewMatix, projectionMatrix); } int main(int argc, char* argv[]) { gltSetWorkingDirectory(argv[0]); glutInit(&argc, argv); glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGBA | GLUT_DEPTH | GLUT_STENCIL); glutInitWindowSize(800, 600); glutCreateWindow(\"Geometry Test Program\"); glutReshapeFunc(ChangeSize); glutSpecialFunc(SpecialKeys); glutDisplayFunc(RenderScene); // Create the Menu glutCreateMenu(ProcessMenu); glutAddMenuEntry(\"Toggle depth test\",1); glutAddMenuEntry(\"Toggle cull backface\",2); glutAddMenuEntry(\"Set Fill Mode\", 3); glutAddMenuEntry(\"Set Line Mode\", 4); glutAddMenuEntry(\"Set Point Mode\", 5); glutAttachMenu(GLUT_RIGHT_BUTTON); GLenum err = glewInit(); if (GLEW_OK != err) { fprintf(stderr, \"GLEW Error: %s\\n\", glewGetErrorString(err)); return 1; } SetupRC(); glutMainLoop(); return 0; } 7.2 è£å‰ª //demo OpenGL è£å‰ª #include \"GLTools.h\" #ifdef __APPLE__ #include #else #define FREEGLUT_STATIC #include #endif //å¬å”¤åœºæ™¯ void RenderScene(void) { //è®¾ç½®æ¸…å±é¢œè‰²ä¸ºè“è‰² glClearColor(0.0f, 0.0f, 1.0f, 0.0f); glClear(GL_COLOR_BUFFER_BIT); //1.ç°åœ¨å‰ªæˆå°çº¢è‰²åˆ†åŒº //(1)è®¾ç½®è£å‰ªåŒºé¢œè‰²ä¸ºçº¢è‰² glClearColor(1.0f, 0.0f, 0.0f, 0.0f); //(2)è®¾ç½®è£å‰ªå°ºå¯¸ glScissor(100, 100, 600, 400); //(3)å¼€å¯è£å‰ªæµ‹è¯• glEnable(GL_SCISSOR_TEST); //(4)å¼€å¯æ¸…å±ï¼Œæ‰§è¡Œè£å‰ª glClear(GL_COLOR_BUFFER_BIT); // 2.è£å‰ªä¸€ä¸ªç»¿è‰²çš„å°çŸ©å½¢ //(1).è®¾ç½®æ¸…å±é¢œè‰²ä¸ºç»¿è‰² glClearColor(0.0f, 1.0f, 0.0f, 0.0f); //(2).è®¾ç½®è£å‰ªå°ºå¯¸ glScissor(200, 200, 400, 200); //(3).å¼€å§‹æ¸…å±æ‰§è¡Œè£å‰ª glClear(GL_COLOR_BUFFER_BIT); //å…³é—­è£å‰ªæµ‹è¯• glDisable(GL_SCISSOR_TEST); //å¼ºåˆ¶æ‰§è¡Œç¼“å­˜åŒº glutSwapBuffers(); } void ChangeSize(int w, int h) { //ä¿è¯é«˜åº¦ä¸èƒ½ä¸º0 if(h == 0) h = 1; // å°†è§†å£è®¾ç½®ä¸ºçª—å£å°ºå¯¸ glViewport(0, 0, w, h); } //ç¨‹åºå…¥å£ int main(int argc, char* argv[]) { glutInit(&argc, argv); glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB); glutInitWindowSize(800,600); glutCreateWindow(\"OpenGL Scissor\"); glutReshapeFunc(ChangeSize); glutDisplayFunc(RenderScene); glutMainLoop(); return 0; } 7.3 é¢œè‰²æ··åˆ //é¢œè‰²ç»„åˆ #include \"GLTools.h\" #include \"GLShaderManager.h\" #ifdef __APPLE__ #include #else #define FREEGLUT_STATIC #include #endif GLBatch squareBatch; GLBatch greenBatch; GLBatch redBatch; GLBatch blueBatch; GLBatch blackBatch; GLShaderManager shaderManager; GLfloat blockSize = 0.2f; GLfloat vVerts[] = { -blockSize, -blockSize, 0.0f, blockSize, -blockSize, 0.0f, blockSize, blockSize, 0.0f, -blockSize, blockSize, 0.0f}; void SetupRC() { glClearColor(1.0f, 1.0f, 1.0f, 1.0f ); shaderManager.InitializeStockShaders(); //ç»˜åˆ¶1ä¸ªç§»åŠ¨çŸ©å½¢ squareBatch.Begin(GL_TRIANGLE_FAN, 4); squareBatch.CopyVertexData3f(vVerts); squareBatch.End(); //ç»˜åˆ¶4ä¸ªå›ºå®šçŸ©å½¢ GLfloat vBlock[] = { 0.25f, 0.25f, 0.0f, 0.75f, 0.25f, 0.0f, 0.75f, 0.75f, 0.0f, 0.25f, 0.75f, 0.0f}; greenBatch.Begin(GL_TRIANGLE_FAN, 4); greenBatch.CopyVertexData3f(vBlock); greenBatch.End(); GLfloat vBlock2[] = { -0.75f, 0.25f, 0.0f, -0.25f, 0.25f, 0.0f, -0.25f, 0.75f, 0.0f, -0.75f, 0.75f, 0.0f}; redBatch.Begin(GL_TRIANGLE_FAN, 4); redBatch.CopyVertexData3f(vBlock2); redBatch.End(); GLfloat vBlock3[] = { -0.75f, -0.75f, 0.0f, -0.25f, -0.75f, 0.0f, -0.25f, -0.25f, 0.0f, -0.75f, -0.25f, 0.0f}; blueBatch.Begin(GL_TRIANGLE_FAN, 4); blueBatch.CopyVertexData3f(vBlock3); blueBatch.End(); GLfloat vBlock4[] = { 0.25f, -0.75f, 0.0f, 0.75f, -0.75f, 0.0f, 0.75f, -0.25f, 0.0f, 0.25f, -0.25f, 0.0f}; blackBatch.Begin(GL_TRIANGLE_FAN, 4); blackBatch.CopyVertexData3f(vBlock4); blackBatch.End(); } //ä¸Šä¸‹å·¦å³é”®ä½æ§åˆ¶ç§»åŠ¨ void SpecialKeys(int key, int x, int y) { GLfloat stepSize = 0.025f; GLfloat blockX = vVerts[0]; GLfloat blockY = vVerts[7]; if(key == GLUT_KEY_UP) blockY += stepSize; if(key == GLUT_KEY_DOWN) blockY -= stepSize; if(key == GLUT_KEY_LEFT) blockX -= stepSize; if(key == GLUT_KEY_RIGHT) blockX += stepSize; if(blockX (1.0f - blockSize * 2)) blockX = 1.0f - blockSize * 2;; if(blockY 1.0f) blockY = 1.0f; vVerts[0] = blockX; vVerts[1] = blockY - blockSize*2; vVerts[3] = blockX + blockSize*2; vVerts[4] = blockY - blockSize*2; vVerts[6] = blockX + blockSize*2; vVerts[7] = blockY; vVerts[9] = blockX; vVerts[10] = blockY; squareBatch.CopyVertexData3f(vVerts); glutPostRedisplay(); } //å¬å”¤åœºæ™¯ void RenderScene(void) { glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT | GL_STENCIL_BUFFER_BIT); //å®šä¹‰4ç§é¢œè‰² GLfloat vRed[] = { 1.0f, 0.0f, 0.0f, 0.5f }; GLfloat vGreen[] = { 0.0f, 1.0f, 0.0f, 1.0f }; GLfloat vBlue[] = { 0.0f, 0.0f, 1.0f, 1.0f }; GLfloat vBlack[] = { 0.0f, 0.0f, 0.0f, 1.0f }; //å¬å”¤åœºæ™¯çš„æ—¶å€™ï¼Œå°†4ä¸ªå›ºå®šçŸ©å½¢ç»˜åˆ¶å¥½ //ä½¿ç”¨ å•ä½ç€è‰²å™¨ //å‚æ•°1ï¼šç®€å•çš„ä½¿ç”¨é»˜è®¤ç¬›å¡å°”åæ ‡ç³»ï¼ˆ-1ï¼Œ1ï¼‰ï¼Œæ‰€æœ‰ç‰‡æ®µéƒ½åº”ç”¨ä¸€ç§é¢œè‰²ã€‚GLT_SHADER_IDENTITY //å‚æ•°2ï¼šç€è‰²å™¨é¢œè‰² shaderManager.UseStockShader(GLT_SHADER_IDENTITY, vGreen); greenBatch.Draw(); shaderManager.UseStockShader(GLT_SHADER_IDENTITY, vRed); redBatch.Draw(); shaderManager.UseStockShader(GLT_SHADER_IDENTITY, vBlue); blueBatch.Draw(); shaderManager.UseStockShader(GLT_SHADER_IDENTITY, vBlack); blackBatch.Draw(); //ç»„åˆæ ¸å¿ƒä»£ç  //1.å¼€å¯æ··åˆ glEnable(GL_BLEND); //2.å¼€å¯ç»„åˆå‡½æ•° è®¡ç®—æ··åˆé¢œè‰²å› å­ glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA); //3.ä½¿ç”¨ç€è‰²å™¨ç®¡ç†å™¨ //*ä½¿ç”¨ å•ä½ç€è‰²å™¨ //å‚æ•°1ï¼šç®€å•çš„ä½¿ç”¨é»˜è®¤ç¬›å¡å°”åæ ‡ç³»ï¼ˆ-1ï¼Œ1ï¼‰ï¼Œæ‰€æœ‰ç‰‡æ®µéƒ½åº”ç”¨ä¸€ç§é¢œè‰²ã€‚GLT_SHADER_IDENTITY //å‚æ•°2ï¼šç€è‰²å™¨é¢œè‰² shaderManager.UseStockShader(GLT_SHADER_IDENTITY, vRed); //4.å®¹å™¨ç±»å¼€å§‹ç»˜åˆ¶ squareBatch.Draw(); //5.å…³é—­æ··åˆåŠŸèƒ½ glDisable(GL_BLEND); //åŒæ­¥ç»˜åˆ¶å‘½ä»¤ glutSwapBuffers(); } void ChangeSize(int w, int h) { glViewport(0, 0, w, h); } int main(int argc, char* argv[]) { gltSetWorkingDirectory(argv[0]); glutInit(&argc, argv); glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGBA | GLUT_DEPTH); glutInitWindowSize(800, 600); glutCreateWindow(\"ç§»åŠ¨çŸ©å½¢ï¼Œè§‚å¯Ÿé¢œè‰²\"); GLenum err = glewInit(); if (GLEW_OK != err) { fprintf(stderr, \"Error: %s\\n\", glewGetErrorString(err)); return 1; } glutReshapeFunc(ChangeSize); glutDisplayFunc(RenderScene); glutSpecialFunc(SpecialKeys); SetupRC(); glutMainLoop(); return 0; } "},"pages/OpenGLç³»åˆ—/04_OpenGLæ¸²æŸ“æŠ€å·§.html":{"url":"pages/OpenGLç³»åˆ—/04_OpenGLæ¸²æŸ“æŠ€å·§.html","title":"4.OpenGLæ¸²æŸ“æŠ€å·§","keywords":"","body":"4.OpenGLæ¸²æŸ“æŠ€å·§ å­¦ä¹ å†…å®¹ æŠ—é”¯é½¿ å¤šé‡é‡‡æ · OpenGLåŸºæœ¬å˜åŒ– æŠ•å½±çŸ©é˜µ-æ­£æŠ•å½± æŠ•å½±çŸ©é˜µ-é€è§†æŠ•å½± ä¸€ã€æŠ—é”¯é½¿ æŠ—é”¯é½¿æ··åˆçš„2å¤§åŠŸèƒ½:é¢œè‰²ç»„åˆã€æŠ—é”¯é½¿ã€‚ //å¼€å¯æ··åˆå¤„ç†ç† glEnable(GL_BLEND); //æŒ‡å®šæ··åˆå› â¼¦å­ GLBlendFunc(GL_SRC_ALPHA,GL_ONE_MINUS_SRC_ALPHA); //æŒ‡å®šæ··åˆâ½…æ–¹ç¨‹å¼ glBlendEquation(GL_FUNC_ADD); //å¯¹ç‚¹è¿›â¾è¡Œè¡ŒæŠ—é”¯â»®é½¿å¤„ç†ç† glEnable(GL_POINT_SMOOTH); //å¯¹çº¿è¿›â¾è¡Œè¡ŒæŠ—é”¯â»®é½¿å¤„ç†ç† glEnable(GL_LINE_SMOOTH); //å¯¹å¤šè¾¹å½¢è¿›â¾è¡Œè¡ŒæŠ—é”¯â»®é½¿å¤„ç†ç† glEnable(GL_POLYGON_SMOOTH); æœªå¼€å¯æŠ—é”¯é½¿ å¼€å¯æŠ—é”¯é½¿ äºŒã€å¤šé‡é‡‡æ · // 1.å¯ä»¥è°ƒâ½¤ç”¨ glutInitDisplayMode æ·»åŠ é‡‡æ ·ç¼“å­˜åŒº glutInitDisplayMode(GLUT_MULTISAMPLE); // 2.å¯ä»¥ä½¿â½¤ç”¨glEnable| glDisableç»„åˆä½¿â½¤ç”¨GLUT_MULTISAMPLE æ‰“å¼€|å…³é—­ å¤šé‡é‡‡ glEnable(GLUT_MULTISAMPLE); glDisable(GLUT_MULTISAMPLE); // 3. å¤šé‡é‡‡æ ·åªæ­£å¯¹å¤šè¾¹å½¢ï¼Œç‚¹å’Œçº¿ä½¿ç”¨æ··åˆ glEnable(GL_POINT_SMOOTH); glDisable(GL_POINT_SMOOTH); glEnable(GL_LINE_SMOOTH); glDisable(GL_LINE_SMOOTH); å¤šé‡é‡‡æ ·ç¼“å­˜åŒºåœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨â½šæ®µRGBå€¼ï¼Œå¹¶ä¸åŒ…å«é¢œè‰²çš„alphaæˆåˆ†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒâ½¤ç”¨glEnableæ¥ä¿®æ”¹è¿™ä¸ªè¡Œä¸º: GL_SAMPLE_ALPHA_TO_COVERAGE ä½¿â½¤ç”¨alphaå€¼ GL_SAMPLE_ALPHA_TO_ON ä½¿â½¤alphaå€¼å¹¶è®¾ä¸º1ï¼Œå¹¶ä½¿â½¤å®ƒã€‚ GL_SAMPLE_COVERAGE ä½¿â½¤glSampleCoverageæ‰€è®¾ç½®çš„å€¼ã€‚ å½“å¯â½¤ GL_SAMPLE_COVERAGE æ—¶ï¼Œå¯ä»¥ä½¿â½¤glSampleCoverageå‡½æ•°å…è®¸æŒ‡å®šä¸€ä¸ªç‰¹å®šçš„å€¼ï¼Œå®ƒæ˜¯ä¸â½šæ®µè¦†ç›–å€¼è¿›â¾æŒ‰ä½ä¸æ“ä½œçš„ç»“æœã€‚ ä¸‰ã€OpenGLåŸºç¡€å˜åŒ– This browser does not support PDFs. Please download the PDF to view it: Download PDF. å››ã€æ•°å­¦çŸ¥è¯† M3DVector3f,ä¸‰ç»´å‘é‡(x,y,z) M3DVector4f,æ€ç»´å‘é‡(x,y,z,w).w = 1.0 //å®šä¹‰2ä¸ªå‘é‡V1,V2 M3DVector3f v1 = {1.0,0.0,0.0}; M3DVector3f v2 = {0.0,1.0,0.0}; //æ–¹æ³•1ï¼šè·å–V1,V2çš„ç‚¹ç§¯ï¼Œè·å–å¤¹è§’çš„coså€¼ GLfloat value1 = m3dDotProduct3(v1, v2); printf(\"V1V2 ä½™å¼¦å€¼ï¼š%f\\n\",value1); //é€šè¿‡acos()ï¼Œè·å–value1çš„å¼§åº¦å€¼ GLfloat value2 = acos(value1); printf(\"V1V2 å¼§åº¦ï¼š%f\\n\",value2); //æ–¹æ³•2ï¼šè·å–V1ï¼ŒV2çš„å¤¹è§’å¼§åº¦å€¼ GLfloat value3 = m3dGetAngleBetweenVectors3(v1, v2); printf(\"V1V2 å¼§åº¦ï¼š%f\\n\",value3); //m3dRadToDeg å¼§åº¦->åº¦æ•° //m3dDegToRad åº¦æ•°->å¼§åº¦ GLfloat value4 = m3dRadToDeg(value3); GLfloat value5 = m3dDegToRad(90); printf(\"V1V2è§’åº¦ï¼š%f\\n\",value4); printf(\"å¼§åº¦ï¼š%f\\n\",value5); //å®šä¹‰å‘é‡vector2 M3DVector3f vector2 = {0.0f,0.0f,0.0f}; //å®ç°çŸ©é˜µå‰ä¹˜ï¼šç»“æœï¼Œå‘é‡1ï¼Œå‘é‡2 // è·å¾—ä¸€ä¸ªä¸v1v2æ‰€åœ¨å¹³é¢å‚ç›´çš„æ–°å‘é‡ // å‰ä¹˜çš„ç»“æœä¸v1v2çš„ç›¸ä¹˜é¡ºåºæœ‰å…³ m3dCrossProduct3(vector2, v1, v2); printf(\"%f,%f,%f\",vector2[0],vector2[1],vector2[2]); å››ã€æ¡ˆä¾‹ æºç  4.1 æŠ—é”¯é½¿+å¤šé‡é‡‡æ · #include \"GLTools.h\" #include \"GLFrustum.h\" #ifdef __APPLE__ #include #else #define FREEGLUT_STATIC #include #endif GLShaderManager shaderManager; GLFrustum viewFrustum; GLBatch smallStarBatch; GLBatch mediumStarBatch; GLBatch largeStarBatch; GLBatch mountainRangeBatch; GLBatch moonBatch; #define SMALL_STARS 100 #define MEDIUM_STARS 40 #define LARGE_STARS 15 #define SCREEN_X 800 #define SCREEN_Y 600 // é€‰æ‹©èœå• void ProcessMenu(int value) { switch(value) { case 1: //æ‰“å¼€æŠ—é”¯é½¿ï¼Œå¹¶ç»™å‡ºå…³äºå°½å¯èƒ½è¿›è¡Œæœ€ä½³çš„å¤„ç†æç¤º //è®¾ç½®æ··åˆå› å­ glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA); glEnable(GL_BLEND); glEnable(GL_POINT_SMOOTH); glHint(GL_POINT_SMOOTH_HINT, GL_NICEST); glEnable(GL_LINE_SMOOTH); glHint(GL_LINE_SMOOTH_HINT, GL_NICEST); glEnable(GL_POLYGON_SMOOTH); glHint(GL_POLYGON_SMOOTH_HINT, GL_NICEST); break; case 2: //å…³é—­æŠ—é”¯é½¿ glDisable(GL_BLEND); glDisable(GL_LINE_SMOOTH); glDisable(GL_POINT_SMOOTH); glDisable(GL_POLYGON_SMOOTH); break; default: break; } // è§¦å‘é‡æ–°ç»˜åˆ¶ glutPostRedisplay(); } //åœºæ™¯å¬å”¤ void RenderScene(void) { //æ‰§è¡Œclearï¼ˆé¢œè‰²ç¼“å­˜åŒºã€æ·±åº¦ç¼“å†²åŒºï¼‰ glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); //å®šä¹‰ç™½è‰² GLfloat vWhite [] = { 1.0f, 1.0f, 1.0f, 1.0f }; //ä½¿ç”¨å­˜å‚¨ç€è‰²ç®¡ç†å™¨ä¸­çš„å¹³é¢ç€è‰²å™¨ //å‚æ•°1ï¼šå¹³é¢ç€è‰²å™¨ //å‚æ•°2: æ¨¡å‹è§†å›¾æŠ•å½±çŸ©é˜µ //å‚æ•°3: é¢œè‰²ï¼Œç™½è‰² shaderManager.UseStockShader(GLT_SHADER_FLAT, viewFrustum.GetProjectionMatrix(), vWhite); //é’ˆå¯¹å¤šè¾¹å½¢å¼€å§‹å¤šé‡é‡‡æ · glEnable(GLUT_MULTISAMPLE); //ç»˜åˆ¶å°æ˜Ÿæ˜Ÿ //ç‚¹çš„å¤§å° glPointSize(1.0f); smallStarBatch.Draw(); //ç»˜åˆ¶ä¸­æ˜Ÿæ˜Ÿ glPointSize(4.0f); mediumStarBatch.Draw(); //ç»˜åˆ¶å¤§æ˜Ÿæ˜Ÿ glPointSize(8.0f); largeStarBatch.Draw(); // ç»˜åˆ¶é¥è¿œçš„åœ°å¹³çº¿ glLineWidth(3.5); mountainRangeBatch.Draw(); //ç»˜åˆ¶æœˆäº® moonBatch.Draw(); //å…³é—­å¤šé‡é‡‡æ · glDisable(GLUT_MULTISAMPLE); // äº¤æ¢ç¼“å†²åŒº glutSwapBuffers(); } //å¯¹æ¸²æŸ“è¿›è¡Œå¿…è¦çš„åˆå§‹åŒ–ã€‚ void SetupRC() { M3DVector3f vVerts[SMALL_STARS]; int i; shaderManager.InitializeStockShaders(); // å°æ˜Ÿæ˜Ÿ smallStarBatch.Begin(GL_POINTS, SMALL_STARS); for(i = 0; i 4.2 å›¾å½¢ç§»åŠ¨ï¼ˆçŸ©é˜µå˜æ¢ï¼‰ /* æ¡ˆä¾‹ï¼šå®ç°çŸ©é˜µçš„ç§»åŠ¨ï¼Œåˆ©ç”¨çŸ©é˜µçš„å¹³ç§»ã€æ—‹è½¬ã€ç»¼åˆå˜åŒ–ç­‰ */ #include \"GLTools.h\" #include \"GLShaderManager.h\" #include \"math3d.h\" #ifdef __APPLE__ #include #else #define FREEGLUT_STATIC #include #endif GLBatch squareBatch; GLShaderManager shaderManager; GLfloat blockSize = 0.1f; GLfloat vVerts[] = { -blockSize, -blockSize, 0.0f, blockSize, -blockSize, 0.0f, blockSize, blockSize, 0.0f, -blockSize, blockSize, 0.0f}; GLfloat xPos = 0.0f; GLfloat yPos = 0.0f; void SetupRC() { //èƒŒæ™¯é¢œè‰² glClearColor(0.0f, 0.0f, 1.0f, 1.0f ); shaderManager.InitializeStockShaders(); // åŠ è½½ä¸‰è§’å½¢ squareBatch.Begin(GL_TRIANGLE_FAN, 4); squareBatch.CopyVertexData3f(vVerts); squareBatch.End(); } //ç§»åŠ¨ï¼ˆç§»åŠ¨åªæ˜¯è®¡ç®—äº†X,Yç§»åŠ¨çš„è·ç¦»ï¼Œä»¥åŠç¢°æ’æ£€æµ‹ï¼‰ void SpecialKeys(int key, int x, int y) { GLfloat stepSize = 0.025f; if(key == GLUT_KEY_UP) yPos += stepSize; if(key == GLUT_KEY_DOWN) yPos -= stepSize; if(key == GLUT_KEY_LEFT) xPos -= stepSize; if(key == GLUT_KEY_RIGHT) xPos += stepSize; // ç¢°æ’æ£€æµ‹ if(xPos (1.0f - blockSize)) xPos = 1.0f - blockSize; if(yPos (1.0f - blockSize)) yPos = 1.0f - blockSize; glutPostRedisplay(); } void RenderScene(void) { glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT | GL_STENCIL_BUFFER_BIT); GLfloat vRed[] = { 1.0f, 0.0f, 0.0f, 1.0f }; M3DMatrix44f mFinalTransform, mTranslationMatrix, mRotationMatrix; //å¹³ç§» xPos,yPos m3dTranslationMatrix44(mTranslationMatrix, xPos, yPos, 0.0f); // æ¯æ¬¡é‡ç»˜æ—¶ï¼Œæ—‹è½¬5åº¦ static float yRot = 0.0f; yRot += 5.0f; m3dRotationMatrix44(mRotationMatrix, m3dDegToRad(yRot), 0.0f, 0.0f, 1.0f); //å°†æ—‹è½¬å’Œç§»åŠ¨çš„ç»“æœåˆå¹¶åˆ°mFinalTransform ä¸­ m3dMatrixMultiply44(mFinalTransform, mTranslationMatrix, mRotationMatrix); //å°†çŸ©é˜µç»“æœæäº¤åˆ°å›ºå®šç€è‰²å™¨ï¼ˆå¹³é¢ç€è‰²å™¨ï¼‰ä¸­ã€‚ shaderManager.UseStockShader(GLT_SHADER_FLAT, mFinalTransform, vRed); squareBatch.Draw(); // æ‰§è¡Œç¼“å†²åŒºäº¤æ¢ glutSwapBuffers(); } void ChangeSize(int w, int h) { glViewport(0, 0, w, h); } int main(int argc, char* argv[]) { gltSetWorkingDirectory(argv[0]); glutInit(&argc, argv); glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGBA | GLUT_DEPTH); glutInitWindowSize(600, 600); glutCreateWindow(\"Move Block with Arrow Keys\"); GLenum err = glewInit(); if (GLEW_OK != err) { fprintf(stderr, \"Error: %s\\n\", glewGetErrorString(err)); return 1; } glutReshapeFunc(ChangeSize); glutDisplayFunc(RenderScene); glutSpecialFunc(SpecialKeys); SetupRC(); glutMainLoop(); return 0; } 4.3 æ­£äº¤æŠ•å½± #include \"GLTools.h\" #include \"GLMatrixStack.h\" #include \"GLFrame.h\" #include \"GLFrustum.h\" #include \"GLGeometryTransform.h\" #include \"GLBatch.h\" #include #ifdef __APPLE__ #include #else #define FREEGLUT_STATIC #include #endif GLFrame viewFrame; GLFrustum viewFrustum; GLBatch tubeBatch; GLBatch innerBatch; //GLMatrixStack å †æ ˆçŸ©é˜µ GLMatrixStack modelViewMatix; GLMatrixStack projectionMatrix; //å‡ ä½•å˜æ¢çš„ç®¡é“ GLGeometryTransform transformPipeline; GLShaderManager shaderManager; // å¬å”¤åœºæ™¯ void RenderScene(void) { // æ¸…å±ã€æ·±åº¦ç¼“å­˜ glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); //glEnable(GL_CULL_FACE); //å¼€å¯æ·±åº¦æµ‹è¯• glEnable(GL_DEPTH_TEST); //ç»˜åˆ¶å‰å‹æ ˆï¼Œå°†æ•°æ®ä¿å­˜è¿›å» modelViewMatix.PushMatrix(viewFrame); GLfloat vRed[] = { 1.0f, 0.0f, 0.0f, 1.0f }; GLfloat vGray[] = { 0.75f, 0.75f, 0.75f, 1.0f }; //é»˜è®¤å…‰æºç€è‰²å™¨ //å‚æ•°1ï¼šç±»å‹ //å‚æ•°2ï¼šæ¨¡å‹è§†å›¾çŸ©é˜µ //å‚æ•°3ï¼šæŠ•å½±çŸ©é˜µ //å‚æ•°4ï¼šé¢œè‰² shaderManager.UseStockShader(GLT_SHADER_DEFAULT_LIGHT, transformPipeline.GetModelViewMatrix(), transformPipeline.GetProjectionMatrix(), vRed); tubeBatch.Draw(); //é»˜è®¤å…‰æºç€è‰²å™¨ //å‚æ•°1ï¼šç±»å‹ //å‚æ•°2ï¼šæ¨¡å‹è§†å›¾çŸ©é˜µ //å‚æ•°3ï¼šæŠ•å½±çŸ©é˜µ //å‚æ•°4ï¼šé¢œè‰² shaderManager.UseStockShader(GLT_SHADER_DEFAULT_LIGHT, transformPipeline.GetModelViewMatrix(), transformPipeline.GetProjectionMatrix(), vGray); innerBatch.Draw(); //ç»˜åˆ¶å®Œå‡ºæ ˆï¼Œè¿˜åŸå¼€å§‹çš„æ•°æ® modelViewMatix.PopMatrix(); glutSwapBuffers(); } //å¯¹å›¾å½¢ä¸Šä¸‹æ–‡åˆå§‹åŒ– void SetupRC() { //è®¾ç½®æ¸…å±é¢œè‰² glClearColor(0.0f, 0.0f, 0.75f, 1.0f ); // glEnable(GL_CULL_FACE); glEnable(GL_DEPTH_TEST); //åˆå§‹åŒ–ç€è‰²å™¨ç®¡ç†å™¨ shaderManager.InitializeStockShaders(); tubeBatch.Begin(GL_QUADS, 200); float fZ = 100.0f; float bZ = -100.0f; //å·¦é¢æ¿çš„é¢œè‰²ã€é¡¶ç‚¹ã€å…‰ç…§æ•°æ® //é¢œè‰²å€¼ tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); //å…‰ç…§æ³•çº¿ //æ¥å—3ä¸ªè¡¨ç¤ºåæ ‡çš„å€¼ï¼ŒæŒ‡å®šä¸€æ¡å‚ç›´äºä¸‰è§’å½¢è¡¨é¢çš„æ³•çº¿å‘é‡ tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); //é¡¶ç‚¹æ•°æ® tubeBatch.Vertex3f(-50.0f, 50.0f, 100.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f,50.0f,fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(50.0f,-50.0f,fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, 35.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 35.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 50.0f,fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -35.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -35.0f,fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f,50.0f,bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f,50.0f,fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(50.0f,-50.0f,fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, 35.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 35.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 50.0f,fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -35.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -35.0f,fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f,50.0f,bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, fZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f,50.0f,bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(50.0f,-50.0f,bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(50.0f, 50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 35.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, 35.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, 50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -35.0f,bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -35.0f, bZ); tubeBatch.End(); //å†…å£ innerBatch.Begin(GL_QUADS, 40); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(-35.0f, 35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(35.0f, 35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(35.0f, 35.0f, bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(-35.0f,35.0f,bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(-35.0f, -35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(-35.0f, -35.0f, bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(35.0f, -35.0f, bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(35.0f, -35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(-35.0f, 35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(-35.0f, 35.0f, bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(-35.0f, -35.0f, bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(-35.0f, -35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(-1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(35.0f, 35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(-1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(35.0f, -35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(-1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(35.0f, -35.0f, bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(-1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(35.0f, 35.0f, bZ); innerBatch.End(); } void SpecialKeys(int key, int x, int y) { if(key == GLUT_KEY_UP) viewFrame.RotateWorld(m3dDegToRad(-5.0), 1.0f, 0.0f, 0.0f); if(key == GLUT_KEY_DOWN) viewFrame.RotateWorld(m3dDegToRad(5.0), 1.0f, 0.0f, 0.0f); if(key == GLUT_KEY_LEFT) viewFrame.RotateWorld(m3dDegToRad(-5.0), 0.0f, 1.0f, 0.0f); if(key == GLUT_KEY_RIGHT) viewFrame.RotateWorld(m3dDegToRad(5.0), 0.0f, 1.0f, 0.0f); //åˆ·æ–°çª—å£ glutPostRedisplay(); } //å¯åŠ¨demoï¼Œå°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³• void ChangeSize(int w, int h) { if(h == 0) h = 1; // è®¾ç½®è§†å›¾çª—å£çš„å°ºå¯¸ glViewport(0, 0, w, h); //è®¾ç½®æ­£æŠ•å½±çŸ©é˜µ /* void SetOrthographic(GLfloat xMin, GLfloat xMax, GLfloat yMin, GLfloat yMax, GLfloat zMin, GLfloat zMax) */ viewFrustum.SetOrthographic(-130.0f, 130.0f, -130.0f, 130.0f, -130.0f, 130.0f); //1.è·å–æŠ•å½±çŸ©é˜µ viewFrustum.GetProjectionMatrix() //2.å°†æŠ•å½±çŸ©é˜µåŠ è½½åˆ°projectionMatrixä¸­ projectionMatrix.LoadMatrix(viewFrustum.GetProjectionMatrix()); //è®¾ç½®å˜æ¢ç®¡çº¿ä»¥ä½¿ç”¨ä¸¤ä¸ªçŸ©é˜µå †æ ˆ transformPipeline.SetMatrixStacks(modelViewMatix, projectionMatrix); } int main(int argc, char* argv[]) { gltSetWorkingDirectory(argv[0]); glutInit(&argc, argv); glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGBA | GLUT_DEPTH | GLUT_STENCIL); glutInitWindowSize(800, 600); glutCreateWindow(\"Orthographic Projection Example\"); glutReshapeFunc(ChangeSize); glutSpecialFunc(SpecialKeys); glutDisplayFunc(RenderScene); GLenum err = glewInit(); if (GLEW_OK != err) { fprintf(stderr, \"GLEW Error: %s\\n\", glewGetErrorString(err)); return 1; } SetupRC(); glutMainLoop(); return 0; } 4.4 é€è§†æŠ•å½± #include \"GLTools.h\" #include \"GLMatrixStack.h\" #include \"GLFrame.h\" #include \"GLFrustum.h\" #include \"GLGeometryTransform.h\" #include \"GLBatch.h\" #include #ifdef __APPLE__ #include #else #define FREEGLUT_STATIC #include #endif GLFrame viewFrame; GLFrustum viewFrustum; GLBatch tubeBatch; GLBatch innerBatch; GLMatrixStack modelViewMatix; GLMatrixStack projectionMatrix; GLGeometryTransform transformPipeline; GLShaderManager shaderManager; void RenderScene(void) { glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); glEnable(GL_DEPTH_TEST); modelViewMatix.PushMatrix(viewFrame); GLfloat vRed[] = { 1.0f, 0.0f, 0.0f, 1.0f }; GLfloat vGray[] = { 0.75f, 0.75f, 0.75f, 1.0f }; shaderManager.UseStockShader(GLT_SHADER_DEFAULT_LIGHT, transformPipeline.GetModelViewMatrix(), transformPipeline.GetProjectionMatrix(), vRed); tubeBatch.Draw(); shaderManager.UseStockShader(GLT_SHADER_DEFAULT_LIGHT, transformPipeline.GetModelViewMatrix(), transformPipeline.GetProjectionMatrix(), vGray); innerBatch.Draw(); modelViewMatix.PopMatrix(); glutSwapBuffers(); } void SetupRC() { glClearColor(0.0f, 0.0f, 0.75f, 1.0f ); glEnable(GL_DEPTH_TEST); shaderManager.InitializeStockShaders(); viewFrame.MoveForward(450.0f); tubeBatch.Begin(GL_QUADS, 200); float fZ = 100.0f; float bZ = -100.0f; tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, 100.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f,50.0f,fZ); // Right Panel tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(50.0f,-50.0f,fZ); // Top Panel tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, 35.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 35.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 50.0f,fZ); // Bottom Panel tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -35.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -35.0f,fZ); // Top length section //////////////////////////// // Normal points up Y axis tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f,50.0f,bZ); // Bottom section tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, fZ); // Left section tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, bZ); // Right Section tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, fZ); // Pointing straight out Z // Left Panel tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f,50.0f,fZ); // Right Panel tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(50.0f,-50.0f,fZ); // Top Panel tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, 35.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 35.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 50.0f,fZ); // Bottom Panel tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -35.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -35.0f,fZ); // Top length section //////////////////////////// // Normal points up Y axis tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, 1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f,50.0f,bZ); // Bottom section tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(0.0f, -1.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, fZ); // Left section tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(50.0f, 50.0f, bZ); // Right Section tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, fZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, bZ); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Normal3f(-1.0f, 0.0f, 0.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, fZ); // Left Panel tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f,50.0f,bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-50.0f, -50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-50.0f, 50.0f, bZ); // Right Panel tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(50.0f,-50.0f,bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(50.0f, 50.0f, bZ); // Top Panel tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, 35.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, 35.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, 50.0f, bZ); // Bottom Panel tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -35.0f,bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(35.0f, -50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -50.0f, bZ); tubeBatch.Normal3f(0.0f, 0.0f, -1.0f); tubeBatch.Color4f(1.0f, 0.0f, 0.0f, 1.0f); tubeBatch.Vertex3f(-35.0f, -35.0f, bZ); tubeBatch.End(); innerBatch.Begin(GL_QUADS, 40); // Insides ///////////////////////////// // Normal points up Y axis innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(-35.0f, 35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(35.0f, 35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(35.0f, 35.0f, bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(-35.0f,35.0f,bZ); // Bottom section innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(-35.0f, -35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(-35.0f, -35.0f, bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(35.0f, -35.0f, bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(0.0f, 1.0f, 0.0f); innerBatch.Vertex3f(35.0f, -35.0f, fZ); // Left section innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(-35.0f, 35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(-35.0f, 35.0f, bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(-35.0f, -35.0f, bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(-35.0f, -35.0f, fZ); // Right Section innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(-1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(35.0f, 35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(-1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(35.0f, -35.0f, fZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(-1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(35.0f, -35.0f, bZ); innerBatch.Color4f(0.75f, 0.75f, 0.75f, 1.0f); innerBatch.Normal3f(-1.0f, 0.0f, 0.0f); innerBatch.Vertex3f(35.0f, 35.0f, bZ); innerBatch.End(); } void SpecialKeys(int key, int x, int y) { if(key == GLUT_KEY_UP) viewFrame.RotateWorld(m3dDegToRad(-5.0), 1.0f, 0.0f, 0.0f); if(key == GLUT_KEY_DOWN) viewFrame.RotateWorld(m3dDegToRad(5.0), 1.0f, 0.0f, 0.0f); if(key == GLUT_KEY_LEFT) viewFrame.RotateWorld(m3dDegToRad(-5.0), 0.0f, 1.0f, 0.0f); if(key == GLUT_KEY_RIGHT) viewFrame.RotateWorld(m3dDegToRad(5.0), 0.0f, 1.0f, 0.0f); // Refresh the Window glutPostRedisplay(); } void ChangeSize(int w, int h) { if(h == 0) h = 1; glViewport(0, 0, w, h); //è®¾ç½®æ­£æŠ•å½±çŸ©é˜µ //viewFrustum.SetOrthographic(-130.0f, 130.0f, -130.0f, 130.0f, -130.0f, 130.0f); viewFrustum.SetPerspective(35.0f, float(w)/float(h), 1.0f, 1000.0f); projectionMatrix.LoadMatrix(viewFrustum.GetProjectionMatrix()); transformPipeline.SetMatrixStacks(modelViewMatix, projectionMatrix); } int main(int argc, char* argv[]) { gltSetWorkingDirectory(argv[0]); glutInit(&argc, argv); glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGBA | GLUT_DEPTH | GLUT_STENCIL); glutInitWindowSize(800, 600); glutCreateWindow(\"Perspective Projection Example\"); glutReshapeFunc(ChangeSize); glutSpecialFunc(SpecialKeys); glutDisplayFunc(RenderScene); GLenum err = glewInit(); if (GLEW_OK != err) { fprintf(stderr, \"GLEW Error: %s\\n\", glewGetErrorString(err)); return 1; } SetupRC(); glutMainLoop(); return 0; } "},"pages/OpenGLç³»åˆ—/05_OpenGLä¸‰è§’å½¢æ‰¹æ¬¡ç±»ç»˜åˆ¶æ¡ˆä¾‹.html":{"url":"pages/OpenGLç³»åˆ—/05_OpenGLä¸‰è§’å½¢æ‰¹æ¬¡ç±»ç»˜åˆ¶æ¡ˆä¾‹.html","title":"5.OpenGLä¸‰è§’å½¢æ‰¹æ¬¡ç±»ç»˜åˆ¶æ¡ˆä¾‹","keywords":"","body":"5.OpenGLä¸‰è§’å½¢æ‰¹æ¬¡ç±»ç»˜åˆ¶æ¡ˆä¾‹ æºç  // Objects.cpp // OpenGL SuperBible, Chapter 4 // Demonstrates GLTools built-in objects // Program by Richard S. Wright Jr. #include \"GLTools.h\" // OpenGL toolkit #include \"GLMatrixStack.h\" #include \"GLFrame.h\" #include \"GLFrustum.h\" #include \"GLBatch.h\" #include \"GLGeometryTransform.h\" #include \"StopWatch.h\" #include #ifdef __APPLE__ #include #else #define FREEGLUT_STATIC #include #endif GLShaderManager shaderManager; GLMatrixStack modelViewMatrix; GLMatrixStack projectionMatrix; //è§‚å¯Ÿè€…ä½ç½® GLFrame cameraFrame; //ä¸–ç•Œåæ ‡ä½ç½® GLFrame objectFrame; //è§†æ™¯ä½“ï¼Œç”¨æ¥æ„é€ æŠ•å½±çŸ©é˜µ GLFrustum viewFrustum; //ä¸‰è§’å½¢æ‰¹æ¬¡ç±» GLTriangleBatch CC_Triangle; //çƒ GLTriangleBatch sphereBatch; //ç¯ GLTriangleBatch torusBatch; //åœ†æŸ± GLTriangleBatch cylinderBatch; //é”¥ GLTriangleBatch coneBatch; //ç£ç›˜ GLTriangleBatch diskBatch; GLGeometryTransform transformPipeline; M3DMatrix44f shadowMatrix; GLfloat vGreen[] = { 0.0f, 1.0f, 0.0f, 1.0f }; GLfloat vBlack[] = { 0.0f, 0.0f, 0.0f, 1.0f }; int nStep = 0; // å°†ä¸Šä¸‹æ–‡ä¸­ï¼Œè¿›è¡Œå¿…è¦çš„åˆå§‹åŒ– void SetupRC() { // Black background glClearColor(0.7f, 0.7f, 0.7f, 1.0f ); //åˆå§‹åŒ–å›ºå®šç€è‰²ç®¡ç†å™¨ shaderManager.InitializeStockShaders(); //å¼€å¯æ·±åº¦æµ‹è¯• glEnable(GL_DEPTH_TEST); //é€šè¿‡GLGeometryTransformç®¡ç†çŸ©é˜µå †æ ˆ //ä½¿ç”¨transformPipeline ç®¡é“ç®¡ç†æ¨¡å‹è§†å›¾çŸ©é˜µå †æ ˆ å’Œ æŠ•å½±çŸ©é˜µå †æ ˆ transformPipeline.SetMatrixStacks(modelViewMatrix, projectionMatrix); //å°†è§‚å¯Ÿè€…åæ ‡ä½ç½®Zç§»åŠ¨å¾€å±å¹•é‡Œç§»åŠ¨15ä¸ªå•ä½ä½ç½® //è¡¨ç¤ºç¦»å±å¹•ä¹‹é—´çš„è·ç¦» è´Ÿæ•°ï¼Œæ˜¯å¾€å±å¹•åé¢ç§»åŠ¨ï¼›æ­£æ•°ï¼Œå¾€å±å¹•å‰é¢ç§»åŠ¨ cameraFrame.MoveForward(-15.0f); //åˆ©ç”¨ä¸‰è§’å½¢æ‰¹æ¬¡ç±»æ„é€ å›¾å½¢å¯¹è±¡ // çƒ /* gltMakeSphere(GLTriangleBatch& sphereBatch, GLfloat fRadius, GLint iSlices, GLint iStacks); å‚æ•°1ï¼šsphereBatchï¼Œä¸‰è§’å½¢æ‰¹æ¬¡ç±»å¯¹è±¡ å‚æ•°2ï¼šfRadiusï¼Œçƒä½“åŠå¾„ å‚æ•°3ï¼šiSlicesï¼Œä»çƒä½“åº•éƒ¨å †å åˆ°é¡¶éƒ¨çš„ä¸‰è§’å½¢å¸¦çš„æ•°é‡ï¼›å…¶å®çƒä½“æ˜¯ä¸€åœˆä¸€åœˆä¸‰è§’å½¢å¸¦ç»„æˆ å‚æ•°4ï¼šiStacksï¼Œå›´ç»•çƒä½“ä¸€åœˆæ’åˆ—çš„ä¸‰è§’å½¢å¯¹æ•° å»ºè®®ï¼šä¸€ä¸ªå¯¹ç§°æ€§è¾ƒå¥½çš„çƒä½“çš„ç‰‡æ®µæ•°é‡æ˜¯å †å æ•°é‡çš„2å€ï¼Œå°±æ˜¯iStacks = 2 * iSlices; ç»˜åˆ¶çƒä½“éƒ½æ˜¯å›´ç»•Zè½´ï¼Œè¿™æ ·+zå°±æ˜¯çƒä½“çš„é¡¶ç‚¹ï¼Œ-zå°±æ˜¯çƒä½“çš„åº•éƒ¨ã€‚ */ gltMakeSphere(sphereBatch, 3.0, 10, 20); // ç¯é¢ /* gltMakeTorus(GLTriangleBatch& torusBatch, GLfloat majorRadius, GLfloat minorRadius, GLint numMajor, GLint numMinor); å‚æ•°1ï¼štorusBatchï¼Œä¸‰è§’å½¢æ‰¹æ¬¡ç±»å¯¹è±¡ å‚æ•°2ï¼šmajorRadius,ç”œç”œåœˆä¸­å¿ƒåˆ°å¤–è¾¹ç¼˜çš„åŠå¾„ å‚æ•°3ï¼šminorRadius,ç”œç”œåœˆä¸­å¿ƒåˆ°å†…è¾¹ç¼˜çš„åŠå¾„ å‚æ•°4ï¼šnumMajor,æ²¿ç€ä¸»åŠå¾„çš„ä¸‰è§’å½¢æ•°é‡ å‚æ•°5ï¼šnumMinor,æ²¿ç€å†…éƒ¨è¾ƒå°åŠå¾„çš„ä¸‰è§’å½¢æ•°é‡ */ gltMakeTorus(torusBatch, 3.0f, 0.75f, 15, 15); // åœ†æŸ± /* void gltMakeCylinder(GLTriangleBatch& cylinderBatch, GLfloat baseRadius, GLfloat topRadius, GLfloat fLength, GLint numSlices, GLint numStacks); å‚æ•°1ï¼šcylinderBatchï¼Œä¸‰è§’å½¢æ‰¹æ¬¡ç±»å¯¹è±¡ å‚æ•°2ï¼šbaseRadius,åº•éƒ¨åŠå¾„ å‚æ•°3ï¼štopRadius,å¤´éƒ¨åŠå¾„ å‚æ•°4ï¼šfLength,åœ†å½¢é•¿åº¦ å‚æ•°5ï¼šnumSlices,å›´ç»•Zè½´çš„ä¸‰è§’å½¢å¯¹çš„æ•°é‡ å‚æ•°6ï¼šnumStacks,åœ†æŸ±åº•éƒ¨å †å åˆ°é¡¶éƒ¨åœ†ç¯çš„ä¸‰è§’å½¢æ•°é‡ */ gltMakeCylinder(cylinderBatch, 2.0f, 2.0f, 3.0f, 15, 2); //é”¥ /* void gltMakeCylinder(GLTriangleBatch& cylinderBatch, GLfloat baseRadius, GLfloat topRadius, GLfloat fLength, GLint numSlices, GLint numStacks); å‚æ•°1ï¼šcylinderBatchï¼Œä¸‰è§’å½¢æ‰¹æ¬¡ç±»å¯¹è±¡ å‚æ•°2ï¼šbaseRadius,åº•éƒ¨åŠå¾„ å‚æ•°3ï¼štopRadius,å¤´éƒ¨åŠå¾„ å‚æ•°4ï¼šfLength,åœ†å½¢é•¿åº¦ å‚æ•°5ï¼šnumSlices,å›´ç»•Zè½´çš„ä¸‰è§’å½¢å¯¹çš„æ•°é‡ å‚æ•°6ï¼šnumStacks,åœ†æŸ±åº•éƒ¨å †å åˆ°é¡¶éƒ¨åœ†ç¯çš„ä¸‰è§’å½¢æ•°é‡ */ //åœ†æŸ±ä½“ï¼Œä»0å¼€å§‹å‘Zè½´æ­£æ–¹å‘å»¶ä¼¸ã€‚ //åœ†é”¥ä½“ï¼Œæ˜¯ä¸€ç«¯çš„åŠå¾„ä¸º0ï¼Œå¦ä¸€ç«¯åŠå¾„å¯æŒ‡å®šã€‚ gltMakeCylinder(coneBatch, 2.0f, 0.0f, 3.0f, 13, 2); // ç£ç›˜ /* void gltMakeDisk(GLTriangleBatch& diskBatch, GLfloat innerRadius, GLfloat outerRadius, GLint nSlices, GLint nStacks); å‚æ•°1:diskBatchï¼Œä¸‰è§’å½¢æ‰¹æ¬¡ç±»å¯¹è±¡ å‚æ•°2:innerRadius,å†…åœ†åŠå¾„ å‚æ•°3:outerRadius,å¤–åœ†åŠå¾„ å‚æ•°4:nSlices,åœ†ç›˜å›´ç»•Zè½´çš„ä¸‰è§’å½¢å¯¹çš„æ•°é‡ å‚æ•°5:nStacks,åœ†ç›˜å¤–ç½‘åˆ°å†…å›´çš„ä¸‰è§’å½¢æ•°é‡ */ gltMakeDisk(diskBatch, 1.5f, 3.0f, 13, 3); } void DrawWireFramedBatch(GLTriangleBatch* pBatch) { //å¹³é¢ç€è‰²å™¨ï¼Œç»˜åˆ¶ä¸‰è§’å½¢ shaderManager.UseStockShader(GLT_SHADER_FLAT, transformPipeline.GetModelViewProjectionMatrix(), vGreen); //ä¼ è¿‡æ¥çš„å‚æ•°ï¼Œå¯¹åº”ä¸åŒçš„å›¾å½¢Batch pBatch->Draw(); // ç”»å‡ºé»‘è‰²è½®å»“ glPolygonOffset(-1.0f, -1.0f); //å¼€å¯å¤„ç†çº¿ glEnable(GL_LINE_SMOOTH); //å¼€å¯æ··åˆåŠŸèƒ½ glEnable(GL_BLEND); //é¢œè‰²æ··åˆ //è¡¨ç¤ºæºé¢œè‰²ä¹˜ä»¥è‡ªèº«çš„alpha å€¼ï¼Œç›®æ ‡é¢œè‰²ä¹˜ä»¥1.0å‡å»æºé¢œè‰²çš„alphaå€¼ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæºé¢œè‰²çš„alphaå€¼è¶Šå¤§ï¼Œåˆ™äº§ç”Ÿçš„æ–°é¢œè‰²ä¸­æºé¢œè‰²æ‰€å æ¯”ä¾‹å°±è¶Šå¤§ï¼Œè€Œç›®æ ‡é¢œè‰²æ‰€å æ¯”ä¾‹åˆ™å‡ å°ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„å°†æºé¢œè‰²çš„alphaå€¼ç†è§£ä¸ºâ€œä¸é€æ˜åº¦â€ã€‚è¿™ä¹Ÿæ˜¯æ··åˆæ—¶æœ€å¸¸ç”¨çš„æ–¹å¼ã€‚ glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA); //é€šè¿‡ç¨‹åºç‚¹å¤§å°æ¨¡å¼æ¥è®¾ç½®ç‚¹çš„å¤§å° glEnable(GL_POLYGON_OFFSET_LINE); //å¤šè¾¹å½¢æ¨¡å‹(èƒŒé¢ã€çº¿) å°†å¤šè¾¹å½¢èƒŒé¢è®¾ä¸ºçº¿æ¡†æ¨¡å¼ glPolygonMode(GL_FRONT_AND_BACK, GL_LINE); //çº¿æ¡å®½åº¦ glLineWidth(2.5f); //å¹³é¢ç€è‰²å™¨ç»˜åˆ¶çº¿æ¡ shaderManager.UseStockShader(GLT_SHADER_FLAT, transformPipeline.GetModelViewProjectionMatrix(), vBlack); pBatch->Draw(); // æ¢å¤å¤šè¾¹å½¢æ¨¡å¼å’Œæ·±åº¦æµ‹è¯• glPolygonMode(GL_FRONT_AND_BACK, GL_FILL); glDisable(GL_POLYGON_OFFSET_LINE); glLineWidth(1.0f); glDisable(GL_BLEND); glDisable(GL_LINE_SMOOTH); } //å¬å”¤åœºæ™¯ void RenderScene(void) { //ç”¨å½“å‰æ¸…é™¤é¢œè‰²æ¸…é™¤çª—å£èƒŒæ™¯ glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT | GL_STENCIL_BUFFER_BIT); //æ¨¡å‹è§†å›¾çŸ©é˜µæ ˆå †ï¼Œå‹æ ˆ modelViewMatrix.PushMatrix(); //è·å–æ‘„åƒå¤´çŸ©é˜µ M3DMatrix44f mCamera; //ä»camereaFrameä¸­è·å–çŸ©é˜µåˆ°mCamera cameraFrame.GetCameraMatrix(mCamera); //æ¨¡å‹è§†å›¾å †æ ˆçš„ çŸ©é˜µä¸mCameraçŸ©é˜µ ç›¸ä¹˜ä¹‹åï¼Œå­˜å‚¨åˆ°modelViewMatrixçŸ©é˜µå †æ ˆä¸­ modelViewMatrix.MultMatrix(mCamera); //åˆ›å»ºçŸ©é˜µmObjectFrame M3DMatrix44f mObjectFrame; //ä»ObjectFrame è·å–çŸ©é˜µåˆ°mOjectFrameä¸­ objectFrame.GetMatrix(mObjectFrame); //å°†modelViewMatrix çš„å †æ ˆä¸­çš„çŸ©é˜µ ä¸ mOjbectFrame çŸ©é˜µç›¸ä¹˜ï¼Œå­˜å‚¨åˆ°modelViewMatrixçŸ©é˜µå †æ ˆä¸­ modelViewMatrix.MultMatrix(mObjectFrame); //ä½¿ç”¨å¹³é¢ç€è‰²å™¨ //å‚æ•°1ï¼šç±»å‹ //å‚æ•°2ï¼šé€šè¿‡transformPipelineè·å–æ¨¡å‹è§†å›¾çŸ©é˜µ //å‚æ•°3ï¼šé¢œè‰² shaderManager.UseStockShader(GLT_SHADER_FLAT, transformPipeline.GetModelViewProjectionMatrix(), vBlack); //åˆ¤æ–­ä½ ç›®å‰æ˜¯ç»˜åˆ¶ç¬¬å‡ ä¸ªå›¾å½¢ switch(nStep) { case 0: DrawWireFramedBatch(&sphereBatch); break; case 1: DrawWireFramedBatch(&torusBatch); break; case 2: DrawWireFramedBatch(&cylinderBatch); break; case 3: DrawWireFramedBatch(&coneBatch); break; case 4: DrawWireFramedBatch(&diskBatch); break; } modelViewMatrix.PopMatrix(); // Flush drawing commands glutSwapBuffers(); } //ä¸Šä¸‹å·¦å³ï¼Œç§»åŠ¨å›¾å½¢ void SpecialKeys(int key, int x, int y) { if(key == GLUT_KEY_UP) //ç§»åŠ¨ä¸–ç•Œåæ ‡ç³»ï¼Œè€Œä¸æ˜¯å»ç§»åŠ¨ç‰©ä½“ã€‚ //å°†ä¸–ç•Œåæ ‡ç³»åœ¨Xæ–¹å‘ç§»åŠ¨-5.0 objectFrame.RotateWorld(m3dDegToRad(-5.0f), 1.0f, 0.0f, 0.0f); if(key == GLUT_KEY_DOWN) objectFrame.RotateWorld(m3dDegToRad(5.0f), 1.0f, 0.0f, 0.0f); if(key == GLUT_KEY_LEFT) objectFrame.RotateWorld(m3dDegToRad(-5.0f), 0.0f, 1.0f, 0.0f); if(key == GLUT_KEY_RIGHT) objectFrame.RotateWorld(m3dDegToRad(5.0f), 0.0f, 1.0f, 0.0f); glutPostRedisplay(); } //ç‚¹å‡»ç©ºæ ¼ï¼Œåˆ‡æ¢æ¸²æŸ“å›¾å½¢ void KeyPressFunc(unsigned char key, int x, int y) { if(key == 32) { nStep++; if(nStep > 4) nStep = 0; } switch(nStep) { case 0: glutSetWindowTitle(\"Sphere\"); break; case 1: glutSetWindowTitle(\"Torus\"); break; case 2: glutSetWindowTitle(\"Cylinder\"); break; case 3: glutSetWindowTitle(\"Cone\"); break; case 4: glutSetWindowTitle(\"Disk\"); break; } glutPostRedisplay(); } void ChangeSize(int w, int h) { glViewport(0, 0, w, h); //é€è§†æŠ•å½± viewFrustum.SetPerspective(35.0f, float(w) / float(h), 1.0f, 500.0f); //projectionMatrix çŸ©é˜µå †æ ˆ åŠ è½½é€è§†æŠ•å½±çŸ©é˜µ projectionMatrix.LoadMatrix(viewFrustum.GetProjectionMatrix()); //modelViewMatrix çŸ©é˜µå †æ ˆ åŠ è½½å•å…ƒçŸ©é˜µ modelViewMatrix.LoadIdentity(); } int main(int argc, char* argv[]) { gltSetWorkingDirectory(argv[0]); glutInit(&argc, argv); glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGBA | GLUT_DEPTH | GLUT_STENCIL); glutInitWindowSize(800, 600); glutCreateWindow(\"Sphere\"); glutReshapeFunc(ChangeSize); glutKeyboardFunc(KeyPressFunc); glutSpecialFunc(SpecialKeys); glutDisplayFunc(RenderScene); GLenum err = glewInit(); if (GLEW_OK != err) { fprintf(stderr, \"GLEW Error: %s\\n\", glewGetErrorString(err)); return 1; } SetupRC(); glutMainLoop(); return 0; } "},"pages/OpenGLç³»åˆ—/06_OpenGLæ¨¡å‹è§†å›¾çŸ©é˜µç»˜åˆ¶æ¡ˆä¾‹.html":{"url":"pages/OpenGLç³»åˆ—/06_OpenGLæ¨¡å‹è§†å›¾çŸ©é˜µç»˜åˆ¶æ¡ˆä¾‹.html","title":"6.OpenGLæ¨¡å‹è§†å›¾çŸ©é˜µç»˜åˆ¶æ¡ˆä¾‹","keywords":"","body":"6.OpenGLæ¨¡å‹è§†å›¾çŸ©é˜µç»˜åˆ¶æ¡ˆä¾‹ æºç  #include \"GLTools.h\" #include \"GLMatrixStack.h\" #include \"GLFrame.h\" #include \"GLFrustum.h\" #include \"GLGeometryTransform.h\" #include \"GLBatch.h\" #include \"StopWatch.h\" #include #ifdef __APPLE__ #include #else #define FREEGLUT_STATIC #include #endif GLFrustum viewFrustum; GLShaderManager shaderManager; GLTriangleBatch torusBatch; // è®¾ç½®è§†å£å’ŒæŠ•å½±çŸ©é˜µ void ChangeSize(int w, int h) { //é˜²æ­¢é™¤ä»¥é›¶ if(h == 0) h = 1; //å°†è§†å£è®¾ç½®ä¸ºçª—å£å°ºå¯¸ glViewport(0, 0, w, h); //è®¾ç½®é€è§†æŠ•å½± viewFrustum.SetPerspective(35.0f, float(w)/float(h), 1.0f, 1000.0f); } //å¬å”¤åœºæ™¯ void RenderScene(void) { //å»ºç«‹åŸºäºæ—¶é—´å˜åŒ–çš„åŠ¨ç”» static CStopWatch rotTimer; //å½“å‰æ—¶é—´ * 60s float yRot = rotTimer.GetElapsedSeconds() * 60.0f; //æ¸…é™¤å±å¹•ã€æ·±åº¦ç¼“å­˜åŒº glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); // çŸ©é˜µå˜é‡ M3DMatrix44f mTranslate, mRotate, mModelview, mModelViewProjection; //åˆ›å»ºä¸€ä¸ª4*4çŸ©é˜µå˜é‡ï¼Œå°†èŠ±æ‰˜æ²¿ç€Zè½´è´Ÿæ–¹å‘ç§»åŠ¨2.5ä¸ªå•ä½é•¿åº¦ m3dTranslationMatrix44(mTranslate, 0.0f, 0.0f, -2.5f); //åˆ›å»ºä¸€ä¸ª4*4çŸ©é˜µå˜é‡ï¼Œå°†èŠ±æ‰˜åœ¨Yè½´ä¸Šæ¸²æŸ“yRotåº¦ï¼ŒyRotæ ¹æ®ç»è¿‡æ—¶é—´è®¾ç½®åŠ¨ç”»å¸§ç‡ m3dRotationMatrix44(mRotate, m3dDegToRad(yRot), 0.0f, 1.0f, 0.0f); // m3dRotationMatrix44(mRotate, m3dDegToRad(yRot), 1.0f, 0.0f, 0.0f); //ä¸ºmModerView é€šè¿‡çŸ©é˜µæ—‹è½¬çŸ©é˜µã€ç§»åŠ¨çŸ©é˜µç›¸ä¹˜ï¼Œå°†ç»“æœæ·»åŠ åˆ°mModerViewä¸Š m3dMatrixMultiply44(mModelview, mTranslate, mRotate); // å°†æ¨¡å‹è§†å›¾çŸ©é˜µçš„æŠ•å½±çŸ©é˜µï¼Œ // å°†æŠ•å½±çŸ©é˜µä¹˜ä»¥æ¨¡å‹è§†å›¾çŸ©é˜µï¼Œå°†å˜åŒ–ç»“æœé€šè¿‡çŸ©é˜µä¹˜æ³•åº”ç”¨åˆ°mModelViewProjectionçŸ©é˜µä¸Š m3dMatrixMultiply44(mModelViewProjection, viewFrustum.GetProjectionMatrix(),mModelview); // å°†è¿™ä¸ªå·²å®Œæˆçš„çŸ©é˜µä¼ é€’ç»™ç€è‰²å™¨ï¼Œå¹¶æ¸²æŸ“è¿™ä¸ªåœ†ç¯é¢ã€‚ //ç»˜å›¾é¢œè‰² GLfloat vBlack[] = { 0.0f, 0.0f, 0.0f, 1.0f }; //é€šè¿‡å¹³é¢ç€è‰²å™¨æäº¤çŸ©é˜µï¼Œå’Œé¢œè‰²ã€‚ //å¹³é¢ç€è‰²å™¨çš„å·¥ä½œåªæ˜¯ä½¿ç”¨æä¾›çŸ©é˜µæ¥é¡¶ç‚¹æ¥è¿›è¡Œè½¬æ¢ï¼Œå¹¶ä¸”ä½¿ç”¨æŒ‡å®šçš„é¢œè‰²å¯¹å‡ ä½•å›¾å½¢è¿›è¡Œç€è‰²ä»¥å¾—åˆ°å®å¿ƒå‡ ä½•å›¾å½¢ shaderManager.UseStockShader(GLT_SHADER_FLAT, mModelViewProjection, vBlack); //å¼€å§‹ç»˜å›¾ torusBatch.Draw(); // äº¤æ¢ç¼“å†²åŒºï¼Œå¹¶ç«‹å³åˆ·æ–° glutSwapBuffers(); glutPostRedisplay(); } void SetupRC() { glClearColor(0.8f, 0.8f, 0.8f, 1.0f ); glEnable(GL_DEPTH_TEST); shaderManager.InitializeStockShaders(); // å½¢æˆä¸€ä¸ªåœ†ç¯ gltMakeTorus(torusBatch, 0.4f, 0.15f, 30, 30); //å½¢æˆä¸€ä¸ªçƒ gltMakeSphere(torusBatch, 0.4f, 10, 20); glPolygonMode(GL_FRONT_AND_BACK, GL_LINE); } int main(int argc, char* argv[]) { gltSetWorkingDirectory(argv[0]); glutInit(&argc, argv); glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGBA | GLUT_DEPTH | GLUT_STENCIL); glutInitWindowSize(800, 600); glutCreateWindow(\"ModelViewProjection Example\"); glutReshapeFunc(ChangeSize); glutDisplayFunc(RenderScene); GLenum err = glewInit(); if (GLEW_OK != err) { fprintf(stderr, \"GLEW Error: %s\\n\", glewGetErrorString(err)); return 1; } SetupRC(); glutMainLoop(); return 0; } "},"pages/OpenGLç³»åˆ—/07_OpenGLé¡¶ç‚¹å˜åŒ–ç®¡çº¿è¯¦è§£.html":{"url":"pages/OpenGLç³»åˆ—/07_OpenGLé¡¶ç‚¹å˜åŒ–ç®¡çº¿è¯¦è§£.html","title":"7.OpenGLé¡¶ç‚¹å˜åŒ–ç®¡çº¿è¯¦è§£","keywords":"","body":"7.OpenGLé¡¶ç‚¹å˜åŒ–ç®¡çº¿è¯¦è§£ ä¸€ã€é¡¶ç‚¹å˜åŒ–ç®¡çº¿ äºŒã€ä½¿ç”¨çŸ©é˜µå †æ ˆ // ç±»å‹ GLMatrixStack::GLMatrixStack(int iStackDepth = 64); // åœ¨å †æ ˆé¡¶éƒ¨è½½â¼Šä¸€ä¸ªå•å…ƒçŸ©é˜µ void GLMatrixStack::LoadIdentity(void); // åœ¨å †æ ˆé¡¶éƒ¨è½½â¼Šä»»ä½•çŸ©é˜µ // å‚æ•°:4*4çŸ©é˜µ void GLMatrixStack::LoadMatrix(const M3DMatrix44f m); // çŸ©é˜µä¹˜ä»¥çŸ©é˜µå †æ ˆé¡¶éƒ¨çŸ©é˜µï¼Œç›¸ä¹˜ç»“æœå­˜å‚¨åˆ°å †æ ˆçš„é¡¶éƒ¨ void GLMatrixStack::MultMatrix(const M3DMatrix44f); // è·å–çŸ©é˜µå †æ ˆé¡¶éƒ¨çš„å€¼ GetMatrix å‡½æ•° // ä¸ºäº†é€‚åº”GLShaderManangerçš„ä½¿â½¤ï¼Œæˆ–è€…è·å–é¡¶éƒ¨çŸ©é˜µçš„å‰¯æœ¬ const M3DMatrix44f & GLMatrixStack::GetMatrix(void); void GLMatrixStack::GetMatrix(M3DMatrix44f mMatrix); ä¸‰ã€å‹æ ˆã€å‡ºæ ˆ å‹æ ˆ: å­˜å‚¨â¼€ä¸ªçŠ¶æ€ å‡ºæ ˆ: æ¢å¤â¼€ä¸ªçŠ¶æ€ // å°†å½“å‰çŸ©é˜µå‹â¼Šå †æ ˆ void GLMatrixStack::PushMatrix(void); // å°†M3DMatrix44f çŸ©é˜µå¯¹è±¡å‹å…¥å½“å‰çŸ©é˜µå †æ ˆ void PushMatrix(const M3DMatrix44f mMatrix); // å°†GLFameå¯¹è±¡å‹å…¥çŸ©é˜µå¯¹è±¡ void PushMatrix(GLFame &frame); // å‡ºæ ˆ(å‡ºæ ˆæŒ‡çš„æ˜¯ç§»é™¤é¡¶éƒ¨çš„çŸ©é˜µå¯¹è±¡) void GLMatrixStack::PopMatrix(void); å››ã€ä»¿å°„å˜æ¢ //Rotate å‡½æ•°angleå‚æ•°æ˜¯ä¼ é€’çš„åº¦æ•°ï¼Œâ½½ä¸æ˜¯å¼§åº¦ void MatrixStack::Rotate(GLfloat angle,GLfloat x,GLfloat y,GLfloat z); void MatrixStack::Translate(GLfloat x,GLfloat y,GLfloat z); void MatrixStack::Scale(GLfloat x,GLfloat y,GLfloat z); äº”ã€GLFrame ä½¿â½¤ç…§ç›¸æœº(æ‘„åƒæœº) å’Œ â»†è‰²å¸§ è¿›â¾ç§»åŠ¨ class GLFrame { protected: // Where am I? M3DVector3f vOrigin; // Where am I going? M3DVector3f vForward; // Which way is up? M3DVector3f vUp; } // å°†å †æ ˆçš„é¡¶éƒ¨å‹å…¥ä»»ä½•çŸ©é˜µ void GLMatrixStack::LoadMatrix(GLFrame &frame); // çŸ©é˜µä¹˜ä»¥çŸ©é˜µå †æ ˆé¡¶éƒ¨çš„çŸ©é˜µã€‚ç›¸ä¹˜ç»“æœå­˜å‚¨åœ¨å †æ ˆçš„é¡¶éƒ¨ void GLMatrixStack::MultMatrix(GLFrame &frame); // å°†å½“å‰çš„çŸ©é˜µå‹æ ˆ void GLMatrixStack::PushMatrix(GLFrame &frame); // GLFrameå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°â½¤æ¥æ£€ç´¢æ¡ä»¶é€‚åˆçš„ç…§ç›¸çŸ©é˜µ void GetCameraMatrix(M3DMatrix44f m,bool bRotationOnly = flase); "},"pages/OpenGLç³»åˆ—/08_OpenGLå…¬è½¬è‡ªè½¬æ¡ˆä¾‹.html":{"url":"pages/OpenGLç³»åˆ—/08_OpenGLå…¬è½¬è‡ªè½¬æ¡ˆä¾‹.html","title":"8.OpenGLå…¬è½¬è‡ªè½¬æ¡ˆä¾‹","keywords":"","body":"8.OpenGLå…¬è½¬è‡ªè½¬æ¡ˆä¾‹ æºç  #include \"GLTools.h\" #include \"GLShaderManager.h\" #include \"GLFrustum.h\" #include \"GLBatch.h\" #include \"GLMatrixStack.h\" #include \"GLGeometryTransform.h\" #include \"StopWatch.h\" #include #include #ifdef __APPLE__ #include #else #define FREEGLUT_STATIC #include #endif //**4ã€æ·»åŠ é™„åŠ éšæœºçƒ #define NUM_SPHERES 50 GLFrame spheres[NUM_SPHERES]; GLShaderManager shaderManager; // ç€è‰²å™¨ç®¡ç†å™¨ GLMatrixStack modelViewMatrix; // æ¨¡å‹è§†å›¾çŸ©é˜µ GLMatrixStack projectionMatrix; // æŠ•å½±çŸ©é˜µ GLFrustum viewFrustum; // è§†æ™¯ä½“ GLGeometryTransform transformPipeline; // å‡ ä½•å›¾å½¢å˜æ¢ç®¡é“ GLTriangleBatch torusBatch; // èŠ±æ‰˜æ‰¹å¤„ç† GLBatch floorBatch; // åœ°æ¿æ‰¹å¤„ç† //**2ã€å®šä¹‰å…¬è½¬çƒçš„æ‰¹å¤„ç†ï¼ˆå…¬è½¬è‡ªè½¬ï¼‰** GLTriangleBatch sphereBatch; //çƒæ‰¹å¤„ç† //**3ã€è§’è‰²å¸§ ç…§ç›¸æœºè§’è‰²å¸§ï¼ˆå…¨å±€ç…§ç›¸æœºå®ä¾‹ï¼‰ GLFrame cameraFrame; void SetupRC() { // åˆå§‹åŒ–ç€è‰²å™¨ç®¡ç†å™¨ shaderManager.InitializeStockShaders(); //å¼€å¯æ·±åº¦æµ‹è¯• glEnable(GL_DEPTH_TEST); //å¼€å¯å¤šè¾¹å½¢æ¨¡å‹ //**4ã€å…³é—­çº¿æ¡†æ¸²æŸ“æ¨¡å¼ //glPolygonMode(GL_FRONT_AND_BACK, GL_LINE); //è®¾ç½®æ¸…å±é¢œè‰²åˆ°é¢œè‰²ç¼“å­˜åŒº glClearColor(0.0f, 0.0f, 0.0f, 1.0f); //ç»˜åˆ¶ç”œç”œåœˆ gltMakeTorus(torusBatch, 0.4f, 0.15f, 30, 30); //**2ã€ ç»˜åˆ¶çƒ(å…¬è½¬è‡ªè½¬)** gltMakeSphere(sphereBatch, 0.1f, 26, 13); //å¾€åœ°æ¿floorBatchæ‰¹å¤„ç†ä¸­æ·»åŠ é¡¶ç‚¹æ•°æ® floorBatch.Begin(GL_LINES, 324); for(GLfloat x = -20.0; x "},"pages/RxSwiftç³»åˆ—/01_Observable_å¯ç›‘å¬åºåˆ—.html":{"url":"pages/RxSwiftç³»åˆ—/01_Observable_å¯ç›‘å¬åºåˆ—.html","title":"1.Observable - å¯ç›‘å¬åºåˆ—","keywords":"","body":"1.Observable - å¯ç›‘å¬åºåˆ— ä¸€ã€Observable ä»‹ç» Observable ä½œä¸º Rx çš„æ ¹åŸºï¼Œæˆ‘ä»¬é¦–å…ˆå¯¹å®ƒè¦æœ‰ä¸€äº›åŸºæœ¬çš„äº†è§£ã€‚ iOS-RxSwift-Tutorials 1.1 Observable Observable è¿™ä¸ªç±»å°±æ˜¯ Rx æ¡†æ¶çš„åŸºç¡€ï¼Œæˆ‘ä»¬å¯ä»¥ç§°å®ƒä¸ºå¯è§‚å¯Ÿåºåˆ—ã€‚å®ƒçš„ä½œç”¨å°±æ˜¯å¯ä»¥å¼‚æ­¥åœ°äº§ç”Ÿä¸€ç³»åˆ—çš„ Eventï¼ˆäº‹ä»¶ï¼‰ï¼Œå³ä¸€ä¸ª Observable å¯¹è±¡ä¼šéšç€æ—¶é—´æ¨ç§»ä¸å®šæœŸåœ°å‘å‡º event(element : T) è¿™æ ·ä¸€ä¸ªä¸œè¥¿ã€‚ è€Œä¸”è¿™äº› Event è¿˜å¯ä»¥æºå¸¦æ•°æ®ï¼Œå®ƒçš„æ³›å‹ å°±æ˜¯ç”¨æ¥æŒ‡å®šè¿™ä¸ª Event æºå¸¦çš„æ•°æ®çš„ç±»å‹ã€‚ æœ‰äº†å¯è§‚å¯Ÿåºåˆ—ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æœ‰ä¸€ä¸ª Observerï¼ˆè®¢é˜…è€…ï¼‰æ¥è®¢é˜…å®ƒï¼Œè¿™æ ·è¿™ä¸ªè®¢é˜…è€…æ‰èƒ½æ”¶åˆ° Observable ä¸æ—¶å‘å‡ºçš„ Eventã€‚ 1.2 Event æŸ¥çœ‹ RxSwift æºç å¯ä»¥å‘ç°ï¼Œäº‹ä»¶ Event çš„å®šä¹‰å¦‚ä¸‹ï¼š public enum Event { /// Next element is produced. case next(Element) /// Sequence terminated with an error. case error(Swift.Error) /// Sequence completed successfully. case completed } å¯ä»¥çœ‹åˆ° Event å°±æ˜¯ä¸€ä¸ªæšä¸¾ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ª Observable æ˜¯å¯ä»¥å‘å‡º 3 ç§ä¸åŒç±»å‹çš„ Event äº‹ä»¶ï¼š nextï¼šnext äº‹ä»¶å°±æ˜¯é‚£ä¸ªå¯ä»¥æºå¸¦æ•°æ® çš„äº‹ä»¶ï¼Œå¯ä»¥è¯´å®ƒå°±æ˜¯ä¸€ä¸ªâ€œæœ€æ­£å¸¸â€çš„äº‹ä»¶ã€‚ å‚è€ƒæ–‡ç«  åŸæ–‡å‡ºè‡ªï¼šwww.hangge.com è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥ï¼šhttps://www.hangge.com/blog/cache/detail_1922.html RxSwiftä¸­æ–‡æ–‡æ¡£ "},"pages/RxSwiftç³»åˆ—/02_Observable_è®¢é˜…_äº‹ä»¶ç›‘å¬_è®¢é˜…é”€æ¯.html":{"url":"pages/RxSwiftç³»åˆ—/02_Observable_è®¢é˜…_äº‹ä»¶ç›‘å¬_è®¢é˜…é”€æ¯.html","title":"2.Observable - è®¢é˜…ã€äº‹ä»¶ç›‘å¬ã€è®¢é˜…é”€æ¯","keywords":"","body":"2.Observable - è®¢é˜…ã€äº‹ä»¶ç›‘å¬ã€è®¢é˜…é”€æ¯ å‚è€ƒæ–‡ç«  Swift - RxSwiftçš„ä½¿ç”¨è¯¦è§£1ï¼ˆåŸºæœ¬ä»‹ç»ã€å®‰è£…é…ç½®ï¼‰ RxSwiftä¸­æ–‡æ–‡æ¡£ "},"pages/RxSwiftç³»åˆ—/03_Observer_è§‚å¯Ÿè€….html":{"url":"pages/RxSwiftç³»åˆ—/03_Observer_è§‚å¯Ÿè€….html","title":"3.Observer - è§‚å¯Ÿè€…","keywords":"","body":"3.Observer - è§‚å¯Ÿè€… å‚è€ƒæ–‡ç«  Swift - RxSwiftçš„ä½¿ç”¨è¯¦è§£1ï¼ˆåŸºæœ¬ä»‹ç»ã€å®‰è£…é…ç½®ï¼‰ RxSwiftä¸­æ–‡æ–‡æ¡£ "},"pages/RxSwiftç³»åˆ—/04_Observer_è‡ªå®šä¹‰å¯ç»‘å®šå±æ€§.html":{"url":"pages/RxSwiftç³»åˆ—/04_Observer_è‡ªå®šä¹‰å¯ç»‘å®šå±æ€§.html","title":"4.Observer - è‡ªå®šä¹‰å¯ç»‘å®šå±æ€§","keywords":"","body":"4.Observer - è‡ªå®šä¹‰å¯ç»‘å®šå±æ€§ "},"pages/RxSwiftç³»åˆ—/05_Subjectsã€Variables.html":{"url":"pages/RxSwiftç³»åˆ—/05_Subjectsã€Variables.html","title":"5.Subjectsã€Variables","keywords":"","body":"5.Subjectsã€Variables "},"pages/RxSwiftç³»åˆ—/06_å˜æ¢æ“ä½œç¬¦_buffer_map_flatMap_scanç­‰.html":{"url":"pages/RxSwiftç³»åˆ—/06_å˜æ¢æ“ä½œç¬¦_buffer_map_flatMap_scanç­‰.html","title":"6.å˜æ¢æ“ä½œç¬¦ï¼šbufferã€mapã€flatMapã€scanç­‰","keywords":"","body":"6.å˜æ¢æ“ä½œç¬¦ï¼šbufferã€mapã€flatMapã€scanç­‰ å‚è€ƒæ–‡ç«  ä¸ºä»€ä¹ˆRxSwiftä¹Ÿéœ€è¦flatMap "},"pages/RxSwiftç³»åˆ—/07_è¿‡æ»¤æ“ä½œç¬¦_filter_take_skipç­‰.html":{"url":"pages/RxSwiftç³»åˆ—/07_è¿‡æ»¤æ“ä½œç¬¦_filter_take_skipç­‰.html","title":"7.è¿‡æ»¤æ“ä½œç¬¦ï¼šfilterã€takeã€skipç­‰","keywords":"","body":"7.è¿‡æ»¤æ“ä½œç¬¦ï¼šfilterã€takeã€skipç­‰ å‚è€ƒæ–‡ç«  RxSwift æ“ä½œç¬¦ "},"pages/RxSwiftç³»åˆ—/08_æ¡ä»¶å’Œå¸ƒå°”æ“ä½œç¬¦_amb_takeWhile_skipWhileç­‰.html":{"url":"pages/RxSwiftç³»åˆ—/08_æ¡ä»¶å’Œå¸ƒå°”æ“ä½œç¬¦_amb_takeWhile_skipWhileç­‰.html","title":"8.æ¡ä»¶å’Œå¸ƒå°”æ“ä½œç¬¦ï¼šambã€takeWhileã€skipWhileç­‰","keywords":"","body":"8.æ¡ä»¶å’Œå¸ƒå°”æ“ä½œç¬¦ï¼šambã€takeWhileã€skipWhileç­‰ "},"pages/RxSwiftç³»åˆ—/09_ç»“åˆæ“ä½œç¬¦_startWith_merge_zipç­‰.html":{"url":"pages/RxSwiftç³»åˆ—/09_ç»“åˆæ“ä½œç¬¦_startWith_merge_zipç­‰.html","title":"9.ç»“åˆæ“ä½œç¬¦ï¼šstartWithã€mergeã€zipç­‰","keywords":"","body":"9.ç»“åˆæ“ä½œç¬¦ï¼šstartWithã€mergeã€zipç­‰ "},"pages/RxSwiftç³»åˆ—/10_ç®—æ•°_èšåˆæ“ä½œç¬¦_toArray_reduce_concat.html":{"url":"pages/RxSwiftç³»åˆ—/10_ç®—æ•°_èšåˆæ“ä½œç¬¦_toArray_reduce_concat.html","title":"10.ç®—æ•°&èšåˆæ“ä½œç¬¦ï¼štoArrayã€reduceã€concat","keywords":"","body":"10.ç®—æ•°&èšåˆæ“ä½œç¬¦ï¼štoArrayã€reduceã€concat "},"pages/RxSwiftç³»åˆ—/11_è¿æ¥æ“ä½œç¬¦_connect_publish_replay_multicast.html":{"url":"pages/RxSwiftç³»åˆ—/11_è¿æ¥æ“ä½œç¬¦_connect_publish_replay_multicast.html","title":"11.è¿æ¥æ“ä½œç¬¦ï¼šconnectã€publishã€replayã€multicast","keywords":"","body":"11.è¿æ¥æ“ä½œç¬¦ï¼šconnectã€publishã€replayã€multicast "},"pages/RxSwiftç³»åˆ—/12_å…¶ä»–æ“ä½œç¬¦_delay_materialize_timeoutç­‰.html":{"url":"pages/RxSwiftç³»åˆ—/12_å…¶ä»–æ“ä½œç¬¦_delay_materialize_timeoutç­‰.html","title":"12.å…¶ä»–æ“ä½œç¬¦ï¼šdelayã€materializeã€timeoutç­‰","keywords":"","body":"12.å…¶ä»–æ“ä½œç¬¦ï¼šdelayã€materializeã€timeoutç­‰ "},"pages/RxSwiftç³»åˆ—/13_é”™è¯¯å¤„ç†æ“ä½œ.html":{"url":"pages/RxSwiftç³»åˆ—/13_é”™è¯¯å¤„ç†æ“ä½œ.html","title":"13.é”™è¯¯å¤„ç†æ“ä½œ","keywords":"","body":"13.é”™è¯¯å¤„ç†æ“ä½œ "},"pages/RxSwiftç³»åˆ—/14_è°ƒè¯•æ“ä½œ.html":{"url":"pages/RxSwiftç³»åˆ—/14_è°ƒè¯•æ“ä½œ.html","title":"14.è°ƒè¯•æ“ä½œ","keywords":"","body":"14.è°ƒè¯•æ“ä½œ "},"pages/RxSwiftç³»åˆ—/15_ç‰¹å¾åºåˆ—1_Single_Completable_Maybe.html":{"url":"pages/RxSwiftç³»åˆ—/15_ç‰¹å¾åºåˆ—1_Single_Completable_Maybe.html","title":"15.ç‰¹å¾åºåˆ—1ï¼šSingleã€Completableã€Maybe","keywords":"","body":"15.ç‰¹å¾åºåˆ—1ï¼šSingleã€Completableã€Maybe "},"pages/RxSwiftç³»åˆ—/16_ç‰¹å¾åºåˆ—2_Driver.html":{"url":"pages/RxSwiftç³»åˆ—/16_ç‰¹å¾åºåˆ—2_Driver.html","title":"16.ç‰¹å¾åºåˆ—2ï¼šDriver","keywords":"","body":"16.ç‰¹å¾åºåˆ—2ï¼šDriver "},"pages/RxSwiftç³»åˆ—/17_ç‰¹å¾åºåˆ—3_ControlProperty_ControlEvent.html":{"url":"pages/RxSwiftç³»åˆ—/17_ç‰¹å¾åºåˆ—3_ControlProperty_ControlEvent.html","title":"17.ç‰¹å¾åºåˆ—3ï¼šControlPropertyã€ControlEvent","keywords":"","body":"17.ç‰¹å¾åºåˆ—3ï¼šControlPropertyã€ControlEvent "},"pages/RxSwiftç³»åˆ—/18_è°ƒåº¦å™¨_subscribeOn_observeOn.html":{"url":"pages/RxSwiftç³»åˆ—/18_è°ƒåº¦å™¨_subscribeOn_observeOn.html","title":"18.è°ƒåº¦å™¨ã€subscribeOnã€observeOn","keywords":"","body":"18.è°ƒåº¦å™¨ã€subscribeOnã€observeOn "},"pages/RxSwiftç³»åˆ—/19_UIæ§ä»¶æ‰©å±•1_UILabel.html":{"url":"pages/RxSwiftç³»åˆ—/19_UIæ§ä»¶æ‰©å±•1_UILabel.html","title":"19.UIæ§ä»¶æ‰©å±•1ï¼šUILabel","keywords":"","body":"19.UIæ§ä»¶æ‰©å±•1ï¼šUILabel "},"pages/RxSwiftç³»åˆ—/20_UIæ§ä»¶æ‰©å±•2_UITextField_UITextView.html":{"url":"pages/RxSwiftç³»åˆ—/20_UIæ§ä»¶æ‰©å±•2_UITextField_UITextView.html","title":"20.UIæ§ä»¶æ‰©å±•2ï¼šUITextFieldã€UITextView","keywords":"","body":"20.UIæ§ä»¶æ‰©å±•2ï¼šUITextFieldã€UITextView "},"pages/RxSwiftç³»åˆ—/21_UIæ§ä»¶æ‰©å±•3_UIButton_UIBarButtonItem.html":{"url":"pages/RxSwiftç³»åˆ—/21_UIæ§ä»¶æ‰©å±•3_UIButton_UIBarButtonItem.html","title":"21.UIæ§ä»¶æ‰©å±•3ï¼šUIButtonã€UIBarButtonItem","keywords":"","body":"21.UIæ§ä»¶æ‰©å±•3ï¼šUIButtonã€UIBarButtonItem "},"pages/RxSwiftç³»åˆ—/22_UIæ§ä»¶æ‰©å±•4_UISwitch_UISegmentedControl.html":{"url":"pages/RxSwiftç³»åˆ—/22_UIæ§ä»¶æ‰©å±•4_UISwitch_UISegmentedControl.html","title":"22.UIæ§ä»¶æ‰©å±•4ï¼šUISwitchã€UISegmentedControl","keywords":"","body":"22.UIæ§ä»¶æ‰©å±•4ï¼šUISwitchã€UISegmentedControl "},"pages/RxSwiftç³»åˆ—/23_UIæ§ä»¶æ‰©å±•5_UIActivityIndicatorView_UIApplication.html":{"url":"pages/RxSwiftç³»åˆ—/23_UIæ§ä»¶æ‰©å±•5_UIActivityIndicatorView_UIApplication.html","title":"23.UIæ§ä»¶æ‰©å±•5ï¼šUIActivityIndicatorViewã€UIApplication","keywords":"","body":"23.UIæ§ä»¶æ‰©å±•5ï¼šUIActivityIndicatorViewã€UIApplication "},"pages/RxSwiftç³»åˆ—/24_UIæ§ä»¶æ‰©å±•6_UISlider_UIStepper.html":{"url":"pages/RxSwiftç³»åˆ—/24_UIæ§ä»¶æ‰©å±•6_UISlider_UIStepper.html","title":"24.UIæ§ä»¶æ‰©å±•6ï¼šUISliderã€UIStepper","keywords":"","body":"24.UIæ§ä»¶æ‰©å±•6ï¼šUISliderã€UIStepper "},"pages/RxSwiftç³»åˆ—/25_åŒå‘ç»‘å®š_<->.html":{"url":"pages/RxSwiftç³»åˆ—/25_åŒå‘ç»‘å®š_<->.html","title":"25.åŒå‘ç»‘å®šï¼š<->","keywords":"","body":"25.åŒå‘ç»‘å®šï¼š "},"pages/RxSwiftç³»åˆ—/26_UIæ§ä»¶æ‰©å±•7_UIGestureRecognizer.html":{"url":"pages/RxSwiftç³»åˆ—/26_UIæ§ä»¶æ‰©å±•7_UIGestureRecognizer.html","title":"26.UIæ§ä»¶æ‰©å±•7ï¼šUIGestureRecognizer","keywords":"","body":"26.UIæ§ä»¶æ‰©å±•7ï¼šUIGestureRecognizer "},"pages/RxSwiftç³»åˆ—/27_UIæ§ä»¶æ‰©å±•8_UIDatePicker.html":{"url":"pages/RxSwiftç³»åˆ—/27_UIæ§ä»¶æ‰©å±•8_UIDatePicker.html","title":"27.UIæ§ä»¶æ‰©å±•8ï¼šUIDatePicker","keywords":"","body":"27.UIæ§ä»¶æ‰©å±•8ï¼šUIDatePicker "},"pages/RxSwiftç³»åˆ—/28_UITableViewçš„ä½¿ç”¨1_åŸºæœ¬ç”¨æ³•.html":{"url":"pages/RxSwiftç³»åˆ—/28_UITableViewçš„ä½¿ç”¨1_åŸºæœ¬ç”¨æ³•.html","title":"28.UITableViewçš„ä½¿ç”¨1ï¼šåŸºæœ¬ç”¨æ³•","keywords":"","body":"28.UITableViewçš„ä½¿ç”¨1ï¼šåŸºæœ¬ç”¨æ³• "},"pages/RxSwiftç³»åˆ—/29_UITableViewçš„ä½¿ç”¨2_RxDataSources.html":{"url":"pages/RxSwiftç³»åˆ—/29_UITableViewçš„ä½¿ç”¨2_RxDataSources.html","title":"29.UITableViewçš„ä½¿ç”¨2ï¼šRxDataSources","keywords":"","body":"29.UITableViewçš„ä½¿ç”¨2ï¼šRxDataSources "},"pages/RxSwiftç³»åˆ—/30_UITableViewçš„ä½¿ç”¨3_åˆ·æ–°è¡¨æ ¼æ•°æ®.html":{"url":"pages/RxSwiftç³»åˆ—/30_UITableViewçš„ä½¿ç”¨3_åˆ·æ–°è¡¨æ ¼æ•°æ®.html","title":"30.UITableViewçš„ä½¿ç”¨3ï¼šåˆ·æ–°è¡¨æ ¼æ•°æ®","keywords":"","body":"30.UITableViewçš„ä½¿ç”¨3ï¼šåˆ·æ–°è¡¨æ ¼æ•°æ® "},"pages/RxSwiftç³»åˆ—/31_UITableViewçš„ä½¿ç”¨5_å¯ç¼–è¾‘è¡¨æ ¼.html":{"url":"pages/RxSwiftç³»åˆ—/31_UITableViewçš„ä½¿ç”¨5_å¯ç¼–è¾‘è¡¨æ ¼.html","title":"31.UITableViewçš„ä½¿ç”¨5ï¼šå¯ç¼–è¾‘è¡¨æ ¼","keywords":"","body":"31.UITableViewçš„ä½¿ç”¨5ï¼šå¯ç¼–è¾‘è¡¨æ ¼ "},"pages/RxSwiftç³»åˆ—/32_UITableViewçš„ä½¿ç”¨6_ä¸åŒç±»å‹çš„å•å…ƒæ ¼æ··ç”¨.html":{"url":"pages/RxSwiftç³»åˆ—/32_UITableViewçš„ä½¿ç”¨6_ä¸åŒç±»å‹çš„å•å…ƒæ ¼æ··ç”¨.html","title":"32.UITableViewçš„ä½¿ç”¨6ï¼šä¸åŒç±»å‹çš„å•å…ƒæ ¼æ··ç”¨","keywords":"","body":"32.UITableViewçš„ä½¿ç”¨6ï¼šä¸åŒç±»å‹çš„å•å…ƒæ ¼æ··ç”¨ "},"pages/RxSwiftç³»åˆ—/33_UITableViewçš„ä½¿ç”¨7_æ ·å¼ä¿®æ”¹.html":{"url":"pages/RxSwiftç³»åˆ—/33_UITableViewçš„ä½¿ç”¨7_æ ·å¼ä¿®æ”¹.html","title":"33.UITableViewçš„ä½¿ç”¨7ï¼šæ ·å¼ä¿®æ”¹","keywords":"","body":"33.UITableViewçš„ä½¿ç”¨7ï¼šæ ·å¼ä¿®æ”¹ "},"pages/RxSwiftç³»åˆ—/34_UICollectionViewçš„ä½¿ç”¨1_åŸºæœ¬ç”¨æ³•.html":{"url":"pages/RxSwiftç³»åˆ—/34_UICollectionViewçš„ä½¿ç”¨1_åŸºæœ¬ç”¨æ³•.html","title":"34.UICollectionViewçš„ä½¿ç”¨1ï¼šåŸºæœ¬ç”¨æ³•","keywords":"","body":"34.UICollectionViewçš„ä½¿ç”¨1ï¼šåŸºæœ¬ç”¨æ³• "},"pages/RxSwiftç³»åˆ—/35_UICollectionViewçš„ä½¿ç”¨2_RxDataSources.html":{"url":"pages/RxSwiftç³»åˆ—/35_UICollectionViewçš„ä½¿ç”¨2_RxDataSources.html","title":"35.UICollectionViewçš„ä½¿ç”¨2ï¼šRxDataSources","keywords":"","body":"35.UICollectionViewçš„ä½¿ç”¨2ï¼šRxDataSources "},"pages/RxSwiftç³»åˆ—/36_UICollectionViewçš„ä½¿ç”¨3_åˆ·æ–°é›†åˆæ•°æ®.html":{"url":"pages/RxSwiftç³»åˆ—/36_UICollectionViewçš„ä½¿ç”¨3_åˆ·æ–°é›†åˆæ•°æ®.html","title":"36.UICollectionViewçš„ä½¿ç”¨3ï¼šåˆ·æ–°é›†åˆæ•°æ®","keywords":"","body":"36.UICollectionViewçš„ä½¿ç”¨3ï¼šåˆ·æ–°é›†åˆæ•°æ® "},"pages/RxSwiftç³»åˆ—/37_UICollectionViewçš„ä½¿ç”¨4_æ ·å¼ä¿®æ”¹.html":{"url":"pages/RxSwiftç³»åˆ—/37_UICollectionViewçš„ä½¿ç”¨4_æ ·å¼ä¿®æ”¹.html","title":"37.UICollectionViewçš„ä½¿ç”¨4ï¼šæ ·å¼ä¿®æ”¹","keywords":"","body":"37.UICollectionViewçš„ä½¿ç”¨4ï¼šæ ·å¼ä¿®æ”¹ "},"pages/RxSwiftç³»åˆ—/38_UIPickerViewçš„ä½¿ç”¨.html":{"url":"pages/RxSwiftç³»åˆ—/38_UIPickerViewçš„ä½¿ç”¨.html","title":"38.UIPickerViewçš„ä½¿ç”¨","keywords":"","body":"38.UIPickerViewçš„ä½¿ç”¨ "},"pages/RxSwiftç³»åˆ—/39_URLSessionçš„ä½¿ç”¨1_è¯·æ±‚æ•°æ®.html":{"url":"pages/RxSwiftç³»åˆ—/39_URLSessionçš„ä½¿ç”¨1_è¯·æ±‚æ•°æ®.html","title":"39.URLSessionçš„ä½¿ç”¨1ï¼šè¯·æ±‚æ•°æ®","keywords":"","body":"39.URLSessionçš„ä½¿ç”¨1ï¼šè¯·æ±‚æ•°æ® "},"pages/RxSwiftç³»åˆ—/40_URLSessionçš„ä½¿ç”¨2_ç»“æœå¤„ç†_æ¨¡å‹è½¬æ¢.html":{"url":"pages/RxSwiftç³»åˆ—/40_URLSessionçš„ä½¿ç”¨2_ç»“æœå¤„ç†_æ¨¡å‹è½¬æ¢.html","title":"40.URLSessionçš„ä½¿ç”¨2ï¼šç»“æœå¤„ç†ã€æ¨¡å‹è½¬æ¢","keywords":"","body":"40.URLSessionçš„ä½¿ç”¨2ï¼šç»“æœå¤„ç†ã€æ¨¡å‹è½¬æ¢ "},"pages/RxSwiftç³»åˆ—/41_ç»“åˆRxAlamofireä½¿ç”¨1_æ•°æ®è¯·æ±‚.html":{"url":"pages/RxSwiftç³»åˆ—/41_ç»“åˆRxAlamofireä½¿ç”¨1_æ•°æ®è¯·æ±‚.html","title":"41.ç»“åˆRxAlamofireä½¿ç”¨1ï¼šæ•°æ®è¯·æ±‚","keywords":"","body":"41.ç»“åˆRxAlamofireä½¿ç”¨1ï¼šæ•°æ®è¯·æ±‚ "},"pages/RxSwiftç³»åˆ—/42_ç»“åˆRxAlamofireä½¿ç”¨2_ç»“æœå¤„ç†_æ¨¡å‹è½¬æ¢.html":{"url":"pages/RxSwiftç³»åˆ—/42_ç»“åˆRxAlamofireä½¿ç”¨2_ç»“æœå¤„ç†_æ¨¡å‹è½¬æ¢.html","title":"42.ç»“åˆRxAlamofireä½¿ç”¨2ï¼šç»“æœå¤„ç†ã€æ¨¡å‹è½¬æ¢","keywords":"","body":"42.ç»“åˆRxAlamofireä½¿ç”¨2ï¼šç»“æœå¤„ç†ã€æ¨¡å‹è½¬æ¢ "},"pages/RxSwiftç³»åˆ—/43_ç»“åˆRxAlamofireä½¿ç”¨3_æ–‡ä»¶ä¸Šä¼ .html":{"url":"pages/RxSwiftç³»åˆ—/43_ç»“åˆRxAlamofireä½¿ç”¨3_æ–‡ä»¶ä¸Šä¼ .html","title":"43.ç»“åˆRxAlamofireä½¿ç”¨3ï¼šæ–‡ä»¶ä¸Šä¼ ","keywords":"","body":"43.ç»“åˆRxAlamofireä½¿ç”¨3ï¼šæ–‡ä»¶ä¸Šä¼  "},"pages/RxSwiftç³»åˆ—/44_ç»“åˆRxAlamofireä½¿ç”¨4_æ–‡ä»¶ä¸‹è½½.html":{"url":"pages/RxSwiftç³»åˆ—/44_ç»“åˆRxAlamofireä½¿ç”¨4_æ–‡ä»¶ä¸‹è½½.html","title":"44.ç»“åˆRxAlamofireä½¿ç”¨4ï¼šæ–‡ä»¶ä¸‹è½½","keywords":"","body":"44.ç»“åˆRxAlamofireä½¿ç”¨4ï¼šæ–‡ä»¶ä¸‹è½½ "},"pages/RxSwiftç³»åˆ—/45_ç»“åˆMoyaä½¿ç”¨1_æ•°æ®è¯·æ±‚.html":{"url":"pages/RxSwiftç³»åˆ—/45_ç»“åˆMoyaä½¿ç”¨1_æ•°æ®è¯·æ±‚.html","title":"45.ç»“åˆMoyaä½¿ç”¨1ï¼šæ•°æ®è¯·æ±‚","keywords":"","body":"45.ç»“åˆMoyaä½¿ç”¨1ï¼šæ•°æ®è¯·æ±‚ "},"pages/RxSwiftç³»åˆ—/46_ç»“åˆMoyaä½¿ç”¨2_ç»“æœå¤„ç†_æ¨¡å‹è½¬æ¢.html":{"url":"pages/RxSwiftç³»åˆ—/46_ç»“åˆMoyaä½¿ç”¨2_ç»“æœå¤„ç†_æ¨¡å‹è½¬æ¢.html","title":"46.ç»“åˆMoyaä½¿ç”¨2ï¼šç»“æœå¤„ç†ã€æ¨¡å‹è½¬æ¢","keywords":"","body":"46.ç»“åˆMoyaä½¿ç”¨2ï¼šç»“æœå¤„ç†ã€æ¨¡å‹è½¬æ¢ "},"pages/RxSwiftç³»åˆ—/47_MVVMæ¶æ„æ¼”ç¤º2_ä½¿ç”¨Observableæ ·ä¾‹.html":{"url":"pages/RxSwiftç³»åˆ—/47_MVVMæ¶æ„æ¼”ç¤º2_ä½¿ç”¨Observableæ ·ä¾‹.html","title":"47.MVVMæ¶æ„æ¼”ç¤º2ï¼šä½¿ç”¨Observableæ ·ä¾‹","keywords":"","body":"47.MVVMæ¶æ„æ¼”ç¤º2ï¼šä½¿ç”¨Observableæ ·ä¾‹ "},"pages/RxSwiftç³»åˆ—/48_MVVMæ¶æ„æ¼”ç¤º3_ä½¿ç”¨Driveræ ·ä¾‹.html":{"url":"pages/RxSwiftç³»åˆ—/48_MVVMæ¶æ„æ¼”ç¤º3_ä½¿ç”¨Driveræ ·ä¾‹.html","title":"48.MVVMæ¶æ„æ¼”ç¤º3ï¼šä½¿ç”¨Driveræ ·ä¾‹","keywords":"","body":"48.MVVMæ¶æ„æ¼”ç¤º3ï¼šä½¿ç”¨Driveræ ·ä¾‹ "},"pages/RxSwiftç³»åˆ—/49_ä¸€ä¸ªç”¨æˆ·æ³¨å†Œæ ·ä¾‹1_åŸºæœ¬åŠŸèƒ½å®ç°.html":{"url":"pages/RxSwiftç³»åˆ—/49_ä¸€ä¸ªç”¨æˆ·æ³¨å†Œæ ·ä¾‹1_åŸºæœ¬åŠŸèƒ½å®ç°.html","title":"49.ä¸€ä¸ªç”¨æˆ·æ³¨å†Œæ ·ä¾‹1ï¼šåŸºæœ¬åŠŸèƒ½å®ç°","keywords":"","body":"49.ä¸€ä¸ªç”¨æˆ·æ³¨å†Œæ ·ä¾‹1ï¼šåŸºæœ¬åŠŸèƒ½å®ç° "},"pages/RxSwiftç³»åˆ—/50_ç»“åˆMJRefreshä½¿ç”¨1_ä¸‹æ‹‰åˆ·æ–°.html":{"url":"pages/RxSwiftç³»åˆ—/50_ç»“åˆMJRefreshä½¿ç”¨1_ä¸‹æ‹‰åˆ·æ–°.html","title":"50.ç»“åˆMJRefreshä½¿ç”¨1ï¼šä¸‹æ‹‰åˆ·æ–°","keywords":"","body":"50.ç»“åˆMJRefreshä½¿ç”¨1ï¼šä¸‹æ‹‰åˆ·æ–° "},"pages/RxSwiftç³»åˆ—/51_DelegateProxyæ ·ä¾‹1_è·å–åœ°ç†å®šä½ä¿¡æ¯.html":{"url":"pages/RxSwiftç³»åˆ—/51_DelegateProxyæ ·ä¾‹1_è·å–åœ°ç†å®šä½ä¿¡æ¯.html","title":"51.DelegateProxyæ ·ä¾‹1ï¼šè·å–åœ°ç†å®šä½ä¿¡æ¯","keywords":"","body":"51.DelegateProxyæ ·ä¾‹1ï¼šè·å–åœ°ç†å®šä½ä¿¡æ¯ "},"pages/RxSwiftç³»åˆ—/52_DelegateProxyæ ·ä¾‹2_å›¾ç‰‡é€‰æ‹©åŠŸèƒ½.html":{"url":"pages/RxSwiftç³»åˆ—/52_DelegateProxyæ ·ä¾‹2_å›¾ç‰‡é€‰æ‹©åŠŸèƒ½.html","title":"52.DelegateProxyæ ·ä¾‹2ï¼šå›¾ç‰‡é€‰æ‹©åŠŸèƒ½","keywords":"","body":"52.DelegateProxyæ ·ä¾‹2ï¼šå›¾ç‰‡é€‰æ‹©åŠŸèƒ½ "},"pages/RxSwiftç³»åˆ—/53_DelegateProxyæ ·ä¾‹3_åº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„çŠ¶æ€å˜åŒ–.html":{"url":"pages/RxSwiftç³»åˆ—/53_DelegateProxyæ ·ä¾‹3_åº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„çŠ¶æ€å˜åŒ–.html","title":"53.DelegateProxyæ ·ä¾‹3ï¼šåº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„çŠ¶æ€å˜åŒ–","keywords":"","body":"53.DelegateProxyæ ·ä¾‹3ï¼šåº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„çŠ¶æ€å˜åŒ– "},"pages/RxSwiftç³»åˆ—/54_sendMessageå’ŒmethodInvokedçš„åŒºåˆ«.html":{"url":"pages/RxSwiftç³»åˆ—/54_sendMessageå’ŒmethodInvokedçš„åŒºåˆ«.html","title":"54.sendMessageå’ŒmethodInvokedçš„åŒºåˆ«","keywords":"","body":"54.sendMessageå’ŒmethodInvokedçš„åŒºåˆ« "},"pages/RxSwiftç³»åˆ—/55_è®¢é˜…UITableViewCellé‡Œçš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶.html":{"url":"pages/RxSwiftç³»åˆ—/55_è®¢é˜…UITableViewCellé‡Œçš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶.html","title":"55.è®¢é˜…UITableViewCellé‡Œçš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶","keywords":"","body":"55.è®¢é˜…UITableViewCellé‡Œçš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶ "},"pages/RxSwiftç³»åˆ—/56_é€šçŸ¥NotificationCenterçš„ä½¿ç”¨.html":{"url":"pages/RxSwiftç³»åˆ—/56_é€šçŸ¥NotificationCenterçš„ä½¿ç”¨.html","title":"56.é€šçŸ¥NotificationCenterçš„ä½¿ç”¨","keywords":"","body":"56.é€šçŸ¥NotificationCenterçš„ä½¿ç”¨ "},"pages/RxSwiftç³»åˆ—/57_é”®å€¼è§‚å¯ŸKVOçš„ä½¿ç”¨.html":{"url":"pages/RxSwiftç³»åˆ—/57_é”®å€¼è§‚å¯ŸKVOçš„ä½¿ç”¨.html","title":"57.é”®å€¼è§‚å¯ŸKVOçš„ä½¿ç”¨","keywords":"","body":"57.é”®å€¼è§‚å¯ŸKVOçš„ä½¿ç”¨ "},"pages/RxSwiftç³»åˆ—/58_è¡¨æ ¼å›¾ç‰‡åŠ è½½ä¼˜åŒ–.html":{"url":"pages/RxSwiftç³»åˆ—/58_è¡¨æ ¼å›¾ç‰‡åŠ è½½ä¼˜åŒ–.html","title":"58.è¡¨æ ¼å›¾ç‰‡åŠ è½½ä¼˜åŒ–","keywords":"","body":"58.è¡¨æ ¼å›¾ç‰‡åŠ è½½ä¼˜åŒ– "},"pages/RxSwiftç³»åˆ—/59_æ£€æµ‹å½“å‰å€¼ä¸åˆå§‹å€¼æ˜¯å¦ç›¸åŒ_isEqualOriginValue.html":{"url":"pages/RxSwiftç³»åˆ—/59_æ£€æµ‹å½“å‰å€¼ä¸åˆå§‹å€¼æ˜¯å¦ç›¸åŒ_isEqualOriginValue.html","title":"59.æ£€æµ‹å½“å‰å€¼ä¸åˆå§‹å€¼æ˜¯å¦ç›¸åŒï¼šisEqualOriginValue","keywords":"","body":"59.æ£€æµ‹å½“å‰å€¼ä¸åˆå§‹å€¼æ˜¯å¦ç›¸åŒï¼šisEqualOriginValue "},"pages/RxSwiftç³»åˆ—/60_é‡å¤æ‰§è¡ŒæŸä¸ªæ“ä½œåºåˆ—_repeatWhen.html":{"url":"pages/RxSwiftç³»åˆ—/60_é‡å¤æ‰§è¡ŒæŸä¸ªæ“ä½œåºåˆ—_repeatWhen.html","title":"60.é‡å¤æ‰§è¡ŒæŸä¸ªæ“ä½œåºåˆ—ï¼šrepeatWhen","keywords":"","body":"60.é‡å¤æ‰§è¡ŒæŸä¸ªæ“ä½œåºåˆ—ï¼šrepeatWhen "},"pages/RxSwiftç³»åˆ—/61_ç›‘å¬æ»šåŠ¨æ¡æ»šåŠ¨åˆ°åº•éƒ¨çš„è¡Œä¸º_reachedBottom.html":{"url":"pages/RxSwiftç³»åˆ—/61_ç›‘å¬æ»šåŠ¨æ¡æ»šåŠ¨åˆ°åº•éƒ¨çš„è¡Œä¸º_reachedBottom.html","title":"61.ç›‘å¬æ»šåŠ¨æ¡æ»šåŠ¨åˆ°åº•éƒ¨çš„è¡Œä¸ºï¼šreachedBottom","keywords":"","body":"61.ç›‘å¬æ»šåŠ¨æ¡æ»šåŠ¨åˆ°åº•éƒ¨çš„è¡Œä¸ºï¼šreachedBottom "},"pages/RxSwiftç³»åˆ—/62_RxFeedbackæ¶æ„1_å®‰è£…é…ç½®ã€åŸºæœ¬ç”¨æ³•.html":{"url":"pages/RxSwiftç³»åˆ—/62_RxFeedbackæ¶æ„1_å®‰è£…é…ç½®ã€åŸºæœ¬ç”¨æ³•.html","title":"62.RxFeedbackæ¶æ„1ï¼šå®‰è£…é…ç½®ã€åŸºæœ¬ç”¨æ³•","keywords":"","body":"62.RxFeedbackæ¶æ„1ï¼šå®‰è£…é…ç½®ã€åŸºæœ¬ç”¨æ³• "},"pages/RxSwiftç³»åˆ—/63_RxFeedbackæ¶æ„2ï¼šä¸€ä¸ªç”¨æˆ·æ³¨å†Œæ ·ä¾‹.html":{"url":"pages/RxSwiftç³»åˆ—/63_RxFeedbackæ¶æ„2ï¼šä¸€ä¸ªç”¨æˆ·æ³¨å†Œæ ·ä¾‹.html","title":"63.RxFeedbackæ¶æ„2ï¼šä¸€ä¸ªç”¨æˆ·æ³¨å†Œæ ·ä¾‹","keywords":"","body":"63.RxFeedbackæ¶æ„2ï¼šä¸€ä¸ªç”¨æˆ·æ³¨å†Œæ ·ä¾‹ "},"pages/RxSwiftç³»åˆ—/64_RxFeedbackæ¶æ„3_GitHubèµ„æºæœç´¢æ ·ä¾‹.html":{"url":"pages/RxSwiftç³»åˆ—/64_RxFeedbackæ¶æ„3_GitHubèµ„æºæœç´¢æ ·ä¾‹.html","title":"64.RxFeedbackæ¶æ„3ï¼šGitHubèµ„æºæœç´¢æ ·ä¾‹","keywords":"","body":"64.RxFeedbackæ¶æ„3ï¼šGitHubèµ„æºæœç´¢æ ·ä¾‹ "},"pages/RxSwiftç³»åˆ—/65_ReactorKitæ¶æ„1_å®‰è£…é…ç½®ã€åŸºæœ¬ç”¨æ³•.html":{"url":"pages/RxSwiftç³»åˆ—/65_ReactorKitæ¶æ„1_å®‰è£…é…ç½®ã€åŸºæœ¬ç”¨æ³•.html","title":"65.ReactorKitæ¶æ„1ï¼šå®‰è£…é…ç½®ã€åŸºæœ¬ç”¨æ³•","keywords":"","body":"65.ReactorKitæ¶æ„1ï¼šå®‰è£…é…ç½®ã€åŸºæœ¬ç”¨æ³• "},"pages/RxSwiftç³»åˆ—/66_ReactorKitæ¶æ„2_ä¸€ä¸ªç”¨æˆ·æ³¨å†Œæ ·ä¾‹.html":{"url":"pages/RxSwiftç³»åˆ—/66_ReactorKitæ¶æ„2_ä¸€ä¸ªç”¨æˆ·æ³¨å†Œæ ·ä¾‹.html","title":"66.ReactorKitæ¶æ„2ï¼šä¸€ä¸ªç”¨æˆ·æ³¨å†Œæ ·ä¾‹","keywords":"","body":"66.ReactorKitæ¶æ„2ï¼šä¸€ä¸ªç”¨æˆ·æ³¨å†Œæ ·ä¾‹ "},"pages/RxSwiftç³»åˆ—/67_ReactorKitæ¶æ„3_GitHubèµ„æºæœç´¢æ ·ä¾‹.html":{"url":"pages/RxSwiftç³»åˆ—/67_ReactorKitæ¶æ„3_GitHubèµ„æºæœç´¢æ ·ä¾‹.html","title":"67.ReactorKitæ¶æ„3ï¼šGitHubèµ„æºæœç´¢æ ·ä¾‹","keywords":"","body":"67.ReactorKitæ¶æ„3ï¼šGitHubèµ„æºæœç´¢æ ·ä¾‹ "},"pages/WebViewç³»åˆ—/01_WebViewä¸iOSåŸç”Ÿçš„äº¤äº’.html":{"url":"pages/WebViewç³»åˆ—/01_WebViewä¸iOSåŸç”Ÿçš„äº¤äº’.html","title":"1.WebViewä¸iOSåŸç”Ÿçš„äº¤äº’","keywords":"","body":"1.WebViewä¸iOSåŸç”Ÿçš„äº¤äº’ ä¸€ã€WKWebViewçš„ä»£ç†æ–¹æ³• 1.1 WKNavigationDelegate è¯¥ä»£ç†æä¾›çš„æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥è¿½è¸ªåŠ è½½è¿‡ç¨‹ï¼ˆé¡µé¢å¼€å§‹åŠ è½½ã€åŠ è½½å®Œæˆã€åŠ è½½å¤±è´¥ï¼‰ã€å†³å®šæ˜¯å¦æ‰§è¡Œè·³è½¬ã€‚ // é¡µé¢å¼€å§‹åŠ è½½æ—¶è°ƒç”¨ optional func webView(_ webView: WKWebView, didStartProvisionalNavigation navigation: WKNavigation!) // å½“å†…å®¹å¼€å§‹è¿”å›æ—¶è°ƒç”¨ optional func webView(_ webView: WKWebView, didCommit navigation: WKNavigation!) // é¡µé¢åŠ è½½å®Œæˆä¹‹åè°ƒç”¨ optional func webView(_ webView: WKWebView, didFinish navigation: WKNavigation!) // é¡µé¢åŠ è½½å¤±è´¥æ—¶è°ƒç”¨ optional func webView(_ webView: WKWebView, didFailProvisionalNavigation navigation: WKNavigation!, withError error: Error) é¡µé¢è·³è½¬çš„ä»£ç†æ–¹æ³•æœ‰ä¸‰ç§ï¼Œåˆ†ä¸ºï¼ˆæ”¶åˆ°è·³è½¬ä¸å†³å®šæ˜¯å¦è·³è½¬ä¸¤ç§ï¼‰ï¼š // æ¥æ”¶åˆ°æœåŠ¡å™¨è·³è½¬è¯·æ±‚ä¹‹åè°ƒç”¨ optional func webView(_ webView: WKWebView, didReceiveServerRedirectForProvisionalNavigation navigation: WKNavigation!) // åœ¨æ”¶åˆ°å“åº”åï¼Œå†³å®šæ˜¯å¦è·³è½¬ optional func webView(_ webView: WKWebView, decidePolicyFor navigationResponse: WKNavigationResponse, decisionHandler: @escaping (WKNavigationResponsePolicy) -> Void) // åœ¨å‘é€è¯·æ±‚ä¹‹å‰ï¼Œå†³å®šæ˜¯å¦è·³è½¬ optional func webView(_ webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -> Void) 1.2 WKUIDelegate optional func webView(_ webView: WKWebView, createWebViewWith configuration: WKWebViewConfiguration, for navigationAction: WKNavigationAction, windowFeatures: WKWindowFeatures) -> WKWebView? ä¸‹é¢ä»£ç†æ–¹æ³•å…¨éƒ½æ˜¯ä¸ç•Œé¢å¼¹å‡ºæç¤ºæ¡†ç›¸å…³çš„ï¼Œé’ˆå¯¹äºwebç•Œé¢çš„ä¸‰ç§æç¤ºæ¡†ï¼ˆè­¦å‘Šæ¡†ã€ç¡®è®¤æ¡†ã€è¾“å…¥æ¡†ï¼‰åˆ†åˆ«å¯¹åº”ä¸‰ç§ä»£ç†æ–¹æ³•ã€‚ä¸‹é¢åªåˆ—ä¸¾äº†è­¦å‘Šæ¡†çš„æ–¹æ³•ã€‚ optional func webView(_ webView: WKWebView, runJavaScriptAlertPanelWithMessage message: String, initiatedByFrame frame: WKFrameInfo, completionHandler: @escaping () -> Void) 1.3 WKScriptMessageHandler WKScriptMessageHandlerå…¶å®å°±æ˜¯ä¸€ä¸ªéµå¾ªçš„åè®®ï¼Œå®ƒèƒ½è®©ç½‘é¡µé€šè¿‡JSæŠŠæ¶ˆæ¯å‘é€ç»™OCã€‚å…¶ä¸­åè®®æ–¹æ³•ã€‚ // ä»webç•Œé¢ä¸­æ¥æ”¶åˆ°ä¸€ä¸ªè„šæœ¬æ—¶è°ƒç”¨ func userContentController(_ userContentController: WKUserContentController, didReceive message: WKScriptMessage) ä»åè®®ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™é‡Œä½¿ç”¨äº†ä¸¤ä¸ªç±»WKUserContentControllerå’ŒWKScriptMessageã€‚WKUserContentControllerå¯ä»¥ç†è§£ä¸ºè°ƒåº¦å™¨ï¼ŒWKScriptMessageåˆ™æ˜¯æºå¸¦çš„æ•°æ®ã€‚ 1.4 WKUserContentController WKUserContentControlleræœ‰ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼Œä¹Ÿæ˜¯å®ƒçš„æ ¸å¿ƒåŠŸèƒ½ã€‚ // jsæ³¨å…¥ï¼Œå³å‘ç½‘é¡µä¸­æ³¨å…¥æˆ‘ä»¬çš„jsæ–¹æ³•ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œå¼€å‘ä¸­è¦æ…ç”¨ã€‚ open func addUserScript(_ userScript: WKUserScript) // æ·»åŠ ä¾›jsè°ƒç”¨ocçš„æ¡¥æ¢ã€‚è¿™é‡Œçš„nameå¯¹åº”WKScriptMessageä¸­çš„nameï¼Œå¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬è®¤ä¸ºå®ƒå°±æ˜¯æ–¹æ³•åã€‚ open func add(_ scriptMessageHandler: WKScriptMessageHandler, name: String) 1.5 WKScriptMessage WKScriptMessageå°±æ˜¯jsé€šçŸ¥ocçš„æ•°æ®ã€‚å…¶ä¸­æœ‰ä¸¤ä¸ªæ ¸å¿ƒå±æ€§ç”¨çš„å¾ˆå¤šã€‚ open var name: String { get } å¯¹åº”func add(_ scriptMessageHandler: WKScriptMessageHandler, name: String)æ·»åŠ çš„nameã€‚ open var body: Any { get } æºå¸¦çš„æ ¸å¿ƒæ•°æ®ã€‚jsè°ƒç”¨æ—¶åªéœ€window.webkit.messageHandlers.#name#.postMessage() è¿™é‡Œçš„nameå°±æ˜¯æˆ‘ä»¬æ·»åŠ çš„nameï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å¾ˆçˆ½ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥å…·ä½“å®ç°ã€‚ äºŒã€è‡ªå®šä¹‰CQWebView class CQWebView: UIView { // å¢åŠ webViewå±æ€§ private lazy var webView: WKWebView = { let conf = WKWebViewConfiguration() conf.preferences.javaScriptEnabled = true conf.selectionGranularity = WKSelectionGranularity.character conf.allowsInlineMediaPlayback = true let webView = WKWebView(frame: .zero, configuration: conf) ... return webView }() } 2.1 å¢åŠ js/ocäº¤äº’æ–¹æ³• class CQWebView: UIView { ... // å¢åŠ jsæ¶ˆæ¯ç›‘å¬ func adddScriptMessageHandler(forName name: String) { webView.configuration.userContentController.add(self, name: name) } // ç§»é™¤jsæ¶ˆæ¯ç›‘å¬ func removeScriptMessageHandler(forName name: String) { webView.configuration.userContentController.removeScriptMessageHandler(forName: name) } // ocæ‰§è¡Œjs func evaluateJavaScript(_ javaScriptString: String, completionHandler: ((Any?, Error?) -> Void)? = nil) { webView.evaluateJavaScript(javaScriptString, completionHandler: completionHandler) } } 2.2 å¢åŠ ä»£ç†å±æ€§ // WebViewä»£ç† @objc protocol CQWebViewDelegate { // æ¥æ”¶ js å‘æ¥çš„æ¶ˆæ¯ @objc optional func webView(_ webView: CQWebView, didReceiveMessage name: String, body: Any) } class CQWebView: UIView { ... weak var delegate: CQWebViewDelegate? } 2.3 å®ç°WKScriptMessageHandler // js å’Œ swift çš„äº¤äº’ extension CQWebView: WKScriptMessageHandler { // æ¥æ”¶ js å‘æ¥çš„æ¶ˆæ¯ func userContentController(_ userContentController: WKUserContentController, didReceive message: WKScriptMessage) { delegate?.webView?(self, didReceiveMessage: message.name, body: message.body) } } ä¸‰ã€JSè°ƒç”¨Swift 2.1 å®Œæ•´html Untitled Document jsè°ƒç”¨swift // jsè°ƒç”¨swift function jsCallSwift(obj) { // å‘ swift å‘é€æ•°æ®ï¼Œè¿™é‡Œçš„â€˜msgBridgeâ€™å°±æ˜¯ swift ä¸­æ·»åŠ çš„æ¶ˆæ¯é€šé“çš„ name window.webkit.messageHandlers.msgBridge.postMessage(obj); } // swiftè°ƒç”¨js function swiftCallJs(msg){ document.getElementById('h').innerText+=msg; } 3.2 å¢åŠ å¯¹jsæ¶ˆæ¯çš„ç›‘å¬ åªéœ€è¦è°ƒç”¨CQWebViewçš„adddScriptMessageHandleræ–¹æ³•ã€‚ class ViewController: UIViewController { // MARK: - Properties private lazy var webView: CQWebView = { let webView = CQWebView(frame: .zero) webView.delegate = self webView.adddScriptMessageHandler(forName: \"msgBridge\") ... return webView }() } 3.2 å®ç°å¯¹jsæ¶ˆæ¯çš„å¤„ç† extension ViewController: CQWebViewDelegate { func webView(_ webView: CQWebView, didReceiveMessage name: String, body: Any) { switch name { case \"msgBridge\": ... break default: break } } } å››ã€Swiftè°ƒç”¨JS 4.1 evaluateJavaScriptæ–¹æ³•ä½¿ç”¨ åœ¨htmlçš„jsä¸­å·²ç»å®šä¹‰äº†swiftCallJsæ–¹æ³•ç­‰å¾…è°ƒç”¨ï¼Œåªéœ€è¦è°ƒç”¨CQWebViewçš„evaluateJavaScriptæ–¹æ³•å³å¯ã€‚ //swift è°ƒ jså‡½æ•° webView.evaluateJavaScript(\"swiftCallJs('\\( dic[\"msg\"] as! String)')\", completionHandler: { (any, error) in if (error != nil) { print(error ?? \"err\") } }) 4.2 WKWebViewåŠ è½½JS NSString *js = @\"\"; // æ ¹æ®JSå­—ç¬¦ä¸²åˆå§‹åŒ–WKUserScriptå¯¹è±¡ WKUserScript *script = [[WKUserScript alloc] initWithSource:js injectionTime:WKUserScriptInjectionTimeAtDocumentEnd forMainFrameOnly:YES]; // æ ¹æ®ç”Ÿæˆçš„WKUserScriptå¯¹è±¡ï¼Œåˆå§‹åŒ–WKWebViewConfiguration WKWebViewConfiguration *config = [[WKWebViewConfiguration alloc] init]; [config.userContentController addUserScript:script]; å‚è€ƒæ–‡ç«  æºç  Safariè°ƒè¯•iOSä¸­çš„JS iOS WKWebView åŠ è½½æœ¬åœ°htmlæ–‡ä»¶ï¼ˆswiftï¼‰ å­¦ä¹ -WebKit(WKScriptMessageHandler) iOSä¸‹OCä¸JSçš„äº¤äº’(WKWebview-MessageHandlerå®ç°) è‡ªå·±åŠ¨æ‰‹æ‰“é€ åŸºäº WKWebView çš„æ··åˆå¼€å‘æ¡†æ¶ï¼ˆäºŒï¼‰â€”â€”js å‘ Native ä¸€å¥è¯ä¼ å€¼å¹¶åå°„å‡º Swift å¯¹è±¡æ‰§è¡ŒæŒ‡å®šå‡½æ•° WkWebKit - javascript on loaded page finds window.webkit is undefined WKWebviewä½¿ç”¨äºŒä¸‰äº‹ "},"pages/WebViewç³»åˆ—/02_DSBridgeçš„ä½¿ç”¨.html":{"url":"pages/WebViewç³»åˆ—/02_DSBridgeçš„ä½¿ç”¨.html","title":"2.DSBridgeçš„ä½¿ç”¨","keywords":"","body":"2.DSBridgeçš„ä½¿ç”¨ å‚è€ƒæ–‡ç«  DSBridgeæ¡†æ¶ä½¿ç”¨è¯´æ˜ ä½¿ç”¨DSBridgeåŒH5äº¤äº’ "},"pages/è®¡ç®—æœºç½‘ç»œåŸç†/ç²¾è®²1.html":{"url":"pages/è®¡ç®—æœºç½‘ç»œåŸç†/ç²¾è®²1.html","title":"1.1.ç²¾è®²1","keywords":"","body":"1.1.ç²¾è®²1 è®¡ç®—æœºç½‘ç»œçš„åŸºæœ¬æ¦‚å¿µ è®¡ç®—æœºç½‘ç»œçš„èµ·æºï¼šè®¡ç®—æœºç½‘ç»œæ˜¯è®¡ç®—æœºæŠ€æœ¯ä¸é€šä¿¡æŠ€æœ¯ç›¸äº’èåˆçš„äº§ç‰©ã€‚ è®¡ç®—æœºç½‘ç»œçš„å®šä¹‰ï¼šäº’è”ã€è‡ªæ²»çš„è®¡ç®—æœºçš„é›†åˆã€‚ äº’è”ï¼štodo è‡ªåˆ¶ï¼štodo äº’è”ç½‘ä¸å› ç‰¹ç½‘ï¼šæ³›æŒ‡ç”±å¤šä¸ªè®¡ç®—æœºç½‘ç»œäº’è”è€Œæˆçš„ç½‘ç»œã€‚ å› ç‰¹ç½‘ï¼šå®ƒæŒ‡å½“å‰å…¨çƒæœ€å¤§çš„ã€åº”ç”¨æœ€å¹¿æ³›çš„è®¡ç®—æœºç½‘ç»œã€‚ ç½‘ç»œåè®®ï¼šç½‘ç»œé€šä¿¡å®ä½“ä¹‹é—´åœ¨æ•°æ®äº¤æ¢è¿‡ç¨‹ä¸­éœ€è¦éµå¾ªçš„è§„åˆ™æˆ–çº¦å®šã€‚ ç½‘ç»œåè®®ä¸‰è¦ç´ ï¼šè¯­æ³•ã€è¯­ä¹‰ã€æ—¶åºã€‚ è¯­æ³•ï¼šå®šä¹‰å®ä½“ä¹‹é—´äº¤æ¢ä¿¡æ¯çš„æ ¼å¼å’Œç»“æ„ã€‚ è¯­ä¹‰ï¼šå®šä¹‰å®ä½“ä¹‹é—´äº¤æ¢ä¿¡æ¯ä¸­çš„æ§åˆ¶ä¿¡æ¯ã€‚ æ—¶åºï¼šå®šä¹‰å®ä½“ä¹‹é—´äº¤æ¢ä¿¡æ¯çš„é¡ºåºä»¥åŠå¦‚ä½•åŒ¹é…æˆ–è€…é€‚åº”å½¼æ­¤çš„é€Ÿåº¦ã€‚ è®¡ç®—æœºç½‘ç»œçš„åŠŸèƒ½ ç¡¬ä»¶èµ„æºå…±äº«ï¼šè®¡ç®—èµ„æºï¼ˆCPUï¼‰ã€å­˜å‚¨èµ„æºã€æ‰“å°æœºä¸æ‰«æä»ªI/Oç­‰ï¼Œä¾‹ï¼šäº‘å­˜å‚¨ã€äº‘è®¡ç®—ã€‚ è½¯ä»¶èµ„æºå…±äº«ï¼šSaaSï¼Œä¾‹ï¼šå¤§å‹åŠå…¬è½¯ä»¶ã€å¤§å‹æ•°æ®åº“ç³»ç»Ÿç­‰ã€‚ ä¿¡æ¯èµ„æºå…±äº«ï¼šä¿¡æ¯æ£€ç´¢ï¼Œæ–°é—»æµè§ˆç­‰ã€‚ è®¡ç®—æœºç½‘ç»œçš„åˆ†ç±» æŒ‰è¦†ç›–èŒƒå›´åˆ†ç±» ä¸ªåŸŸç½‘ï¼šPANï¼Œéšèº«ç©¿æˆ´è®¾å¤‡ã€ä¾¿æºè®¾å¤‡é€šè¿‡æ— çº¿æŠ€æœ¯æ„æˆçš„å°èŒƒå›´ç½‘ç»œï¼Œä¾‹å¦‚ï¼šè“ç‰™è€³æœºå’Œæ‰‹æœºã€‚ å±€åŸŸç½‘ï¼šLANï¼Œé€šå¸¸éƒ¨ç½²åœ¨åŠå…¬å®¤ã€åŠå…¬æ¥¼ã€å‚åŒºã€æ ¡åŒºç­‰ã€‚ åŸåŸŸç½‘ï¼šMANï¼Œè¦†ç›–ä¸€ä¸ªåŸå¸‚èŒƒå›´çš„ç½‘ç»œã€‚ å¹¿åŸŸç½‘ï¼šWANï¼Œè¦†ç›–èŒƒå›´åœ¨å‡ ååˆ°å‡ åƒåƒç±³ï¼Œå¯ä»¥å®ç°å¼‚åœ°åŸåŸŸç½‘çš„äº’è”ã€‚ æŒ‰æ‹“æ‰‘ç»“æ„åˆ†ç±»ï¼šæ˜Ÿå‹ã€æ€»çº¿å‹ã€ç¯å‹ã€ç½‘çŠ¶ã€æ ‘å½¢ã€æ··åˆå‹ã€‚ æŒ‰äº¤æ¢æ–¹å¼åˆ†ç±» æŒ‰ç½‘ç»œç”¨æˆ·å±æ€§ æ‹“æ‰‘ topologyï¼Œæ˜¯ç ”ç©¶å‡ ä½•å›¾å½¢æˆ–ç©ºé—´åœ¨è¿ç»­æ”¹å˜å½¢çŠ¶åè¿˜èƒ½ä¿æŒä¸å˜çš„ä¸€äº›ç‰¹è´¨çš„ä¸€ä¸ªå­¦ç§‘ã€‚å®ƒåªè€ƒè™‘ç‰©ä½“é—´çš„ä½ç½®å…³ç³»è€Œä¸è€ƒè™‘ä»–ä»¬çš„å½¢çŠ¶å’Œå¤§å°ã€‚ æ˜Ÿå‹ åŒ…æ‹¬ä¸€ä¸ªä¸­å¤®ç»“ç‚¹ï¼Œç½‘ç»œä¸­çš„ä¸»æœºé€šè¿‡ç‚¹å¯¹ç‚¹é€šä¿¡é“¾è·¯ä¸ä¸­å¤®ç»“ç‚¹é“¾æ¥ã€‚ ä¼˜ç‚¹ï¼šæ˜“äºç›‘æ§ç®¡ç†ã€æ•…éšœè¯Šæ–­ã€éš”ç¦»ã€‚ ç¼ºç‚¹ï¼šä¸­å¤®ç»“ç‚¹ä¸€æ—¦æ•…éšœï¼Œå…¨ç½‘ç˜«ç—ªã€‚ æ€»çº¿å‹ ç½‘ç»œé‡‡ç”¨ä¸€æ¡å¹¿æ’­ä¿¡é“ä½œä¸ºå…¬å…±ä¼ è¾“ä»‹è´¨ã€‚æ‰€æœ‰ç»“ç‚¹å‡ä¸æ€»çº¿è¿æ¥ï¼Œç»“ç‚¹é—´çš„é€šä¿¡å‡é€šè¿‡å…±äº«çš„æ€»çº¿è¿›è¡Œã€‚ ä¼˜ç‚¹ï¼šç»“æ„ç®€å•ï¼Œç”µç¼†æ•°é‡å°‘ï¼Œæ˜“äºæ‰©å±•ã€‚ ç¼ºç‚¹ï¼šä¸­å¤®ç»“ç‚¹ä¸€æ—¦æ•…éšœï¼Œå…¨ç½‘ç˜«ç—ªã€‚ ç¯å½¢ åˆ©ç”¨é€šä¿¡é“¾è·¯å°†æ‰€æœ‰ç»“ç‚¹è¿æˆä¸€ä¸ªé—­åˆçš„ç¯ã€‚ ä¼˜ç‚¹ï¼šç”µç¼†é•¿åº¦æ¯”è¾ƒçŸ­ï¼Œå¯ä»¥ä½¿ç”¨å…‰çº¤ï¼Œæ˜“äºé¿å…å†²çªã€‚ ç¼ºç‚¹ï¼šæŸç»“ç‚¹æ•…éšœå¼•èµ·å…¨ç½‘ç˜«ç—ªï¼ŒåŠ æ–°ï¼ˆæ’¤å‡ºï¼‰ç»“ç‚¹æ¯”è¾ƒéº»çƒ¦ï¼Œç­‰å¾…æ—¶é—´è¾ƒé•¿ã€‚ ç½‘çŠ¶ ç½‘ç»œä¸­çš„ç»“ç‚¹é€šè¿‡å¤šæ¡é“¾è·¯ä¸ä¸åŒçš„ç»“ç‚¹ç›´æ¥ç›¸è¿æ¥ã€‚ ä¼˜ç‚¹ï¼šç½‘ç»œå¯é æ€§é«˜ï¼Œä¸€æ¡æˆ–å¤šæ¡é“¾è·¯æ•…éšœæ—¶ï¼Œç½‘ç»œä»ç„¶å¯ä»¥è”é€šã€‚ ç¼ºç‚¹ï¼šç½‘ç»œç»“æ„å¤æ‚ï¼Œæˆæœ¬é«˜ã€‚ æ ‘å½¢ å¯ä»¥çœ‹ä½œæ˜¯æ€»çº¿å‹æ‹“æ‰‘æˆ–æ˜Ÿå‹æ‹“æ‰‘ç»“æ„ç½‘ç»œçš„æ‰©å±•ã€‚ ä¼˜ç‚¹ï¼šæ˜“äºæ‰©å±•ï¼Œæ•…éšœæ˜“éš”ç¦»ã€‚ ç¼ºç‚¹ï¼šæ ¹ç»“ç‚¹è¦æ±‚é«˜ã€‚ "},"pages/è®¡ç®—æœºç½‘ç»œåŸç†/ç²¾è®²2.html":{"url":"pages/è®¡ç®—æœºç½‘ç»œåŸç†/ç²¾è®²2.html","title":"1.2.ç²¾è®²2","keywords":"","body":"1.2.ç²¾è®²2 æ•°æ®äº¤æ¢æŠ€æœ¯ todo è®¡ç®—æœºç½‘ç»œæ€§èƒ½ todo è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„ todo "},"pages/è®¡ç®—æœºç½‘ç»œåŸç†/ç²¾è®²3.html":{"url":"pages/è®¡ç®—æœºç½‘ç»œåŸç†/ç²¾è®²3.html","title":"1.3.ç²¾è®²3","keywords":"","body":"1.3.ç²¾è®²3 åŸŸåç³»ç»Ÿï¼ˆDNSï¼‰ æ ¹åŸŸåæœåŠ¡å™¨ é¡¶çº§åŸŸåæœåŠ¡å™¨ æƒå¨åŸŸåæœåŠ¡å™¨ ä¸­é—´åŸŸåæœåŠ¡å™¨ åŸŸåè§£æè¿‡ç¨‹ "},"pages/è®¡ç®—æœºç½‘ç»œåŸç†/ç²¾è®²5.html":{"url":"pages/è®¡ç®—æœºç½‘ç»œåŸç†/ç²¾è®²5.html","title":"1.5.ç²¾è®²5","keywords":"","body":"1.5.ç²¾è®²5 ä¼ è¾“å±‚ ä¼ è¾“å±‚çš„åŸºæœ¬æœåŠ¡ ä¼ è¾“å±‚çš„å¤ç”¨å’Œåˆ†è§£ ç­‰-åœåè®®ä¸æ»‘åŠ¨çª—å£åè®® ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰ ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰ ä¸€ã€ä¼ è¾“å±‚çš„åŸºæœ¬æœåŠ¡ ä¼ è¾“å±‚çš„æ ¸å¿ƒä»»åŠ¡ï¼šåº”ç”¨è¿›ç¨‹ä¹‹é—´æä¾›ç«¯åˆ°ç«¯çš„é€»è¾‘é€šä¿¡æœåŠ¡ã€‚ 1.1 ä¼ è¾“å±‚çš„åŠŸèƒ½ å¯¹åº”ç”¨å±‚æŠ¥æ–‡è¿›è¡Œåˆ†æ®µå’Œé‡ç»„ é¢å‘åº”ç”¨å±‚å®ç°å¤ç”¨å’Œåˆ†è§£ å®ç°ç«¯å¯¹ç«¯çš„æµé‡æ§åˆ¶ æ‹¥å¡æ§åˆ¶ ä¼ è¾“å±‚å¯»å€ å¯¹æŠ¥æ–‡è¿›è¡Œå·®é”™æ£€æµ‹ å®ç°è¿›ç¨‹é—´çš„ç«¯åˆ°ç«¯å¯é æ•°æ®ä¼ è¾“æ§åˆ¶ å©å’åˆ˜æ‹¥å¯»å·®é”™-å¯é  1.2 ä¼ è¾“å±‚å¯»å€ä¸ç«¯å£ TCP/IPä½“ç³»ç»“æ„ç½‘ç»œçš„è§£å†³æ–¹æ³•ï¼šåœ¨ä¼ è¾“å±‚ä½¿ç”¨åè®®ç«¯å£å·ï¼Œé€šå¸¸ç®€ç§°ç«¯å£ï¼ˆportï¼‰ï¼Œåœ¨å…¨ç½‘èŒƒå›´å†…åˆ©ç”¨â€œIPåœ°å€+ç«¯å£å·â€å”¯ä¸€æ ‡è¯†ä¸€ä¸ªé€šä¿¡ç«¯ç‚¹ã€‚ åº”ç”¨å±‚ä¸ä¼ è¾“å±‚é—´æŠ½è±¡çš„åè®®ç«¯å£æ˜¯è½¯ä»¶ç«¯å£ã€‚ ä¼ è¾“å±‚ç«¯å£å·ä¸º16ä½æ•´æ•°ï¼Œå¯ä»¥ç¼–å·65536ä¸ªï¼ˆ2çš„16æ¬¡æ–¹ï¼‰ã€‚ å°äº26çš„ç«¯å£å·ä¸ºå¸¸ç”¨ç«¯å£å·ã€‚ DNSé»˜è®¤çš„ç«¯å£æ˜¯53ã€‚ ç«¯å£å· æè¿° ç±»å‹ 0-1023 ç†ŸçŸ¥ç«¯å£å· æœåŠ¡å™¨ç«¯å£å· 1024-49151 ç™»è®°ç«¯å£å· æœåŠ¡å™¨ç«¯å£å· 49152-65535 å®¢æˆ·ç«¯å·ï¼Œæˆ–çŸ­æš‚ç«¯å£å· å®¢æˆ·ç«¯å£å· 1.3 æ— è¿æ¥æœåŠ¡ä¸é¢å‘è¿æ¥æœåŠ¡ æ— è¿æ¥æœåŠ¡ é¢å‘è¿æ¥æœåŠ¡ æ•°æ®ä¼ è¾“ä¹‹å‰ï¼šæ— éœ€ä¸å¯¹ç«¯è¿›è¡Œä»»ä½•ä¿¡æ¯äº¤æ¢ï¼Œç›´æ¥æ„é€ ä¼ è¾“å±‚æŠ¥æ–‡æ®µå¹¶å‘æ¥å—ç«¯å‘é€ã€‚ æ•°æ®ä¼ è¾“ä¹‹å‰ï¼šéœ€è¦åŒæ–¹äº¤æ¢ä¸€äº›æ§åˆ¶ä¿¡æ¯ï¼Œå»ºç«‹é€»è¾‘è¿æ¥ï¼Œç„¶åå†ä¼ è¾“æ•°æ®ï¼Œä¼ è¾“ç»“æŸåè¿˜éœ€è¦æ‹†é™¤è¿æ¥ã€‚ ç±»ä¼¼äºä¿¡ä»¶é€šä¿¡ ç±»ä¼¼äºç”µè¯é€šä¿¡ äºŒã€ä¼ è¾“å±‚çš„å¤ç”¨å’Œåˆ†è§£ 2.1 å¤ç”¨å’Œåˆ†è§£ å¤šè·¯åˆ†è§£ï¼šåœ¨ç›®çš„ä¸»æœºï¼Œä¼ è¾“å±‚åè®®è¯»å–æŠ¥æ–‡æ®µä¸­çš„å­—æ®µï¼Œæ ‡è¯†å‡ºæ¥æ”¶å¥—æ¥å­—ï¼Œè¿›è€Œé€šè¿‡è¯¥å¥—æ¥å­—ï¼Œå†ä¼ è¾“å±‚çš„æŠ¥æ–‡æ®µä¸­çš„æ•°æ®äº¤ä»˜ç»™æ­£ç¡®çš„å¥—æ¥å­—ã€‚ å¤šè·¯å¤ç”¨ï¼šå†æºä¸»æœºï¼Œä¼ è¾“å±‚åè®®ä»ä¸åŒçš„å¥—æ¥å­—æ”¶é›†åº”ç”¨è¿›ç¨‹å‘é€çš„æ•°æ®å—ï¼Œå¹¶ä¸ºæ¯ä¸ªæ•°æ®å—å°è£…ä¸Šé¦–éƒ¨ä¿¡æ¯ï¼ˆåŒ…æ‹¬ç”¨äºåˆ†è§£çš„ä¿¡æ¯ï¼‰æ„æˆæŠ¥æ–‡æ®µï¼Œç„¶åå°†æŠ¥æ–‡æ®µä¼ é€’ç»™ç½‘ç»œå±‚ã€‚ æ€»ç»“ï¼šæ”¯æŒä¼—å¤šåº”ç”¨è¿›ç¨‹å…±ç”¨åŒä¸€ä¸ªä¼ è¾“å±‚åè®®ï¼Œå¹¶èƒ½å¤Ÿå°†æ¥æ”¶åˆ°çš„æ•°æ®å‡†ç¡®äº¤ä»˜ç»™ä¸åŒçš„åº”ç”¨è¿›ç¨‹ï¼Œæˆä¸ºä¼ è¾“å±‚çš„å¤šè·¯å¤ç”¨ä¸å¤šè·¯åˆ†è§£ï¼ˆç®€ç§°å¤ç”¨ä¸åˆ†è§£ï¼Œä¹Ÿç§°ä¸ºå¤ç”¨ä¸åˆ†ç”¨ï¼‰ã€‚ 2.1 æ— è¿æ¥çš„å¤šè·¯å¤ç”¨å’Œåˆ†è§£ ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUser Datagram Protocol,UDPï¼‰ï¼šInternetæä¾›æ— è¿æ¥æœåŠ¡çš„ä¼ è¾“å±‚åè®®ã€‚ UDPå°†åº”ç”¨å±‚çš„æ•°æ®å°è£…æˆä¸€ä¸ªUDPæŠ¥æ–‡æ®µã€‚ UDPå¥—æ¥å­—äºŒå…ƒç»„ï¼šã€‚ 2.2 é¢å‘è¿æ¥çš„å¤šè·¯å¤ç”¨å’Œåˆ†è§£ ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTransmission Control Protocol,TCPï¼‰ï¼šInternetæä¾›é¢å‘è¿æ¥æœåŠ¡çš„ä¼ è¾“å±‚åè®®ã€‚ TCPå¥—æ¥å­—å››å…ƒç»„ï¼šã€‚ ä¸‰ã€ç­‰-åœåè®®ä¸æ»‘åŠ¨çª—å£åè®® 3.1 å¯é æ•°æ®ä¼ è¾“åŸºæœ¬åŸç† ä¸å¯é ä¼ è¾“ä¿¡é“å†æ•°æ®ä¼ è¾“ä¸­å¯èƒ½å‘ç”Ÿï¼š æ¯”ç‰¹å·®é”™ï¼š1001-1000 ä¹±åºï¼šæ•°æ®å—1ã€2ã€5ã€6ã€3ã€4 æ•°æ®æµå¤±ï¼šæ•°æ®å—1ã€2ã€5 å¾ˆå¤šç½‘ç»œåº”ç”¨å¸Œæœ›ä¼ è¾“å±‚æä¾›å¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ã€‚ä¼ è¾“å±‚ä¸»è¦æœ‰ä¸¤ä¸ªåè®®ï¼šTCPå’ŒUDPã€‚TCPæä¾›å¯é æ•°æ®ä¼ è¾“æœåŠ¡ã€‚TCPè¦é‡‡å–é€‚å½“çš„æªæ–½ï¼Œä¿è¯å¯é ä¼ è¾“æ•°æ®ã€‚ åŸºäºä¸å¯é ä¿¡é“å®ç°å¯é æ•°æ®ä¼ è¾“é‡‡å–çš„æªæ–½ï¼š å·®é”™æ£€æµ‹ï¼šåˆ©ç”¨å·®é”™ç¼–ç å®ç°æ•°æ®åŒ…ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ¯”ç‰¹å·®é”™æ£€æµ‹ã€‚ ç¡®è®¤ï¼šæ¥æ”¶æ–¹å‘å‘é€æ–¹åé¦ˆæ¥æ”¶çŠ¶æ€ã€‚ACKï¼ˆè‚¯å®šç¡®è®¤ï¼‰ï¼›NAKï¼ˆå¦å®šç¡®è®¤ï¼‰ã€‚ é‡ä¼ ï¼šå‘é€æ–¹é‡æ–°å‘é€æ¥æ”¶æ–¹æ²¡æœ‰æ­£ç¡®æ¥æ”¶çš„æ•°æ®ã€‚ åºå·ï¼šç¡®ä¿æ•°æ®æŒ‰åºæäº¤ã€‚ è®¡æ—¶å™¨ï¼šè§£å†³æ•°æ®ä¸¢å¤±é—®é¢˜ã€‚ 3.2 åœç­‰åè®® è‡ªåŠ¨é‡ä¼ è¯·æ±‚åè®®ARQã€‚ å‘é€æ–¹ï¼Œå‘é€æ•°æ®ï¼Œç­‰å¾…ç¡®è®¤ã€‚ æ¥æ”¶æ–¹ï¼Œè‚¯å®šç¡®è®¤/å¦å®šç¡®è®¤ã€‚ å‘é€æ–¹ï¼Œåç»­æ•°æ®/é‡ä¼ æ•°æ®ã€‚ æ€§èƒ½å·®ï¼Œä¿¡é“åˆ©ç”¨ç‡ä½ã€‚ 3.3 æ»‘åŠ¨çª—å£åè®® æµæ°´çº¿åè®®ï¼šç®¡é“åè®®ã€‚å…è®¸å‘é€æ–¹å†æ²¡æœ‰æ”¶åˆ°ç¡®è®¤å‰è¿ç»­å‘é€å¤šä¸ªåˆ†ç»„ã€‚æœ€å…¸å‹çš„æµæ°´çº¿åè®®ï¼šæ»‘åŠ¨çª—å£åè®®ã€‚ å¢åŠ åˆ†ç»„åºå·ã€‚ å‘é€æ–¹å’Œæ¥æ”¶æ–¹å¯ä»¥æ¢æˆå¤šä¸ªåˆ†ç»„ã€‚ ç¡®è®¤åªè¿”å›ACKã€‚ä¾‹å¦‚ï¼šæ­£ç¡®æ¥æ”¶åˆ†ç»„01ï¼Œåˆ™è¿”å›ACK01ã€‚ å‘é€æ–¹çš„å‘é€çª—å£ï¼ˆWsï¼‰ï¼šå‘é€æ–¹å¯ä»¥å‘é€æœªè¢«ç¡®è®¤åˆ†ç»„çš„æœ€å¤§æ•°é‡ã€‚ æ¥æ”¶æ–¹çš„æ¥æ”¶çª—å£ï¼ˆWrï¼‰ï¼šæ¥æ”¶æ–¹å¯ä»¥ç¼“å­˜çš„æ­£ç¡®åˆ°è¾¾çš„åˆ†ç»„çš„æœ€å¤§æ•°é‡ã€‚ æ»‘åŠ¨çª—å£åè®®ï¼Œæ ¹æ®æ¥æ”¶çª—å£çš„å¤§å°ï¼Œå¯ä»¥å…·ä½“åˆ†ä¸ºï¼š å›é€€Næ­¥åè®®ï¼šGBNåè®®ï¼ˆGo-Back-Nï¼‰ é€‰æ‹©é‡ä¼ åè®®ï¼šSRåè®®ï¼ˆSelective Repeat) GBNåè®®ï¼šå‘é€çª—å£Ws>=1ï¼Œæ¥æ”¶çª—å£Wr=1ï¼ŒæœªæŒ‰åºåˆ°è¾¾çš„åˆ†ç»„éœ€è¦é‡ä¼ ã€‚ SRåè®®ï¼šå‘é€çª—å£Ws>1ï¼Œæ¥æ”¶çª—å£Wr>1ã€‚å‘é€æ–¹é‡ä¼ æœªè¢«æ¥æ”¶æ–¹ç¡®è®¤çš„åˆ†ç»„ã€‚ "},"pages/è®¡ç®—æœºç½‘ç»œåŸç†/ç²¾è®²6.html":{"url":"pages/è®¡ç®—æœºç½‘ç»œåŸç†/ç²¾è®²6.html","title":"1.6.ç²¾è®²6","keywords":"","body":"1.6.ç²¾è®²6 ä¸€ã€ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUDPï¼‰ ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆUser Datagram Protocol UDPï¼‰ï¼šInternetä¼ è¾“å±‚åè®®ï¼Œæä¾›æ— è¿æ¥ã€ä¸å¯é ã€æ•°æ®æŠ¥å°½åŠ›ä¼ è¾“æœåŠ¡ã€‚ 1.1 UDPç‰¹ç‚¹ åº”ç”¨è¿›ç¨‹å®¹æ˜“æ§åˆ¶å‘é€ä»€ä¹ˆæ•°æ®ä»¥åŠä½•æ—¶å‘é€ï¼Œä¼šå‡ºç°åˆ†ç»„ä¸¢å¤±å’Œé‡å¤ã€‚ æ— éœ€å»ºç«‹è¿æ¥ã€‚ æ— è¿æ¥çŠ¶æ€ã€‚ é¦–éƒ¨å¼€é”€å°ï¼Œåªæœ‰8ä¸ªå­—èŠ‚ã€‚ 1.2 UDPæ•°æ®æŠ¥ç»“æ„ UDPæ•°æ®æŠ¥é¦–éƒ¨ï¼šæºç«¯å£å·ï¼ˆ16ä½ï¼‰ã€ç›®çš„ç«¯å£å·ï¼ˆ16ä½ï¼‰ã€é•¿åº¦ï¼ˆ16ä½ï¼‰ã€æ ¡éªŒå’Œï¼ˆ16ä½ï¼‰ï¼Œä¸€å…±8å­—èŠ‚ã€‚ UDPæ•°æ®æŠ¥æ•°æ®å­—æ®µï¼šåº”ç”¨æ•°æ® 1.3 UDPæ ¡éªŒå’Œ æä¾›å·®é”™æ£€æµ‹åŠŸèƒ½ï¼ŒUDPçš„æ ¡éªŒå’Œç”¨äºæ£€æµ‹UDPæŠ¥æ–‡æ®µä»æºåˆ°ç›®çš„åœ°ä¼ é€è¿‡ç¨‹ä¸­ï¼Œå…¶ä¸­æ•°æ®æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜ã€‚ UDPæ ¡éªŒå’Œè®¡ç®—çš„å†…å®¹åŒ…æ‹¬3éƒ¨åˆ†ï¼šUDPä¼ªé¦–éƒ¨ã€UDPé¦–éƒ¨ã€åº”ç”¨æ•°æ®ã€‚ 1.4 UDPä¼ªé¦–éƒ¨ç»“æ„ æºIPåœ°å€ã€ç›®çš„IPåœ°å€ã€åè®®å·ï¼šå¯¹åº”å°è£…UDPæ•°æ®æŠ¥çš„IPåˆ†ç»„çš„å­—æ®µã€‚ UDPé•¿åº¦å­—æ®µï¼šæ˜¯è¯¥UDPæ•°æ®æŠ¥çš„å­—æ®µï¼Œè¯¥å­—æ®µå‚ä¸è®¡ç®—ä¸¤æ¬¡ã€‚ UDPåè®®å·ï¼š17ã€‚ 1.5 UDPæ ¡éªŒå’Œè®¡ç®—è§„åˆ™ æ‰€æœ‰å‚ä¸è¿ç®—å†…å®¹æŒ‰16ä½å¯¹é½æ±‚å’Œã€‚ æ±‚å’Œè¿‡ç¨‹ä¸­é‡åˆ°æº¢å‡ºï¼ˆå³è¿›ä½ï¼‰éƒ½è¢«å›å·ï¼ˆå³è¿›ä½ä¸æœ€ä½ä½å†ç›¸åŠ ï¼‰ï¼Œæœ€åå¾—åˆ°çš„å’Œå–åç ï¼Œå°±æ˜¯UDPçš„æ ¡éªŒå’Œï¼Œå¡«å…¥UDPæ•°æ®æŠ¥çš„æ ¡éªŒå’Œå­—æ®µã€‚ UDPå†ç”Ÿæˆæ ¡éªŒå’Œçš„æ—¶å€™ï¼Œæ ¡éªŒå’Œå­—æ®µå…¨å–0ã€‚ äºŒã€ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTCPï¼‰ 2.1 TCPæŠ¥æ–‡æ®µç»“æ„ ä¼ è¾“æ§åˆ¶åè®®(Transmission Control Protocol ,TCP)ï¼šInternetä¼ è¾“å±‚åè®®ã€‚æä¾›é¢å‘è¿æ¥ã€å¯é ã€æœ‰åºã€å­—èŠ‚æµ ä¼ è¾“æœåŠ¡ã€‚ ç¬¬ä¸€ã€åº”ç”¨è¿›ç¨‹å…ˆå»ºç«‹è¿æ¥ã€‚ ç¬¬äºŒã€æ¯ä¸€æ¡TCPè¿æ¥åªæœ‰ä¸¤ä¸ªç«¯ç‚¹ã€‚ ç¬¬ä¸‰ã€å¯é äº¤ä»˜ï¼šæ— å·®é”™ï¼Œä¸ä¸¢å¤±ï¼Œä¸é‡å¤ï¼ŒæŒ‰åºåˆ°è¾¾ ç¬¬å››ã€å…¨åŒå·¥é€šä¿¡ã€‚ ç¬¬äº”ã€é¢å‘å­—èŠ‚æµã€‚ æµï¼šå­—èŠ‚åºåˆ—ã€‚åº”ç”¨ç¨‹åºå’ŒTCPçš„äº¤äº’æ˜¯ä¸€ä¸ªä¸ªæ•°æ®å—ï¼ŒTCPæŠŠä»–ä»¬çœ‹åšæ˜¯æ— ç»“æ„å­—èŠ‚ã€‚ graph LR åº”ç”¨å±‚æŠ¥æ–‡-->ä¼ è¾“å±‚TCPæŠ¥æ–‡æ®µ æœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦ï¼ˆMaximum Segment Size,MSSï¼‰ï¼šæŠ¥æ–‡æ®µä¸­å°è£…çš„åº”ç”¨å±‚æ•°æ®çš„æœ€å¤§é•¿åº¦ã€‚ æºç«¯å£å·å­—æ®µï¼Œç›®çš„ç«¯å£å·å­—æ®µåˆ†åˆ«å 16ä½ã€‚å¤ç”¨/åˆ†è§£æ¥è‡ª/é€åˆ°ä¸Šå±‚åº”ç”¨çš„æ•°æ®ã€‚ åºå·å­—æ®µã€ç¡®è®¤åºå·å­—æ®µåˆ†åˆ«å 32ä½ã€‚ åºå·å­—æ®µï¼šTCPçš„åºå·æ˜¯å¯¹æ¯ä¸ªåº”ç”¨å±‚æ•°æ®çš„æ¯ä¸ªå­—èŠ‚è¿›è¡Œç¼–å·ï¼› ç¡®è®¤åºå·å­—æ®µï¼šæ˜¯æœŸæœ›ä»å¯¹æ–¹æ¥æ”¶æ•°æ®çš„å­—èŠ‚åºå·ï¼Œå³è¯¥åºå·å¯¹åº”çš„å­—èŠ‚å°šæœªæ”¶åˆ°ï¼› é¦–éƒ¨é•¿åº¦å­—æ®µå 4ä½ã€‚æŒ‡å‡ºTCPæ®µçš„é¦–éƒ¨é•¿åº¦ï¼Œä»¥4å­—èŠ‚ä¸ºè®¡ç®—å•ä½ã€‚æœ€çŸ­æ˜¯20å­—èŠ‚ï¼›æœ€é•¿æ˜¯60å­—èŠ‚ã€‚ ä¿ç•™å­—æ®µå 6ä½ã€‚ä¿ç•™ä¸ºä»Šåä½¿ç”¨ï¼Œç›®å‰å€¼ä¸º0ã€‚ URGã€ACKã€PSHã€RSTã€SYNã€FINå„å 1ä½ã€‚ä¸ºæ ‡å¿—ä½å­—æ®µï¼›å„å 1ä½ï¼Œå–å€¼ä¸º0æˆ–1ï¼› ç´§æ€¥URG=1ï¼Œç´§æ€¥æŒ‡é’ˆå­—æ®µæœ‰æ•ˆï¼Œä¼˜å…ˆä¼ é€ã€‚ ç¡®è®¤ACK=1ï¼Œç¡®è®¤åºå·å­—æ®µæœ‰æ•ˆï¼›ACK=0æ—¶ï¼Œç¡®è®¤åºå·å­—æ®µæ— æ•ˆã€‚ æ¨é€PSH=1ï¼Œå°½å¿«å°†æŠ¥æ–‡æ®µä¸­çš„æ•°æ®äº¤ä»˜æ¥æ”¶åº”ç”¨è¿›ç¨‹ï¼Œä¸è¦ç­‰ç¼“å­˜æ»¡äº†å†äº¤ä»˜ã€‚ å¤ä½RST=1ï¼ŒTCPè¿æ¥å‡ºç°ä¸¥é‡å·®é”™ï¼Œé‡Šæ”¾è¿æ¥ï¼Œå†é‡æ–°å»ºç«‹TCPè¿æ¥ã€‚ åŒæ­¥SYN=1ï¼Œè¯¥TCPæŠ¥æ–‡æ®µæ˜¯ä¸€ä¸ªå»ºç«‹æ–°è¿æ¥è¯·æ±‚æ§åˆ¶æ®µæˆ–è€…åŒæ„å»ºç«‹æ–°è¿æ¥çš„ç¡®è®¤æ®µã€‚ ç»ˆæ­¢FIN=1ï¼ŒTCPæŠ¥æ–‡æ®µçš„å‘é€ç«¯æ•°æ®å·²ç»å‘é€å®Œæ¯•ï¼Œè¯·æ±‚é‡Šæ”¾è¿æ¥ã€‚ æ¥æ”¶çª—å£å­—æ®µå 16ä½ã€‚å‘å¯¹æ–¹é€šå‘Šæˆ‘æ–¹æ¥æ”¶çª—å£çš„å¤§å°ã€‚ æ ¡éªŒå’Œå­—æ®µå 16ä½ã€‚æ ¡éªŒå’Œå­—æ®µæ£€éªŒçš„èŒƒå›´ç±»ä¼¼äºUDPï¼Œè®¡ç®—æ–¹æ³•ä¸UDPæ ¡éªŒå’Œçš„è®¡ç®—æ–¹æ³•ç›¸åŒã€‚TCPåè®®å·æ˜¯6ã€‚ ç´§æ€¥æŒ‡é’ˆå­—æ®µå 16ä½ã€‚URG=1æ—¶ï¼Œæ‰æœ‰æ•ˆã€‚æŒ‡å‡ºåœ¨æœ¬TCPæŠ¥æ–‡æ®µä¸­ç´§æ€¥æ•°æ®å…±æœ‰å¤šå°‘ä¸ªå­—èŠ‚ é€‰é¡¹å­—æ®µé•¿åº¦å¯å˜ï¼ŒåŸºæœ¬ä¸ç”¨ã€‚æœ€çŸ­ä¸º0å­—èŠ‚ï¼Œæœ€é•¿ä¸º40å­—èŠ‚ã€‚ å¡«å……å­—æ®µï¼Œå–å€¼å…¨ä¸º0ï¼Œç›®çš„æ˜¯ä¸ºäº†æ•´ä¸ªé¦–éƒ¨é•¿åº¦æ˜¯4å­—èŠ‚çš„æ•´å€æ•°ã€‚ è¦ç‚¹ï¼š åºå·å­—æ®µï¼šTCPçš„åºå·æ˜¯å¯¹æ¯ä¸ªåº”ç”¨å±‚æ•°æ®çš„æ¯ä¸ªå­—èŠ‚è¿›è¡Œç¼–å·ï¼Œ ç¡®è®¤åºå·å­—æ®µï¼šæ˜¯æœŸæœ›ä»å¯¹æ–¹æ¥æ”¶æ•°æ®çš„å­—èŠ‚åºå·ï¼Œå³è¯¥åºå·å¯¹åº”çš„å­—èŠ‚å°šæœªæ”¶åˆ°ã€‚ç”¨ack_seqè¡¨ç¤ºã€‚ TCPæ®µçš„é¦–éƒ¨é•¿åº¦æœ€çŸ­æ˜¯20å­—èŠ‚ã€‚ 2.2 TCPè¿æ¥ç®¡ç† TCPè¿æ¥ç®¡ç†ï¼šè¿æ¥å»ºç«‹ä¸è¿æ¥æ‹†é™¤ã€‚ TCPè¿æ¥å»ºç«‹ï¼š ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š å®¢æˆ·å‘æœåŠ¡å™¨å‘é€è¿æ¥è¯·æ±‚æ®µï¼šSYN=1,seq=x SYN=1ï¼šå»ºç«‹è¿æ¥è¯·æ±‚æ§åˆ¶æ®µ seq=xï¼šè¡¨ç¤ºä¼ è¾“çš„æŠ¥æ–‡æ®µçš„ç¬¬1ä¸ªæ•°æ®å­—èŠ‚çš„åºåˆ—å·æ˜¯xï¼Œå¹¶ä»¥æ­¤åºåˆ—å·ä»£è¡¨æ•´ä¸ªæŠ¥æ–‡æ®µçš„åºå· ï¼ˆè¡¥å……ï¼šsequence numberï¼Œåºå·çš„æ„æ€ã€‚ï¼‰ å®¢æˆ·ç«¯è¿›å…¥SYN_SENDï¼ˆåŒæ­¥å‘é€ï¼‰ ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°TCPè¿æ¥è¯·æ±‚æ®µåï¼Œå¦‚åŒæ„ï¼Œåˆ™å‘å›ç¡®è®¤æŠ¥æ–‡æ®µï¼š ï¼ˆSYN=1,ACK=1,seq=y, ack_seq=x+1ï¼‰ SYN=1ï¼šåŒæ„å»ºç«‹æ–°è¿æ¥çš„ç¡®è®¤æ®µ ack_seq=x+1ï¼šè¡¨ç¤ºå·²ç»æ”¶åˆ°äº†åºåˆ—å·ä¸ºxçš„æŠ¥æ–‡æ®µï¼Œå‡†å¤‡æ¥æ”¶åºåˆ—å·ä¸ºx+1çš„æŠ¥æ–‡æ®µã€‚ seq=yï¼šæœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ç¡®è®¤æŠ¥æ–‡æ®µçš„åºåˆ—å·æ˜¯yã€‚ æœåŠ¡å™¨ç”±LISTENè¿›å…¥SYN_RCVDï¼ˆåŒæ­¥æ”¶åˆ°ï¼‰ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·å¯¹æœåŠ¡å™¨çš„ åŒæ„è¿æ¥æŠ¥æ–‡æ®µ è¿›è¡Œç¡®è®¤ï¼š ï¼ˆACK=1,seq=x+1,ack_seq=y+1ï¼‰ seq=x+1ï¼šå®¢æˆ·æ­¤æ¬¡çš„æŠ¥æ–‡æ®µçš„åºåˆ—å·æ˜¯x+1ã€‚ ack_seq=y+1ï¼šå®¢æˆ·æœŸæœ›æ¥æ”¶æœåŠ¡å™¨åºåˆ—å·ä¸ºy+1çš„æŠ¥æ–‡æ®µã€‚ å½“å®¢æˆ·å‘é€ACKæ—¶ï¼Œå®¢æˆ·ç«¯è¿›å…¥ESTABLISHEDçŠ¶æ€ï¼› å½“æœåŠ¡æ”¶åˆ°ACKåï¼Œä¹Ÿè¿›å…¥ESTABLISHEDçŠ¶æ€ï¼› åªæœ‰ç¬¬ä¸‰æ¬¡æ¡æ‰‹å¯æºå¸¦æ•°æ®ã€‚ TCPè¿æ¥æ‹†é™¤ï¼š ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·å‘æœåŠ¡å™¨å‘é€é‡Šæ”¾è¿æ¥æŠ¥æ–‡æ®µï¼šï¼ˆFIN=1,seq=uï¼‰ FIN=1ï¼šå‘é€ç«¯æ•°æ®å‘é€å®Œæ¯•ï¼Œè¯·æ±‚é‡Šæ”¾è¿æ¥ã€‚ seq=uï¼šä¼ è¾“çš„ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚çš„åºå·æ˜¯u å®¢æˆ·ç«¯çŠ¶æ€ç”±ESTABLISHEDè¿›å…¥FIN_WAIT_1ï¼ˆç»ˆæ­¢ç­‰å¾…1çŠ¶æ€ï¼‰ ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šæœåŠ¡å™¨å‘å®¢æˆ·å‘é€ç¡®è®¤æ®µï¼šï¼ˆACK=1,seq=v,ack_seq=u+1ï¼‰ ACK=1ï¼šç¡®è®¤å­—å·æ®µæœ‰æ•ˆã€‚ ack_seq=u+1ï¼šæœåŠ¡å™¨æœŸæœ›æ¥æ”¶å®¢æˆ·æ•°æ®åºå·ä¸ºu+1ã€‚ seq=vï¼šæœåŠ¡å™¨ä¼ è¾“çš„æ•°æ®åºå·æ˜¯vã€‚ æœåŠ¡å™¨çŠ¶æ€ç”±ESTABLISHEDè¿›å…¥CLOSE_WAITï¼ˆå…³é—­ç­‰å¾…ï¼‰ å®¢æˆ·ç«¯æ”¶åˆ°ACKæ®µåï¼Œç”±FIN_WAIT_1è¿›å…¥FIN_WAIT_2 ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šæœåŠ¡å™¨å‘å®¢æˆ·å‘é€é‡Šæ”¾è¿æ¥æŠ¥æ–‡æ®µï¼šï¼ˆFIN=1,ACK=1,seq=w,ack_seq=u+1ï¼‰ FIN=1ï¼šè¯·æ±‚é‡Šæ”¾è¿æ¥ ACK=1ï¼šç¡®è®¤å­—å·æ®µæœ‰æ•ˆã€‚ ack_seq=u+1ï¼šè¡¨ç¤ºæœåŠ¡å™¨æœŸæœ›æ¥æ”¶å®¢æˆ·æ•°æ®åºå·ä¸ºu+1ã€‚ seq=wï¼šè¡¨ç¤ºè‡ªå·±ä¼ è¾“çš„ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚çš„åºå·æ˜¯wã€‚ æœåŠ¡å™¨çŠ¶æ€ç”±CLOSE_WAITè¿›å…¥LAST_ACKï¼ˆæœ€åç¡®è®¤çŠ¶æ€ï¼‰ ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·å‘æœåŠ¡å™¨å‘é€ç¡®è®¤æ®µï¼šï¼ˆACK=1,seq=u+1,ack_seq=w+1ï¼‰ ACK=1ï¼šç¡®è®¤å­—å·æ®µæœ‰æ•ˆã€‚ ack_seq=w+1ï¼šè¡¨ç¤ºå®¢æˆ·æœŸæœ›æ¥æ”¶æœåŠ¡å™¨æ•°æ®åºå·ä¸ºw+1ã€‚ seq=u+1ï¼šè¡¨ç¤ºå®¢æˆ·ä¼ è¾“çš„æ•°æ®çš„åºå·æ˜¯u+1ã€‚ å®¢æˆ·ç«¯çŠ¶æ€ç”±FIN_WAIT_2è¿›å…¥TIME_WAITï¼Œç­‰å¾…2MSLæ—¶é—´ï¼Œè¿›å…¥CLOSEDçŠ¶æ€ã€‚ æœåŠ¡å™¨åœ¨æ”¶åˆ°æœ€åä¸€æ¬¡ACKåï¼Œç”±LAST_ACKè¿›å…¥CLOSEDã€‚ 2.3 TCPå¯é æ•°æ®ä¼ è¾“ TCPå®ç°å¯é æ•°æ®ä¼ è¾“æœåŠ¡çš„å·¥ä½œæœºåˆ¶ï¼š å¯é ï¼šä¿è¯æ¥æ”¶æ–¹åº”ç”¨è¿›ç¨‹ä»ç¼“å†²åŒºè¯»å‡ºçš„å­—èŠ‚æµä¸å‘é€æ–¹å‘å‡ºçš„å­—èŠ‚æµæ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚ ä¸€ã€TCPå®ç°å¯é æ•°æ®ä¼ è¾“æœåŠ¡çš„å·¥ä½œæœºåˆ¶ï¼š 1ã€åº”ç”¨å±‚æ•°æ®è¢«åˆ†å‰²æˆTCPè®¤ä¸ºæœ€é€‚åˆå‘é€çš„æ•°æ®å—ã€‚ 2ã€TCPå‘å‡ºä¸€ä¸ªæ®µåï¼Œå¯åŠ¨ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œç­‰å¾…ç›®çš„ç«¯ç¡®è®¤æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ®µã€‚ 3ã€TCPé¦–éƒ¨ä¸­è®¾æœ‰æ ¡éªŒå’Œå­—æ®µï¼Œç”¨äºæ£€æµ‹æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯å¦å‘ç”Ÿå·®é”™ã€‚ 4ã€TCPæŠ¥æ–‡æ®µåˆ°ç›®çš„ç«¯å¯èƒ½ä¼šå¤±åºï¼ŒTCPä¼šé‡æ–°æ’åºã€‚ 5ã€æ¥æ”¶ç«¯æ”¶åˆ°é‡å¤çš„æŠ¥æ–‡æ®µï¼Œæ¥æ”¶ç«¯æ ¹æ®åºå·æŠŠé‡å¤çš„æŠ¥æ–‡æ®µä¸¢å¼ƒã€‚ 6ã€TCPæä¾›æµé‡æ§åˆ¶ã€‚ ä¿è¯æ¥æ”¶æ–¹è¿›ç¨‹ä»ç¼“å†²åŒºè¯»å‡ºçš„å­—èŠ‚æµä¸å‘é€æ–¹å‘å‡ºçš„å­—èŠ‚æµæ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚ 1ã€æ ¡éªŒï¼šä¸UDPä¸€æ · 2ã€åºå· 3ã€ç¡®è®¤ 4ã€é‡ä¼  5ã€è®¡æ—¶å™¨ åºå·ï¼šåº”ç”¨å±‚æ•°æ®è¢«åˆ†å‰²æˆTCPè®¤ä¸ºæœ€é€‚åˆå‘é€çš„æ•°æ®å—ã€‚ä¸€ä¸ªå­—èŠ‚å ç”¨ä¸€ä¸ªåºå·ã€‚åºå·å­—æ®µæŒ‡çš„å°±æ˜¯ä¸€ä¸ªæŠ¥æ–‡æ®µç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ã€‚ ç¡®è®¤ï¼šTCPé‡‡ç”¨ç´¯ç§¯ç¡®è®¤ã€‚æ­¤æ—¶è¿”å›ç¡®è®¤åºå·ä¸º4ã€‚ TCPç”ŸæˆACKçš„ç­–ç•¥ï¼š 1ã€å…·æœ‰æ‰€æœŸæœ›åºå·çš„æŠ¥æ–‡æ®µæŒ‰åºåˆ°è¾¾ï¼Œæ‰€æœ‰åœ¨æœŸæœ›åºå·åŠä»¥å‰çš„æŠ¥æ–‡æ®µéƒ½å·²è¢«ç¡®è®¤ã€‚TCPå»¶è¿Ÿ500mså‘é€ACKã€‚ 2ã€å…·æœ‰æ‰€æœŸæœ›åºå·çš„æŠ¥æ–‡æ®µæŒ‰åºåˆ°è¾¾ã€ä¸”å¦ä¸€ä¸ªæŒ‰åºæŠ¥æ–‡æ®µåœ¨ç­‰å¾…ACKä¼ è¾“ï¼ŒTCPæ¥æ”¶æ–¹ç«‹å³å‘é€å•ä¸ªç´¯è®¡ACKï¼Œç¡®è®¤ä»¥ä¸Šä¸¤ä¸ªæŒ‰åºåˆ°è¾¾æŠ¥æ–‡æ®µã€‚ 3ã€æ‹¥æœ‰åºå·å¤§äºæœŸæœ›åºå·çš„å¤±åºæŠ¥æ–‡æ®µåˆ°è¾¾ï¼ŒTCPæ¥æ”¶æ–¹ç«‹å³å‘é€é‡å¤ACKï¼ŒæŒ‡ç¤ºä¸‹ä¸€ä¸ªæœŸæœ›æ¥æ”¶å­—èŠ‚çš„åºå·ã€‚ 4ã€æ”¶åˆ°ä¸€ä¸ªæŠ¥æ–‡æ®µï¼Œéƒ¨åˆ†æˆ–å®Œå…¨å¡«å……æ¥æ”¶æ•°æ®é—´éš”ã€‚ é‡ä¼ ï¼šå¿«é€Ÿé‡ä¼ : TCPå‘é€æ–¹æ¥æ”¶åˆ°å¯¹ç›¸åŒåºå·çš„3æ¬¡é‡å¤ACKï¼Œå°±è¯´æ˜è¢«é‡å¤ç¡®è®¤çš„æŠ¥æ–‡æ®µå·²ä¸¢å¤±ï¼Œè¿™æ—¶å€™å³ä¾¿æ²¡æœ‰è¶…æ—¶ï¼Œä¹Ÿä¼šé‡å‘è¯¥æŠ¥æ–‡æ®µã€‚ è®¡æ—¶å™¨ï¼šè®¡æ—¶å™¨è¶…æ—¶æ—¶é—´çš„è°ƒæ•´ã€‚ è®¡æ—¶å™¨è¶…æ—¶æ—¶é—´è®¾ç½®ï¼š TimeoutInerval=EstimatedRTT+4Ã—DevRTT EstimatedRTTï¼šæŠ½æ ·RTTçš„åŠ æƒç§»åŠ¨å¹³å‡å€¼ã€‚ DevRTTï¼šåå·®RTT 2.4 TCPæµé‡æ§åˆ¶ 2.5 TCPæ‹¥å¡æ§åˆ¶ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸€ç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¯¼è®º/ç¬¬ä¸€èŠ‚_ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ¦‚å¿µåŠå…¶å‘å±•.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸€ç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¯¼è®º/ç¬¬ä¸€èŠ‚_ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ¦‚å¿µåŠå…¶å‘å±•.html","title":"ç¬¬ä¸€èŠ‚ï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ¦‚å¿µåŠå…¶å‘å±•","keywords":"","body":"ç¬¬ä¸€èŠ‚ï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ¦‚å¿µåŠå…¶å‘å±• ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ¦‚å¿µçš„èµ·æº ç”¨â€œä¸‰åŒ–â€æ¥æ¦‚æ‹¬äººç±»ç¤¾ä¼šå‘å±•çš„å†ç¨‹ï¼Œâ€œä¸‰åŒ–â€åˆ†åˆ«æ˜¯æŒ‡å†œä¸šåŒ–ã€å·¥ä¸šåŒ–å’Œä¿¡æ¯åŒ–ã€‚ é«˜ç™»Â·æˆ´ç»´æ–¯å®šä¹‰ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè¯´æ˜å…¶ç›®æ ‡åœ¨ä¸‰ä¸ªå±‚æ¬¡ä¸Šæ”¯æŒç®¡ç†æ´»åŠ¨ï¼Œé«˜ã€ä¸­ã€ä½ä¸‰ä¸ªå±‚æ¬¡åˆ†åˆ«å¯¹åº”å†³ç­–å±‚ã€ç®¡ç†å±‚å’Œæ‰§è¡Œå±‚ã€‚ äººç±»å‘å±•å†ç¨‹çš„â€œä¸‰åŒ–â€åˆ†åˆ«æŒ‡å†œä¸šåŒ–ã€å·¥ä¸šåŒ–å’Œä¿¡æ¯åŒ–ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯ç°ä»£åŒ–å’Œä¿¡æ¯æŠ€æœ¯çš„åº”ç”¨ä¸æ–­èåˆçš„äº§ç‰©ã€‚ ç°ä»£åŒ–å’Œä¿¡æ¯æŠ€æœ¯ä¸æ–­èåˆçš„äº§ç‰©æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ 1985å¹´ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åˆ›å§‹äººé«˜ç™»Â·æˆ´ç»´æ–¯ç»™ç®¡ç†ä¿¡æ¯ç³»ç»Ÿåšäº†ä¸€ä¸ªå®Œæ•´çš„å®šä¹‰ï¼šâ€œå®ƒæ˜¯ä¸€ä¸ªåˆ©ç”¨è®¡ç®—æœºç¡¬ä»¶å’Œè½¯ä»¶ï¼Œæ‰‹å·¥ä½œä¸šï¼Œåˆ†æã€è®¡åˆ’ã€æ§åˆ¶å’Œå†³ç­–æ¨¡å‹ï¼Œä»¥åŠæ•°æ®åº“çš„ç”¨æˆ·-æœºå™¨ç³»ç»Ÿã€‚å®ƒèƒ½æä¾›ä¿¡æ¯ï¼Œæ”¯æŒä¼ä¸šæˆ–ç»„ç»‡çš„è¿è¡Œã€ç®¡ç†å’Œå†³ç­–åŠŸèƒ½â€ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ¦‚å¿µçš„æ¼”è¿› åœ¨ç®¡ç†é¢†åŸŸï¼Œæˆ‘ä»¬è®¤ä¸ºç®¡ç†ä¿¡æ¯ç³»ç»Ÿå°±æ˜¯ä¿¡æ¯ç³»ç»Ÿã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å®šä¹‰ ç³»ç»Ÿè®¾è®¡è€…ä¸æ‡‚ç°ä»£ç®¡ç†çŸ¥è¯†ï¼Œæ˜¯ä¸å¯èƒ½è®¾è®¡å‡ºå¥½çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ã€‚æ­£ç¡® è®¡ç®—æœºæ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¿…è¦æ¡ä»¶ã€‚é”™è¯¯ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¸€ä½“åŒ–é›†æˆç³»ç»Ÿï¼ŒåŒ…æ‹¬æ•°æ®çš„ä¸€ä½“åŒ–å’Œç³»ç»Ÿå¼€å‘çš„ä¸€ä½“åŒ–ä¸¤ä¸ªå«ä¹‰ã€‚ MISæ˜¯ä¸€ä¸ªâ€œä¸€ä½“åŒ–ç³»ç»Ÿâ€ï¼Œåˆç§°é›†æˆç³»ç»Ÿã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¸€ä½“åŒ–ç³»ç»Ÿ,ä¸€ä½“åŒ–å…·æœ‰ä¸¤ä¸ªå«ä¹‰ï¼šæ•°æ®çš„ä¸€ä½“åŒ–å’Œç³»ç»Ÿå¼€å‘çš„ä¸€ä½“åŒ–ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯ä»¥è®¡ç®—æœºæŠ€æœ¯ã€é€šä¿¡æŠ€æœ¯å’Œè½¯ä»¶æŠ€æœ¯ä¸ºæŠ€æœ¯åŸºç¡€ï¼Œæœ€ç»ˆæœåŠ¡ä¸ç»„ç»‡æ•´ä½“çš„ç®¡ç†å’Œå†³ç­–ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯ä¸€ä¸ªâ€œé›†æˆç³»ç»Ÿâ€ï¼Œåˆç§°ä¸€ä½“åŒ–ç³»ç»Ÿã€‚ åªè¦æœ‰ç®¡ç†ï¼Œå°±è¦æœ‰ä¿¡æ¯ï¼Œå°±å¿…ç„¶æœ‰ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ=äºº+è®¡ç®—æœºï¼Œå³ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯ä¸€ä¸ªåˆæˆç³»ç»Ÿã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯åˆ©ç”¨ç°ä»£ç®¡ç†çš„å…ˆè¿›æŠ€æœ¯ã€æ–¹æ³•å’Œå·¥å…·ï¼Œå‘å„çº§ç®¡ç†è€…æä¾›ç»è¥ç®¡ç†çš„å†³ç­–æ”¯æŒã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯ä¸€ä¸ªâ€œä¸€ä½“åŒ–â€ç³»ç»Ÿï¼Œå…¶ä¸­â€œä¸€ä½“åŒ–â€åŒ…å«ä¸¤ä¸ªå«ä¹‰ï¼šæ•°æ®çš„ä¸€ä½“åŒ–å’Œç³»ç»Ÿå¼€å‘çš„ä¸€ä½“åŒ–ã€‚ ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸€ä½“åŒ–çš„å«ä¹‰ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯ä¸€ä¸ªâ€œä¸€ä½“åŒ–ç³»ç»Ÿâ€æˆ–ç§°â€œé›†æˆç³»ç»Ÿâ€ã€‚â€œä¸€ä½“åŒ–â€å…·æœ‰ä¸¤ä¸ªå«ä¹‰ï¼š æ•°æ®çš„ä¸€ä½“åŒ–ï¼šæ•°æ®åœ¨å±‹é‡Œå­˜å‚¨ä¸Šå¯ä»¥åˆ†å¸ƒå­˜æ”¾ï¼Œä½†åœ¨é€»è¾‘ä¸Šå´éœ€è¦ç”±ç»Ÿä¸€çš„éƒ¨é—¨ï¼Œç»Ÿä¸€çš„äººå‘˜é›†ä¸­ç®¡ç†ï¼› ç³»ç»Ÿå¼€å‘çš„ä¸€ä½“åŒ–ï¼šè¦æŒ‰æ€»ä½“è§„åˆ’ï¼Œåˆ†å¸ƒå®æ–½çš„åŸåˆ™è¿›è¡Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å»ºè®¾ã€‚ åè¯è§£é‡Šï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯ä¸€ä¸ªç”±äººã€æœºï¼ˆè®¡ç®—æœºï¼‰ç»„æˆçš„èƒ½è¿›è¡Œç®¡ç†ä¿¡æ¯çš„æ”¶é›†ã€ä¼ é€’ã€å­˜å‚¨ã€åŠ å·¥ã€ç»´æŠ¤å’Œä½¿ç”¨çš„ç³»ç»Ÿã€‚ ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŸºæœ¬åŠŸèƒ½ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯ä¸€ä¸ªäººæœºç³»ç»Ÿï¼ŒåŒæ—¶å®ƒåˆæ˜¯ä¸€ä¸ªä¸€ä½“åŒ–é›†æˆç³»ç»Ÿã€‚å®ƒä»¥è®¡ç®—æœºæŠ€æœ¯ã€é€šä¿¡æŠ€æœ¯å’Œè½¯ä»¶æŠ€æœ¯ä¸ºæŠ€æœ¯åŸºç¡€ï¼Œå°†ç°ä»£ç®¡ç†ç†è®ºã€ç°ä»£ç®¡ç†æ–¹æ³•åŠå„çº§ç®¡ç†äººå‘˜èä¸ºä¸€ä½“ï¼Œæœ€ç»ˆä¸ºæŸä¸ªç»„ç»‡æ•´ä½“çš„ç®¡ç†ä¸å†³ç­–æœåŠ¡ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä»¥è®¡ç®—æœºæŠ€æœ¯ï¼Œé€šä¿¡æŠ€æœ¯å’Œè½¯ä»¶æŠ€æœ¯ä¸ºæŠ€æœ¯åŸºç¡€ï¼Œå°†ç°ä»£ç®¡ç†ç†è®ºã€ç°ä»£ç®¡ç†æ–¹æ³•åŠå„çº§ç®¡ç†äººå‘˜èä¸ºä¸€ä½“ï¼Œæœ€ç»ˆæœåŠ¡äºç»„ç»‡æ•´ä½“çš„ç®¡ç†ä¸å†³ç­–ã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸€ç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¯¼è®º/ç¬¬äºŒèŠ‚_ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åˆ†ç±».html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸€ç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¯¼è®º/ç¬¬äºŒèŠ‚_ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åˆ†ç±».html","title":"ç¬¬äºŒèŠ‚ï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åˆ†ç±»","keywords":"","body":"ç¬¬äºŒèŠ‚ï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åˆ†ç±» ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä»4ä¸ªè§’åº¦è¿›è¡Œåˆ†ç±»ï¼Œä¸åŒ…æ‹¬ï¼ˆAï¼‰ A åŠŸèƒ½ç»“æ„ B ç®¡ç†åº”ç”¨å±‚æ¬¡ C æ•°æ®å¤„ç†æ–¹å¼ D æ ¸å¿ƒä¸šåŠ¡ å…³äºç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åˆ†ç±»ï¼Œç”µå­å•†åŠ¡ç³»ç»Ÿéš¶å±äºï¼ˆCï¼‰åˆ†ç±»æ–¹å¼ã€‚ A è¡Œä¸šå’Œä¸šåŠ¡èŒèƒ½ B ç®¡ç†åº”ç”¨å±‚æ¬¡ C æ ¸å¿ƒä¸šåŠ¡ D æ•°æ®å¤„ç†æ–¹å¼ åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åˆ†ç±»ä¸­ï¼Œç”µå­ä¸šåŠ¡ç³»ç»Ÿçš„åˆ†ç±»æ–¹å¼æ˜¯ä¾æ®ï¼ˆBï¼‰ A æ•°æ®å¤„ç†æ–¹å¼ B æ ¸å¿ƒä¸šåŠ¡æ´»åŠ¨ C ç®¡ç†åº”ç”¨å±‚æ¬¡ D è¡Œä¸šå’Œä¸šåŠ¡èŒèƒ½ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¯ä»¥æŒ‰è¡Œä¸šå’Œä¸šåŠ¡èŒèƒ½è¿›è¡Œåˆ†ç±»ï¼ˆAï¼‰ã€‚ A æ­£ç¡® B é”™è¯¯ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åˆ†ç±»æ–¹å¼åŒ…æ‹¬æ ¸å¿ƒä¸šåŠ¡ã€æ•°æ®å¤„ç†æ–¹å¼ã€ç®¡ç†åº”ç”¨å±‚æ¬¡ã€è¡Œä¸šå’Œä¸šåŠ¡èŒèƒ½4ä¸ªæ–¹é¢ã€‚ æŒ‰æ ¸å¿ƒä¸šåŠ¡æ´»åŠ¨åˆ†ç±» å¤©çŒ«å•†åŸï¼ˆwww.tmall.comï¼‰æ˜¯ä¸€ç§å…¸å‹çš„ï¼ˆBï¼‰ A B2Bç³»ç»Ÿ B B2Cç³»ç»Ÿ C C2Cç³»ç»Ÿ D B2Gç³»ç»Ÿ ä»¥ä¸‹ä¿¡æ¯ç³»ç»Ÿå±äºç”µå­å•†åŠ¡ç³»ç»Ÿçš„æ˜¯ï¼ˆBï¼‰ A ç§‘æŠ€ç®¡ç†ç³»ç»Ÿ B ç½‘ä¸Šè´­ç‰©ç³»ç»Ÿ C ä¼šè®¡ä¿¡æ¯ç³»ç»Ÿ D å¸‚åœºç›‘ç®¡ç³»ç»Ÿ ä»¥ä¸‹ç³»ç»Ÿå±äºç”µå­ä¸šåŠ¡ç³»ç»Ÿçš„æ˜¯ï¼ˆDï¼‰ A ç»æµç®¡ç†ç³»ç»Ÿ B å¸‚åœºç›‘ç®¡ç³»ç»Ÿ C ç¤¾ä¼šç®¡ç†ç³»ç»Ÿ D ä¼šè®¡ä¿¡æ¯ç³»ç»Ÿ ä¿¡æ¯ç³»ç»ŸæŒ‰æ ¸å¿ƒä¸šåŠ¡å¯åˆ†æˆè‹¥å¹²ç±»å‹ï¼Œå…¶ä¸­å¸‚åœºç›‘ç®¡ç³»ç»Ÿå±äºï¼ˆDï¼‰ A ç”µå­ä¸šåŠ¡ç³»ç»Ÿ B ç”µå­è´¢åŠ¡ç³»ç»Ÿ C ç”µå­å•†åŠ¡ç³»ç»Ÿ D ç”µå­æ”¿åŠ¡ç³»ç»Ÿ ä»¥ä¸‹ä¿¡æ¯ç³»ç»Ÿå±äºç”µå­æ”¿åŠ¡ç³»ç»Ÿçš„æ˜¯ï¼ˆDï¼‰ A å­¦ç±ç®¡ç†ç³»ç»Ÿ B åˆ¶é€ ç®¡ç†ç³»ç»Ÿ C æ•™åŠ¡ç®¡ç†ç³»ç»Ÿ D ç»æµç®¡ç†ç³»ç»Ÿ ä¸‹åˆ—ä¿¡æ¯ç³»ç»Ÿä¸å±äºç”µå­æ”¿åŠ¡ç³»ç»Ÿçš„æ˜¯ï¼ˆDï¼‰ A å®è§‚ç»æµç®¡ç†ç³»ç»Ÿ B ç¤¾ä¼šæ²»å®‰ç®¡ç†ç³»ç»Ÿ C å¸‚åœºç›‘ç£ç®¡ç†ç³»ç»Ÿ D ä¼ä¸šè´¢åŠ¡ç®¡ç†ç³»ç»Ÿ ä¸‹åˆ—ä¿¡æ¯ç³»ç»Ÿå±äºç”µå­æ”¿åŠ¡ç³»ç»Ÿçš„æ˜¯ï¼ˆDï¼‰ A å­¦æ ¡æ•™åŠ¡ç®¡ç†ç³»ç»Ÿ B ä¼ä¸šç”Ÿäº§ç®¡ç†ç³»ç»Ÿ C é«˜æ ¡ç§‘æŠ€ç®¡ç†ç³»ç»Ÿ D å…¬å…±å®‰å…¨ç®¡ç†ç³»ç»Ÿ ä»¥ä¸‹ä¿¡æ¯ç³»ç»Ÿå±äºç”µå­æ”¿åŠ¡ç³»ç»Ÿçš„æ˜¯ï¼ˆAï¼‰ A æˆ·ç±ç®¡ç†ç³»ç»Ÿ B å­¦ç±ç®¡ç†ç³»ç»Ÿ C ç”Ÿäº§ç®¡ç†ç³»ç»Ÿ D åŒ»é™¢ç®¡ç†ç³»ç»Ÿ ä»¥ä¸‹å±äºç”µå­å•†åŠ¡ç³»ç»Ÿçš„æ˜¯ï¼ˆBï¼‰ A ç§‘æŠ€ç®¡ç†ç³»ç»Ÿ B ç½‘ä¸Šè´­ç‰©ç³»ç»Ÿ C ä¼šè®¡ä¿¡æ¯ç³»ç»Ÿ D å¸‚åœºç›‘ç®¡ç³»ç»Ÿ é¡¾å®¢åœ¨ç½‘ä¸Šä¹¦åº—ä¹°ä¹¦ï¼Œè¿™ç§æ¨¡å¼å±äºç”µå­å•†åŠ¡ç³»ç»Ÿçš„ï¼ˆBï¼‰ A B2B B B2C C C2C D B2G æŒ‰æ ¸å¿ƒä¸šåŠ¡æ´»åŠ¨åˆ†ç±»ï¼Œä¸‹åˆ—ä¸å±äºç”µå­ä¸šåŠ¡ç³»ç»Ÿçš„æ˜¯ï¼ˆBï¼‰ A äººåŠ›èµ„æºç®¡ç†ç³»ç»Ÿ B ç»æµç®¡ç†ç³»ç»Ÿ C å­¦ç±ç®¡ç†ç³»ç»Ÿ D æ•™åŠ¡ç®¡ç†ç³»ç»Ÿ æŒ‰æ ¸å¿ƒä¸šåŠ¡æ´»åŠ¨åˆ†ç±»ï¼Œä¸»è¦é’ˆå¯¹ä¼äº‹ä¸šå•ä½çš„å…·ä½“ä¸šåŠ¡è¿‡ç¨‹å»ºç«‹çš„ç³»ç»Ÿæ˜¯æŒ‡ï¼ˆAï¼‰ A ç”µå­ä¸šåŠ¡ B ç”µå­æ”¿åŠ¡ C ç”µå­å•†åŠ¡ D ç”µå­è´¸æ˜“ ä¸‹åˆ—é€‰é¡¹ä¸­ï¼Œå±äºç”µå­æ”¿åŠ¡ç³»ç»Ÿçš„æ˜¯ï¼ˆAï¼‰ A ç¤¾ä¼šç®¡ç†ç³»ç»Ÿ B é“è·¯å®¢ç¥¨ç³»ç»Ÿ C å­¦ç±ç®¡ç†ç³»ç»Ÿ D ç§‘æŠ€ç®¡ç†ç³»ç»Ÿ ä»¥ä¸‹ä¿¡æ¯ç³»ç»Ÿå±äºç”µå­æ”¿åŠ¡ç³»ç»Ÿçš„æ˜¯ï¼ˆCï¼‰ A é“è·¯å®¢ç¥¨ç³»ç»Ÿ B é«˜æ ¡æ•™åŠ¡ç³»ç»Ÿ C å¸‚åœºç›‘ç®¡ç³»ç»Ÿ D å­¦ç±ç®¡ç†ç³»ç»Ÿ ä»¥ä¸‹ä¿¡æ¯ç³»ç»Ÿå±äºç”µå­æ”¿åŠ¡ç³»ç»Ÿçš„æ˜¯ï¼ˆCï¼‰ A é“è·¯å®¢ç¥¨ç³»ç»Ÿ B é«˜æ ¡æ•™åŠ¡ç³»ç»Ÿ C å¸‚åœºç›‘ç®¡ç³»ç»Ÿ D ä¼ä¸šè®¡åˆ’ç³»ç»Ÿ ä»¥ä¸‹å±äºç”µå­æ”¿åŠ¡ç³»ç»Ÿçš„æ˜¯ï¼ˆAï¼‰ A ç¤¾ä¼šç®¡ç†ç³»ç»Ÿ B ç§‘æŠ€ç®¡ç†ç³»ç»Ÿ C æ•™åŠ¡ç®¡ç†ç³»ç»Ÿ D å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ é“è·¯å®¢ç¥¨ç³»ç»Ÿå±äºç”µå­å•†åŠ¡ç³»ç»Ÿï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ æ·˜å®ç½‘æ˜¯ä¸€ç§ç”µå­ä¸šåŠ¡ç³»ç»Ÿï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ æŒ‰æ ¸å¿ƒä¸šåŠ¡æ´»åŠ¨åˆ†ç±»ï¼Œä¸€èˆ¬æ‰€è¯´çš„ç®¡ç†ä¿¡å¿ƒç³»ç»Ÿéƒ½æ˜¯æŒ‡ç”µå­ä¸šåŠ¡ç³»ç»Ÿã€‚ æŒ‰æ ¸å‹ä¸šåŠ¡æ´»åŠ¨åˆ†ç±»ï¼Œç§‘æŠ€ç®¡ç†ç³»ç»Ÿå±äºç”µå­ä¸šåŠ¡ç³»ç»Ÿã€‚ é€šå¸¸ä»¥ç½‘ç«™å½¢å¼å‡ºç°çš„ç³»ç»Ÿæ˜¯ç”µå­å•†åŠ¡ç³»ç»Ÿã€‚ å¯¹ç”¨æˆ·è€Œè¨€ï¼Œç”µå­å•†åŠ¡ç³»ç»Ÿé€šå¸¸ä»¥ç½‘ç«™çš„å½¢å¼å‡ºç°çš„ã€‚ ç”µå­å•†åŠ¡ç³»ç»Ÿä¸»è¦ä¾æ‰˜äºInternetï¼Œå¯å®ç°ç½‘ä¸Šè´­ç‰©ç­‰æ´»åŠ¨ã€‚ æŒ‰å•†åŠ¡æ´»åŠ¨å‚ä¸ä¸»ä½“ã€ç”µå­å•†åŠ¡ç³»ç»Ÿåˆ’åˆ†çš„æ¨¡å¼åŒ…æ‹¬ï¼šB2Bã€B2Cã€C2Cã€B2Gã€‚ æŒ‰æ ¸å¿ƒä¸šåŠ¡æ´»åŠ¨åˆ†ç±»ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»ŸåŒ…æ‹¬ç”µå­ä¸šåŠ¡ç³»ç»Ÿã€ç”µå­æ”¿åŠ¡ç³»ç»Ÿå’Œç”µå­å•†åŠ¡ç³»ç»Ÿã€‚ å…³äºç”µå­æ”¿åŠ¡ç³»ç»Ÿï¼Œç®€è¿°æ”¿åºœçš„ä¸»è¦èŒèƒ½æ˜¯ä»€ä¹ˆã€‚ æ”¿åºœçš„ä¸»è¦èŒèƒ½åŒ…æ‹¬ç»æµç®¡ç†ã€å¸‚åœºç›‘æ§ã€ç¤¾ä¼šç®¡ç†çš„å…¬å…±æœåŠ¡ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»ŸæŒ‰æ ¸å¿ƒä¸šåŠ¡æ´»åŠ¨æœ‰å“ªäº›åˆ†ç±»ã€‚ ç”µå­ä¸šåŠ¡ç³»ç»Ÿã€ç”µå­æ”¿åŠ¡ç³»ç»Ÿã€ç”µå­å•†åŠ¡ç³»ç»Ÿã€‚ ç®€è¿°ç”µå­æ”¿åŠ¡çš„çªå‡ºç‰¹ç‚¹ã€‚ ä½¿æ”¿åºœå·¥ä½œæ›´æœ‰æ•ˆã€æ›´ç²¾ç®€ï¼› ä½¿æ”¿åºœå·¥ä½œæ›´å…¬å¼€ã€æ›´é€æ˜ï¼› ä¸ºä¼ä¸šå’Œå±…æ°‘æä¾›æ›´å¥½çš„æœåŠ¡ï¼› é‡æ–°æ„é€ æ”¿åºœã€ä¼ä¸šã€å±…æ°‘ä¹‹é—´çš„å…³ç³»ï¼Œä½¿ä¹‹æ¯”ä»¥å‰æ›´åŠ åè°ƒï¼Œä½¿ä¼ä¸šå’Œå±…æ°‘èƒ½å¤Ÿæ›´å¥½çš„å‚ä¸æ”¿åºœçš„ç®¡ç†ã€‚ ç®€è¿°æŒ‰å•†åŠ¡æ´»åŠ¨å‚ä¸ä¸»ä½“ï¼Œç”µå­å•†åŠ¡ç³»ç»Ÿçš„åˆ’åˆ†æ¨¡å¼ã€‚ æŒ‰å•†åŠ¡æ´»åŠ¨å‚ä¸ä¸»ä½“ï¼Œç”µå­å•†åŠ¡ç³»ç»Ÿçš„åˆ’åˆ†ä¸ºä¼ä¸šå¯¹ä¼ä¸šã€ä¼ä¸šå¯¹æ¶ˆè´¹è€…ã€æ¶ˆè´¹è€…å¯¹æ¶ˆè´¹è€…ã€ä¼ä¸šå¯¹æ”¿åºœç­‰è‹¥å¹²æ¨¡å¼ï¼Œåˆ†åˆ«ç®€ç§°ä¸ºB2Bã€B2Cã€C2Cã€B2Gã€‚ æŒ‰æ•°æ®å¤„ç†æ–¹å¼åˆ†ç±» ä¸‹åˆ—ä¿¡æ¯ç³»ç»Ÿå±äºåˆ†æå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ˜¯ï¼ˆBï¼‰ A å·¥èµ„å‘æ”¾ç³»ç»Ÿ B äººåŠ›èµ„æºç®¡ç†ç³»ç»Ÿ C ä¼šè®¡è®°è´¦ç³»ç»Ÿ D äººäº‹æ¡£æ¡ˆç®¡ç†ç³»ç»Ÿ ä¸‹åˆ—å±äºåˆ†æå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ˜¯ï¼ˆAï¼‰ A å†³ç­–æ”¯æŒç³»ç»Ÿ B äººäº‹æ¡£æ¡ˆç®¡ç†ç³»ç»Ÿ C å·¥èµ„å‘æ”¾ç³»ç»Ÿ D æ•°æ®é‡‡é›†å½•å…¥ç³»ç»Ÿ ç›®å‰ï¼Œå•ç‹¬çš„æ“ä½œå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå·²æ¯”è¾ƒå°‘è§ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ æŒ‰æ•°æ®å¤„ç†æ–¹å¼åˆ†ç±»ï¼Œå¯åˆ†ä¸ºæ“ä½œå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå’Œåˆ†æå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ åœ¨ä¿¡æ¯åŒ–çš„åˆå§‹é˜¶æ®µï¼Œä¼ä¸šæ‰€å»ºç«‹çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¤šæ•°å±äºæ“ä½œæ€§ã€‚ é¢å‘é‚£äº›éœ€è¦è¿›è¡Œè¶‹åŠ¿åˆ†æã€é¢„æµ‹ç­‰ç®¡ç†å†³ç­–éœ€æ±‚è€Œå»ºç«‹çš„æ˜¯åˆ†æå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ æŒ‰æ•°æ®å¤„ç†æ–¹å¼åˆ†ç±»ï¼Œæ“ä½œå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸€èˆ¬æ˜¯é¢å‘å…·ä½“çš„ç®¡ç†ä¸šåŠ¡è€Œå»ºç«‹çš„ï¼ŒåŠŸèƒ½æ¯”è¾ƒç®€å•ã€‚ æŒ‰æ•°æ®å¤„ç†æ–¹å¼åˆ†ç±»ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»ŸåŒ…æ‹¬æ“ä½œå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå’Œåˆ†æå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ äººä»¬å¾€å¾€å°†æ“ä½œå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸åˆ†æå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿåˆå¹¶åœ¨ä¸€èµ·ï¼Œå…±åŒç»„ç»‡ä¸€ä¸ªå®Œæ•´çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ å®Œæ•´çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸€èˆ¬åŒ…æ‹¬æ“ä½œå‹å’Œåˆ†æå‹ä¸¤ç±»å­ç³»ç»Ÿã€‚ ä¸€äº›ä¸“é—¨çš„åˆ†æå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæœ‰æ—¶ä¼šå€ŸåŠ©æ•°æ®ä»“åº“ï¼ˆDWï¼‰æˆ–å†³ç­–æ”¯æŒç³»ç»Ÿï¼ˆDSSï¼‰ç­‰æŠ€æœ¯ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»ŸæŒ‰æ•°æ®å¤„ç†æ–¹å¼åˆ†ç±»ï¼Œå¯åˆ†ä¸ºæ“ä½œå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå’Œåˆ†æå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ åè¯è§£é‡Šï¼šæ“ä½œå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ ä¸»è¦æ˜¯é¢å‘å…·ä½“çš„ä¸šåŠ¡è€Œå»ºç«‹ï¼ŒåŠŸèƒ½ç®€å•ï¼Œä¸»è¦åŒ…æ‹¬æ•°æ®å½•å…¥ã€ä¿®æ”¹ã€åˆ é™¤ã€æ‰“å°ã€æŸ¥æ‰¾å’Œç®€å•çš„æ•°æ®æ±‡æ€»è®¡ç®—ç­‰ã€‚ åè¯è§£é‡Šï¼šåˆ†æå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ ä¸»è¦é¢å‘é‚£äº›éœ€è¦è¶‹åŠ¿åˆ†æã€é¢„æµ‹ç­‰ç®¡ç†å†³ç­–éœ€æ±‚è€Œå»ºç«‹çš„ï¼Œéœ€è¦åŸºäºæ“ä½œå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘ï¼Œä¸€äº›åˆ†æå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæœ‰æ—¶éœ€è¦å€ŸåŠ©æ•°æ®ä»“åº“ï¼ˆDWï¼‰æˆ–å†³ç­–æ”¯æŒç³»ç»Ÿï¼ˆDSSï¼‰ç­‰ã€‚ æŒ‰ç®¡ç†åº”ç”¨å±‚æ¬¡ ä½¿ç»„ç»‡çš„ä¸­å±‚ç®¡ç†äººå‘˜é€šè¿‡å›ºå®šæ ¼å¼çš„æŠ¥è¡¨ã€æŠ¥å‘Šå’Œç»¼åˆæŸ¥è¯¢ã€ç»Ÿè®¡åˆ†æï¼Œäº†è§£å’Œç›‘è§†ç®¡ç†é¢†åŸŸçš„è¿è¡ŒçŠ¶å†µï¼ŒæŒ‡çš„æ˜¯ï¼ˆAï¼‰ A ç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ B äº‹åŠ¡å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ C æˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ D å†³ç­–å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ ä»¥ä¸‹ä¿¡æ¯å±äºæˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ˜¯ï¼ˆDï¼‰ A ç»¼åˆæŸ¥è¯¢ç³»ç»Ÿ B ç»Ÿè®¡åˆ†æç³»ç»Ÿ C æŠ¥è¡¨æŠ¥å‘Šç³»ç»Ÿ D åˆ¶å®šè®¡åˆ’ç³»ç»Ÿ æŒ‰ç®¡ç†åº”ç”¨å±‚æ¬¡åˆ†ç±»ï¼ŒæœåŠ¡äºç»„ç»‡çš„åŸºå±‚ç®¡ç†è€…ï¼Œä»¥å…·ä½“çš„ä¸šåŠ¡è¿‡ç¨‹çš„è‡ªåŠ¨åŒ–ä¸ºç›®çš„æŒ‡çš„æ˜¯ï¼ˆAï¼‰ A å®ç‰©å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ B ç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ C æˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ D ç»„ç»‡å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ æŒ‰ç®¡ç†åº”ç”¨å±‚æ¬¡åˆ†ç±»ï¼Œä¸ºæˆ˜ç•¥è®¡åˆ’çš„åˆ¶å®šå’Œè°ƒæ•´æä¾›è¾…åŠ©å†³ç­–åŠŸèƒ½çš„æ˜¯ï¼ˆBï¼‰ A å®ç‰©å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ B æˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ C ç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ D æ“ä½œå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ ç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸»è¦æœåŠ¡äºç»„ç»‡çš„åŸºå±‚ç®¡ç†è€…ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ æˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ‰€éœ€è¦çš„æ•°æ®ä¸€èˆ¬æ¥æºå®ç‰©å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå’Œç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿï¼Œè¿˜æœ‰ä¸€äº›æ¥è‡ªä¼ä¸šå¤–éƒ¨ï¼Œå…¶ä¸­å¤–éƒ¨æ•°æ®æ‰€å æ¯”ä¾‹è¾ƒå¤§ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ ç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ä¸»è¦ç›®çš„æ˜¯ä½¿ç»„ç»‡çš„ä¸­å±‚ç®¡ç†äººå‘˜é€šè¿‡å›ºå®šæ ¼å¼çš„æŠ¥è¡¨ã€æŠ¥å‘Šå’Œç»¼åˆæŸ¥è¯¢ã€ç»Ÿè®¡æŸ¥è¯¢ï¼Œäº†è§£å’Œç›‘è§†ç®¡ç†é¢†åŸŸçš„è¿è¡Œæƒ…å†µã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ æˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸»è¦æœåŠ¡äºç»„ç»‡çš„é«˜å±‚ç®¡ç†è€…ã€‚ åœ¨ç®¡ç†åº”ç”¨å±‚æ¬¡çš„åˆ†ç±»ä¸‹ï¼Œä¸»è¦æœåŠ¡äºç»„ç»‡çš„åŸºå±‚ç®¡ç†è€…çš„æ˜¯äº‹ç‰©å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ åœ¨ç®¡ç†åº”ç”¨å±‚æ¬¡çš„åˆ†ç±»ä¸‹ï¼ŒæœåŠ¡äºä¸­å±‚ç®¡ç†è€…çš„æ˜¯ç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ æˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸»è¦æœåŠ¡äºç»„ç»‡çš„é«˜å±‚ç®¡ç†è€…ã€‚ æˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºæˆ˜ç•¥çš„åˆ¶å®šå’Œè°ƒæ•´æä¾›è¾…åŠ©çš„å†³ç­–åŠŸèƒ½ã€‚ æˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ•°æ®ä¸€èˆ¬æ¥æºäºäº‹åŠ¡å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå’Œç®¡ç†å‹ç®¡ç†å‹ä¿¡æ¯ç³»ç»Ÿï¼Œå¤–éƒ¨æ•°æ®æ‰€åœ¨çš„æ¯”ä¾‹è¾ƒå¤§ã€‚ ç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åˆ†ç±»æ–¹å¼æ˜¯æŒ‰ç®¡ç†åº”ç”¨å±‚æ¬¡è¿›è¡Œåˆ’åˆ†çš„ã€‚ äº‹åŠ¡å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ä¸»è¦ç›®çš„æ˜¯å…·ä½“ä¸šåŠ¡è¿‡ç¨‹çš„è‡ªåŠ¨åŒ–ã€‚ æŒ‰ç®¡ç†åº”ç”¨å±‚æ¬¡è¿›è¡Œåˆ†ç±»åŒ…æ‹¬ï¼šäº‹åŠ¡å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€ç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå’Œæˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ ç®€è¿°ç®¡ç†æ§åˆ¶å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ ç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸»è¦æœåŠ¡äºç»„ç»‡çš„ä¸­å±‚ç®¡ç†è€…ï¼Œæä¾›ç»¼åˆæŸ¥è¯¢ã€ç»Ÿè®¡åˆ†æå’ŒæŠ¥è¡¨ã€æŠ¥å‘Šç­‰åŠŸèƒ½ï¼Œè®¾è®¡å¤šé¡¹ä¸šåŠ¡çš„ç»¼åˆç®¡ç†ã€‚ä¸»è¦ç›®çš„æ˜¯ä½¿ç»„ç»‡çš„ä¸­å±‚ç®¡ç†äººå‘˜é€šè¿‡å›ºå®šæ ¼å¼çš„æŠ¥è¡¨ã€æŠ¥å‘Šå’Œç»¼åˆæŸ¥è¯¢ã€ç»Ÿè®¡åˆ†æï¼Œäº†è§£ç›‘è§†ç®¡ç†é¢†åŸŸçš„è¿è¡Œæƒ…å†µã€‚ ç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ä¸»è¦ç›®çš„ã€‚ ç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ä¸»è¦ç›®çš„æ˜¯ä½¿ç»„ç»‡çš„ä¸­å±‚ç®¡ç†äººå‘˜é€šè¿‡å›ºå®šæ ¼å¼çš„æŠ¥è¡¨ã€æŠ¥å‘Šå’Œç»¼åˆæŸ¥è¯¢ã€ç»Ÿè®¡åˆ†æï¼Œäº†è§£å’Œç›‘è§†ç®¡ç†é¢†åŸŸçš„è¿è¡Œæƒ…å†µã€‚ åè¯è§£é‡Šï¼šäº‹åŠ¡å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ äº‹åŠ¡å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯æŒ‰ç®¡ç†åº”ç”¨å±‚æ¬¡åˆ†ç±»çš„ä¸€ç§ï¼Œä¸»è¦æœåŠ¡äºç»„ç»‡çš„åŸºå±‚ç®¡ç†è€…ï¼Œä¸»è¦ç›®çš„æ˜¯å…·ä½“ä¸šåŠ¡è¿‡ç¨‹çš„è‡ªåŠ¨åŒ–ã€‚ ç®€è¿°äº‹åŠ¡å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ¦‚å¿µã€‚ äº‹åŠ¡å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸»è¦æœåŠ¡äºç»„ç»‡çš„åŸºå±‚ç®¡ç†è€…ï¼Œä¸»è¦ç›®çš„æ˜¯å…·ä½“ä¸šåŠ¡è¿‡ç¨‹çš„è‡ªåŠ¨åŒ–ï¼Œä¸€èˆ¬æ“ä½œå‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¤§å¤šæ•°å±äºäº‹åŠ¡å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ åè¯è§£é‡Šï¼šæˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ æˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸»è¦æœåŠ¡äºç»„ç»‡çš„é«˜å±‚ç®¡ç†è€…ï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºæˆ˜ç•¥çš„åˆ¶å®šå’Œè°ƒæ•´æä¾›è¾…åŠ©çš„å†³ç­–åŠŸèƒ½ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»ŸæŒ‰åº”ç”¨å±‚æ¬¡çš„åˆ†ç±»ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»ŸæŒ‰åº”ç”¨å±‚æ¬¡åˆ†ç±»åŒ…æ‹¬ï¼šäº‹åŠ¡å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€ç®¡ç†å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå’Œæˆ˜ç•¥å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ æŒ‰è¡Œä¸šå’Œä¸šåŠ¡èŒèƒ½åˆ†ç±» å°†ç®¡ç†ä¿¡æ¯ç³»ç»Ÿåˆ’åˆ†ä¸ºé“è·¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€æ—ä¸šç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€ç”µåŠ›ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åˆ’åˆ†æ–¹å¼æ˜¯ï¼ˆAï¼‰ A æŒ‰è¡Œä¸šæˆ–éƒ¨é—¨ B æŒ‰ä¸šåŠ¡èŒèƒ½ C æŒ‰ç®¡ç†åº”ç”¨å±‚æ¬¡ D æŒ‰æ•°æ®çš„å¤„ç†æ–¹å¼ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åˆ†ç±»æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚æŒ‰è¡Œä¸šæˆ–éƒ¨é—¨å¯ä»¥åˆ’åˆ†ä¸ºé“è·¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€æ—ä¸šç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€ç”µåŠ›ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚å¯¹äºæŸä¸ªå…·ä½“çš„è¡Œä¸šæˆ–éƒ¨é—¨ï¼Œåˆå¯ä»¥æŒ‰ä¸šåŠ¡èŒèƒ½åˆ’åˆ†ä¸ºè‹¥å¹²ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸€ç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¯¼è®º/ç¬¬ä¸‰èŠ‚_ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç»“æ„.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸€ç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¯¼è®º/ç¬¬ä¸‰èŠ‚_ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç»“æ„.html","title":"ç¬¬ä¸‰èŠ‚ï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç»“æ„","keywords":"","body":"ç¬¬ä¸‰èŠ‚ï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç»“æ„ åŠŸèƒ½ç»“æ„ è¦è®¾è®¡å‡ºä¸€ä¸ªé«˜è´¨é‡çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿï¼Œå°±å¿…é¡»å…ˆäº†è§£å®ƒçš„ç»“æ„ï¼Œä»ä½¿ç”¨è€…çš„è§’åº¦ä¸Šçœ‹ï¼Œä»»ä½•ä¸€ä¸ªç®¡ç†ä¿¡æ¯ç³»ç»Ÿå…·æœ‰æ˜ç¡®çš„ç›®æ ‡ï¼Œï¼Œå¹¶ç”±è‹¥å¹²å…·ä½“åŠŸèƒ½ç»„æˆã€‚ä¸ºå®Œæˆè¿™ä¸ªç›®æ ‡ï¼Œå„åŠŸèƒ½ç›¸äº’è”ç³»ï¼Œæ„æˆäº†ä¸€ä¸ªæœ‰æœºç»„åˆçš„æ•´ä½“ï¼Œè¡¨ç°å‡ºç³»ç»Ÿçš„ç‰¹å¾ï¼ŒæŒ‡çš„æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ï¼ˆAï¼‰ A åŠŸèƒ½ç»“æ„ B æ¦‚å¿µç»“æ„ C èŒèƒ½ç»“æ„ D è½¯ç¡¬ä»¶ç»“æ„ ä»ä½¿ç”¨è€…è§’åº¦çœ‹ï¼Œä»»ä½•ä¸€ä¸ªç®¡ç†ä¿¡æ¯ç³»ç»Ÿå‡æœ‰æ˜ç¡®çš„ç›®æ ‡ï¼Œå¹¶ç”±è‹¥å¹²å…·ä½“åŠŸèƒ½ç»„æˆã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ è¦è®¾è®¡å‡ºä¸€ä¸ªé«˜è´¨é‡çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿï¼Œå°±å¿…é¡»å…ˆäº†è§£å®ƒçš„ç»“æ„ã€‚ ä¸ºå®Œæˆç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç›®æ ‡ï¼Œå„åŠŸèƒ½ç›¸äº’è”ç³»ï¼Œæ„æˆäº†ä¸€ä¸ªæœ‰æœºç»„åˆçš„æ•´ä½“ï¼Œè¡¨ç°å‡ºç³»ç»Ÿçš„ç‰¹å¾ï¼ŒæŒ‡çš„æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŠŸèƒ½ç»“æ„ã€‚ åè¯è§£é‡Šï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŠŸèƒ½ç»“æ„ã€‚ è¦è®¾è®¡å‡ºä¸€ä¸ªé«˜è´¨é‡çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿï¼Œå°±å¿…é¡»å…ˆäº†è§£å®ƒçš„æœºæ„ï¼Œä»ä½¿ç”¨è€…çš„è§’åº¦çœ‹ï¼Œä»»ä½•ä¸€ä¸ªç®¡ç†ä¿¡æ¯ç³»ç»Ÿå‡æœ‰æ˜ç¡®çš„ç›®æ ‡ï¼Œå¹¶ç”±è‹¥å¹²å…·ä½“åŠŸèƒ½ç»„æˆï¼Œä¸ºå®Œæˆè¿™ä¸ªç›®æ ‡ï¼Œå„åŠŸèƒ½ç›¸äº’è”ç³»ï¼Œæ„æˆäº†ä¸€ä¸ªæœ‰æœºç»„åˆçš„æ•´ä½“ï¼Œè¡¨ç°å‡ºçš„ç³»ç»Ÿç‰¹å¾ï¼ŒæŒ‡çš„æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŠŸèƒ½ç»“æ„ã€‚ åè¯è§£é‡Šï¼šç³»ç»Ÿçš„ç»“æ„ã€‚ â€œç»“æ„â€æŒ‡ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå„éƒ¨ä»¶çš„æ„æˆæ¡†æ¶ï¼Œç”±äºå¯¹è¿™äº›éƒ¨ä»¶çš„ä¸åŒç†è§£ï¼Œå°±æ„æˆäº†ä¸åŒçš„ç»“æ„æ–¹å¼ã€‚ ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŠŸèƒ½ç»“æ„ã€‚ è¦è®¾è®¡å‡ºä¸€ä¸ªé«˜è´¨é‡çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿï¼Œå°±å¿…é¡»å…ˆäº†è§£å®ƒçš„ç»“æ„ï¼Œä»ä½¿ç”¨è€…çš„è§’åº¦çœ‹ï¼Œä»»ä½•ä¸€ä¸ªç®¡ç†ä¿¡æ¯ç³»ç»Ÿå‡æœ‰æ˜ç¡®çš„ç›®æ ‡ï¼Œå¹¶ç”±è‹¥å¹²å…·ä½“åŠŸèƒ½ç»„æˆï¼Œä¸ºå®Œæˆè¿™ä¸ªç›®æ ‡ï¼Œå„åŠŸèƒ½äº’ç›¸è”ç³»ï¼Œæ„æˆäº†ä¸€ä¸ªæœ‰æœºç»„åˆçš„æ•´ä½“ï¼Œè¡¨ç°å‡ºçš„ç³»ç»Ÿç‰¹å¾ï¼Œè¿™å°±æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŠŸèƒ½æœºæ„ã€‚ æ¦‚å¿µç»“æ„ ä¸åŒ…å«åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ¦‚å¿µç»“æ„ä¸­çš„è¦ç´ æ˜¯ï¼ˆBï¼‰ A ä¿¡æ¯ç®¡ç†è€… B ç³»ç»Ÿå¼€å‘è€… C ä¿¡æ¯å¤„ç†å™¨ D ç³»ç»Ÿä½¿ç”¨è€… ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ¦‚å¿µç»“æ„ç”±ä¿¡æ¯æºã€ä¿¡æ¯å¤„ç†å™¨ã€ä¿¡æ¯ç”¨æˆ·å’Œä¿¡æ¯ç®¡ç†è€…ç»„æˆã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å››ä¸ªéƒ¨ä»¶æ˜¯ä¿¡æ¯æºã€ä¿¡æ¯å¤„ç†å™¨ã€ä¿¡æ¯ç”¨æˆ·å’Œä¿¡æ¯ç®¡ç†è€…ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå››å¤§éƒ¨ä»¶ä¸­ï¼Œä¿¡æ¯æºæ˜¯ä¿¡æ¯äº§ç”Ÿåœ°ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå››å¤§éƒ¨ä»¶ä¸­ï¼Œä¿¡æ¯å¤„ç†å™¨æ‹…è´Ÿç€ä¿¡æ¯çš„ä¼ è¾“ã€åŠ å·¥å’Œå­˜å‚¨ç­‰ä»»åŠ¡ã€‚ ä»æ¦‚å¿µç»“æ„ä¸Šï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿç”±ä¿¡æ¯æºã€ä¿¡æ¯å¤„ç†å™¨ã€ä¿¡æ¯ç”¨æˆ·å’Œä¿¡æ¯ç®¡ç†è€…ç­‰å››ä¸ªéƒ¨ä»¶ç»„æˆã€‚ ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ¦‚å¿µç»“æ„ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŠŸèƒ½ç»“æ„åæ˜ äº†ç®¡ç†çš„ä¸šåŠ¡èŒèƒ½ï¼Œæ¯”è¾ƒç›´è§‚ï¼Œæ˜“äºç†è§£ã€‚å¦‚æœå„ä¸ªç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŠŸèƒ½ç»“æ„è¿›è¡ŒæŠ½è±¡ï¼Œä¼šå‘ç°æ‰€æœ‰çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå‡æ˜¯ç”±ä¿¡æ¯æºã€ä¿¡æ¯å¤„ç†å™¨ã€ä¿¡æ¯ç”¨æˆ·å’Œä¿¡æ¯ç®¡ç†è€…å››ä¸ªéƒ¨ä»¶ç»„æˆï¼Œè¿™å°±æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ¦‚å¿µç»“æ„ã€‚ ç»„æˆç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å››å¤§éƒ¨ä»¶ æ‰€æœ‰çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå‡ç”±ä¿¡æ¯æºã€ä¿¡æ¯å¤„ç†å™¨ã€ä¿¡æ¯ç”¨æˆ·å’Œä¿¡æ¯ç®¡ç†è€…å››å¤§éƒ¨ä»¶ç»„æˆã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ¦‚å¿µç»“æ„åŒ…æ‹¬å“ªå‡ ä¸ªéƒ¨åˆ†ï¼Ÿå„è‡ªçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ¦‚å¿µç»“æ„ç”±å››ä¸ªéƒ¨ä»¶ç»„æˆï¼šä¿¡æ¯æºã€ä¿¡æ¯å¤„ç†å™¨ã€ä¿¡æ¯ç”¨æˆ·å’Œä¿¡æ¯ç®¡ç†è€…ã€‚ ä¿¡æ¯æºæ˜¯ä¿¡æ¯çš„äº§ç”Ÿåœ°ã€‚ ä¿¡æ¯å¤„ç†å™¨æ‹…è´Ÿç€ä¿¡æ¯çš„ä¼ è¾“ã€åŠ å·¥å’Œå­˜å‚¨ç­‰ä»»åŠ¡ã€‚ ä¿¡æ¯ç”¨æˆ·æ˜¯ä¿¡æ¯çš„æœ€ç»ˆä½¿ç”¨è€…ï¼Œä»–ä»¬åº”ç”¨ä¿¡æ¯è¿›è¡Œç®¡ç†å†³ç­–ã€‚ ä¿¡æ¯ç®¡ç†è€…è´Ÿè´£ä¿¡æ¯ç³»ç»Ÿçš„è®¾è®¡ã€å®æ–½å’Œç»´æŠ¤ç­‰å·¥ä½œã€‚ ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå››å¤§éƒ¨ä»¶çš„ä¸»è¦ä½œç”¨ã€‚ ä¿¡æ¯æºæ˜¯ä¿¡æ¯çš„äº§ç”Ÿåœ°ã€‚ ä¿¡æ¯å¤„ç†å™¨æ‹…è´Ÿç€ä¿¡æ¯çš„ä¼ è¾“ã€åŠ å·¥å’Œå­˜å‚¨ç­‰ä»»åŠ¡ã€‚ ä¿¡æ¯ç”¨æˆ·æ˜¯ä¿¡æ¯çš„æœ€ç»ˆä½¿ç”¨è€…ï¼Œä»–ä»¬åº”ç”¨ä¿¡æ¯è¿›è¡Œç®¡ç†å†³ç­–ã€‚ ä¿¡æ¯ç®¡ç†è€…è´Ÿè´£ä¿¡æ¯ç³»ç»Ÿçš„è®¾è®¡ï¼Œå®æ–½å’Œç»´æŠ¤ç­‰å·¥ä½œã€‚ ç®¡ç†èŒèƒ½ç»“æ„ ä¼ä¸šä¸­çš„ç®¡ç†æ´»åŠ¨å®é™…æƒ…å†µæ˜¯çºµã€æ¨ªäº¤å‰å½¢æˆå®Œæ•´çš„ç®¡ç†æ´»åŠ¨ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ æ¨ªå‘çœ‹ä¸€ä¸ªç»„ç»‡ï¼Œç®¡ç†æ´»åŠ¨æ˜¯æŒ‰èŒèƒ½æ’åˆ—çš„ã€‚ ä»çºµå‘è§†é‡åˆ†æï¼Œç®¡ç†æ´»åŠ¨çš„é«˜ã€ä¸­ã€ä½ä¸‰ä¸ªå±‚æ¬¡åˆ†åˆ«å¯¹åº”æˆ˜ç•¥è®¡åˆ’å±‚ã€ç®¡ç†æ§åˆ¶å±‚ã€æ‰§è¡Œæ§åˆ¶å±‚ã€‚ æ”¯æŒæ‰§è¡Œæ§åˆ¶çš„å¤„ç†åˆ†åˆ«æ˜¯ï¼šäº‹åŠ¡å¤„ç†ã€æŠ¥è¡¨å¤„ç†å’ŒæŸ¥è¯¢å¤„ç†ã€‚ å®é™…ä¼ä¸šä¸­çš„ç®¡ç†æ´»åŠ¨ä¸å¯èƒ½åªæ˜¯å•çº¯çš„æŒ‰å±‚æ¬¡åˆ’åˆ†ï¼Œæˆ–è€…å•çº¯çš„æŒ‰èŒèƒ½åˆ’åˆ†ã€‚ ç®¡ç†æ§åˆ¶å­ç³»ç»Ÿçš„ä»»åŠ¡æ˜¯ä¸ºä¼ä¸šå„èŒèƒ½éƒ¨é—¨ç®¡ç†äººå‘˜æä¾›ç”¨äºè¡¡é‡ä¼ä¸šæ•ˆç›Šã€æ§åˆ¶ä¼ä¸šç”Ÿäº§ç»è¥æ´»åŠ¨ã€åˆ¶å®šä¼ä¸šèµ„æºåˆ†é…æ–¹æ¡ˆç­‰æ´»åŠ¨æ‰€éœ€çš„ä¿¡æ¯ã€‚ ä»çºµå‘è§†è§’åˆ†æï¼Œæ‰§è¡Œæ§åˆ¶å­ç³»ç»Ÿçš„ä»»åŠ¡æ˜¯ç¡®ä¿åŸºå±‚ç”Ÿäº§ç»è¥æ´»åŠ¨çš„æ­£å¸¸ã€æœ‰æ•ˆçš„è¿›è¡Œã€‚ ä»æ¨ªå‘è§†è§’å°†ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè¿›è¡Œåˆ†ç±»ï¼Œåˆ—ä¸¾4ä¸ªä¾‹å­ã€‚ ç”Ÿäº§ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ é”€å”®ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ ç‰©èµ„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ è´¢åŠ¡ä¼šè®¡ç®¡ç†ä¿¡æ¯ç³»ç»Ÿ æ‰§è¡Œæ§åˆ¶å­ç³»ç»Ÿçš„ä»»åŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ æ‰§è¡Œæ§åˆ¶å­ç³»ç»Ÿçš„ä»»åŠ¡æ˜¯ç¡®ä¿åŸºå±‚çš„ç”Ÿäº§ç»è¥æ´»åŠ¨æ­£å¸¸ã€æœ‰æ•ˆçš„è¿›è¡Œã€‚ ç®€è¿°æˆ˜ç•¥è®¡åˆ’å­ç³»ç»Ÿçš„ä¸»è¦ä»»åŠ¡ã€‚ æˆ˜ç•¥è®¡åˆ’å­ç³»ç»Ÿçš„ä¸»è¦ä»»åŠ¡æ˜¯ï¼Œä¸ºä¼ä¸šæˆ˜ç•¥è®¡åˆ’çš„åˆ¶å®šå’Œè°ƒæ•´æä¾›è¾…åŠ©çš„å†³ç­–åŠŸèƒ½ã€‚ ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç®¡ç†èŒèƒ½ç»“æ„ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç®¡ç†èŒèƒ½ç»“æ„ï¼Œä¸»è¦ä»ä¸‰æ–¹é¢åˆ†æï¼š1.çºµå‘è§†é‡:ä¸€èˆ¬å°†ç®¡ç†æ´»åŠ¨åˆ†ä¸ºé«˜ã€ä¸­ã€ä½ä¸‰ä¸ªå±‚æ¬¡ï¼Œå³æˆ˜ç•¥è®¡åˆ’å±‚ã€ç®¡ç†æ§åˆ¶å±‚å’Œæ‰§è¡Œæ§åˆ¶å±‚ã€‚é’ˆå¯¹è¿™ä¸‰ä¸ªå±‚æ¬¡å»ºç«‹çš„ç³»ç»Ÿç§°ä¸ºæˆ˜ç•¥è®¡åˆ’å­ç³»ç»Ÿã€ç®¡ç†æ§åˆ¶å­ç³»ç»Ÿã€æ‰§è¡Œæ§åˆ¶å­ç³»ç»Ÿã€‚åˆ†åˆ«å±äºæˆ˜ç•¥å‹ã€ç®¡ç†å‹ã€äº‹åŠ¡å‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚2.æ¨ªå‘è§†é‡ï¼šæ¨ªå‘æ¥çœ‹ä¸€ä¸ªç»„ç»‡ï¼Œå…¶ç®¡ç†æ´»åŠ¨æ˜¯æŒ‰èŒèƒ½æ’åˆ—çš„ï¼Œå¯åˆ†ä¸ºè‹¥å¹²å­ç³»ç»Ÿï¼šç”Ÿäº§ç®¡ç†å­ç³»ç»Ÿã€é”€å”®ç®¡ç†å­ç³»ç»Ÿã€ç‰©èµ„ç®¡ç†å­ç³»ç»Ÿã€è´¢åŠ¡ä¼šè®¡ç®¡ç†å­ç³»ç»Ÿã€äººåŠ›èµ„æºç®¡ç†å­ç³»ç»Ÿã€‚3.ç»¼åˆè§†é‡ï¼šå®é™…ä¼ä¸šä¸­çš„ç®¡ç†æ´»åŠ¨ä¸å•çº¯æŒ‰å±‚æ¬¡æˆ–èŒèƒ½åˆ’åˆ†ï¼Œæ˜¯æ¨ªã€çºµäº¤å‰å½¢æˆçš„å®Œæ•´çš„ç®¡ç†æ´»åŠ¨ã€‚ ç®€è¿°ç®¡ç†æ§åˆ¶å­ç³»ç»Ÿçš„ä»»åŠ¡ã€‚ ç®¡ç†æ§åˆ¶å­ç³»ç»Ÿçš„ä»»åŠ¡æ˜¯ä¸ºä¼ä¸šå„èŒèƒ½éƒ¨é—¨çš„ç®¡ç†äººå‘˜æä¾›ç”¨äºè¡¡é‡ä¼ä¸šæ•ˆç›Šã€æ§åˆ¶ä¼ä¸šç”Ÿäº§ç»è¥æ´»åŠ¨ã€åˆ¶å®šä¼ä¸šèµ„æºåˆ†é…æ–¹æ¡ˆç­‰æ´»åŠ¨çš„æ‰€éœ€è¦çš„ä¿¡æ¯ã€‚ è½¯ç¡¬ä»¶ç»“æ„ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç¡¬ä»¶æœºæ„ä¸€èˆ¬ä»¥ç¡¬ä»¶è®¾å¤‡çš„ç‰©ç†ä½ç½®å®‰æ’å’Œæ‹“æ‰‘ç»“æ„ç­‰æ–¹å¼å±•ç°ã€‚ è½¯ä»¶å¤§ä½“å¯åˆ†ä¸ºç³»ç»Ÿè½¯ä»¶å’Œåº”ç”¨è½¯ä»¶ä¸¤å¤§ç±»ã€‚ è®¡ç®—æœºçš„çµé­‚å’Œæ€æƒ³æ˜¯è½¯ä»¶ã€‚ ä¼ä¸šçº§ä¿¡æ¯åŒ–å»ºè®¾å¸¸ç”¨çš„æ˜¯ä¸¤ç§æœåŠ¡å™¨ï¼Œåˆ†åˆ«æ˜¯ï¼šå°å‹æœºå’ŒPCæœåŠ¡å™¨ã€‚ åœ¨è®¡ç®—æœºçš„ç¡¬ä»¶ä¸­ï¼Œç°ä»£çš„è®¡ç®—æœºä¸»è¦é‡‡ç”¨å†¯è¯ºä¼Šæ›¼ä½“ç³»ç»“æ„ã€‚ æŒ‰è®¡ç®—æœºåœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸­å‘æŒ¥çš„ä½œç”¨ï¼Œé€šå¸¸åˆ†ä¸ºå®¢æˆ·æœºå’ŒæœåŠ¡å™¨ä¸¤å¤§ç±»ã€‚ è½¯ä»¶å¤§ä½“å¯åˆ†ç±»ç³»ç»Ÿè½¯ä»¶å’Œåº”ç”¨è½¯ä»¶ä¸¤å¤§ç±»ã€‚ æŒ‰æ“ä½œç³»ç»Ÿåˆ’åˆ†ï¼Œç›®å‰å¸¸ç”¨çš„æœåŠ¡å™¨ç”±WindowsæœåŠ¡å™¨ï¼ŒUnixæœåŠ¡å™¨å’ŒLinuxæœåŠ¡å™¨ã€‚ ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç¡¬ä»¶ç»“æ„åŠå…¶ç»„æˆã€‚ è®¡ç®—æœºå’Œç½‘ç»œç­‰ç¡¬ä»¶æ˜¯ç³»ç»Ÿçš„å®ä½“éƒ¨åˆ†ï¼›åŒ…æ‹¬ä¸»æœºã€å¤–è®¾å’Œç½‘ç»œç¡¬ä»¶è®¾å¤‡ç»„æˆï¼›è®¡ç®—æœºä¸»è¦æœ‰å®¢æˆ·æœºã€å„ç§æœåŠ¡å™¨åŠè¿æ¥è®¾å¤‡ç­‰ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„è½¯ä»¶ç»“æ„åŒ…æ‹¬å“ªä¸¤æ–¹é¢å†…å®¹ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„è½¯ä»¶ç»“æ„åŒ…æ‹¬ä¸¤æ–¹é¢å†…å®¹ï¼šä¸€æ˜¯æè¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè½¯ä»¶çš„åŠŸèƒ½æ¨¡å—ï¼Œæ˜¯å¯¹ç®¡ç†ä¿¡æ¯ç³»ç»ŸåŠŸèƒ½ç»“æ„çš„è¿›ä¸€æ­¥è¡¥å……å’Œç»†åŒ–ï¼Œä¸€èˆ¬å¯ä»¥ç”¨ç³»ç»Ÿæ¨¡å—ç»“æ„å›¾çš„å½¢å¼å±•ç¤ºï¼›äºŒæ˜¯ä¾é™„äºç¡¬ä»¶ç»“æ„çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„è½¯ä»¶ç»“æ„ï¼Œä¸»è¦åŒ…æ‹¬æ“ä½œç³»ç»Ÿã€æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€åº”ç”¨å¼€å‘å·¥å…·å’Œå„ç§æœåŠ¡å™¨è½¯ä»¶ç­‰ã€‚ ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç¡¬ä»¶ç»“æ„ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç¡¬ä»¶ç»“æ„ä¸€èˆ¬ä»¥ç¡¬ä»¶è®¾å¤‡çš„ç‰©ç†ä½ç½®å’Œæ‹“æ‰‘ç»“æ„ç­‰æ–¹å¼å±•ç°ã€‚ä»ç»“æ„åŸç†ä¸Šè®²ï¼Œç°ä»£çš„è®¡ç®—æœºä¸»è¦é‡‡ç”¨å†¯è¯ºä¼Šæ›¼ä½“ç³»ç»“æ„ï¼Œä¸»è¦ç”±è¿ç®—å™¨ã€æ§åˆ¶å™¨å­˜å‚¨å™¨å’Œè¾“å…¥ã€è¾“å…¥è®¾å¤‡ç»„æˆã€‚æŒ‰è®¡ç®—æœºåœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸­å‘æŒ¥çš„ä½œç”¨ï¼Œé€šå¸¸å¯åˆ†ä¸ºå®¢æˆ·æœºå’ŒæœåŠ¡å™¨ä¸¤å¤§ç±»ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„è½¯ä»¶ç»“æ„ä¸»è¦åŒ…æ‹¬å“ªäº›æ–¹é¢ã€‚ ä¸€æ˜¯æè¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿåº”ç”¨è½¯ä»¶çš„åŠŸèƒ½æ¨¡å—ï¼Œæ˜¯å¯¹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŠŸèƒ½ç»“æ„çš„è¿›ä¸€æ­¥è¡¥å……å’Œç»†åŒ–ï¼Œä¸€èˆ¬å¯ä»¥ç”¨ç³»ç»Ÿç»“æ„æ¨¡å—å›¾çš„å½¢å¼å±•ç°ã€‚ äºŒæ˜¯ä¾é™„äºç¡¬ä»¶ç»“æ„çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„è½¯ä»¶ç»“æ„ã€‚ä¸»è¦åŒ…æ‹¬æ“ä½œç³»ç»Ÿã€æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€åº”ç”¨å¼€å‘å·¥å…·å’Œå„ç§æœåŠ¡å™¨è½¯ä»¶ç­‰ã€‚ ä»¥è§„æ¨¡å’Œæ“ä½œç³»ç»Ÿä¸ºåˆ†ç±»æ ‡å‡†ï¼Œä¼ä¸šçº§ä¿¡æ¯åŒ–å»ºè®¾æœ‰å“ªäº›å¸¸è§çš„æœåŠ¡å™¨ï¼Ÿ æœåŠ¡å™¨æœ‰å¤šç§åˆ†ç±»æ ‡å‡†ï¼š æŒ‰è§„æ¨¡åˆ’åˆ†ã€‚åˆ†ä¸ºè¶…çº§è®¡ç®—æœºã€å¤§å‹æœºã€å°å‹æœºå’ŒPCæœåŠ¡å™¨ã€‚ä¼ä¸šçº§ä¿¡æ¯åŒ–å»ºè®¾ä¸­å¸¸è§çš„å°å‹æœºå’ŒPCæœåŠ¡å™¨ã€‚ æŒ‰æ“ä½œç³»ç»Ÿåˆ†ã€‚åˆ†ç±»WindowsæœåŠ¡å™¨ã€UnixæœåŠ¡å™¨å’ŒLinuxæœåŠ¡å™¨ç³»ç»Ÿã€‚ä¼ä¸šçº§ä¿¡æ¯åŒ–å»ºè®¾ä¸­ï¼Œå°å‹æœºé€šå¸¸è¿è¡Œçš„æ˜¯Unixæ“ä½œç³»ç»Ÿï¼ŒPCæœåŠ¡å™¨ä¸Šè¿è¡Œçš„æ˜¯Windwosæ“ä½œç³»ç»Ÿã€‚è¿‘å¹´æ¥ï¼ŒPCæœåŠ¡å™¨é‡‡ç”¨Linuxæ“ä½œç³»ç»Ÿçš„ä¹Ÿæ—¥æ¸æ™®éã€‚ æœåŠ¡å™¨æŒ‰æ“ä½œç³»ç»Ÿåˆ’åˆ†çš„åˆ†ç±»ã€‚ æœåŠ¡å™¨æŒ‰æ“ä½œç³»ç»Ÿåˆ’åˆ†å¯åˆ†ä¸ºWindowsæœåŠ¡å™¨ã€UnixæœåŠ¡å™¨å’ŒLinuxæœåŠ¡å™¨ã€‚ æœåŠ¡å™¨æŒ‰è§„æ¨¡åˆ’åˆ†çš„åˆ†ç±»ã€‚ æŒ‰è§„æ¨¡åˆ’åˆ†ï¼ŒæœåŠ¡å™¨å¯åˆ’åˆ†ä¸ºè¶…çº§è®¡ç®—æœºã€å¤§å‹æœºã€å°å‹æœºå’ŒPCæœåŠ¡å™¨ã€‚ è®¡ç®—æœºæŒ‰å†¯è¯ºä¼Šæ›¼ä½“ç³»ç»“æ„ï¼Œæœ‰å“ªäº›ç»„æˆéƒ¨ä»¶ï¼Ÿ ä»ç»“æ„åŸç†ä¸Šè®²ï¼Œç°ä»£çš„è®¡ç®—æœºä¸»è¦é‡‡ç”¨å†¯è¯ºä¼Šæ›¼ä½“ç³»ç»“æ„ï¼Œä¸»è¦ç”±è¿ç®—å™¨ã€æ§åˆ¶å™¨ã€å­˜å‚¨å™¨å’Œè¾“å…¥ã€è¾“å‡ºè®¾å¤‡ç»„æˆã€‚ ä¾é™„äºç¡¬ä»¶ç»“æ„çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„è½¯ä»¶ç»“æ„åŒ…æ‹¬å“ªäº›å†…å®¹ï¼Ÿ ä¸»è¦åŒ…æ‹¬æ“ä½œç³»ç»Ÿã€æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€åº”ç”¨å¼€å‘å·¥å…·å’Œå„ç§æœåŠ¡å™¨è½¯ä»¶ç­‰ã€‚ ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿç¡¬ä»¶ç»“æ„æè¿°çš„å†…å®¹ã€‚ ç»™ä¿¡æ¯ç³»ç»Ÿç¡¬ä»¶ç»“æ„æè¿°çš„æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ‰€ä¾æ‰˜çš„è®¡ç®—æœºåŠå…¶ç½‘ç»œç³»ç»Ÿçš„ç¡¬ä»¶è®¾å¤‡ç»„æˆåŠå…¶è¿æ¥æ–¹å¼ã€‚å„ç¡¬ä»¶è®¾å¤‡çš„åŠŸèƒ½å’ŒæŠ€æœ¯å‚æ•°ã€‚ ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„è½¯ä»¶ç»“æ„ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„è½¯ä»¶ç»“æ„ä¸€èˆ¬åŒ…æ‹¬åº”ç”¨è½¯ä»¶åŠŸèƒ½æ¨¡å—ä»¥åŠä¾é™„äºç¡¬ä»¶ç»“æ„çš„ç³»ç»Ÿè½¯ä»¶ï¼ŒåŒ…æ‹¬æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€åº”ç”¨å¼€å‘å·¥å…·å’Œå„ç§æœåŠ¡å™¨è½¯ä»¶ç­‰ã€‚ ç½‘ç»œè®¡ç®—ç»“æ„ äººä»¬åœ¨ç¬”è®°æœ¬ç”µè„‘ä¸Šæµè§ˆé—¨æˆ·ç½‘ç«™ä¸Šçš„ç½‘é¡µæ–°é—»æ—¶ä½¿ç”¨çš„è®¡ç®—æ¨¡å¼æœ€æœ‰å¯èƒ½æ˜¯ï¼ˆDï¼‰ A ä¸­å¤®ä¸»æœºåˆ†æ—¶å¤„ç†æ¨¡å¼ B æ–‡ä»¶æœåŠ¡å™¨æ¨¡å¼ C å®¢æˆ·æœº/æœåŠ¡å™¨æ¨¡å¼ D æµè§ˆå™¨/æœåŠ¡å™¨æ¨¡å¼ åœ¨ç½‘ç»œè®¡ç®—ç»“æ„ä¸­ï¼Œä½¿ç”¨WebæœåŠ¡å™¨ç»“æ„çš„æ˜¯ï¼ˆBï¼‰ A ä¸­å¤®ä¸»æœºé›†ä¸­åˆ†æ—¶ç»“æ„ B æµè§ˆå™¨/æœåŠ¡å™¨ç»“æ„ C æ–‡ä»¶æœåŠ¡å™¨ç»“æ„ D å®¢æˆ·æœº/æœåŠ¡å™¨ç»“æ„ ä¼ ç»Ÿçš„C/Sæ¨¡å¼æ˜¯ä¸¤å±‚ç»“æ„çš„ç³»ç»Ÿã€‚ C/Sæ¨¡å¼çš„æœ€å¤§çš„ä¼˜ç‚¹æ˜¯äº¤äº’æ€§å¼ºã€‚ B/Säº§ç”Ÿå’Œå‘å±•çš„ä¸»è¦å¾—ç›ŠäºInternetæŠ€æœ¯çš„å‘å±•ã€‚ ä»é€»è¾‘ä¸Šçœ‹ï¼ŒC/Sæ¨¡å¼æ˜¯æŒ‡è¿›ç¨‹é—´è¯·æ±‚å’ŒæœåŠ¡çš„å…³ç³»ã€‚ å…³äºæµè§ˆå™¨/æœåŠ¡å™¨æ¨¡å¼ï¼Œå®¢æˆ·ç«¯è¿è¡Œçš„æµè§ˆå™¨è½¯ä»¶ï¼Œç»è¿‡WebæœåŠ¡å™¨çš„è½¬åŒ–ï¼Œå˜æˆHTMLæ–‡æ¡£å½¢å¼ï¼Œè½¬å‘ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ã€‚ B/Säº§ç”Ÿå’Œå‘å±•å¾—ç›ŠäºInternetæŠ€æœ¯çš„å‘å±•ã€‚ ä¸‰å±‚C/Sç»“æ„åˆ†ä¸ºè¡¨ç°å±‚ã€ä¸šåŠ¡å±‚å’Œæ•°æ®å±‚ã€‚ åœ¨å®¢æˆ·æœåŠ¡å™¨æ¨¡å¼çš„ä¸‰å±‚ç»“æ„ä¸­ï¼Œè¡¨ç°å±‚ç§°ä¸ºâ€œç˜¦â€å®¢æˆ·ã€‚ ä¼ ç»Ÿçš„C/Sæ¨¡å¼æ˜¯ä¸€ç§ä¸¤å±‚ç»“æ„çš„ç³»ç»Ÿï¼Œç¬¬äºŒå±‚æ˜¯ç½‘ç»œç»“åˆäº†æ•°æ®åº“æœåŠ¡å™¨ã€‚ B/Sæ˜¯æµè§ˆå™¨/æœåŠ¡å™¨æ¨¡å¼çš„ç®€ç§°ã€‚ Nå±‚ç»“æ„ä¸­æ¯”è¾ƒå¸¸è§çš„æ˜¯ä¸‰å±‚ï¼Œå…¶ä¸­è¡¨ç°å±‚ä»…è´Ÿè´£ä¸ç”¨æˆ·äº¤äº’ã€‚ ç®€è¿°ä¸‹æµè§ˆå™¨/æœåŠ¡å™¨ï¼ˆB/Sï¼‰æ¨¡å¼ã€‚ åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œå®¢æˆ·ç«¯è¿è¡Œæµè§ˆå™¨è½¯ä»¶ï¼Œæµè§ˆå™¨ä»¥è¶…æ–‡æœ¬æ–¹å¼å‘WebæœåŠ¡å™¨æå‡ºè®¿é—®æ•°æ®åº“çš„è¦æ±‚ï¼ŒWebæœåŠ¡å™¨æ¥å—å®¢æˆ·ç«¯è¯·æ±‚åï¼Œå°†è¿™ä¸ªè¯·æ±‚è½¬åŒ–ä¸ºSQLè¯­æ³•ï¼Œå¹¶äº¤ç»™æ•°æ®åº“æœåŠ¡å™¨ï¼Œæ•°æ®åº“æœåŠ¡å™¨æ¥å—åˆ°è¯·æ±‚åï¼ŒéªŒè¯å…¶åˆæ³•æ€§ï¼Œå¹¶è¿›è¡Œæ•°æ®å¤„ç†ï¼Œç„¶åå°†å¤„ç†åçš„ç»“æœè¿”å›WebæœåŠ¡å™¨ï¼ŒWebæœåŠ¡å™¨å†ä¸€æ¬¡å°†å¾—åˆ°çš„æ‰€æœ‰ç»“æœè¿›è¡Œè½¬åŒ–ï¼Œå˜æˆHTMLæ–‡æ¡£å½¢å¼ï¼Œè½¬å‘ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ï¼Œä»¥å‹å¥½çš„Webé¡µé¢å½¢å¼æ˜¾ç¤ºå‡ºæ¥ã€‚ ç®€è¿°C/Sæ¨¡å¼ã€‚ ä¼ ç»Ÿçš„C/Sæ¨¡å¼æ˜¯ä¸€ç§ä¸¤å±‚ç»“æ„çš„ç³»ç»Ÿï¼Œç¬¬ä¸€å±‚åœ¨å®¢æˆ·æœºç³»ç»Ÿä¸Šç»“åˆäº†è¡¨ç°å±‚ä¸ä¸šåŠ¡é€»è¾‘ï¼Œç¬¬äºŒå±‚æ˜¯é€šè¿‡ç½‘ç»œç»“åˆäº†æ•°æ®åº“æœåŠ¡å™¨ã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸€ç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¯¼è®º/ç¬¬å››èŠ‚_ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å‡ ç§å…¸å‹åº”ç”¨.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸€ç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¯¼è®º/ç¬¬å››èŠ‚_ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å‡ ç§å…¸å‹åº”ç”¨.html","title":"ç¬¬å››èŠ‚ï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å‡ ç§å…¸å‹åº”ç”¨","keywords":"","body":"ç¬¬å››èŠ‚ï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å‡ ç§å…¸å‹åº”ç”¨ MRPç³»ç»Ÿ ä¸‹åˆ—å…³äºMRPç³»ç»Ÿæ‰€ä¾æ®çš„ç®¡ç†ç†å¿µï¼Œé”™è¯¯çš„æ˜¯ï¼ˆDï¼‰ A ä¾›åº”ä¸éœ€æ±‚å¹³è¡¡ B ä¼˜å…ˆçº§è®¡åˆ’åŸåˆ™ C ç”Ÿäº§ä¸ä¾›åº”è®¡åˆ’å¿…é¡»æ ¹æ®éœ€ç”¨æ—¶é—´å’Œæ•°é‡æ¥ç¡®å®šä¼˜å…ˆé¡ºåº D ä¾›åº”å¿…é¡»å¤§äºéœ€æ±‚ åœ¨MRPçš„ä¸‰é¡¹æ•°æ®ä¸­ï¼Œä¸»ç”Ÿäº§è®¡åˆ’å†³å®šMRPçš„å¿…è¦æ€§å’Œå¯è¡Œæ€§ã€‚ MRPçš„æ ¸å¿ƒæ˜¯è€ƒè™‘ç‰©æ–™ä¸æ—¶é—´å’Œæ•°é‡ä¹‹é—´çš„å…³ç³»ã€‚ MRPç³»ç»Ÿæ‰€ä¾æ®çš„ç®¡ç†ç†å¿µä¸­ï¼Œä¾›åº”å¿…é¡»ä¸éœ€æ±‚å¹³è¡¡ã€‚ MRPç³»ç»Ÿæ‰€ä¾æ®çš„ç®¡ç†ç†å¿µä¸­ï¼Œé‡‡ç”¨äº†ä¼˜å…ˆçº§è®¡åˆ’åŸåˆ™ã€‚ è¾“å…¥MRPçš„åŸºæœ¬æ•°æ®æ˜¯ä¸»ç”Ÿäº§è®¡åˆ’ã€ç‰©æ–™æ¸…å•å’Œåº“å­˜ä¿¡æ¯ã€‚ MRPçš„ä¸‰é¡¹åŸºæœ¬è¾“å…¥æ•°æ®ä¸­ï¼Œè®¡ç®—éœ€æ±‚æ•°é‡å’Œæ—¶é—´åŸºæœ¬æ•°æ®æ˜¯æŒ‡ç‰©æ–™æ¸…å•å’Œåº“å­˜ä¿¡æ¯ã€‚ ç‰©æ–™éœ€æ±‚è®¡åˆ’çš„åŸºæœ¬å†…å®¹æ˜¯ç¼–åˆ¶é›¶ä»¶çš„ç”Ÿäº§è®¡åˆ’å’Œé‡‡è´­è®¡åˆ’ã€‚ MRPçš„ä¸‰é¡¹åŸºæœ¬è¾“å…¥æ•°æ®åŒ…æ‹¬ï¼šä¸»ç”Ÿäº§è®¡åˆ’ã€ç‰©æ–™æ¸…å•å’Œåº“å­˜ä¿¡æ¯ã€‚ ç®€è¿°MRPçš„é€»è¾‘æµç¨‹ã€‚ MRPçš„åŸºæœ¬å†…å®¹æ˜¯ç¼–åˆ¶é›¶ä»¶çš„ç”Ÿäº§è®¡åˆ’å’Œé‡‡è´­è®¡åˆ’ã€‚ä¸»ç”Ÿäº§è®¡åˆ’æ˜¯å°†ç”Ÿäº§è®¡åˆ’å¤§çº²è§„å®šçš„äº§å“ç³»åˆ—æˆ–å¤§ç±»è½¬æ¢æˆç‰¹å®šäº§å“æˆ–ç‰¹å®šéƒ¨ä»¶çš„è®¡åˆ’ï¼Œæ®æ­¤å¯ä»¥åˆ¶å®šç‰©æ–™éœ€æ±‚è®¡åˆ’ã€ç”Ÿäº§è¿›åº¦è®¡åˆ’ä¸èƒ½åŠ›éœ€æ±‚è®¡åˆ’ã€‚ ç®€è¿°MRPçš„åŸºæœ¬ä»»åŠ¡ã€‚ MRPçš„åŸºæœ¬ä»»åŠ¡ï¼šä»æ‰€éœ€æ±‚äº§å“çš„ç”Ÿäº§è®¡åˆ’å¯¼å‡ºç›¸å…³ç‰©æ–™çš„éœ€æ±‚é‡å’Œéœ€æ±‚æ—¶é—´ï¼›æ ¹æ®ç‰©æ–™çš„éœ€æ±‚æ—¶é—´å’Œç”Ÿäº§å‘¨æœŸæ¥ç¡®å®šå…¶å¼€å§‹ç”Ÿäº§çš„æ—¶é—´ã€‚ ç®€è¿°MRPç³»ç»Ÿçš„ç®¡ç†ç†å¿µã€‚ MRPç³»ç»Ÿæ‰€ä¾æ®çš„ç®¡ç†ç†å¿µä¸»è¦æ˜¯ï¼š1.ä¾›åº”å¿…é¡»ä¸éœ€æ±‚å¹³è¡¡ï¼›2.ä¼˜å…ˆçº§è®¡åˆ’åŸåˆ™ï¼Œå³ç”Ÿäº§ä¸ä¾›åº”è®¡åˆ’å¿…é¡»æ ¹æ®éœ€ç”¨æ—¶é—´å’Œæ•°é‡æ¥ç¡®å®šä¼˜å…ˆé¡ºåºã€‚ ç®€è¿°MRPçš„ä¸‰é¡¹åŸºæœ¬è¾“å…¥æ•°æ®ã€‚ MRPçš„ä¸‰é¡¹åŸºæœ¬è¾“å…¥æ•°æ®åŒ…æ‹¬ï¼š1.ä¸»ç”Ÿäº§è®¡åˆ’ã€ç‰©æ–™æ¸…å•å’Œåº“å­˜ä¿¡æ¯ã€‚å…¶ä¸­ï¼Œä¸»ç”Ÿäº§è®¡åˆ’å†³å®šMRPçš„å¿…è¦æ€§å’Œå¯è¡Œæ€§ï¼Œå¦å¤–ä¸¤é¡¹æ˜¯è®¡ç®—éœ€æ±‚æ•°é‡å’Œæ—¶é—´çš„åŸºæœ¬æ•°æ®ï¼Œä»–ä»¬çš„å‡†ç¡®å®šç›´æ¥å½±å“MRPçš„è¿ç®—ç»“æœã€‚ åè¯è§£é‡Šï¼šMRPç³»ç»Ÿã€‚ å‡†ç¡®çš„è®²ï¼ŒMRPï¼ˆç‰©æ–™éœ€æ±‚è®¡åˆ’çš„ç®€ç§°ï¼‰æ˜¯ä¸€ç§ä»¥ç‰©æ–™éœ€æ±‚è®¡åˆ’ä¸æ§åˆ¶ä¸ºä¸»çº¿çš„ç®¡ç†ç†å¿µï¼ŒåŸºäºæ­¤ç§ç®¡ç†æ–¹æ³•å½¢æˆçš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè¢«ç§°ä¸ºMRPç³»ç»Ÿã€‚ MRPIIç³»ç»Ÿ ä¸€èˆ¬ä¼ä¸šä½¿ç”¨MRPIIä»¥åï¼Œåˆ¶é€ æˆæœ¬å¹³å‡é™ä½ï¼ˆBï¼‰ A 5%ï½10% B 10%ï½15% C 15%ï½20% D 20%ï½25% MRPIIå·²èƒ½åŠ¨æ€ç›‘æ§äº§ã€ä¾›ã€é”€å…¨éƒ¨ç”Ÿäº§è¿‡ç¨‹ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ åˆ¶é€ èµ„æºè®¡åˆ’çš„ç®€ç§°æ˜¯MRPIIã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ MRPIIçš„åŸºæœ¬æ€æƒ³å°±æ˜¯æŠŠä¼ä¸šä½œä¸ºä¸€ä¸ªæœ‰æœºæ•´ä½“ï¼ŒåŸºäºä¼ä¸šç»è¥ç›®æ ‡åˆ¶å®šç”Ÿäº§è®¡åˆ’ï¼Œå›´ç»•ç‰©æ–™é›†æˆç»„ç»‡å†…çš„å„ç§ä¿¡æ¯ï¼Œå®ç°æŒ‰éœ€ã€æŒ‰æ—¶è¿›è¡Œç”Ÿäº§ã€‚ MRPIIæ˜¯ä¸€ç§è®¡åˆ’ä¸»å¯¼å‹ç®¡ç†æ¨¡å¼ã€‚ MRPIIä¸MRPçš„ä¸»è¦åŒºåˆ«ä¹‹ä¸€å°±æ˜¯è¿ç”¨äº†ç®¡ç†ä¼šè®¡çš„æ¦‚å¿µã€‚ åˆ¶é€ èµ„æºè®¡åˆ’ç®€ç§°MRPIIã€‚ MRPIIç³»ç»Ÿæ¶‰åŠåªæ˜¯ç‰©æµï¼Œè¿™åªæ˜¯ä¼ä¸šç”Ÿäº§ç®¡ç†çš„ä¸€ä¸ªæ–¹é¢ï¼Œä¸æ­¤ç›¸å…³çš„èµ„é‡‘æµè¿˜æ²¡æœ‰çº³å…¥å…¶ä¸­ã€‚ ä¸€èˆ¬ä¼ä¸šè¿ç”¨MRPIIä»¥åï¼Œåˆ¶é€ æˆæœ¬å¹³å‡é™ä½**10%ï½15%ã€‚ äººä»¬æŠŠåˆ¶é€ ã€è´¢åŠ¡ã€é”€å”®ã€é‡‡è´­ã€å·¥ç¨‹æŠ€æœ¯ç­‰å„å­ç³»ç»Ÿé›†æˆä¸ºä¸€ä¸ªä¸€ä½“åŒ–ç³»ç»Ÿï¼Œè¢«ç§°ä¸ºåˆ¶é€ èµ„æºè®¡åˆ’ã€‚ ç®€è¿°MRPIIçš„åŸºæœ¬æ€æƒ³æ˜¯ä»€ä¹ˆï¼Ÿ MMRPIIçš„åŸºæœ¬æ€æƒ³å°±æ˜¯æŠŠä¼ä¸šä½œä¸ºä¸€ä¸ªæœ‰æœºæ•´ä½“ã€‚åŸºäºä¼ä¸šç»è¥ç›®æ ‡åˆ¶å®šç”Ÿäº§è®¡åˆ’ï¼Œå›´ç»•ç‰©æ–™é›†æˆç»„ç»‡å†…çš„å„ç§ä¿¡æ¯ï¼Œå®ç°æŒ‰éœ€ã€æŒ‰æ—¶ç”Ÿäº§ã€‚ åè¯è§£é‡Šï¼šMRPIIã€‚ äººä»¬æŠŠåˆ¶é€ ã€è´¢åŠ¡ã€é”€å”®ã€é‡‡è´­ã€å·¥ç¨‹æŠ€æœ¯ç­‰å„å­ç³»ç»Ÿé›†æˆä¸ºä¸€ä¸ªä¸€ä½“åŒ–ç³»ç»Ÿï¼Œè¢«ç§°ä¸ºåˆ¶é€ èµ„æºè®¡åˆ’ï¼Œä¸ºäº†åŒºåˆ«ç‰©æ–™åŒºåˆ«è®¡åˆ’ï¼Œç®€ç§°MRPIIã€‚ ERPç³»ç»Ÿ 1.ERPé¢å‘æ•´ä¸ªä¾›åº”é“¾çš„å››å¤§å…ƒç´ ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A èµ„é‡‘ B è´§ç‰© C äººå‘˜ D ç‰©æµ 2.åœ¨ERPä¸­ï¼Œè´¢åŠ¡ç®¡ç†ç³»ç»Ÿå¯ä»¥åˆ†ä¸ºä¼šè®¡æ ¸ç®—ä¸è´¢åŠ¡ç®¡ç†ã€‚ 3.åœ¨ç‰©æµç®¡ç†ä¸­ï¼Œåº“å­˜æ§åˆ¶çš„ä¸»è¦ä½œç”¨æ˜¯æ§åˆ¶å­˜å‚¨ç‰©æ–™çš„æ•°é‡ã€‚ 4.ERPçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ç”Ÿäº§è®¡åˆ’ä¸æ§åˆ¶ç®¡ç†ã€‚ 5.ä¸€èˆ¬ï¼ŒERPè½¯ä»¶çš„è´¢åŠ¡åˆ†ä¸ºä¼šè®¡æ ¸ç®—å’Œè´¢åŠ¡ç®¡ç†ä¸¤æ–¹é¢ã€‚ 6.ç‰©æµç®¡ç†ä¸­ï¼Œæœ‰åˆ†é”€ç®¡ç†ã€åº“å­˜ç®¡ç†å’Œé‡‡è´­ç®¡ç†ã€‚ 7.å¯ä»¥ç”¨äºè¦†ç›–ä¸€ä¸ªç»„ç»‡çš„ã€è¿›è¡Œç‰©è´¨èµ„æºã€èµ„é‡‘èµ„æºå’Œä¿¡æ¯èµ„æºé›†æˆä¸€ä½“åŒ–ç®¡ç†çš„é›†æˆä¿¡æ¯ç³»ç»Ÿçš„æ˜¯ERPã€‚ 8.åœ¨ERPä¸­ï¼Œç‰©æµç®¡ç†å¯æœ‰åˆ†é”€ç®¡ç†ã€åº“å­˜ç®¡ç†å’Œé‡‡è´­ç®¡ç†ç»„æˆã€‚ 9.ç”±MRPç»è¿‡é—­ç¯MRPç›´åˆ°MRP IIï¼Œå…¶å‘å±•åŸºæœ¬ä¸Šæ˜¯æ²¿ç€ä¸¤ä¸ªæ–¹é¢å»¶ä¼¸ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯èµ„æºæ¦‚å¿µå†…æ¶µçš„ä¸æ–­æ‰©å¤§ã€‚ 10.ç”±MRPç»è¿‡é—­ç¯MRPç›´åˆ°MRP IIï¼Œå…¶ä¸­ä¸€ä¸ªå‘å±•æ–¹å‘æ˜¯è®¡åˆ’é—­ç¯çš„å½¢æˆã€‚ 11.ERPç³»ç»Ÿçš„äº§ç”Ÿä¸å‘å±•ï¼Œæ—¶é—´è¢«ä½œä¸ºæœ€å…³é”®çš„èµ„æºã€‚ 12.ERPæ˜¯é¢å‘ä¾›åº”é“¾ç®¡ç†çš„ï¼Œå®ƒç”±å››å¤§å…ƒç´ ï¼Œå³èµ„é‡‘ã€è´§ç‰©ã€äººå‘˜å’Œä¿¡æ¯ã€‚ 13.å…¸å‹çš„ERPç³»ç»Ÿçš„åŠŸèƒ½ä¸»è¦åŒ…æ‹¬è´¢åŠ¡ç®¡ç†ã€ç‰©æµï¼ˆä¾›é”€ï¼‰ç®¡ç†ã€ç”Ÿäº§è®¡åˆ’ä¸æ§åˆ¶ã€äººåŠ›èµ„æºç­‰æ–¹é¢ã€‚ 14.ERPçš„å››å¤§å…ƒç´ åˆ†åˆ«æ˜¯èµ„é‡‘ã€è´§ç‰©ã€äººå‘˜å’Œä¿¡æ¯ã€‚ 15.ERPç³»ç»Ÿçš„åŠŸèƒ½ä¸»è¦åŒ…æ‹¬è´¢åŠ¡ç®¡ç†ã€ç‰©æµç®¡ç†ã€ç”Ÿäº§è®¡åˆ’ä¸æ§åˆ¶ç®¡ç†ã€äººåŠ›èµ„æºç®¡ç†ç­‰æ–¹é¢ã€‚ 16.ERPé¢å‘ä¾›åº”é“¾çš„å››å¤§å…ƒç´ åŒ…æ‹¬ï¼šèµ„é‡‘ã€è´§ç‰©ã€äººå‘˜å’Œä¿¡æ¯ã€‚ 17.ç®€è¿°ç°åœ¨å¯¹ERPç³»ç»Ÿçš„å®šä¹‰ã€‚ ç°åœ¨ï¼ŒERPè¿™ä¸ªæœ¯è¯­åŒ…æ‹¬æ‰€æœ‰å¯ä»¥ç”¨äºè¦†ç›–ä¸€ä¸ªç»„ç»‡çš„ã€è¿›è¡Œç‰©è´¨èµ„æºã€èµ„é‡‘èµ„æºå’Œä¿¡æ¯èµ„æºé›†æˆä¸€ä½“åŒ–ç®¡ç†çš„é›†æˆä¿¡æ¯ç³»ç»Ÿã€‚ 18.ç‰©æµç®¡ç†ä¸­ï¼Œåˆ†é”€ç®¡ç†æœ‰æ‹¿ä¸‰ä¸ªæ–¹é¢çš„åŠŸèƒ½ï¼Ÿ 1. å¯¹äºå®¢æˆ·ä¿¡æ¯çš„ç®¡ç†å’ŒæœåŠ¡ã€‚ 2. å¯¹äºé”€å”®è®¢å•çš„ç®¡ç†ã€‚ 3. å¯¹äºé”€å”®çš„ç»Ÿè®¡ä¸åˆ†æã€‚ 19.ç®€è¿°ç”Ÿäº§è®¡åˆ’ä¸æ§åˆ¶ç®¡ç†çš„åŠŸèƒ½ã€‚ ä¸»è¦åŠŸèƒ½æœ‰ï¼š 1. ä¸»ç”Ÿäº§è®¡åˆ’ 2. ç‰©æµéœ€æ±‚è®¡åˆ’ 3. èƒ½åŠ›éœ€æ±‚è®¡åˆ’ 4. è½¦é—´æ§åˆ¶ 5. åˆ¶é€ æ ‡å‡† 20.ç®€è¿°ERPçš„å››é¡¹åŠŸèƒ½ã€‚ 1. è´¢åŠ¡ç®¡ç†ï¼šè´¢åŠ¡éƒ¨åˆ†åˆ†ä¸ºä¼šè®¡æ ¸ç®—å’Œè´¢åŠ¡ç®¡ç†ã€‚ 2. ç‰©æµç®¡ç†ï¼šåŒ…æ‹¬åˆ†é”€ç®¡ç†ã€åº“å­˜æ§åˆ¶å’Œé‡‡è´­ç®¡ç†ã€‚ 3. ç”Ÿäº§è®¡åˆ’ä¸æ§åˆ¶ç®¡ç†ï¼šæ˜¯ERPç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½ã€‚ 4. äººåŠ›èµ„æºç®¡ç†ï¼šæ˜¯ä¼ä¸šé‡è¦çš„èµ„æºã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äºŒç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯†/ç¬¬ä¸€èŠ‚_ç®¡ç†çš„åŸºæœ¬çŸ¥è¯†.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äºŒç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯†/ç¬¬ä¸€èŠ‚_ç®¡ç†çš„åŸºæœ¬çŸ¥è¯†.html","title":"ç¬¬ä¸€èŠ‚ï¼šç®¡ç†çš„åŸºæœ¬çŸ¥è¯†","keywords":"","body":"ç¬¬ä¸€èŠ‚ï¼šç®¡ç†çš„åŸºæœ¬çŸ¥è¯† ç®¡ç†çš„å«ä¹‰ 1.ç®¡ç†è€…å¯¹æœªæ¥äº‹ä»¶çš„é¢„æµ‹ã€åˆ¶å®šè¡ŒåŠ¨æ–¹æ¡ˆçš„ç®¡ç†èŒèƒ½å±äºï¼ˆAï¼‰ A è®¡åˆ’ B ç»„ç»‡ C åè°ƒ D æ§åˆ¶ 2.ç®¡ç†åŒ…æ‹¬è®¡åˆ’ã€ç»„ç»‡ã€æŒ‡æŒ¥ã€åè°ƒå’Œæ§åˆ¶5ä¸ªèŒèƒ½ï¼Œå…¶ä¸­æ˜¯ä¼ä¸šå†…éƒ¨æ¯ä¸€éƒ¨åˆ†æˆ–æ¯ä¸€ä¸ªæˆå‘˜éƒ½æœä»æ•´ä½“ç›®æ ‡çš„èŒèƒ½å±äºï¼ˆCï¼‰ A è®¡åˆ’ B ç»„ç»‡ C åè°ƒ D æŒ‡æŒ¥ 3.ç®¡ç†è€…å¯¹ä¸‹å±äººå‘˜çš„å·¥ä½œè¿›è¡Œæ£€æŸ¥ã€çº åï¼Œä½¿å…¶è¾¾åˆ°è¦æ±‚ï¼Œè¿™ç§ç®¡ç†èŒèƒ½å±äºï¼ˆDï¼‰ A è®¡åˆ’ B ç»„ç»‡ C åè°ƒ D æ§åˆ¶ 4.å…³äºç®¡ç†çš„è¿‡ç¨‹ï¼Œå…¶æ­¥éª¤ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A å‘ç°é—®é¢˜ B æ‹Ÿå®šæ–¹æ¡ˆ C ä½œå‡ºå†³ç­– D èŒèƒ½åˆ’åˆ† 5.ç®¡ç†çš„é¦–è¦èŒèƒ½æ˜¯ï¼ˆBï¼‰ A åè°ƒ B è®¡åˆ’ C ç»„ç»‡ D æ§åˆ¶ 6.åœ¨ç®¡ç†ç°ä»£åŒ–ä¸­ï¼Œâ€œé‡è§†ç»è¥å’Œå†³ç­–çš„æ€æƒ³â€ä½“ç°çš„æ˜¯ï¼ˆAï¼‰ A ç®¡ç†æ€æƒ³ B ç®¡ç†ç»„ç»‡ C ç®¡ç†æ–¹æ³• D ç®¡ç†æ‰‹æ®µ 7.ç®¡ç†ç°ä»£åŒ–ä¸»è¦åŒ…æ‹¬ç®¡ç†æ€æƒ³ã€ç®¡ç†ç»„ç»‡ã€ç®¡ç†æ–¹æ³•å’Œç®¡ç†æ‰‹æ®µçš„ç°ä»£åŒ–ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 8.ç»„ç»‡æ˜¯ç®¡ç†çš„é¦–è¦èŒèƒ½ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 9.ç®¡ç†å°±æ˜¯å»è¥é€ ä¸€ç§æ¿€åŠ±ç¯å¢ƒï¼Œä½¿å¤„äºå…¶ä¸­çš„æ‰€æœ‰å·¥ä½œäººå‘˜åŠªåŠ›å·¥ä½œï¼Œå‘æŒ¥ç¾¤ä½“çš„ååŒæ•ˆåº”ï¼Œä»¥è¾¾åˆ°ä¼ä¸šæˆ–ç»„ç»‡çš„ç›®æ ‡ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 10.ç®¡ç†å·¥ä½œæ˜¯é€šè¿‡åè°ƒå…¶ä»–äººçš„æ´»åŠ¨æ¥è¿›è¡Œçš„ï¼Œè¿½æ±‚ç¾¤ä½“çš„ååŒæ•ˆåº”ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 11.ç®¡ç†ç°ä»£åŒ–ä¸»è¦åŒ…æ‹¬ç®¡ç†æ€æƒ³ã€ç®¡ç†ç»„ç»‡ã€ç®¡ç†æ–¹æ³•å’Œç®¡ç†æ‰‹æ®µçš„ç°ä»£åŒ–ã€‚ 12.ç®¡ç†èŒèƒ½æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œé€šè¿‡æŒ‡æŒ¥åè°ƒèŒèƒ½ï¼Œå°†ä¸ªäººå·¥ä½œä¸é›†ä½“ç›®æ ‡åè°ƒä¸€è‡´ã€‚ 13.ç®¡ç†èŒèƒ½ç›¸äº’ä¾å­˜ï¼Œé€šè¿‡ç»„ç»‡èŒèƒ½ï¼Œå»ºç«‹å®ç°ç›®æ ‡çš„æ‰‹æ®µã€‚ 14.ç®¡ç†èŒèƒ½ä¸å¯åˆ†å‰²ï¼Œé€šè¿‡æ§åˆ¶èŒèƒ½ï¼Œå¯ä»¥ä¿è¯è®¡åˆ’çš„å®ç°ã€‚ 15.ç®¡ç†èŒèƒ½ç›¸äº’å…³è”ï¼Œé€šè¿‡è®¡åˆ’èŒèƒ½æ˜ç¡®ç»„ç»‡ç›®æ ‡å’Œæ–¹å‘ã€‚ 16.ç®¡ç†èŒèƒ½ä¸­ï¼Œè®¡åˆ’çš„å…³é”®æ˜¯ç›®æ ‡çš„ç¡®å®šé—®é¢˜ã€‚ 17.å…³äºç®¡ç†èŒèƒ½ï¼Œè®¡åˆ’çš„å‡†åˆ™æ˜¯è¿›ç¨‹çš„æ—¶åºã€‚ 18.å¯¹æœªæ¥äº‹ä»¶é€šè¿‡é¢„æµ‹åˆ¶å®šæ–¹æ¡ˆçš„æ˜¯ç®¡ç†èŒèƒ½ä¸­çš„è®¡åˆ’ã€‚ 19.åœ¨ç®¡ç†èŒèƒ½ä¸­ï¼Œå¯¹äººè´¢ç‰©è¿›è¡Œé…å¤‡çš„æ˜¯ç»„ç»‡ã€‚ 20.ç®¡ç†èŒèƒ½ä¸­ï¼Œç®¡ç†è¿‡ç¨‹ä¸­å¸¦æœ‰ç»¼åˆæ€§ã€æ•´ä½“æ€§çš„ä¸€ç§èŒèƒ½æ˜¯åè°ƒã€‚ 21.å¯¹æ‰€å±å¯¹è±¡çš„è¡Œä¸ºè¿›è¡Œå‘ä»¤ã€è°ƒåº¦çš„ç®¡ç†èŒèƒ½æ˜¯æŒ‡æŒ¥ã€‚ 22.æ§åˆ¶èŒèƒ½å¯¹ä¸‹å±äººå‘˜çš„è¡Œä¸ºè¿›è¡Œæ£€æµ‹çº æ­£ï¼Œä½¿å…¶æŒ‰è¦æ±‚å·¥ä½œã€‚ 23.é‡è§†ç»è¥ã€é‡è§†å†³ç­–çš„æ€æƒ³ä½“ç°äº†ç®¡ç†æ€æƒ³çš„ç°ä»£åŒ–ã€‚ 24.ç»è¥é¢„æµ‹å’Œå†³ç­–æ–¹æ³•ä½“ç°äº†ç®¡ç†æ–¹æ³•çš„ç°ä»£åŒ–ã€‚ 25.è¡¨ç°åœ¨è®¡ç®—æœºå’Œé€šä¿¡æŠ€æœ¯åœ¨ç®¡ç†é¢†åŸŸä¸­çš„åº”ç”¨ï¼Œå¯¹å¤§ä¼ä¸šæœ‰é‡è¦æ„ä¹‰çš„äº‹ç®¡ç†æ‰‹æ®µçš„ç°ä»£åŒ–ã€‚ 26.ç®¡ç†æ‰‹æ®µçš„ç°ä»£åŒ–èƒ½ç›´æ¥ä¿ƒè¿›ç®¡ç†ä½“åˆ¶ã€ç®¡ç†ç»„ç»‡ã€ç®¡ç†æ–¹æ³•ç°ä»£åŒ–è¿›ç¨‹ã€‚ 27.ç®¡ç†çš„è¿‡ç¨‹æ˜¯åŸºäºä¿¡æ¯çš„å†³ç­–è¿‡ç¨‹ã€‚ 28.ç®¡ç†çš„è¿‡ç¨‹åŒ…æ‹¬ï¼šå‘ç°é—®é¢˜ã€æ‹Ÿå®šæ–¹æ¡ˆå’Œä½œå‡ºå†³ç­–ã€‚ 29.ç®¡ç†çš„è¿‡ç¨‹ä¸€èˆ¬åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼šå‘ç°é—®é¢˜ã€æ‹Ÿå®šæ–¹æ¡ˆå’Œä½œå‡ºå†³ç­–ã€‚ 30.ç®¡ç†å·¥ä½œæ˜¯é€šè¿‡åè°ƒå…¶ä»–äººçš„æ´»åŠ¨æ¥è¿›è¡Œçš„ï¼Œè¿½æ±‚ç¾¤ä½“çš„ååŒæ•ˆåº”ã€‚ 31.ç®¡ç†å·¥ä½œçš„ä¸­å¿ƒæ˜¯ç®¡ç†å…¶ä»–äººçš„å·¥ä½œã€‚ 32.ç®¡ç†ç°ä»£åŒ–ä¸»è¦åŒ…æ‹¬ç®¡ç†æ€æƒ³ã€ç®¡ç†æ–¹æ³•ã€ç®¡ç†ç»„ç»‡å’Œç®¡ç†æ‰‹æ®µçš„ç°ä»£åŒ–ã€‚ 33.ç®¡ç†è¿‡ç¨‹é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼Œå³å‘ç°é—®é¢˜ã€æ‹Ÿå®šæ–¹æ¡ˆå’Œä½œå‡ºå†³ç­–ã€‚ 34.ç®¡ç†çš„åŸºæœ¬èŒèƒ½åŒ…æ‹¬è®¡åˆ’ã€ç»„ç»‡ã€æŒ‡æŒ¥ã€åè°ƒå’Œæ§åˆ¶ã€‚ 35.ç®¡ç†åœ¨äºè¥é€ ä¸€ç§æ¿€åŠ±ç¯å¢ƒï¼Œä½¿å¤„äºå…¶ä¸­çš„æ‰€æœ‰å·¥ä½œäººå‘˜åŠªåŠ›å·¥ä½œï¼Œå‘æŒ¥ç¾¤ä½“çš„ååŒæ•ˆåº”ï¼Œä»¥è¾¾åˆ°ä¼ä¸šæˆ–ç»„ç»‡çš„ç›®æ ‡ã€‚ 36.ç®¡ç†è¿‡ç¨‹åŒ…æ‹¬å‘ç°é—®é¢˜ã€æ‹Ÿå®šæ–¹æ¡ˆå’Œä½œå‡ºå†³ç­–çš„è¿‡ç¨‹ã€‚ 37.ç®¡ç†çš„äº”å¤§åŸºæœ¬èŒèƒ½æ˜¯è®¡åˆ’ã€ç»„ç»‡ã€æŒ‡æŒ¥ã€æ§åˆ¶å’Œåè°ƒã€‚ 38.ç®¡ç†ç°ä»£åŒ–ä¸»è¦åŒ…æ‹¬ç®¡ç†æ€æƒ³ã€ç®¡ç†ç»„ç»‡ã€ç®¡ç†æ–¹æ³•å’Œç®¡ç†æ‰‹æ®µçš„ç°ä»£åŒ–ã€‚ 39.ç®¡ç†ç°ä»£åŒ–ä¸»è¦åŒ…æ‹¬å“ªäº›æ–¹é¢çš„å†…å®¹ï¼Ÿ ç®¡ç†ç°ä»£åŒ–ä¸»è¦åŒ…æ‹¬ç®¡ç†æ€æƒ³ã€ç®¡ç†æ–¹æ³•ã€ç®¡ç†ç»„ç»‡å’Œç®¡ç†æ‰‹æ®µçš„ç°ä»£åŒ–ã€‚ 40.ç®¡ç†èŒèƒ½ä¸­ç»„ç»‡çš„åŸºæœ¬è¦æ±‚æ˜¯ä»€ä¹ˆï¼Ÿ å®ƒç”±ä¸¤ä¸ªåŸºæœ¬è¦æ±‚ï¼šä¸€æ˜¯æŒ‰ç›®æ ‡è¦æ±‚è®¾ç½®æœºæ„ã€æ˜ç¡®å²—ä½ã€é…å¤‡äººå‘˜ã€è§„å®šæƒé™ã€èµ‹äºˆèŒè´£ï¼Œå¹¶å»ºç«‹ä¸€ä¸ªç»Ÿä¸€çš„ç»„ç»‡ç³»ç»Ÿï¼›äºŒæ˜¯æŒ‰å®ç°ç›®æ ‡çš„è®¡åˆ’å’Œè¿›ç¨‹ï¼Œåˆç†åœ°ç»„ç»‡äººåŠ›ã€ç‰©åŠ›å’Œè´¢åŠ›ï¼Œå¹¶ä¿è¯å®ƒä»¬åœ¨æ•°é‡å’Œè´¨é‡ä¸Šç›¸äº’åŒ¹é…ï¼Œä»¥å–å¾—æœ€ä½³çš„ç»æµå’Œç¤¾ä¼šæ•ˆç›Šã€‚ 41.åœ¨ç®¡ç†èŒèƒ½ä¸­ï¼Œè®¡åˆ’é‡ç‚¹è§£å†³çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ è®¡åˆ’é‡ç‚¹è§£å†³çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜ï¼šä¸€æ˜¯ç›®æ ‡çš„ç¡®å®šé—®é¢˜ï¼Œè¿™æ˜¯è®¡åˆ’çš„å…³é”®ï¼›äºŒæ˜¯è¿›ç¨‹çš„æ—¶åºï¼Œå³å…ˆåšä»€ä¹ˆï¼Œååšä»€ä¹ˆï¼Œå¯ä»¥åŒæ—¶åšä»€ä¹ˆï¼Œè¿™æ˜¯è®¡åˆ’çš„å‡†åˆ™ã€‚ 42.ç®€è¿°ç®¡ç†ç»„ç»‡çš„ç°ä»£åŒ–åŒ…æ‹¬å“ªäº›æ–¹é¢çš„å†…å®¹ï¼Ÿ ç®¡ç†ç»„ç»‡çš„ç°ä»£åŒ–åŒ…æ‹¬ç®¡ç†ä½“åˆ¶ã€æœºæ„è®¾ç½®ã€ç”Ÿäº§ç»„ç»‡å’ŒåŠ³åŠ¨ç»„ç»‡ç­‰å‡ ä¸ªæ–¹é¢çš„ç°ä»£åŒ–ã€‚ 43.å…³äºç®¡ç†çš„æ¦‚å¿µç”±å“ªäº›å«ä¹‰ï¼Ÿ ç®¡ç†å°±æ˜¯ç”±ä¸€ä¸ªæˆ–æ›´å¤šçš„äººæ¥åè°ƒä»–äººçš„æ´»åŠ¨ï¼Œä»¥ä¾¿æ”¶åˆ°ä¸ªäººå•ç‹¬æ´»åŠ¨æ‰€ä¸èƒ½æ”¶åˆ°çš„æ•ˆæœè€Œè¿›è¡Œçš„å„ç§æ´»åŠ¨ã€‚è¿™ä¸€æ¦‚å¿µç”±ä¸‰æ–¹é¢çš„å«ä¹‰ï¼š 1. ç®¡ç†å·¥ä½œçš„ä¸­å¿ƒæ˜¯ç®¡ç†å…¶ä»–äººçš„å·¥ä½œã€‚ 2. ç®¡ç†å·¥ä½œæ˜¯é€šè¿‡åè°ƒå…¶ä»–äººçš„æ´»åŠ¨æ¥è¿›è¡Œçš„ï¼Œè¿½æ±‚ç¾¤ä½“çš„ååŒæ•ˆåº”ã€‚ 3. ç®¡ç†å°±æ˜¯å»è¥é€ ä¸€ç§æ¿€åŠ±ç¯å¢ƒï¼Œä½¿å…¶æ‰€æœ‰å·¥ä½œäººå‘˜åŠªåŠ›å·¥ä½œï¼Œå‘æŒ¥ç¾¤ä½“çš„ååŒæ•ˆåº”ï¼Œè¾¾åˆ°ä¼ä¸šæˆ–ç»„ç»‡çš„ç›®æ ‡ã€‚ 44.åè¯è§£é‡Šï¼šç®¡ç†ã€‚ ç®¡ç†å°±æ˜¯ç”±ä¸€ä¸ªæˆ–æ›´å¤šçš„äººæ¥åè°ƒä»–äººçš„æ´»åŠ¨ï¼Œä»¥ä¾¿æ”¶åˆ°ä¸ªäººå•ç‹¬æ´»åŠ¨æ‰€ä¸èƒ½æ”¶åˆ°çš„æ•ˆæœè€Œè¿›è¡Œçš„å„ç§æ´»åŠ¨ã€‚è¿™ä¸€æ¦‚å¿µç”±ä¸‰æ–¹é¢çš„å«ä¹‰ï¼š 1. ç®¡ç†å·¥ä½œçš„ä¸­æ—¶ç®¡ç†å…¶ä»–äººçš„å·¥ä½œã€‚ 2. ç®¡ç†å·¥ä½œæ—¶é€šè¿‡åè°ƒå…¶ä»–äººçš„æ´»åŠ¨æ¥è¿›è¡Œçš„ï¼Œè¿½æ±‚ç¾¤ä½“çš„ååŒæ•ˆåº”ã€‚ 3. ç®¡ç†å°±æ˜¯å»è¥é€ ä¸€ç§æ¿€åŠ±ç¯å¢ƒï¼Œä½¿å…¶æ‰€æœ‰å·¥ä½œäººå‘˜åŠªåŠ›å·¥ä½œï¼Œå‘æŒ¥ç¾¤ä½“çš„ååŒæ•ˆåº”ï¼Œè¾¾åˆ°ä¼ä¸šæˆ–ç»„ç»‡çš„ç›®æ ‡ã€‚ 45.ç®€è¿°ç®¡ç†ç”±å“ªäº›åŸºæœ¬èŒèƒ½ã€‚ ç®¡ç†çš„åŸºæœ¬èŒèƒ½ï¼š 1. è®¡åˆ’ã€‚è¿™æ˜¯ç®¡ç†çš„é¦–è¦èŒèƒ½ï¼Œå®ƒå¯¹æœªæ¥äº‹ä»¶ä½œå‡ºé¢„æµ‹ï¼Œä»¥åˆ¶å®šå‡ºè¡ŒåŠ¨æ–¹æ¡ˆã€‚ 2. ç»„ç»‡ã€‚å®ƒæ˜¯æŒ‡å®Œæˆè®¡åˆ’æ‰€éœ€çš„ç»„ç»‡ç»“æ„ã€è§„ç« åˆ¶åº¦ã€äººè´¢ç‰©çš„é…å¤‡ç­‰ã€‚ 3. æŒ‡æŒ¥ã€‚å®ƒæ˜¯æŒ‡å¯¹æ‰€å±å¯¹è±¡çš„è¡Œä¸ºè¿›è¡Œå‘ä»¤ã€è°ƒåº¦ã€æ£€æŸ¥ã€‚ 4. åè°ƒã€‚å®ƒæ˜¯æŒ‡ä½¿ç»„ç»‡å†…éƒ¨çš„æ¯ä¸€éƒ¨åˆ†æˆ–æ¯ä¸€æˆå‘˜çš„ä¸ªåˆ«è¡ŒåŠ¨éƒ½èƒ½æœä»æ•´ä¸ªé›†ä½“ç›®æ ‡ï¼Œæ˜¯ç®¡ç†è¿‡ç¨‹ä¸­å¸¦æœ‰ç»¼åˆæ€§ã€æ•´ä½“æ€§çš„ä¸€ç§èŒèƒ½ã€‚ 5. æ§åˆ¶ã€‚å®ƒæ˜¯æŒ‡å¯¹ä¸‹å±äººå‘˜çš„è¡Œä¸ºè¿›è¡Œæ£€æµ‹ï¼Œçº æ­£åå·®ï¼Œä½¿å…¶æŒ‰è§„å®šçš„è¦æ±‚å·¥ä½œã€‚ 46.æ§åˆ¶èŒèƒ½å¿…é¡»å…·å¤‡ä¸‰ä¸ªåŸºæœ¬æ¡ä»¶ï¼Ÿ æ§åˆ¶èŒèƒ½å¿…é¡»å…·å¤‡ä¸‰ä¸ªåŸºæœ¬æ¡ä»¶ï¼šä¸€æ˜¯æœ‰æ˜ç¡®çš„æ‰§è¡Œæ ‡å‡†ï¼›äºŒæ˜¯åŠæ—¶è·å¾—å‘ç”Ÿåå·®çš„ä¿¡æ¯ï¼›ä¸‰æ˜¯æœ‰çº æ­£åå·®çš„æœ‰æ•ˆæªæ–½ã€‚ç¼ºå°‘ä»»ä½•ä¸€ä¸ªæ¡ä»¶ï¼Œç®¡ç†æ´»åŠ¨ä¾¿ä¼šå¤±å»æ§åˆ¶ã€‚ ç»„ç»‡ç»“æ„ 1.ä¸€ä¸ªä¼ä¸šçš„ç»„ç»‡å†…ä¸‹çº§ä¸»è¦è´Ÿè´£äººåªæ¥å—ä¸Šä¸€çº§ä¸»è¦è´Ÿè´£äººçš„æŒ‡æŒ¥ä¸æ§åˆ¶ï¼Œè¿™ä¸ªä¼ä¸šçš„ç»„ç»‡æœºæ„å±äºï¼ˆBï¼‰ A èŒèƒ½åˆ¶ç»„ç»‡ç»“æ„ B ç›´çº¿åˆ¶ç»„ç»‡ç»“æ„ C çŸ©é˜µå¼ç»„ç»‡ç»“æ„ D äº‹ä¸šéƒ¨ç»„ç»‡ç»“æ„ 2.ç»„ç»‡æœºæ„ä¸­ï¼Œæœ€æ—©æœ€ç®€å•çš„ç»„ç»‡å½¢å¼æ˜¯ï¼ˆAï¼‰ A ç›´çº¿åˆ¶ç»„ç»‡ç»“æ„ B çŸ©é˜µå¼ç»„ç»‡ç»“æ„ C èŒèƒ½åˆ¶ç»„ç»‡ç»“æ„ D äº‹ä¸šéƒ¨åˆ¶ç»„ç»‡ç»“æ„ 3.ä¸‹åˆ—ç»„ç»‡æœºæ„ä¸­ï¼Œç”±ä¸¤ç»´ç»„æˆï¼Œä¸€ç»´æ˜¯ç›´çº¿ç»„ç»‡ï¼Œå¦ä¸€ç»´æ˜¯ä»»åŠ¡çš„ç»„ç»‡ç»“æ„æ˜¯ï¼ˆBï¼‰ A ç›´çº¿åˆ¶ç»„ç»‡ç»“æ„ B çŸ©é˜µå¼ç»„ç»‡ç»“æ„ C èŒèƒ½åˆ¶ç»„ç»‡ç»“æ„ D äº‹ä¸šéƒ¨åˆ¶ç»„ç»‡ç»“æ„ 4.å„çº§è¡Œæ”¿å•ä½é™¤ä¸»ç®¡è´Ÿè´£äººå¤–ï¼Œè¿˜ç›¸åº”è®¾ç«‹ä¸€äº›èŒèƒ½æœºæ„ï¼ŒæŒ‡çš„æ˜¯ï¼ˆAï¼‰ A äº‹ä¸šéƒ¨åˆ¶ç»„ç»‡ç»“æ„ B ç›´çº¿åˆ¶ç»„ç»‡ç»“æ„ C èŒèƒ½åˆ¶ç»„ç»‡ç»“æ„ D çŸ©é˜µå¼ç»„ç»‡ç»“æ„ 5.ç›´çº¿åˆ¶ç»“æ„æ˜¯ä¸€ç§æ ‘çŠ¶ç»„ç»‡ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 6.è‹¥ä¸€ç§ç»„ç»‡ç»“æ„ç”±ä¸¤ç»´ç»„æˆï¼Œåˆ™è¿™æ ·çš„ç»„ç»‡ç»“æ„ç§°ä¸ºçŸ©é˜µå¼ç»„ç»‡ç»“æ„ã€‚ 7.ç›´çº¿åˆ¶ç»“æ„æ¯”è¾ƒé€‚ç”¨äºä»»åŠ¡æ˜ç¡®ä¸”æ§åˆ¶ä¸¥æ ¼çš„æƒ…å†µï¼Œæ˜¯ä¸€ç§æ ‘çŠ¶ç»„ç»‡ã€‚ 8.ä¸ºåŠ å¼ºä»»åŠ¡è¿‡ç¨‹çš„è´Ÿè´£åˆ¶ï¼Œå¤§è§„æ¨¡ä¼ä¸šé‡‡å–çŸ©é˜µå¼ç»“æ„ã€‚ 9.ç›´çº¿åˆ¶ç»“æ„æ¯”è¾ƒé€‚ç”¨äºä»»åŠ¡æ˜ç¡®ï¼Œè€Œåˆè¦æ±‚é¢†å¯¼é›†ä¸­ã€æ§åˆ¶ä¸¥æ ¼çš„æƒ…å†µï¼Œæ˜¯ä¸€ç§æ ‘çŠ¶ç»„ç»‡ã€‚ 10.ç›´çº¿åˆ¶æ˜¯ä¸€ç§æœ€æ—©ä¹Ÿæ˜¯æœ€ç®€å•çš„ç»„ç»‡å½¢å¼ã€‚ 11.ç»„ç»‡æ˜¯ä¿è¯ç®¡ç†ç›®æ ‡å®ç°çš„é‡è¦æ‰‹æ®µã€‚ 12.äº†è§£ç®¡ç†çš„ç»„ç»‡ç»“æ„å°†æœ‰åˆ©äºæˆ‘ä»¬åˆ†æå’Œè®¾è®¡ç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ 13.èŒèƒ½åˆ¶ç»„ç»‡ç»“æ„çš„ä¼˜ç‚¹æ˜¯å‡å°‘äº†æœ€é«˜é¢†å¯¼è€…çš„è´Ÿæ‹…ã€‚ 14.å¦‚ä¸€ä¸ªç»„ç»‡å„çº§è¡Œæ”¿å•ä½ä¸ºä»ä¸Šåˆ°ä¸‹å®è¡Œçš„ä½“åˆ¶æ˜¯ä¸‹å±éƒ¨é—¨åªæœä»ç›´æ¥ä¸Šçº§çš„å‘½ä»¤ï¼Œåˆ™è¿™æ ·çš„ç»„ç»‡ç»“æ„ç§°ä¸ºç›´çº¿åˆ¶ç»„ç»‡æœºæ„ã€‚ 15.å¦‚æœåœ¨å‚é•¿ä¸‹é¢è®¾ç«‹èŒèƒ½éƒ¨é—¨å’Œäººå‘˜ï¼ŒååŠ©å‚é•¿ä»äº‹èŒèƒ½ç®¡ç†å·¥ä½œï¼ŒæŒ‡çš„æ˜¯èŒèƒ½åˆ¶ç»„ç»‡ç»“æ„ã€‚ 16.çŸ©é˜µå¼ç»„ç»‡ç»“æ„ä¸€ç»´æ˜¯ç›´çº¿ç»„ç»‡ï¼Œå¦ä¸€ç»´æ˜¯ä»»åŠ¡ã€‚ 17.ä¼ä¸šç®¡ç†çš„ç»„ç»‡ç»“æ„ä¸€èˆ¬åˆ†ä¸ºä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯ç›´çº¿åˆ¶ç»„ç»‡ç»“æ„ã€èŒèƒ½åˆ¶ç»„ç»‡ç»“æ„å’ŒçŸ©é˜µå¼ç»„ç»‡ç»“æ„ã€‚ 18.å…¸å‹çš„ç»„ç»‡ç»“æ„åŒ…æ‹¬ç›´çº¿åˆ¶ç»„ç»‡ç»“æ„ã€èŒèƒ½åˆ¶ç»„ç»‡ç»“æ„å’ŒçŸ©é˜µå¼ç»„ç»‡ç»“æ„ã€‚ 19.èŒèƒ½åˆ¶ç»„ç»‡ç»“æ„çš„ä¼˜ç¼ºç‚¹ã€‚ èŒèƒ½åˆ¶ç»„ç»‡ç»“æ„çš„ä¼˜ç‚¹æ˜¯å‡å°‘äº†æœ€é«˜é¢†å¯¼è€…çš„è´Ÿæ‹…ï¼Œä½†ç¼ºç‚¹æ˜¯å®¹æ˜“é€ æˆåŠäº‹æ•ˆç‡ä½ä¸‹ç­‰ç°è±¡ã€‚ 20.ç®€è¿°çŸ©é˜µå¼ç»„ç»‡ç»“æ„çš„ä¼˜ç¼ºç‚¹ã€‚ å…¶ä¼˜ç‚¹æ˜¯åŠ å¼ºäº†æ¨ªå‘è”ç³»ã€å…·æœ‰è¾ƒå¤§çš„æœºåŠ¨æ€§ã€‚å…¶ä¸»è¦ç¼ºç‚¹æ˜¯äººå‘˜å—åŒé‡é¢†å¯¼ï¼Œæœ‰æ—¶ä¸æ˜“åˆ†æ¸…è´£ä»»ã€‚ 21.åè¯è§£é‡Šï¼šèŒèƒ½åˆ¶ç»„ç»‡ç»“æ„ã€‚ èŒèƒ½åˆ¶ç»„ç»‡ç»“æ„ï¼Œæ˜¯å„çº§è¡Œæ”¿å•ä½é™¤ä¸»ç®¡è´Ÿè´£äººå¤–ï¼Œè¿˜ç›¸åº”åœ°è®¾ç«‹ä¸€äº›èŒèƒ½æœºæ„ã€‚å¦‚åœ¨å‚é•¿ä¸‹é¢è®¾ç«‹èŒèƒ½éƒ¨é—¨å’Œäººæ„¿ï¼ŒååŠ©å‚é•¿ä»äº‹èŒèƒ½ç®¡ç†å·¥ä½œã€‚ 22.åè¯è§£é‡Šï¼šç›´çº¿åˆ¶ç»„ç»‡ç»“æ„ã€‚ ç›´çº¿åˆ¶æ˜¯ä¸€ç§æœ€æ—©ä¹Ÿæ˜¯æœ€ç®€å•çš„ç»„ç»‡å½¢å¼ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯ä¼ä¸šå„çº§è¡Œæ”¿å•ä½ä»ä¸Šå€’ä¸‹å®è¡Œå‚ç›´é¢†å¯¼ï¼Œä¸‹å±éƒ¨é—¨åªæ¥å—ä¸€ä¸ªä¸Šæœºçš„æŒ‡ä»¤ï¼Œå„çº§ä¸»ç®¡è´Ÿè´£äººå¯¹æ‰€å±å•ä½çš„ä¸€åˆ‡é—®é¢˜è´Ÿè´£ã€‚ç›´çº¿åˆ¶ç»“æ„æ¯”è¾ƒé€‚ç”¨äºä»»åŠ¡æ˜ç¡®ï¼Œè€Œåˆè¦æ±‚é¢†å¯¼é›†ä¸­ã€æ§åˆ¶ä¸¥æ ¼çš„æƒ…å†µï¼Œæ˜¯ä¸€ç§æ ‘çŠ¶ç»„ç»‡ã€‚ 23.ç®€è¿°å…¸å‹çš„ç»„ç»‡ç»“æ„æœ‰å“ªå‡ ç§ï¼Ÿ å…¸å‹çš„ç»„ç»‡ç»“æ„ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ä¸‰ç§ï¼šç›´çº¿åˆ¶ç»„ç»‡ç»“æ„ï¼›èŒèƒ½åˆ¶ç»„ç»‡ç»“æ„ï¼›çŸ©é˜µå¼ç»„ç»‡ç»“æ„ã€‚ 24.åè¯è§£é‡Šï¼šçŸ©é˜µå¼ç»„ç»‡ç»“æ„ã€‚ çŸ©é˜µå¼ç»„ç»‡ç»“æ„æœ‰ä¸¤ç»´ç»„æˆï¼Œä¸€ç»´æ˜¯ç›´çº¿ç»„ç»‡ï¼Œå¦ä¸€ç»´æ˜¯ä»»åŠ¡ã€‚å…¶ä¼˜ç‚¹æ˜¯åŠ å¼ºäº†æ¨ªå‘è”ç³»ã€å…·æœ‰è¾ƒå¤§çš„æœºåŠ¨æ€§ã€‚å…¶ä¸»è¦ç¼ºç‚¹æ˜¯äººå‘˜å—åŒé‡é¢†å¯¼ï¼Œæœ‰æ—¶ä¸æ˜“åˆ†æ¸…è´£ä»»ã€‚ ç®¡ç†éƒ¨é—¨çš„åˆ’åˆ†æ–¹æ³• 1.åœ¨ç®¡ç†éƒ¨é—¨çš„åˆ’åˆ†æ–¹æ³•ä¸­ï¼Œæœ€å¹¿æ³›é‡‡ç”¨çš„æ˜¯ä¸€ç§åŸºæœ¬æ–¹æ³•çš„åˆ’åˆ†ä¾æ®æ˜¯ï¼ˆCï¼‰ A åœ°åŒº B äº§å“ C èŒèƒ½ D å¸‚åœº 2.ä¸€ä¸ªå¤§å‹å…¨å›½è¿é”é›¶å”®ä¼ä¸šåˆ’åˆ†ç®¡ç†éƒ¨é—¨æ—¶ï¼Œåˆé€‚çš„åˆ’åˆ†åŸåˆ™æ˜¯ï¼ˆCï¼‰ A æŒ‰å·¥è‰ºåˆ’åˆ† B æŒ‰äº§å“éƒ¨ä»¶åˆ’åˆ† C æŒ‰åœ°åŒºåˆ’åˆ† D æŒ‰å¸‚åœºå‰æ™¯åˆ’åˆ† 3.åœ¨å¤šç§ç»è¥çš„å¤§è§„æ¨¡ç»„ç»‡ä¸­ï¼Œåˆ’åˆ†éƒ¨é—¨æ¯”è¾ƒæµè¡Œçš„æ–¹å¼æ˜¯ï¼ˆBï¼‰ A æŒ‰åœ°åŒºåˆ’åˆ† B æŒ‰äº§å“åˆ’åˆ† C æŒ‰èŒèƒ½åˆ’åˆ† D æŒ‰é¡¾å®¢åˆ’åˆ† 4.é“¶è¡Œæ€»è¡ŒåŠå…¶åˆ†è¡Œçš„ç®¡ç†æ¨¡å¼æ˜¯ï¼ˆAï¼‰ A æŒ‰åœ°åŒºç®¡ç† B æŒ‰èŒèƒ½ç®¡ç† C æŒ‰äº§å“ç®¡ç† D æŒ‰é¡¾å®¢ç®¡ç† 5.ä¸€ä¸ªå¤§å‹å¯è¾°åˆ¶é€ ä¼ä¸šåˆ†æˆå‘åŠ¨æœºåˆ†å‚ã€è½¦èº«åˆ†å‚ã€è½´æ‰¿åˆ†å‚ã€‚è¿™ç§ç®¡ç†éƒ¨é—¨çš„åˆ’åˆ†æ–¹å¼å±äºï¼ˆBï¼‰ A æŒ‰å·¥è‰ºåˆ’åˆ† B æŒ‰äº§å“éƒ¨ä»¶åˆ’åˆ† C æŒ‰åœ°åŒºåˆ’åˆ† D æŒ‰å¸‚åœºå‰æ™¯åˆ’åˆ† 6.å¯¹ä¸€ä¸ªä¸€èˆ¬åˆ¶é€ ä¼ä¸šè€Œè¨€ï¼Œåˆ’åˆ†ç®¡ç†éƒ¨é—¨çš„åŸåˆ™æ˜¯ï¼ˆCï¼‰ A æŒ‰å¸‚åœºåˆ’åˆ† B æŒ‰åœ°åŒºåˆ’åˆ† C æŒ‰èŒèƒ½åˆ’åˆ† D æŒ‰å·¥è‰ºåˆ’åˆ† 7.åœ¨ä¸åŒåœ°åŒºè®¾ç½®æ”¿åºœéƒ¨é—¨çš„ç®¡ç†æ¨¡å¼æ˜¯ï¼ˆCï¼‰ A æŒ‰èŒèƒ½ç®¡ç† B æŒ‰äº§å“ç®¡ç† C æŒ‰åœ°åŒºç®¡ç† D æŒ‰é¡¾å®¢ç®¡ç† 8.èŒèƒ½åˆ¶å’ŒçŸ©é˜µåˆ¶æ˜¯ç›®å‰å¤šæ•°ä¼ä¸šé‡‡ç”¨çš„ç»„ç»‡ç»“æ„ã€‚ 9.ç®€è¿°ç®¡ç†éƒ¨é—¨çš„åˆ’åˆ†æ–¹æ³•ã€‚ ç®¡ç†éƒ¨é—¨çš„åˆ’åˆ†æ–¹æ³•ï¼š1.æŒ‰èŒèƒ½åˆ’åˆ†éƒ¨é—¨ã€‚æ ¹æ®ä¸“ä¸šåŸåˆ™ï¼Œä»¥å·¥ä½œæˆ–ä»»åŠ¡çš„æ€§è´¨ç»´åŸºç¡€æ¥åˆ’åˆ†éƒ¨é—¨çš„ï¼Œå¦‚åˆ¶é€ ä½¿ç”¨çš„æ˜¯ç”Ÿäº§ã€é”€å”®ã€è´¢åŠ¡ç­‰ï¼›2.æŒ‰åœ°åŒºåˆ’åˆ†éƒ¨é—¨ã€‚ä¾‹å¦‚ï¼Œå¤„äºä¸åŒåœ°åŒºçš„æ”¿åºœæœºå…³ã€é“¶è¡Œã€æ³•é™¢ã€å·¥å•†ç­‰ï¼›3.æŒ‰äº§å“åˆ’åˆ†éƒ¨é—¨ã€‚ä¾‹å¦‚ï¼šæ±½è½¦åˆ¶é€ ä¼ä¸šåˆ†æˆå‘åŠ¨æœºåˆ†å‚ã€è½¦èº«åˆ†å‚ã€è½´æ‰¿åˆ†å‚ç­‰ã€‚ ç®¡ç†å¹…åº¦ä¸å±‚æ¬¡ 1.è´Ÿè´£æ‹Ÿå®šå…¬å¸ä¸­é•¿æœŸå‘å±•è§„åˆ’ã€ç»è¥è®¡åˆ’ã€èµ„æœ¬ç»è¥è§„åˆ’å’Œæ–¹æ¡ˆçš„ç®¡ç†å±‚æ˜¯ï¼ˆAï¼‰ A æˆ˜ç•¥å†³ç­–å±‚ B ä¸šåŠ¡ç®¡ç†å±‚ C ä¸šåŠ¡æ‰§è¡Œå±‚ D æˆ˜æœ¯ç®¡ç†å‘˜ 2.ä»¥ä¸‹å…³äºâ€œç®¡ç†å¹…åº¦â€çš„è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆCï¼‰ A ç®¡ç†å¹…åº¦è¶Šå¤§ï¼Œç®¡ç†æ•ˆç‡è¶Šé«˜ B ç®¡ç†å¹…åº¦è¶Šå¤§ï¼Œç®¡ç†æ•ˆç‡è¶Šä½ C æœ‰æ•ˆç®¡ç†å¹…åº¦è¶Šå¤§ï¼Œç®¡ç†å±‚æ¬¡è¶Šå°‘ D æœ‰æ•ˆç®¡ç†å¹…åº¦è¶Šå¤§ï¼Œç®¡ç†å±‚æ¬¡è¶Šå¤š 3.åœ¨ç®¡ç†å±‚æ¬¡ä¸­ï¼Œé«˜å±‚ç®¡ç†å¯¹åº”çš„æ˜¯ï¼ˆAï¼‰ A æˆ˜ç•¥çº§ç®¡ç† B æˆ˜æœ¯çº§ C æ‰§è¡Œå±‚ D ä½œä¸šå±‚ 4.åŸºå±‚ç®¡ç†åˆç§°ä¸ºï¼ˆAï¼‰ A ä½œä¸šå±‚ç®¡ç† B æˆ˜ç•¥çº§ç®¡ç† C æˆ˜æœ¯çº§ç®¡ç† Dã€‚æŠ€æœ¯çº§ç®¡ç† 5.æˆ˜æœ¯çº§ç®¡ç†å¯¹åº”çš„æ˜¯ï¼ˆCï¼‰ A é«˜å±‚ç®¡ç† B åŸºå±‚ç®¡ç† C ä¸­å±‚ç®¡ç† D æ‰§è¡Œå±‚ç®¡ç† 6.å…³äºç®¡ç†å¹…åº¦ï¼Œå½“è¶…è¿‡æŸä¸ªé™åº¦æ—¶ï¼Œç®¡ç†çš„æ•ˆç‡å°±ä¼šéšä¹‹ä¸‹é™ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 7.è¾ƒå¤§çš„ç®¡ç†å¹…åº¦æ„å‘³ç€è¾ƒå¤šçš„å±‚æ¬¡ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 8.æ‰å¹³ç»“æ„æ˜¯ä¸€ç§ç®¡ç†å±‚æ¬¡å°‘è€Œç®¡ç†å®½åº¦å¤§çš„ç»“æ„ã€‚ 9.æŒ‰ç…§ç®¡ç†å¹…åº¦å¤§å°å’Œç®¡ç†å±‚æ¬¡å¤šå°‘åˆ’åˆ†ï¼Œç›´å¼ç»“æ„ç®¡ç†å±‚æ¬¡è¾ƒå¤šã€‚ 10.ä¸ºäº†æœ‰æ•ˆç®¡ç†ï¼Œæˆ‘ä»¬å°½é‡å‡å°‘ç®¡ç†å±‚æ¬¡ï¼Œç§°ä¸ºç®¡ç†æ‰å¹³åŒ–ã€‚ 11.æŒ‰ç…§ç®¡ç†å¹…åº¦å¤§å°å’Œç®¡ç†å±‚æ¬¡å¤šå°‘ï¼Œåˆ†æˆä¸¤ç§ç»“æ„ï¼šæ‰å¹³ç»“æ„å’Œç›´å¼ç»“æ„ã€‚ 12.ä¼ä¸šä¸€åç®¡ç†ä¸­æœ‰æ•ˆåœ°ç›‘ç£ã€ç®¡ç†å…¶ç›´æ¥ä¸‹å±çš„äººæ•°ç§°ä¸ºç®¡ç†å¹…åº¦ã€‚ 13.ç®¡ç†å¹…åº¦åˆç§°ä¸ºâ€œç®¡ç†è·¨åº¦â€æˆ–â€œç®¡ç†å®½åº¦â€ã€‚ 14.ç®¡ç†å¹…åº¦åˆç§°ä¸ºâ€œç®¡ç†è·¨åº¦â€æˆ–â€œç®¡ç†å®½åº¦â€ã€‚ 15.ç®¡ç†å¹…åº¦åˆç§°ä¸ºâ€œç®¡ç†è·¨åº¦â€æˆ–â€œç®¡ç†å®½åº¦â€ã€‚ 16.é«˜å±‚ç®¡ç†å±æˆ˜ç•¥çº§ç®¡ç†ï¼Œå®ƒæ˜¯ä¸€ä¸ªç»„ç»‡æœ€é«˜é¢†å¯¼å±‚ã€‚ 17.æŒ‰ç…§ç®¡ç†å¹…åº¦çš„å¤§å°åŠç®¡ç†å±‚æ¬¡çš„å¤šå°‘ï¼Œåˆ†æˆä¸¤ç§ç»“æ„ï¼šæ‰å¹³ç»“æ„å’Œç›´å¼ç»“æ„ã€‚ 18.æŒ‰ç…§ç®¡ç†ä¸­å¹…åº¦çš„å¤§å°åŠç®¡ç†å±‚æ¬¡çš„å¤šå°‘ï¼Œç»„ç»‡å¯ä»¥åˆ†æˆä¸¤ç§ç»“æ„ï¼Œå…¶ä¸­ç®¡ç†å±‚æ¬¡å°‘è€Œç®¡ç†å®½åº¦å¤§çš„ç»“æ„ï¼Œç§°ä¸ºæ‰å¹³ç»“æ„ã€‚ 19.å°†ç®¡ç†åˆ’åˆ†ä¸ºä¸‰ä¸ªå±‚æ¬¡ï¼šé«˜å±‚ç®¡ç†ã€ä¸­å±‚ç®¡ç†ã€åŸºå±‚ç®¡ç†ã€‚ 20.é€šå¸¸ï¼Œå½“è¶…è¿‡äº†ç®¡ç†å¹…åº¦æ—¶ï¼Œå°±å¿…é¡»å¢åŠ ä¸€ä¸ªç®¡ç†å±‚æ¬¡ã€‚ 21.æ ¹æ®ä¼ä¸šçš„å†…å¤–æƒ…å†µï¼Œåˆ†æå’Œåˆ¶å®šè¯¥ç»„ç»‡é•¿è¿œç›®æ ‡åŠæ”¿ç­–çš„ç®¡ç†å±‚å±äºé«˜å±‚ç®¡ç†å±‚ã€‚ 22.åœ¨ç®¡ç†å±‚æ¬¡ä¸­ï¼Œæˆ˜ç•¥çº§ç®¡ç†å¯¹åº”çš„æ˜¯é«˜å±‚ç®¡ç†ã€‚ 23.åè¯è§£é‡Šï¼šç®¡ç†å±‚æ¬¡ã€‚ ç®¡ç†å±‚æ¬¡å°±æ˜¯æŒ‡ç®¡ç†ç»„ç»‡åˆ’åˆ†ä¸ºå¤šå°‘ä¸ªç­‰çº§ã€‚ç®¡ç†è€…çš„èƒ½åŠ›æœ‰é™ï¼Œå½“ä¸‹å±äººå‘˜å¤ªå¤šè¶…å‡ºäº†è‡ªå·±çš„ç®¡ç†å¹…åº¦æ—¶ï¼Œéœ€è¦åˆ’åˆ†å±‚æ¬¡ï¼Œä¸åŒçš„ç®¡ç†å±‚æ¬¡æ ‡å¿—ç€ä¸åŒçš„èŒè´£å’Œæƒé™ã€‚æˆ‘ä»¬å°†ç®¡ç†åˆ’åˆ†ä¸ºä¸‰ä¸ªå±‚æ¬¡ï¼šé«˜å±‚ç®¡ç†ã€ä¸­å±‚ç®¡ç†ã€åŸºå±‚ç®¡ç†ã€‚ 24.å½±å“ç®¡ç†å¹…åº¦çš„å› ç´ æœ‰å“ªäº›ï¼Ÿ å½±å“ç®¡ç†å¹…åº¦çš„å› ç´ å¾ˆå¤šï¼Œæ¯”å¦‚ç®¡ç†è€…çš„ä¸ªäººèƒ½åŠ›ã€å·¥ä½œçš„éš¾æ˜“ç¨‹åº¦ï¼Œä»¥åŠä¿¡æ¯çš„æ²Ÿé€šå’Œå¤„ç†æ•ˆç‡ã€‚ 25.åè¯åŠæ—¶ï¼šç®¡ç†å¹…åº¦ã€‚ ç®¡ç†å¹…åº¦ï¼šåˆç§°â€œç®¡ç†è·¨åº¦â€æˆ–â€œç®¡ç†å®½åº¦â€ï¼Œæ˜¯æŒ‡ä¸€åç®¡ç†è€…æœ‰æ•ˆåœ°ç›‘ç£ã€ç®¡ç†å…¶ç›´æ¥ä¸‹å±çš„äººæ•°æ˜¯æœ‰é™çš„ï¼Œå½“è¶…è¿‡æŸä¸ªé™åº¦æ—¶ï¼Œç®¡ç†çš„æ•ˆç‡å°±ä¼šéšä¹‹ä¸‹é™ã€‚ 26.åè¯è§£é‡Šï¼šç®¡ç†æ‰å¹³åŒ–ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œä¸ºäº†è¾¾åˆ°æœ‰æ•ˆç®¡ç†ï¼Œåº”å°½å¯èƒ½åœ°å‡å°‘ç®¡ç†å±‚æ¬¡ï¼Œæˆ‘ä»¬å°†è¿™ä¸€è¿‡ç¨‹ç§°ä¸ºç®¡ç†æ‰å¹³åŒ–ã€‚ ç®¡ç†å±‚æ¬¡ä¸å†³ç­–ç±»å‹ 1.å…³äºç»“æ„åŒ–å†³ç­–çš„è¯†åˆ«ç¨‹åº¦ï¼Œä¸‹åˆ—æè¿°æ­£ç¡®çš„æ˜¯ï¼ˆAï¼‰ A é—®é¢˜ç¡®å®š B é—®é¢˜è¾ƒéš¾ç¡®å®š C é—®é¢˜ä¸ç¡®å®š D å‚æ•°éš¾ä»¥é‡åŒ– 2.å…³äºåŠç»“æ„åŒ–å†³ç­–çš„ç‰¹ç‚¹ï¼Œæè¿°æ­£ç¡®çš„æ˜¯ï¼ˆDï¼‰ A é—®é¢˜ä¸ç¡®å®š B ä¸å¤æ‚ C æ— æ³•å»ºæ¨¡ D ä¿¡æ¯ä¸»è¦æ¥è‡ªå†…éƒ¨ 3.éç»“æ„åŒ–å†³ç­–çš„ç‰¹ç‚¹æ˜¯ï¼ˆAï¼‰ A å‚æ•°éš¾ä»¥é‡åŒ– B ä¸å¤æ‚ C ä¿¡æ¯æ¥æºäºå†…éƒ¨ D è‡ªåŠ¨åŒ–çš„å†³ç­–æ–¹å¼ 4.ç»“æ„åŒ–å†³ç­–çš„ç‰¹ç‚¹æ˜¯ï¼ˆBï¼‰ A é—®é¢˜æ¯”è¾ƒå¤æ‚ B æ‰€éœ€ä¿¡æ¯æ¥è‡ªä¼ä¸šå†…éƒ¨ C é—®é¢˜è¾ƒéš¾è¯†åˆ« D å€ŸåŠ©äººå·¥æ™ºèƒ½å†³ç­– 5.å…³äºç®¡ç†æ´»åŠ¨çš„å†³ç­–è¿‡ç¨‹ï¼Œâ€œè´¦åŠ¡å¤„ç†â€ä½“ç°çš„å†³ç­–æ–¹å¼æ˜¯ï¼ˆAï¼‰ A ç»“æ„åŒ–å†³ç­– B åŠç»“æ„åŒ–å†³ç­– C éç»“æ„åŒ–å†³ç­– D ç»„ç»‡ç»“æ„åŒ–å†³ç­– 6.å¾ˆéš¾ç”¨ç¡®å®šçš„å†³ç­–æ¨¡å‹æ¥æè¿°ï¼Œå¼ºè°ƒå†³ç­–è€…çš„ä¸»è§‚æ„è¯†ï¼ŒæŒ‡çš„æ˜¯ï¼ˆBï¼‰ A åŠç»“æ„åŒ–å†³ç­– B éç»“æ„åŒ–å†³ç­– C ç»“æ„åŒ–å†³ç­– D ç»„ç»‡ç»“æ„åŒ–å†³ç­– 7.å…³äºç®¡ç†æ´»åŠ¨çš„å†³ç­–è¿‡ç¨‹ï¼Œâ€œç‰©èµ„å‡ºå…¥åº“ç®¡ç†â€çš„æ´»åŠ¨ä½“ç°çš„å†³ç­–æ–¹å¼æ˜¯ï¼ˆBï¼‰ A éç»“æ„åŒ–å†³ç­– B ç»“æ„åŒ–å†³ç­– C ç»„ç»‡ç»“æ„åŒ–å†³ç­– D åŠç»“æ„åŒ–å†³ç­– 8.â€œå¸‚åœºé¢„æµ‹â€çš„æ´»åŠ¨ä½“ç°çš„å†³ç­–æ–¹å¼æ˜¯ï¼ˆAï¼‰ A åŠç»“æ„åŒ–å†³ç­– B ç»„ç»‡ç»“æ„åŒ–å†³ç­– C ç»“æ„åŒ–å†³ç­– D éç»“æ„åŒ–å†³ç­– 9.â€œç‰©èµ„é…é€â€çš„æ´»åŠ¨ä½“ç°çš„å†³ç­–æ–¹å¼æ˜¯ï¼ˆAï¼‰ A åŠç»“æ„åŒ– B ç»“æ„åŒ– C ç»„ç»‡ç»“æ„åŒ– D éç»“æ„åŒ– 10.éç»“æ„åŒ–å†³ç­–çš„ç‰¹ç‚¹æ˜¯ï¼ˆCï¼‰ A é—®é¢˜ä¸æ˜“ç¡®å®š B ä¿¡æ¯æ¥è‡ªä¼ä¸šå†…éƒ¨ C æ¨¡å‹å®¹æ˜“æè¿° D ç”¨äºçŸ­æœŸå±€éƒ¨å†³ç­– 11.ç®¡ç†æ´»åŠ¨çš„é«˜ã€ä¸­ã€ä½ä¸‰ä¸ªå±‚æ¬¡åˆ†åˆ«å¯¹åº”æ˜¯ï¼ˆDï¼‰ A éç»“æ„åŒ–å†³ç­–å±‚æ¬¡ã€åŠç»“æ„åŒ–å†³ç­–ã€ç»“æ„åŒ–å†³ç­– B ç»“æ„åŒ–å†³ç­–ã€éç»“æ„åŒ–å†³ç­–ã€åŠç»“æ„åŒ–å†³ç­–æ¬¡ C éç»“æ„åŒ–å†³ç­–ã€ç»“æ„åŒ–å†³ç­–ã€åŠç»“æ„åŒ–å†³ç­– D ç»“æ„åŒ–å†³ç­–ã€åŠç»“æ„åŒ–å†³ç­–ã€éç»“æ„åŒ–å†³ç­– 12.éç»“æ„åŒ–å†³ç­–å¼ºè°ƒå†³ç­–è€…çš„ä¸»è§‚æ„è¯†ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 13.éç»“æ„åŒ–å†³ç­–çš„ä¿¡æ¯æ¥æºæ˜¯å¤–éƒ¨å’Œå†…éƒ¨ç»¼åˆä¿¡æ¯ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 14.åŠç»“æ„åŒ–å†³ç­–çš„å¤æ‚ç¨‹åº¦æ˜¯å¾ˆå¤æ‚ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 15.éç»“æ„åŒ–å†³ç­–çš„é—®é¢˜ä¸ç¡®å®šï¼Œå‚æ•°éš¾ä»¥é‡åŒ–ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 16.ç»“æ„åŒ–å†³ç­–çš„å†³ç­–æ–¹å¼æ˜¯è‡ªåŠ¨åŒ–ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 17.éç»“æ„åŒ–å†³ç­–çš„é—®é¢˜ä¸€èˆ¬éƒ½å¸¦æœ‰å…¨å±€æ€§ã€æˆ˜ç•¥æ€§å’Œå¤æ‚æ€§ã€‚ 18.éæœºæ„åŒ–å†³ç­–å¼ºè°ƒå†³ç­–è€…çš„ä¸»è§‚æ„è¯†ï¼Œé—®é¢˜ä¸€èˆ¬éƒ½å¸¦æœ‰å…¨å±€æ€§ã€æˆ˜ç•¥æ€§å’Œå¤æ‚æ€§ã€‚ 19.åœ¨å†³ç­–ç±»å‹ä¸­ï¼Œå¼ºè°ƒå†³ç­–æ„å¿—çš„æ˜¯éç»“æ„åŒ–å†³ç­–ã€‚ 20.ä¾æ®ä¸€å®šçš„è§„åˆ™å®ç°å†³ç­–è¿‡ç¨‹çš„è‡ªåŠ¨åŒ–çš„æ˜¯ç»“æ„åŒ–å†³ç­–ã€‚ 21.åŠç»“æ„åŒ–å†³ç­–é€šå¸¸æ˜¯æŒ‡ä¼ä¸šèŒèƒ½éƒ¨é—¨ä¸»ç®¡ä¸šåŠ¡äººå‘˜çš„è®¡åˆ’æ§åˆ¶ç­‰ç®¡ç†å†³ç­–æ´»åŠ¨ã€‚ 22.ç»“æ„åŒ–å†³ç­–é€šå¸¸æŒ‡ç¡®å®šå‹çš„ç®¡ç†é—®é¢˜ã€‚ 23.ä¼ä¸šä¸»è§‚è®¡åˆ’æ§åˆ¶çš„ç®¡ç†å†³ç­–æ´»åŠ¨æŒ‡çš„æ˜¯åŠç»“æ„åŒ–å†³ç­–ã€‚ 24.ç®¡ç†æ´»åŠ¨çš„é«˜ã€ä¸­ã€ä½ä¸‰ä¸ªå±‚æ¬¡åˆ†åˆ«å¯¹åº”çš„å†³ç­–è¿‡ç¨‹æ˜¯ï¼šéç»“æ„åŒ–å†³ç­–ã€åŠç»“æ„åŒ–å†³ç­–å’Œç»“æ„åŒ–å†³ç­–ã€‚ 25.éç»“æ„åŒ–çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ éç»“æ„åŒ–çš„ç‰¹ç‚¹æ˜¯å¾ˆéš¾ç”¨ç¡®å®šçš„å†³ç­–æ¨¡å‹æ¥æè¿°ï¼Œå®ƒå¼ºè°ƒå†³ç­–è€…çš„ä¸»è§‚æ„è¯†ã€‚è¿™ç±»é—®é¢˜ä¸€èˆ¬éƒ½å¸¦æœ‰å…¨å±€æ€§ã€æˆ˜ç•¥æ€§å’Œå¤æ‚æ€§ã€‚ 26.åè¯è§£é‡Šï¼šéç»“æ„åŒ–å†³ç­–ã€‚ éç»“æ„åŒ–å†³ç­–æ—¶æŒ‡å¾ˆéš¾ç”¨ç¡®å®šçš„æ¨¡å‹æ¥æè¿°çš„ä¸€ç±»ç®¡ç†å†³ç­–æ´»åŠ¨ï¼Œå®ƒå¼ºè°ƒå†³ç­–è€…çš„ä¸»è§‚æ„è¯†ï¼Œè¿™ç±»é—®é¢˜ä¸€èˆ¬éƒ½å¸¦æœ‰å…¨å±€æ€§ã€æˆ˜ç•¥æ€§å’Œå¤æ‚æ€§ã€‚ 27.åè¯è§£é‡Šï¼šç»“æ„åŒ–å†³ç­–ã€‚ ç»“æ„åŒ–å†³ç­–é€šå¸¸æŒ‡ç¡®å®šçš„ç®¡ç†é—®é¢˜ï¼Œå®ƒä¾æ®ä¸€å®šçš„å†³ç­–è§„åˆ™æˆ–é€šç”¨çš„æ¨¡å‹æ¥å®ç°å…¶å†³ç­–è¿‡ç¨‹çš„è‡ªåŠ¨åŒ–ã€‚è§£å†³è¿™ç±»é—®é¢˜é€šå¸¸é‡‡ç”¨æ•°æ®ç®¡ç†æ–¹å¼ï¼Œå®ƒç€çœ¼äºæé«˜å¤„ç†çš„æ•ˆç‡å’Œè´¨é‡ã€‚ 28.åè¯è§£é‡Šï¼šåŠç»“æ„åŒ–å†³ç­–ã€‚ åŠç»“æ„åŒ–å†³ç­–æ˜¯æŒ‡ä¼ä¸šèŒèƒ½éƒ¨é—¨ä½ç®¡ä¸šåŠ¡äººå‘˜çš„è®¡åˆ’æ§åˆ¶ç­‰ç®¡ç†å†³ç­–æ´»åŠ¨ã€‚å®ƒå¤šå±äºçŸ­æœŸçš„ã€å±€éƒ¨çš„å†³ç­–ã€‚å†³ç­–çš„è¿‡ç¨‹ä¸­ï¼Œåœ¨ç»“æ„åŒ–å†³ç­–è¿‡ç¨‹æ‰€æä¾›çš„ä¿¡æ¯çš„åŸºç¡€ä¸Šï¼Œä¸€èˆ¬åº”æœ‰ä¸“ç”¨æ¨¡å‹æ¥å¸®åŠ©ã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äºŒç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯†/ç¬¬äºŒèŠ‚_ä¿¡æ¯çš„åŸºæœ¬çŸ¥è¯†.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äºŒç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯†/ç¬¬äºŒèŠ‚_ä¿¡æ¯çš„åŸºæœ¬çŸ¥è¯†.html","title":"ç¬¬äºŒèŠ‚ï¼šä¿¡æ¯çš„åŸºæœ¬çŸ¥è¯†","keywords":"","body":"ç¬¬äºŒèŠ‚ï¼šä¿¡æ¯çš„åŸºæœ¬çŸ¥è¯† ä¿¡æ¯ä¸æ•°æ® 1.åè¯è§£é‡Šï¼šä¿¡æ¯ã€‚ ä¿¡æ¯æ˜¯ç»è¿‡åŠ å·¥çš„æ•°æ®ï¼Œæ˜¯æœ‰ä¸€å®šçš„å«ä¹‰ã€èƒ½å‡å°‘ä¸ç¡®å®šæ€§ã€å¯¹å†³ç­–æˆ–è¡Œä¸ºæœ‰ç°å®æˆ–æ½œåœ¨ä»·å€¼çš„æ•°æ®ã€‚ ä¿¡æ¯çš„åŸºæœ¬å±æ€§ 1.ä¸‹åˆ—å…³äºä¿¡æ¯çš„åŸºæœ¬å±æ€§ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆAï¼‰ A ä¿¡æ¯æ˜¯æ™®éå­˜åœ¨çš„ B ä¿¡æ¯å…·æœ‰æ¶ˆè€—æ€§ C ä¿¡æ¯æ˜¯ä¸å¯å‹ç¼© D ä¿¡æ¯å…·æœ‰è™šæ‹Ÿæ€§ 2.ä¿¡æ¯è¢«åˆ©ç”¨æ—¶å¯ä»¥äº§ç”Ÿèƒ½é‡æˆ–æ—¶é—´çš„ç‰¹æ€§å±äºä¿¡æ¯çš„ï¼ˆBï¼‰ A å¯äº¤äº’æ€§ B å¯è½¬åŒ–æ€§ C å¯æ‰©æ•£æ€§ D å¯å…±äº«æ€§ 3.ä¸‹åˆ—å…³äºä¿¡æ¯çš„åŸºæœ¬å±æ€§ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆAï¼‰ A ä¿¡æ¯å…·æœ‰äº‹å®æ€§ B ä¿¡æ¯å…·æœ‰æ¶ˆè€—æ€§ C ä¿¡æ¯å…·æœ‰ä¸å¯å‹ç¼©æ€§ D ä¿¡æ¯å…·æœ‰ä¸å¯å˜æ¢æ€§ 4.ä¿¡æ¯æ˜¯äº‹åŠ¡è¿åŠ¨å’ŒçŠ¶æ€æ”¹å˜çš„æ–¹å¼ï¼Œåæ˜ äº†ä¿¡æ¯å…·æœ‰ï¼ˆAï¼‰ A æ™®éæ€§ B äº‹å®æ€§ C å…±äº«æ€§ D å˜æ¢æ€§ 5.å…³äºä¿¡æ¯çš„åŸºæœ¬å±æ€§ï¼Œä¸‹åˆ—æè¿°æ­£ç¡®çš„æ˜¯ï¼ˆAï¼‰ A ä¿¡æ¯æ˜¯æ™®éå­˜åœ¨çš„ B ä¿¡æ¯æè¿°äº†äº‹ç‰©çš„æ’å®šçŠ¶æ€ C ä¿¡æ¯ä¸å¯å‹ç¼© D ä¿¡æ¯æ˜¯å¯æ¶ˆè€—çš„ 6.ä¿—è¯è¯´ï¼Œâ€œæ²¡æœ‰ä¸é€é£çš„å¢™â€ï¼Œä½“ç°äº†ä¿¡æ¯å…·æœ‰ï¼ˆAï¼‰ A æ‰©æ•£æ€§ B å˜æ¢æ€§ C å¯è½¬åŒ–æ€§ D å±‚æ¬¡æ€§ 7.ä¿¡æ¯å¤„ç†åº”è¯¥æŠ“ä½äº‹ç‰©çš„ä¸»è¦çŸ›ç›¾ï¼Œä»æ•°æ®ä¸­å»ç²—å–ç²¾ï¼Œå»ä¼ªå­˜çœŸï¼ŒæŒ‡çš„æ˜¯ä¿¡æ¯çš„ï¼ˆCï¼‰ A å…±äº«æ€§ B å˜æ¢æ€§ C å¯å‹ç¼©æ€§ D å±‚æ¬¡æ€§ 8.ä¿¡æ¯ä¸å…¶ä»–ç‰©è´¨èµ„æºä¸åŒï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸ä½†ä¸ä¼šè¢«æ¶ˆè€—ï¼Œè€Œä¸”è¿˜å¯èƒ½å‡ºç°å†ç”Ÿæˆ–å¢æ®–ï¼ŒæŒ‡çš„æ˜¯ä¿¡æ¯çš„ï¼ˆCï¼‰ A å±‚æ¬¡æ€§ B æ™®éæ€§ C éæ¶ˆè€—æ€§ D å…±äº«æ€§ 9.ä¿¡æ¯å¯ä»¥è´Ÿè½½åœ¨å…¶ä»–ä¸€åˆ‡å¯èƒ½çš„ç‰©è´¨è½½ä½“å’Œèƒ½é‡å½¢å¼ä¸Šï¼Œä½“ç°äº†ä¿¡æ¯çš„ï¼ˆCï¼‰ A æ™®éæ€§ B äº‹å®æ€§ C å˜æ¢æ€§ D å±‚æ¬¡æ€§ 10.ä»¥ä¸‹å…³äºä¿¡æ¯çš„åŸºæœ¬å±æ€§ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆCï¼‰ A ä¿¡æ¯ä¸å¯å…±äº« B ä¿¡æ¯ä¸å¯å˜æ¢ C ä¿¡æ¯ä¸å¯æ¶ˆè€— D ä¿¡æ¯ä¸å¯å‹ç¼© 11.ä»¥ä¸‹å…³äºä¿¡æ¯å±æ€§çš„æè¿°ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆDï¼‰ A ä¿¡æ¯ä¸å…·å±‚æ¬¡æ€§ B ä¿¡æ¯å…·æœ‰å¯æ¶ˆè€—æ€§ C ä¿¡æ¯ä¸å¯å‹ç¼©æ€§ D ä¿¡æ¯å…·æœ‰å¯è½¬åŒ–æ€§ 12.ä¿¡æ¯çš„åŸºæœ¬å±æ€§å¾ˆå¤šï¼Œå…¶ä¸­ä¿¡æ¯åŠ›å›¾å†²ç ´éè‡ªç„¶çº¦æŸä¼ æ’­åˆ°å››é¢å…«æ–¹çš„å±æ€§æ˜¯ï¼ˆBï¼‰ A å…±äº«æ€§ B æ‰©æ•£æ€§ C å˜æ¢æ€§ D äº‹å®æ€§ 13.ä¸‹åˆ—å…³äºä¿¡æ¯çš„åŸºæœ¬å±æ€§ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆAï¼‰ A ä¿¡æ¯å…·æœ‰å˜æ¢æ€§ B ä¿¡æ¯ä¸å¯è½¬åŒ– C ä¿¡æ¯æ²¡æœ‰å…±äº«æ€§ D ä¿¡æ¯ä¸å¯æ‰©æ•£ 14.ä¿¡æ¯åŠ›å›¾å†²ç ´éè‡ªç„¶çº¦æŸä¼ æ’­åˆ°å››é¢å…«æ–¹çš„ç‰¹æ€§æ˜¯ï¼ˆBï¼‰ A å…±äº«æ€§ B æ‰©æ•£æ€§ C å˜æ¢æ€§ D äº‹å®æ€§ 15.ä»¥ä¸‹å…³äºä¿¡æ¯çš„åŸºæœ¬å±æ€§ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆDï¼‰ A ä¿¡æ¯æ²¡æœ‰è½¬åŒ–æ€§ B ä¿¡æ¯æ²¡æœ‰æ‰©æ•£æ€§ C ä¿¡æ¯ä¸å…·æ™®éæ€§ D ä¿¡æ¯ä¸å…·æ¶ˆè€—æ€§ 16.ä¿¡æ¯çš„åŸºæœ¬å±æ€§ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A äº‹å®æ€§ B æ‰©æ•£æ€§ C å˜æ¢æ€§ D æ¶ˆè€—æ€§ 17.ä»¥ä¸‹å…³äºä¿¡æ¯çš„åŸºæœ¬å±æ€§ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆAï¼‰ A ä¿¡æ¯å…·æœ‰äº‹å®æ€§ B ä¿¡æ¯ä¸å¯å‹ç¼© C ä¿¡æ¯å…·æœ‰æ¶ˆè€—æ€§ D ä¿¡æ¯ä¸å¯æ‰©æ•£ 18.ä»¥ä¸‹å…³äºä¿¡æ¯çš„åŸºæœ¬å±æ€§ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆDï¼‰ A ä¿¡æ¯ä¸å¯è½¬åŒ– B ä¿¡æ¯ä¸å¯å‹ç¼© C ä¿¡æ¯ä¸è¢«æ‰©æ•£ D ä¿¡æ¯ä¸å›è¢«æ¶ˆè€— 19.ä»¥ä¸‹å…³äºâ€œä¿¡æ¯â€çš„è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆBï¼‰ A ä¿¡æ¯å¯ä»¥å¢åŠ ä¸ç¡®å®šæ€§ B ä¿¡æ¯å¯ä»¥è¢«å‹ç¼© C ä¿¡æ¯å¯ä»¥è¢«æ¶ˆè€— D ä¿¡æ¯ä»·å€¼æ€»ä¸ºæ­£ 20.å°†ä¼ä¸šçš„å…¨éƒ¨ä¿¡æ¯é›†ä¸­ç®¡ç†ï¼Œå……åˆ†å…±äº«ï¼Œä¿¡æ¯æ‰å¯èƒ½æˆä¸ºä¼ä¸šå¯åˆ©ç”¨çš„èµ„æºï¼ŒæŒ‡çš„æ˜¯ä¿¡æ¯çš„ï¼ˆCï¼‰ A å˜æ¢æ€§ B å±‚æ¬¡æ€§ C å…±äº«æ€§ D äº‹å®æ€§ 21.ä¿¡æ¯ç»è¿‡é›†ä¸­ã€ç»¼åˆå’Œæ¦‚æ‹¬å¤„ç†åï¼Œä¸å›ä¸¢å¤±ä¿¡æ¯çš„æœ¬è´¨ï¼Œåæ˜ äº†ä¿¡æ¯çš„ï¼ˆAï¼‰ A å¯å‹ç¼©æ€§ B å…±äº«æ€§ C äº‹å®æ€§ D éæ¶ˆè€—æ€§ 22.æè¿°äº‹ç‰©è¿åŠ¨å’ŒçŠ¶æ€çš„å˜åŒ–ï¼Œæ˜¯æŒ‡ä¿¡æ¯å…·æœ‰ï¼ˆBï¼‰ A å±‚æ¬¡æ€§ B äº‹å®æ€§ C å˜æ¢æ€§ D å¯å‹ç¼©æ€§ 23.ä¿¡æ¯å¯ä»¥å˜æ¢æˆç‰©è´¨ã€èƒ½é‡å’Œæ—¶é—´åæ˜ äº†å®ƒçš„ï¼ˆAï¼‰ A å˜æ¢æ€§ B å…±äº«æ€§ C å¯è½¬åŒ–æ€§ D éæ¶ˆè€—æ€§ 24.ä¿¡æ¯è¢«åˆ©ç”¨æ—¶å¯ä»¥äº§ç”Ÿèƒ½é‡æˆ–æ—¶é—´çš„ç‰¹æ€§ï¼Œè¿™å±äºä¿¡æ¯çš„ï¼ˆBï¼‰ A å¯äº¤æ¢æ€§ B å¯è½¬åŒ–æ€§ C å¯æ‰©æ•£æ€§ D å¯å‹ç¼©æ€§ 25.å°†ç®¡ç†åˆ’åˆ†ä¸ºæˆ˜ç•¥çº§ã€ç­–ç•¥çº§å’Œæ‰§è¡Œå±‚ï¼Œåæ˜ äº†ä¿¡æ¯çš„ï¼ˆAï¼‰ A å±‚æ¬¡æ€§ B äº‹å®æ€§ C éæ¶ˆè€—æ€§ D å…±äº«æ€§ 26.ä¿¡æ¯æ—¶ä¸å¯å˜æ¢çš„ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 27.ä¿¡æ¯æ˜¯å¯ä»¥å…±äº«çš„ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 28.ä»æ½œåœ¨çš„æ„ä¹‰ä¸Šè®²ï¼Œä¿¡æ¯æ˜¯å¯ä»¥è½¬åŒ–çš„ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 29.ä¿¡æ¯æ˜¯ä¸€ç§ç‰¹æ®Šçš„èµ„æºï¼ŒèŒèƒ½å…±äº«ä¸èƒ½äº¤æ¢ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 30.ä¿¡æ¯å’Œç®¡ç†ä¸ä¸€æ ·ï¼Œæ²¡æœ‰å±‚æ¬¡æ€§ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 31.ä¿¡æ¯æ˜¯ä¸å¯å‹ç¼©çš„ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 32.ä¿¡æ¯çš„éæ¶ˆè€—æ€§æ˜¯æŒ‡åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸ä½†ä¸ä¼šè¢«æ¶ˆè€—ï¼Œè€Œä¸”è¿˜å¯èƒ½å‡ºç°å†ç”Ÿæˆ–å¢æ®–ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 33.ä¿¡æ¯åŠ›å›¾å†²ç ´ä¿å¯†çš„ã€éè‡ªç„¶çš„çº¦æŸæƒ³å››é¢å…«æ–¹ä¼ æ’­ï¼Œä½“ç°äº†ä¿¡æ¯å…·å¯å‹ç¼©æ€§ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 34.ä¿¡æ¯å…·æœ‰äº‹å®æ€§ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 35.åªè¦æœ‰äº‹ç‰©å­˜åœ¨ï¼Œåªè¦æœ‰äº‹ç‰©è¿åŠ¨ï¼Œå°±ä¼šæœ‰å®ƒä»¬è¿åŠ¨çš„çŠ¶æ€å’Œæ–¹å¼ï¼Œå°±å­˜åœ¨ä¿¡æ¯ï¼Œä½“ç°äº†ä¿¡æ¯çš„æ™®éæ€§ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 36.åªè¦æœ‰äº‹ç‰©å­˜åœ¨çº§å…¶è¿åŠ¨ï¼Œå°±ä¼šæœ‰å®ƒä»¬è¿åŠ¨çš„çŠ¶æ€å’Œæ–¹å¼ï¼Œå°±å­˜åœ¨ä¿¡æ¯ï¼Œè¿™å°±æ˜¯ä¿¡æ¯çš„æ™®éæ€§ã€‚ 37.ä¿¡æ¯çš„ç‰¹æ€§ä¹‹ä¸€æ˜¯æè¿°äº‹ç‰©è¿åŠ¨å’ŒçŠ¶æ€çš„æ”¹å˜ï¼Œè¿™ç§ç‰¹æ€§ç§°ä¸ºä¿¡æ¯çš„äº‹å®æ€§ï¼ˆçœŸå®æ€§ï¼‰ã€‚ 38.ä¿¡æ¯å¯ä»¥è´Ÿè½½åœ¨å…¶ä»–ä¸€åˆ‡å°½å¯èƒ½çš„ç‰©è´¨è½½ä½“å’Œèƒ½é‡å½¢å¼ä¸Šï¼ŒæŒ‡çš„æ˜¯ä¿¡æ¯çš„å˜æ¢æ€§ã€‚ 39.ä¿¡æ¯åœ¨ä¸€å®šçš„æ¡ä»¶ä¸‹ï¼Œå¯ä»¥è½¬åŒ–ä¸ºç‰©è´¨ã€èƒ½é‡ã€æ—¶é—´åŠå…¶ä»–ã€‚ 40.ä¿¡æ¯å¯ä»¥è´Ÿè½½åœ¨å…¶ä»–ä¸€åˆ‡å¯èƒ½çš„ç‰©è´¨è½½ä½“å’Œèƒ½é‡å½¢å¼ä¸Šï¼ŒæŒ‡çš„æ˜¯ä¿¡æ¯çš„å˜æ¢æ€§ã€‚ 41.ä¿¡æ¯æ˜¯ä¸€ç§ç‰¹æ®Šçš„èµ„æºï¼ŒèŒèƒ½å…±äº«ä¸èƒ½äº¤æ¢ã€‚ 42.ä¿¡æ¯æ˜¯æ™®éå­˜åœ¨çš„ï¼Œå®ƒæ˜¯äº‹ç‰©è¿åŠ¨å’ŒçŠ¶æ€æ”¹å˜çš„æ–¹å¼ã€‚ 43.ä¿¡æ¯çš„éæ¶ˆè€—æ€§æ˜¯æŒ‡ä¿¡æ¯ä¸å…¶ä»–ç‰©è´¨èµ„æºä¸åŒï¼Œå®ƒåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸ä½†ä¸ä¼šè¢«æ¶ˆè€—ï¼Œè€Œä¸”è¿˜å¯èƒ½å‡ºç°å†ç”Ÿæˆ–å¢æ®–ã€‚ 44.ä¿¡æ¯ç»è¿‡æµ“ç¼©ã€é›†ä¸­ã€ç»¼åˆå’Œæ¦‚æ‹¬å¤„ç†ç­‰åï¼Œä¸è‡³äºå½±å“å…¶ä¸­çš„å«ä¹‰ï¼Œä½“ç°äº†ä¿¡æ¯çš„å¯å‹ç¼©æ€§ã€‚ 45.å¯¹åŸºå±‚æ¸¸æ³³çš„ä¿¡æ¯ï¼Œå¯¹é«˜å±‚æ¥è¯´å¯èƒ½æ˜¯æ•°æ®ã€‚å› æ­¤ï¼Œä¿¡æ¯ä¸ç®¡ç†ä¸€æ ·ï¼Œä¹Ÿå…·æœ‰å±‚æ¬¡æ€§ã€‚ 46.å°†ç®¡ç†åˆ†æˆä¸‰ä¸ªå±‚æ¬¡ï¼Œé«˜å±‚ç®¡ç†å¯¹åº”æˆ˜ç•¥çº§ã€‚ 47.å°†ç®¡ç†åˆ†æˆä¸‰ä¸ªå±‚çº§ï¼Œä¸­å±‚ç®¡ç†å¯¹åº”ç­–ç•¥çº§ã€‚ 48.å°†ç®¡ç†åˆ†æˆä¸‰ä¸ªå±‚çº§ï¼ŒåŸºå±‚ç®¡ç†å¯¹åº”æ‰§è¡Œå±‚ã€‚ 49.å…³äºä¿¡æ¯çš„åŸºæœ¬å±æ€§ï¼Œäº‹å®ä½¿ä¿¡æ¯å…·æœ‰ä»·å€¼ï¼Œä¸ç¬¦åˆäº‹å®çš„ä¿¡æ¯åè€Œä¼šå°†å†³ç­–å¼•å…¥æ­§é€”ã€‚ 50.ä¿¡æ¯çš„å¯å‹ç¼©æ€§æ˜¯æŒ‡ä¿¡æ¯ç»è¿‡æµ“ç¼©ã€é›†ä¸­ã€ç»¼åˆå’Œæ¦‚æ‹¬ç­‰å¤„ç†åï¼Œè€Œä¸è‡³äºä¸¢å¤±ä¿¡æ¯çš„æœ¬è´¨ã€‚ 51.åè¯è§£é‡Šï¼šä¿¡æ¯çš„æ™®éæ€§ã€‚ ä¿¡æ¯çš„æ™®éæ€§ï¼šä¿¡æ¯æ˜¯æ™®éå­˜åœ¨çš„ï¼Œå®ƒæ˜¯äº‹ç‰©è¿åŠ¨å’ŒçŠ¶æ€æ”¹å˜çš„æ–¹å¼ã€‚å› æ­¤ï¼Œåªè¦æœ‰äº‹ç‰©å­˜åœ¨ï¼Œåªè¦æœ‰äº‹ç‰©è¿åŠ¨ï¼Œå°±ä¼šæœ‰å®ƒä»¬è¿åŠ¨çš„çŠ¶æ€å’Œæ–¹å¼ï¼Œå°±å­˜åœ¨ä¿¡æ¯ã€‚ 52.åè¯è§£é‡Šï¼šä¿¡æ¯çš„å…±äº«æ€§ã€‚ ä¿¡æ¯æ˜¯ä¸€ç§ç‰¹æ®Šçš„èµ„æºï¼Œåªèƒ½å…±äº«ä¸èƒ½äº¤æ¢ï¼Œåªæœ‰ä¼ä¸šçš„å…¨éƒ¨ä¿¡æ¯é›†ä¸­ç®¡ç†ï¼Œå……åˆ†å…±äº«ï¼Œä¿¡æ¯æ‰å¯èƒ½æˆä¸ºä¼ä¸šå¯åˆ©ç”¨çš„èµ„æºã€‚ 53.åè¯è§£é‡Šï¼šä¿¡æ¯çš„éæ¶ˆè€—æ€§ã€‚ ä¿¡æ¯çš„éæ¶ˆè€—æ€§æ˜¯æŒ‡ä¿¡æ¯ä¸å…¶ä»–ç‰©è´¨èµ„æºä¸åŒï¼Œå®ƒåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸ä½†ä¸ä¼šè¢«æ¶ˆè€—ï¼Œè€Œä¸”è¿˜å¯èƒ½å‡ºç°å†ç”Ÿæˆ–å¢æ®–ã€‚ 54.ç®€è¿°ä¿¡æ¯çš„å±‚æ¬¡æ€§çš„å«ä¹‰ã€‚ é€šå¸¸å°†ç®¡ç†åˆ†æˆä¸‰ä¸ªå±‚æ¬¡ï¼Œå³é«˜å±‚ç®¡ç†ï¼ˆæˆ˜ç•¥çº§ï¼‰ã€ä¸­å±‚ç®¡ç†ï¼ˆç­–ç•¥çº§ï¼‰å’ŒåŸºå±‚ç®¡ç†ï¼ˆæ‰§è¡Œå±‚ï¼‰ã€‚è¿™æ˜¯ä¿¡æ¯çš„å±‚æ¬¡æ€§ã€‚å¯¹äºåŒä¸€ä¸ªé—®é¢˜ï¼Œå¤„äºä¸åŒçš„ç®¡ç†å±‚æ¬¡ï¼Œè¦æ±‚ä¸åŒçš„ä¿¡æ¯ï¼Œå¯¹åŸºå±‚æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå¯¹é«˜å±‚æ¥è¯´å¯èƒ½æ˜¯æ•°æ®ã€‚å› æ­¤ï¼Œä¿¡æ¯ä¸ç®¡ç†ä¸€æ ·ï¼Œä¹Ÿå…·æœ‰å±‚æ¬¡æ€§ã€‚ 55.ç®€è¿°ä¿¡æ¯å…·æœ‰æ™®éæ€§çš„å«ä¹‰ã€‚ ä¿¡æ¯å…·æœ‰æ™®éæ€§çš„å«ä¹‰æ˜¯ï¼šä¿¡æ¯æ˜¯ä¸å˜å­˜åœ¨çš„ï¼Œå®ƒæ˜¯äº‹ç‰©è¿åŠ¨å’ŒçŠ¶æ€æ”¹å˜çš„æ–¹å¼ã€‚å› æ­¤ï¼Œåªè¦æœ‰äº‹ç‰©å­˜åœ¨ï¼Œåªè¦æœ‰äº‹ç‰©è¿åŠ¨ï¼Œå°±ä¼šæœ‰å®ƒä»¬è¿åŠ¨çš„çŠ¶æ€å’Œæ–¹å¼ï¼Œå°±å­˜åœ¨ä¿¡æ¯ã€‚ 56.åè¯è§£é‡Šï¼šä¿¡æ¯çš„æ‰©æ•£æ€§ã€‚ ä¿¡æ¯çš„æ‰©æ•£æ€§æ˜¯ä¿¡æ¯çš„æœ¬æ€§ï¼Œä¿¡æ¯åŠ›å›¾å†²ç ´ä¿å¯†çš„ã€éè‡ªç„¶çš„çº¦æŸï¼Œé€šè¿‡å„ç§æ¸ é“å’Œæ‰‹æ®µå‘å››é¢å…«æ–¹ä¼ æ’­ã€‚ 57.åè¯è§£é‡Šï¼šä¿¡æ¯çš„å˜æ¢æ€§ã€‚ ä¿¡æ¯çš„å˜æ¢æ€§æ˜¯æŒ‡ï¼šä¿¡æ¯æ˜¯äº‹ç‰©è¿åŠ¨çš„çŠ¶æ€å’Œæ–¹å¼ï¼Œä¸æ˜¯äº‹ç‰©æœ¬èº«ï¼Œå› æ­¤ä¿¡æ¯å¯ä»¥è´Ÿè½½åœ¨å…¶ä»–ä¸€åˆ‡å°½å¯èƒ½çš„ç‰©è´¨è½½ä½“å’Œèƒ½é‡å½¢å¼ä¸Šã€‚ 58.åè¯è§£é‡Šï¼šä¿¡æ¯çš„äº‹å®æ€§ã€‚ ä¿¡æ¯æè¿°äº†äº‹ç‰©è¿åŠ¨å’ŒçŠ¶æ€çš„æ”¹å˜ï¼Œå› æ­¤ï¼Œå®ƒå…·æœ‰äº‹å®æ€§ï¼Œè¿™æ˜¯ä¿¡æ¯çš„é‡è¦åŸºæœ¬æ€§è´¨ä¹‹ä¸€ï¼Œäº‹å®æ˜¯ä¿¡æ¯å…·æœ‰ä»·å€¼ï¼Œä¸ç¬¦åˆäº‹å®çš„ä¿¡æ¯å…¶ä»·å€¼å¯èƒ½ä¸ºè´Ÿï¼Œä¸ä½†ä¸ä¼šè¾…åŠ©å†³ç­–ï¼Œåè€Œä¼šå°†å†³ç­–å¼•å…¥æ­§é€”ã€‚ 59.åè¯è§£é‡Šï¼šä¿¡æ¯çš„å¯å‹ç¼©æ€§ã€‚ ä¿¡æ¯è¿›æ•…å®«æµ“ç¼©ã€é›†ä¸­ã€ç»¼åˆå’Œæ¦‚æ‹¬å¤„ç†åï¼Œä¸è‡³äºä¸¢å¤±ä¿¡æ¯çš„æœ¬è´¨ã€‚åœ¨è¿›è¡Œä¿¡æ¯å¤„ç†çš„æ—¶å€™åº”è¯¥æŠ“ä½äº‹ç‰©çš„ä¸»è¦çŸ›ç›¾ï¼Œä»æ•°æ®ä¸­å»ç²—å–ç²¾ï¼Œå»ä¼ªå­˜çœŸï¼Œå¯¹åŸå§‹æ•°æ®è¿›è¡Œé›†ä¸­ã€ç»¼åˆå’Œæ¦‚æ‹¬ï¼ŒæŠ½å–å‡ºæœ€èƒ½è¯´æ¸…é—®é¢˜çš„ä¿¡æ¯ï¼Œä»è¿™ç§æ„ä¹‰ä¸Šè®²ï¼Œä¿¡æ¯å…·æœ‰å¯å‹ç¼©æ€§ã€‚ 60.ä¿¡æ¯çš„åŸºæœ¬å±æ€§æœ‰å“ªäº›ï¼Ÿ ä¿¡æ¯çš„åŸºæœ¬å±æ€§ä¸»è¦æœ‰ï¼šæ™®éæ€§ã€äº‹å®æ€§ã€å±‚æ¬¡æ€§ã€å¯å‹ç¼©æ€§ã€æ‰©æ•£æ€§ã€éæ¶ˆè€—æ€§ã€å…±äº«æ€§ã€å˜æ¢æ€§å’Œå¯è½¬åŒ–æ€§ã€‚ ä¿¡æ¯å¤„ç†çš„ç”Ÿå‘½å‘¨æœŸ 1.åœ¨ä¿¡æ¯çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œä¿¡æ¯ç»´æŠ¤çš„ä¸Šä¸€ä¸ªé˜¶æ®µæ˜¯ä¿¡æ¯ï¼ˆBï¼‰ A æ”¶é›† B å­˜å‚¨ C ä¼ è¾“ D ä½¿ç”¨ 2.ä¿¡æ¯çš„ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºå¤šä¸ªè¿‡ç¨‹ï¼Œï¼ˆCï¼‰ä¸æ˜¯å…¶ä¸­çš„è¿‡ç¨‹ã€‚ A éœ€æ±‚ B æ”¶é›† C ä¿®æ”¹ D å¤„ç† 3.åœ¨ä¿¡æ¯çš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µä¸­ï¼Œä¿¡æ¯å¤„ç†çš„ä¸‹ä¸€ä¸ªé˜¶æ®µæ˜¯ä¿¡æ¯ï¼ˆCï¼‰ A æ‰‹æœº B ä¼ è¾“ C å­˜å‚¨ D ç»´æŠ¤ 4.ä¿¡æ¯çš„ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬å¤šä¸ªé˜¶æ®µï¼Œä¸‹åˆ—é˜¶æ®µä¸­ï¼Œç›¸äº’è¡”æ¥çš„æ˜¯ï¼ˆDï¼‰ A æ”¶é›†å’Œå¤„ç† B å¤„ç†å’Œä½¿ç”¨ C å­˜å‚¨å’Œä¼ è¾“ D ä¼ è¾“å’Œå¤„ç† 5.ä¸ºäº†ç¡®ä¿ä¿¡æ¯ä¼ è¾“çš„æ•ˆç‡ï¼Œä¸‹åˆ—é€‰é¡¹æ­£ç¡®çš„æ˜¯ï¼ˆBï¼‰ A å»ºç«‹å°å®¹é‡çš„ä¿¡æ¯é€šé“ B è§„å®šåˆç†çš„ä¿¡æ¯æµç¨‹ C å¢åŠ ä¿¡æ¯ä¼ é€’çš„ç¯èŠ‚ D ä¿¡æ¯ä¼ é€’çš„ç¯èŠ‚è¶Šå¤šï¼Œä¼ é€’çš„é€Ÿåº¦å°±è¶Šå¿« 6.ä¿¡æ¯ç»´æŠ¤çš„ä¸»è¦ç›®çš„ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A å‡†ç¡®æ€§ B åŠæ—¶æ€§ C å®‰å…¨æ€§ D å¼€æ”¾æ€§ 7.ä¸æ–­æ›´æ–°æ•°æ®ã€ç»´æŠ¤æ•°æ®çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§æŒ‡çš„æ˜¯ä¿¡æ¯ï¼ˆBï¼‰ A å¤„ç† B ç»´æŠ¤ C ä½¿ç”¨ D å­˜å‚¨ 8.ä¿¡æ¯çš„ï¼ˆAï¼‰æ˜¯ç®¡ç†äººå‘˜å¯¹ä¿¡æ¯çš„éœ€æ±‚è€Œè¿›è¡Œçš„åŸå§‹æ•°æ®çš„è·å–è¿‡ç¨‹ã€‚ A æ”¶é›† B å¤„ç† C ç»´æŠ¤ D ä½¿ç”¨ 9.ä¿¡æ¯ç»´æŠ¤çš„ä¸»è¦ç›®çš„ä¸åŒ…æ‹¬ï¼ˆBï¼‰ A ä¿è¯ä¿¡æ¯çš„å‡†ç¡®æ€§ B ä¿è¯ä¿¡æ¯çš„å…±äº«å‹ C ä¿è¯ä¿¡æ¯çš„åŠæ—¶æ€§ D ä¿è¯ä¿¡æ¯çš„å®‰å…¨æ€§ 10.åœ¨ä¿¡æ¯çš„å­˜å‚¨é—®é¢˜ä¸Šï¼Œä¸»è¦ç”±ä¿¡æ¯ä½¿ç”¨çš„ç›®çš„å†³å®šçš„æ˜¯ï¼ˆAï¼‰ A ä¿å­˜ä½•ç§ä¿¡æ¯ B ä¿¡æ¯å­˜å‚¨ä»‹è´¨ C ä¿¡æ¯çš„ä¿å­˜æ—¶é—´ D ä¿¡æ¯çš„å­˜å‚¨æ–¹å¼ 11.å¯¹æ”¶é›†çš„ä¿¡æ¯è¿›è¡Œå»ç²—å–ç²¾ã€ç”±è¡¨åŠé‡Œçš„å¤„ç†è¿‡ç¨‹æ˜¯ä¿¡æ¯ï¼ˆBï¼‰ A ç»´æŠ¤ B åŠ å·¥ C ä¼ è¾“ D ä½¿ç”¨ 12.ä¿¡æ¯çš„å­˜å‚¨æ¶‰åŠçš„é—®é¢˜ä¸åŒ…æ‹¬ï¼ˆBï¼‰ A ä¿å­˜ä»€ä¹ˆä¿¡æ¯ B ä¿å­˜ä½ç½® C å­˜å‚¨ä»‹è´¨ D å­˜å‚¨æ–¹å¼ 13.å…³äºä¿¡æ¯æ”¶é›†é˜¶æ®µé¢ä¸´çš„é—®é¢˜ï¼Œæœ€åçš„é—®é¢˜æ˜¯ç”¨ä½•ç§å½¢å¼å°†æ”¶é›†ç»“æœè¡¨ç°å‡ºæ¥ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 14.äºŒæ¬¡ä¿¡æ¯æ˜¯æŒ‡æŒ‰ç…§æŸç§è§„åˆ™ç»è¿‡å˜æ¢ã€ç»¼åˆåˆ†æå’Œç»Ÿè®¡æ¨æ–­æ‰€äº§ç”Ÿçš„ä¿¡æ¯çš„æ€»ç§°ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 15.ä¿¡æ¯å­˜å‚¨æ´»åŠ¨ä¸éœ€è¦è€ƒè™‘å­˜å‚¨æ–¹å¼çš„é—®é¢˜ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 16.ä¿å­˜ç¤¾ä¹ˆä¿¡æ¯æ˜¯ä¿¡æ¯å­˜å‚¨éœ€è¦è€ƒè™‘çš„é—®é¢˜ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 17.ä¿¡æ¯ç»´æŠ¤çš„ä¸»è¦ç›®çš„æ˜¯ä¿è¯ä¿¡æ¯çš„ï¼ˆABCDï¼‰ A ä¿å¯†æ€§ B å‡†ç¡®æ€§ C åŠæ—¶æ€§ D å®‰å…¨æ€§ E æ— è¯¯æ€§ 18.ä¸ºäº†ç¡®ä¿ä¿¡æ¯ä¼ è¾“çš„æ•ˆç‡ï¼Œéœ€è¦åšçš„å·¥ä½œåŒ…æ‹¬ï¼ˆBCDï¼‰ A å¢åŠ ä¼ é€’æ–¹å¼ B å»ºç«‹å¤§å®¹é‡çš„ä¿¡æ¯é€šé“ C è§„å®šåˆç†çš„ä¿¡æ¯æµç¨‹ D å‡å°‘ä¿¡æ¯ä¼ é€’çš„ç¯èŠ‚ 19.å…³äºä¿¡æ¯çš„å­˜å‚¨é—®é¢˜ï¼ŒåŒ…æ‹¬ï¼ˆABCDï¼‰ A ä¿å­˜ä»€ä¹ˆä¿¡æ¯ B ä¿å­˜æ—¶é—´ C å­˜å‚¨æ–¹å¼ D å­˜å‚¨ä»‹è´¨ 20.ä¿¡æ¯ç»´æŠ¤çš„ä¸»è¦ç›®çš„æ˜¯ä¿è¯ä¿¡æ¯çš„å‡†ç¡®æ€§ã€åŠæ—¶æ€§ã€å®‰å…¨æ€§å’Œä¿å¯†æ€§ã€‚ 21.ä¿¡æ¯ç»´æŠ¤çš„ä¸»è¦ç›®çš„æ˜¯ä¿è¯ä¿¡æ¯çš„å‡†ç¡®æ€§ã€åŠæ—¶æ€§ã€å®‰å…¨æ€§å’Œä¿å¯†æ€§ã€‚ 22.ä¿¡æ¯åŠ å·¥äº§ç”Ÿå»¶è¿Ÿï¼Œä½“ç°äº†ä¿¡æ¯çš„ç‰¹å¾æ˜¯æ»åæ€§ã€‚ 23.ä¸ºäº†ä¿è¯ä¿¡æ¯çš„ä¼ è¾“æ•ˆç‡ï¼Œæ³¨æ„ä¸¤ç‚¹ï¼šä¸€æ˜¯æŠ€æœ¯é—®é¢˜ï¼›äºŒæ˜¯è¯­ä¹‰é—®é¢˜ã€‚ 24.ä¿¡æ¯æŒ‰æ—¶é—´åˆ†ï¼Œå¯åˆ†ä¸ºä¸€æ¬¡ä¿¡æ¯å’ŒäºŒæ¬¡ä¿¡æ¯ã€‚ 25.ä¿¡æ¯ç»´æŠ¤çš„ä¸»è¦ç›®çš„æ˜¯ä¿è¯ä¿¡æ¯çš„å‡†ç¡®æ€§ã€åŠæ—¶æ€§ã€å®‰å…¨æ€§å’Œä¿å¯†æ€§ã€‚ 26.ä¿¡æ¯çš„æ”¶é›†æ˜¯æ ¹æ®ç®¡ç†äººå‘˜å¯¹ä¿¡æ¯çš„éœ€æ±‚è€Œè¿›è¡Œçš„åŸå§‹æ•°æ®çš„è·å–è¿‡ç¨‹ã€‚ 27.ä¿¡æ¯çš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µåŒ…æ‹¬éœ€æ±‚ã€æ”¶é›†ã€ä¼ è¾“ã€å¤„ç†ã€å­˜å‚¨ã€ç»´æŠ¤ã€ä½¿ç”¨å’Œé€€å‡ºç­‰è¿‡ç¨‹ã€‚ 28.ä¿¡æ¯æ”¶é›†çš„é¦–è¦é—®é¢˜æ˜¯å¦‚ä½•å°†éœ€è¦çš„ä¿¡æ¯è¯†åˆ«å‡ºæ¥ï¼Œå…¶æ¬¡æ˜¯æ”¶é›†çš„æ–¹æ³•é—®é¢˜ã€‚ 29.ä¿¡æ¯å­˜å‚¨æ´»åŠ¨æ¶‰åŠçš„é—®é¢˜åŒ…æ‹¬ä¿å­˜ä»€ä¹ˆä¿¡æ¯ã€å­˜å‚¨ä»‹è´¨ã€ä¿å­˜æ—¶é—´ã€å­˜å‚¨æ–¹å¼ã€‚ 30.ä¿¡æ¯æ”¶é›†çš„é¦–è¦é—®é¢˜æ˜¯å¦‚ä½•å°†éœ€è¦çš„ä¿¡æ¯è¯†åˆ«ï¼ˆæˆ–æ£€æµ‹ï¼‰å‡ºæ¥ã€‚ 31.ä»ä¿¡æ¯çš„äº§ç”Ÿåˆ°æœ€ç»ˆè¢«ä½¿ç”¨è€Œé€€å‡ºçš„è¿‡ç¨‹ï¼Œç§°ä¸ºä¿¡æ¯å¤„ç†çš„ç”Ÿå‘½å‘¨æœŸã€‚ 32.ä¿¡æ¯çš„äº§ç”Ÿã€ä½¿ç”¨è‡³é€€å‡ºçš„æ•´ä¸ªè¿‡ç¨‹ç§°ä¸ºä¿¡æ¯çš„ç”Ÿå‘½å‘¨æœŸã€‚ 33.ä¿¡æ¯å­˜å‚¨æ´»åŠ¨ä¸»è¦æ¶‰åŠä¿å­˜ä»€ä¹ˆä¿¡æ¯ã€å­˜å‚¨ä»‹è´¨ã€ä¿å­˜æ—¶é—´ã€å­˜å‚¨æ–¹å¼å››ä¸ªé—®é¢˜ã€‚ 34.ä¿¡æ¯çš„å­˜å‚¨æ´»åŠ¨ä¸»è¦æ¶‰åŠå“ªäº›é—®é¢˜ï¼Ÿ ä¿¡æ¯çš„å­˜å‚¨æ´»åŠ¨ä¸»è¦æ¶‰åŠä¿å­˜ä»€ä¹ˆä¿¡æ¯ã€å­˜å‚¨ä»‹è´¨ã€ä¿å­˜æ—¶é—´ã€å­˜å‚¨æ–¹å¼å››ä¸ªé—®é¢˜ã€‚ 35.åè¯è§£é‡Šï¼šä¿¡æ¯çš„ç»´æŠ¤ã€‚ ä¿¡æ¯ç»´æŠ¤ï¼Œç‹­ä¹‰ä¸Šæ˜¯æŒ‡ä¸æ–­æ›´æ–°æ•°æ®ã€ç»´æŠ¤æ•°æ®çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ï¼Œä½¿ä¿¡æ¯ä¿æŒå¯ç”¨çŠ¶æ€ã€‚å¹¿ä¹‰ä¸Šæ˜¯æŒ‡ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘å’Œè¿è¡Œä¸­çš„ä¸€åˆ‡æ•°æ®ç®¡ç†å·¥ä½œã€‚ 36.ä¿¡æ¯ç»´æŠ¤çš„ç›®çš„ ä¿¡æ¯ç»´æŠ¤çš„ç›®çš„æ˜¯ä¿è¯ä¿¡æ¯çš„å‡†ç¡®æ€§ã€åŠæ—¶æ€§ã€å®‰å…¨æ€§å’Œä¿å¯†æ€§ã€‚ 37.ä¿è¯ä¿¡æ¯çš„ä¼ è¾“æ•ˆç‡ï¼Œæˆ‘ä»¬éœ€è¦åšå“ªäº›å·¥ä½œï¼Ÿ 1.å»ºç«‹å¤§å®¹é‡çš„ä¿¡æ¯é€šé“ï¼›2.è§„å®šåˆç†çš„ä¿¡æ¯æµç¨‹ï¼›3.å‡å°‘ä¿¡æ¯ä¼ é€’çš„ç¯èŠ‚ã€‚ 38.åè¯è§£é‡Šï¼šä¿¡æ¯çš„æ”¶é›†ã€‚ ä¿¡æ¯çš„æ”¶é›†æ˜¯æ ¹æ®ç®¡ç†äººå‘˜å¯¹ä¿¡æ¯çš„éœ€æ±‚è€Œè¿›è¡Œçš„åŸå§‹æ•°æ®çš„è·å–è¿‡ç¨‹ã€‚ 39.ä¿¡æ¯ä¼ è¾“æ•ˆç‡éœ€è¦æ³¨æ„çš„é—®é¢˜ã€‚ ä¸ºäº†ç¡®ä¿ä¿¡æ¯ä¼ è¾“çš„æ•ˆç‡ï¼Œå¿…é¡»æ³¨æ„ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€æ˜¯æŠ€æœ¯é—®é¢˜ï¼Œå³å¦‚ä½•å¿«é€Ÿã€å‡†ç¡®åœ°ä¼ è¾“ä¿¡æ¯ï¼›äºŒæ˜¯è¯­ä¹‰é—®é¢˜ï¼Œå³åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¦‚ä½•ç¡®åˆ‡åœ°è¡¨è¾¾ä¿¡æ¯çš„æ„ä¹‰ã€‚ 40.ç¡®ä¿ä¿¡æ¯çš„ä¼ è¾“æ•ˆç‡ï¼Œè¦åšåˆ°å“ªå‡ ç‚¹ï¼Ÿ ä¸ºäº†ç¡®ä¿ä¿¡æ¯ä¼ è¾“çš„æ•ˆç‡ï¼Œéœ€è¦åšåˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š1.å»ºç«‹å¤§å®¹é‡çš„ä¿¡æ¯é€šé“ï¼›2.è§„å®šåˆç†çš„ä¿¡æ¯æµç¨‹ï¼›3.å‡å°‘ä¿¡æ¯ä¼ é€’çš„ç¯èŠ‚ã€‚ 41.åè¯è§£é‡Šï¼šä¿¡æ¯å¤„ç†çš„ç”Ÿå‘½å‘¨æœŸã€‚ ä¿¡æ¯ä¸å…¶ä»–èµ„æºä¸€æ ·å…·æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œä»ä¿¡æ¯çš„äº§ç”Ÿåˆ°æœ€ç»ˆè¢«ä½¿ç”¨è€Œå‘æŒ¥ä½œç”¨ï¼Œå¯å°†ä¿¡æ¯çš„ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºéœ€æ±‚ã€æ”¶é›†ã€ä¼ è¾“ã€å¤„ç†ã€å­˜å‚¨ã€ç»´æŠ¤ã€ä½¿ç”¨å’Œé€€å‡ºç­‰è¿‡ç¨‹ã€‚ 42.åè¯è§£é‡Šï¼šä¿¡æ¯åŠ å·¥ã€‚ ä¿¡æ¯åŠ å·¥å°±æ˜¯å¯¹æ”¶é›†çš„ä¿¡æ¯è¿›è¡Œå»çœŸä¼ªã€å»ç²—å–ç²¾ã€ç”±è¡¨åŠé‡Œã€ç”±æ­¤åŠå½¼çš„åŠ å·¥è¿‡ç¨‹ã€‚ ç®¡ç†ä¿¡æ¯ä¸å†³ç­– 1.é«˜å±‚ç®¡ç†è€…å¯¹ä¿¡æ¯çš„è¦æ±‚æ˜¯ï¼ˆBï¼‰ A ä¿¡æ¯æ¥æºä¸»è¦æ˜¯ä¼ä¸šå†…éƒ¨ B ä¿¡æ¯çš„ç²¾åº¦è¦æ±‚æ¯”è¾ƒé«˜ C ä¿¡æ¯çš„èŒƒå›´æ¯”è¾ƒå®½ D ä¿¡æ¯å‘ç”Ÿæ—¶é—´æ˜¯è¿‡å»çš„ 2.ä»¥ä¸‹å…³äºç®¡ç†ä¿¡æ¯çš„ç‰¹æ€§ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆï¼‰ A ä¿¡æ¯æ¥æºçš„åˆ†æ•£æ€§ B ä¿¡æ¯å¤„ç†æ–¹å¼çš„å•ä¸€æ€§ C ä¿¡æ¯é‡å¤§æ¥æºå•çº¯ D ä¿¡æ¯åŠ å·¥å’Œä½¿ç”¨ä¸€è‡´æ€§ 3.ä»¥ä¸‹å…³äºä¿¡æ¯ä¸å†³ç­–çš„å…³ç³»ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆAï¼‰ A å†³ç­–è¿‡ç¨‹å°±æ˜¯ä¿¡æ¯å¤„ç†è¿‡ç¨‹ B å†³ç­–ä¿¡æ¯çš„æ•°é‡è¶Šå¤šè¶Šå¥½ C ä¸åŒå±‚æ¬¡å†³ç­–éœ€è¦ç›¸åŒä¿¡æ¯ D é«˜å±‚å†³ç­–åªéœ€ç»“æ„åŒ–ä¿¡æ¯ 4.åŸºå±‚ç®¡ç†è€…å¯¹ä¿¡æ¯è¦æ±‚çš„ç‰¹ç‚¹æ˜¯ï¼ˆDï¼‰ A ä¿¡æ¯æ¥æºä»¥å¤–éƒ¨ä¸ºä¸» B ä¿¡æ¯èŒƒå›´è¾ƒå®½ C ä¿¡æ¯å‘ç”Ÿæ—¶é—´ä¸ç¡®å®š D ä¿¡æ¯ç²¾åº¦å¾ˆé«˜ 5.ä»¥ä¸‹å…³äºç®¡ç†ä¿¡æ¯çš„ç‰¹æ€§ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆAï¼‰ A ä¿¡æ¯é‡å¤§ï¼Œæ¥æºå¤šæ · B ä¿¡æ¯åŠ å·¥å’Œä½¿ç”¨çš„ä¸€è‡´æ€§ C ä¿¡æ¯æ¥æºçš„é›†ä¸­æ€§ D ä¿¡æ¯å¤„ç†æ–¹å¼çš„å•ä¸€æ€§ 6.ä¸­å±‚ç®¡ç†è€…å¯¹ä¿¡æ¯è¦æ±‚çš„ç‰¹ç‚¹æ˜¯ï¼ˆDï¼‰ A ä¿¡æ¯æ¥è‡ªå¤–éƒ¨ B ä¿¡æ¯å‘ç”Ÿçš„æ—¶é—´æ˜¯å½“å‰çš„ C ä¿¡æ¯å†…å®¹å…·ä½“ D ä¿¡æ¯çš„ç²¾åº¦è¦æ±‚æ˜¯è¾ƒé«˜çš„ 7.å†³ç­–è¿‡ç¨‹ä¸­çš„æ¯ä¸€æ­¥éƒ½ç¦»ä¸å¼€ä¿¡æ¯ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 8.å…³äºç®¡ç†ä¿¡æ¯ä¸å†³ç­–çš„å…³ç³»ï¼Œä½å±‚ç®¡ç†çš„å‘ç”Ÿé¢‘ç‡æ˜¯ä¸€èˆ¬ä½¿ç”¨ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 9.ä¸­å±‚ç®¡ç†çš„ä¿¡æ¯èŒƒå›´è¾ƒçª„ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 10.ç®¡ç†ä¿¡æ¯çš„å‘ç”Ÿã€åŠ å·¥å’Œä½¿ç”¨æ—¶é—´ã€ç©ºé—´ä¸Šæ˜¯ä¸€è‡´çš„ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 11.ç®¡ç†ä¿¡æ¯çš„ç‰¹ç‚¹åŒ…æ‹¬ï¼ˆABCDï¼‰ A ä¿¡æ¯æ¥æºçš„åˆ†æ•£æ€§ B ä¿¡æ¯é‡å¤§ä¸”å¤šæ ·æ€§ C ä¿¡æ¯å¤„ç†æ–¹å¼çš„å¤šæ ·æ€§ D ä¿¡æ¯çš„å‘ç”Ÿã€åŠ å·¥å’Œä½¿ç”¨æ—¶é—´ã€ç©ºé—´ä¸Šçš„ä¸ä¸€è‡´æ€§ 12.ç®¡ç†ä¿¡æ¯çš„ç‰¹ç‚¹ä¸­æœ‰ï¼šä¿¡æ¯é‡å¤§ä¸”å¤šæ ·æ€§ã€‚ 13.ä¸åŒçš„ç®¡ç†å±‚æ¬¡éœ€è¦ä¸åŒå±‚æ¬¡çš„ä¿¡æ¯ï¼Œé«˜å±‚ä¿¡æ¯å¤§å¤šæ•°æ¥è‡ªç»„ç»‡çš„å¤–éƒ¨ã€‚ 14.ç®€è¿°ç®¡ç†ä¿¡æ¯é™¤äº†å…·æœ‰ä¿¡æ¯çš„ä¸€èˆ¬å±æ€§å¤–ï¼Œè¿˜æœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ ç®¡ç†ä¿¡æ¯é™¤äº†å…·æœ‰ä¿¡æ¯çš„ä¸€èˆ¬å±æ€§å¤–ï¼Œè¿˜æœ‰çš„ç‰¹ç‚¹ï¼š1.ä¿¡æ¯æ¥æºçš„åˆ†æ•£æ€§ã€‚2.ä¿¡æ¯å¤§ä¸”å¤šæ ·æ€§ã€‚3.ä¿¡æ¯å¤„ç†æ–¹æ³•çš„å¤šæ ·æ€§ã€‚4.ä¿¡æ¯çš„å‘ç”Ÿã€åŠ å·¥å’Œä½¿ç”¨æ—¶é—´ã€ç©ºé—´ä¸Šçš„ä¸ä¸€è‡´æ€§ã€‚ 15.ç®€è¿°ä¿¡æ¯ä¸å†³ç­–çš„å…³ç³»ã€‚ 1.å†³ç­–éœ€è¦ä¿¡æ¯çš„æ”¯æŒã€‚å†³ç­–çš„ç›®çš„æ˜¯ä¸ºäº†æ¶ˆé™¤ä¸ç¡®å®šæ€§ï¼Œéœ€è¦å¤§é‡ã€å‡†ç¡®ã€å…¨é¢ã€åŠæ—¶çš„ä¿¡æ¯ä½œä¸ºä¾æ®ã€‚å¯ä»¥è¯´å†³ç­–è¿‡ç¨‹ä¸­çš„æ¯ä¸€æ­¥éƒ½ç¦»ä¸å¼€ä¿¡æ¯ï¼Œä»æŸç§ç¨‹åº¦ä¸Šè®²ï¼Œå†³ç­–è¿‡ç¨‹å¯ä»¥è§†ä¸ºä¸€ä¸ªä¿¡æ¯å¤„ç†è¿‡ç¨‹ã€‚2.ä¸åŒçš„ç®¡ç†å±‚æ¬¡éœ€è¦ä¸åŒçš„ä¿¡æ¯ã€‚ç®¡ç†å†³ç­–éœ€è¦ä¿¡æ¯ï¼Œä½†å¹¶ä¸æ˜¯è¯´ä¿¡æ¯è¶Šå¤šè¶Šå¥½ï¼Œå®é™…ä¸Šï¼Œä¸åŒç¨‹åº¦çš„å†³ç­–éœ€è¦ä¸åŒçš„ä¿¡æ¯ï¼Œæ‰€æœ‰ï¼Œå¦‚ä½•æŠŠé€‚å½“çš„ä¿¡æ¯æä¾›ç»™ä¸åŒçš„ç®¡ç†å†³ç­–è€…æ˜¯éå¸¸é‡è¦çš„ã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äºŒç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯†/ç¬¬ä¸‰èŠ‚_ç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯†.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äºŒç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯†/ç¬¬ä¸‰èŠ‚_ç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯†.html","title":"ç¬¬ä¸‰èŠ‚ï¼šç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯†","keywords":"","body":"ç¬¬ä¸‰èŠ‚ï¼šç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯† ç³»ç»Ÿçš„æ¦‚å¿µ 1.ç³»ç»Ÿå¯ä»¥åˆ†è§£çš„åŸºæœ¬è¦ç´ ä¸åŒ…æ‹¬ï¼ˆCï¼‰ A è¾“å…¥ B å¤„ç† C æ›´æ–° D åé¦ˆ 2.ä»¥ä¸‹å…³äºç³»ç»Ÿçš„æ¦‚å¿µï¼Œé”™è¯¯çš„æ˜¯ï¼ˆDï¼‰ A ç³»ç»Ÿéƒ½ç”±è¦ç´ ç»„æˆ B ç³»ç»Ÿéƒ½æœ‰ä¸€å®šçš„ç»“æ„ C ç³»ç»Ÿéƒ½æœ‰ä¸€å®šçš„ç›®çš„ D ç³»ç»Ÿéƒ½æ˜¯é—­ç¯ç³»ç»Ÿ 3.ä¸‹åˆ—å…³äºç³»ç»Ÿçš„æ¦‚å¿µï¼Œé”™è¯¯çš„æ˜¯ï¼ˆCï¼‰ A ç³»ç»Ÿéƒ½æœ‰ä¸€å®šçš„åŠŸèƒ½ B ç³»ç»Ÿéƒ½æœ‰è¦ç´ ç»„æˆ C ç³»ç»Ÿæ•´ä½“çš„æ€§èƒ½ç­‰äºå„è¦ç´ çš„æ€§èƒ½åªå’Œ D ç³»ç»Ÿéƒ½æœ‰ä¸€å®šçš„ç»“æ„ 4.ç³»ç»Ÿå­˜åœ¨çš„åŸºæœ¬æ¡ä»¶åŒ…æ‹¬ï¼ˆABCï¼‰ A ç³»ç»Ÿæ˜¯ç”±è‹¥å¹²è¦ç´ ç»„æˆçš„ B ç³»ç»Ÿæœ‰ä¸€å®šçš„ç»“æ„ C ç³»ç»Ÿæœ‰ä¸€å®šçš„åŠŸèƒ½ D ç³»ç»Ÿçš„åŠŸèƒ½è¶Šå¤šè¶Šå¥½ 5.ç³»ç»Ÿå¯ä»¥åˆ†è§£ä¸ºè¾“å…¥ã€å¤„ç†ã€è¾“å‡ºã€åé¦ˆå’Œæ§åˆ¶äº”ä¸ªåŸºæœ¬è¦ç´ ã€‚ 6.æ— è®ºä½•ç§ç³»ç»Ÿéƒ½å¯ä»¥åˆ†è§£ä¸ºè¾“å…¥ã€å¤„ç†ã€è¾“å‡ºã€åé¦ˆå’Œæ§åˆ¶äº”ä¸ªåŸºæœ¬è¦ç´ ã€‚ 7.ç³»ç»Ÿå¯ä»¥åˆ†è§£çš„äº”ä¸ªè¦ç´ åˆ†åˆ«æ˜¯è¾“å…¥ã€å¤„ç†ã€è¾“å‡ºã€åé¦ˆå’Œæ§åˆ¶ã€‚ 8.ç³»ç»Ÿå­˜åœ¨çš„ä¸‰ä¸ªåŸºæœ¬æ¡ä»¶åŒ…æ‹¬ï¼šç”±è‹¥å¹²è¦ç´ ï¼ˆéƒ¨åˆ†ï¼‰ç»„æˆã€æœ‰ä¸€å®šçš„ç»“æ„ã€æœ‰ä¸€å®šçš„åŠŸèƒ½ã€‚ 9.ç³»ç»Ÿå­˜åœ¨çš„ä¸‰ä¸ªåŸºæœ¬æ¡ä»¶åŒ…æ‹¬ï¼šç”±è‹¥å¹²è¦ç´ ï¼ˆéƒ¨åˆ†ï¼‰ç»„æˆã€æœ‰ä¸€å®šçš„ç»“æ„ã€æœ‰ä¸€å®šçš„åŠŸèƒ½ã€‚ 10.ä»å“ªå‡ æ–¹é¢å¯¹ç³»ç»Ÿè¿›è¡Œåˆ†æï¼Ÿ æˆ‘ä»¬ä¸€èˆ¬ä»ç³»ç»Ÿçš„è¦ç´ ã€ç»“æ„å’ŒåŠŸèƒ½ä¸‰ä¸ªæ–¹é¢è¿›è¡Œåˆ†æï¼š1.ç³»ç»Ÿæ˜¯ç”±è‹¥å¹²è¦ç´ ç»„æˆçš„ã€‚2.ç³»ç»Ÿæœ‰ä¸€å®šçš„ç»“æ„ã€‚3.ç³»ç»Ÿæœ‰ä¸€å®šçš„åŠŸèƒ½ã€‚ç³»ç»Ÿçš„åŠŸèƒ½æ˜¯ç³»ç»Ÿä¸å¤–éƒ¨ç¯å¢ƒç›¸äº’è”ç³»å’Œç›¸äº’ä½œç”¨è¡¨ç°å‡ºæ¥çš„æ€§è´¨ã€èƒ½åŠ›å’ŒåŠŸèƒ½ã€‚ 11.åè¯è§£é‡Šï¼šç³»ç»Ÿã€‚ ç³»ç»Ÿæ˜¯ç”±ä¸€äº›ç›¸äº’è”ç³»ã€ç›¸äº’åˆ¶çº¦çš„è‹¥å¹²ç»„æˆéƒ¨åˆ†ç»“åˆè€Œæˆçš„ã€å…·æœ‰ç‰¹å®šåŠŸèƒ½çš„ä¸€ä¸ªæœ‰æœºæ•´ä½“ï¼ˆé›†åˆï¼‰ã€‚ 12.ç®€è¿°ç³»ç»Ÿå­˜åœ¨çš„åŸºæœ¬æ¡ä»¶ã€‚ ç³»ç»Ÿå­˜åœ¨çš„ä¸‰ä¸ªåŸºæœ¬æ¡ä»¶ï¼š1.ç³»ç»Ÿæ˜¯ç”±è‹¥å¹²è¦ç´ ï¼ˆéƒ¨åˆ†ï¼‰ç»„æˆçš„ã€‚2.ç³»ç»Ÿæœ‰ä¸€å®šçš„ç»“æ„ã€‚3.ç³»ç»Ÿæœ‰ä¸€å®šçš„åŠŸèƒ½ã€‚ ç³»ç»Ÿçš„åˆ†ç±» 1.æŒ‰ç³»ç»Ÿä¸ç¯å¢ƒçš„å…³ç³»åˆ†ç±»ï¼Œç”Ÿç‰©ç³»ç»Ÿå±äºï¼ˆBï¼‰ A å°é—­ç³»ç»Ÿ B å¼€æ”¾ç³»ç»Ÿ C æ¦‚å¿µç³»ç»Ÿ D ç‰©ç†ç³»ç»Ÿ 2.ç³»ç»ŸæŒ‰å¤æ‚ç¨‹åº¦åˆ†ç±»ï¼Œå®—æ•™å±äºï¼ˆBï¼‰ A ç”Ÿç‰©ç³»ç»Ÿ B ç¤¾ä¼šç³»ç»Ÿ C ç‰©ç†ç³»ç»Ÿ D è‡ªç„¶ç³»ç»Ÿ 3.ç³»ç»ŸæŒ‰å¤æ‚ç¨‹åº¦åˆ†ç±»ï¼Œæœ€å¤æ‚çš„æ˜¯ï¼ˆBï¼‰ A è‡ªç„¶ç³»ç»Ÿ B å®‡å®™ç³»ç»Ÿ C ç‰©ç†ç³»ç»Ÿ D ç”Ÿç‰©ç³»ç»Ÿ 4.ç³»ç»ŸæŒ‰å¤æ‚ç¨‹åº¦åˆ†ç±»ï¼Œè‰ºæœ¯å±äºï¼ˆDï¼‰ A è‡ªç„¶ç³»ç»Ÿ B ç”Ÿç‰©ç³»ç»Ÿ C ç‰©ç†ç³»ç»Ÿ D ç¤¾ä¼šç³»ç»Ÿ 5.ç³»ç»ŸæŒ‰ç…§æ˜¯å¦æœ‰åé¦ˆæœºåˆ¶åˆ†ä¸ºï¼ˆBï¼‰ A å°é—­ç³»ç»Ÿå’Œå¼€æ”¾ç³»ç»Ÿ B å¼€ç¯ç³»ç»Ÿå’Œé—­ç¯ç³»ç»Ÿ C æ¦‚å¿µç³»ç»Ÿå’Œç‰©ç†ç³»ç»Ÿ D ç¤¾ä¼šç³»ç»Ÿå’Œç»æµç³»ç»Ÿ 6.æŒ‰å¤æ‚ç¨‹åº¦åˆ†ç±»ï¼Œæœ€å¤æ‚çš„ç³»ç»Ÿæ˜¯ï¼ˆAï¼‰ A å®‡å®™ç³»ç»Ÿ B ç‰©ç†ç»“æ„ç³»ç»Ÿ C äººç±»ç³»ç»Ÿ D ç¤¾ä¼šç³»ç»Ÿ 7.é—­ç¯ç³»ç»Ÿæ˜¯ç³»ç»Ÿçš„è¾“å‡ºé‡ä¸å¯¹ç³»ç»Ÿçš„æ§åˆ¶äº§ç”Ÿä»»ä½•å½±å“ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 8.ç³»ç»ŸæŒ‰å¤æ‚ç¨‹åº¦åˆ†ç±»è‰ºæœ¯å±äºè‡ªç„¶ç³»ç»Ÿã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 9.æŒ‰å¤æ‚ç¨‹åº¦åˆ†ç±»ï¼Œè®¡ç®—æœºã€æ±½è½¦ã€æ¡¥æ¢ç­‰å±äºç‰©ç†ç»“æ„ç³»ç»Ÿã€‚ 10.æŒ‰ç³»ç»Ÿçš„æŠ½è±¡ç¨‹åº¦åˆ†ç±»ï¼Œæœ€æŠ½è±¡çš„ç³»ç»Ÿæ˜¯æ¦‚å¿µç³»ç»Ÿã€‚ 11.å¦‚ä¸€ä¸ªç³»ç»Ÿçš„æ§åˆ¶å™¨èƒ½å¤Ÿå¯¹è¾“å‡ºè¡Œä¸ºå’ŒæœŸæœ›è¡Œä¸ºä¹‹é—´çš„åå·®è¿›è¡Œè°ƒèŠ‚ï¼Œæ¶ˆé™¤åå·®ï¼Œä»¥è·å¾—é¢„æœŸçš„ç³»ç»Ÿæ€§èƒ½ï¼Œåˆ™è¿™ä¸ªç³»ç»Ÿå±äºé—­ç¯ï¼ˆæˆ–åé¦ˆï¼‰ç³»ç»Ÿã€‚ 12.æ¶‰åŠç»æµå’Œæ”¿æ²»ï¼ŒæŒ‰å¤æ‚ç¨‹åº¦åˆ†ç±»çš„ç³»ç»Ÿæ˜¯ç¤¾ä¼šç³»ç»Ÿã€‚ 13.è¾“å…¥è¾“å‡ºä¹‹é—´å­˜åœ¨åé¦ˆæœºåˆ¶çš„æ˜¯é—­ç¯ï¼ˆæˆ–åé¦ˆï¼‰ç³»ç»Ÿã€‚ 14.æŒ‰æŠ½è±¡ç¨‹åº¦åˆ†ç±»ï¼Œå®¢è§‚å­˜åœ¨å¯ä»¥å®é™…è¿ä½œçš„ç³»ç»Ÿæ˜¯ç‰©ç†ç³»ç»Ÿã€‚ 15.æŒ‰ç³»ç»Ÿä¸ç¯å¢ƒçš„å…³ç³»åˆ†ç±»ï¼Œå¯åˆ†ä¸ºå°é—­ç³»ç»Ÿå’Œå¼€æ”¾ç³»ç»Ÿ*ã€‚ 16.æŒ‰æ˜¯å¦æœ‰åé¦ˆæœºåˆ¶åˆ†ç±»ï¼Œå¯åˆ†ä¸ºå¼€ç¯ç³»ç»Ÿå’Œé—­ç¯ç³»ç»Ÿã€‚ 17.ä»ç³»ç»Ÿåˆ†ç±»è¯´ï¼Œæ”¿æ²»ã€ç»æµã€æ³•å¾‹å’Œå®—æ•™å±äºç¤¾ä¼šç³»ç»Ÿã€‚ 18.å¦‚æœä¸€ä¸ªç³»ç»Ÿçš„è¾“å‡ºé‡ä¸å¯¹ç³»ç»Ÿçš„æ§åˆ¶äº§ç”Ÿä»»ä½•å½±å“ï¼Œåˆ™è¿™ä¸ªç³»ç»Ÿå±äºå¼€ç¯ç³»ç»Ÿã€‚ 19.å¦‚æœä¸€ä¸ªç³»ç»Ÿçš„è¾“å‡ºç«¯ä¸è¾“å…¥ç«¯ä¹‹é—´ä¸å­˜åœ¨åé¦ˆï¼Œè¿™æ ·çš„ç³»ç»Ÿç§°ä¸ºå¼€ç¯ç³»ç»Ÿã€‚ 20.æŒ‰ç³»ç»Ÿçš„æŠ½è±¡ç¨‹åº¦åˆ†ç±»å¯åˆ†ä¸ºä¸‰ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼šæ¦‚å¿µç³»ç»Ÿã€é€»è¾‘ç³»ç»Ÿã€ç‰©ç†ç³»ç»Ÿã€‚ 21.å¦‚ä¸€ä¸ªç³»ç»Ÿå¯ä»¥ä¸ç¯å¢ƒè¿›è¡Œä¿¡æ¯å’Œèƒ½é‡äº¤æ¢ï¼Œåˆ™è¿™ä¸ªç³»ç»Ÿå±äºå¼€æ”¾ç³»ç»Ÿã€‚ 22.å¦‚ä¸€ä¸ªç³»ç»Ÿä¸ä¸ç¯å¢ƒè¿›è¡Œä¿¡æ¯å’Œèƒ½é‡äº¤æ¢ï¼Œä¸ä¸ºç³»ç»Ÿä»¥å¤–çš„å› ç´ æ‰€å¹²æ‰°ï¼Œåˆ™è¿™ä¸ªç³»ç»Ÿå±äºå°é—­ç³»ç»Ÿã€‚ 23.æŒ‰ç³»ç»Ÿä¸ç¯å¢ƒçš„å…³ç³»åˆ†ç±»ï¼Œç¤¾ä¼šç³»ç»Ÿå±äºå¼€æ”¾ç³»ç»Ÿã€‚ 24.äººç±»ç³»ç»ŸæŒ‰ç³»ç»Ÿä¸ç¯å¢ƒåˆ†ç±»ï¼Œå±äºå¼€æ”¾ç³»ç»Ÿã€‚ 25.æŒ‰ç³»ç»Ÿçš„æŠ½è±¡ç¨‹åº¦åˆ†ç±»å¯åˆ†ä¸ºï¼šæ¦‚å¿µç³»ç»Ÿã€é€»è¾‘ç³»ç»Ÿã€ç‰©ç†ç³»ç»Ÿã€‚ 26.åè¯è§£é‡Šï¼šé—­ç¯ç³»ç»Ÿã€‚ å¦‚ä¸€ä¸ªç³»ç»Ÿçš„æ§åˆ¶å™¨èƒ½å¤Ÿå¯¹è¾“å‡ºè¡Œä¸ºå’ŒæœŸæœ›è¡Œä¸ºä¹‹é—´çš„åå·®è¿›è¡Œè°ƒæ•´ï¼Œæ¶ˆé™¤åå·®ï¼Œä»¥è·å¾—é¢„æœŸçš„ç³»ç»Ÿæ€§èƒ½ï¼Œåˆ™è¿™ä¸ªç³»ç»Ÿå±äºé—­ç¯ç³»ç»Ÿï¼ˆæˆ–åé¦ˆç³»ç»Ÿï¼‰ã€‚ 27.åè¯è§£é‡Šï¼šé€»è¾‘ç³»ç»Ÿã€‚ é€»è¾‘ç³»ç»Ÿæ˜¯åœ¨æ¦‚å¿µçš„åŸºç¡€ä¸Šï¼Œæ„é€ å‡ºæ¥çš„åŸç†ä¸Šè¡Œå¾—é€šçš„ç³»ç»Ÿã€‚ 28.åè¯è§£é‡Šï¼šå¼€ç¯ç³»ç»Ÿã€‚ æŒ‰æ˜¯å¦æœ‰åé¦ˆæœºåˆ¶åˆ†ç±»ï¼Œå¯åˆ†ä¸ºå¼€ç¯ç³»ç»Ÿå’Œé—­ç¯ç³»ç»Ÿã€‚å¦‚æœä¸€ä¸ªç³»ç»Ÿçš„è¾“å‡ºç«¯å’Œè¾“å…¥ç«¯ä¹‹é—´ä¸å­˜åœ¨åé¦ˆï¼Œç³»ç»Ÿçš„è¾“å‡ºé‡ä¸å¯¹ç³»ç»Ÿçš„æ§åˆ¶äº§ç”Ÿä»»ä½•å½±å“ï¼Œè¿™æ ·çš„ç³»ç»Ÿç§°å¼€ç¯ç³»ç»Ÿã€‚ 29.ç³»ç»ŸæŒ‰å¤æ‚ç¨‹åº¦çš„åˆ†ç±»æœ‰å“ªäº›ï¼Ÿ ç³»ç»ŸæŒ‰å¤æ‚ç¨‹åº¦åˆ†ç±»åˆ†ä¸ºï¼šç‰©ç†ç»“æ„ç³»ç»Ÿã€ç”Ÿç‰©ç³»ç»Ÿã€äººç±»ç³»ç»Ÿã€ç¤¾ä¼šç³»ç»Ÿã€å®‡å®™ç³»ç»Ÿã€‚ ç³»ç»Ÿçš„å±æ€§ 1.ä¸åŒå±‚æ¬¡ä¸Šçš„ç³»ç»Ÿè¿åŠ¨éƒ½å­˜åœ¨ç»„ç»‡åŒ–çš„å€¾å‘ï¼Œè€Œä¸åŒç³»ç»Ÿä¹‹é—´å­˜åœ¨ç€ç³»ç»ŸåŒæ„ï¼Œä½“ç°äº†ç³»ç»Ÿçš„ï¼ˆAï¼‰ A ç»Ÿä¸€æ€§ B æ•´ä½“æ€§ C å±‚æ¬¡æ€§ D å…³è”æ€§ 2.å¦‚æœä¸€ä¸ªç³»ç»Ÿç”±è‹¥å¹²å­ç³»ç»Ÿç»„æˆï¼Œè¯¥ç³»ç»Ÿæœ¬èº«åˆæ˜¯æ›´å¤§ç³»ç»Ÿçš„å­ç³»ç»Ÿï¼Œè¿™ç§ç‰¹æ€§ç§°ä¸ºç³»ç»Ÿçš„ï¼ˆBï¼‰ A æ•´ä½“æ€§ B å±‚æ¬¡æ€§ C æ‰©å±•æ€§ D ç»Ÿä¸€æ€§ 3.ç³»ç»Ÿçš„å±æ€§ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A æ•´ä½“æ€§ B å…³è”æ€§ C å±‚æ¬¡æ€§ D å…±äº«æ€§ 4.ä¸€ä¸ªç³»ç»Ÿæ€»æ˜¯ç”±è‹¥å¹²å­ç³»ç»Ÿç»„æˆçš„ï¼Œè¯¥ç³»ç»Ÿæœ¬èº«åˆå¯çœ‹åšæ›´å¤§ç³»ç»Ÿçš„ä¸€ä¸ªå­ç³»ç»Ÿï¼Œè¿™å°±æ„æˆäº†ç³»ç»Ÿçš„ï¼ˆCï¼‰ A å…³è”æ€§ B ç»Ÿä¸€æ€§ C å±‚æ¬¡æ€§ D æ•´ä½“æ€§ 5.ç³»ç»Ÿçš„æ€»ä½“æ€§èƒ½å¤§äºå„è¦ç´ æ€§èƒ½åªå’Œçš„ç‰¹æ€§ç§°ä¸ºç³»ç»Ÿçš„ï¼ˆAï¼‰ A æ•´ä½“æ€§ B ç»Ÿä¸€æ€§ C å…³è”æ€§ D å±‚æ¬¡æ€§ 6.ç³»ç»Ÿæ€§èƒ½å¤§äºå„å­ç³»ç»Ÿæ€§èƒ½ä¹‹å’Œçš„ç‰¹æ€§ï¼Œç§°ä¸ºç³»ç»Ÿçš„ï¼ˆCï¼‰ A ç»Ÿä¸€æ€§ B å…³è”æ€§ C æ•´ä½“æ€§ D å±‚æ¬¡æ€§ 7.ç³»ç»Ÿä¸å…¶å­ç³»ç»Ÿæˆ–è¦ç´ ä¹‹é—´ç›¸äº’ä¾å­˜å’Œä½œç”¨çš„ç‰¹æ€§ï¼Œç§°ä¸ºç³»ç»Ÿçš„ï¼ˆCï¼‰ A æ•´ä½“æ€§ B å±‚æ¬¡æ€§ C å…³è”æ€§ D ç»Ÿä¸€æ€§ 8.å®¢è§‚ç‰©è´¨è¿åŠ¨çš„å±‚æ¬¡æ€§å’Œå„ä¸åŒå±‚æ¬¡ä¸Šç³»ç»Ÿè¿åŠ¨çš„ç‰¹æ®Šæ€§ï¼Œä½“ç°äº†ç³»ç»Ÿçš„ï¼ˆCï¼‰ A æ•´ä½“æ€§ B å…³è”æ€§ C ç»Ÿä¸€æ€§ D å±‚æ¬¡æ€§ 9.ç¦»å¼€å…³è”æ€§å°±ä¸èƒ½æ­ç¤ºå¤æ‚ç³»ç»Ÿçš„æœ¬è´¨ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 10.ä¸€ä¸ªç³»ç»Ÿç”±è‹¥å¹²å­ç³»ç»Ÿç»„æˆï¼Œè¯¥ç³»ç»Ÿå°±æ˜¯æœ€å¤§çš„ç³»ç»Ÿã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 11.ç³»ç»Ÿçš„å±æ€§åŒ…æ‹¬ï¼ˆABCDï¼‰ A æ•´ä½“æ€§ B å…³è”æ€§ C å±‚æ¬¡æ€§ D ç»Ÿä¸€æ€§ E ä¸€è‡´æ€§ 12.å®¢è§‚ç‰©è´¨è¿åŠ¨çš„å±‚æ¬¡å’Œå„ä¸åŒå±‚æ¬¡ä¸Šç³»ç»Ÿè¿åŠ¨çš„ç‰¹æ®Šæ€§ï¼Œè¿™ä¸»è¦è¡¨ç°åœ¨ä¸åŒå±‚æ¬¡ä¸Šç³»ç»Ÿè¿åŠ¨è§„å¾‹çš„ç»Ÿä¸€æ€§ã€‚ 13.ä¸åŒå±‚æ¬¡ä¸Šçš„ç³»ç»Ÿè¿åŠ¨éƒ½å­˜åœ¨ç»„ç»‡åŒ–çš„å€¾å‘ï¼Œè€Œä¸åŒç³»ç»Ÿä¹‹é—´å­˜åœ¨ç€ç³»ç»ŸåŒæ„ã€‚ 14.ç³»ç»Ÿæœ¬èº«ä¹Ÿä»¥å¯çœ‹åšæ˜¯æ›´å¤§çš„ç³»ç»Ÿçš„ä¸€ä¸ªå­ç³»ç»Ÿï¼Œä½“ç°äº†ç³»ç»Ÿçš„å±‚æ¬¡æ€§ã€‚ 15.åœ¨å¤„ç†ç³»ç»Ÿé—®é¢˜æ—¶ï¼Œè¦æ³¨æ„ç ”ç©¶ç³»ç»Ÿçš„ç»“æ„ä¸åŠŸèƒ½çš„å…³ç³»ï¼Œé‡è§†æé«˜ç³»ç»Ÿçš„æ•´ä½“åŠŸèƒ½ã€‚ 16.ç³»ç»Ÿä¸ç¯å¢ƒä¹‹é—´ç›¸äº’ä½œç”¨ã€ç›¸äº’ä¾å­˜å’Œç›¸äº’å…³ç³»ä½“ç°äº†ç³»ç»Ÿçš„å…³è”æ€§ã€‚ 17.è™½ç„¶ç³»ç»Ÿæ˜¯ç”±è¦ç´ æˆ–å­ç³»ç»Ÿç»„æˆçš„ï¼Œä½†ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½å¯ä»¥å¤§äºå„è¦ç´ çš„æ€§èƒ½ä¹‹å’Œã€‚ 18.ç³»ç»Ÿçš„å±æ€§ä¸­ï¼Œå…³è”æ€§æ˜¯æŒ‡ç³»ç»Ÿä¸å…¶å­ç³»ç»Ÿä¹‹é—´ã€ç³»ç»Ÿå†…éƒ¨å„å­ç³»ç»Ÿä¹‹é—´ä»¥åŠç³»ç»Ÿä¸ç¯å¢ƒä¹‹é—´ç›¸äº’ä½œç”¨ï¼Œç›¸äº’ä¾å­˜å’Œç›¸äº’å…³ç³»ã€‚ 19.ç³»ç»Ÿçš„å±æ€§æœ‰æ•´ä½“æ€§ã€å…³è”æ€§ã€å±‚æ¬¡æ€§å’Œç»Ÿä¸€æ€§ã€‚ 20.ç³»ç»Ÿçš„å±æ€§åŒ…æ‹¬æ•´ä½“æ€§ã€å…³è”æ€§ã€å±‚æ¬¡æ€§å’Œç»Ÿä¸€æ€§ã€‚ 21.åè¯è§£é‡Šï¼šç³»ç»Ÿçš„å±æ€§ ç»Ÿä¸€æ€§ã€‚ ä¸€èˆ¬ç³»ç»Ÿè®ºæ‰¿è®¤å®¢è§‚ç‰©è´¨è¿åŠ¨çš„å±‚æ¬¡æ€§å’Œå„ä¸åŒå±‚æ¬¡ä¸Šç³»ç»Ÿè¿åŠ¨çš„ç‰¹æ®Šæ€§ï¼Œè¿™ä¸»è¦è¡¨ç°åœ¨ä¸åŒå±‚æ¬¡ä¸Šç³»ç»Ÿè¿åŠ¨è§„å¾‹çš„ç»Ÿä¸€æ€§ï¼Œä¸åŒå±‚æ¬¡ä¸Šçš„ç³»ç»Ÿè¿åŠ¨éƒ½å­˜åœ¨ç»„ç»‡åŒ–çš„å€¾å‘ï¼Œè€Œä¸åŒç³»ç»Ÿä¹‹é—´å­˜åœ¨ç€ç³»ç»ŸåŒæ„ã€‚ 22.åè¯è§£é‡Šï¼šç³»ç»Ÿçš„å…³è”æ€§ã€‚ å…³è”æ€§æ˜¯ç³»ç»Ÿçš„ä¸€ä¸ªå±æ€§ï¼Œæ˜¯æŒ‡ç³»ç»Ÿä¸å…¶å­ç³»ç»Ÿä¹‹é—´ã€ç³»ç»Ÿå†…éƒ¨å„å­ç³»ç»Ÿä¹‹é—´å’Œç³»ç»Ÿä¸ç¯å¢ƒä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€ç›¸äº’ä¾å­˜å’Œç›¸äº’å…³ç³»ã€‚ç¦»å¼€å…³è”æ€§å°±ä¸èƒ½æ­ç¤ºå¤æ‚ç³»ç»Ÿçš„æœ¬è´¨ã€‚ 23.åè¯è§£é‡Šï¼šç³»ç»Ÿçš„æ•´ä½“æ€§ã€‚ æ•´ä½“æ€§æ˜¯ç³»ç»Ÿçš„ä¸€ä¸ªå±æ€§ã€‚è™½ç„¶ç³»ç»Ÿæ˜¯ç”±è¦ç´ æˆ–å­ç³»ç»Ÿç»„æˆçš„ï¼Œä½†ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½å¯ä»¥å¤§äºå„è¦ç´ çš„æ€§èƒ½ä¹‹å’Œã€‚å› æ­¤åœ¨å¤„ç†ç³»ç»Ÿé—®é¢˜æ—¶ï¼Œè¦æ³¨æ„ç ”ç©¶ç³»ç»Ÿçš„ç»“æ„ä¸åŠŸèƒ½çš„å…³ç³»ï¼Œé‡è§†æé«˜ç³»ç»Ÿçš„æ•´ä½“åŠŸèƒ½ã€‚ 24.åè¯è§£é‡Šï¼šç³»ç»Ÿçš„å±‚æ¬¡æ€§ã€‚ ä¸€ä¸ªç³»ç»Ÿæ€»æ˜¯ç”±è‹¥å¹²å­ç³»ç»Ÿç»„æˆçš„ï¼Œè¯¥ç³»ç»Ÿæœ¬èº«åˆå¯çœ‹åšæ˜¯ä¸€ä¸ªæ›´å¤§çš„ç³»ç»Ÿçš„ä¸€ä¸ªå­ç³»ç»Ÿï¼Œè¿™å°±æ„æˆäº†ç³»ç»Ÿçš„å±‚æ¬¡æ€§ã€‚ ç³»ç»Ÿçš„åˆ†è§£ 1.ä¸‹åˆ—ç³»ç»ŸåŸåˆ™ä¸­ï¼Œä¸æ­£ç¡®çš„æ˜¯ï¼ˆBï¼‰ A å¯æ§åˆ¶åŸåˆ™ B å­ç³»ç»Ÿè§„æ¨¡ç›¸åŒåŸåˆ™ C åŠŸèƒ½èšåˆæ€§åŸåˆ™ D å­ç³»ç»Ÿæ¥å£æ ‡å‡†åŒ–åŸåˆ™ 2.ç³»ç»Ÿçš„åˆ†è§£å‡å°‘äº†æˆ‘ä»¬åˆ†æé—®é¢˜çš„éš¾åº¦ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 3.å°†ç³»ç»ŸæŒ‰ä¸€å®šçš„åŸåˆ™åˆ†è§£ä¸ºè‹¥å¹²å­ç³»ç»Ÿåï¼ŒåŠŸèƒ½å’Œç»“æ„ä¼šå˜å¤æ‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 4.ç³»ç»Ÿåˆ†è§£ä¸ºäº†ä¿è¯å‡†ç¡®ï¼Œè€ƒè™‘çš„åŸåˆ™åŒ…æ‹¬ï¼ˆABDï¼‰ A å¯æ§åˆ¶æ€§åŸåˆ™ B åŠŸèƒ½èšåˆæ€§åŸåˆ™ C å¯åˆ†è§£åŸåˆ™ D æ¥å£æ ‡å‡†åŒ–åŸåˆ™ E æµç¨‹åŒ–åŸåˆ™ 5.ç»è¿‡ç³»ç»Ÿçš„åˆ†è§£åï¼Œå¤§å¤§é™ä½äº†åŠŸèƒ½å’Œç»“æ„çš„å¤æ‚ç¨‹åº¦ï¼Œå‡å°‘äº†æˆ‘ä»¬åˆ†æé—®é¢˜çš„éš¾åº¦ã€‚ 6.é¢å¯¹ä¸€ä¸ªå¤æ‚çš„ç³»ç»Ÿï¼Œäººä»¬å°†å…¶åˆ’åˆ†è§£ä¸ºè‹¥å¹²å­ç³»ç»Ÿï¼Œä»è€Œé™ä½åˆ†æçš„éš¾åº¦ï¼Œè¿™ç§ç³»ç»Ÿæ–¹æ³•ç§°ä¸ºç³»ç»Ÿçš„åˆ†è§£ï¼Œæˆ–ç³»ç»Ÿåˆ†æã€‚ 7.ç³»ç»Ÿåˆ†è§£çš„è¿‡ç¨‹å°±æ˜¯ç¡®å®šå­ç³»ç»Ÿè¾¹ç•Œçš„è¿‡ç¨‹ã€‚ 8.ç³»ç»Ÿåˆ†è§£çš„è¿‡ç¨‹ä¸­ï¼Œå­ç³»ç»Ÿä¹‹é—´çš„è¿æ¥ç‚¹è¢«å®šä¹‰ä¸ºæ¥å£ã€‚ 9.ä¸ºäº†ä¿è¯ç³»ç»Ÿåˆ†è§£çš„å‡†ç¡®æ€§å’Œåˆç†æ€§ï¼Œè€ƒè™‘çš„åŸåˆ™åŒ…æ‹¬å¯æ§åˆ¶åŸåˆ™ã€åŠŸèƒ½èšåˆæ€§åŸåˆ™å’Œæ¥å£æ ‡å‡†åŒ–åŸåˆ™ã€‚ 10.ç³»ç»Ÿåˆ†è§£éœ€è¦è€ƒè™‘ä¸‰ä¸ªåŸåˆ™ï¼Œåˆ†åˆ«æ˜¯å¯æ§åˆ¶åŸåˆ™ã€åŠŸèƒ½èšåˆæ€§åŸåˆ™å’Œæ¥å£æ ‡å‡†åŒ–åŸåˆ™ã€‚ 11.ç¡®ä¿ç³»ç»Ÿåˆ†è§£çš„å‡†ç¡®æ€§ï¼Œéœ€è¦è€ƒè™‘å“ªäº›åŸåˆ™ï¼Ÿ ä¸ºäº†ä¿è¯ç³»ç»Ÿåˆ†è§£çš„å‡†ç¡®æ€§å’Œåˆç†æ€§ï¼Œä¸»è¦è€ƒè™‘ä¸‰ä¸ªåŸåˆ™ï¼š1.å¯æ§åˆ¶åŸåˆ™ï¼›2.åŠŸèƒ½èšåˆæ€§åŸåˆ™ï¼›3.æ¥å£æ ‡å‡†åŒ–åŸåˆ™ã€‚ 12.åè¯è§£é‡Šï¼šç³»ç»Ÿåˆ†è§£ã€‚ é¢å¯¹ä¸€ä¸ªåºå¤§å¤æ‚çš„ç³»ç»Ÿï¼Œæ— æ³•æŠŠç³»ç»Ÿæ‰€æœ‰å…ƒç´ ä¹‹é—´å…³ç³»è¡¨è¾¾æ¸…æ¥šï¼Œè¿™æ—¶è¦å°†ç³»ç»ŸæŒ‰ä¸€å®šçš„åŸåˆ™åˆ†è§£ä¸ºè‹¥å¹²å­ç³»ç»Ÿï¼Œç»è¿‡ç³»ç»Ÿçš„åˆ†è§£åï¼Œå…¶åŠŸèƒ½å’Œç»“æ„çš„å¤æ‚ç¨‹åº¦å¤§å¤§é™ä½ï¼Œå‡å°‘äº†æˆ‘ä»¬åˆ†æé—®é¢˜çš„éš¾åº¦ã€‚è¿™ç§ç³»ç»Ÿçš„æ–¹æ³•å°±æ˜¯ç³»ç»Ÿçš„åˆ†è§£ã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äºŒç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯†/ç¬¬å››èŠ‚_ä¿¡æ¯æŠ€æœ¯çš„åŸºæœ¬çŸ¥è¯†.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äºŒç« _ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„åŸºæœ¬çŸ¥è¯†/ç¬¬å››èŠ‚_ä¿¡æ¯æŠ€æœ¯çš„åŸºæœ¬çŸ¥è¯†.html","title":"ç¬¬å››èŠ‚ï¼šä¿¡æ¯æŠ€æœ¯çš„åŸºæœ¬çŸ¥è¯†","keywords":"","body":"ç¬¬å››èŠ‚ï¼šä¿¡æ¯æŠ€æœ¯çš„åŸºæœ¬çŸ¥è¯† ä¿¡æ¯æŠ€æœ¯çš„åŸºæœ¬çŸ¥è¯† 1.ä»ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘è§’åº¦çœ‹ï¼Œä¸‰å¤§æ ¸å¿ƒæŠ€æœ¯æŒ‡çš„æ˜¯ç½‘ç»œæŠ€æœ¯ã€æ•°æ®åº“æŠ€æœ¯å’Œå¼€å‘è¯­è¨€ã€‚ 2.ä»ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘è§’åº¦çœ‹ï¼Œç½‘ç»œæŠ€æœ¯ã€æ•°æ®åº“æŠ€æœ¯å’Œå¼€å‘è¯­è¨€æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ä¸‰å¤§æ ¸å¿ƒæŠ€æœ¯ã€‚ 3.å…³äºä¿¡æ¯çš„æ”¶é›†ã€è¯†åˆ«ã€æå–ã€å˜æ¢ã€å­˜å‚¨ã€å¤„ç†ã€æ£€ç´¢ã€æ£€æµ‹ã€åˆ†æå’Œåˆ©ç”¨ç­‰å„ç§æŠ€æœ¯çš„æ€»ç§°ï¼Œæ˜¯æŒ‡ä¿¡æ¯æŠ€æœ¯ã€‚ 4.ç«™åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘è§’åº¦ï¼Œç½‘ç»œæŠ€æœ¯ã€æ•°æ®åº“æŠ€æœ¯å’Œå¼€å‘è¯­è¨€æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ä¸‰å¤§æ ¸å¿ƒæŠ€æœ¯ã€‚ 5.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ä¸‰å¤§æ ¸å¿ƒæŠ€æœ¯æ˜¯ç½‘ç»œæŠ€æœ¯ã€å¼€å‘è¯­è¨€å’Œæ•°æ®åº“æŠ€æœ¯ã€‚ 6.åè¯è§£é‡Šï¼šä¿¡æ¯æŠ€æœ¯ã€‚ ä¿¡æ¯æŠ€æœ¯æ˜¯æœ‰å…³ä¿¡æ¯çš„æ”¶é›†ã€è¯†åˆ«ã€æå–ã€å˜æ¢ã€å­˜å‚¨ã€å¤„ç†ã€æ£€ç´¢ã€æ£€æµ‹ã€åˆ†æå’Œåˆ©ç”¨ç­‰å„ç§æŠ€æœ¯çš„æ€»ç§°ï¼Œæ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„é‡è¦åŸºç¡€ã€‚ ç½‘ç»œæŠ€æœ¯ 1.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä»¥è®¡ç®—æœºç½‘ç»œä¸ºåŸºç¡€çš„ä¸»è¦åŸå› æ˜¯ï¼Œä¸åŒ…æ‹¬ï¼ˆAï¼‰ A å¢åŠ æŠ•èµ„ B æœ‰åˆ©äºä¿¡æ¯çš„å®‰å…¨å­˜å‚¨ C èŠ‚çœæŠ•èµ„ D ä¸Šä¸‹çº§ä¿¡æ¯çš„äº¤æµ 2.å®‰å…¨çš„ç½‘ç»œä¸å…·æœ‰çš„ç‰¹å¾æ˜¯ï¼ˆAï¼‰ A ä¸å¯å®¡æŸ¥æ€§ B ä¿å¯†æ€§ C å®Œæ•´æ€§ D å¯ç”¨æ€§ 3.æœ€åŸºæœ¬çš„æ‹“æ‰‘ç»“æ„ä¸åŒ…æ‹¬ï¼ˆBï¼‰ A æ€»çº¿å‹ B æ›²çº¿å‹ C æ˜Ÿå‹ D ç¯å‹ 4.è®¿é—®äº’è”ç½‘æ—¶ï¼Œç”¨æˆ·ä½¿ç”¨çš„ç½‘ç»œåè®®æ˜¯ï¼ˆAï¼‰ A TCP/IP B IPX/SPX C NetBEUI D X.25 5.ç”¨æˆ·è®¿é—®äº’è”ç½‘ï¼Œå¿…é¡»ä½¿ç”¨IPX/SPXåè®®ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 6.æœ€åŸºæœ¬çš„æ‹“æ‰‘ç»“æ„åˆ†ä¸ºæ€»çº¿å‹ã€æ˜Ÿå‹ã€ç¯å½¢ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 7.ç½‘ç»œå®‰å…¨æŒ‡ç½‘ç»œç³»ç»Ÿçš„ç¡¬ä»¶ã€è½¯ä»¶åŠå…¶ç³»ç»Ÿä¸­çš„æ•°æ®å—åˆ°ä¿æŠ¤ï¼Œç³»ç»Ÿå¯ä»¥è¿ç»­å¯é æ­£å¸¸åœ°è¿è¡Œï¼Œç½‘ç»œæœåŠ¡ä¸ä¸­æ–­ã€‚ A æ­£ç¡® B é”™è¯¯ 8.å®‰å…¨çš„ç½‘ç»œæ˜¯ä¸å¯å®¡æŸ¥çš„ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 9.è®¡ç®—æœºç½‘ç»œçš„åŠŸèƒ½è¡¨ç°åœ¨ç¡¬ä»¶èµ„æºçš„å…±äº«ã€è½¯ä»¶èµ„æºå…±äº«å’Œç”¨æˆ·ä¿¡æ¯äº¤æ¢ä¸Šã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 10.è®¡ç®—æœºç½‘ç»œçš„åŠŸèƒ½ä¸»è¦è¡¨åŒ…æ‹¬ï¼ˆABEï¼‰ A ç¡¬ä»¶èµ„æºå…±äº« B ç”¨æˆ·ä¿¡æ¯äº¤æ¢ C è¾ƒå°çš„å†—ä½™åº¦ D å®¹æ˜“æ‰©å±• E è½¯ä»¶èµ„æºå…±äº« 11.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä»¥è®¡ç®—æœºç½‘ç»œä¸ºåŸºç¡€çš„ä¸»è¦åŸå› åŒ…æ‹¬ï¼ˆABCEï¼‰ A æ¨ªå‘éƒ¨é—¨é—´çš„ä¿¡æ¯äº¤æµ B ä¸Šä¸‹çº§é—´çš„ä¿¡æ¯äº¤æµ C èŠ‚çœèµ„æº D ä¸åˆ©äºä¿¡æ¯çš„å…±äº« E æœ‰åˆ©äºä¿¡æ¯çš„å®‰å…¨å­˜å‚¨ 12.å®‰å…¨ç½‘ç»œçš„ç‰¹å¾åŒ…æ‹¬ï¼ˆABCDEï¼‰ A ä¿å¯†æ€§ B å®Œæ•´æ€§ C å¯ç”¨æ€§ D å¯æ§æ€§ E å¯å®¡æŸ¥æ€§ 13.èƒ½è¿æ¥å¤šä¸ªåŸå¸‚ã€åœ°åŒºæˆ–å›½å®¶çš„è®¡ç®—æœºç½‘ç»œç§°ä¸ºå¹¿åŸŸç½‘ã€‚ 14.Internetæ˜¯ä¸€ç§èŒƒå›´è¦†ç›–å…¨çƒçš„å¹¿åŸŸç½‘ç»œã€‚ 15.ç½‘ç»œæŒ‰åœ°ç†èŒƒå›´åˆ†ç±»ï¼Œå¯ä»¥åˆ†ä¸ºå±€åŸŸç½‘å’Œå¹¿åŸŸç½‘ã€‚ 16.ç½‘ç»œæŒ‰åœ°ç†èŒƒå›´åˆ†ç±»ï¼Œå¯ä»¥åˆ†ä¸ºå±€åŸŸç½‘å’Œå¹¿åŸŸç½‘ã€‚ 17.ä¸åŒè®¡ç®—æœºä¹‹é—´å¿…é¡»ä½¿ç”¨ç›¸åŒçš„ç½‘ç»œåè®®æ‰å¯ä»¥è¿›è¡Œé€šä¿¡ã€‚ 18.æœ€åŸºæœ¬çš„æ‹“æ‰‘ç»“æ„åˆ†ä¸ºï¼šæ€»çº¿å‹ã€æ˜Ÿå‹å’Œç¯å‹ã€‚ 19.ç½‘ç»œæŒ‰é€šä¿¡ä»‹è´¨åˆ†ç±»ï¼Œåˆ†ä¸ºæœ‰çº¿ç½‘å’Œæ— çº¿ç½‘ã€‚ 20.ç”¨æˆ·å¦‚æœè®¿é—®Internetï¼Œå¿…é¡»ä½¿ç”¨TCP/IPåè®®ã€‚ 21.ç½‘ç»œæ‹“æ‰‘ç»“æ„æ˜¯æŒ‡è®¡ç®—æœºåŠç½‘ç»œè®¾å¤‡åœ¨ç©ºé—´ä¸Šçš„æ’åˆ—å½¢å¼ã€‚ 22.è®¡ç®—æœºç½‘ç»œæ˜¯å°†è®¡ç®—æœºäº’è¿èµ·æ¥ï¼Œä»¥åŠŸèƒ½å®Œæ•´çš„ç½‘ç»œè½¯ä»¶å®ç°èµ„æºå…±äº«å’Œä¿¡æ¯ä¼ é€’çš„ç³»ç»Ÿã€‚ 23.è®¡ç®—æœºç½‘ç»œå°±æ˜¯åˆ©ç”¨é€šä¿¡è®¾å¤‡å’Œçº¿è·¯å°†åœ°ç†ä½ç½®ä¸åŒã€åŠŸèƒ½ç‹¬ç«‹çš„ä¸¤å°æˆ–ä¸¤å°ä»¥ä¸Šè®¡ç®—æœºäº’è¿èµ·æ¥ã€‚ 24.ç½‘ç»œå®‰å…¨æŒ‡çš„æ˜¯ç½‘ç»œç³»ç»Ÿçš„ç¡¬ä»¶ã€è½¯ä»¶åŠå…¶ç³»ç»Ÿä¸­çš„æ•°æ®æ”¶åˆ°ä¿æŠ¤ã€‚ 25.è®¡ç®—æœºåŠç½‘ç»œè®¾å¤‡åœ¨ç©ºé—´ä¸Šçš„æ’åˆ—å½¢å¼æŒ‡çš„æ˜¯ç½‘ç»œæ‹“æ‰‘ç»“æ„ã€‚ 26.ç”¨æˆ·å¦‚æœè®¿é—®Internetï¼Œå¿…é¡»ä½¿ç”¨TCP/IPåè®®ã€‚ 27.ä¸åŒçš„è®¡ç®—æœºä¹‹é—´å¿…é¡»ä½¿ç”¨ç›¸åŒçš„ç½‘ç»œåè®®æ‰å¯ä»¥è¿›è¡Œé€šä¿¡ã€‚ 28.è®¡ç®—æœºç½‘ç»œçš„åŠŸèƒ½ä¸»è¦è¡¨ç°åœ¨ç¡¬ä»¶èµ„æºå…±äº«å’Œç”¨æˆ·ä¹‹é—´çš„ä¿¡æ¯äº¤æ¢ä¸‰ä¸ªæ–¹é¢ã€‚ 29.å®‰å…¨çš„ç½‘ç»œä¸€èˆ¬å…·æœ‰ä¿å¯†æ€§ã€å®Œæ•´æ€§ã€å¯ç”¨æ€§ã€å¯æ§æ€§ã€å’Œå¯å®¡æŸ¥æ€§ã€‚ 30.ç½‘ç»œå®‰å…¨ä»æœ¬è´¨ä¸Šè®²æ˜¯ç½‘ç»œçš„ä¿¡æ¯å®‰å…¨ã€‚ 31.åœ¨ç½‘ç»œä¸Šï¼Œå„å°è®¡ç®—æœºç›¸äº’â€œå¯¹è¯â€çš„è¯­è¨€ç§°ä¸ºç½‘ç»œåè®®ã€‚ 32.å®‰å…¨çš„ç½‘ç»œä¸€èˆ¬å…·æœ‰ä¿å¯†æ€§ã€å®Œæ•´æ€§ã€å¯ç”¨æ€§ã€å¯æ§æ€§ã€å¯å®¡æŸ¥æ€§ã€‚ 33.åè¯è§£é‡Šï¼šå¹¿åŸŸç½‘ã€‚ å¹¿åŸŸç½‘è·¨æ¥æ›´å¤§çš„ç‰©ç†èŒƒå›´ï¼Œèƒ½è¿æ¥å¤šä¸ªåŸå¸‚ã€åœ°åŒºæˆ–å›½å®¶ï¼ŒInternetå°±æ˜¯ä¸€ç§èŒƒå›´è¦†ç›–å…¨çƒçš„å¹¿åŸŸç½‘ç»œã€‚ 34.åˆ—ä¸¾å¸¸è§çš„ä¸‰ç§ç½‘ç»œåè®®ã€‚ TCP/IPåè®®ã€IPX/SPXåè®®ã€NetBEUIåè®®ã€‚ 35.è®¡ç®—æœºç½‘ç»œçš„åŠŸèƒ½è¡¨ç°åœ¨å“ªäº›æ–¹é¢ï¼Ÿ ç¡¬ä»¶èµ„æºå…±äº«ã€è½¯ä»¶èµ„æºå…±äº«å’Œç”¨æˆ·é—´ä¿¡æ¯äº¤æ¢ã€‚ 36.åè¯è§£é‡Šï¼šè®¡ç®—æœºç½‘ç»œã€‚ è®¡ç®—æœºç½‘ç»œå°±æ˜¯åˆ©ç”¨é€šä¿¡è®¾å¤‡å’Œçº¿è·¯è®²åœ°ç†ä½ç½®ä¸åŒã€åŠŸèƒ½ç‹¬ç«‹çš„ä¸¤å°æˆ–ä¸¤å°ä»¥ä¸Šè®¡ç®—æœºäº’è¿èµ·æ¥ï¼Œä»¥åŠŸèƒ½å®Œå–„çš„ç½‘ç»œè½¯ä»¶å®ç°èµ„æºå…±äº«å’Œä¿¡æ¯ä¼ é€’çš„ç³»ç»Ÿã€‚ 37.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä»¥è®¡ç®—æœºç½‘ç»œä¸ºåŸºç¡€çš„åŸå› ã€‚ 1.ä¸Šä¸‹çº§é—´ä¿¡æ¯çš„äº¤æµï¼›2.æ¨ªå‘éƒ¨é—¨é—´ä¿¡æ¯çš„äº¤æµï¼›3.èŠ‚çœæŠ•èµ„ï¼›4.æœ‰åˆ©äºä¿¡æ¯çš„å®‰å…¨å­˜å‚¨ã€‚ 38.ç½‘ç»œå®‰å…¨æŒ‡çš„æ˜¯å“ªäº›å†…å®¹ï¼Ÿ ç½‘ç»œå®‰å…¨æŒ‡çš„æ˜¯ç½‘ç»œç³»ç»Ÿçš„ç¡¬ä»¶ã€è½¯ä»¶åŠå…¶ç³»ç»Ÿä¸­çš„æ•°æ®å—åˆ°ä¿æŠ¤ï¼Œä¸å› å¶ç„¶çš„æˆ–è€…æ¶æ„çš„åŸå› è€Œé­å—ç ´åã€æ›´æ”¹ã€æ³„æ¼ï¼Œç³»ç»Ÿè¿ç»­å¯é æ­£å¸¸çš„è¿è¡Œï¼Œç½‘ç»œæœåŠ¡ä¸ä¸­æ–­ã€‚ç½‘ç»œçš„å®‰å…¨ä¸€èˆ¬å…·æœ‰ä¿å¯†æ€§ã€å®Œæ•´æ€§ã€å¯ç”¨æ€§ã€å¯æ§æ€§å’Œå¯å®¡æŸ¥æ€§äº”ä¸ªç‰¹å¾ã€‚ 39.ç®€è¿°å®‰å…¨çš„ç½‘ç»œä¸€èˆ¬å…·æœ‰çš„äº”ä¸ªç‰¹å¾ã€‚ å®‰å…¨çš„ç½‘ç»œä¸€èˆ¬å…·æœ‰ä¿å¯†æ€§ã€å®Œæ•´æ€§ã€å¯ç”¨æ€§ã€å¯æ§æ€§å’Œå¯å®¡æŸ¥æ€§äº”ä¸ªç‰¹å¾ã€‚ æ•°æ®åº“æŠ€æœ¯ 1.æ•°æ®è¡¨æ˜¯ä¸€ä¸ªç”±è¡Œå’Œåˆ—ç»„æˆçš„äºŒç»´ç»“æ„ï¼Œè¡Œç§°ä¸ºï¼ˆCï¼‰ A å­—å— B å­—æ®µ C è®°å½• D å­—ä¸² 2.æ•°æ®è¡¨æ˜¯ä¸€ä¸ªç”±è¡Œå’Œåˆ—ç»„æˆçš„äºŒç»´ç»“æ„ï¼Œåˆ—ç§°ä¸ºï¼ˆAï¼‰ A å­—æ®µ B å­—èŠ‚ C è®°å½• D å­—å— 3.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¸¸è§çš„â€œCRUDâ€ï¼Œâ€œCâ€å¯¹åº”æ•°æ®åº“SQLè¯­è¨€ä¸­çš„ï¼ˆAï¼‰ A æ’å…¥ B ä¿®æ”¹ C åˆ é™¤ D æŸ¥è¯¢ 4.å…³ç³»æ•°æ®åº“çš„æ ‡å‡†è¯­è¨€æ˜¯ï¼ˆAï¼‰ A SQLè¯­è¨€ B Cè¯­è¨€ C GOè¯­è¨€ D æ±‡ç¼–è¯­è¨€ 5.æ•°æ®åº“æ‰€ä¿å­˜çš„æ•°æ®æ˜¯æŒ‡é•¿æœŸå‚¨å­˜åœ¨è®¡ç®—æœºå†…ã€æœ‰ç»„ç»‡çš„ã€å¯å…±äº«çš„æ•°æ®é›†åˆã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 6.SQLè¯­è¨€ä¸­æ²¡æœ‰ä¿®æ”¹è¯­å¥ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 7.åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸­ï¼ŒAccesså±äºå¤§å‹æ•°æ®åº“ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 8.æ•°æ®è¡¨æ˜¯ä¸€ä¸ªç”±è¡Œå’Œåˆ—ç»„æˆçš„äºŒç»´ç»“æ„ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 9.æ•°æ®åº“æ˜¯å„ç§æ•°æ®çš„é›†åˆå’Œå®¹å™¨ã€‚ 10.è¡¨æ˜¯å­˜æ”¾æ•°æ®çš„åŸºæœ¬æ•°æ®ç»“æ„ã€‚ 11.å¯¹æ•°æ®åº“è¿›è¡Œç®¡ç†ï¼Œä½äºç”¨æˆ·å’Œæ“ä½œç³»ç»Ÿä¹‹é—´çš„å·¥å…·æ˜¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰ã€‚ 12.æ•°æ®åº“æ‰€ä¿å­˜çš„æ•°æ®æ˜¯æŒ‡é•¿æœŸå­˜å‚¨åœ¨è®¡ç®—æœºå†…ã€æœ‰ç»„ç»‡çš„ã€å¯å…±äº«çš„æ•°æ®é›†åˆã€‚ 13.æ•°æ®åº“æ˜¯å„ç§ç›¸å…³æ•°æ®çš„é›†åˆå’Œå®¹å™¨ã€‚ 14.ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ç®€ç§°SQLè¯­è¨€ã€‚ 15.å…³ç³»æ•°æ®åº“çš„æ ‡å‡†è¯­è¨€æ˜¯ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ã€‚ 16.æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç”¨æˆ·å’Œæ“ä½œç³»ç»Ÿä¹‹é—´ã€‚ 17.æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç¼©å†™ä¸ºDBMSã€‚ 18.åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸­ï¼Œé€šå¸¸ä¼šæŠŠæ•°æ®åº“ç®¡ç†ç³»ç»Ÿåˆ†æˆä¸¤å¤§ç±»ï¼Œä¸€æ˜¯ç½‘ç»œæ•°æ®åº“å’Œå¤§å‹æ•°æ®åº“ï¼ŒäºŒæ˜¯æ¡Œé¢æˆ–å°å‹æ•°æ®åº“ã€‚ 19.æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ˜¯å¯¹æ•°æ®åº“è¿›è¡Œç®¡ç†çš„ç³»ç»Ÿè½¯ä»¶ã€‚ 20.åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸­ï¼Œä¸€èˆ¬ä¼šå°†æ•°æ®åº“ç®¡ç†ç³»ç»Ÿåˆ†æˆä¸¤å¤§ç±»ï¼šåˆ†åˆ«æ˜¯ç½‘ç»œæ•°æ®åº“æˆ–å¤§å‹æ•°æ®åº“ä»¥åŠæ¡Œé¢åŠå°å‹æ•°æ®åº“ã€‚ 21.åœ¨æ•°æ®è¡¨ä¸­ï¼Œè¡Œç§°ä¸ºè®°å½•ã€‚ 22.æ•°æ®è¡¨ä¸­ï¼Œè¡Œç§°ä¸ºè®°å½•ï¼Œåˆ—ç§°ä¸ºå­—æ®µã€‚ 23.æ•°æ®è¡¨æ˜¯æ•°æ®åº“çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œé€šå¸¸ç§°ä¸ºè¡¨ã€‚ 24.å¸¸ç”¨çš„SQLè¯­å¥æœ‰å“ªäº›ï¼Ÿ å¸¸ç”¨çš„SQLè¯­å¥ä¸»è¦æœ‰ï¼šæ’å…¥ï¼ˆInsertï¼‰ã€ä¿®æ”¹ï¼ˆUpdateï¼‰ã€åˆ é™¤ï¼ˆDeleteï¼‰ã€æŸ¥è¯¢ï¼ˆSelectï¼‰ç­‰ã€‚ 25.ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸­ï¼Œæ•°æ®åº“å…³ç³»ç³»ç»Ÿçš„ä¸¤å¤§åˆ†ç±»ã€‚ åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸­ï¼Œé€šå¸¸å°†æ•°æ®åº“ç®¡ç†ç³»ç»Ÿåˆ†æˆä¸¤å¤§ç±»ï¼Œä¸€æ˜¯ç½‘ç»œæ•°æ®åº“æˆ–å¤§å‹æ•°æ®åº“ï¼Œå®ƒä¸»è¦åº”ç”¨äºä¼ä¸šçº§ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘ï¼Œæ¯”å¦‚Oracleã€SQL Severå’ŒDB2ç­‰ï¼ŒäºŒæ˜¯æ¡Œé¢æˆ–å°å‹æ•°æ®åº“ï¼Œå®ƒä¸»è¦ç”¨äºå•æœºç‰ˆç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘ï¼Œæ¯”å¦‚Accessã€Foxproç­‰ã€‚ 26.åè¯è§£é‡Šï¼šæ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚ æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ˜¯å¯¹æ•°æ®åº“è¿›è¡Œç®¡ç†çš„ç³»ç»Ÿè½¯ä»¶ï¼Œä½äºç”¨æˆ·å’Œæ“ä½œç³»ç»Ÿä¹‹é—´ï¼Œä¸ºç”¨æˆ·æˆ–åº”ç”¨ç¨‹åºæä¾›è®¿é—®æ•°æ®çš„æ–¹æ³•å’Œå·¥å…·ã€‚ 27.åè¯è§£é‡Šï¼šDBMSã€‚ æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ˜¯å¯¹æ•°æ®åº“è¿›è¡Œç®¡ç†çš„ç³»ç»Ÿè½¯ä»¶ï¼Œä½äºç”¨æˆ·å’Œæ“ä½œç³»ç»Ÿä¹‹é—´ï¼Œä¸ºç”¨æˆ·æˆ–åº”ç”¨ç¨‹åºæä¾›è®¿é—®æ•°æ®çš„æ–¹æ³•å’Œå·¥å…·ã€‚ è®¡ç®—æœºè¯­è¨€ 1.é«˜çº§è¯­è¨€æ˜¯ç¬¬ï¼ˆCï¼‰ä»£è®¡ç®—æœºè¯­è¨€ã€‚ A ä¸€ B äºŒ C ä¸‰ D å›› 2.å…³äºè®¡ç®—æœºè¯­è¨€ï¼Œä¸‹åˆ—è¯´æ³•é”™è¯¯çš„æ˜¯ï¼ˆDï¼‰ A æ±‡ç¼–è¯­è¨€æ”¹å˜äº†æœºå™¨è¯­è¨€çš„ä¸ç›´è§‚æ€§ B é«˜çº§è¯­è¨€å…·æœ‰è¾ƒå¥½çš„å¯ç§»æ¤æ€§ C æœºå™¨è¯­è¨€å¯ä»¥ç›´æ¥å’Œæœºå™¨æ‰“äº¤é“ D æ±‡ç¼–è¯­è¨€å¯ä»¥è¢«æœºå™¨ç›´æ¥è¯†åˆ« 3.Javaå±äºç¨‹åºè®¾è®¡è¯­è¨€æ±‡ä¸­çš„ï¼ˆCï¼‰ A æœºå™¨è¯­è¨€ B æ±‡ç¼–è¯­è¨€ C é«˜çº§è¯­è¨€ D ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ 4.èƒ½è¢«è®¡ç®—æœºç›´æ¥ç†è§£å’Œæ‰§è¡Œçš„æ˜¯ï¼ˆAï¼‰ A æœºå™¨è¯­è¨€ B æ±‡ç¼–è¯­è¨€ C é«˜çº§è¯­è¨€ D ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ 5.ç¨‹åºè®¾è®¡è¯­è¨€å‘å±•ç»å†çš„ä¸‰ä¸ªé˜¶æ®µä¸åŒ…æ‹¬ï¼ˆCï¼‰ A æœºå™¨è¯­è¨€ B æ±‡ç¼–è¯­è¨€ C æ±‰è¯­ D é«˜çº§è¯­è¨€ 6.æ±‡ç¼–è¯­è¨€çš„å¯ç§»æ¤æ€§æ¯”è¾ƒå¥½ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 7.è®¡ç®—æœºè¯­è¨€ï¼ŒæŒ‡äººä¸è®¡ç®—æœºä¹‹é—´é€šä¿¡çš„è¯­è¨€ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 8.ç¬¬ä¸€ä»£è®¡ç®—æœºè¯­è¨€æ˜¯æœºå™¨è¯­è¨€ã€‚ 9.ç¬¬äºŒä»£è®¡ç®—æœºè¯­è¨€æ˜¯æ±‡ç¼–è¯­è¨€ã€‚ 10.é«˜çº§è¯­è¨€æ˜¯ç¬¬ä¸‰ä»£é«˜çº§è¯­è¨€ã€‚ 11.è®¡ç®—æœºç¨‹åºè®¾è®¡è¯­è¨€ï¼Œç»å†äº†æœºå™¨è¯­è¨€ã€æ±‡ç¼–è¯­è¨€åˆ°é«˜çº§è¯­è¨€çš„å†ç¨‹ã€‚ 12.ç¨‹åºè®¾è®¡è¯­è¨€ä¹Ÿç§°ä¸ºè®¡ç®—æœºè¯­è¨€ã€‚ 13.ç¨‹åºè®¾è®¡è¯­è¨€ä¸­ï¼Œå¯ä»¥ç›´æ¥å’Œè®¡ç®—æœºæ‰“äº¤é“çš„æ˜¯æœºå™¨è¯­è¨€ã€‚ 14.ç¨‹åºè®¾è®¡è¯­è¨€çš„å‘å±•é€šå¸¸åˆ†ä¸ºæœºå™¨è¯­è¨€ã€æ±‡ç¼–è¯­è¨€å’Œé«˜çº§è¯­è¨€ä¸‰ä¸ªé˜¶æ®µã€‚ 15.æ±‡ç¼–è¯­è¨€çš„ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ æ¶‰åŠæœºå™¨çš„ç¡¬ä»¶ç»†èŠ‚ï¼Œéš¾å­¦éš¾ç”¨ï¼Œå®¹æ˜“å‡ºé”™ï¼Œä¸”æ— æ³•ç§»æ¤ï¼Œä¸æ˜“ç»´æŠ¤ã€‚ 16.åè¯è§£é‡Šï¼šè®¡ç®—æœºè¯­è¨€ã€‚ è®¡ç®—æœºè¯­è¨€åˆç§°ç¨‹åºè®¾è®¡è¯­è¨€ï¼ŒæŒ‡äººä¸è®¡ç®—æœºä¹‹é—´é€šä¿¡çš„è¯­è¨€ï¼Œæ˜¯äººä¸è®¡ç®—æœºä¹‹é—´ä¼ é€’ä¿¡æ¯çš„åª’ä»‹ï¼Œæ˜¯å¼€å‘ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè½¯ä»¶å¿…å¤‡çš„å·¥å…·ã€‚ 17.åè¯è§£é‡Šï¼šæ±‡ç¼–è¯­è¨€ã€‚ æ˜¯åŸºäºåŠ©è®°ç¬¦çš„è®¡ç®—æœºè¯­è¨€ã€‚æ±‡ç¼–è¯­è¨€ä¸æœºå™¨æŒ‡ä»¤ä¹‹é—´åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚æ±‡ç¼–è¯­è¨€ä¸èƒ½è¢«æœºå™¨ç›´æ¥è¯†åˆ«ã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸‰ç« _ç³»ç»Ÿå¼€å‘æ–¹æ³•æ¦‚è¿°/ç¬¬ä¸€èŠ‚_ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„åŸºæœ¬é—®é¢˜.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸‰ç« _ç³»ç»Ÿå¼€å‘æ–¹æ³•æ¦‚è¿°/ç¬¬ä¸€èŠ‚_ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„åŸºæœ¬é—®é¢˜.html","title":"ç¬¬ä¸€èŠ‚ï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„åŸºæœ¬é—®é¢˜","keywords":"","body":"ç¬¬ä¸€èŠ‚ï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„åŸºæœ¬é—®é¢˜ ç³»ç»Ÿå¼€å‘å…·å¤‡çš„æ¡ä»¶ 1.å¯¹ä¼ä¸šç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘å’Œä½¿ç”¨æˆè´¥èµ·å†³å®šä½œç”¨çš„é¦–è¦æ¡ä»¶æ˜¯ï¼ˆDï¼‰ A è¾ƒå¼ºçš„å¼€å‘é˜Ÿä¼ B è¾ƒå¥½çš„ç¡¬ä»¶æ¡ä»¶ C æ­£ç¡®çš„å¼€å‘ç­–ç•¥ D ä¼ä¸šé«˜å±‚é¢†å¯¼çš„é‡è§†ä¸ä»‹å…¥ 2.å…³äºç³»ç»Ÿå¼€å‘å…·å¤‡çš„æ¡ä»¶ï¼Œä¸‹åˆ—è¯´æ³•é”™è¯¯çš„æ˜¯ï¼ˆAï¼‰ A ä¼ä¸šé«˜å±‚é¢†å¯¼ä¸éœ€è¦ä»‹å…¥ B ä¼ä¸šä¸šåŠ¡äººå‘˜è¦æœ‰ç§¯ææ€§ C ä¼ä¸šè¦æœ‰ä¸€å®šçš„ç§‘å­¦ç®¡ç†åŸºç¡€ D è¦æœ‰ä¸€å®šçš„æŠ•èµ„ä¿è¯ 3.å¯¹äºä¼ä¸šçš„ç®¡ç†åŸºç¡€å·¥ä½œï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘å¿…å¤‡æ¡ä»¶ä¹‹ä¸€æ˜¯ï¼ˆCï¼‰ A å…ˆè¿›ã€å®ç”¨çš„ä¿¡æ¯åŸºç¡€è®¾æ–½ B è§„èŒƒã€å®Œå–„çš„ä¿¡æ¯ç®¡ç†åˆ¶åº¦ C ç§‘å­¦ã€æœ‰æ•ˆçš„ä¿¡æ¯ç®¡ç†æ–¹æ³• D å‡†ç¡®ã€å®Œæ•´çš„ä¼ä¸šåŸºç¡€æ•°æ® 4.å¯¹ä¼ä¸šç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘å’Œä½¿ç”¨æˆè´¥èµ·å†³å®šä½œç”¨çš„æ˜¯ï¼ˆCï¼‰ A æŠ•èµ„ä¿è¯ B ç§‘å­¦ç®¡ç†åŸºç¡€ C é«˜å±‚é¢†å¯¼é‡è§†ä¸ä»‹å…¥ D ä¸šåŠ¡äººå‘˜çš„ç§¯ææ€§ 5.è®¡ç®—æœºèƒ½å°†å¤§æ‰¹é‡æ•°æ®é«˜é€Ÿã€å‡†ç¡®åœ°è¿›è¡Œå„ç§åŠ å·¥å¤„ç†ï¼Œäº§ç”Ÿå¯¹ä¼ä¸šç®¡ç†æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½“ç°äº†ï¼ˆCï¼‰ A ä¼ä¸šé«˜å±‚é¢†å¯¼åº”é‡è§†å’Œä»‹å…¥ B ä¼ä¸šä¸šåŠ¡äººå‘˜è¦æœ‰ç§¯ææ€§ C ä¼ä¸šè¦æœ‰ä¸€å®šçš„ç§‘å­¦æŒ‚å†åŸºç¡€ D è¦æœ‰ä¸€å®šçš„æŠ•èµ„ä¿è¯ 6.åœ¨ä¸€èˆ¬åˆ¶é€ ä¼ä¸šä¸­ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç›´æ¥æ“ä½œè€…ä¸ä½¿ç”¨è€…ä¸»è¦æ˜¯ï¼ˆCï¼‰ A ä¼ä¸šå„çº§é¢†å¯¼ B ä¼ä¸šä¿¡æ¯ä¸­å¿ƒå·¥ä½œäººå‘˜ C ä¼ä¸šå„ç±»ä¸šåŠ¡äººå‘˜ D ä¼ä¸šåŸºå±‚èŒå·¥ 7.ä¼ä¸šè¿›è¡Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘å¿…é¡»å…·å¤‡çš„æ¡ä»¶ä¸­ï¼Œæœ€é‡è¦çš„ä¸€ä¸ªæ˜¯ï¼ˆBï¼‰ A æœ‰ä¸€å®šçš„è®¡ç®—æœºåº”ç”¨åŸºç¡€ B æœ‰ä¸€å®šçš„ç§‘å­¦ç®¡ç†åŸºç¡€ C æœ‰è¾ƒå¥½çš„ç³»ç»Ÿå¼€å‘æ–¹æ¡ˆ D æœ‰è¾ƒå¼ºçš„ä½¿ç”¨ã€ç»´æŠ¤åŠ›é‡ 8.å¯¹ä¼ä¸šç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘å’Œä½¿ç”¨æˆè´¥èµ·å†³å®šä½œç”¨çš„é¦–è¦æ¡ä»¶æ˜¯ï¼ˆDï¼‰ A è¾ƒå¼ºçš„å¼€å‘é˜Ÿä¼ B è¾ƒå¥½çš„ç¡¬ä»¶æ¡ä»¶ C è¾ƒå……è£•çš„å¼€å‘æ—¶é—´ D ä¼ä¸šé«˜å±‚é¢†å¯¼çš„é‡è§†å’Œä»‹å…¥ 9.ä¼ä¸šå¼€å‘ç®¡ç†ä¿¡æ¯ç³»ç»Ÿåº”å…·å¤‡çš„æ¡ä»¶ä¸­ï¼Œæ²¡æœ‰ï¼ˆBï¼‰ A ä¼ä¸šè¦æœ‰ä¸€å®šçš„ç§‘å­¦ç®¡ç†åŸºç¡€ B ä¼ä¸šè¦å‡å°‘æŠ•èµ„ C ä¼ä¸šé«˜å±‚é¢†å¯¼åº”é‡è§†å’Œä»‹å…¥ D ä¼ä¸šä¸šåŠ¡äººå‘˜è¦æœ‰ç§¯ææ€§ 10.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿåœ¨è¿›è¡Œå¼€å‘æ—¶ï¼Œç³»ç»Ÿçš„è§„æ¨¡è¦è¶Šå¤§è¶Šå¥½ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 11.ç³»ç»Ÿå»ºæˆæŠ•å…¥ä½¿ç”¨åï¼Œä¼ä¸šå„ä¸šåŠ¡äººå‘˜æ˜¯ç³»ç»Ÿçš„ç›´æ¥æ“ä½œè€…ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 12.åªæœ‰ä¼ä¸šæœ€é«˜å±‚é¢†å¯¼æ‰æœ‰æƒåˆ©å’Œæƒå¨åœ¨ä¼ä¸šå®£å¸ƒå»ºç«‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„è§‰å¾—ä»¥åŠè½å®ç»„ç»‡æœºæ„ï¼ŒåŠ¨å‘˜å…¨ä¼ä¸šæ”¯æŒç³»ç»Ÿå¼€å‘ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 13.å¼€å‘ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¹‹å‰ï¼Œä¼ä¸šåº”è¯¥è¦æœ‰ä¸€å®šçš„ç§‘å­¦ç®¡ç†åŸºç¡€ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 14.ä¼ä¸šå¼€å‘ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¿…é¡»å…·å¤‡çš„æ¡ä»¶åŒ…æ‹¬ï¼ˆABDEï¼‰ A ä¼ä¸šä¸šåŠ¡äººå‘˜è¦æœ‰ç§¯ææ€§ B è¦æœ‰ä¸€å®šçš„æŠ•èµ„ä¿è¯ C è¦æœ‰ä¸€å®šçš„ç»æµæ•ˆç›Š D ä¼ä¸šè¦æœ‰ä¸€å®šçš„ç§‘å­¦ç®¡ç†åŸºç¡€ E ä¼ä¸šé«˜å±‚é¢†å¯¼åº”é‡è§†å’Œä»‹å…¥ 15.ç®¡ç†ä¿¡æ¯ç³»ç»ŸæŠ•å…¥ä½¿ç”¨åï¼Œç»´æŠ¤è´¹ç”¨å æ€»æŠ•èµ„çš„ä¸»è¦éƒ¨åˆ†ã€‚ 16.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„è§„æ¨¡è¾ƒå¤§ç¨‹åº¦åœ°å–å†³äºä¼ä¸šçš„æŠ•èµ„é¢ã€‚ 17.åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»ŸæŠ•å…¥ä½¿ç”¨ä»¥åï¼Œé•¿æœŸè€Œé‡è¦çš„ä»»åŠ¡æŒ‡çš„æ˜¯ç³»ç»Ÿçš„ç»´æŠ¤å·¥ä½œã€‚ 18.ä¼ä¸šå¼€å‘ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¿…é¡»å…·å¤‡æ¡ä»¶ä¸­ï¼Œä¼ä¸šä¸šåŠ¡äººå‘˜è¦æœ‰ç§¯ææ€§ã€‚ 19.ä¼ä¸šè¦æœ‰ä¸€å®šçš„æŠ•èµ„ä¿è¯æ˜¯ä¼ä¸šå¼€å‘ç®¡ç†ä¿¡æ¯ç³»ç»Ÿåº”å…·å¤‡çš„ä¸€ä¸ªæ¡ä»¶ã€‚ 20.ä¼ä¸šå„ç±»ä¸šåŠ¡äººå‘˜æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸»è¦çš„ç›´æ¥æ“ä½œè€…ä¸ä½¿ç”¨è€…ã€‚ 21.ä¼ä¸šé«˜å±‚é¢†å¯¼äººå‘˜çš„é‡è§†ä¸ä»‹å…¥å¯¹ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ä½¿ç”¨çš„æˆè´¥èµ·å†³å®šæ€§ä½œç”¨ã€‚ 22.ç³»ç»Ÿå»ºæˆæŠ•å…¥ä½¿ç”¨åï¼Œä¼ä¸šä¸šåŠ¡äººå‘˜æ˜¯ç³»ç»Ÿçš„ç›´æ¥æ“ä½œè€…ä¸ä½¿ç”¨è€…ã€‚ 23.ä¼ä¸šå…·æœ‰ä¸€å®šçš„ç§‘å­¦ç®¡ç†åŸºç¡€æ˜¯è¿›è¡Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„ä¸€ä¸ªå¿…è¦æ¡ä»¶ã€‚ 24.æ²¡æœ‰ç§‘å­¦ç®¡ç†çš„åŸºç¡€ï¼Œå°±æ— æ³•å»ºæˆæœ‰æ•ˆçš„è®¡ç®—æœºç®¡ç†ä¿¡æ¯ç³»ç»Ÿã€‚ 25.ä¼ä¸šé«˜å±‚é¢†å¯¼é‡è§†ä¸ä»‹å…¥çš„ä¸»è¦æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ ä¼ä¸šé«˜å±‚é¢†å¯¼é‡è§†å’Œä»‹å…¥çš„ä¸»è¦æ„ä¹‰åœ¨äºï¼Œåªæœ‰ä¼ä¸šæœ€é«˜å±‚é¢†å¯¼æ‰æœ‰æƒåˆ©å’Œæƒå¨åœ¨ä¼ä¸šå®£å¸ƒå»ºç«‹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å†³å®šä»¥åŠè½å®ç»„ç»‡æœºæ„ï¼ŒåŠ¨å‘˜å…¨ä¼ä¸šæ”¯æŒç³»ç»Ÿå¼€å‘ã€‚ 26.ç®€è¿°ä¼ä¸šå¼€å‘ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¿…é¡»å…·å¤‡çš„æ¡ä»¶ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œä¼ä¸šå¼€å‘ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¿…é¡»å…·å¤‡ä»¥ä¸‹æ¡ä»¶ï¼š1.ä¼ä¸šé«˜å±‚é¢†å¯¼åº”é‡è§†å’Œä»‹å…¥ï¼›2.ä¼ä¸šä¸šåŠ¡äººå‘˜è¦æœ‰ç§¯ææ€§ï¼›3.ä¼ä¸šè¦æœ‰ä¸€å®šçš„ç§‘å­¦ç®¡ç†åŸºç¡€ï¼›4.è¦æœ‰ä¸€å®šçš„æŠ•èµ„ä¿è¯ã€‚ 27.å¼€å‘ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¹‹å‰ä¼ä¸šåº”å…·å¤‡å“ªäº›åŸºæœ¬æ¡ä»¶ï¼Ÿ 1.ä¼ä¸šé«˜å±‚é¢†å¯¼é‡è§†å’Œä»‹å…¥ï¼›2.ä¼ä¸šä¸šåŠ¡äººå‘˜è¦æœ‰ç§¯ææ€§ï¼›3.ä¼ä¸šè¦æœ‰ä¸€å®šçš„ç§‘å­¦ç®¡ç†åŸºç¡€ï¼›4.è¦æœ‰ä¸€å®šçš„æŠ•èµ„ä¿è¯ã€‚ 28.ç®€è¿°ä¼ä¸šè¦ç§‘å­¦ç®¡ç†çš„å†…å®¹ã€‚ åœ¨ä¼ä¸šä¸­ï¼Œæ²¡æœ‰ç§‘å­¦ç®¡ç†çš„åŸºç¡€ï¼Œå°±æ— æ³•å»ºæˆæœ‰æ•ˆçš„è®¡ç®—æœºç®¡ç†ä¿¡æ¯ç³»ç»Ÿï¼Œè®¡ç®—æœºèƒ½å°†å¤§æ‰¹é‡æ•°æ®é«˜é€Ÿã€å‡†ç¡®åœ°è¿›è¡Œå„ç§åŠ å·¥å¤„ç†ï¼Œäº§ç”Ÿå¯¹ä¼ä¸šç®¡ç†æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯å®ƒçš„å‰ææ˜¯è¾“å…¥çš„æ•°æ®å‡†ç¡®ã€å®Œæ•´ï¼Œå¦åˆ™ä¾¿æˆäº†â€œå‡æ•°çœŸç®—â€ï¼Œæ ¹æœ¬ä¸å¯èƒ½å¾—åˆ°å…·æœ‰æŒ‡å¯¼æ„ä¹‰çš„ä¿¡æ¯ã€‚ ç³»ç»Ÿå¼€å‘å‰çš„å‡†å¤‡å·¥ä½œ 1.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘ç­–ç•¥å¾ˆå¤§ç¨‹åº¦ä¸Šå†³å®šäº†ç³»ç»Ÿçš„æˆè´¥ã€‚ä¸‹åˆ—ä¸å±äºæ­£ç¡®å¼€å‘ç­–ç•¥çš„æ˜¯ï¼ˆDï¼‰ A æ ¹æ®ä¼ä¸šçš„å®é™…æƒ…å†µé€‰æ‹©åˆé€‚çš„æ–¹æ³• B ä½¿ç³»ç»Ÿå…·æœ‰æ°å½“çš„ç›®æ ‡ C åŠ¨å‘˜ä¼ä¸šå„æ–¹é¢çš„åŠ›é‡ D ä»ç³»ç»Ÿè®¾è®¡å…¥æ‰‹ï¼Œæœ‰æ­¥éª¤åœ°å®æ–½ç³»ç»Ÿ 2.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿèƒ½å¦çœŸæ­£å–å¾—æ•ˆç›Šï¼Œä¸ä¼ä¸šåŸºç¡€æ•°æ®çš„å®Œæ•´ç¨‹åº¦ä»¥åŠï¼ˆBï¼‰æœ‰å¾ˆå¤§å…³ç³»ã€‚ A è§„èŒƒç¨‹åº¦ B çœŸå®ç¨‹åº¦ C å›°éš¾ç¨‹åº¦ D å®ç”¨ç¨‹åº¦ 3.å…³äºç³»ç»Ÿå¼€å‘å‰çš„å‡†å¤‡å·¥ä½œï¼Œå¦‚æœæ²¡æœ‰ï¼ˆDï¼‰ï¼Œç³»ç»Ÿå°±åƒä¸€åº§æ²¡æœ‰åŸæ–™çš„åŠ å·¥å‚ã€‚ A ç³»ç»Ÿç›®æ ‡ B å¼€å‘ç­–ç•¥ C æŠ•èµ„é‡‘é¢ D åŸºç¡€æ•°æ® 4.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„å‡ºå‘ç‚¹æ˜¯ï¼ˆAï¼‰ A ç³»ç»Ÿå¼€å‘éƒ¨æ ‡ B ç³»ç»Ÿå¼€å‘ç­–ç•¥ C ç³»ç»Ÿå¼€å‘æ–¹æ³• D ç³»ç»Ÿå¼€å‘ç»©æ•ˆ 5.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸­ä¸€é¡¹æœ€é‡è¦çš„åŸºç¡€å·¥ä½œæ˜¯æ”¶é›†ã€æ•´ç†ã€è§„èŒƒï¼ˆBï¼‰ A ä¼ä¸šè¿è¥æ•°æ® B ä¼ä¸šåŸºç¡€æ•°æ® C ä¼ä¸šç¯å¢ƒæ•°æ® D ä¼ä¸šå†³ç­–æ•°æ® 6.ç³»ç»Ÿå¼€å‘çš„å‰æœŸå‡†å¤‡å·¥ä½œä¸éœ€è¦ç¡®å®šï¼ˆDï¼‰ A æŠ•èµ„é‡‘é¢ B å¼€å‘ç­–ç•¥ C åŸºç¡€æ•°æ® D æ€»ä½“ç»“æ„ 7.ç³»ç»Ÿå¼€å‘å‰çš„å‡†å¤‡å·¥ä½œï¼Œä¸åŒ…æ‹¬ï¼ˆDï¼‰ A å€Ÿé‰´åŒç±»ç³»ç»Ÿçš„å¼€å‘ç»éªŒ B ç¡®å®šç³»ç»Ÿç›®æ ‡ã€å¼€å‘ç­–ç•¥å’ŒæŠ•èµ„é‡‘é¢ C æ‰‹æœºå’Œæ•´ç†åŸºç¡€æ•°æ® D ä¼ä¸šå¼€å‘å¿…é¡»è¦è‡ªä¸»åˆ›æ–° 8.å€Ÿé‰´åŒç±»ç³»ç»Ÿçš„å¼€å‘ç»éªŒæ˜¯æŒ‡å¸å–å…¶ä»–ä¼ä¸šæˆ–ç»„ç»‡ä¸­ç±»ä¼¼çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘ç»éªŒå’Œå¤±è´¥æ•™è®­ï¼Œå°±èƒ½åœ¨æœ¬ä¼ä¸šç³»ç»Ÿå¼€å‘ä¸­å°‘èµ°å¼¯è·¯ã€‚ A æ­£ç¡® B é”™è¯¯ 9.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘å‰çš„å‡†å¤‡å·¥ä½œä¹‹ä¸€æ˜¯ç¡®å®šç³»ç»Ÿç›®æ ‡ã€å¼€å‘ç­–ç•¥å’ŒæŠ•èµ„é‡‘é¢ã€‚ 10.ç³»ç»Ÿå¼€å‘ç›®æ ‡æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„å‡ºå‘ç‚¹ã€‚ 11.æ­£ç¡®å¼€å‘ç­–ç•¥çš„å†…å®¹ä¸­ï¼Œç»„ç»‡ç”±ç®¡ç†äººå‘˜å’ŒæŠ€æœ¯äººå‘˜å‚åŠ çš„å¼€å‘é˜Ÿä¼ã€‚ 12.æ­£ç¡®çš„å¼€å‘ç­–ç•¥æ˜¯ä»æ€»ä½“è§„åˆ’å…¥æ‰‹ï¼Œæœ‰æ­¥éª¤åœ°å®æ–½ç³»ç»Ÿï¼›æ³¨é‡ç³»ç»Ÿçš„è¿è¡Œã€ç»´æŠ¤å’Œæ›´æ–°ç­‰ã€‚ 13.ç³»ç»Ÿå¼€å‘å‰çš„å‡†å¤‡å·¥ä½œä¸­æœ‰ä¸€é¡¹å†…å®¹æ˜¯ï¼šç¡®å®šç³»ç»Ÿç›®æ ‡ã€å¼€å‘ç­–ç•¥å’ŒæŠ•èµ„é‡‘é¢ã€‚ 14.ç³»ç»Ÿçš„ç›®æ ‡æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè®¾è®¡çš„å‡ºå‘ç‚¹ã€‚ 15.ç¡®å®šç³»ç»Ÿç›®æ ‡ã€å¼€å‘ç­–ç•¥å’ŒæŠ•èµ„é‡‘é¢æ˜¯ç³»ç»Ÿå¼€å‘å‰çš„ä¸€é¡¹å‡†å¤‡å·¥ä½œã€‚ 16.ç³»ç»Ÿå¼€å‘å‰çš„ä¸€é¡¹å‡†å¤‡å·¥ä½œæ˜¯å€Ÿé‰´åŒç±»ç³»ç»Ÿçš„å¼€å‘ç»éªŒã€‚ 17.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿèƒ½å¦å–å¾—æ•ˆç›Šï¼Œä¸å­˜å‚¨åœ¨ç³»ç»Ÿä¸­çš„ä¼ä¸šåŸºç¡€æ•°æ®çš„å®Œæ•´ç¨‹åº¦ä»¥åŠçœŸå®ç¨‹åº¦æœ‰å¾ˆå¤§å…³ç³»ã€‚ 18.æ”¶é›†ã€æ•´ç†ã€è§„èŒƒä¼ä¸šçš„åŸºç¡€æ•°æ®æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸­ä¸€é¡¹æœ€é‡è¦çš„åŸºç¡€å·¥ä½œã€‚ 19.å¸å–å…¶ä»–ä¼ä¸šåŒç±»ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„ç»éªŒæ•™è®­æ˜¯ä¼ä¸šç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘æˆåŠŸçš„é‡è¦æªæ–½ã€‚ 20.ä¼ä¸šåŸºç¡€æ•°æ®çš„æ”¶é›†ã€è§„èŒƒå’Œæ•´ç†ï¼Œæ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘å‰å‰çš„åŸºç¡€æ€§å·¥ä½œã€‚ 21.åè¯è§£é‡Šï¼šæ­£ç¡®çš„å¼€å‘ç­–ç•¥ã€‚ æ‰€è°“æ­£ç¡®çš„å¼€å‘ç­–ç•¥ï¼Œå°±æ˜¯èƒ½æ ¹æ®ä¼ä¸šçš„å®é™…æƒ…å†µé€‰æ‹©åˆé€‚çš„æ–¹æ³•ï¼Œé‡‡ç”¨æ­£ç¡®çš„æ–¹å¼å’Œæ‰‹æ®µæ¥å»ºç«‹ç³»ç»Ÿï¼Œä½¿ç³»ç»Ÿå…·æœ‰æ°å½“çš„ç›®æ ‡ï¼›èƒ½åŠ¨å‘˜ä¼ä¸šå„æ–¹é¢çš„åŠ›é‡ï¼›ç»„ç»‡ç”±ç®¡ç†äººå‘˜å’ŒæŠ€æœ¯äººå‘˜å‚åŠ çš„å¼€å‘é˜Ÿä¼ï¼›ä»æ€»ä½“è§„åˆ’å…¥æ‰‹ï¼Œæœ‰æ­¥éª¤åœ°å®æ–½ç³»ç»Ÿï¼›æ³¨é‡ç³»ç»Ÿçš„è¿è¡Œã€ç»´æŠ¤å’Œæ›´æ–°ç­‰ã€‚ 22.ç®€è¿°æ­£ç¡®çš„å¼€å‘ç­–ç•¥çš„å†…å®¹ã€‚ æ‰€è°“æ­£ç¡®çš„å¼€å‘ç­–ç•¥ï¼Œå°±æ˜¯èƒ½æ ¹æ®ä¼ä¸šçš„å®é™…æƒ…å†µé€‰æ‹©åˆé€‚çš„æ–¹æ³•ï¼Œé‡‡ç”¨æ­£ç¡®çš„æ–¹å¼å’Œæ‰‹æ®µæ¥å»ºç«‹ç³»ç»Ÿï¼Œä½¿ç³»ç»Ÿå…·æœ‰æ°å½“çš„ç›®æ ‡ï¼›èƒ½åŠ¨å‘˜ä¼ä¸šå„æ–¹é¢çš„åŠ›é‡ï¼›ç»„ç»‡ç”±ç®¡ç†äººå‘˜å’ŒæŠ€æœ¯äººå‘˜å‚åŠ çš„å¼€å‘é˜Ÿä¼ï¼›ä»æ€»ä½“è§„åˆ’å…¥æ‰‹ï¼Œæœ‰æ­¥éª¤åœ°å®æ–½ç³»ç»Ÿï¼›æ³¨é‡ç³»ç»Ÿçš„è¿è¡Œã€ç»´æŠ¤å’Œæ›´æ–°ç­‰ã€‚ 23.ç³»ç»Ÿå¼€å‘å‰çš„å‡†å¤‡å·¥ä½œæœ‰å“ªäº›å†…å®¹ï¼Ÿ ç³»ç»Ÿå¼€å‘å‰çš„å‡†å¤‡å·¥ä½œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š1.å€Ÿé‰´åŒç±»ç³»ç»Ÿçš„å¼€å‘ç»éªŒï¼›2.ç¡®å®šç³»ç»Ÿç›®æ ‡ã€å¼€å‘ç­–ç•¥å’ŒæŠ•èµ„é‡‘é¢ï¼›3.æ”¶é›†å’Œæ•´ç†åŸºç¡€æ•°æ®ã€‚ ç³»ç»Ÿå¼€å‘çš„å›°éš¾å› ç´  1.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘å¤±è´¥çš„é‡è¦åŸå› ä¹‹ä¸€æ˜¯ï¼ˆBï¼‰ A é‡è§†è§„åˆ’ï¼Œè½»è§†ç¼–ç¨‹ B é‡è§†ç¼–ç¨‹ï¼Œè½»è§†è§„åˆ’ C é‡è§†è®¾è®¡ï¼Œè½»è§†å®æ–½ D é‡è§†å®æ–½ï¼Œè½»è§†è®¾è®¡ 2.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¤§éƒ¨åˆ†çš„å·¥ä½œæ˜¯ï¼ˆCï¼‰è„‘åŠ›åŠ³åŠ¨çš„ç»“æœã€‚ A ç»„ç»‡è€… B ç®¡ç†äººå‘˜ C å¼€å‘äººå‘˜ D ä¸šåŠ¡äººå‘˜ 3.ä¸‹åˆ—é€‰é¡¹ä¸­ï¼Œä¸å±äºç³»ç»Ÿå¼€å‘å›°éš¾å› ç´ çš„æ˜¯ï¼ˆDï¼‰ A æ–°ç³»ç»Ÿå¯¹å½“å‰ç®¡ç†æ¨¡å¼å½±å“å¤§ B ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ•ˆç›Šä¸æ˜“ç”¨è´§å¸å½¢å¼ç›´æ¥åæ˜  C åŸºç¡€æ•°æ®çš„å‡†ç¡®æ€§ä¸å®Œæ•´æ€§å·® D é‡è§†è§„åˆ’ï¼Œè½»è§†ç¼–ç¨‹ 4.å…³äºé€ æˆç³»ç»Ÿå¼€å‘å›°éš¾çš„å„é¡¹è¯´æ³•ä¸­ï¼Œé”™è¯¯çš„æ˜¯ï¼ˆDï¼‰ A æ–°ç³»ç»Ÿå¯¹å½“å‰ç®¡ç†æ¨¡å¼å½±å“è¾ƒå¤§ B ç³»ç»Ÿçš„æ•ˆç›Šä¸æ˜“ç”¨è´§å¸å½¢å¼ç›´æ¥åæ˜  C åŸºç¡€æ•°æ®çš„å‡†ç¡®æ€§ä¸å®Œæ•´æ€§å·® D é‡è§†è§„åˆ’ï¼Œè½»è§†ç¼–ç¨‹ 5.åœ¨ç³»ç»Ÿå»ºè®¾è¿‡ç¨‹ä¸­ï¼Œå„é˜¶æ®µæ‰€å¼•å…¥çš„é”™è¯¯å…·æœ‰æ½œä¼æœŸï¼Œè¶Šæ—©æ½œå…¥çš„é”™è¯¯è¶Šæ™šæ‰ä¼šå‘ç°ï¼ŒæŒ‡çš„æ˜¯ï¼ˆAï¼‰ A å †æ ˆç°è±¡ B è½»è§†è§„åˆ’ C æ–°ç³»ç»Ÿå½±å“è¾ƒå¤§ D åŸºç¡€æ•°æ®çš„å®Œæ•´æ€§å·® 6.å…³äºç³»ç»Ÿå¼€å‘çš„å›°éš¾å› ç´ ï¼Œæè¿°ä¸æ­£ç¡®çš„æ˜¯ï¼ˆAï¼‰ A æ—§çš„ç³»ç»Ÿå¯¹å½“å‰ç®¡ç†æ¨¡å¼æœ‰å½±å“ B åŸºç¡€æ•°æ®å®Œæ•´æ€§å·® C é‡è§†ç¼–ç¨‹ï¼Œè½»è§†è§„åˆ’ D å †æ ˆç°è±¡ 7.ä¼ä¸šçš„ç®¡ç†åŸºç¡€å·¥ä½œæ··ä¹±ï¼Œéš¾ä»¥è·å¾—å‡†ç¡®ã€å®Œæ•´çš„åŸå§‹æ•°æ®å¯¼è‡´ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸èƒ½è¾ƒå¥½åœ°å‘æŒ¥ä½œç”¨ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 8.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å»ºè®¾æœ‰å…¶è‡ªèº«çš„å‘å±•è§„å¾‹ï¼Œå„é˜¶æ®µæ‰€å¼•å…¥çš„é”™è¯¯å…·æœ‰æ½œä¼æœŸï¼Œè¶Šæ—©æ½œå…¥çš„é”™è¯¯è¶Šæ™šæ‰èƒ½å‘ç°ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 9.é‡è§†ç¨‹åºè®¾è®¡ï¼Œè½»è§†æ€»ä½“è§„åˆ’çš„æ€æƒ³æ˜¯å¯¼è‡´ç³»ç»Ÿå¼€å‘å¤±è´¥çš„é‡è¦åŸå› ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 10.å¯¹äºå¤§å¤šæ•°ä¼ä¸šæ¥è¯´ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¸¦æ¥çš„ç»æµæ•ˆç›Šä¸æ˜“ç”¨è´§å¸å½¢å¼ç›´æ¥åæ˜ ï¼Œå±äºé—´æ¥æ•ˆç›Šã€‚ 11.ç°åœ¨ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘å¾€å¾€è¦å’Œä¼ä¸šå˜é©åŒæ—¶è¿›è¡Œã€‚ 12.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘è¿‡ç¨‹æœ‰åˆ«äºå…¶ä»–ç±»å‹çš„è¿‡ç¨‹ï¼Œå±äºçŸ¥è¯†å¯†é›†å‹çš„å·¥ä½œã€‚ 13.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ•ˆç›Šä¸æ˜“ç”¨è´§å¸å½¢å¼ç›´æ¥åæ˜ ï¼Œæ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„ä¸€ä¸ªå›°éš¾å› ç´ ã€‚ 14.åŸºç¡€æ•°æ®çš„å‡†ç¡®æ€§ä¸å®Œæ•´æ€§å·®ï¼Œæ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„ä¸€ä¸ªå›°éš¾å› ç´ ã€‚ 15.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å»ºè®¾æœ‰å…¶è‡ªèº«çš„å‘å±•è§„å¾‹ï¼Œç³»ç»Ÿå¼€å‘è¿‡ç¨‹ä¸€èˆ¬åˆ†é˜¶æ®µè¿›è¡Œçš„ï¼Œå„é˜¶æ®µæ‰€å¼•å…¥çš„é”™è¯¯å…·æœ‰æ½œä¼æœŸã€‚ 16.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„ä¸€ä¸ªå›°éš¾å› ç´ é‡‡ç”¨å¢åŠ å¼€å‘äººå‘˜çš„æ–¹å¼æ¥åŠ å¿«è¿›åº¦ã€‚ 17.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„ä¸€ä¸ªå›°éš¾å› ç´ æ˜¯ï¼šé‡è§†ç¼–ç¨‹ï¼Œè½»è§†è§„åˆ’ã€‚ 18.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„ä¸€ä¸ªå›°éš¾å› ç´ æ˜¯æ–°ç³»ç»Ÿå¯¹å½“å‰ç®¡ç†æ¨¡å¼å½±å“è¾ƒå¤§ã€‚ 19.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¯¹ä¼ä¸šçš„å„ç§æ•°æ®è¿›è¡ŒåŠ å·¥å¤„ç†ï¼Œæç‚¼ä¿¡æ¯ï¼Œç”¨æ¥è¾…åŠ©ç®¡ç†å†³ç­–ã€‚ 20.ç³»ç»Ÿå¼€å‘è¿‡ç¨‹ä¸€èˆ¬æ˜¯åˆ†é˜¶æ®µè¿›è¡Œçš„ï¼Œæ¯ä¸€ä¸ªé˜¶æ®µéƒ½å¯èƒ½ç”±äºå¼€å‘äººå‘˜å¯¹ç”¨æˆ·éœ€æ±‚çš„ç†è§£å‡ºç°åå·®ç­‰åŸå› å¼•å…¥é”™è¯¯ã€‚ 21.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘å¤±è´¥çš„æœ€é‡è¦åŸå› æ˜¯é‡è§†ç¼–ç¨‹ï¼Œè½»è§†è§„åˆ’ã€‚ 22.ç®¡ç†ä¿¡æ¯ç³»ç»ŸæŠ•å…¥ä½¿ç”¨åï¼Œä¼ä¸šå¿…é¡»é€‚åº”æ–°ç³»ç»Ÿæ¥çš„ç®¡ç†æ€æƒ³ã€ç®¡ç†æ–¹æ³•å’Œç®¡ç†ç»„ç»‡çš„å˜é©ã€‚ 23.ç³»ç»Ÿå¼€å‘çš„å›°éš¾å› ç´ ä¸»è¦æœ‰å“ªäº›ï¼Ÿ 1.æ–°ç³»ç»Ÿå¯¹å½“å‰ç®¡ç†æ¨¡å¼å½±å“è¾ƒå¤§ï¼›2.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ•ˆç›Šä¸æ˜“ç”¨è´§å¸å½¢å¼ç›´æ¥åæ˜ ï¼›3.åŸºç¡€æ•°æ®çš„å‡†ç¡®æ€§å’Œå®Œæˆæ€§å·®ï¼›4.é‡è§†ç¼–ç¨‹ï¼Œè½»è§†è§„åˆ’ï¼›5.æ— æ³•é‡‡ç”¨å¢åŠ å¼€å‘äººå‘˜çš„æ–¹å¼æ¥åŠ å¿«è¿›åº¦ï¼›6.å­˜åœ¨å †æ ˆç°è±¡ã€‚ 24.ç®€è¿°ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„å›°éš¾å› ç´ ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„å›°éš¾å› ç´ ä¸»è¦æœ‰ï¼š1.æ–°ç³»ç»Ÿå¯¹å½“å‰ç®¡ç†æ¨¡å¼å½±å“è¾ƒå¤§ï¼›2.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ•ˆç›Šä¸æ˜“ç”¨è´§å¸å½¢å¼ç›´æ¥åæ˜ ï¼›3.åŸºç¡€æ•°æ®çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§å·®ï¼›4.é‡è§†ç¼–ç¨‹ï¼Œè½»è§†è§„åˆ’ï¼›5.æ— æ³•é‡‡ç”¨å¢åŠ å¼€å‘äººå‘˜çš„æ–¹å¼æ¥åŠ å¿«è¿›åº¦ï¼›6.å­˜åœ¨å †æ ˆç°è±¡ã€‚ 25.åè¯è§£é‡Šï¼šå †æ ˆç°è±¡ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å»ºè®¾æœ‰å…¶è‡ªèº«çš„å‘å±•è§„å¾‹ï¼Œç³»ç»Ÿå¼€å‘è¿‡ç¨‹ä¸€èˆ¬æ˜¯åˆ†é˜¶æ®µè¿›è¡Œçš„ï¼Œæ¯ä¸€ä¸ªé˜¶æ®µéƒ½å¯èƒ½ç”±äºå¼€å‘äººå‘˜å¯¹ç”¨æˆ·éœ€æ±‚çš„ç†è§£å‡ºç°åå·®ç­‰åŸå› å¼•å…¥é”™è¯¯ï¼Œå¹¶ä¸”å„é˜¶æ®µæ‰€å¼•å…¥çš„é”™è¯¯å…·æœ‰æ½œä¼æœŸï¼Œè¶Šæ—©æ½œå…¥çš„é”™è¯¯è¶Šæ™šæ‰èƒ½å‘ç°ï¼Œæˆ‘ä»¬å°†æ­¤ç°è±¡ç§°ä¸ºå †æ ˆç°è±¡ã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸‰ç« _ç³»ç»Ÿå¼€å‘æ–¹æ³•æ¦‚è¿°/ç¬¬äºŒèŠ‚_ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘æ–¹æ³•.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸‰ç« _ç³»ç»Ÿå¼€å‘æ–¹æ³•æ¦‚è¿°/ç¬¬äºŒèŠ‚_ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘æ–¹æ³•.html","title":"ç¬¬äºŒèŠ‚ï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘æ–¹æ³•","keywords":"","body":"ç¬¬äºŒèŠ‚ï¼šç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘æ–¹æ³• ç³»ç»Ÿå¼€å‘æ–¹æ³•çš„äº§ç”ŸèƒŒæ™¯ 1.å…³äºè½¯ä»¶å±æœºçš„çˆ†å‘ï¼Œè¯´æ³•é”™è¯¯çš„æ˜¯ï¼ˆDï¼‰ A è½¯ä»¶çš„å¯é æ€§å·® B è½¯ä»¶å¼€å‘è´¹ç”¨å’Œè¿›åº¦å¤±æ§ C ç”Ÿäº§å‡ºæ¥çš„è½¯ä»¶éš¾ä»¥ç»´æŠ¤ D è½¯ä»¶å±æœºçš„å‡ºç°å’Œç®¡ç†æ— å…³ 2.å¸¸ç”¨çš„å¼€å‘æ–¹æ³•ä¸åŒ…æ‹¬ï¼ˆCï¼‰ A ç»“æ„åŒ–æ–¹æ³• B åŸå‹æ³• C éç»“æ„åŒ– D é¢å‘å¯¹è±¡çš„æ–¹æ³• 3.ä¸ºæ‘†è„±è½¯ä»¶å±æœºçš„å½±å“ï¼Œæ¨è¿›å¼€å‘çš„æˆåŠŸç‡ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç ”åˆ¶å¿…ç»ä¹‹è·¯æ˜¯ï¼ˆBï¼‰ A ç§‘å­¦åŒ– B å·¥ç¨‹åŒ– C è‡ªåŠ¨åŒ– D æ™ºèƒ½åŒ– 4.è½¯ä»¶å±æœºçš„ä¸»è¦è¡¨ç°ä¹‹ä¸€æ˜¯è½¯ä»¶éš¾ä»¥ï¼ˆCï¼‰ A ç”Ÿäº§ B ä½¿ç”¨ C ç»´æŠ¤ D è¯„ä»· 5.è½¯ä»¶å±æœºçˆ†å‘ä¸»è¦è¡¨ç°ä¸åŒ…æ‹¬ï¼ˆAï¼‰ A è½¯ä»¶ä¸å¯ä»¥ä¿®æ”¹ B è½¯ä»¶å¼€å‘è´¹ç”¨å’Œè¿›åº¦å¤±æ§ C è½¯ä»¶çš„å¯é æ€§å·® D ç”Ÿäº§å‡ºæ¥çš„è½¯ä»¶éš¾ä»¥ç»´æŠ¤ 6.è½¯ä»¶å±æœºçš„ä¸»è¦è¡¨ç°ä¹‹ä¸€æ˜¯è½¯ä»¶éš¾ä»¥ç»´æŠ¤ã€‚ 7.ä¸ºæ‘†è„±è½¯ä»¶å±æœºçš„å½±å“ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç ”åˆ¶å¿…é¡»èµ°å·¥ç¨‹åŒ–çš„é“è·¯ã€‚ 8.è½¯ä»¶å±æœºçˆ†å‘ä¸»è¦è¡¨ç°åœ¨ä¸‰ä¸ªæ–¹é¢ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹é¢æ˜¯è½¯ä»¶çš„å¯é æ€§å·®ã€‚ 9.é€ æˆâ€œè½¯ä»¶å±æœºâ€çš„åŸå› æ˜¯å¤šæ–¹é¢çš„ï¼Œæ²¡æœ‰æˆ–æœªèƒ½è®¤çœŸéµå¾ªå¼€å‘è§„èŒƒæ˜¯å…¶ä¸­çš„ä¸€ä¸ªæ–¹é¢ã€‚ 10.æœªèƒ½å……åˆ†ç†è§£å’Œæ­£ç¡®è¡¨è¾¾ç”¨æˆ·çš„éœ€æ±‚æ˜¯é€ æˆâ€œè½¯ä»¶å±æœºâ€çš„ä¸€ä¸ªåŸå› ã€‚ 11.é€ æˆâ€œè½¯ä»¶å±æœºâ€çš„åŸå› æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ‰æŠ€æœ¯ä¸Šçš„ï¼Œä½†æ›´ä¸»è¦çš„æ˜¯â€œç®¡ç†â€ä¸Šçš„ã€‚ 12.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘æ–¹æ³•ä¸»è¦æœ‰ä¸‰å¤§ç±»ï¼šç»“æ„åŒ–æ–¹æ³•ã€åŸå‹æ³•ä»¥åŠé¢å‘å¯¹è±¡çš„æ–¹æ³•ã€‚ 13.ç›®å‰å¸¸ç”¨çš„ç³»ç»Ÿå¼€å‘æ–¹æ³•ä¸»è¦æœ‰ç»“æ„åŒ–æ–¹æ³•ã€åŸå‹æ³•å’Œé¢å‘å¯¹è±¡æ–¹æ³•ç­‰ä¸‰å¤§ç±»ã€‚ 14.ç›®å‰å¸¸ç”¨çš„ä¸‰ç§å¼€å‘æ–¹æ³•ã€‚ ç›®å‰å¸¸ç”¨çš„ä¸€äº›å¼€å‘æ–¹æ³•ä¸»è¦æœ‰ä¸‰å¤§ç±»ï¼Œå³ç»“æ„åŒ–æ–¹æ³•ï¼ŒåŸå‹æ³•ï¼Œä»¥åŠé¢å‘å¯¹è±¡çš„æ–¹æ³•ã€‚ 15.ç®€è¿°è½¯ä»¶å±æœºçˆ†å‘çš„ä¸»è¦è¡¨ç°ã€‚ è½¯ä»¶å±æœºçˆ†å‘ä¸»è¦è¡¨ç°åœ¨ä¸‰ä¸ªé˜²éœ¾å‘¢ï¼š1.è½¯ä»¶å¼€å‘è´¹ç”¨å’Œè¿›åº¦å¤±æ§ï¼›2.è½¯ä»¶çš„å¯é æ€§å·®ï¼›3.ç”Ÿäº§å‡ºæ¥çš„è½¯ä»¶éš¾ä»¥ç»´æŠ¤ã€‚ 16.ç®€è¿°é€ æˆâ€œè½¯ä»¶å±æœºâ€çš„åŸå› ã€‚ é€ æˆâ€œè½¯ä»¶å±æœºâ€çš„åŸå› æ˜¯å¤šæ–¹é¢çš„ï¼Œæœ‰æŠ€æœ¯ä¸Šçš„ï¼Œä½†æ›´ä¸»è¦çš„æ˜¯ç®¡ç†ä¸Šçš„ï¼Œæ¯”å¦‚é‡‡ç”¨äº†ä¸é€‚å½“çš„å¼€å‘æ–¹æ³•ï¼›æœªèƒ½å……åˆ†ç†è§£å’Œæ­£ç¡®è¡¨è¾¾ç”¨æˆ·çš„éœ€æ±‚ï¼›æ²¡æœ‰æˆ–æœªèƒ½è®¤çœŸéµå¾ªå¼€å‘è§„èŒƒï¼›é¡¹ç›®ç®¡ç†ä¸åŠ›ï¼›ä¸é‡è§†èµ„æ–™ã€æ–‡æ¡£å·¥ä½œç­‰ã€‚ ç»“æ„åŒ–å¼€å‘æ–¹æ³• 1.ç»“æ„åŒ–åˆ†ææ–¹æ³•çš„ç³»ç»Ÿè¯´æ˜ä¹¦çš„æ„æˆä¸­ï¼Œæ²¡æœ‰ï¼ˆDï¼‰ A ä¸€å¥—åˆ†å±‚çš„æ•°æ®æµå›¾ B ä¸€æœ¬æ•°æ®å­—å…¸ C ä¸€ç»„åŠ å·¥è¯´æ˜ D åˆ†ææŠ¥å‘Š 2.ç»“æ„åŒ–è®¾è®¡çš„ä¸»è¦ç‰¹ç‚¹ä¸åŒ…æ‹¬ï¼ˆAï¼‰ A äº’ç›¸è”ç³»ã€åŠŸèƒ½è¾ƒå¤šçš„æ¨¡å—ç»“æ„ B å—å†…è”ç³»å¤§ C å—é—´è”ç³»å° D é‡‡ç”¨æ¨¡å—ç»“æ„å›¾çš„æè¿°æ–¹å¼ 3.ï¼ˆAï¼‰æ˜¯â€œç»“æ„åŒ–åˆ†æâ€å’Œâ€œç»“æ„åŒ–è®¾è®¡â€çš„ç»Ÿç§°ã€‚ A ç»“æ„åŒ–æ–¹æ³• B åŸå‹æ³• C é¢å‘å¯¹è±¡çš„æ–¹æ³• D é¢å‘ç”¨æˆ·çš„æ–¹æ³• 4.é‡‡ç”¨ç»“æ„åŒ–è®¾è®¡æ–¹æ³•æ‰€è®¾è®¡çš„ç³»ç»Ÿï¼Œå…¶æ¨¡å—çš„ä¸»è¦ç‰¹ç‚¹ä¹‹ä¸€æ˜¯ï¼ˆAï¼‰ A ç›¸å¯¹ç‹¬ç«‹ã€åŠŸèƒ½å•ä¸€ B ç›¸äº’ç‹¬ç«‹ã€åŠŸèƒ½å¤šæ · C ç›¸å¯¹ç‹¬ç«‹ã€åŠŸèƒ½å¤šæ · D ç›¸äº’è”ç³»ã€åŠŸèƒ½å¤šæ · 5.ç»“æ„åŒ–åˆ†æçš„ä¸»è¦å†…å®¹åŒ…æ‹¬ä¸€ç»„åˆ†å±‚çš„ï¼ˆBï¼‰ A ç³»ç»Ÿæµç¨‹å›¾ B æ•°æ®æµå›¾ C æ¨¡å—ç»“æ„å›¾ D ç¨‹åºæµç¨‹å›¾ 6.ç»“æ„åŒ–è®¾è®¡ä¸­ï¼Œå„æ¨¡å—ä¹‹é—´çš„å…³ç³»åº”è¯¥æ˜¯ï¼ˆDï¼‰ A æ¨¡å—å†…éƒ¨è”ç³»å’Œæ¨¡å—ä¹‹é—´çš„è”ç³»éƒ½è¦å¤§ B æ¨¡å—å†…å®¹å’Œæ¨¡å—ä¹‹é—´çš„è”ç³»éƒ½è¦å° C æ¨¡å—å†…éƒ¨è”ç³»è¦å°ï¼Œæ¨¡å—ä¹‹é—´è”ç³»è¦å¤§ D æ¨¡å—å†…éƒ¨è”ç³»è¦å¤§ï¼Œæ¨¡å—ä¹‹é—´è”ç³»è¦å° 7.ç»“æ„åŒ–åˆ†ææ–¹æ³•çš„åŸºæœ¬æ€æƒ³å¯ä»¥æ¦‚æ‹¬ä¸ºï¼ˆCï¼‰ A è‡ªåº•å‘ä¸Šï¼Œé€æ­¥å®ç° B è‡ªé¡¶å‘ä¸‹ï¼Œé€æ­¥å®ç° C è‡ªé¡¶å‘ä¸‹ï¼Œé€æ­¥å®ç° D è‡ªåº•å‘ä¸Šï¼Œé€å±‚åˆ†è§£ 8.ä¸€ä¸ªå¥½çš„ç»“æ„åŒ–è®¾è®¡çš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼ˆAï¼‰ A ç›¸å¯¹ç‹¬ç«‹çš„æ¨¡å—ç»“æ„ B æ¨¡å—å†…è”ç³»å° C ç”±ç²—åˆ°ç»†ï¼Œé€æ­¥æ±‚ç²¾ D æ¨¡å—é—´è”ç³»å¤§ 9.ç»“æ„åŒ–åˆ†ææ–¹æ³•è§£å†³å¤æ‚é—®é¢˜çš„ä¸¤ä¸ªåŸºæœ¬æ‰‹æ®µæ˜¯ï¼ˆCï¼‰ A åˆ†è§£ã€å…·ä½“åŒ– B é›†æˆã€å…·ä½“åŒ– C åˆ†è§£ã€æŠ½è±¡ D é›†æˆã€æŠ½è±¡ 10.ç»“æ„åŒ–åˆ†ææ–¹æ³•çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯åˆ†æç»“æœçš„æè¿°æ–¹å¼å°½å¯èƒ½é‡‡ç”¨ï¼ˆBï¼‰ A æ–‡å­— B å›¾å½¢ C å›¾åƒ D å¤šåª’ä½“ 11.ç”¨ç»“æ„åŒ–åˆ†ææ–¹æ³•è·å¾—çš„ç³»ç»Ÿè¯´æ˜ä¹¦åŒ…æ‹¬ï¼ˆDï¼‰ A ç³»ç»Ÿè§„åˆ’ã€ç³»ç»Ÿåˆ†æã€ç³»ç»Ÿè®¾è®¡ã€ç³»ç»Ÿå®æ–½ B ç³»ç»Ÿæ€»ä½“è®¾è®¡ã€ç³»ç»Ÿè¯¦ç»†è®¾è®¡ã€æ•°æ®åº“è®¾è®¡ã€äººæœºç•Œé¢è®¾è®¡ C ç³»ç»Ÿæµç¨‹å›¾ã€æ•°æ®æµå›¾ã€æ¨¡å—ç»“æ„å›¾ã€ç¨‹åºæµç¨‹å›¾ D æ•°æ®æµå›¾ã€æ•°æ®å­—å…¸ã€åŠ å·¥è¯´æ˜ã€è¡¥å……ææ–™ 12.ç”¨æ–‡å­—ç­‰å½¢å¼è¯¦ç»†æè¿°ç³»ç»Ÿæ¯ä¸€ä¸ªåŸºæœ¬å¤„ç†è¿‡ç¨‹çš„å·¥å…·æ˜¯ï¼ˆCï¼‰ A æ•°æ®æµå›¾ B æ•°æ®å­—å…¸ C åŠ å·¥è¯´æ˜ D E-Rå›¾ 13.ç»“æ„åŒ–åˆ†ææ–¹æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼ˆAï¼‰ A è‡ªé¡¶å‘ä¸‹ï¼Œé€æ­¥æ±‚ç²¾ B è‡ªåº•å‘ä¸Šï¼Œé€å±‚é›†æˆ C è‡ªå¤–å‘å†…ï¼Œé€æ­¥æ·±å…¥ D è‡ªå†…å‘å¤–ï¼Œé€æ­¥æ‰©å±• 14.åœ¨ç»“æ„åŒ–åˆ†ææ–¹æ³•ä¸­ï¼Œç”¨æ¥è¾…åŠ©è¿›è¡Œç³»ç»Ÿåˆ†æçš„ææ–™æ˜¯ï¼ˆDï¼‰ A æ•°æ®æµå›¾ B æ•°æ®è¯å…¸ C åŠ å·¥è¯´æ˜ D è¡¥å……ææ–™ 15.ç»“æ„åŒ–æ–¹æ³•æ˜¯ç›®å‰æœ€æˆç†Ÿã€åº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘æ–¹æ³•ä¹‹ä¸€ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 16.ç”¨ç»“æ„åŒ–åˆ†ææ–¹æ³•è·å¾—çš„ç³»ç»Ÿè¯´æ˜ä¹¦ç”±ä»¥ä¸‹å››éƒ¨åˆ†ç»„æˆï¼šæ•°æ®æµå›¾ã€æ•°æ®å­—å…¸ã€åŠ å·¥è¯´æ˜ã€è¡¥å……ææ–™ã€‚ 17.ç»“æ„åŒ–è®¾è®¡çš„åŸºæœ¬æ€æƒ³æ˜¯å°†ç³»ç»Ÿè®¾è®¡æˆç”±ç›¸å¯¹ç‹¬ç«‹ã€å•ä¸€åŠŸèƒ½çš„æ¨¡å—ç»„æˆçš„ç»“æ„ã€‚ 18.ç»“æ„åŒ–è®¾è®¡çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯é‡‡ç”¨æ¨¡å—ç»“æ„å›¾çš„æè¿°æ–¹å¼ã€‚ 19.åœ¨ç»“æ„åŒ–è®¾è®¡ä¸­ï¼Œæ¨¡å—å†…éƒ¨è”ç³»è¦å¤§ã€‚ 20.ç»“æ„åŒ–è®¾è®¡çš„åŸºæœ¬æ€æƒ³æ˜¯è®¾è®¡æˆç›¸å¯¹ç‹¬ç«‹ã€åŠŸèƒ½å•ä¸€çš„æ¨¡å—ç»“æ„ã€‚ 21.ç»“æ„åŒ–æ–¹æ³•æ˜¯â€œç»“æ„åŒ–åˆ†æâ€å’Œâ€œç»“æ„åŒ–è®¾è®¡â€çš„ç»Ÿç§°ã€‚ 22.ç»“æ„åŒ–æ–¹æ³•æ˜¯åŸºäºç€‘å¸ƒæ¨¡å‹æå‡ºçš„ã€‚ 23.ç»“æ„åŒ–åˆ†ææ–¹æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯è‡ªé¡¶å‘ä¸‹ã€é€æ­¥æ±‚ç²¾ã€‚ 24.ç»“æ„åŒ–åˆ†ææ–¹æ³•çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯ï¼Œåˆ†æç»“æœçš„æè¿°å°½å¯èƒ½é‡‡ç”¨å›¾å½¢æ–¹å¼ã€‚ 25.ç»“æ„åŒ–åˆ†ææ–¹æ³•è§£å†³å‘ç ¸é—®é¢˜çš„ä¸¤ä¸ªåŸºæœ¬æ‰‹æ®µæ˜¯åˆ†è§£ã€æŠ½è±¡ã€‚ 26.ç»“æ„åŒ–è®¾è®¡è¡¡é‡æ¨¡å—â€œç›¸å¯¹ç‹¬ç«‹â€çš„å‡†åˆ™ä¹‹ä¸€æ˜¯å—å†…è”ç³»è¦å¤§ã€‚ 27.ç»“æ„åŒ–æ–¹æ³•è§£å†³å¤æ‚é—®é¢˜çš„ä¸¤ä¸ªåŸºæœ¬æ‰‹æ®µæ˜¯åˆ†è§£å’ŒæŠ½è±¡ã€‚ 28.ç®€è¿°ç»“æ„åŒ–åˆ†ææ–¹æ³•çš„åŸºæœ¬æ‰‹æ®µã€åŸºæœ¬ç­–ç•¥å’Œä¸»è¦å†…å®¹ã€‚ ç»“æ„åŒ–åˆ†æçš„åŸºæœ¬æ‰‹æ®µæ˜¯åˆ†è§£ä¸æŠ½è±¡ï¼ŒåŸºæœ¬ç­–ç•¥æ˜¯è‡ªé¡¶å‘ä¸‹ã€ç”±ç²—åˆ°ç»†ã€é€æ­¥æ±‚ç²¾ï¼Œä¸»è¦å†…å®¹åŒ…æ‹¬ä¸€å¥—åˆ†å±‚çš„æ•°æ®æµå›¾ï¼Œä¸€æœ¬æ•°æ®è¯å…¸ï¼Œä¸€ç»„åŠ å·¥è¯´æ˜å’Œè¡¥å……ææ–™ã€‚ 29.ç»“æ„åŒ–åˆ†ææ–¹æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ä»€ä¹ˆï¼Ÿ ç»“æ„åŒ–åˆ†ææ–¹æ³•æ˜¯ä¸€ä¸ªç®€å•æ˜äº†ã€ä½¿ç”¨å¾ˆå¹¿çš„ç³»ç»Ÿåˆ†æçš„æ–¹æ³•ï¼Œå…¶åŸºæœ¬æ€æƒ³å¯ä»¥æ¦‚æ‹¬ä¸ºä¸€å¥è¯ï¼šâ€œè‡ªé¡¶å‘ä¸‹ï¼Œç”±ç²—åˆ°ç»†ï¼Œé€æ­¥æ±‚ç²¾â€ã€‚ 30.ç»“æ„åŒ–åˆ†æçš„ä¸»è¦å†…å®¹æœ‰å“ªäº›ï¼Ÿ ç»“æ„åŒ–åˆ†æçš„ä¸»è¦å†…å®¹åŒ…æ‹¬å››ä¸ªéƒ¨åˆ†ï¼š1.ä¸€å¥—åˆ†å±‚çš„æ•°æ®æµå›¾ï¼›2.ä¸€æœ¬æ•°æ®å­—å…¸ï¼›3.ä¸€ç»„åŠ å·¥è¯´æ˜ï¼›4.è¡¥å……ææ–™ã€‚ 31.åè¯è§£é‡Šï¼šç»“æ„åŒ–åˆ†æã€‚ ç»“æ„åŒ–åˆ†ææ–¹æ³•æ˜¯ä¸€ä¸ªç®€å•æ˜äº†ã€ä½¿ç”¨å¾ˆå¹¿çš„ç³»ç»Ÿåˆ†æçš„æ–¹æ³•ï¼Œå…¶åŸºæœ¬æ€æƒ³å¯ä»¥æ¦‚æ‹¬ä¸ºä¸€å¥è¯ï¼šâ€œè‡ªé¡¶å‘ä¸‹ï¼Œç”±ç²—åˆ°ç»†ï¼Œé€æ­¥æ±‚ç²¾â€ï¼Œæˆ–ç§°ä¸ºâ€œè‡ªé¡¶å‘ä¸‹ï¼Œé€å±‚åˆ†è§£â€ã€‚ 32.ç®€è¿°ç»“æ„åŒ–è®¾è®¡çš„ä¸»è¦ç‰¹ç‚¹ã€‚ 1.ç›¸å¯¹ç‹¬ç«‹ã€åŠŸèƒ½å•ä¸€çš„æ¨¡å—ç»“æ„ï¼›2.å—å†…è”ç³»å¤§ï¼Œå—é—´è”ç³»å°ï¼›3.é‡‡ç”¨æ¨¡å—ç»“æ„å›¾çš„æè¿°æ–¹æ³•ã€‚ 33.ç®€è¿°ç»“æ„åŒ–è®¾è®¡æ–¹æ³•ä¸­ï¼Œç³»ç»Ÿè®¾è®¡æ–¹æ³•çš„ä¸»è¦ç‰¹ç‚¹ã€‚ ç»“æ„åŒ–è®¾è®¡æ–¹æ³•æ˜¯ä½¿ç”¨æœ€å¹¿çš„ä¸€ç§ç³»ç»Ÿè®¾è®¡æ–¹æ³•ï¼Œå…¶ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼š1.æ¨¡å—ç»“æ„ç›¸å¯¹ç‹¬ç«‹ã€åŠŸèƒ½å•ä¸€ï¼›2.å—å†…è”ç³»å¤§ã€å—é—´è”ç³»å°ï¼›3.é‡‡ç”¨æ¨¡å—ç»“æ„å›¾çš„æè¿°æ–¹æ³•ã€‚ åŸå‹åŒ–å¼€å‘æ–¹æ³• 1.ä½œä¸ºä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•ï¼ŒåŸå‹æ³•ä¸€èˆ¬å¯ç”¨æ¥ç¡®å®šï¼ˆCï¼‰ A ç³»ç»Ÿç›®æ ‡ B ç³»ç»ŸåŠŸèƒ½ C ç”¨æˆ·éœ€æ±‚ D ç”¨æˆ·åå¥½ 2.ç³»ç»Ÿå¼€å‘äººå‘˜åœ¨è·å–ç”¨æˆ·éœ€æ±‚åï¼Œä¸æŠ›å¼ƒåŸå‹ç³»ç»Ÿï¼Œè€Œæ˜¯æ ¹æ®ç”¨æˆ·æ„è§ï¼Œåå¤ä¿®æ”¹å’Œæ‰©å……åŸå‹ç³»ç»Ÿï¼Œç›´è‡³ç”¨æˆ·æ»¡æ„ï¼Œæ­¤ç§åŸå‹æ³•æ•°æ®ï¼ˆCï¼‰ A æ¢ç´¢å‹ B å®éªŒå‹ C æ¼”åŒ–å‹ D æ··åˆå‹ 3.ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„åŸå‹æ³•ä¸­çš„â€œåŸå‹â€æ˜¯æŒ‡ï¼ˆCï¼‰ A åŸæ²¹ç³»ç»Ÿçš„ç±»å‹ B åŸæœ‰ç³»ç»Ÿéƒ¨åˆ†åŠŸèƒ½çš„æ¨¡å—ç»„åˆ C æ–°ç³»ç»Ÿéƒ¨åˆ†åŠŸèƒ½çš„æ—©æœŸç‰ˆæœ¬ D æ–°ç³»ç»Ÿéƒ¨åˆ†åŠŸèƒ½çš„ç³»ç»Ÿè®¾è®¡ 4.æ¢ç´¢å‹åŸå‹æ³•é€‚ç”¨çš„ç³»ç»Ÿå¼€å‘åœºåˆæ˜¯ï¼ˆDï¼‰ A ç³»ç»Ÿè§„æ¨¡è¾ƒå¤§ B éœ€æ±‚å˜åŠ¨é¢‘ç¹ C ç›®æ ‡æ˜ç¡®ï¼Œä½†ç³»ç»Ÿæ–¹æ¡ˆä¸ç¡®å®š D ç›®æ ‡å«ç³Šï¼Œç³»ç»Ÿç‰¹æ€§ä¸ç¡®å®š 5.åº”ç”¨åŸå‹æ³•æ—¶ï¼Œå¿«é€Ÿå¼€å‘å‡ºåŸå‹ç³»ç»Ÿåï¼Œè¦æ±‚ç”¨æˆ·æ—¨å…ˆå¯¹æ­¤ç³»ç»Ÿè¿›è¡Œï¼ˆCï¼‰ A åˆ†æ B è®¾è®¡ C è¯•ç”¨ D å®¡æ ¸ 6.å®ç°å‹åŸå‹æ³•çš„é€‚ç”¨åœºåˆæ˜¯ï¼ˆAï¼‰ A ç³»ç»Ÿè§„æ¨¡å¤§ï¼Œå¼€å‘æ–¹æ¡ˆä¸ç¡®å®š B éœ€æ±‚å˜åŠ¨è¾ƒå¤§ C ç³»ç»Ÿå¼€å‘ç›®æ ‡å«ç³Š D ç³»ç»Ÿç‰¹æ€§ä¸æ˜ç¡® 7.åŸå‹æ³•çš„ç¬¬ä¸€æ­¥æ˜¯è·å–ä¸€ç»„ï¼ˆBï¼‰ A ç”¨æˆ·çš„åŸºæœ¬ç›®æ ‡ B ç”¨æˆ·çš„åŸºæœ¬éœ€æ±‚ C ç³»ç»Ÿçš„åŸºæœ¬åŠŸèƒ½ D ç³»ç»Ÿçš„åŸºæœ¬ç»“æ„ 8.ä¸‹åˆ—é€‰é¡¹ä¸­ï¼Œä¸å±äºåŸå‹åŒ–æ–¹æ³•çš„åˆ†ç±»æ–¹å¼æ˜¯ï¼ˆAï¼‰ A ç ”ç©¶å‹ B æ¢ç´¢å‹ C æ¼”åŒ–å‹ D å®éªŒå‹ 9.åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘æ–¹æ³•ä¸­ï¼Œé‡‡ç”¨å¯å‘å¼æ–¹æ³•ï¼Œæœ€ç»ˆæå‡ºæ˜ç¡®çš„éœ€æ±‚çš„æ–¹å¼ï¼ˆAï¼‰ A åŸå‹æ³• B é¢å‘å¯¹è±¡ C ç»“æ„åŒ– D éç»“æ„åŒ– 10.åŸå‹æ³•é‡‡ç”¨å¯å‘å¼æ–¹æ³•ï¼Œå¼•å¯¼ç”¨æˆ·é€æ¸åŠ æ·±å¯¹ç³»ç»Ÿçš„ç†è§£ï¼Œæœ€ç»ˆæå‡ºæ˜ç¡®çš„éœ€æ±‚ã€‚ 11.ä¸»è¦åº”ç”¨äºç³»ç»Ÿè§„æ¨¡å¤§ã€å¼€å‘æ–¹æ¡ˆä¸ç¡®å®šæƒ…å†µä¸‹çš„ç³»ç»Ÿå¼€å‘çš„åŸå‹æ³•å±äºå®éªŒå‹åŸå‹æ³•ã€‚ 12.ç³»ç»Ÿå¼€å‘ä¸­ï¼Œç”¨åŸå‹æ¥è¡¨ç¤ºç³»ç»Ÿæ—©æœŸè¿è¡Œç‰ˆæœ¬ã€‚ 13.åŸå‹åŒ–å¼€å‘æ–¹æ³•åˆç§°ä¸ºå¿«é€ŸåŸå‹æ³•ã€‚ 14.åœ¨åŸå‹åŒ–æ–¹æ³•ä¸­ï¼Œé’ˆå¯¹å¼€å‘ç›®æ ‡æ¨¡ç³Šã€äººå‘˜ç¼ºä¹ç»éªŒçš„æƒ…å†µæ¢ç´¢å‹æ–¹å¼ã€‚ 15.åŸå‹åŒ–æ–¹æ³•çš„è¿ç”¨æ–¹å¼ä¸­ï¼Œå®éªŒå‹ç”¨äºéªŒè¯æ–¹æ¡ˆæ˜¯å¦åˆé€‚ï¼Œè§„æ ¼è¯´æ˜æ˜¯å¦å¯é ã€‚ 16.åŸå‹åŒ–æ–¹æ³•ä¸­ï¼Œæ¼”åŒ–å‹æ–¹å¼è®¤ä¸ºä¿¡æ¯ç³»ç»Ÿæœ¬è´¨ä¸Šå°±æ˜¯ä¸æ–­æ¼”åŒ–çš„ã€‚ 17.åŸå‹åŒ–æ–¹æ³•æ ¹æ®ç³»ç»Ÿå¼€å‘çš„ç›®çš„å’Œç­–ç•¥å¯ä»¥åˆ’åˆ†ä¸ºæ¢ç´¢å‹ã€å®éªŒå‹å’Œæ¼”åŒ–å‹ç­‰ä¸‰ç±»ã€‚ 18.ç³»ç»Ÿå¼€å‘äººå‘˜åœ¨è·å–ç”¨æˆ·éœ€æ±‚åï¼Œä¸æŠ›å¼ƒåŸå‹ç³»ç»Ÿï¼Œè€Œæ˜¯æ ¹æ®ç”¨æˆ·æ„è§ï¼Œåå¤ä¿®æ”¹å’Œæ‰©å……åŸå‹ç³»ç»Ÿï¼Œç›´è‡³ç”¨æˆ·æ»¡æ„ã€‚æ­¤ç§åŸå‹æ³•å±äºæ¼”åŒ–å‹ã€‚ 19.åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸­ï¼Œäººä»¬ä¸€èˆ¬å°†èƒ½åæ˜ æ–°ç³»ç»Ÿçš„éƒ¨åˆ†é‡è¦åŠŸèƒ½å’Œç‰¹å¾çš„æ—©æœŸå¯è¿è¡Œç‰ˆæœ¬ç§°ä¸ºåŸå‹ã€‚ 20.åŸå‹åŒ–æ–¹æ³•çš„åˆ†ç±»åŒ…æ‹¬ï¼šæ¢ç´¢å‹ã€å®éªŒå‹å’Œæ¼”åŒ–å‹ã€‚ 21.ç®€è¿°åŸå‹æ³•çš„ä¸»è¦æ­¥éª¤ã€‚ åŸå‹æ³•è¦æ±‚åœ¨è·å¾—ä¸€ç»„åŸºæœ¬çš„ç”¨æˆ·éœ€æ±‚åï¼Œå¿«é€Ÿåœ°å¼€å‘å‡ºæ–°ç³»ç»Ÿçš„ä¸€ä¸ªåŸå‹ï¼Œç”¨æˆ·ã€å¼€å‘è€…åŠå…¶ä»–æœ‰å…³äººå‘˜åœ¨è¯•ç”¨åŸå‹çš„è¿‡ç¨‹ä¸­ï¼ŒåŠ å¼ºé€šä¿¡å’Œåé¦ˆï¼Œé€šè¿‡åå¤è¯„ä»·å’Œåå¤ä¿®æ”¹åŸå‹ç³»ç»Ÿï¼Œé€æ­¥ç¡®å®šå„ç§éœ€æ±‚çš„ç»†èŠ‚ï¼Œé€‚åº”éœ€æ±‚çš„å˜åŒ–ï¼Œä»è€Œæœ€ç»ˆæé«˜ç³»ç»Ÿçš„è´¨é‡ã€‚å› æ­¤ï¼ŒåŸå‹åŒ–æ–¹æ³•æ˜¯ä¸€ç§ç¡®å®šç”¨æˆ·éœ€æ±‚çš„æœ‰æ•ˆæ–¹æ³•ï¼Œå®ƒé‡‡ç”¨â€œå¯å‘å¼â€æ–¹æ³•ï¼Œå¼•å¯¼ç”¨æˆ·é€æ¸åœ°åŠ æ·±å¯¹ç³»ç»Ÿçš„ç†è§£ï¼Œæœ€ç»ˆæå‡ºæ˜ç¡®çš„éœ€æ±‚ã€‚ 22.ç®€è¿°åŸå‹åŒ–æ–¹æ³•çš„3ç§ç±»å‹ã€‚ åŸå‹åŒ–æ–¹æ³•å¯è¡¨ç°ä¸ºä¸åŒçš„è¿ç”¨æ–¹å¼ï¼Œä¸€èˆ¬å¯åˆ†ä¸ºä¸‰ç±»ï¼š1.æ¢ç´¢å‹ï¼šä¸»è¦æ˜¯é’ˆå¯¹å¼€å‘ç›®æ ‡æ¨¡ç³Šã€ç”¨æˆ·å’Œå¼€å‘äººå‘˜å¯¹é¡¹ç›®éƒ½ç¼ºé¥­ç»éªŒçš„æƒ…å†µï¼›2.å®éªŒå‹ï¼šç”¨äºå¤§è§„æ¨¡å¼€å‘å’Œå®ç°ä¹‹å‰è€ƒæ ¸ã€éªŒè¯æ–¹æ¡ˆæ˜¯å¦åˆé€‚ï¼Œè§„æ ¼è¯´æ˜æ˜¯å¦å¯é ï¼›3.æ¼”åŒ–å‹ï¼šè¯¥æ–¹æ³•è®¤ä¸ºä¿¡æ¯ç³»ç»Ÿæœ¬è´¨ä¸Šå°±æ˜¯ä¸æ–­æ¼”åŒ–çš„ï¼Œé‡ç‚¹å…³æ³¨é—®é¢˜æ˜¯å¦‚ä½•æ‰èƒ½ä½¿ä¿¡æ¯ç³»ç»Ÿé€‚åº”ä¸å¯é¿å…çš„å˜åŒ–ã€‚ 23.åè¯è§£é‡Šï¼šåŸå‹åŒ–å¼€å‘æ–¹æ³•ã€‚ åŸå‹åŒ–å¼€å‘æ–¹æ³•è¦æ±‚åœ¨è·å¾—ä¸€ç»„åŸºæœ¬ç”¨æˆ·éœ€æ±‚åï¼Œå¿«é€Ÿåœ°å¼€å‘å‡ºæ–°ç³»ç»Ÿçš„ä¸€ä¸ªåŸå‹ï¼Œç”¨æˆ·ã€å¼€å‘è€…åŠå…¶ä»–æœ‰å…³äººå‘˜åœ¨è¯•ç”¨åŸå‹çš„è¿‡ç¨‹ä¸­ï¼ŒåŠ å¼ºé€šä¿¡å’Œåé¦ˆï¼Œé€šè¿‡åå¤è¯„ä»·å’Œåå¤ä¿®æ”¹åŸå‹ç³»ç»Ÿï¼Œé€æ­¥ç¡®å®šå„ç§éœ€æ±‚çš„ç»†èŠ‚ï¼Œé€‚åº”éœ€æ±‚çš„å˜åŒ–ï¼Œä»è€Œæœ€ç»ˆæé«˜ç³»ç»Ÿçš„è´¨é‡ã€‚å› æ­¤ï¼ŒåŸå‹åŒ–æ–¹æ³•æ˜¯ä¸€ç§ç¡®å®šç”¨æˆ·éœ€æ±‚çš„æœ‰æ•ˆæ–¹æ³•ã€‚ é¢å‘å¯¹è±¡å¼€å‘æ–¹æ³• 1.é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œç»§æ‰¿æ˜¯ä¸‹åˆ—ä½•ç§è¦ç´ é—´æ•°æ®ä¸æ–¹æ³•çš„æœºåˆ¶ï¼ˆDï¼‰ A å¯¹è±¡ä¸å¯¹è±¡ B ç±»ä¸ç±» C å¯¹è±¡ä¸ç±» D çˆ¶ç±»ä¸å­ç±» 2.åœ¨é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œä¸‹åˆ—è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆDï¼‰ A å¯¹è±¡æ˜¯ç±»çš„æŠ½è±¡ï¼Œå­ç±»æ˜¯å¯¹è±¡çš„å®ä¾‹ B ç±»æ˜¯å¯¹è±¡çš„æŠ½è±¡ï¼Œè¶…ç±»æ˜¯å­ç±»çš„å®ä¾‹ C å¯¹è±¡æ˜¯ç±»çš„å®ä¾‹ï¼Œå­ç±»æ˜¯è¶…ç±»çš„å®ä¾‹ D ç±»æ˜¯å¯¹è±¡çš„æŠ½è±¡ï¼Œè¶…ç±»æ˜¯å­ç±»çš„æŠ½è±¡ 3.é¢å‘å¯¹è±¡ä¸­ï¼Œçˆ¶ç±»ä¸å­ç±»å…±äº«æ•°æ®ä¸æ–¹æ³•çš„æœºåˆ¶æ˜¯ï¼ˆCï¼‰ A æŠ½è±¡ B å®ä¾‹åŒ– C ç»§æ‰¿ D å¤šæ€æ€§ 4.å…³äºé¢å‘å¯¹è±¡å¼€å‘æ–¹æ³•ï¼Œï¼ˆAï¼‰ A æ–¹æ³• B æ¶ˆæ¯ C å¯¹è±¡ D å°è£… 5.ï¼ˆAï¼‰ä¸å¤šæ€æ€§ å¢åŠ äº†ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„çµæ´»æ€§ã€å¯è¯»æ€§ï¼Œæé«˜äº†ç³»ç»Ÿæ•ˆç‡ã€‚ A é‡è½½ B å¯¹è±¡ C å°è£… D ç»§æ‰¿ 6.åœ¨é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œå¯¹è±¡æ˜¯æŒ‡ï¼ˆDï¼‰ A ç›¸äº’å…³è”çš„æ•°æ®é›† B ç›¸äº’å…³è”çš„ç¨‹åºæ¨¡å— C ç›¸äº’å…³è”çš„æ“ä½œ D ç›¸äº’å…³è”çš„å®ä½“ 7.é¢å‘å¯¹è±¡æ–¹æ³•ä¸­å¯¹è±¡çš„å››ä¸ªç»„æˆéƒ¨åˆ†æ˜¯ï¼ˆAï¼‰ A å¯¹è±¡æ ‡è¯†ã€æ“ä½œé›†åˆã€æ•°æ®ç»“æ„ã€æ¶ˆæ¯æ¥å£ B å¯¹è±¡æ ‡è¯†ã€å¯¹è±¡å±æ€§ã€å¯¹è±¡åŠŸèƒ½ã€å¯¹è±¡æ•°æ® C å¯¹è±¡æ ‡è¯†ã€å¯¹è±¡æ•°æ®ã€å¯¹è±¡æµç¨‹ã€å¯¹è±¡åŠŸèƒ½ D å¯¹è±¡æ ‡ç¤ºã€å¯¹è±¡æ•°æ®æµã€ä¿¡æ¯å¤„ç†ã€æ¶ˆæ¯æ¥å£ 8.ä¸‹é¢ä¸å±äºé¢å‘å¯¹è±¡ç†è®ºçš„ä¸»è¦æ¦‚å¿µçš„æ˜¯ï¼ˆDï¼‰ A å¯¹è±¡ B ç±»å’Œå®ä¾‹ C æ¶ˆæ¯å’Œæ–¹æ³• D æ•°æ®å­—å…¸ 9.å¯¹è±¡çš„å°è£…æœºåˆ¶æ˜¯æŒ‡å¯¹è±¡æ˜¯è‹¥å¹²è¦ç´ çš„é›†æˆä½“ï¼Œè¿™äº›è¦ç´ åŒ…æ‹¬ï¼ˆAï¼‰ A æ•°æ®ä¸æ–¹æ³• B æ¶ˆæ¯ä¸æ–¹æ³• C å¤šç§æ“ä½œ D å¤šç§æ•°æ® 10.ä»¥ä¸‹å…³äºé¢å‘å¯¹è±¡æ–¹æ³•ä¸­å¯¹è±¡å’Œç±»çš„è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼ˆBï¼‰ A â€œåŒ—äº¬å¤§å­¦â€æ˜¯ä¸€ä¸ªç±» B â€œå¤§å­¦â€ æ˜¯ä¸€ä¸ªç±» C â€œå¤§å­¦â€å’Œâ€œåŒ—äº¬å¤§å­¦â€ä¹‹é—´æ˜¯ç»§æ‰¿çš„å…³ç³» D â€œå¤§å­¦â€å’Œâ€œåŒ—äº¬å¤§å­¦â€ä¹‹é—´æ²¡æœ‰å…³ç³» 11.æä¾›ä¸äººç±»åœ¨è§£å†³é—®é¢˜çš„æ€ç»´æ–¹å¼ç›¸å®¹èƒ½åŠ›ï¼Œä½“ç°äº†é¢å‘å¯¹è±¡å¼€å‘æ–¹æ³•ä¸­çš„ï¼ˆBï¼‰ A å°è£… B å¤šæ€æ€§ C å®ä¾‹ D é‡è½½ 12.åœ¨é¢å‘å¯¹è±¡å¼€å‘æ–¹æ³•ä¸­ï¼Œä¿¡æ¯éšè”½æŠ€æœ¯æŒ‡çš„æ˜¯ï¼ˆCï¼‰ A å¯¹è±¡ B ç±» C å°è£… D ç»§æ‰¿ 13.é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œå¯¹è±¡çš„å››ä¸ªç»„æˆéƒ¨åˆ†æ˜¯å¯¹è±¡æ ‡è¯†ã€æ“ä½œé›†åˆã€æ•°æ®ç»“æ„ã€æ¶ˆæ¯æ¥å£ã€‚ 14.é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œå¯¹è±¡æ˜¯æ•°æ®ç»“æ„ä»¥åŠä½œç”¨äºæ­¤ç»“æ„ä¸Šçš„æ•°æ®æ“ä½œçš„å°è£…ä½“ã€‚ 15.åœ¨é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œå¯¹è±¡æ˜¯é¢å‘å¯¹è±¡ç†è®ºçš„åŸºçŸ³ã€‚ 16.é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œç»§æ‰¿æ˜¯å­ç±»è‡ªåŠ¨å…±äº«çˆ¶ç±»ä¸­çš„æ–¹æ³•å’Œæ•°æ®çš„æœºåˆ¶ã€‚ 17.é¢å‘å¯¹è±¡æ–¹æ³•ä¸»è¦åŒ…æ‹¬é¢å‘å¯¹è±¡çš„åˆ†ææ–¹æ³•ã€é¢å‘å¯¹è±¡çš„è®¾è®¡æ–¹æ³•å’Œé¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ–¹æ³•ã€‚ 18.å¯¹è±¡ç”±å¯¹è±¡çš„æ ‡è¯†ã€å¯¹è±¡ä¸­çš„æ“ä½œé›†åˆã€å¯¹è±¡çš„æ•°æ®ç»“æ„*ï¼ŒåŠå¯¹è±¡å¯¹å¤–æ¶ˆæ¯æ¥å£ï¼ˆMSï¼‰å››ä¸ªéƒ¨åˆ†ã€‚ 19.é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œå¯¹è±¡å…·æœ‰å°è£…å’Œèƒ½åŠ¨ä¸¤ç§ç‰¹æ€§ã€‚ 20.é¢å‘å¯¹è±¡å¼€å‘æ–¹æ³•ä¸­ï¼Œæ¶ˆæ¯å»ºç«‹äº†é€šä¿¡é—´çš„æ¡¥æ¢ã€‚ 21.ç»§æ‰¿æ˜¯çˆ¶ç±»ä¸å­ç±»å…±äº«æ•°æ®ä¸æ–¹æ³•çš„æœºåˆ¶ã€‚ 22.é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œä½¿å¯¹è±¡ç§°ä¸ºæ•°æ®ä¸æ–¹æ³•é›†æˆä½“çš„æœºåˆ¶æ˜¯å°è£…æœºåˆ¶ã€‚ 23.åœ¨é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œå¯¹è±¡æ˜¯æŒ‡ç›¸äº’å…³è”çš„å®ä½“ã€‚ 24.åœ¨é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œç±»æ˜¯å¯¹è±¡çš„æŠ½è±¡ã€‚ 25.é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œå¯¹è±¡å…·æœ‰â€œå°è£…â€ä¸â€œèƒ½åŠ¨â€ä¸¤ç§ç‰¹æ€§ã€‚ 26.ç±»æ˜¯å¯¹è±¡çš„æŠ½è±¡æè¿°ã€‚ 27.åœ¨é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œç±»æ˜¯å¯¹è±¡çš„æŠ½è±¡æè¿°ã€‚ 28.ç®€è¿°é¢å‘å¯¹è±¡æ–¹æ³•ä¸­çš„å®šä¹‰åŠå…¶ç»„æˆéƒ¨åˆ†ã€‚ å¯¹è±¡æ˜¯æŒ‡ä¸€äº›ç›¸äº’å…³è”çš„å®ä½“ï¼Œå®ƒæ˜¯é¢å‘å¯¹è±¡ç†è®ºçš„åŸºçŸ³ï¼Œç”±å¯¹è±¡çš„æ ‡ç¤ºã€å¯¹è±¡ä¸­çš„æ“ä½œé›†åˆã€å¯¹è±¡çš„æ•°æ®ç»“æ„ã€åŠå¯¹è±¡å¯¹å¤–æ¶ˆæ¯æ¥å£å››éƒ¨åˆ†ç»„æˆï¼Œå…·æœ‰å°è£…å’Œèƒ½åŠ¨çš„ä¸¤ç§ç‰¹æ€§ã€‚ 29.ç®€è¿°é¢å‘å¯¹è±¡æ–¹æ³•ä¸­çš„å°è£…å’Œç»§æ‰¿ã€‚ 1.åœ¨é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œå°è£…æ˜¯ä¸€ç§ä¿¡æ¯çš„éšè”½æŠ€æœ¯ã€‚å°è£…æœºåˆ¶ä½¿å¯¹è±¡æˆä¸ºæ•°æ®ä¸æ–¹æ³•çš„é›†åˆä½“ï¼Œå¤–éƒ¨è§†å›¾æ˜¾ç¤ºçš„åªæ˜¯å¯¹è±¡å°è£…ç•Œé¢ä¸Šçš„ä¿¡æ¯ã€‚å°è£…ä½¿å¯¹è±¡å†…éƒ¨æ¨¡å—çš„æ”¹å˜ä¸ä¼šå¯¹å…¶ä»–å¯¹è±¡äº§ç”Ÿè‡´å‘½çš„åæœï¼Œè¿™åœ¨æ¨¡å‹ä½“ç³»é›†æˆæ—¶éå¸¸æœ‰ç”¨ï¼›2.ç»§æ‰¿æ˜¯å­ç±»è‡ªåŠ¨å…±äº«çˆ¶ç±»ä¸­çš„æ–¹æ³•å’Œæ•°æ®çš„æœºåˆ¶ï¼Œæè¿°äº†äººç±»ç”±ä¸€èˆ¬åˆ°ç‰¹æ®Šã€è‡ªé¡¶å‘ä¸‹çš„æ¼”ç»èƒ½åŠ›ã€‚å®ƒæ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ä½“ç³»ç»“æ„å…·æœ‰å¼€æ”¾æ€§ã€‚å¯¹äºçˆ¶ç±»ï¼Œç»§æ‰¿æ„å‘³ç€â€œé—ä¼ â€ï¼Œå¯¹äºå­ç±»ç»§æ‰¿åˆæ„å‘³ç€â€œå˜å¼‚â€ã€‚ 30.é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œå¯¹è±¡çš„ç»„æˆéƒ¨åˆ†ã€‚ åœ¨é¢å‘å¯¹è±¡å¼€å‘æ–¹æ³•ä¸­ï¼Œå¯¹è±¡æ˜¯ä¸€äº›ç›¸äº’å…³è”çš„å®ä½“ï¼Œå®ƒæ˜¯é¢å‘å¯¹è±¡ç†è®ºçš„åŸºçŸ³ï¼Œç”±å¯¹è±¡çš„æ ‡è¯†ã€å¯¹è±¡ä¸­çš„æ“ä½œé›†åˆã€å¯¹è±¡çš„æ•°æ®ç»“æ„ï¼ŒåŠå¯¹è±¡å¯¹å¤–æ¶ˆæ¯æ¥å£ï¼ˆMSï¼‰å››éƒ¨åˆ†ç»„æˆã€‚ 31.åè¯è§£é‡Šï¼šå®ä¾‹åŒ–è¿‡ç¨‹ã€‚ ç±»æ˜¯åˆ›å»ºå¯¹è±¡çš„è“å›¾ï¼Œä»æŸç§æ„ä¹‰ä¸Šè®²ï¼Œå¯¹è±¡æ˜¯ç±»çš„å®ä¾‹ï¼Œç”±ç±»åˆ°å¯¹è±¡çš„è¿‡ç¨‹ç§°ä¸ºå®ä¾‹åŒ–è¿‡ç¨‹ã€‚ 32.åè¯è§£é‡Šï¼šé¢å‘å¯¹è±¡æ–¹æ³•ã€‚ é¢å‘å¯¹è±¡æ–¹æ³•æ˜¯ä¸€ç§åŸºäºé¢å‘å¯¹è±¡ç†å¿µçš„ç³»ç»Ÿå¼€å‘æ–¹æ³•ã€‚å®ƒå°†é¢å‘å¯¹è±¡çš„æ€æƒ³åº”ç”¨äºè½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒæŒ‡å¯¼å¼€å‘æ´»åŠ¨ã€‚ 33.ç®€è¿°é¢å‘å¯¹è±¡æ–¹æ³•ä¸­å¯¹è±¡çš„ç»„æˆéƒ¨åˆ†ã€‚ åœ¨é¢å‘å¯¹è±¡æ–¹æ³•ä¸­ï¼Œå¯¹è±¡ç”±ä»¥ä¸‹4éƒ¨åˆ†ç»„æˆï¼šå¯¹è±¡çš„æ ‡è¯†ã€å¯¹è±¡ä¸­çš„æ“ä½œé›†åˆã€å¯¹è±¡çš„æ•°æ®ç»“æ„ã€å¯¹è±¡å¯¹å¤–çš„æ¶ˆæ¯æ¥å£ã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸‰ç« _ç³»ç»Ÿå¼€å‘æ–¹æ³•æ¦‚è¿°/ç¬¬ä¸‰èŠ‚_ç»“æ„åŒ–å¼€å‘æ–¹æ³•çš„å¼€å‘è¿‡ç¨‹.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸‰ç« _ç³»ç»Ÿå¼€å‘æ–¹æ³•æ¦‚è¿°/ç¬¬ä¸‰èŠ‚_ç»“æ„åŒ–å¼€å‘æ–¹æ³•çš„å¼€å‘è¿‡ç¨‹.html","title":"ç¬¬ä¸‰èŠ‚ï¼šç»“æ„åŒ–å¼€å‘æ–¹æ³•çš„å¼€å‘è¿‡ç¨‹","keywords":"","body":"ç¬¬ä¸‰èŠ‚ï¼šç»“æ„åŒ–å¼€å‘æ–¹æ³•çš„å¼€å‘è¿‡ç¨‹ ç³»ç»Ÿå¼€å‘é˜¶æ®µåˆ’åˆ† 1.ä»ç³»ç»Ÿå¼€å‘çš„é˜¶æ®µåˆ’åˆ†æ¥çœ‹ï¼Œç³»ç»Ÿåˆ†æçš„ä¸‹ä¸€é˜¶æ®µæ˜¯ï¼ˆBï¼‰ A ç³»ç»Ÿè§„åˆ’ B ç³»ç»Ÿè®¾è®¡ C ç³»ç»Ÿå®æ–½ D è¿è¡Œç»´æŠ¤ 2.æŒ‰ç»“æ„åŒ–æ–¹æ³•ï¼ŒMISçš„å¼€å‘åˆ†é˜¶æ®µè¿›è¡Œï¼Œå…¶ä¸­ç›¸äº’è¡”æ¥çš„ä¸¤ä¸ªé˜¶æ®µæ˜¯ï¼ˆAï¼‰ A æ€»ä½“è§„åˆ’ã€ç³»ç»Ÿè®¾è®¡ B ç³»ç»Ÿåˆ†æã€ç³»ç»Ÿè¯„ä»· C è¿è¡Œç»´æŠ¤ã€ç³»ç»Ÿè¯„ä»· D ç³»ç»Ÿå®æ–½ã€ç³»ç»Ÿè¯„ä»· 3.æŒ‰ç»“æ„åŒ–æ–¹æ³•ï¼Œç³»ç»Ÿå®æ–½çš„ä¸‹ä¸€é˜¶æ®µæ˜¯ï¼ˆAï¼‰ A è¿è¡Œç»´æŠ¤ B ç³»ç»Ÿè¯„ä»· C ç³»ç»Ÿè®¾è®¡ D ç³»ç»Ÿåˆ†æ 4.ç³»ç»Ÿåˆ†æçš„ä¸‹ä¸€é˜¶æ®µæ˜¯ï¼ˆBï¼‰ A ç³»ç»Ÿè§„åˆ’ B ç³»ç»Ÿè®¾è®¡ C å¯è¡Œæ€§åˆ†æ D åˆæ­¥è°ƒæŸ¥ 5.æŒ‰ç»“æ„åŒ–æ–¹æ³•ï¼ŒMISçš„æ–¹æ³•åˆ†é˜¶æ®µè¿›è¡Œï¼Œå…¶ä¸­ç›¸äº’è¡”æ¥çš„ä¸¤ä¸ªé˜¶æ®µæ˜¯ï¼ˆCï¼‰ A ç³»ç»Ÿè§„åˆ’ã€ç³»ç»Ÿè®¾è®¡ B ç³»ç»Ÿåˆ†æã€ç³»ç»Ÿè¯„ä»· C ç³»ç»Ÿå®æ–½ã€ç³»ç»Ÿç»´æŠ¤ D ç³»ç»Ÿå®æ–½ã€ç³»ç»Ÿè¯„ä»· 6.ä»ç³»ç»Ÿå¼€å‘çš„é˜¶æ®µåˆ’åˆ†æ¥çœ‹ï¼Œç³»ç»Ÿåˆ†æçš„å‰ä¸€é˜¶æ®µæ˜¯ï¼ˆAï¼‰ A ç³»ç»Ÿè§„åˆ’ B ç³»ç»Ÿè®¾è®¡ C ç³»ç»Ÿå®æ–½ D è¿è¡Œç»´æŠ¤ 7.æŒ‰ç»“æ„åŒ–æ–¹æ³•ï¼Œè¿è¡Œç»´æŠ¤çš„ä¸‹ä¸€é˜¶æ®µæ˜¯ï¼ˆDï¼‰ A ç³»ç»Ÿåˆ†æ B ç³»ç»Ÿè®¾è®¡ C ç³»ç»Ÿå®æ–½ D ç³»ç»Ÿè¯„ä»· 8.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿç”Ÿå‘½å‘¨æœŸä¸­çš„ç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯æ€»ä½“è§„åˆ’*ï¼Œä¹Ÿæ˜¯ç³»ç»Ÿå¼€å‘è¿‡ç¨‹çš„ç¬¬ä¸€æ­¥ã€‚ 9.ä»ç³»ç»Ÿå¼€å‘çš„é˜¶æ®µåˆ’åˆ†æ¥çœ‹ï¼Œç³»ç»Ÿåˆ†ææ˜¯ç³»ç»Ÿæ€»ä½“è§„åˆ’å·¥ä½œçš„ç»§ç»­ï¼Œæ˜¯ç³»ç»Ÿè®¾è®¡å·¥ä½œçš„å‰å¯¼ã€‚ 10.æŒ‰ç»“æ„åŒ–æ–¹æ³•ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘é€šå¸¸åŒ…æ‹¬æ€»ä½“è§„åˆ’ã€ç³»ç»Ÿåˆ†æã€ç³»ç»Ÿè®¾è®¡ã€ç³»ç»Ÿå®æ–½ã€è¿è¡Œç»´æŠ¤å’Œç³»ç»Ÿè¯„ä»·ã€‚ 11.æŒ‰ç»“æ„åŒ–æ–¹æ³•ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘é€šå¸¸åŒ…æ‹¬æ€»ä½“è§„åˆ’ã€ç³»ç»Ÿåˆ†æã€ç³»ç»Ÿè®¾è®¡ã€ç³»ç»Ÿå®æ–½ã€ç³»ç»Ÿè¿è¡Œç»´æŠ¤å’Œç³»ç»Ÿè¯„ä»·6ä¸ªä¸»è¦é˜¶æ®µã€‚ 12.ä»»ä½•ä¸€ä¸ªç³»ç»Ÿéƒ½æœ‰å…¶äº§ç”Ÿã€å‘å±•å’Œç­äº¡çš„ç”Ÿå‘½å†ç¨‹ï¼Œè¢«ç§°ä½œç³»ç»Ÿçš„ç”Ÿå‘½å‘¨æœŸã€‚ 13.æŒ‰ç»“æ„åŒ–æ–¹æ³•ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å¼€å‘é˜¶æ®µè¿›è¡Œï¼Œå…¶ç³»ç»Ÿå®æ–½ã€è¿è¡Œç»´æŠ¤ä¸¤ä¸ªé˜¶æ®µä¾å…ˆåé¡ºåºç›¸äº’è¡”æ¥ã€‚ 14.æ€»ä½“è§„åˆ’æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿç”Ÿå‘½å‘¨æœŸçš„ç¬¬ä¸€ä¸ªé˜¶æ®µï¼Œæ˜¯MISçš„æ¦‚å¿µå½¢æˆæ—¶æœŸã€‚ 15.ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç”Ÿå‘½å‘¨æœŸã€‚ ç³»ç»Ÿçš„ç”Ÿå‘½å‘¨æœŸï¼šå‡ºç°éœ€æ±‚ï¼Œæå‡ºæ–°ç³»ç»Ÿæ–¹æ¡ˆï¼Œç³»ç»Ÿäº§ç”Ÿã€æˆé•¿ï¼Œç³»ç»Ÿæˆç†Ÿï¼Œç³»ç»Ÿè¡°é€€ï¼Œç³»ç»ŸåºŸå¼ƒã€‚ 16ï¼Œåè¯è§£é‡Šï¼šâ€œç€‘å¸ƒâ€æ¨¡å‹ã€‚ æŒ‰ç»“æ„åŒ–æ–¹æ³•ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿé€šå¸¸åŒ…æ‹¬æ€»ä½“è§„åˆ’ã€ç³»ç»Ÿåˆ†æã€ç³»ç»Ÿè®¾è®¡ã€ç³»ç»Ÿå®æ–½ã€è¿è¡Œç»´æŠ¤ã€ç³»ç»Ÿè¯„ä»·6ä¸ªä¸»è¦é˜¶æ®µï¼Œå„é˜¶æ®µåƒç€‘å¸ƒæµæ°´ä¸€æ ·è”ä¸ºä¸€ä½“ï¼Œç§°ä¸ºâ€œç€‘å¸ƒâ€æ¨¡å‹ã€‚ 17.æŒ‰ç»“æ„åŒ–æ–¹æ³•ï¼Œç³»ç»Ÿå¼€å‘çš„ä¸»è¦é˜¶æ®µç”±å“ªäº›ï¼Ÿ æŒ‰ç»“æ„åŒ–æ–¹æ³•ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘é€šå¸¸åŒ…æ‹¬æ€»ä½“è§„åˆ’ã€ç³»ç»Ÿåˆ†æã€ç³»ç»Ÿè®¾è®¡ã€ç³»ç»Ÿå®æ–½ã€è¿è¡Œç»´æŠ¤å’Œç³»ç»Ÿè¯„ä»·6ä¸ªä¸»è¦é˜¶æ®µã€‚ 18.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„å…­ä¸ªé˜¶æ®µåˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ æŒ‰ç»“æ„åŒ–æ–¹æ³•ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘é€šå¸¸åŒ…æ‹¬æ€»ä½“è§„åˆ’ã€ç³»ç»Ÿåˆ†æã€ç³»ç»Ÿè®¾è®¡ã€ç³»ç»Ÿå®æ–½ã€è¿è¡Œç»´æŠ¤ã€ç³»ç»Ÿè¯„ä»·6ä¸ªä¸»è¦é˜¶æ®µã€‚ 19.åè¯è§£é‡Šï¼šç³»ç»Ÿçš„ç”Ÿå‘½å‘¨æœŸã€‚ ä»»ä½•ä¸€ä¸ªç³»ç»Ÿéƒ½æœ‰äº§ç”Ÿã€å‘å±•å’Œç­äº¡çš„ç”Ÿå‘½å†ç¨‹ï¼Œè¢«ç§°ä½œç³»ç»Ÿçš„ç”Ÿå‘½å‘¨æœŸã€‚ å„é˜¶æ®µä¸»è¦å†…å®¹ 1.è¯¦ç»†éœ€æ±‚åˆ†æä¹ æƒ¯ä¸Šç§°ä¸ºç³»ç»Ÿåˆ†æï¼Œä¸»è¦æ˜ç¡®æœªæ¥ç³»ç»Ÿï¼ˆBï¼‰ A æ˜¯ä»€ä¹ˆ B å¹²ä»€ä¹ˆ C å¦‚ä½•åš D ä½•æ—¶åš 2.åœ¨ç³»ç»Ÿå®æ–½ä¸­ï¼Œï¼ˆAï¼‰æ˜¯ç¼–å†™ç®¡ç†ä¿¡æ¯ç³»ç»Ÿåº”ç”¨è½¯ä»¶ã€‚ A ç³»ç»Ÿå®ç° B ç³»ç»Ÿæµ‹è¯• C ç›´æ¥åˆ‡æ¢ D å¹³è¡Œåˆ‡æ¢ 3.ç³»ç»Ÿå®æ–½ä¸­ï¼Œï¼ˆBï¼‰éœ€è¦éªŒè¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„å…¨éƒ¨åŠŸèƒ½åŠæ€§èƒ½è¦æ±‚ã€‚ A ç³»ç»Ÿå®ç° B ç³»ç»Ÿæµ‹è¯• C ç³»ç»Ÿåˆ‡æ¢ D ç³»ç»Ÿç»´æŠ¤ 4.ç³»ç»Ÿç»´æŠ¤å·¥ä½œé‡åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„å æ¯”æ˜¯ï¼ˆAï¼‰å·¦å³ã€‚ 70% 60% 50% 40% 5.ç³»ç»Ÿç»´æŠ¤çš„å·¥ä½œå†…å®¹ï¼Œä¸åŒ…æ‹¬ï¼ˆCï¼‰ A ç¨‹åºçš„ç»´æŠ¤ B æ•°æ®çš„ç»´æŠ¤ C æ–‡æ¡£çš„ç»´æŠ¤ D è®¾å¤‡çš„ç»´æŠ¤ 6.æ€»ä½“è®¾è®¡è¦åˆ’åˆ†å­ç³»ç»Ÿï¼Œç¡®å®šå¥½ç»“æ„ï¼Œç”»å‡ºï¼ˆAï¼‰ A æ¨¡å—ç»“æ„å›¾ B ä¸šåŠ¡æµç¨‹å›¾ C æ•°æ®æµå›¾ D å®ä½“è”ç³»å›¾ 7.å›ç­”â€œç³»ç»Ÿå¹²ä»€ä¹ˆâ€çš„é˜¶æ®µæ˜¯ï¼ˆCï¼‰ A æ€»ä½“è§„åˆ’ B ç³»ç»Ÿè®¾è®¡ C ç³»ç»Ÿåˆ†æ D è¿è¡Œç»´æŠ¤ 8.å…³äºç³»ç»Ÿè¯´æ˜è¯´çš„ä½œç”¨ï¼Œé”™è¯¯çš„æ˜¯ï¼ˆAï¼‰ A æè¿°äº†æ–°ç³»ç»Ÿçš„æ•°æ®æ¨¡å‹ B ä¸ºç”¨æˆ·å’Œå¼€å‘äººå‘˜çš„äº¤æµå’Œç›‘ç£æä¾›åŸºç¡€ C ä½œä¸ºæ–°ç³»ç»ŸéªŒæ”¶å’Œè¯„ä»·çš„ä¾æ® D ä½œä¸ºå¼€å‘äººå‘˜è¿›è¡Œç³»ç»Ÿè®¾è®¡å’Œå®æ–½çš„åŸºç¡€ 9.ç³»ç»Ÿè®¾è®¡é˜¶æ®µè¦è§£å†³çš„é—®é¢˜æ˜¯ï¼ˆDï¼‰ A ä¸ºä»€ä¹ˆ B æ˜¯ä»€ä¹ˆ C å¹²ä»€ä¹ˆ D æ€ä¹ˆå¹² 10.å¯ä»¥ä»å¤šæ–¹é¢å¯¹ç³»ç»Ÿè¿›è¡Œè¯„ä»·ï¼Œå…¶ä¸­ä¸€æ–¹é¢æ˜¯è¯„ä»·ç³»ç»Ÿçš„ï¼ˆBï¼‰ A ä½“éªŒ B ç»æµ C ä½¿ç”¨ D æ•´ä½“ 11.åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œæ€»ä½“è§„åˆ’é˜¶æ®µä¸»è¦æ˜ç¡®æ‰€å¼€å‘çš„ç³»ç»Ÿï¼ˆAï¼‰ A æ˜¯ä»€ä¹ˆ B åšä»€ä¹ˆ C æ€ä¹ˆåš D åšçš„æ•ˆæœ 12.æ€»ä½“è§„åˆ’å¯ä»¥æ¦‚æ‹¬ä¸ºï¼ˆCï¼‰ A æ˜ç¡®ç³»ç»Ÿâ€œåšä»€ä¹ˆâ€çš„é—®é¢˜ B æ˜ç¡®ç³»ç»Ÿâ€œå¦‚ä½•åšçš„â€çš„é—®é¢˜ C æ˜ç¡®ç³»ç»Ÿâ€œæ˜¯ä»€ä¹ˆâ€çš„é—®é¢˜ D æ˜ç¡®ç³»ç»Ÿâ€œè°æ¥åšâ€çš„é—®é¢˜ 13.ç³»ç»Ÿåˆ†æå›ç­”çš„æ˜¯ç³»ç»Ÿï¼ˆBï¼‰ A â€œæ˜¯ä»€ä¹ˆâ€çš„é—®é¢˜ B â€œå¹²ä»€ä¹ˆâ€çš„é—®é¢˜ C â€œæ€ä¹ˆå¹²â€çš„é—®é¢˜ D â€œä¸ºä»€ä¹ˆå¹²â€çš„é—®é¢˜ 14.æ€»ä½“è§„åˆ’é˜¶æ®µéœ€è¦å›ç­”çš„é—®é¢˜æ˜¯è¯¥ä¿¡æ¯ç³»ç»Ÿï¼ˆAï¼‰ A æ˜¯ä»€ä¹ˆ B å¹²ä»€ä¹ˆ C å¦‚ä½•å¹² D ä¸ºä»€ä¹ˆå¹² 15.å›ç­”â€œç³»ç»Ÿæ€ä¹ˆå¹²â€çš„é˜¶æ®µæ˜¯ï¼ˆBï¼‰ A ç³»ç»Ÿåˆ†æ B ç³»ç»Ÿè®¾è®¡ C ç³»ç»Ÿå®æ–½ D ç³»ç»Ÿè¯„ä»· 16.ç³»ç»Ÿåˆ‡æ¢æ–¹å¼ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A ç›´æ¥åˆ‡æ¢ B é—´æ¥åˆ‡æ¢ C å¹³è¡Œåˆ‡æ¢ D åˆ†æ®µåˆ‡æ¢ 17.ä½“ç°â€œç³»ç»Ÿæ˜¯ç¥â€çš„é˜¶æ®µæ˜¯ï¼ˆCï¼‰ A ç³»ç»Ÿåˆ†æ B ç³»ç»Ÿè®¾è®¡ C æ€»ä½“è§„åˆ’ D ç³»ç»Ÿè¯„ä»· 18.ç³»ç»Ÿå®æ–½é˜¶æ®µçš„ä¸»è¦æ–‡æ¡£æ˜¯ï¼ˆDï¼‰ A ç³»ç»Ÿè¯´æ˜è¯´ B ç³»ç»Ÿè®¾è®¡è¯´æ˜è¯´ C ç³»ç»Ÿåˆ†ææŠ¥å‘Š D ç”¨æˆ·æ“ä½œæ‰‹å†Œ 19.å¯¹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè¿›è¡Œæ€»ä½“è§„åˆ’æ—¶ï¼Œä¸ºäº†ä½¿é¢†å¯¼å¯¹ç³»ç»Ÿçš„å¼€å‘ä¸å¦ä½œå‡ºå†³ç­–ï¼Œå¹¶ç­¹é›†å¤§é‡çš„è´¹ç”¨ï¼Œéœ€è¦æœ‰ä¸€ä¸ªæ¦‚ç•¥çš„æŠ•èµ„æ–¹æ¡ˆã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 20.æ˜ç¡®ç³»ç»Ÿâ€œæ˜¯ä»€ä¹ˆâ€æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ€»ä½“è§„åˆ’é˜¶æ®µçš„ç›®çš„ã€‚ 21.ç³»ç»Ÿå®æ–½é˜¶æ®µçš„ä¸»è¦æ–‡æ¡£æ˜¯ç”¨æˆ·æ“ä½œæ‰‹å†Œã€‚ 22.ç³»ç»Ÿç»´æŠ¤å·¥ä½œä¸»è¦åŒ…æ‹¬ï¼šç¨‹åºçš„ã€æ•°æ®çš„ã€ä»£ç çš„å’Œè®¾å¤‡çš„ç»´æŠ¤ã€‚ 23.å°†ç³»ç»Ÿåˆ†æè¯´æ˜ä¹¦è½¬æ¢æˆå…·ä½“çš„è®¡ç®—æœºå®æ–½æ–¹æ¡ˆæ˜¯ç³»ç»Ÿè®¾è®¡è¯´æ˜ä¹¦ã€‚ 24.æ€»ä½“è§„åˆ’åˆ’åˆ†ç³»ç»Ÿçš„å­ç³»ç»Ÿï¼Œç¡®å®šç»“æ„ï¼Œç”»å‡ºæ¨¡å—ç»“æ„å›¾ã€‚ 25.å›ç­”â€œç³»ç»Ÿæ˜¯ä»€ä¹ˆâ€çš„é˜¶æ®µæ˜¯æ€»ä½“è§„åˆ’ã€‚ 26.ç³»ç»Ÿåˆ†æé˜¶æ®µæ˜ç¡®è¡¨è¾¾æˆçš„ä¹¦é¢ææ–™æ˜¯ç³»ç»Ÿè¯´æ˜ä¹¦ã€‚ 27.ç³»ç»Ÿè¯„ä»·çš„ä¸€é¡¹å†…å®¹æ˜¯å¯¹ç³»ç»Ÿçš„åŠŸèƒ½å’Œæ€§èƒ½è¿›è¡Œè¯„ä»·ã€‚ 28.ç³»ç»Ÿç»´æŠ¤çš„å·¥ä½œä¸»è¦åŒ…æ‹¬ç¨‹åºçš„ã€æ•°æ®çš„ã€ä»£ç çš„å’Œè®¾å¤‡çš„ç»´æŠ¤ã€‚ 29.ç³»ç»Ÿè½¬æ¢æˆåŠŸï¼Œæ„å‘³ç€æ•´ä½“å¼€å‘è¿‡ç¨‹çš„ç»“æŸï¼Œå³å¯æŠ•å…¥æ­£å¸¸è¿è¡Œï¼Œæ¥ç€çš„ä»»åŠ¡æ˜¯æ–°ç³»ç»Ÿçš„æ­£å¸¸ä½¿ç”¨å’Œç»´æŠ¤ã€‚ 30.åœ¨ç³»ç»ŸæŠ•å…¥æ­£å¼è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œéœ€è¦å¯¹ç³»ç»Ÿè¿è¡Œåçš„å®é™…æ•ˆæœè¿›è¡Œè¯„ä»·ã€‚ 31.å¯¹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè¿›è¡Œæ€»ä½“è§„åˆ’æ—¶ï¼Œåœ¨å®é™…è¿›è¡Œç³»ç»Ÿåˆ†æä¹‹å‰ï¼Œåº”æ‹¿å‡ºä¸€ä¸ªç”±è¯´æœåŠ›çš„ç³»ç»Ÿå¯è¡Œæ€§è¯´æ˜ï¼Œå¯¹ç³»ç»Ÿçš„æ•ˆæœä½œå‡ºè®ºè¯ã€‚ 32.ç³»ç»Ÿè®¾è®¡å¯åˆ†ä¸ºæ€»ä½“è®¾è®¡å’Œè¯¦ç»†è®¾è®¡ä¸¤ä¸ªé˜¶æ®µï¼Œæœ€ç»ˆéœ€è¦äº¤ä»˜ç³»ç»Ÿè®¾è®¡è¯´æ˜ä¹¦ã€‚ 33.ä¸ºäº†æ€»ç»“ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„è¿è¡Œæ•ˆæœï¼Œå¿…é¡»åœ¨é€‚å½“çš„æ—¶å€™ç€æ‰‹è¿›è¡Œç³»ç»Ÿè¯„ä»·å·¥ä½œã€‚ 34.ä»ç³»ç»Ÿå¼€å‘çš„é˜¶æ®µåˆ’åˆ†æ¥çœ‹ï¼Œç³»ç»Ÿåˆ†ææ—¶æ€»ä½“è§„åˆ’å·¥ä½œçš„ç»§ç»­ï¼Œæ˜¯ç³»ç»Ÿè®¾è®¡å·¥ä½œçš„å‰å¯¼ã€‚ 35.åœ¨ç³»ç»Ÿè®¾è®¡é˜¶æ®µï¼Œè®¾è®¡çš„ç»“æœä»¥ç³»ç»Ÿè®¾è®¡è¯´æ˜ä¹¦çš„å½¢å¼æäº¤ã€‚ 36.ä»ç»“æ„åŒ–æ–¹æ³•å¼€å‘è¿‡ç¨‹çš„è§’åº¦çœ‹ï¼Œç®¡ç†ä¿¡æ¯ç³»ç»Ÿå»ºè®¾çš„ç¬¬ä¸€æ­¥æ˜¯æ€»ä½“è§„åˆ’ã€‚ 37.MISæ€»ä½“è§„åˆ’ä¸­ä¸¤ä¸ªç›¸äº’è¡”æ¥çš„æ­¥éª¤æ˜¯æ‹Ÿå®šç³»ç»Ÿå®æ–½æ–¹æ¡ˆå’Œå¯è¡Œæ€§åˆ†æã€‚ 38.ç³»ç»Ÿè®¾è®¡å¯åˆ†ä¸ºæ€»ä½“è®¾è®¡å’Œè¯¦ç»†è®¾è®¡ä¸¤ä¸ªé˜¶æ®µã€‚ 39.ä»å“ªäº›æ–¹é¢å¯¹ç³»ç»Ÿè¿›è¡Œè¯„ä»·ï¼Ÿ é€šå¸¸å¯ä»¥ä»å‡ æ–¹é¢å¯¹ç³»ç»Ÿè¿›è¡Œè¯„ä»·ï¼š1.ç³»ç»Ÿçš„åŠŸèƒ½å’Œæ€§èƒ½ï¼›2.ç³»ç»Ÿçš„ç»æµæ•ˆæœï¼›3.å…¶ä»–æ–¹é¢çš„è¯„ä»·ï¼šæ–‡æ¡£æ˜¯å¦é½å…¨ã€æ¸…æ™°ã€ç¨‹åºé‡çš„å¤§å°ã€å¼€å‘å‘¨æœŸçš„é•¿çŸ­ã€‚ 40.ç®€è¿°ç³»ç»Ÿå®æ–½é˜¶æ®µçš„ä¸»è¦å·¥ä½œã€‚ è¯¥é˜¶æ®µçš„å·¥ä½œä¸»è¦åŒ…æ‹¬ï¼šç³»ç»Ÿå®ç°ã€ç³»ç»Ÿæµ‹è¯•å’Œç³»ç»Ÿåˆ‡æ¢ç­‰å†…å®¹ã€‚ 41.ç³»ç»Ÿæµ‹è¯•çš„ä»»åŠ¡ã€‚ ç³»ç»Ÿæµ‹è¯•çš„ä»»åŠ¡æ˜¯å‘ç°ç³»ç»Ÿå­˜åœ¨çš„é—®é¢˜ï¼ŒéªŒè¯å’Œç¡®è®¤ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯å¦æ»¡è¶³ç³»ç»Ÿè¯´æ˜ä¹¦æ–‡ä»¶çš„å…¨éƒ¨åŠŸèƒ½åŠæ€§èƒ½è¦æ±‚ã€‚ 42.ç³»ç»Ÿè¿è¡Œç»´æŠ¤é˜¶æ®µçš„ä¸»è¦ä»»åŠ¡ã€‚ ç³»ç»Ÿè½¬åŒ–æˆæœï¼Œæ„å‘³ç€æ•´ä½“å¼€å‘è¿‡ç¨‹çš„ç»“æŸï¼Œå³å¯æŠ•å…¥æ­£å¸¸è¿è¡Œï¼Œæ¥ç€çš„ä»»åŠ¡æ˜¯æ–°ç³»ç»Ÿçš„æ­£å¸¸ä½¿ç”¨å’Œç»´æŠ¤ï¼Œå¹¶æ’°å†™è¿è¡ŒçŠ¶å†µæŠ¥å‘Šï¼Œè¿™äº›å°±æ˜¯èƒ¸è¿è¡Œç»´æŠ¤é˜¶æ®µçš„ä¸»è¦ä»»åŠ¡ã€‚ 43.ç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦ä»»åŠ¡ã€‚ ç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦ä»»åŠ¡æ˜¯å¼€å‘äººå‘˜åŒç”¨æˆ·ä¸€èµ·ï¼Œé€šè¿‡å¯¹å½“å‰ç³»ç»Ÿçš„è¯¦ç»†è°ƒæŸ¥å’Œåˆ†æå……åˆ†ç†è§£æ–°ç³»ç»Ÿç›®æ ‡ï¼Œå³ç”¨æˆ·çš„éœ€æ±‚ï¼Œå¹¶å°†å®ƒæ˜ç¡®çš„è¡¨è¾¾æˆä¹¦é¢èµ„æ–™-ç³»ç»Ÿè¯´æ˜ä¹¦ã€‚ 44.åè¯è§£é‡Šï¼šç³»ç»Ÿè¯´æ˜ä¹¦ã€‚ ç³»ç»Ÿåˆ†æé˜¶æ®µå¼€å‘äººå‘˜åŒç”¨æˆ·ä¸€èµ·ï¼Œé€šè¿‡å¯¹å½“å‰ç³»ç»Ÿçš„è¯¦ç»†è°ƒæŸ¥å’Œåˆ†æå……åˆ†ç†è§£æ–°ç³»ç»Ÿç›®æ ‡ï¼Œå³ç”¨æˆ·çš„éœ€æ±‚ï¼Œå¹¶å°†å®ƒæ˜ç¡®åœ°è¡¨è¾¾æˆä¹¦é¢èµ„æ–™-ç³»ç»Ÿè¯´æ˜ä¹¦ã€‚ç³»ç»Ÿè¯´æ˜ä¹¦åœ¨ç³»ç»Ÿå¼€å‘è¿‡ç¨‹ä¸­éå¸¸é‡è¦ï¼Œè¦æ±‚è¯¥æ–‡æ¡£å®Œæ•´ã€ä¸€è‡´ã€ç²¾ç¡®ä¸”ç®€æ˜æ˜“æ‡‚å’Œæ˜“äºç»´æŠ¤ã€‚ 45.å¯¹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè¿›è¡Œæ€»ä½“è§„åˆ’ï¼Œæ˜¯å¤„äºå“ªäº›è€ƒè™‘ï¼Ÿ å¯¹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè¿›è¡Œæ€»ä½“è§„åˆ’ï¼Œæ˜¯å‡ºäºä»¥ä¸‹çš„è€ƒè™‘ï¼š1.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ˜¯ç”±ä¼—å¤šçš„å­ç³»ç»Ÿæ‰€ç»„æˆçš„ï¼Œä¸ºäº†ä»–ä»¬çš„ç»„æˆå’Œå…³ç³»ç”±åˆæ­¥äº†è§£ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥çš„åˆ†æå·¥ä½œï¼Œå°±å¿…é¡»å…ˆä»æ€»ä½“ä¸Šæå‡ºæ–¹æ¡ˆï¼›2.ä¸ºäº†ä½¿é¢†å¯¼å¯¹ç³»ç»Ÿçš„å¼€å‘ä¸å¦ä½œå‡ºå†³ç­–ï¼Œå¹¶ç­¹é›†å¤§é‡çš„è´¹ç”¨ï¼Œéœ€è¦æœ‰ä¸€ä¸ªæ¦‚æ‹¬çš„æŠ•èµ„æ–¹æ¡ˆï¼›3.åœ¨å®é™…è¿›è¡Œç³»ç»Ÿåˆ†æä¹‹å‰ï¼Œåº”æ‹¿å‡ºä¸€ä¸ªæœ‰è¯´æœåŠ›çš„ç³»ç»Ÿå¯è¡Œæ€§è¯´æ˜ï¼Œå¯¹ç³»ç»Ÿçš„æ•ˆæœä½œå‡ºè®ºè¯ï¼›4.ç”±äºè´¢åŠ›é™åˆ¶ï¼Œç”¨æˆ·å¾€å¾€éœ€è¦åˆ†æ­§åˆ†æ‰¹åœ°å®æ–½å­ç³»ç»Ÿï¼Œå› è€Œéœ€è¦å®ç°ä½œå‡ºåˆ†æ‰¹å¼€å‘è®¡åˆ’ã€‚ 46.åè¯è§£é‡Šï¼šç³»ç»Ÿåˆ†æã€‚ ç³»ç»Ÿåˆ†æé˜¶æ®µä¸»è¦æ˜¯è§£å†³â€œå¹²ä»€ä¹ˆâ€çš„é—®é¢˜ã€‚ç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦ä»»åŠ¡æ˜¯å¼€å‘äººå‘˜åŒç”¨æˆ·ä¸€èµ·ï¼Œé€šè¿‡å¯¹å½“å‰ç³»ç»Ÿçš„è¯¦ç»†è°ƒæŸ¥å’Œåˆ†æå……åˆ†ç†è§£æ–°ç³»ç»Ÿç›®æ ‡ï¼Œå³ç”¨æˆ·çš„éœ€æ±‚ï¼Œå¹¶å°†å®ƒæ˜ç¡®åœ°è¡¨è¾¾æˆä¹¦é¢èµ„æ–™-ç³»ç»Ÿè¯´æ˜ä¹¦ã€‚ 47.åè¯è§£é‡Šï¼šç³»ç»Ÿç³»ç»Ÿçš„æ€»ä½“è§„åˆ’ã€‚ æ€»ä½“è§„åˆ’æ—¶ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå»ºè®¾çš„ç¬¬ä¸€æ­¥ï¼Œæ„åœ¨é€šè¿‡åˆæ­¥çš„ã€æ€»ä½“çš„éœ€æ±‚åˆ†æï¼Œå›ç­”â€œç³»ç»Ÿæ˜¯ä»€ä¹ˆâ€çš„é—®é¢˜ï¼Œè¿›è¡Œå¯è¡Œæ€§è®ºè¯ã€‚ 48.ç³»ç»Ÿè¯´æ˜è¯´çš„ä¸‰ä¸ªä½œç”¨ã€‚ 1.æè¿°äº†æ–°ç³»ç»Ÿçš„é€»è¾‘æ¨¡å‹ï¼Œä½œä¸ºå¼€å‘äººå‘˜è¿›è¡Œç³»ç»Ÿè®¾è®¡å’Œå®æ–½çš„åŸºç¡€ï¼›2.ä½œä¸ºç”¨æˆ·å’Œå¼€å‘äººå‘˜ä¹‹é—´çš„åè®®å’ŒåˆåŒï¼Œä¸ºåŒæ–¹çš„äº¤æµå’Œç›‘ç£æä¾›åŸºç¡€ï¼›3.ä½œä¸ºæ–°ç³»ç»ŸéªŒæ”¶å’Œè¯„ä»·çš„ä¾æ®ã€‚ 49.ç³»ç»Ÿè¯´æ˜ä¹¦ä½œç”¨ä½“ç°åœ¨å“ªäº›æ–¹é¢ï¼Ÿ 1.æè¿°äº†æ–°ç³»ç»Ÿçš„é€»è¾‘æ¨¡å‹ï¼Œä½œä¸ºå¼€å‘äººå‘˜è¿›è¡Œç³»ç»Ÿè®¾è®¡å’Œå®æ–½çš„åŸºç¡€ï¼›2.ä½œä¸ºç”¨æˆ·å’Œå¼€å‘äººå‘˜ä¹‹é—´çš„åè®®å’ŒåˆåŒï¼Œä¸ºåŒæ–¹äº¤æµå’Œç›‘ç£æä¾›åŸºç¡€ï¼›3.ä¸ºæ–°ç³»ç»ŸéªŒæ”¶å’Œè¯„ä»·æä¾›ä¾æ®ã€‚ 50.åè¯è§£é‡Šï¼šç³»ç»Ÿåˆ‡æ¢ã€‚ ç³»ç»Ÿåˆ‡æ¢æ˜¯æŒ‡ä»¥æ–°ç³»ç»Ÿä»£æ›¿å½“å‰ç³»ç»Ÿçš„è¿‡ç¨‹ï¼Œé€šå¸¸åŒ…æ‹¬äººå‘˜åŸ¹è®­ã€è¿è¡Œç¯å¢ƒå‡†å¤‡ã€æ•°æ®å‡†å¤‡ã€ç®¡ç†åˆ¶åº¦å’Œæµç¨‹å‡†å¤‡ç­‰å·¥ä½œï¼Œä¸€èˆ¬æœ‰ç›´æ¥åˆ‡æ¢ã€å¹³è¡Œåˆ‡æ¢å’Œåˆ†æ®µåˆ‡æ¢ä¸‰ç§æ›´ç­–ç•¥ã€‚ 51.åè¯è§£é‡Šï¼šæ€»ä½“è§„åˆ’ã€‚ æ€»ä½“è§„åˆ’æ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿç”Ÿå‘½å‘¨æœŸçš„ç¬¬ä¸€é˜¶æ®µï¼Œå…¶ç›®çš„æ˜¯æ˜ç¡®ç³»ç»Ÿâ€œæ˜¯ä»€ä¹ˆâ€çš„é—®é¢˜ï¼Œæç»˜å‡ºä¿¡æ¯ç³»ç»Ÿçš„æ¶æ„ï¼Œå¯¹ä¿¡æ¯ç³»ç»Ÿæå‡ºå®Œæ•´ã€æ¸…æ™°çš„è¦æ±‚ã€‚ 52.åå­—è§£é‡Šï¼šç³»ç»Ÿè¯„ä»·ã€‚ åœ¨ç³»ç»ŸæŠ•å…¥æ­£å¼è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œä¸ºäº†äº†è§£æ–°ç³»ç»Ÿæ˜¯å¦è¾¾åˆ°äº†é¢„æœŸçš„ç›®æ ‡å’Œè¦æ±‚ï¼ŒåŒæ—¶ä¹Ÿä¸ºäº†æ€»ç»“å¼€å‘ç»éªŒï¼Œéœ€è¦å¯¹ç³»ç»Ÿè¿è¡Œåçš„å®é™…æ•ˆæœè¿›è¡Œè¯„ä»·ã€‚ 53.æ€»ä½“è§„åˆ’é˜¶æ®µä¸»è¦åŒ…æ‹¬å“ªäº›å·¥ä½œï¼Ÿ 1.å¯¹å½“å‰ç³»ç»Ÿè¿›è¡Œåˆæ­¥è°ƒæŸ¥ï¼›2.åˆ†æå’Œç¡®å®šç³»ç»Ÿç›®æ ‡ï¼›3.åˆ†æå­ç³»ç»Ÿçš„ç»„æˆä»¥åŠåŸºæœ¬åŠŸèƒ½ï¼›4.æ‹Ÿå®šç³»ç»Ÿçš„å®æ–½æ–¹æ¡ˆï¼›5.è¿›è¡Œç³»ç»Ÿçš„å¯è¡Œæ€§ç ”ç©¶ï¼›6.ç¼–å†™å¯è¡Œæ€§æŠ¥å‘Šã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸‰ç« _ç³»ç»Ÿå¼€å‘æ–¹æ³•æ¦‚è¿°/ç¬¬å››èŠ‚_å¼€å‘è¿‡ç¨‹ç»„ç»‡ä¸ç®¡ç†æ–¹æ³•.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬ä¸‰ç« _ç³»ç»Ÿå¼€å‘æ–¹æ³•æ¦‚è¿°/ç¬¬å››èŠ‚_å¼€å‘è¿‡ç¨‹ç»„ç»‡ä¸ç®¡ç†æ–¹æ³•.html","title":"ç¬¬å››èŠ‚ï¼šå¼€å‘è¿‡ç¨‹ç»„ç»‡ä¸ç®¡ç†æ–¹æ³•","keywords":"","body":"ç¬¬å››èŠ‚ï¼šå¼€å‘è¿‡ç¨‹ç»„ç»‡ä¸ç®¡ç†æ–¹æ³• å¼€å‘è¿‡ç¨‹ç»„ç»‡ä¸ç®¡ç†æ–¹æ³• é¡¹ç›®ç®¡ç†çš„ä¸»è¦å†…å®¹ 1.é’ˆå¯¹æ¯ä¸€ç±»å¼€å‘äººå‘˜åˆ¶å®šå…¶å·¥ä½œè¿‡ç¨‹ä¸­çš„è´£ä»»ã€ä¹‰åŠ¡ã€å®Œæˆä»»åŠ¡çš„è´¨é‡æ ‡å‡†æ˜¯ï¼ˆCï¼‰é˜¶æ®µçš„å†…å®¹ã€‚ A è®¡åˆ’å®‰æ’ B ç»è´¹ç®¡ç† C å®¡è®¡æ§åˆ¶ D è´¨é‡ä¿è¯ 2.ç¼–åˆ¶å‡ºä»»åŠ¡å®Œæˆè®¡åˆ’è¡¨ï¼Œä½œä¸ºè®¡åˆ’å®æ–½ç›‘æ§çš„åŸºç¡€ï¼ŒæŒ‡çš„æ˜¯é¡¹ç›®ç®¡ç†çš„ï¼ˆBï¼‰ A ä»»åŠ¡åˆ’åˆ† B è®¡åˆ’å®‰æ’ C ç»è´¹ç®¡ç† D å®¡è®¡æ§åˆ¶ 3.å¯¹ç³»ç»Ÿå¼€å‘å„ä¸ªé˜¶æ®µè¿›è¡ŒæŠ€æœ¯è¯„å®¡å±äºé¡¹ç›®ç®¡ç†çš„ï¼ˆCï¼‰ A å®¡è®¡æ§åˆ¶å·¥ä½œ B é£é™©ç®¡ç†å·¥ä½œ C è´¨é‡ä¿è¯å·¥ä½œ D è®¡åˆ’å®‰æ’å·¥ä½œ 4.é¡¹ç›®ç»ç†å¯ä»¥è¿ç”¨ç»æµæ æ†æ¥æ§åˆ¶æ•´ä¸ªå¼€å‘å·¥ä½œï¼ŒæŒ‡çš„æ˜¯ï¼ˆBï¼‰ A ä»»åŠ¡åˆ’åˆ† B ç»è´¹ç®¡ç† C å®¡è®¡æ§åˆ¶ D è´¨é‡ä¿è¯ 5.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘æœŸé—´çš„é¡¹ç›®ç®¡ç†æœ‰6é¡¹ä¸»è¦å†…å®¹ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼ˆD) A ä»»åŠ¡åˆ’åˆ†ã€è®¡åˆ’å®‰æ’ã€æ€»ä½“è§„åˆ’ã€è¿è¡Œç»´æŠ¤ B ç»è´¹ç®¡ç†ã€é£é™©ç®¡ç†ã€ç³»ç»Ÿå®æ–½ã€ç³»ç»Ÿè¯„ä»· C è®¡åˆ’å®‰æ’ã€ç»è´¹ç®¡ç†ã€ç³»ç»Ÿè®¾è®¡ã€ç³»ç»Ÿè¯„ä»· D ä»»åŠ¡åˆ’åˆ†ã€è®¡åˆ’å®‰æ’ã€é£é™©ç®¡ç†ã€è´¨é‡ä¿è¯ 6.é£é™©ç®¡ç†æ˜¯å¯¹å·²ç»å‘ç”Ÿçš„é—®é¢˜é‡‡å–äº‹å…ˆé¢„é˜²çš„å¤„ç†æ–¹æ³•ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 7.åœ¨é¡¹ç›®ç®¡ç†ä¸­ï¼Œä»»åŠ¡è´Ÿè´£äººæœ‰ä»»æ„æ”¯é…ç»è´¹çš„æƒåˆ©ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 8.ä»»åŠ¡åˆ’åˆ†æœ‰åˆ©äºå°†ä»»åŠ¡è´£ä»»è½å®åˆ°äººï¼Œä¾¿äºåˆ†æ¸…æ¯ä¸ªäººçš„èŒè´£ï¼Œæœ‰åˆ©äºè´£ã€æƒã€åˆ©ç›¸ç»“åˆçš„ç›‘ç£å’Œç®¡ç†æ–¹å¼ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 9.ä¸ºäº†ä¿è¯ç³»ç»Ÿå¼€å‘å·¥ä½œçš„é¡ºåˆ©è¿›è¡Œï¼Œéœ€è¦æŒæ¡é¡¹ç›®çš„è¿›å±•æƒ…å†µï¼ŒåŠæ—¶å¤„ç†å¼€å‘è¿‡ç¨‹ä¸­å‡ºç°çš„é—®é¢˜ï¼ŒåŠæ—¶ä¿®æ­£å¼€å‘å·¥ä½œä¸­å‡ºç°çš„åå·®ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 10.å®¡è®¡æ§åˆ¶æŒ‰ç…§è®¡åˆ’å¯¹æ¯é¡¹ä»»åŠ¡è¿›è¡Œå®¡è®¡ï¼Œåˆ†ææ‰§è¡Œä»»åŠ¡è®¡åˆ’è¡¨å’Œç»è´¹çš„å˜åŒ–æƒ…å†µï¼Œç¡®å®šéœ€è¦è°ƒæ•´ã€å˜åŒ–çš„éƒ¨åˆ†ï¼Œå¹¶æ ¹æ®ä»»åŠ¡å®Œæˆè®¡åˆ’è¡¨å’Œå®¡è®¡ç»“æœã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 11.é¡¹ç›®ç®¡ç†çš„é‡ç‚¹å’Œéš¾ç‚¹æ˜¯è´¨é‡ä¿è¯ã€‚ 12.å¹¿ä¹‰ä¸Šï¼Œé¡¹ç›®ç®¡ç†åŒ…æ‹¬ç³»ç»Ÿå¼€å‘æœŸå’Œç³»ç»Ÿç»´æŠ¤å…¶çš„ç®¡ç†ã€‚ 13.é¡¹ç›®ç®¡ç†çš„ä¸»è¦å†…å®¹ä¸­ï¼Œä»»åŠ¡åˆ’åˆ†æ˜¯æŠŠæ•´ä¸ªå¼€å‘å·¥ä½œå®šä¹‰ä¸ºä¸€ç»„ä»»åŠ¡çš„é›†åˆã€‚ 14.è´¨é‡ä¿è¯çš„ä¸€é¡¹å†…å®¹æ˜¯åˆ¶å®šå¹¶æ‰§è¡Œç³»ç»Ÿæµ‹è¯•ç­–ç•¥å’Œæµ‹è¯•è®¡åˆ’ã€‚ 15.ä¿è¯ç³»ç»Ÿå¼€å‘è¿‡ç¨‹åŠç›¸å…³æŠ€æœ¯æ ‡å‡†çš„ä¸€è‡´æ€§æ˜¯è´¨é‡ä¿è¯çš„ä¸€é¡¹å†…å®¹ã€‚ 16.å¯¹ç³»ç»Ÿå¼€å‘å„é˜¶æ®µè¿›è¡ŒæŠ€æœ¯è¯„å®¡æ˜¯è´¨é‡ä¿è¯çš„ä¸€é¡¹å†…å®¹ã€‚ 17.é£é™©ç®¡ç†çš„ä¸»è¦ä»»åŠ¡æ˜¯å¯¹æ½œåœ¨çš„é—®é¢˜é‡‡å–äº‹å…ˆé¢„é˜²çš„å¤„ç†æ–¹æ³•ï¼Œä»¥ä¾¿å°½å¯èƒ½åœ°æé«˜ç³»ç»Ÿå¼€å‘çš„æˆåŠŸå’Œå¼€å‘è¿›ç¨‹ã€‚ 18.é€šè¿‡å®¡è®¡ä¸æ§åˆ¶ï¼Œå¯¹äºç³»ç»Ÿå¼€å‘ä¸­å‡ºç°çš„å˜åŒ–æƒ…å†µï¼Œé¡¹ç›®ç»ç†è¦åŠæ—¶ä¸ç”¨æˆ·å’Œä¸»ç®¡éƒ¨é—¨è”ç³»ï¼Œé’ˆå¯¹å˜åŒ–æƒ…å†µé‡‡å–ç›¸åº”çš„å¯¹ç­–ã€‚ 19.é£é™©ç®¡ç†çš„ä¸»è¦ä»»åŠ¡æ˜¯å¯¹æ½œåœ¨çš„é—®é¢˜é‡‡å–äº‹å…ˆé¢„é˜²çš„å¤„ç†æ–¹æ³•ï¼Œä»¥ä¾¿å°½å¯èƒ½åœ°æé«˜ç³»ç»Ÿå¼€å‘çš„æˆåŠŸç‡å’Œå¼€å‘è¿›ç¨‹ã€‚ 20.è´¨é‡ä¿è¯æ˜¯é¡¹ç›®ç®¡ç†çš„é‡ç‚¹å’ŒæŒ‰ç‚¹ï¼Œå®ƒä¸€èˆ¬åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼Œå³äº‹å‰å‡†å¤‡ã€è¿‡ç¨‹ç›‘æ§ã€äº‹åè¯„å®¡ç­‰ã€‚ 21.è´¨é‡ä¿è¯çš„ä¸€é¡¹å†…å®¹æ˜¯ç ”ç©¶å¹¶é€‰ç”¨ç³»ç»Ÿå¼€å‘æ–¹æ³•å’Œå·¥å…·ã€‚ 22.åœ¨æ€»ä½“è§„åˆ’é˜¶æ®µå¯¹ç³»ç»Ÿè´¨é‡æå‡ºè¦æ±‚æ—¶è´¨é‡ä¿è¯çš„ä¸€é¡¹å†…å®¹ã€‚ 23.åœ¨é¡¹ç›®ç®¡ç†è¿‡ç¨‹ä¸­ï¼Œé¡¹ç›®ç»ç†å¯ä»¥è¿ç”¨ç»æµæ æ†æ¥æ§åˆ¶æ•´ä¸ªå¼€å‘å·¥ä½œã€‚ 24.å…³äºè¿›è¡Œä»»åŠ¡åˆ’åˆ†çš„ç›®çš„ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹é¢æ˜¯æœ‰åˆ©äºèµ„é‡‘çš„åˆ†é…ã€‚ 25.é¡¹ç›®ç®¡ç†çš„è®¡åˆ’å®‰æ’é˜¶æ®µï¼Œä»»åŠ¡å®Œæˆè®¡åˆ’è¡¨è¦è¡¨æ˜ä»»åŠ¡çš„å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´ï¼Œä»¥åŠä»»åŠ¡ä¹‹é—´çš„ç›¸äº’ä¾èµ–çš„ç¨‹åº¦ï¼Œä¸€æ¬¡ä½œä¸ºè®¡åˆ’å®æ–½ç›‘æ§çš„åŸºç¡€ã€‚ 26.è®¡åˆ’å®‰æ’ä¸­çš„è®¡åˆ’åˆ¶å®šå‡ºæ¥åï¼Œå¯ä»¥ç¼–åˆ¶å‡ºä»»åŠ¡å®Œæˆè®¡åˆ’è¡¨ã€‚ 27.ä»»åŠ¡å®Œæˆè®¡åˆ’è¡¨è¦è¡¨æ˜ä»»åŠ¡çš„å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´ï¼Œä»¥åŠä»»åŠ¡ä¹‹é—´çš„ç›¸äº’ä¾èµ–ç¨‹åº¦ï¼Œä»¥æ­¤ä½œä¸ºè®¡åˆ’å®æ–½ç›‘æ§çš„åŸºç¡€ã€‚ 28.é¡¹ç›®ç®¡ç†çš„ä¸»è¦å†…å®¹æœ‰å¤šä¸ªæ–¹é¢ï¼Œå…¶ä¸­ä¸€é¡¹å†…å®¹æ˜¯ä»»åŠ¡åˆ’åˆ†ã€‚ 29.é¡¹ç›®ç»ç†å¯ä»¥è¿ç”¨ç»æµæ æ†æ¥æ§åˆ¶åœ³ä¸ªå¼€å‘å·¥ä½œï¼Œç»è´¹çš„æœ‰æ•ˆè¿ä½œå¯ä»¥èµ·åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœã€‚ 30.é£é™©ç®¡ç†é€šå¸¸å¯ä»¥åˆ’åˆ†ä¸ºé£é™©è¯†åˆ«ã€é£é™©åˆ†æã€é£é™©ç¼“å’Œå’Œé£é™©è·Ÿè¸ªå››ä¸ªé˜¶æ®µã€‚ 31.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘é¡¹ç›®ç®¡ç†ä¸­è´¨é‡ä¿è¯ä¸€èˆ¬åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼Œå³äº‹å‰å‡†å¤‡ã€è¿‡ç¨‹ç›‘æ§ã€äº‹åè¯„å®¡ã€‚ 32.ä¿¡æ¯ç³»ç»Ÿå¼€å‘è¿‡ç¨‹é¡¹ç›®ç®¡ç†çš„ä¸»è¦å†…å®¹ä¸€èˆ¬åŒ…æ‹¬ä»»åŠ¡åˆ’åˆ†ã€è®¡åˆ’å®‰æ’ã€ç»è´¹ç®¡ç†ã€å®¡è®¡æ§åˆ¶ã€é£é™©ç®¡ç†ã€è´¨é‡ä¿è¯ç­‰æ–¹é¢ã€‚ 33.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘æœŸé—´çš„é¡¹ç›®ç®¡ç†æœ‰6é¡¹ä¸»è¦å†…å®¹ï¼Œå…¶ä¸­åŒ…æ‹¬ä»»åŠ¡åˆ’åˆ†ã€è®¡åˆ’å®‰æ’ã€ç»è´¹ç®¡ç†ã€å®¡è®¡æ§åˆ¶ã€é£é™©ç®¡ç†ã€è´¨é‡ä¿è¯ã€‚ 34.é£é™©ç®¡ç†åˆ†ä¸ºé£é™©è¯†åˆ«ã€é£é™©åˆ†æã€é£é™©ç¼“å’Œå’Œé£é™©è·Ÿè¸ªå››ä¸ªé˜¶æ®µã€‚ 35.é£é™©ç®¡ç†åˆ†ä¸ºé£é™©è¯†åˆ«ã€é£é™©åˆ†æã€é£é™©ç¼“å’Œå’Œé£é™©è·Ÿè¸ªå››ä¸ªé˜¶æ®µã€‚ 36.ä»»åŠ¡åˆ’åˆ†çš„ç›®çš„ã€‚ ä¸€æ–¹é¢å°†æ•´ä¸ªå·¥ä½œåˆ’åˆ†æˆè‹¥å¹²ä¸ªè¾ƒå…·ä½“çš„ä»»åŠ¡ç¾¤ï¼Œæœ‰åˆ©äºä»»åŠ¡è´£ä»»è½å®åˆ°äººï¼Œä¾¿äºåˆ†æ¸…æ¯ä¸ªäººçš„èŒè´£ï¼Œæœ‰åˆ©äºè´£ã€æƒã€åˆ©ç›¸ç»“åˆçš„ç›‘ç£å’Œç®¡ç†æ–¹å¼ï¼Œå¦ä¸€æ–¹é¢è¿™æ ·åšæœ‰åˆ©äºèµ„é‡‘çš„åˆ†é…ï¼Œä¿è¯èµ„é‡‘çš„æœ‰æ•ˆæ§åˆ¶ã€‚ 37.é¡¹ç›®ç®¡ç†ä¸­ï¼Œå¼€å‘è®¡åˆ’çš„å†…å®¹åˆ’åˆ†ä¸ºå“ªäº›æ–¹é¢ï¼Ÿ å¼€å‘è®¡åˆ’å¯ä»¥åˆ’åˆ†ä¸ºè®¡ç®—æœºè½¯ç¡¬ä»¶çš„é…ç½®è®¡åˆ’ã€å¼€å‘è®¡åˆ’ã€æµ‹è¯•å’Œè¯„ä¼°è®¡åˆ’ã€éªŒæ”¶ä¿è¯è®¡åˆ’ã€ç³»ç»Ÿå·¥ç¨‹ç®¡ç†è®¡åˆ’ã€åŸ¹è®­è®¡åˆ’ã€å®‰è£…è®¡åˆ’ç­‰ã€‚ 38.é£é™©ç®¡ç†çš„ä¸»è¦ä»»åŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ é£é™©ç®¡ç†çš„ä¸»è¦ä»»åŠ¡æ˜¯å¯¹æ½œåœ¨çš„é—®é¢˜é‡‡å–äº‹å…ˆé¢„é˜²çš„å¤„ç†æ–¹æ³•ï¼Œä»¥ä¾¿å°½å¯èƒ½åœ°æä¾›ç³»ç»Ÿå¼€å‘çš„æˆåŠŸç‡å’Œå¼€å‘è¿›ç¨‹ã€‚ 39.é¡¹ç›®ç®¡ç†ä¸­ï¼Œè´¨é‡ä¿è¯åˆ†ä¸ºå“ªå‡ ä¸ªé˜¶æ®µï¼Ÿ åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘é¡¹ç›®ç®¡ç†ä¸­ï¼Œè´¨é‡ä¿è¯ä¸€èˆ¬åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼Œå³äº‹å‰å‡†å¤‡ã€è¿‡ç¨‹ç›‘æ§ã€äº‹åè¯„å®¡ç­‰ã€‚ 40.é¡¹ç›®ç®¡ç†ä¸­ï¼Œè´¨é‡ä¿è¯åŒ…æ‹¬å“ªäº›å†…å®¹ï¼Ÿ è´¨é‡ä¿è¯é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š1.åœ¨æ€»ä½“è§„åˆ’é˜¶æ®µå¯¹ç³»ç»Ÿè´¨é‡æå‡ºè¦æ±‚ï¼Œå¹¶åœ¨ç³»ç»Ÿåˆ†æé˜¶æ®µè¿›è¡Œç»†åŒ–å’Œå®Œå–„ï¼›2.ç ”ç©¶å¹¶é€‰ç”¨ç³»ç»Ÿå¼€å‘æ–¹æ³•å’Œå·¥å…·ï¼›3.å¯¹ç³»ç»Ÿå¼€å‘å„é˜¶æ®µè¿›è¡ŒæŠ€æœ¯è¯„å®¡ï¼›4.åˆ¶å®šå¹¶æ‰§è¡Œç³»ç»Ÿæµ‹è¯•ç­–ç•¥å’Œæµ‹è¯•è®¡åˆ’ï¼›5.æŒ‰è¦æ±‚å½¢æˆç³»ç»Ÿæ–‡æ¡£å¹¶å¯¹æ–‡æ¡£çš„æ”¹å˜è¿›è¡Œæ§åˆ¶ï¼›6.ä¿è¯ç³»ç»Ÿå¼€å‘è¿‡ç¨‹åŠç›¸å…³æŠ€æœ¯æ ‡å‡†çš„ä¸€è‡´æ€§ï¼›7.å»ºç«‹ç³»ç»Ÿè´¨é‡çš„åº¦é‡æ¨¡å‹å’Œç›¸åº”çš„æœºåˆ¶ï¼›8.å¯¹å„ç§è´¨é‡ä¿è¯è¿›è¡Œè®°å½•ï¼Œå¹¶å½¢æˆæŠ¥å‘Šã€‚ 41.ç®€è¿°é¡¹ç›®ç®¡ç†ä¸­ç»è´¹ç®¡ç†çš„ä¸»è¦å†…å®¹ã€‚ ç»è´¹ç®¡ç†åœ¨æ•´ä¸ªå¼€å‘é¡¹ç›®ç®¡ç†ä¸­å¤„äºé‡è¦çš„åœ°ä½ã€‚é¡¹ç›®ç»ç†å¯ä»¥è¿ç”¨ç»æµæ æ†æ¥æ§åˆ¶æ•´ä¸ªå¼€å‘å·¥ä½œã€‚ç»è´¹çš„æœ‰æ•ˆè¿ç”¨å¯ä»¥èµ·åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœï¼Œç¹æ®–ï¼Œä¹Ÿè®¸åŒ–äº†å¾ˆå¤šé’±ï¼Œå¼€å‘å·¥ä½œå´æ¯«æ— è¿›å±•ã€‚åœ¨é¡¹ç›®ç®¡ç†ä¸­ï¼Œèµ‹äºˆä»»åŠ¡è´£ä»»äººä¸€å®šèŒè´£çš„åŒæ—¶ï¼Œè¿˜è¦èµ‹äºˆä»–ä¸€å®šçš„ç»è´¹æ”¯é…æƒï¼ŒåŒæ—¶è¦å¯¹å…¶è¿›è¡Œé€‚å½“çš„æ§åˆ¶ã€‚æ‰€ä»¥ä»»åŠ¡è´£ä»»äººä¸å¯ä»¥éšæ„æ”¯é…ç»è´¹ï¼Œæ˜¯éœ€è¦æ”¶åˆ°ä¸€å®šçš„çº¦æŸçš„ã€‚ 42.ç®€è¿°é¡¹ç›®ç®¡ç†ä¸­å®¡è®¡æ§åˆ¶çš„å†…å®¹ã€‚ å®¡è®¡æ§åˆ¶æ˜¯æŒ‰ç…§æ‰€é‡‡ç”¨çš„å¼€å‘æ–¹æ³•ï¼Œé’ˆå¯¹æ¯ä¸€ç±»å¼€å‘äººå‘˜åˆ¶å®šå‡ºå…¶å·¥ä½œè¿‡ç¨‹çš„è´£ä»»ã€ä¹‰åŠ¡ã€å®Œæˆä»»åŠ¡çš„è´¨é‡æ ‡å‡†ç­‰ï¼ŒæŒ‰ç…§è®¡åˆ’å¯¹æ¯é¡¹ä»»åŠ¡è¿›è¡Œå®¡è®¡ï¼Œåˆ†ææ‰§è¡Œä»»åŠ¡è®¡åˆ’è¡¨å’Œç»è´¹çš„å˜åŒ–æƒ…å†µï¼Œç¡®å®šéœ€è¦è°ƒæ•´ã€å˜åŒ–çš„éƒ¨åˆ†ï¼Œå¹¶æ ¹æ®ä»»åŠ¡å®Œæˆè®¡åˆ’è¡¨å’Œå®¡è®¡ç»“æœï¼ŒæŒæ¡é¡¹ç›®è¿›å±•æƒ…å†µï¼ŒåŠæ—¶å¤„ç†å¼€å‘è¿‡ç¨‹ä¸­å‡ºç°çš„é—®é¢˜ï¼ŒåŠæ—¶ä¿®æ­£å¼€å‘å·¥ä½œä¸­å‡ºç°çš„åå·®ï¼Œä¿è¯ç³»ç»Ÿå¼€å‘å·¥ä½œçš„é¡ºåˆ©è¿›è¡Œã€‚ 43.é¡¹ç›®ç®¡ç†ä¸­ï¼Œä»»åŠ¡å®Œæˆè®¡åˆ’è¡¨éœ€è¦è¡¨æ˜å“ªäº›å†…å®¹ï¼Ÿ è®¡åˆ’åˆ¶å®šå‡ºæ¥åï¼Œå¯ä»¥ç¼–åˆ¶å‡ºä»»åŠ¡å®Œæˆè®¡åˆ’è¡¨ï¼Œè¡¨æ˜ä»»åŠ¡çš„å¼€å§‹æ—¶é—´ã€ç»“æŸæ—¶é—´ï¼Œä»¥åŠä»»åŠ¡ä¹‹é—´çš„ä¾èµ–ç¨‹åº¦ï¼Œä»¥æ­¤ä½œä¸ºè®¡åˆ’å®æ–½ç›‘æ§çš„åŸºç¡€ã€‚ 44.åè¯è§£é‡Šï¼šä»»åŠ¡åˆ’åˆ†ã€‚ ä»»åŠ¡åˆ’åˆ†æ˜¯æŠŠæ•´ä¸ªå¼€å‘å·¥ä½œå®šä¹‰ä¸ºä¸€ç»„ä»»åŠ¡çš„é›†åˆï¼Œè¿™ç»„ä»»åŠ¡åˆå¯ä»¥è¿›ä¸€æ­¥åˆ’åˆ†è‹¥å¹²å­ä»»åŠ¡ï¼Œè¿›è€Œå½¢æˆå…·æœ‰å±‚æ¬¡ç»“æ„çš„ä»»åŠ¡ç¾¤ã€‚ 45.ç®€è¿°ç³»ç»Ÿå¼€å‘è¿‡ç¨‹é¡¹ç›®ç®¡ç†çš„ä¸»è¦å†…å®¹ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘è¿‡ç¨‹é¡¹ç›®ç®¡ç†çš„ä¸»è¦å†…å®¹ï¼Œä¸€èˆ¬åŒ…æ‹¬ä»»åŠ¡åˆ’åˆ†ã€è®¡åˆ’å®‰æ’ã€ç»è´¹ç®¡ç†ã€å®¡è®¡æ§åˆ¶ã€é£å‘ç®¡ç†å’Œè´¨é‡ä¿è¯ç­‰å‡ ä¸ªæ–¹é¢çš„å†…å®¹ã€‚ 46.é£å‘ç®¡ç†çš„å››ä¸ªé˜¶æ®µã€‚ é£é™©ç®¡ç†é€šå¸¸å¯ä»¥åˆ’åˆ†ä¸ºé£é™©è¯†åˆ«ã€é£é™©åˆ†æã€é£é™©ç¼“å’Œå’Œé£é™©è·Ÿè¸ªå››ä¸ªé˜¶æ®µã€‚ é¡¹ç›®ç®¡ç†ç»„çš„ç»„æˆ 1.ä½œä¸ºç³»ç»Ÿå¼€å‘çš„æ ¸å¿ƒäººç‰©ä¹‹ä¸€ã€èµ·ç€ç”¨æˆ·å’Œç³»ç»Ÿå¼€å‘å…¶ä»–äººå‘˜ä¹‹é—´çš„æ¡¥æ¢ä¸æ¥å£ä½œç”¨çš„ç³»ç»Ÿå¼€å‘é¡¹ç›®ç»„æˆå‘˜ï¼ˆBï¼‰ A ç¨‹åºå‘˜ B ç³»ç»Ÿåˆ†æå‘˜ C ç³»ç»Ÿè®¾è®¡é™¢ D ç”¨æˆ·ä»£è¡¨ 2.ä¸‹åˆ—äººå‘˜ä¸­ï¼Œè´Ÿè´£åˆ¶å®šç½‘ç»œé…ç½®æ–¹æ¡ˆçš„ï¼ˆB) A ç³»ç»Ÿåˆ†æå‘˜ B ç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜ C æ•°æ®åº“ç®¡ç†å‘˜ D ç¨‹åºå‘˜ 3.ç³»ç»Ÿå¼€å‘çš„æ ¸å¿ƒäººç‰©æ˜¯ï¼ˆCï¼‰ A é¡¹ç›®ç»„é•¿ B ç”¨æˆ· C ç³»ç»Ÿåˆ†æå‘˜ D ç¨‹åºå‘˜ 4.é¡¹ç›®å°ç»„ä¸­ï¼Œï¼ˆAï¼‰è´Ÿè´£ç³»ç»Ÿçš„æ€»ä½“è®¾è®¡ã€æ¨¡å—è®¾è®¡ä»¥åŠæ¨¡å—ä¹‹é—´çš„æ¥å£è®¾è®¡å·¥ä½œã€‚ A ç³»ç»Ÿè®¾è®¡å‘˜ B æ•°æ®åº“ç®¡ç†å‘˜ C ç³»ç»Ÿåˆ†æå‘˜ D ç¨‹åºå‘˜ 5.é¡¹ç›®ç®¡ç†è¿‡ç¨‹ä¸­ï¼Œï¼ˆAï¼‰è´Ÿè´£ä¾æ®ç³»ç»Ÿé€»è¾‘æ–¹æ¡ˆè¿›è¡Œç³»ç»Ÿçš„ç¨‹åºè®¾è®¡ï¼Œå®ç°æ–¹æ¡ˆä¸­çš„å„é¡¹åŠŸèƒ½ã€‚ A ç¨‹åºå‘˜ B æ•°æ®åº“ç®¡ç†å‘˜ C ç³»ç»Ÿè®¾è®¡å‘˜ D ç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜ 6.åœ¨å¼€å‘ä¸­ï¼Œè¦åšå¥½ï¼ˆCï¼‰çš„åŸ¹è®­å·¥ä½œï¼Œæä¾›ä»–ä»¬çš„å‚ä¸æ„è¯†åŠä½¿ç”¨æ–°ç³»ç»Ÿçš„ç§¯ææ€§ã€‚ A é¡¹ç›®ç»„é•¿ B ç¨‹åºå‘˜ C ç”¨æˆ· D ç³»ç»Ÿåˆ†æå‘˜ 7.åœ¨ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸­ï¼Œä¿¡æ¯ç³»ç»Ÿå»ºè®¾çš„å‚ä¸è€…å’Œæœ€ç»ˆä½¿ç”¨è€…æ˜¯ï¼ˆAï¼‰ A ç”¨æˆ· B é¡¹ç›®ç»„é•¿ C ç¨‹åºå‘˜ D ç³»ç»Ÿåˆ†æå‘˜ 8.é¡¹ç›®å°ç»„ä¸­ï¼Œæ•´ä¸ªé¡¹ç›®çš„é¢†å¯¼æ˜¯ï¼ˆDï¼‰ A ç³»ç»Ÿåˆ†æå‘˜ B ç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜ C ç¨‹åºå‘˜ D é¡¹ç›®ç»„é•¿ 9.é¡¹ç›®å°ç»„çš„ç»„æˆä¸åŒ…æ‹¬ï¼ˆDï¼‰ A ç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜ B æ•°æ®åº“ç®¡ç†å‘˜ C ç³»ç»Ÿè®¾è®¡å‘˜ D ä¸šåŠ¡å‘˜ 10.é¡¹ç›®ç®¡ç†å°ç»„ä¸­ï¼Œè´Ÿè´£ç›‘ç£å’Œæ§åˆ¶æ•°æ®åº“çš„è¿è¡Œä»¥åŠç›¸å…³æ”¹è¿›å·¥ä½œçš„äººæ˜¯ï¼ˆBï¼‰ A ç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜ B æ•°æ®åº“ç®¡ç†å‘˜ C ç³»ç»Ÿè®¾è®¡å‘˜ D ç¨‹åºå‘˜ 11.åœ¨ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸­ï¼Œç”¨æˆ·æ˜¯ä¿¡æ¯ç³»ç»Ÿå»ºè®¾çš„å‚ä¸è€…å’Œæœ€ç»ˆä½¿ç”¨è€…ï¼Œä»–ä»¬æ‡‚å¾—å…·ä½“çš„ç®¡ç†éœ€æ±‚å’Œä¿¡æ¯éœ€æ±‚ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 12.ä¸€ä¸ªæˆåŠŸçš„ç³»ç»Ÿåˆ†æå‘˜å¿…é¡»çœŸæ­£æŠŠäººçš„å› ç´ åŒè®¡ç®—æœºè§£å†³é—®é¢˜ä¸­ç”¨åˆ°çš„æ–¹æ³•å’Œè§„ç¨‹ç»“åˆåœ¨ä¸€èµ·ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 13.é¡¹ç›®å°ç»„ä¸­ï¼Œç¨‹åºå‘˜éœ€è¦è´Ÿè´£è¿›è¡Œç”¨æˆ·çš„ä½¿ç”¨åŸ¹è®­å·¥ä½œã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 14.é¡¹ç›®ç»„é•¿åº”æ˜¯å…·å¤‡ç®¡ç†çŸ¥è¯†çš„ä¸“ä¸šäººæ‰ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 15.é¡¹ç›®ç®¡ç†å°ç»„ä¸­ï¼Œè´Ÿè´£ä¾æ®æ–°ç³»ç»Ÿé€»è¾‘æ–¹æ¡ˆåˆ¶å®šç¡¬ä»¶ç½‘ç»œé…ç½®æ–¹æ¡ˆçš„æ˜¯ç³»ç»Ÿè®¾è®¡å‘˜ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 16.ä¸‹åˆ—é€‰é¡¹ä¸­ï¼Œæ•°æ®é¡¹ç›®å°ç»„æˆå‘˜çš„æ˜¯ï¼ˆABCDEï¼‰ A é¡¹ç›®ç»„é•¿ B ç”¨æˆ· C ç³»ç»Ÿåˆ†æå‘˜ D ç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜ E æ•°æ®åº“ç®¡ç†å‘˜ 17.é¡¹ç›®ç®¡ç†å°ç»„ä¸­ï¼Œç¨‹åºå‘˜è´Ÿè´£ç³»ç»Ÿçš„æµ‹è¯•å’Œè¯•è¿è¡Œå·¥ä½œã€‚ 18.ç®¡ç†å°ç»„ä¸­ï¼Œç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜è´Ÿè´£ä¾æ®æ–°ç³»ç»Ÿé€»è¾‘æ–¹æ¡ˆåˆ¶å®šç¡¬ä»¶ç½‘ç»œé…ç½®æ–¹æ¡ˆã€‚ 19.ç®¡ç†å°ç»„ä¸­ï¼Œæ•°æ®åº“ç®¡ç†å‘˜è´Ÿè´£ç›‘æ§å’Œæ§åˆ¶æ•°æ®åº“çš„è¿è¡Œä»¥åŠç›¸å…³æ”¹è¿›å·¥ä½œã€‚ 20.ç®¡ç†å°ç»„ä¸­ï¼Œç³»ç»Ÿè®¾è®¡å‘˜è´Ÿè´£è¿›è¡Œç³»ç»Ÿçš„æ€»ä½“è®¾è®¡ä»¥åŠæ¨¡å—ä¹‹é—´çš„æ¥å£è®¾è®¡å·¥ä½œã€‚ 21.åœ¨é¡¹ç›®ç®¡ç†å°ç»„ä¸­ï¼Œä¿¡æ¯ç³»ç»Ÿå»ºè®¾çš„å‚ä¸è€…å’Œæœ€ç»ˆä½¿ç”¨è€…æ˜¯ç”¨æˆ·ã€‚ 22.é¡¹ç›®è´Ÿè´£äººä¹Ÿç§°ä¸ºé¡¹ç›®ç»„é•¿ã€‚ 23.ç³»ç»Ÿå¼€å‘å¿…é¡»åœ¨é¡¹ç›®å°ç»„ä¸­å„ç±»äººå‘˜çš„å…±åŒåŠªåŠ›ä¸‹æ‰èƒ½å®Œæˆï¼Œå› æ­¤è¦åšå¥½è¿™äº›å¼€å‘äººå‘˜çš„ç»„ç»‡åè°ƒå·¥ä½œã€‚ 24.åœ¨é¡¹ç›®ç®¡ç†è¿‡ç¨‹ä¸­ï¼Œç¨‹åºå‘˜è´Ÿè´£è¿›è¡Œç”¨æˆ·çš„ä½¿ç”¨åŸ¹è®­å·¥ä½œä»¥åŠç³»ç»Ÿçš„æµ‹è¯•å’Œè¯•è¿è¡Œã€‚ 25.ç³»ç»Ÿå¼€å‘ä¸­ï¼Œç»„ç»‡ä¸åè°ƒå·¥ä½œå¯ä»¥é€šè¿‡ä¸€ä¸ªé¡¹ç›®é¢†å¯¼å°ç»„æ¥å®ç°ã€‚ 26.åœ¨é¡¹ç›®ç®¡ç†è¿‡ç¨‹ä¸­ï¼Œè´Ÿè´£ç³»ç»Ÿçš„ç¨‹åºè®¾è®¡ã€è´Ÿè´£è¿›è¡Œç”¨æˆ·çš„ä½¿ç”¨åŸ¹è®­çš„äººå‘˜æ˜¯ç¨‹åºå‘˜ã€‚ 27.é¡¹ç›®ç®¡ç†è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿè®¾è®¡å‘˜è´Ÿè´£ç³»ç»Ÿçš„æ€»ä½“è®¾è®¡ã€æ¨¡å—è®¾è®¡ä»¥åŠæ¨¡å—ä¹‹é—´æ¥å£çš„è®¾è®¡å·¥ä½œã€‚ 28.ç®¡ç†å°ç»„ä¸­ï¼Œæ•°æ®åº“ç®¡ç†å‘˜è´Ÿè´£ä¾æ®ç³»ç»Ÿé€»è¾‘æ–¹æ¡ˆä¸­æå‡ºçš„æ•°æ®éœ€æ±‚è¿›è¡Œæ•°æ®åº“è®¾è®¡ã€å®šä¹‰å’Œå­˜å‚¨å·¥ä½œã€‚ 29.ç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜è´Ÿè´£åˆ¶å®šç¡¬ä»¶ç½‘ç»œé…ç½®æ–¹æ¡ˆã€‚ 30.ç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜è´Ÿè´£ä¾æ®æ–°ç³»ç»Ÿé€»è¾‘æ–¹æ¡ˆä¸­æå‡ºçš„å¯¹ç¡¬ä»¶ç½‘ç»œçš„åŸºæœ¬è¦æ±‚åˆ¶å®šç¡¬ä»¶ç½‘ç»œé…ç½®æ–¹æ¡ˆã€‚ 31.ç®¡ç†å°ç»„ä¸­ï¼Œæ•°æ®åº“ç®¡ç†å‘˜è´Ÿè´£ä¾æ®ç³»ç»Ÿé€»è¾‘æ–¹æ¡ˆä¸­æå‡ºçš„æ•°æ®éœ€æ±‚è¿›è¡Œæ•°æ®åº“è®¾è®¡ã€å®šä¹‰å’Œå­˜å‚¨å·¥ä½œã€‚ 32.ç³»ç»Ÿåˆ†æå‘˜åœ¨æ€»ä½“è§„åˆ’å’Œç³»ç»Ÿåˆ†æé˜¶æ®µï¼Œéœ€è¦å¤§é‡çš„äººé™…å…³ç³»æ–¹é¢çš„ç»éªŒã€‚ 33.ç³»ç»Ÿå¼€å‘çš„æ ¸å¿ƒäººç‰©æ˜¯ç³»ç»Ÿåˆ†æå‘˜ã€‚ 34.åœ¨ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œè¦åšå¥½å¹¿å¤§ç”¨æˆ·çš„åŸ¹è®­å·¥ä½œï¼Œæé«˜ä»–ä»¬çš„å‚ä¸æ„è¯†åŠä½¿ç”¨æ–°ç³»ç»Ÿçš„ç§¯ææ€§ã€‚ 35.åœ¨ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸­ï¼Œç”¨æˆ·æ—¢è¦è´Ÿè´£åœ°æå‡ºç³»ç»Ÿéœ€æ±‚ï¼Œåˆè¦åŠæ—¶çº æ­£ç³»ç»Ÿå¼€å‘ä¸­çš„åå·®ã€‚ 36.åœ¨ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸­ï¼Œç”¨æˆ·æ‡‚å¾—å…·ä½“çš„ç®¡ç†éœ€æ±‚å’Œä¿¡æ¯éœ€æ±‚ã€‚ 37.é¡¹ç›®ç»„é•¿åœ¨å®æ–½é¡¹ç›®é¢†å¯¼å·¥ä½œæ—¶ï¼Œè¦æ—¶åˆ»æ³¨æ„æ‰€å¼€å‘çš„ç³»ç»Ÿæ˜¯å¦ç¬¦åˆæœ€åˆåˆ¶å®šçš„ç›®æ ‡ã€‚ 38.é¡¹ç›®ç»„é•¿åœ¨å®æ–½é¡¹ç›®é¢†å¯¼å·¥ä½œæ—¶ï¼Œè¦æ—¶åˆ»æ³¨æ„æ‰€å¼€å‘çš„ç³»ç»Ÿæ˜¯å¦ç¬¦åˆæœ€åˆåˆ¶å®šçš„ç›®æ ‡ï¼›åœ¨å¼€å‘å·¥ä½œä¸­æ˜¯å¦è¿ç”¨äº†é¢„å…ˆé€‰æ‹©çš„å¼€å‘æ–¹æ³•ï¼›å“ªäº›äººé€‚åˆåšå“ªäº›å·¥ä½œç­‰ä¸€ç³»åˆ—æ€»ä½“æ€§çš„ç®¡ç†å·¥ä½œã€‚ 39.é¡¹ç›®å°ç»„ä¸­ï¼Œæ•´ä¸ªé¡¹ç›®çš„é¢†å¯¼è€…æ—¶é¡¹ç›®ç»„é•¿ã€‚ 40.é¡¹ç›®ç»„é•¿åº”æ˜¯ä¸€ä¸ªå…·æœ‰ç³»ç»Ÿå¼€å‘å’Œç®¡ç†çŸ¥è¯†çš„å¤åˆå‹äººæ‰ã€‚ 41.é¡¹ç›®å°ç»„çš„ç»„æˆåŒ…æ‹¬ï¼šé¡¹ç›®ç»„é•¿ã€ç”¨æˆ·ã€ç³»ç»Ÿåˆ†æå‘˜ã€ç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜ã€æ•°æ®åº“ç®¡ç†å‘˜ã€ç³»ç»Ÿè®¾è®¡å‘˜å’Œç¨‹åºå‘˜ã€‚ 42.ç³»ç»Ÿåˆ†æå‘˜åœ¨æ€»ä½“è§„åˆ’å’Œç³»ç»Ÿåˆ†æé˜¶æ®µï¼Œéœ€è¦å¤§é‡çš„äººé™…å…³ç³»æ–¹é¢çš„ç»éªŒï¼Œä»¥ä¾¿ä¸ç”¨æˆ·ä¸€èµ·å·¥ä½œï¼Œç¡®å®šéœ€æ±‚å’ŒæŠŠè¿™äº›éœ€æ±‚è½¬å˜ä¸ºé€»è¾‘æ–¹æ¡ˆã€‚ 43.é¡¹ç›®ç»„é•¿åœ¨å®æ–½é¡¹ç›®é¢†å¯¼å·¥ä½œæ—¶ï¼Œéœ€è€ƒè™‘å¼€å‘å·¥ä½œæ˜¯å¦è¿ç”¨äº†é¢„å…ˆé€‰æ‹©çš„å¼€å‘æ–¹æ³•ã€‚ 44.é¡¹ç›®ç»„é•¿åº”æ˜¯ä¸€ä¸ªå…·æœ‰ç³»ç»Ÿå¼€å‘å’Œç®¡ç†çŸ¥è¯†çš„å¤åˆå‹äººæ‰ã€‚ 45.é¡¹ç›®å°ç»„çš„ç»„æˆä¸»è¦åŒ…æ‹¬ï¼šé¡¹ç›®ç»„é•¿ã€ç”¨æˆ·ã€ç³»ç»Ÿåˆ†æå‘˜ã€ç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜ã€æ•°æ®åº“ç®¡ç†å‘˜ã€ç³»ç»Ÿè®¾è®¡å‘˜å’Œç¨‹åºå‘˜ã€‚ 46.åœ¨ä¿¡æ¯ç³»ç»Ÿå¼€å‘è¿‡ç¨‹ä¸­ï¼Œé¡¹ç›®ç®¡ç†ç»„çš„ç»„æˆæˆå‘˜å’Œç»„ç»‡å½¢å¼ä¸€èˆ¬æ¥è¯´å¯ä»¥æ ¹æ®é¡¹ç›®ç»è´¹çš„å¤šå°‘å’Œç³»ç»Ÿçš„å¤§å°æ¥ç¡®å®šã€‚ 47.é¡¹ç›®å°ç»„ç»„æˆä¸»è¦åŒ…æ‹¬ï¼šé¡¹ç›®ç»„é•¿ã€ç”¨æˆ·ã€ç³»ç»Ÿåˆ†æå‘˜ã€ç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜ã€æ•°æ®åº“ç®¡ç†å‘˜ã€ç³»ç»Ÿè®¾è®¡å‘˜å’Œç¨‹åºå‘˜ã€‚ 48.åœ¨ç³»ç»Ÿå¼€å‘ä¸­ï¼Œç³»ç»Ÿåˆ†æå‘˜è‡ªèº«éœ€è¦å…·å¤‡å“ªäº›æ¡ä»¶ï¼Ÿ ç³»ç»Ÿåˆ†æå‘˜å¿…é¡»å…·å¤‡ç›¸å¯¹å¹¿åšçš„çŸ¥è¯†ï¼Œæ—¢è¦æ‡‚å¾—è®¡ç®—æœºçŸ¥è¯†ï¼Œåˆè¦å…·å¤‡ç®¡ç†çŸ¥è¯†å’Œç®¡ç†æ‰å¹²ã€‚ç³»ç»Ÿåˆ†æå‘˜åœ¨ç³»ç»Ÿå¼€å‘ä¸­æ‹…ä»»ç€é‡è¦çš„è§’è‰²ï¼Œå…¶å·¥ä½œçš„å¥½åç›´æ¥å½±å“ç³»ç»Ÿå¼€å‘çš„è´¨é‡ã€‚ 49.é¡¹ç›®ç»„é•¿çš„ä»»åŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ é¡¹ç›®ç»„é•¿çš„ä»»åŠ¡æ˜¯ä¿è¯æ•´ä¸ªå¼€å‘é¡¹ç›®çš„é¡ºåˆ©è¿›è¡Œï¼Œè´Ÿè´£åè°ƒå¼€å‘äººå‘˜ä¹‹é—´ã€ç”¨æˆ·ä¹‹é—´ã€å¼€å‘äººå‘˜å’Œç”¨æˆ·ä¹‹é—´çš„å…³ç³»ï¼ŒåŒæ—¶æ‹¥æœ‰èµ„é‡‘çš„æ”¯é…æƒï¼Œå¯ä»¥æŠŠèµ„é‡‘ä½œä¸ºå¼ºæœ‰åŠ›çš„å·¥å…·æ¥è¿›è¡Œé¡¹ç›®ç®¡ç†ã€‚ 50.é¡¹ç›®ç»„é•¿åœ¨å®æ–½é¡¹ç›®é¢†å¯¼å·¥ä½œæ—¶è¦æ³¨æ„å“ªäº›æ–¹é¢ï¼Ÿ é¡¹ç›®ç»„é•¿åœ¨å®æ–½é¡¹ç›®é¢†å¯¼å·¥ä½œæ—¶ï¼Œè¦æ—¶åˆ»æ³¨æ„æ‰€å¼€å‘çš„ç³»ç»Ÿæ˜¯å¦ç¬¦åˆæœ€åˆåˆ¶å®šçš„ç›®æ ‡ï¼›åœ¨å¼€å‘å·¥ä½œä¸­æ˜¯å¦è¿ç”¨äº†é¢„å…ˆé€‰æ‹©çš„å¼€å‘æ–¹æ³•ï¼›å“ªäº›äººé€‚åˆå“ªäº›å·¥ä½œç­‰ä¸€ç³»åˆ—æ€»ä½“æ€§çš„ç®¡ç†å·¥ä½œã€‚ 51.ç®€è¿°MISå¼€å‘é¡¹ç›®å°ç»„çš„ç»„æˆã€‚ é¡¹ç›®å°ç»„çš„ç»„æˆä¸»è¦åŒ…æ‹¬ä»¥ä¸‹æ–¹é¢ï¼šé¡¹ç›®ç»„é•¿ã€ç³»ç»Ÿåˆ†æå‘˜ã€ç¡¬ä»¶ç½‘ç»œè®¾è®¡å‘˜ã€æ•°æ®åº“ç®¡ç†å‘˜ã€ç³»ç»Ÿè®¾è®¡å‘˜ã€ç¨‹åºå‘˜ã€‚ æ–‡æ¡£çš„ç®¡ç† 1.ç³»ç»Ÿå¼€å‘å»ºè®¾è¿‡ç¨‹ä¸€æ—¦éœ€è¦å¯¹æŸä¸ªæ–‡ä»¶è¿›è¡Œä¿®æ”¹æ—¶ï¼Œè¦åŠæ—¶ã€å‡†ç¡®åœ°ä¿®æ”¹ä¸ä¹‹ç›¸å…³è”çš„æ–‡æ¡£ï¼ŒæŒ‡çš„æ˜¯ï¼ˆBï¼‰ A æ–‡æ¡£è¦æ ‡å‡†åŒ–å’Œè§„èŒƒåŒ– B ç»´æŠ¤æ–‡æ¡£çš„ä¸€è‡´æ€§ C ç»´æŠ¤æ–‡æ¡£çš„å¯è¿½è¸ªæ€§ D æ–‡æ¡£ç®¡ç†çš„åˆ¶åº¦åŒ– 2.(B)æ˜¯ç³»ç»Ÿå¼€å‘å»ºè®¾çš„ç”Ÿå‘½çº¿ A ç”¨æˆ· B æ–‡æ¡£ C ç³»ç»Ÿè½¯ä»¶ D ç½‘ç»œ 3.æ–‡æ¡£ç®¡ç†åº”éµå¾ªçš„ä¸€ä¸ªé‡è¦åŸåˆ™æ˜¯ï¼ˆAï¼‰ A æ–‡æ¡£æ ‡å‡†åŒ– B æ–‡æ¡£å®ç”¨åŒ– C æ–‡æ¡£ç®€åŒ– D æ–‡æ¡£ä¼˜åŒ– 4.æ–‡æ¡£çš„ç®¡ç†éµå¾ªçš„åŸåˆ™ï¼Œä¸åŒ…æ‹¬ï¼ˆDï¼‰ A æ–‡æ¡£è¦æ ‡å‡†åŒ– B ç»´æŠ¤æ–‡æ¡£çš„ä¸€è‡´æ€§ C ç»´æŠ¤æ–‡æ¡£çš„å¯è¿½è¸ªæ€§ D ç»´æŠ¤æ–‡æ¡£çš„å…±äº«æ€§ 5.åœ¨ç³»ç»Ÿå¼€å‘å‰å¿…é¡»é¦–å…ˆé€‰æ‹©æˆ–åˆ¶å®šæ–‡æ¡£æ ‡å‡†ï¼Œä½“ç°çš„åŸåˆ™æ˜¯ï¼ˆAï¼‰ A æ–‡æ¡£è¦æ ‡å‡†åŒ–å’Œè§„èŒƒåŒ– B ç»´æŠ¤æ–‡æ¡£çš„ä¸€è‡´æ€§ C ç»´æŠ¤æ–‡æ¡£çš„å¯è¿½è¸ªæ€§ D æ–‡æ¡£ç®¡ç†åˆ¶åº¦åŒ– 6.ç³»ç»Ÿå¼€å‘å»ºè®¾è¿‡ç¨‹æ˜¯ä¸€ä¸ªæ¯”è¾ƒç¨³å®šçš„é™æ€è¿‡ç¨‹ã€‚ï¼ˆBï¼‰ A æ­£ç¡® B é”™è¯¯ 7.æ–‡æ¡£è¦æ ‡å‡†åŒ–å’Œè§„èŒƒåŒ–æ˜¯æ–‡æ¡£ç®¡ç†åº”éµå¾ªçš„ä¸€ä¸ªåŸåˆ™ï¼ŒæŒ‡çš„æ˜¯ï¼šåœ¨ç³»ç»Ÿå¼€å‘å‰å¿…é¡»é¦–å…ˆé€‰æ‹©æˆ–åˆ¶å®šæ–‡æ¡£æ ‡å‡†ï¼Œåœ¨ç»Ÿä¸€æ ‡å‡†çš„åˆ¶çº¦ä¸‹ï¼Œå¼€å‘äººå‘˜è´Ÿè´£å»ºç«‹æ‰€å»ºç«‹æ‰¿æ‹…ä»»åŠ¡çš„æ–‡æ¡£èµ„æ–™ã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 8.æ²¡æœ‰è‰¯å¥½çš„ç”¨æˆ·éœ€æ±‚æ–‡æ¡£ï¼Œç³»ç»Ÿåˆ†æå’Œè®¾è®¡å°±å¤±å»äº†å¯é çš„ä¾æ®ï¼Œå¼€å‘è¿‡ç¨‹ä¹Ÿå°±ä¸å¯èƒ½ä»¥æœ‰æ¬¡åºã€å¯ç®¡ç†çš„æ–¹å¼è¿›è¡Œã€‚ï¼ˆAï¼‰ A æ­£ç¡® B é”™è¯¯ 9.ç³»ç»Ÿå¼€å‘å»ºè®¾è¿‡ç¨‹ä¸€æ—¦éœ€è¦å¯¹æŸä¸ªæ–‡æ¡£è¿›è¡Œä¿®æ”¹æ—¶ï¼Œè¦åŠæ—¶ã€å‡†ç¡®åœ°ä¿®æ”¹ä¸ä¹‹ç›¸å…³è”çš„æ–‡æ¡£ï¼Œè€Œè¿™ä¸€è¿‡ç¨‹åˆå¿…é¡»æœ‰ç›¸åº”çš„åˆ¶åº¦æ¥ä¿è¯ã€‚ 10.åœ¨ç³»ç»Ÿå¼€å‘å‰å¿…é¡»é¦–å…ˆé€‰æ‹©æˆ–åˆ¶å®šæ–‡æ¡£æ ‡å‡†ï¼Œåœ¨ç»Ÿä¸€æ ‡å‡†çš„åˆ¶çº¦ä¸‹ï¼Œå¼€å‘äººå‘˜è´Ÿè´£å»ºç«‹æ‰€æ‰¿æ‹…ä»»åŠ¡çš„æ–‡æ¡£èµ„æ–™ã€‚ 11.æ–‡æ¡£ç®¡ç†åº”éµå¾ªçš„ä¸€ä¸ªåŸåˆ™æ˜¯æ–‡æ¡£è¦æ ‡å‡†åŒ–å’Œè§„èŒƒåŒ–ï¼ŒæŒ‡çš„æ˜¯ï¼šåœ¨ç³»ç»Ÿå¼€å‘å‰å¿…é¡»é¦–å…ˆé€‰æ‹©æˆ–åˆ¶å®šæ–‡æ¡£æ ‡å‡†ï¼Œåœ¨ç»Ÿä¸€æ ‡å‡†çš„åˆ¶çº¦ä¸‹ï¼Œå¼€å‘äººå‘˜è´Ÿè´£å»ºç«‹æ‰€æ‰¿æ‹…ä»»åŠ¡çš„æ–‡æ¡£èµ„æ–™ã€‚ 12.ç»´æŠ¤æ–‡æ¡£çš„ä¸€è‡´æ€§æ˜¯æ–‡æ¡£ç®¡ç†åº”éµå¾ªçš„ä¸€æ¡åŸåˆ™ã€‚ 13.ç³»ç»Ÿå¼€å‘å»ºè®¾è¿‡ç¨‹æ˜¯ä¸€ä¸ªä¸æ–­å˜åŒ–çš„åŠ¨æ€è¿‡ç¨‹ï¼Œä¸€æ—¦éœ€è¦å¯¹æŸä¸ªæ–‡æ¡£è¿›è¡Œä¿®æ”¹æ—¶ï¼Œè¦åŠæ—¶ã€å‡†ç¡®åœ°ä¿®æ”¹ä¸ä¹‹ç›¸å…³è”çš„æ–‡æ¡£ã€‚ 14.ç³»ç»Ÿå¼€å‘å»ºè®¾çš„ç”Ÿå‘½çº¿æ—¶æ–‡æ¡£ã€‚ 15.æ²¡æœ‰è‰¯å¥½çš„ç”¨æˆ·éœ€æ±‚æ–‡æ¡£ï¼Œç³»ç»Ÿåˆ†æå’Œè®¾è®¡å°±å¤±å»äº†å¯é çš„ä¾æ®ã€‚ 16.æ²¡æœ‰è‰¯å¥½çš„ç”¨æˆ·éœ€æ±‚æ–‡æ¡£ï¼Œç³»ç»Ÿåˆ†æå’Œè®¾è®¡å°±å¤±å»äº†å¯é çš„ä¾æ®ï¼Œå¼€å‘è¿‡ç¨‹ä¹Ÿå°±ä¸å¯èƒ½ä»¥æœ‰æ¬¡åºã€å¯ç®¡ç†çš„æ–¹å¼è¿›è¡Œï¼Œä»è€Œé€ æˆä¸¥é‡çš„ä½æ•ˆç‡ç”šè‡³å¤±è´¥ï¼ŒåŒæ—¶ä¹Ÿä¼šç»™ç³»ç»Ÿçš„è¿è¡Œå’Œç»´æŠ¤å·¥ä½œå¸¦æ¥å›°éš¾ï¼Œé™ä½ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸã€‚ 17.æ–‡æ¡£è¦æ ‡å‡†åŒ–å’Œè§„èŒƒåŒ–æ—¶æ–‡æ¡£ç®¡ç†åº”éµå¾ªçš„ä¸€ä¸ªåŸåˆ™ã€‚ 18.ç®€è¿°åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå»ºè®¾çš„å„ä¸ªé˜¶æ®µéƒ½éœ€è¦æœ‰ç›¸åº”æ–‡æ¡£èµ„æ–™çš„æ„ä¹‰ã€‚ æ–‡æ¡£æ˜¯ç³»ç»Ÿå¼€å‘å»ºè®¾çš„ç”Ÿå‘½çº¿ï¼Œå®ƒè´¯ç©¿äºç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„çœŸä¸ªè¿‡ç¨‹ï¼Œç³»ç»Ÿå¼€å‘çš„å„ä¸ªå±‚æ¬¡å’Œé˜¶æ®µéƒ½è¦æœ‰ç›¸åº”çš„æ–‡æ¡£ã€‚æ²¡æœ‰è‰¯å¥½çš„ç”¨æˆ·éœ€æ±‚æ–‡æ¡£ï¼Œç³»ç»Ÿåˆ†æå’Œè®¾è®¡å°±å¤±å»äº†å¯é çš„ä¾æ®ï¼Œå¼€å‘è¿‡ç¨‹ä¹Ÿå°±ä¸å¯èƒ½ä»¥æœ‰æ¬¡åºã€å¯ç®¡ç†çš„æ–¹å¼è¿›è¡Œï¼Œä»è€Œé€ æˆä¸¥é‡çš„ä½æ•ˆç‡ç”šè‡³å¤±è´¥ï¼ŒåŒæ—¶ä¹Ÿä¼šç»™ç³»ç»Ÿçš„è¿è¡Œå’Œç»´æŠ¤å·¥ä½œå¸¦æ¥å›°éš¾ï¼Œé™ä½äº†ç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸã€‚å› æ­¤åœ¨ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå»ºè®¾çš„å„ä¸ªé˜¶æ®µéƒ½éœ€è¦æœ‰ç›¸åº”çš„æ–‡æ¡£èµ„æ–™ã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬å››ç« _æ€»ä½“è§„åˆ’/ç¬¬ä¸€èŠ‚_æ€»ä½“è§„åˆ’çš„ç›®çš„å’Œæ­¥éª¤.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬å››ç« _æ€»ä½“è§„åˆ’/ç¬¬ä¸€èŠ‚_æ€»ä½“è§„åˆ’çš„ç›®çš„å’Œæ­¥éª¤.html","title":"ç¬¬ä¸€èŠ‚ï¼šæ€»ä½“è§„åˆ’çš„ç›®çš„å’Œæ­¥éª¤","keywords":"","body":"ç¬¬ä¸€èŠ‚ï¼šæ€»ä½“è§„åˆ’çš„ç›®çš„å’Œæ­¥éª¤ æ€»ä½“è§„åˆ’çš„ç›®çš„ 1.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ€»ä½“è§„åˆ’çš„ç›®çš„æ˜¯è¦æ˜ç¡®ç³»ç»Ÿï¼ˆAï¼‰ A æ˜¯ä»€ä¹ˆ B åšä»€ä¹ˆ C æ€ä¹ˆåš D è°æ¥åš 2.æ€»ä½“è§„åˆ’çš„ç›®çš„ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A åè°ƒå­ç³»ç»Ÿé—´çš„å·¥ä½œ B ä¿è¯ä¿¡æ¯å…±äº« C ä½¿å¼€å‘å·¥ä½œæœ‰åºè¿›è¡Œ D æ˜ç¡®ç³»ç»Ÿå®ç°æ‰€éœ€è½¯ç¡¬ä»¶ 3.æ€»ä½“è§„åˆ’çš„ç›®çš„ä¸åŒ…æ‹¬ï¼ˆAï¼‰ A ä¿è¯ä¿¡æ¯çš„å‡†ç¡® B ä¿è¯ä¿¡æ¯å…±äº« C åè°ƒå­ç³»ç»Ÿé—´çš„å·¥ä½œ D æ˜¯å¼€å‘å·¥ä½œæœ‰åºè¿›è¡Œ 4.ä¸‹è¿°ä¸å±äºç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ€»ä½“è§„åˆ’ç›®çš„æ˜¯ï¼ˆAï¼‰ A ç¡®å®šå…·ä½“éœ€æ±‚ B ä¿è¯ä¿¡æ¯å…±äº« C åè°ƒå­ç³»ç»Ÿé—´çš„å·¥ä½œ D ä½¿å¼€å‘å·¥ä½œæœ‰åºè¿›è¡Œ 5.æ˜ç¡®æœªæ¥ç³»ç»Ÿâ€œæ˜¯ä»€ä¹ˆâ€œæ˜¯ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ€»ä½“è§„åˆ’çš„ç›®çš„ã€‚ 6.ç®€è¿°ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ€»ä½“è§„åˆ’çš„ç›®çš„ã€‚ ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ€»ä½“è§„åˆ’çš„ç›®çš„æ˜¯æ˜ç¡®ç³»ç»Ÿâ€œæ˜¯ä»€ä¹ˆâ€çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œé¡¶å±‚è®¾è®¡ï¼Œæç»˜ä¿¡æ¯ç³»ç»Ÿæ¶æ„ï¼Œå¹¶å¯¹ç›®æ ‡ç³»ç»Ÿæå‡ºå®Œæ•´ã€å‡†ç¡®ã€æ¸…æ™°ã€å…·ä½“çš„è¦æ±‚ã€‚ä¿è¯ä¿¡æ¯å…±äº«ã€åè°ƒå­ç³»ç»Ÿé—´çš„å·¥ä½œï¼Œä½¿å¼€å‘æœ‰åºè¿›è¡Œã€‚ æ€»ä½“è§„åˆ’çš„ä¸»è¦æ­¥éª¤ 1.æ€»ä½“è§„åˆ’çš„å†…å®¹ä¸­ä¸åº”åŒ…æ‹¬ï¼ˆCï¼‰ A æ–°ç³»ç»Ÿçš„ç›®æ ‡ B æ–°ç³»ç»Ÿçš„å­ç³»ç»Ÿåˆ’åˆ† C æ–°ç³»ç»Ÿçš„æŠ€æœ¯è®¾è®¡ D æ–°ç³»ç»Ÿçš„æŠ•èµ„æ–¹æ¡ˆ 2.æ€»ä½“è§„åˆ’ä¸­çš„éœ€æ±‚åˆæ­¥è°ƒæŸ¥å†…å®¹è‡³å°‘åŒ…æ‹¬ï¼ˆDï¼‰ A æ–°ç³»ç»Ÿçš„æŠ€æœ¯æ–¹æ¡ˆ B æ–°ç³»ç»Ÿçš„è¿è¡Œç®¡ç†æ–¹æ¡ˆ C æ–°ç³»ç»Ÿçš„äººå‘˜åŸ¹è®­è®¡åˆ’ D æ–°ç³»ç»Ÿçš„å¼€å‘æ¡ä»¶ 3.æ€»ä½“è§„åˆ’ä¸­ï¼Œæ–°ç³»ç»Ÿç›®æ ‡å…·å¤‡çš„é‡è¦ç‰¹æ€§ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A ç›®æ ‡çš„å¤šé‡æ€§ B ç›®æ ‡çš„ä¾é™„æ€§ C ç›®æ ‡çš„é€‚åº”æ€§ D ç›®æ ‡çš„çŸ­æœŸæ€§ 4.ä¼°ç®—æ–°ç³»ç»Ÿå¼€å‘è´¹ç”¨ä»¥åŠæ–°ç³»ç»Ÿçš„æ•ˆç›Šä½“ç°äº†å¯è¡Œæ€§åˆ†æä¸­çš„ï¼ˆAï¼‰ A ç»æµå¯è¡Œæ€§ B ç®¡ç†å¯è¡Œæ€§ C å¼€å‘ç¯å¢ƒå¯è¡Œæ€§ D æŠ€æœ¯å¯è¡Œæ€§ 5.å¯è¡Œæ€§åˆ†ææŠ¥å‘Šä¸­ï¼Œé¡¹ç›®æ‘˜è¦å±äºï¼ˆCï¼‰ A ç°è¡Œç³»ç»Ÿè°ƒæŸ¥ä¸åˆ†æ B æ­éœ² C å¼•è¨€ D å¯è¡Œæ€§è®ºè¯ 6.æ¦‚æ‹¬åœ°é˜è¿°å¯è¡Œè¿˜æ˜¯ä¸å¯è¡ŒæŒ‡çš„æ˜¯å¯è¡Œæ€§åˆ†ææŠ¥å‘Šä¸­çš„ï¼ˆAï¼‰ A ç»“è®º B å¼•è¨€ C æ–°ç³»ç»Ÿå‡è®¾æ–¹æ¡ˆ D å¯è¡Œæ€§è®ºè¯ 7.æŠ€æœ¯å¯è¡Œæ€§çš„é‡ç‚¹ä¹‹ä¸€æ˜¯ï¼ˆCï¼‰ A é¢†å¯¼äººå‘˜çš„æ–‡åŒ–ç´ è´¨ä¸æŠ€æœ¯æ°´å¹³ B ç®¡ç†äººå‘˜çš„æ–‡åŒ–ç´ è´¨ä¸æŠ€æœ¯æ°´å¹³ C ä¸šåŠ¡äººå‘˜çš„æ–‡åŒ–ç´ è´¨ä¸æŠ€æœ¯æ°´å¹³ D è´¢åŠ¡äººå‘˜çš„æ–‡åŒ–ç´ è´¨ä¸æŠ€æœ¯æ°´å¹³ 8.ä¼ä¸šèƒ½å¦æŠ½è°ƒå¿…è¦çš„éª¨å¹²åŠ›é‡å‚åŠ ç³»ç»Ÿå¼€å‘ï¼Œåœ¨å¯è¡Œæ€§åˆ†æä¸­å±äºï¼ˆDï¼‰ A æŠ€æœ¯å¯è¡Œæ€§ B ç»æµå¯è¡Œæ€§ C ç®¡ç†å¯è¡Œæ€§ D å¼€å‘ç¯å¢ƒå¯è¡Œæ€§ 9.å½“å‰ç®¡ç†ä½“åˆ¶ä¸‹ä¼ä¸šæ˜¯å¦æä¾›æ–°ç³»ç»Ÿå¼€å‘å¿…é¡»çš„åŸºç¡€æ•°æ®ï¼Œåœ¨å¯è¡Œæ€§åˆ†æä¸­æ•°æ®ï¼ˆCï¼‰ A æŠ€æœ¯å¯è¡Œæ€§ B ç»æµå¯è¡Œæ€§ C ç®¡ç†å¯è¡Œæ€§ D å¼€å‘ç¯å¢ƒå¯è¡Œæ€§ 10.ç»æµå¯è¡Œæ€§åˆ†æçš„é‡ç‚¹æ˜¯æ–°ç³»ç»Ÿçš„ï¼ˆDï¼‰ A ç›´æ¥æ•ˆç›Šä¸é—´æ¥æ•ˆç›Š B ç®¡ç†æ•ˆç›Šä¸ç»æµæ•ˆç›Š C å¼€å‘è´¹ç”¨ä¸è¿è¡Œè´¹ç”¨ D å¼€å‘è¿è¡Œè´¹ç”¨ä¸æ•ˆç›Š 11.æ€»ä½“è§„åˆ’ä¸­ï¼Œéœ€æ±‚åˆæ­¥è°ƒæŸ¥çš„ä¸‹ä¸€ä¸ªæ­¥éª¤æ˜¯ï¼ˆAï¼‰ A ç¡®å®šç³»ç»Ÿå»ºè®¾ç›®æ ‡ B ç¼–åˆ¶å¯è¡Œæ€§åˆ†ææŠ¥å‘Š C å¯è¡Œæ€§åˆ†æ D ç¡®å®šå­ç³»ç»ŸåŸºæœ¬åŠŸèƒ½ 12.æ€»ä½“è§„åˆ’ä¸­ä¸¤ä¸ªç›¸äº’è¡”æ¥çš„æ­¥éª¤æ˜¯å¯è¡Œæ€§åˆ†æå’Œï¼ˆDï¼‰ A éœ€æ±‚åˆæ­¥è°ƒæŸ¥ B ç¡®å®šç³»ç»Ÿå»ºè®¾ç›®æ ‡ C ç¡®å®šå­ç³»ç»ŸåŸºæœ¬åŠŸèƒ½ D ç¼–åˆ¶å¯è¡Œæ€§åˆ†ææŠ¥å‘Š 13.ä¼ä¸šæœ€æå±‚é¢†å¯¼è€ƒè™‘æ›¿ä»£ç°æœ‰ç³»ç»Ÿçš„éœ€æ±‚æ˜¯å¦è¿«åˆ‡ä½“ç°äº†ï¼ˆCï¼‰ A å¼€å‘ç¯å¢ƒå¯è¡Œæ€§ B æŠ€æœ¯å¯è¡Œæ€§ C ç®¡ç†å¯è¡Œæ€§ D ç»æµå¯è¡Œæ€§ 14.åœ¨æ€»ä½“è§„åˆ’ä¸­ï¼Œä¸‹è¿°ä¸å±äºéœ€æ±‚åˆæ­¥è°ƒæŸ¥çš„æ˜¯ï¼ˆDï¼‰ A ç°è¡Œç³»ç»Ÿçš„ç›®æ ‡å’Œä»»åŠ¡ B ç°è¡Œç³»ç»Ÿçš„ç¯å¢ƒå’Œçº¦æŸæ¡ä»¶ C ç°è¡Œç³»ç»Ÿçš„ä¸šåŠ¡æµç¨‹ D ä¸šåŠ¡å’Œæ•°æ®çš„å…·ä½“åŒ–æƒ…å†µ 15.å¯è¡Œæ€§åˆ†ææŠ¥å‘Šçš„å†…å®¹ä¸åŒ…æ‹¬ï¼ˆAï¼‰ A æ—§çš„å‚è€ƒæ–¹æ¡ˆ B å¯è¡Œæ€§è®ºè¯ C æ–°ç³»ç»Ÿå»ºè®¾æ–¹æ¡ˆ D ç°è¡Œç³»ç»Ÿè°ƒæŸ¥ä¸åˆ†æ 16.ä¼ä¸šèƒ½å¦æŠ½è°ƒå¿…è¦çš„éª¨å¹²åŠ›é‡å‚åŠ ç³»ç»Ÿå¼€å‘ï¼Œåœ¨å¯è¡Œæ€§åˆ†æä¸­å±äºå¼€å‘ç¯å¢ƒçš„å¯è¡Œæ€§ã€‚ 17.ç»æµå¯è¡Œæ€§åˆ†æçš„é‡ç‚¹æ˜¯æ–°ç³»ç»Ÿçš„å¼€å‘è¿è¡Œè´¹ç”¨ä¸æ•ˆç›Šã€‚ 18.MISæ€»ä½“è§„åˆ’çš„æ­¥éª¤ä¸€çº¿åé¡ºåºåŒ…æ‹¬éœ€æ±‚åˆæ­¥è°ƒæŸ¥ã€ç¡®å®šç³»ç»Ÿå»ºè®¾ç›®æ ‡ã€åˆæ­¥ç¡®å®šå­ç³»ç»Ÿç»„æˆä¸åŸºæœ¬åŠŸèƒ½ç­‰ç­‰ã€‚ 19.ç³»ç»Ÿå¼€å‘è¿‡ç¨‹çš„ç¬¬ä¸€ä¸ªæ­£å¼æ–‡æ¡£æ˜¯å¯è¡Œæ€§åˆ†ææŠ¥å‘Šã€‚ 20.å½“å‰ç®¡ç†ä½“åˆ¶ä¸‹ä¼ä¸šæ˜¯å¦èƒ½æä¾›æ–°ç³»ç»Ÿå¼€å‘å¿…é¡»çš„åŸºç¡€æ•°æ®ï¼Œåœ¨å¯è¡Œæ€§åˆ†æä¸­å±äºç®¡ç†çš„å¯è¡Œæ€§ã€‚ 21.å¯è¡Œæ€§ä¸­çš„å¯èƒ½æ€§æ˜¯æŒ‡ç³»ç»Ÿå¼€å‘çš„æ¡ä»¶æ˜¯å¦å…·å¤‡ï¼Œå¿…è¦æ€§æ˜¯æŒ‡æ˜¯å¦éœ€è¦å¼€å‘æ–°ç³»ç»Ÿã€‚ 22.å¯è¡Œæ€§åˆ†æä¸»è¦è®ºè¯ç³»ç»Ÿå¼€å‘çš„æŠ€æœ¯å¯è¡Œæ€§ã€ç»æµå¯è¡Œæ€§ã€ç®¡ç†å¯è¡Œæ€§å’Œå¼€å‘ç¯å¢ƒå¯è¡Œæ€§ã€‚ 23.å¯è¡Œæ€§åˆ†æä¸­çš„å¯è¡Œæ€§é€šå¸¸åŒ…æ‹¬å¯èƒ½æ€§ä¸å¿…è¦æ€§ä¸¤ä¸ªæ–¹é¢ã€‚ 24.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„å¯è¡Œæ€§ç ”ç©¶é€šå¸¸åŒ…æ‹¬æŠ€æœ¯ä¸Šçš„å¯è¡Œæ€§ã€ç»æµä¸Šçš„å¯è¡Œæ€§ã€ç®¡ç†ä¸Šçš„å¯è¡Œæ€§å’Œå¼€å‘ç¯å¢ƒçš„å¯è¡Œæ€§ã€‚ 25.å¯è¡Œæ€§åˆ†æåŒ…æ‹¬æŠ€æœ¯ä¸Šçš„å¯è¡Œæ€§ã€ç»æµä¸Šçš„å¯è¡Œæ€§ã€ç®¡ç†ä¸Šçš„å¯è¡Œæ€§å’Œå¼€å‘ç¯å¢ƒçš„å¯è¡Œæ€§ç­‰4ä¸ªæ–¹é¢ã€‚ 26.ä¿¡æ¯ç³»ç»Ÿå¼€å‘çš„å¯è¡Œæ€§åˆ†æä¸€èˆ¬åŒ…æ‹¬æŠ€æœ¯å¯è¡Œæ€§åˆ†æã€ç»æµå¯è¡Œæ€§åˆ†æã€å¼€å‘ç¯å¢ƒå¯è¡Œæ€§åˆ†æå’Œç®¡ç†å¯è¡Œæ€§åˆ†æã€‚ 27.æ˜ç¡®æ–°ç³»ç»Ÿçš„å¼€å‘æ¡ä»¶æ˜¯æ€»ä½“è§„åˆ’ä¸­éœ€æ±‚åˆæ­¥è°ƒæŸ¥è¿™ä¸€æ­¥éª¤çš„å†…å®¹ä¹‹ä¸€ã€‚ 28.å¯è¡Œæ€§åˆ†æä¸­çš„å¯è¡Œæ€§é€šå¸¸åŒ…æ‹¬å¯èƒ½æ€§ä¸å¿…è¦æ€§ä¸¤ä¸ªæ–¹é¢ã€‚ 29.ç®€è¿°ä¿¡æ¯ç³»ç»Ÿæ€»ä½“è§„åˆ’ä¸­å¯è¡Œæ€§åˆ†æçš„å››ä¸ªæ–¹é¢çš„å†…å®¹ã€‚ å¯è¡Œæ€§åˆ†æä¸»è¦å†…å®¹ï¼š1.æŠ€æœ¯ä¸Šçš„å¯è¡Œæ€§ã€‚æ ¹æ®æ–°ç³»ç»Ÿçš„ç›®æ ‡æ¥è€ƒè™‘ç³»ç»Ÿçš„è½¯ç¡¬ä»¶è®¾å¤‡ã€è®¡ç®—æœºè”ç½‘èƒ½åŠ›ã€ç½‘ç»œåŠæ•°æ®å®‰å…¨ä¿æŠ¤æªæ–½ã€è¾“å…¥è¾“å‡ºè®¾å¤‡ã€å¤§å®¹é‡å­˜å‚¨è®¾å¤‡ï¼›2.ç»æµä¸Šçš„å¯èƒ½æ€§ã€‚ä¼°ç®—æ–°ç³»ç»Ÿå¼€å‘å’Œè¿è¡Œæ‰€éœ€çš„è´¹ç”¨ï¼Œä»¥åŠæ–°ç³»ç»Ÿçš„æ•ˆç›Šï¼›3.ç®¡ç†ä¸Šçš„å¯è¡Œæ€§ã€‚ä¸»è¦è€ƒè™‘ç®¡ç†ä½“åˆ¶æ˜¯å¦å¯ä»¥æä¾›æ‰€å¿…é¡»æ•°æ®ï¼Œéœ€æ±‚æ˜¯å¦è¿«åˆ‡ï¼Œä»¥åŠä¸šåŠ¡äººå‘˜å¯¹æ–°ç³»ç»Ÿçš„é€‚åº”èƒ½åŠ›ï¼›4.å¼€å‘ç¯å¢ƒçš„å¯è¡Œæ€§ã€‚è€ƒè™‘ä¼ä¸šèƒ½å¦ä¸ºæ–°ç³»ç»Ÿå¼€å‘å»ºè®¾æä¾›é•¿æœŸã€è‰¯å¥½çš„ç¯å¢ƒã€‚ 30.åè¯è§£é‡Šï¼šç»æµå¯è¡Œæ€§ã€‚ ç»æµå¯è¡Œæ€§æ˜¯å¯è¡Œæ€§åˆ†æçš„ä¸€ä¸ªæ–¹é¢ã€‚æ–°ç³»ç»Ÿçš„ç»æµå¯è¡Œæ€§åˆ†æçš„å«ä¹‰æ˜¯ï¼Œä¼°ç®—æ–°ç³»ç»Ÿå¼€å‘å’Œè¿è¡Œæ‰€éœ€çš„è´¹ç”¨ï¼Œä»¥åŠæ–°ç³»ç»Ÿçš„æ•ˆç›Šï¼Œå°†æŠ•èµ„å’Œæ•ˆç›Šè¿›è¡Œæ¯”è¾ƒï¼Œè¯´æ˜åœ¨ç»æµä¸Šæ˜¯åˆç®—çš„ã€‚ 31.ç®€è¿°ç³»ç»Ÿè§„åˆ’ä¸­æ–°ç³»ç»Ÿç›®æ ‡åº”å…·å¤‡çš„é‡è¦ç‰¹æ€§ã€‚ åœ¨åˆ¶è®¢å…·ä½“çš„æ–°ç³»ç»Ÿç›®æ ‡ï¼Œåº”è€ƒè™‘ä½¿ç›®æ ‡å…·å¤‡ä»¥ä¸‹é‡è¦ç‰¹æ€§ï¼š1.ç›®æ ‡çš„æ€»ä½“æˆ˜ç•¥æ€§ï¼›2.ç›®æ ‡çš„å¤šé‡æ€§ï¼›3.ç›®æ ‡çš„ä¾é™„æ€§ï¼›4.ç›®æ ‡çš„é€‚åº”æ€§ï¼›5.ç›®æ ‡çš„é•¿æœŸæ€§ã€‚ 32.åè¯è§£é‡Šï¼šæŠ€æœ¯å¯è¡Œæ€§ æŠ€æœ¯ä¸Šçš„å¯è¡Œæ€§æ˜¯æ ¹æ®æ–°ç³»ç»Ÿçš„ç›®æ ‡æ¥è€ƒè™‘ç³»ç»Ÿçš„è½¯ç¡¬ä»¶æ¶‰åˆ«ã€è®¡ç®—æœºè”ç½‘èƒ½åŠ›ã€ç½‘ç»œåŠæ•°æ®å®‰å…¨ä¿æŠ¤æªæ–½ã€è¾“å…¥è¾“å‡ºè®¾å¤‡ã€å¤§å®¹é‡å­˜å‚¨è®¾å¤‡ç­‰ã€‚æŠ€æœ¯åŠ›é‡ä¸ä»…è€ƒè™‘æŠ€æœ¯äººå‘˜çš„æ•°é‡ï¼Œæ›´åº”è€ƒè™‘ä»–ä»¬çš„ç»éªŒå’Œæ°´å¹³ã€‚ 33.ç®€è¿°æ€»ä½“è§„åˆ’ä¸­å¯è¡Œæ€§åˆ†ææŠ¥å‘Šçš„ä¸»è¦å†…å®¹ã€‚ å¯è¡Œæ€§åˆ†ææŠ¥å‘Šæ˜¯ç³»ç»Ÿå¼€å‘è¿‡ç¨‹ä¸­çš„ç¬¬ä¸€ä¸ªæ­£å¼æ–‡æ¡£ï¼Œç›®å‰å°šæ²¡æœ‰ç»Ÿä¸€çš„ç¼–å†™æ ¼å¼ï¼ŒæŠ¥å‘Šçš„å†…å®¹é€šå¸¸ç”±å‡ éƒ¨åˆ†ç»„æˆï¼š1.å¼•è¨€ã€‚ä¸»è¦åŒ…æ‹¬é¡¹ç›®æ‘˜è¦ã€å¼€å‘èƒŒæ™¯ã€å‚è€ƒèµ„æ–™å’Œä¸“é—¨æœ¯è¯­ç­‰å†…å®¹ï¼›2.ç°è¡Œç³»ç»Ÿè°ƒæŸ¥ä¸åˆ†æï¼›3.æ–°ç³»ç»Ÿå»ºè®¾æ–¹æ¡ˆï¼›4.å¯è¡Œæ€§è®ºè¯ï¼›5.ç»“è®ºã€‚ 34.ç®€è¿°æ€»ä½“è§„åˆ’ä¸­éœ€æ±‚åˆæ­¥è°ƒæŸ¥çš„ä¸»è¦å†…å®¹ã€‚ 1.ç°è¡Œç³»ç»Ÿçš„ç›®æ ‡å’Œä»»åŠ¡ï¼›2.ç°è¡Œç³»ç»Ÿæ¦‚å†µï¼›3.ç°è¡Œç³»ç»Ÿçš„ç¯å¢ƒå’Œçº¦æŸæ¡ä»¶ï¼›4.ç°è¡Œç³»ç»Ÿçš„ä¸šåŠ¡æµç¨‹å’Œå­ç³»ç»Ÿçš„åˆ’åˆ†ï¼›5.æ–°ç³»ç»Ÿçš„å¼€å‘æ¡ä»¶ã€‚ 35.ç®€è¿°æ€»ä½“è§„åˆ’çš„ä¸»è¦æ­¥éª¤ã€‚ 1.éœ€æ±‚åˆæ­¥è°ƒæŸ¥ï¼›2.ç¡®å®šç³»ç»Ÿå»ºè®¾ç›®æ ‡ï¼›3.åˆæ­¥ç¡®å®šå­ç³»ç»Ÿç»„æˆä¸åŸºæœ¬åŠŸèƒ½ï¼›4.æ‹Ÿå®šç³»ç»Ÿå®ç°æ–¹æ¡ˆï¼›5.å¯è¡Œæ€§åˆ†æï¼›6.ç¼–åˆ¶å¯è¡Œæ€§åˆ†ææŠ¥å‘Šã€‚ 36.åè¯è§£é‡Šï¼šç®¡ç†å¯è¡Œæ€§ã€‚ è€ƒè™‘å½“å‰ç³»ç»Ÿçš„ç®¡ç†ä½“åˆ¶æ˜¯å¦æœ‰æ¡ä»¶æä¾›æ–°ç³»ç»Ÿæ‰€å¿…é¡»çš„å„ç§æ•°æ®ï¼Œä¼ä¸šæœ€é«˜å±‚é¢†å¯¼åŠå„çº§ç®¡ç†äººå‘˜å¯¹å¼€å‘å»ºè®¾ä¸€ä¸ªæ–°ç³»ç»Ÿæ¥æ›¿ä»£ç°æœ‰ç³»ç»Ÿçš„éœ€æ±‚æ˜¯å¦è¿«åˆ‡ï¼Œå³æ–°ç³»ç»Ÿçš„å¿…è¦æ€§ã€‚æ­¤å¤–ï¼Œå¯¹æ–°ç³»ç»Ÿè¿è¡Œåå°†å¯¹å„æ–¹é¢äº§ç”Ÿçš„å½±å“ä¹Ÿåº”åŠ ä»¥è€ƒè™‘ã€‚å¦å¤–è¿˜åº”è€ƒè™‘å½“å‰ç³»ç»Ÿçš„ä¸šåŠ¡äººå‘˜å¯¹æ–°ç³»ç»Ÿçš„é€‚åº”èƒ½åŠ›ã€‚ 37.ä¿¡æ¯ç³»ç»Ÿæ€»ä½“è§„åˆ’çš„ä¸»è¦æ­¥éª¤æœ‰å“ªäº›ï¼Ÿ 1.éœ€æ±‚åˆæ­¥è°ƒæŸ¥ï¼›2.ç¡®å®šç³»ç»Ÿå»ºè®¾ç›®æ ‡ï¼›3.åˆæ­¥ç¡®å®šå­ç³»ç»Ÿç»„æˆä¸åŸºæœ¬åŠŸèƒ½ï¼›4.æ‹Ÿå®šç³»ç»Ÿå®æ–½æ–¹æ¡ˆï¼›5.å¯è¡Œæ€§åˆ†æï¼›6.ç¼–åˆ¶å¯è¡Œæ€§åˆ†ææŠ¥å‘Šã€‚ 38.åè¯è§£é‡Šï¼šå¼€å‘ç¯å¢ƒçš„å¯è¡Œæ€§ã€‚ å¼€å‘æ€§çš„å¯è¡Œæ€§æ˜¯å¯è¡Œæ€§åˆ†æçš„ä¸€ä¸ªæ–¹é¢ã€‚ä¼ä¸šé¢†å¯¼æ„è§æ˜¯å¦ä¸€è‡´ï¼Œæœ‰æ— èµ„é‡‘ï¼Œèƒ½å¦æŠ½å‡ºéª¨å¹²åŠ›é‡å‚åŠ æ–°ç³»ç»Ÿå¼€å‘ç­‰ï¼Œç®€å•åœ°è¯´å°±æ˜¯ä¼ä¸šèƒ½ä¸ºæ–°ç³»ç»Ÿçš„å¼€å‘å»ºè®¾æä¾›ä¸€ä¸ªé•¿æœŸçš„ã€è‰¯å¥½çš„ç¯å¢ƒã€‚ 39.åè¯è§£é‡Šï¼šç®¡ç†å¯è¡Œæ€§ã€‚ ç®¡ç†ä¸Šçš„å¯è¡Œæ€§æ˜¯æŒ‡è€ƒè™‘å½“å‰ç³»ç»Ÿçš„ç®¡ç†ä½“åˆ¶æ˜¯å¦æœ‰æ¡ä»¶æä¾›æ–°ç³»ç»Ÿæ‰€å¿…é¡»çš„å„ç§æ•°æ®ï¼Œä¼ä¸šæœ€é«˜å±‚é¢†å¯¼åŠå„çº§ç®¡ç†äººå‘˜å¯¹å¼€å‘å»ºè®¾ä¸€ä¸ªæ–°ç³»ç»Ÿæ¥æ›¿ä»£ç°æœ‰ç³»ç»Ÿçš„éœ€æ±‚æ˜¯å¦è¿«åˆ‡ï¼Œå³æ–°ç³»ç»Ÿçš„å¿…è¦æ€§ã€‚ 40.æ€»ä½“è§„åˆ’ä¸­ï¼Œåˆæ­¥è°ƒæŸ¥çš„ä¸»è¦å†…å®¹ã€‚ 1.ç°è¡Œç³»ç»Ÿçš„ç›®æ ‡å’Œä»»åŠ¡ï¼›2.ç°è¡Œç³»ç»Ÿæ¦‚å†µï¼›3.ç°è¡Œç³»ç»Ÿçš„ç¯å¢ƒå’Œçº¦æŸæ¡ä»¶ï¼›4.ç°è¡Œç³»ç»Ÿçš„ä¸šåŠ¡æµç¨‹å’Œå­ç³»ç»Ÿçš„åˆ’åˆ†ï¼›5.æ–°ç³»ç»Ÿçš„å¼€å‘æ¡ä»¶ã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬å››ç« _æ€»ä½“è§„åˆ’/ç¬¬äºŒèŠ‚_ç³»ç»Ÿè§„åˆ’çš„ä¸»è¦æ­¥éª¤.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬å››ç« _æ€»ä½“è§„åˆ’/ç¬¬äºŒèŠ‚_ç³»ç»Ÿè§„åˆ’çš„ä¸»è¦æ­¥éª¤.html","title":"ç¬¬äºŒèŠ‚ï¼šç³»ç»Ÿè§„åˆ’çš„ä¸»è¦æ­¥éª¤","keywords":"","body":"ç¬¬äºŒèŠ‚ï¼šç³»ç»Ÿè§„åˆ’çš„ä¸»è¦æ­¥éª¤ ä¼ä¸šç³»ç»Ÿè§„åˆ’æ³• 1.BSPæ³•å¯ç”¨äºç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„ï¼ˆAï¼‰ A è§„åˆ’ B åˆ†æ C å®æ–½ D ç»´æŠ¤ 2.BSPæ³•å¯ç”¨äºç®¡ç†ä¿¡æ¯ç³»ç»Ÿçš„æ€»ä½“è§„åˆ’ã€‚ 3.ç”¨äºç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ€»ä½“è§„åˆ’çš„å¸¸è§æ–¹æ³•æœ‰ä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯ä¼ä¸šç³»ç»Ÿè§„åˆ’æ³•ã€å…³é”®æˆåŠŸå› ç´ æ³•å’Œæˆ˜ç•¥ç›®æ ‡é›†è½¬åŒ–æ³•ã€‚ æ–¹æ³•æ¦‚è¿° 1.BSPæ³•éµå¾ªçš„ä¸€ä¸ªåŸåˆ™æ˜¯ä»æ–¹æ³•è®ºåˆ°æ‘†è„±å¯¹ï¼ˆDï¼‰ A ç®¡ç†åˆ¶åº¦çš„ä¾èµ–æ€§ B ç®¡ç†æ–¹æ³•çš„ä¾ä»æ€§ C ç»„ç»‡æ–‡åŒ–çš„ä¾ä»æ€§ D ç»„ç»‡æœºæ„çš„ä¾ä»æ€§ 2.åœ¨æ€»ä½“æ€è·¯ä¸Šï¼ŒBSPæ³•éµå¾ªçš„åŸåˆ™æ˜¯ï¼ˆDï¼‰ A è‡ªä¸‹è€Œä¸Šçš„åˆ†æä¸è‡ªä¸Šè€Œä¸‹çš„è§„åˆ’ç›¸ç»“åˆ B è‡ªä¸Šè€Œä¸‹çš„åˆ†æä¸è‡ªä¸‹è€Œä¸Šçš„è§„åˆ’ç›¸ç»“åˆ C è‡ªä¸‹è€Œä¸Šçš„è§„åˆ’ä¸è‡ªä¸Šè€Œä¸‹çš„å®æ–½ç›¸ç»“åˆ D è‡ªä¸Šè€Œä¸‹çš„è§„åˆ’ä¸è‡ªä¸‹è€Œä¸Šçš„å®æ–½ç›¸ç»“åˆ 3.BSPæ³•å¿…é¡»éµå¾ªçš„é¦–è¦åŸåˆ™æ˜¯æ”¯æŒï¼ˆAï¼‰ A ä¼ä¸šçš„æ€»ç›®æ ‡ B ä¿¡æ¯ç³»ç»Ÿçš„æ€»ç›®æ ‡ C ä¼ä¸šè¿‡ç¨‹ D ä¿¡æ¯ç³»ç»Ÿæ€»ä½“ç»“æ„ 4.ä»¥ä¸‹å±äºBSPæ³•å·¥ä½œæµç¨‹ä¸­æ ¸å¿ƒéƒ¨åˆ†çš„æ˜¯ï¼ˆCï¼‰ A ç ”ç©¶é¡¹ç›®çš„ç¡®å®š B ç ”ç©¶ç»„æˆå‘˜çš„é€‰æ‹© C å®šä¹‰ä¼ä¸šè¿‡ç¨‹ D åˆ¶è®¢å¼€å‘å»ºè®®ä¹¦ä¸å¼€å‘è®¡åˆ’ 5.ä¼ä¸šç³»ç»Ÿè§„åˆ’æ–¹æ³•ï¼ˆBSPï¼‰çš„å®è´¨æ˜¯ï¼ˆBï¼‰ A ä¿¡æ¯ç³»ç»Ÿæˆ˜ç•¥è½¬åŒ–æˆä¼ä¸šæˆ˜ç•¥ B ä¼ä¸šæˆ˜ç•¥è½¬åŒ–æˆä¿¡æ¯ç³»ç»Ÿæˆ˜ç•¥ C ä¿¡æ¯ç³»ç»Ÿè¿‡ç¨‹è½¬åŒ–æˆä¼ä¸šè¿‡ç¨‹ D ä¼ä¸šè¿‡ç¨‹è½¬åŒ–æˆä¿¡æ¯ç³»ç»Ÿè¿‡ç¨‹ 6.ä¸‹é¢å…³äºBSPæ–¹æ³•çš„å™è¿°ï¼Œä¸æ­£ç¡®çš„æ˜¯ï¼ˆC) A BSPæ–¹æ³•æ˜¯ä¸€ç§ç»“æ„åŒ–æ–¹æ³• B BSPæ–¹æ³•çš„å®è´¨æ˜¯ä¼ä¸šæˆ˜ç•¥è½¬åŒ–æˆä¿¡æ¯ç³»ç»Ÿæˆ˜ç•¥ C BSPæ–¹æ³•æ¨èé‡‡ç”¨è‡ªä¸‹è€Œä¸Šçš„æ–¹å¼è¯†åˆ«ä¿¡æ¯ç³»ç»Ÿç›®æ ‡å’Œæ•°æ® D BSPæ–¹æ³•å¯ä½¿ä¿¡æ¯ç³»ç»Ÿåœ¨ç»“æ„ä¸Šæœ‰è‰¯å¥½çš„æ•´ä½“æ€§ 7.BSPæ³•å¿…é¡»éµå¾ªçš„ä¸»è¦åŸåˆ™ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A æ”¯æŒä¼ä¸šçš„æ€»ç›®æ ‡ B é¢å‘ä¼ä¸šä¸­ç®¡ç†å„å±‚æ¬¡çš„è¦æ±‚ C ä»æ–¹æ³•ä¸Šæ‘†è„±ä¿¡æ¯ç³»ç»Ÿå¯¹æ—§ç»„ç»‡ç»“æ„çš„ä¾ä»æ€§ D å¿…é¡»è‡ªä¸Šè€Œä¸‹è§„åˆ’å®æ–½ 8.åœ¨æ€»ä½“æ€è·¯ä¸Šï¼ŒBSPæ³•éµå¾ªçš„åŸåˆ™æ˜¯è‡ªä¸Šè€Œä¸‹çš„è§„åˆ’ä¸è‡ªä¸‹è€Œä¸Šçš„å®æ–½ç›¸ç»“åˆã€‚ 9.BSPæ³•å·¥ä½œæµç¨‹ä¸­çš„æ ¸å¿ƒéƒ¨åˆ†ä¹‹ä¸€æ˜¯å®šä¹‰ä¼ä¸šè¿‡ç¨‹å’Œå®šä¹‰æ•°æ®ç±»ã€‚ 10.BSPï¼ˆä¼ä¸šç³»ç»Ÿè§„åˆ’ï¼‰æ–¹æ³•å·¥ä½œæµç¨‹ä¸­çš„æ ¸å¿ƒéƒ¨åˆ†ä¹‹ä¸€æ˜¯å®šä¹‰ä¼ä¸šè¿‡ç¨‹å’Œå®šä¹‰æ•°æ®ç±»ã€‚ 11.BSPæ³•å®è´¨æ˜¯ä¼ä¸šæˆ˜ç•¥è½¬åŒ–ä¿¡æ¯ç³»ç»Ÿæˆ˜ç•¥çš„è¿‡ç¨‹ã€‚ 12.ä»æ–¹æ³•è®ºä¸Šæ‘†è„±å¯¹æ—§ç»„ç»‡æœºæ„çš„ä¾ä»æ€§æ˜¯BSPæ³•éµå¾ªçš„ä¸€ä¸ªåŸåˆ™ã€‚ 13.BSPæ–¹æ³•ç€çœ¼äºä¼ä¸šæ´»åŠ¨è¿‡ç¨‹ï¼Œä»æ–¹æ³•è®ºä¸Šæ‘†è„±äº†ä¿¡æ¯ç³»ç»Ÿå¯¹æ—§ç»„ç»‡ç»“æ„çš„ä¾ä»æ€§ã€‚ 14.ä¼ä¸šç³»ç»Ÿè§„åˆ’æ–¹æ³•ï¼ˆBSPï¼‰å·¥ä½œæµç¨‹ä¸­çš„æ ¸å¿ƒéƒ¨åˆ†åŒ…æ‹¬äº†å®šä¹‰ä¼ä¸šè¿‡ç¨‹å’Œå®šä¹‰æ•°æ®ç±»ã€‚ 15.BSPæ³•å¿…é¡»éµå¾ªçš„é¦–è¦åŸåˆ™æ˜¯æ”¯æŒä¼ä¸šçš„æ€»ç›®æ ‡ã€‚ 16.ç®€è¿°ä¼ä¸šç³»ç»Ÿè§„åˆ’ï¼ˆBSPï¼‰æ³•å¿…é¡»éµå¾ªçš„ä¸»è¦åŸåˆ™ã€‚ ä¼ä¸šç³»ç»Ÿè§„åˆ’ï¼ˆBSPï¼‰æ³•å¿…é¡»éµå¾ªçš„ä¸»è¦åŸåˆ™ï¼š1.æ”¯æŒä¼ä¸šçš„æ€»ç›®æ ‡ï¼›2.é¢å‘ä¼ä¸šä¸­ç®¡ç†å„å±‚æ¬¡çš„è¦æ±‚ï¼›3.ä»æ–¹æ³•è®ºä¸Šæ‘†è„±ä¿¡æ¯ç³»ç»Ÿå¯¹æ—§ç»„ç»‡æœºæ„çš„ä¾ä»æ€§ï¼›4.æ˜¯ä¿¡æ¯ç³»ç»Ÿåœ¨ç»“æ„ä¸Šæœ‰è‰¯å¥½çš„æ•´ä½“æ€§ï¼›5.è‡ªä¸Šè€Œä¸‹è§„åˆ’å’Œè‡ªä¸‹è€Œä¸Šå®æ–½ç›¸ç»“åˆã€‚ 17.ç®€è¿°BSPæ–¹æ³•å·¥ä½œæµæ ¸å¿ƒéƒ¨åˆ†çš„å†…å®¹ã€‚ BSPæ–¹æ³•å·¥ä½œæµç¨‹çš„æ ¸å¿ƒéƒ¨åˆ†ä¸º1.å®šä¹‰ä¼ä¸šè¿‡ç¨‹å’Œæ•°æ®ç±»ï¼›2.åˆ†æç ”ç©¶ç°è¡Œç³»ç»Ÿå¯»æ±‚ä¼ä¸šçš„æ”¯æŒï¼›3.ç ”ç©¶ç®¡ç†éƒ¨é—¨å¯¹ç³»ç»Ÿçš„è¦æ±‚ï¼›4.ç¡®å®šæ–°ä¿¡æ¯ç³»ç»Ÿçš„ä½“ç³»ç»“æ„ï¼›5.ç¡®å®šæ–°ç³»ç»Ÿçš„å®ç°ä¼˜åŒ–é¡ºåºã€‚ 18.ç®€è¿°BSPæ–¹æ³•å·¥ä½œæµç¨‹çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚ 1.å®šä¹‰ä¼ä¸šè¿‡ç¨‹å’Œæ•°æ®ç±»ï¼›2.åˆ†æç ”ç©¶ç°è¡Œç³»ç»Ÿå¯¹ä¼ä¸šçš„æ”¯æŒï¼›3.ç ”ç©¶ç®¡ç†éƒ¨é—¨å¯¹ç³»ç»Ÿçš„è¦æ±‚ï¼›4.ç¡®å®šæ–°ä¿¡æ¯ç³»ç»Ÿçš„ä½“ç³»ç»“æ„ï¼›5.ç¡®å®šæ–°ä¿¡æ¯ç³»ç»Ÿçš„å®ç°ä¼˜åŒ–é¡ºåºã€‚ 19.åè¯è§£é‡Šï¼šä¼ä¸šç³»ç»Ÿè§„åˆ’æ–¹æ³•ï¼ˆBSPï¼‰ æ˜¯ç”±ç¾å›½IBMå…¬å¸ä¸20ä¸–çºª70å¹´ä»£åˆ›é€ å¹¶é€æ¸å‘å±•èµ·æ¥çš„ä¸€ç§å¯¹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè¿›è¡Œè§„åˆ’å’Œè®¾è®¡çš„ç»“æ„åŒ–æ–¹æ³•ï¼Œè‡³ä»Šä»å¹¿ä¸ºåº”ç”¨ï¼Œå¹¶åœ¨è®¸å¤šé¢†åŸŸå–å¾—äº†æˆåŠŸã€‚ æ–¹æ³•æ¦‚è¿° 1.BSPæ³•éµå¾ªçš„ä¸€ä¸ªåŸåˆ™æ˜¯ä»æ–¹æ³•è®ºä¸Šæ‘†è„±å¯¹ï¼ˆDï¼‰ A ç®¡ç†åˆ¶åº¦çš„ä¾ä»æ€§ B ç®¡ç†æ–¹æ³•çš„ä¾ä»æ€§ C ç»„ç»‡æ–‡åŒ–çš„ä¾ä»æ€§ D ç»„ç»‡æœºæ„çš„ä¾ä»æ€§ 2.åœ¨æ€»ä½“æ€è·¯ä¸Šï¼ŒBSPæ³•éµå¾ªçš„åŸåˆ™æ˜¯ï¼ˆDï¼‰ A è‡ªä¸‹è€Œä¸Šçš„åˆ†æä¸è‡ªä¸Šè€Œä¸‹çš„è§„åˆ’ç›¸ç»“åˆ B è‡ªä¸Šè€Œä¸‹çš„åˆ†æä¸è‡ªä¸‹è€Œä¸Šçš„è§„åˆ’ç›¸ç»“åˆ C è‡ªä¸‹è€Œä¸Šçš„è§„åˆ’ä¸è‡ªä¸Šè€Œä¸‹çš„å®æ–½ç›¸é›†åˆ D è‡ªä¸Šè€Œä¸‹çš„è§„åˆ’ä¸è‡ªä¸‹è€Œä¸Šçš„å®æ–½ç›¸ç»“åˆ 3.BSPæ³•å¿…é¡»éµå¾ªçš„é¦–è¦åŸåˆ™æ˜¯æ”¯æŒï¼ˆAï¼‰ A ä¼ä¸šçš„æ€»ç›®æ ‡ B ä¿¡æ¯ç³»ç»Ÿçš„æ€»ç›®æ ‡ C ä¼ä¸šè¿‡ç¨‹ D ä¿¡æ¯ç³»ç»Ÿæ€»ä½“ç»“æ„ 4.ä»¥ä¸‹å±äºBSPæ³•å·¥ä½œæµç¨‹ä¸­æ ¸å¿ƒéƒ¨åˆ†çš„æ˜¯ï¼ˆC) A ç ”ç©¶é¡¹ç›®çš„ç¡®å®š B ç ”ç©¶ç»„å…ƒçš„é€‰æ‹© C å®šä¹‰ä¼ä¸šè¿‡ç¨‹ D åˆ¶è®¢å¼€å‘å»ºè®®ä¹¦ä¸å¼€å‘è®¡åˆ’ 5.ä¼ä¸šç³»ç»Ÿè§„åˆ’æ–¹æ³•ï¼ˆBSPï¼‰çš„å®è´¨æ˜¯ï¼ˆBï¼‰ A ä¿¡æ¯ç³»ç»Ÿæˆ˜ç•¥è½¬åŒ–æˆä¼ä¸šæˆ˜ç•¥ B ä¼ä¸šæˆ˜ç•¥è½¬åŒ–æˆä¿¡æ¯ç³»ç»Ÿæˆ˜ç•¥ C ä¿¡æ¯ç³»ç»Ÿè¿‡ç¨‹è½¬åŒ–æˆä¼ä¸šè¿‡ç¨‹ D ä¼ä¸šè¿‡ç¨‹è½¬åŒ–æˆä¿¡æ¯ç³»ç»Ÿè¿‡ç¨‹ 6.ä¸‹é¢å…³äºBSPæ–¹æ³•çš„å™è¿°ï¼Œä¸æ­£ç¡®çš„æ˜¯ï¼ˆCï¼‰ A BSPæ–¹æ³•æ˜¯ä¸€ç§ç»“æ„åŒ–æ–¹æ³• B BSPæ–¹æ³•çš„å®è´¨æ˜¯ä¼ä¸šæˆ˜ç•¥è½¬åŒ–æˆä¿¡æ¯ç³»ç»Ÿæˆ˜ç•¥ C BSPæ–¹æ³•æ¨èç”¨è‡ªä¸‹è€Œä¸Šçš„æ–¹å¼è¯†åˆ«ä¿¡æ¯ç³»ç»Ÿç›®æ ‡å’Œæ•°æ® D BSPæ–¹æ³•å¯ä½¿ä¿¡æ¯ç³»ç»Ÿåœ¨ç»“æ„ä¸Šç”±è‰¯å¥½çš„æ•´ä½“æ€§ 7.BSPæ³•å¿…é¡»éµå¾ªçš„ä¸»è¦åŸåˆ™ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A æ”¯æŒä¼ä¸šçš„æ€»ç›®æ ‡ B é¢å‘ä¼ä¸šä¸­ç®¡ç†å„å±‚æ¬¡çš„è¦æ±‚ C ä»æ–¹æ³•ä¸Šæ‘†è„±ä¿¡æ¯ç³»ç»Ÿå¯¹æ—§ç»„ç»‡æœºæ„çš„ä¾ä»æ€§ D å¿…é¡»è‡ªä¸Šè€Œä¸‹è§„åˆ’å®æ–½ 8.åœ¨æ€»ä½“æ€è·¯ä¸Šï¼ŒBSPæ³•éµå¾ªçš„åŸåˆ™æ˜¯è‡ªä¸Šè€Œä¸‹çš„è§„åˆ’ä¸è‡ªä¸‹è€Œä¸Šçš„å®æ–½ç›¸ç»“åˆã€‚ 9.BSPæ³•å·¥ä½œæµç¨‹ä¸­çš„æ ¸å¿ƒéƒ¨åˆ†ä¹‹ä¸€æ˜¯å®šä¹‰ä¼ä¸šè¿‡ç¨‹å’Œå®šä¹‰æ•°æ®ç±»ã€‚ 10.BSPï¼ˆä¼ä¸šç³»ç»Ÿè§„åˆ’ï¼‰æ–¹æ³•å·¥ä½œæµç¨‹ä¸­çš„æ ¸å¿ƒéƒ¨åˆ†ä¹‹ä¸€æ˜¯å®šä¹‰ä¼ä¸šè¿‡ç¨‹å’Œå®šä¹‰æ•°æ®ç±»ã€‚ 11.BSPæ³•çš„å®è´¨æ˜¯ä¼ä¸šæˆ˜ç•¥è½¬åŒ–æˆä¿¡æ¯ç³»ç»Ÿæˆ˜ç•¥çš„è¿‡ç¨‹ã€‚ 12.ä»æ–¹æ³•è®ºä¸Šæ‘†è„±å¯¹æ—§ç»„ç»‡æœºæ„çš„ä¾ä»æ€§æ˜¯BSPæ³•éµå¾ªçš„ä¸€ä¸ªåŸåˆ™ã€‚ 13.BSPæ–¹æ³•ç€çœ¼äºä¼ä¸šæ´»åŠ¨è¿‡ç¨‹ï¼Œä»æ–¹æ³•ä¸Šæ‘†è„±äº†ä¿¡æ¯ç³»ç»Ÿå¯¹æ—§ç»„ç»‡æœºæ„çš„ä¾ä»æ€§ã€‚ 14.ä¼ä¸šç³»ç»Ÿè§„åˆ’æ–¹æ³•ï¼ˆBSPï¼‰å·¥ä½œæµç¨‹ä¸­çš„æ ¸å¿ƒéƒ¨åˆ†åŒ…æ‹¬å®šä¹‰ä¼ä¸šè¿‡ç¨‹å’Œå®šä¹‰æ•°æ®ç±»ã€‚ 15.BSPæ³•å¿…é¡»éµå¾ªçš„é¦–è¦åŸåˆ™æ˜¯æ”¯æŒä¼ä¸šçš„æ€»ç›®æ ‡ã€‚ 16.ç®€è¿°ä¼ä¸šç³»ç»Ÿè§„åˆ’ï¼ˆBSPï¼‰æ³•å¿…é¡»éµå¾ªçš„ä¸»è¦åŸåˆ™ã€‚ 1.æ”¯æŒä¼ä¸šçš„æ€»ç›®æ ‡ï¼›2.é¢å‘ä¼ä¸šä¸­ç®¡ç†å„å±‚æ¬¡çš„è¦æ±‚ï¼›3.ä»æ–¹æ³•ä¸Šæ‘†è„±ä¿¡æ¯ç³»ç»Ÿå¯¹æ—§ç»„ç»‡æœºæ„çš„ä¾ä»æ€§ï¼›4.ä½¿ä¿¡æ¯ç³»ç»Ÿåœ¨ç»“æ„ä¸Šæœ‰è‰¯å¥½çš„æ•´ä½“æ€§ï¼›5.è‡ªä¸Šè€Œä¸‹è§„åˆ’å’Œè‡ªä¸‹è€Œä¸Šå®æ–½ç›¸ç»“åˆã€‚ 17.ç®€è¿°BSPæ–¹æ³•å·¥ä½œæµç¨‹æ ¸å¿ƒéƒ¨åˆ†çš„å†…å®¹ã€‚ 1.å®šä¹‰ä¼ä¸šè¿‡ç¨‹å’Œæ•°æ®ç±»ï¼›2.åˆ†æç ”ç©¶ç°è¡Œç³»ç»Ÿå¯»æ±‚ä¼ä¸šçš„æ”¯æŒï¼›3.ç ”ç©¶ç®¡ç†éƒ¨é—¨å¯¹ç³»ç»Ÿçš„è¦æ±‚ï¼›4.ç¡®å®šæ–°ä¿¡æ¯ç³»ç»Ÿçš„ä½“ç³»ç»“æ„ï¼›5.ç¡®å®šæ–°ä¿¡æ¯ç³»ç»Ÿçš„å®ç°ä¼˜åŒ–é¡ºåºã€‚ 18.ç®€è¿°BSPæ–¹æ³•å·¥ä½œæµç¨‹çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚ 1.å®šä¹‰ä¼ä¸šè¿‡ç¨‹å’Œæ•°æ®ç±»ï¼›2.åˆ†æç ”ç©¶ç°è¡Œç³»ç»Ÿå¯¹ä¼ä¸šçš„æ”¯æŒï¼›3.ç ”ç©¶ç®¡ç†éƒ¨é—¨å¯¹ç³»ç»Ÿçš„è¦æ±‚ï¼›4.ç¡®å®šä¿¡æ¯ç³»ç»Ÿçš„ä½“ç³»ç»“æ„ï¼›5.ç¡®å®šæ–°ä¿¡æ¯ç³»ç»Ÿçš„å®ç°ä¼˜åŒ–é¡ºåºã€‚ 19.åè¯è§£é‡Šï¼šä¼ä¸šç³»ç»Ÿè§„åˆ’æ–¹æ³•ï¼ˆBSPï¼‰ã€‚ æ˜¯ç”±ç¾å›½IBMå…¬å¸äº20ä¸–çºª70å¹´ä»£åˆ›é€ å¹¶é€æ¸å‘å±•èµ·æ¥çš„ä¸€ç§å¯¹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè¿›è¡Œè§„åˆ’å’Œè®¾è®¡çš„ç»“æ„åŒ–æ–¹æ³•ï¼Œè‡³ä»Šä»å¹¿ä¸ºåº”ç”¨ï¼Œå¹¶åœ¨è®¸å¤šé¢†åŸŸå–å¾—äº†æˆåŠŸã€‚ å·¥ä½œæµç¨‹ 1.BSPå·¥ä½œä¸­çš„æœ€åä¸€é¡¹æµç¨‹æ˜¯ï¼ˆAï¼‰ A ç ”ç©¶æˆæœæŠ¥å‘Š B åˆ¶å®šå»ºè®®ä¹¦å’Œå¼€å‘è®¡åˆ’ C ç¡®å®šå­ç³»ç»Ÿå¼€å‘çš„ä¼˜å…ˆé¡ºåº D æå‡ºåˆ¤æ–­å’Œç»“è®º 2.åœ¨BSPå·¥ä½œæµç¨‹ä¸­ï¼Œåˆ†æå½“å‰ç³»ç»Ÿæ”¯æŒé˜¶æ®µçš„åˆ†æå·¥å…·ï¼ˆAï¼‰ A ä¸¾è¯ B æ•°æ®æµå›¾ C æµç¨‹å›¾ D å®ä½“è”ç³»å›¾ 3.ç ”ç©¶ç®¡ç†éƒ¨é—¨å¯¹ç³»ç»Ÿçš„è¦æ±‚æ˜¯ï¼ˆAï¼‰ A è‡ªä¸Šè€Œä¸‹ B è‡ªä¸‹è€Œä¸Š C ä»å‰å¾€å D ä»åå¾€å‰ 4.å…³äºâ€œç ”ç©¶ç®¡ç†éƒ¨é—¨å¯¹ç³»ç»Ÿçš„è¦æ±‚â€çš„è¾¾åˆ°ç›®æ ‡ï¼Œé”™è¯¯çš„æ˜¯ï¼ˆDï¼‰ A å¯¹ç ”ç©¶ç»„å·²å¾—å‡ºçš„ç»“è®ºè¿›è¡Œæ ¸å® B å¼„æ¸…ä¼ä¸šå°†æ¥çš„å‘å±•æ–¹å‘ã€ä¿¡æ¯éœ€æ±‚ã€ä¸»è¦çš„éšœç¢å’Œæœºä¼š C ç¡®å®šä¼ä¸šå­˜åœ¨çš„é—®é¢˜ D æå‡ºåˆ¤æ–­å’Œç»“è®º 5.å…³äºBSPçš„å·¥ä½œæµç¨‹ï¼Œè¯´æ³•é”™è¯¯çš„æ˜¯ï¼ˆDï¼‰ A BSPçš„ç ”ç©¶å¿…é¡»åœ¨ä¼ä¸šæœ€é«˜é¢†å¯¼å’Œæœ€é«˜ç®¡ç†éƒ¨é—¨å‚ä¸çš„å‰æä¸‹æ‰èƒ½å¼€å‘ B ç ”ç©¶å¼€å§‹å‰éœ€è¦æ”¶é›†å¥½ç›¸å…³åŸºç¡€èµ„æ–™ C ç ”ç©¶çš„å‡†å¤‡æ´»åŠ¨æˆæœæ˜¯åˆ¶è®¢ç ”ç©¶è®¡åˆ’ D ç ”ç©¶çš„å‡†å¤‡æ´»åŠ¨ä¸‹ä¸€é˜¶æ®µæ˜¯å®šä¹‰ä¼ä¸šè¿‡ç¨‹ 6.BSPæ³•ä¸­ï¼Œå®šä¹‰æ•°æ®ç±»æ—¶æœ€é‡è¦çš„æ˜¯å…³è”æ•°æ®ç±»ä¸ï¼ˆBï¼‰ A ä¼ä¸šç›®æ ‡ B ä¼ä¸šè¿‡ç¨‹ C ä¼ä¸šèµ„æº D ä¼ä¸šç»„ç»‡ 7.BSPæ–¹æ³•ä¸­ï¼Œä¼ä¸šè¿‡ç¨‹å…³æ³¨çš„ä¸»è¦å†…å®¹æ˜¯ï¼ˆAï¼‰ A ä¼ä¸šèµ„æºè½¬åŒ–ä¸èµ„æºç®¡ç† B ä¼ä¸šä¿¡æ¯è½¬åŒ–ä¸åˆ©ç”¨ C å­ç³»ç»Ÿä»¶çš„ä¿¡æ¯äº¤æ¢ D ä¼ä¸šéƒ¨é—¨çš„ä¿¡æ¯äº¤æ¢ 8.åœ¨BSPæ–¹æ³•ä¸­ï¼Œâ€œå»ºç«‹è¿‡ç¨‹å’Œæ•°æ®ç±»çŸ©é˜µï¼Œå¹¶ä¸ºè®¾è®¡å‡ºä¿¡æ¯ç³»ç»Ÿç»“æ„æä¾›åŸºæœ¬æ•°æ®â€è¿™ä¸€æ­¥åº”å‘ç”Ÿåœ¨ï¼ˆBï¼‰ A å®šä¹‰ä¼ä¸šè¿‡ç¨‹ B å®šä¹‰æ•°æ®ç±»é˜¶æ®µ C åˆ†æå½“å‰çš„ç³»ç»Ÿæ”¯æŒé˜¶æ®µ D ç ”ç©¶ç®¡ç†éƒ¨é—¨å¯¹ç³»ç»Ÿçš„è¦æ±‚é˜¶æ®µ 9.BSPæ³•ä¸­ï¼Œå®šä¹‰æ•°æ®ç±»æ—¶æœ€é‡è¦çš„æ˜¯è¦æŠŠæ•°æ®ç±»ä¸ä¼ä¸šè¿‡ç¨‹å…³è”èµ·æ¥ã€‚ 10.ä¼ä¸šè¿‡ç¨‹æ˜¯ä¼ä¸šèµ„æºè½¬åŒ–ä¸èµ„æºç®¡ç†ä¸­çš„æœ‰é€»è¾‘å…³ç³»çš„å†³ç­–å’Œæ´»åŠ¨ã€‚ 11.ä¼ä¸šè¿‡ç¨‹æ˜¯ä¼ä¸šèµ„æºè½¬åŒ–ä¸èµ„æºç®¡ç†ä¸­çš„æœ‰é€»è¾‘å…³ç³»çš„å†³ç­–å’Œæ´»åŠ¨ã€‚ 12.å®šä¹‰æ•°æ®ç±»æ—¶æœ€é‡è¦çš„æ˜¯è¦æŠŠæ•°æ®ç±»ä¸ä¼ä¸šè¿‡ç¨‹å…³è”èµ·æ¥ã€‚ 13.åè¯è§£é‡Šï¼šBSPæ³•ä¸­çš„ä¼ä¸šè¿‡ç¨‹ã€‚ ä¼ä¸šè¿‡ç¨‹æ˜¯æŒ‡ä¼ä¸šèµ„æºè½¬åŒ–å’Œèµ„æºç®¡ç†ä¸­æœ‰é€»è¾‘å…³ç³»çš„å†³ç­–å’Œæ´»åŠ¨ã€‚é€šè¿‡ä¼ä¸šè¿‡ç¨‹çš„ç ”ç©¶ï¼Œå¯ä»¥äº†è§£ä¼ä¸šçš„åŠŸèƒ½ã€ä»»åŠ¡ã€ä¿¡æ¯éœ€æ±‚å’Œå…³è”ï¼›ä»è€Œä½œå‡ºå…³ç³»çŸ©é˜µï¼Œé€šè¿‡å…³ç³»çŸ©é˜µå¯è¿›ä¸€æ­¥å½¢æˆç³»ç»Ÿä¿¡æ¯æ¨¡å‹ï¼Œæ‰€ä»¥è¯´ä¼ä¸šè¿‡ç¨‹æ˜¯ä¼ä¸šç¯å¢ƒä¸ä¿¡æ¯ç³»ç»Ÿä¹‹é—´çš„ç•Œé¢ã€‚ 14.åè¯è§£é‡Šï¼šæ•°æ®ç±» åœ¨BSPæ³•ä¸­ï¼Œæ•°æ®ç±»æ˜¯æŒ‡æ”¯æŒä¼ä¸šæ‰€å¿…éœ€çš„ï¼Œåœ¨é€»è¾‘ä¸Šäº’ç›¸è”ç³»çš„ï¼Œå¹¶èƒ½ç»„æˆç›¸å¯¹ç‹¬ç«‹çš„å®Œæ•´æ•°æ®å•ä½çš„é‚£äº›æ•°æ®éƒ¨åˆ†ã€‚ 15.ç®€è¿°BSPæ³•çš„å·¥ä½œæµç¨‹ä¸­â€œç ”ç©¶ç®¡ç†éƒ¨é—¨å¯¹ç³»ç»Ÿçš„è¦æ±‚â€è¿™ä¸€å·¥ä½œè¾¾åˆ°çš„ç›®çš„ã€‚ â€œç ”ç©¶ç®¡ç†éƒ¨é—¨å¯¹ç³»ç»Ÿçš„è¦æ±‚â€è¿™ä¸€å·¥ä½œåº”è¾¾åˆ°çš„ç›®çš„ï¼š1.å¯¹ç ”ç©¶ç»„å·²å¾—å‡ºçš„ç»“è®ºè¿›è¡Œæ ¸å®ã€‚é‡ç‚¹æ ¸å®èŒè´£ã€ç›®æ ‡ã€å…³é”®æˆåŠŸå› å­ç­‰æ–¹é¢ï¼›2.å¼„æ¸…ä¼ä¸šå°†æ¥çš„å‘å±•æ–¹å‘ã€ä¿¡æ¯éœ€æ±‚ã€ä¸»è¦çš„éšœç¢å’Œæœºä¼šï¼›3.ç¡®å®šä¼ä¸šå­˜åœ¨çš„é—®é¢˜ï¼Œå°†ä»–ä»¬ä¸ä¼ä¸šè¿‡ç¨‹å’Œæ•°æ®ç±»è”ç³»èµ·æ¥è¿›è¡Œè€ƒè™‘ï¼›4.æå‡ºè§£å†³è¿™äº›é—®é¢˜å¯èƒ½çš„æ–¹æ³•ã€ç¡®å®šæ½œåœ¨çš„æ•ˆç›Šã€‚ å®šä¹‰ä¼ä¸šè¿‡ç¨‹ 1.BSPæ³•ä¸­å…³é”®æ€§çš„ä¼ä¸šèµ„æºæ˜¯ï¼ˆBï¼‰ A è®¡åˆ’ä¸æ§åˆ¶ B äº§å“ä¸æœåŠ¡ C ææ–™ä¸è®¾å¤‡ D èµ„é‡‘ä¸èµ„äº§ 2.åœ¨BSPæ–¹æ³•ä¸­ï¼Œå®šä¹‰ä¼ä¸šè¿‡ç¨‹åº”è¯¥ä»ä¸‰ä¸ªæ–¹é¢å…¥æ‰‹ï¼Œå®ƒä»¬æ˜¯ï¼ˆDï¼‰ A äººå‘˜ã€è®¾å¤‡ã€èµ„é‡‘ B äº§å“ã€æœåŠ¡ã€ç®¡ç† C äº§å“ä¸æœåŠ¡ã€äººå‘˜ã€ç‰©èµ„ D è®¡åˆ’ä¸æ§åˆ¶ã€äº§å“ä¸æœåŠ¡ã€æ”¯æŒæ€§èµ„æº 3.èµ„æºçš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µä¸åŒ…æ‹¬ï¼ˆBï¼‰ A éœ€æ±‚ B è®¡åˆ’ C æœåŠ¡ D é€€å‡º 4.ä¸ºå®ç°ä¼ä¸šç›®æ ‡å¿…é¡»ä½¿ç”¨ã€å¼•ç”¨å’Œæ¶ˆè€—çš„èµ„æºå±äºï¼ˆAï¼‰ A æ”¯æŒæ€§èµ„æº B å…³é”®æ€§èµ„æº C äº§å“ä¸æœåŠ¡ D è®¡åˆ’ä¸æ§åˆ¶ 5.BSPæ³•ä¸­ï¼Œä¼ä¸šèµ„æºçš„ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä»¥ä¸‹å››ä¸ªé˜¶æ®µï¼ˆCï¼‰ A è§„åˆ’ã€å¼€å‘ã€åˆ©ç”¨ã€å›æ”¶ B éœ€æ±‚ã€ç”Ÿäº§ã€æ¶ˆè´¹ã€å›æ”¶ C éœ€æ±‚ã€è·å–ã€æœåŠ¡ã€é€€å‡º D åˆ†æã€è®¾è®¡ã€å®æ–½ã€æ›´æ–° 6.BSPæ–¹æ³•çš„æ ¸å¿ƒæ˜¯ï¼ˆAï¼‰ A å®šä¹‰ä¼ä¸šè¿‡ç¨‹ B å®šä¹‰æ•°æ®ç±» C ç ”ç©¶ç®¡ç†éƒ¨é—¨ç³»ç»Ÿçš„è¦æ±‚ D è®¾è®¡ä¿¡æ¯ç³»ç»Ÿæ€»ä½“ç»“æ„ 7.BSPæ³•ä¸­ä¼ä¸šè¿‡ç¨‹å®šä¹‰çš„ä¸€èˆ¬æ­¥éª¤ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A ä»è®¡åˆ’/æ§åˆ¶èµ„æºç€æ‰‹ B è¯†åˆ«äº§å“/æœåŠ¡è¿‡ç¨‹ C æ”¯æŒæ€§èµ„æºè¯†åˆ«ä¼ä¸šè¿‡ç¨‹ D è¯†åˆ«ä¼ä¸šè¿‡ç¨‹ 8.è®¡åˆ’ä¸æ§åˆ¶ã€äº§å“ä¸æœåŠ¡ã€æ”¯æŒæ€§èµ„æºæ˜¯BSPæ³•å®šä¹‰çš„ä¼ä¸šä¸‰é¡¹èµ„æºã€‚ 9.BSPæ³•ä¸­ï¼Œä¼ä¸šèµ„æºçš„ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºéœ€æ±‚ã€è·å–ã€æœåŠ¡ã€é€€å‡º4ä¸ªé˜¶æ®µã€‚ 10.BSPæ³•ä¸­å…³é”®æ€§çš„ä¼ä¸šèµ„æºæ˜¯äº§å“ä¸æœåŠ¡ã€‚ 11.ä¼ä¸šè¿‡ç¨‹å®šä¹‰çš„ä¸€ä¸ªæ­¥éª¤æ˜¯æ”¯æŒèµ„æºè¯†åˆ«ä¼ä¸šè¿‡ç¨‹ã€‚ 12.ä¼ä¸šèµ„æºçš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µåˆ†ä¸ºéœ€æ±‚ã€è·å–ã€æœåŠ¡ã€é€€å‡ºã€‚ 13.åœ¨å®šä¹‰ä¼ä¸šè¿‡ç¨‹ä¸­ï¼Œç”Ÿå‘½å‘¨æœŸæ˜¯æŒ‡ä¸€é¡¹èµ„æºç”±å–å¾—åˆ°é€€å‡ºè¿‡ç¨‹æ‰€ç»ç†çš„é˜¶æ®µã€‚ 14.ä¼ä¸šèµ„æºä¸­ä¸ä»¥å…·ä½“å½¢å¼å­˜åœ¨çš„â€œèµ„æºâ€æ˜¯ä¼ä¸šçš„è®¡åˆ’ä¸æ§åˆ¶ã€‚ 15.ä¼ä¸šç³»ç»Ÿè§„åˆ’ï¼ˆBSPï¼‰å®šä¹‰çš„ä¼ä¸šèµ„æºä¸­æœ‰ä¸€ç±»ä¸ä»¥å…·ä½“äº§å“å½¢å¼å­˜åœ¨çš„èµ„æºï¼Œå°±æ˜¯ä¼ä¸šçš„è®¡åˆ’ä¸æ§åˆ¶ã€‚ 16.BSPæ³•å®šä¹‰çš„ä¼ä¸šèµ„æºä¸­æœ‰ä¸€ç±»ä¸ä»¥å…·ä½“äº§å“å½¢å¼å­˜åœ¨çš„èµ„æºï¼Œå°±æ˜¯è®¡åˆ’ä¸æ§åˆ¶ã€‚ 17.ä¼ä¸šå†…çš„æ”¯æŒæ€§èµ„æºã€‚ æ”¯æŒæ€§èµ„æºæ˜¯æŒ‡ä¸ºå®ç°ä¼ä¸šç›®æ ‡å¿…é¡»ä½¿ç”¨ã€å¼•ç”¨å’Œæ¶ˆè€—çš„é‚£äº›èµ„æºï¼Œå¦‚åŸææ–™ã€èµ„é‡‘ã€è®¾å¤‡äººå‘˜ç­‰ã€‚ 18.ç®€è¿°BSPæ³•ä¸­ä¼ä¸šè¿‡ç¨‹å®šä¹‰ï¼ˆè¯†åˆ«ï¼‰çš„ä¸€èˆ¬æ­¥éª¤ã€‚ 1.ä»è®¡åˆ’/æ§åˆ¶èµ„æºç€æ‰‹ã€‚å¯ä»¥è¯†åˆ«å‡ºä¼ä¸šæˆ˜ç•¥è§„åˆ’ä¸ç®¡ç†æ§åˆ¶ä¸¤ä¸ªå±‚æ¬¡çš„è¿‡ç¨‹ã€‚2.è¯†åˆ«äº§å“/æœåŠ¡è¿‡ç¨‹ã€‚æ ¹æ®å…¶éœ€æ±‚ã€è·å–ã€æœåŠ¡ã€é€€å‡º4é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸï¼Œå¯¹æ¯ä¸€é˜¶æ®µï¼Œç”¨ä¸€äº›è¿‡ç¨‹è¿›è¡Œç®¡ç†ã€‚3.ä»æ”¯æŒæ€§èµ„æºè¯†åˆ«ä¼ä¸šè¿‡ç¨‹ã€‚å…¶æ–¹æ³•ä¸äº§å“/æœåŠ¡è¯†åˆ«çš„è¿‡ç¨‹ç±»ä¼¼ã€‚ 19.åè¯è§£é‡Šï¼šèµ„æºçš„ç”Ÿå‘½å‘¨æœŸ èµ„æºçš„ç”Ÿå‘½å—æ°”å¯ä»¥ç”¨æ¥ä½œä¸ºç ”ç©¶ä¼ä¸šè¿‡ç¨‹çš„ä¸€ç§æ‰‹æ®µã€‚æ‰€è°“ç”Ÿå‘½å‘¨æœŸæ˜¯æŒ‡ä¸€é¡¹èµ„æºç”±å–å¾—åˆ°é€€å‡ºè¿‡ç¨‹æ‰€ç»ç†çš„é˜¶æ®µã€‚ä¸€èˆ¬åˆ’åˆ†æ–¹æ³•å¯åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼Œå„ä¸ªé˜¶æ®µåˆ†åˆ«ä¸ºï¼šéœ€æ±‚ã€è·å–ã€æœåŠ¡ã€é€€å‡ºã€‚ 20.åè¯è§£é‡Šï¼šBSPæ–¹æ³•ä¸­çš„ä¼ä¸šèµ„æºã€‚ BSPæ–¹æ³•ä¸­çš„ä¼ä¸šèµ„æºåŒ…æ‹¬ä¼ä¸šçš„è®¡åˆ’ä¸æ§åˆ¶ã€äº§å“ä¸æœåŠ¡ï¼ˆå…³é”®æ€§èµ„æºï¼‰å’Œæ”¯æŒæ€§èµ„æºã€‚ 21.ç®€è¿°ä¼ä¸šçš„ä¸‰ç§èµ„æºã€‚ 1.ä¼ä¸šå†…çš„èµ„æºå¯åˆ†ä¸ºå…³é”®æ€§èµ„æºå’Œæ”¯æŒæ€§èµ„æºï¼Œè¿˜æœ‰ä¸€ç±»ä¸ä»¥å…·ä½“äº§å“å½¢å¼å­˜åœ¨çš„â€œèµ„æºâ€ï¼Œé‚£å°±æ˜¯ä¼ä¸šçš„è®¡åˆ’ä¸æ§åˆ¶ï¼›2.å…³é”®æ€§èµ„æºæ˜¯æŒ‡ä¼ä¸šä¸­äº§å“ä¸æœåŠ¡ï¼›3.æ”¯æŒæ€§èµ„æºæ˜¯æŒ‡ä¸ºå®ç°ä¼ä¸šç›®æ ‡å¿…é¡»ä½¿ç”¨ã€å¼•ç”¨å’Œæ¶ˆè€—çš„é‚£äº›èµ„æºã€‚ å®šä¹‰æ•°æ®ç±» 1.BSPæ³•å°†ä¼ä¸šæ•°æ®åˆ†ä¸ºå››ç§ç±»å‹ï¼Œå®ƒä»¬æ˜¯ï¼ˆDï¼‰ A äº‹åŠ¡å‹ã€ç®¡ç†æ§åˆ¶å‹ã€å†³ç­–å‹ã€ç»¼åˆå‹ B äº‹ç‰©å‹ã€ç»Ÿè®¡å‹ã€æŠ¥å‘Šå‹ã€è®¡åˆ’å‹ C åº“å­˜æ–‡æ¡£å‹ã€åˆ†æå‹ã€ç»Ÿè®¡å‹ã€è®¡åˆ’å‹ D è®¡åˆ’å‹ã€äº‹ç‰©å‹ã€ç»Ÿè®¡å‹ã€åº“å­˜æ–‡æ¡£å‹ 2.ä¼ä¸šç¨ååˆ©æ¶¦å±äºï¼ˆCï¼‰ A è®¡åˆ’å‹æ•°æ® B äº‹ç‰©å‹æ•°æ® C ç»Ÿè®¡å‹æ•°æ® D åº“å­˜æ–‡æ¡£å‹æ•°æ® 3.æœ‰ä¸€ç±»ä¼ä¸šæ•°æ®èƒ½å¤Ÿåæ˜ èµ„æºç”Ÿå‘½å‘¨æœŸå„ä¸ªé˜¶æ®µè¿‡æ¸¡è¿‡ç¨‹çš„ç›¸å…³å˜åŒ–ï¼Œå®ƒå±äºï¼ˆBï¼‰ A åº“å­˜æ–‡æ¡£å‹æ•°æ®ç±» B äº‹ç‰©å‹æ•°æ®ç±» C è®¡åˆ’å‹æ•°æ®ç±» D ç»Ÿè®¡å‹æ•°æ®ç±» 4.åæ˜ ä¼ä¸šçŠ¶å†µå¹¶æä¾›æŸäº›åé¦ˆä¿¡æ¯çš„ä¼ä¸šæ•°æ®å±äºï¼ˆDï¼‰ A åº“å­˜æ–‡æ¡£å‹æ•°æ® B äº‹ç‰©å‹æ•°æ® C è®¡åˆ’å‹æ•°æ® D ç»Ÿè®¡å‹æ•°æ® 5.ä¼ä¸šæ•°æ®çš„å››ç§ç±»å‹ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A è®¡åˆ’å‹ B äº‹ç‰©å‹ C åº“å­˜æ–‡æ¡£å‹ D æ•°æ®å‹ 6.ä¼ä¸šæ•°æ®åˆ†æˆ4ä¸­ç±»å‹ï¼Œå³äº‹ç‰©å‹ã€è®¡åˆ’å‹ã€ç»Ÿè®¡å‹å’Œåº“å­˜æ–‡æ¡£å‹æ•°æ®ã€‚ 7.ä¼ä¸šæ•°æ®çš„æ–¹æ³•æœ‰ä¼ä¸šå®ä½“æ³•å’Œä¼ä¸šè¿‡ç¨‹æ³•ã€‚ 8.BSPæ³•å°†ä¼ä¸šæ•°æ®åˆ†ä¸ºè®¡åˆ’å‹ã€äº‹ç‰©å‹ã€ç»¼åˆç»Ÿè®¡å‹å’Œåº“å­˜æ–‡æ¡£å‹4ç§ç±»å‹ã€‚ 9.BSPæ³•ä¸­ä¼ä¸šæ•°æ®åˆ†æˆ4ä¸­ç±»å‹ï¼Œå³äº‹ç‰©å‹ã€è®¡åˆ’å‹ã€ç»Ÿè®¡å‹å’Œåº“å­˜æ–‡æ¡£å‹æ•°æ®ã€‚ 10.è¯†åˆ«ä¼ä¸šæ•°æ®çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼šä¼ä¸šå®ä½“æ³•å’Œä¼ä¸šè¿‡ç¨‹æ³•ã€‚ 11.ç®€è¿°BSPæ³•ä¸­æŒ‰èµ„æºç”Ÿå‘½å‘¨æœŸä¸åŒé˜¶æ®µéœ€æ±‚å®šä¹‰çš„4ä¸­æ•°æ®ç±»å‹ã€‚ åº“å­˜æ–‡æ¡£å‹ã€äº‹ç‰©å‹ã€è®¡åˆ’å‹å’Œç»¼åˆç»Ÿè®¡å‹ã€‚ 12.åè¯è§£é‡Šï¼šè®¡åˆ’å‹æ•°æ®ç±» è®¡åˆ’å‹æ•°æ®ç±»æ˜¯ä¼ä¸šæ•°æ®çš„ä¸€ç§ç±»å‹ã€‚è®¡åˆ’å‹æ•°æ®ç±»åæ˜ çš„å†…å®¹ï¼šåæ˜ ç›®æ ‡ã€èµ„æºã€è½¬åŒ–è¿‡ç¨‹ç­‰è®¡åˆ’å€¼ï¼›è®¡åˆ’å‹æ•°æ®ç±»çš„ç‰¹ç‚¹ï¼š1.å¯é¥ä¸å¤šä¸ªåº“å­˜å‹æ•°æ®æœ‰å…³ï¼›2.å„ç§è®¡åˆ’ã€é¢„æµ‹ã€é¢„ç®—ã€è°ƒåº¦è¡¨ç­‰ã€‚ 13.åè¯è§£é‡Šï¼šè¯†åˆ«ä¼ä¸šæ•°æ®çš„ä¼ä¸šè¿‡ç¨‹æ³•ã€‚ ä¼ä¸šè¿‡ç¨‹æ³•æ˜¯åˆ©ç”¨ä»¥å‰è¯†åˆ«çš„ä¼ä¸šè¿‡ç¨‹ï¼Œåˆ†ææ¯ä¸€ä¸ªè¿‡ç¨‹åˆ©ç”¨ä»€ä¹ˆæ•°æ®ï¼Œäº§ç”Ÿä»€ä¹ˆæ•°æ®ï¼Œæˆ–è€…è¯´æ¯ä¸ªè¿‡ç¨‹çš„è¾“å…¥å’Œè¾“å‡ºæ•°æ®æ˜¯ä»€ä¹ˆã€‚ä¸»è¦å·¥å…·æ˜¯è¿‡ç¨‹/æ•°æ®çŸ©é˜µã€‚ 14.åè¯è§£é‡Šï¼šç»Ÿè®¡å‹æ•°æ®ç±» åæ˜ ä¼ä¸šçŠ¶å†µï¼Œæä¾›æŸäº›åé¦ˆä¿¡æ¯ã€‚ç‰¹ç‚¹ï¼š1.ä¸€èˆ¬æ¥è‡ªå…¶ä»–ç±»å‹æ•°æ®ç±»çš„é‡‡æ ·ï¼›2.å†å²æ€§ã€å¯¹ç…§è¡Œæˆ–è¯„ä»·è¡Œçš„å‚è€ƒæ•°æ®ï¼›3.æ•°æ®çš„ç»¼åˆæ€§å¼ºã€‚ 15.åè¯è§£é‡Šï¼šä¼ä¸šè¿‡ç¨‹æ³• ä¼ä¸šè¿‡ç¨‹æ³•æ˜¯åˆ©ç”¨ä»¥å‰è¯†åˆ«çš„ä¼ä¸šè¿‡ç¨‹ï¼Œåˆ†ææ¯ä¸€ä¸ªè¿‡ç¨‹åˆ©ç”¨äº†ä»€ä¹ˆæ•°æ®ï¼Œäº§ç”Ÿä»€ä¹ˆæ•°æ®ï¼Œæˆ–è€…è¯´æ¯ä¸€è¿‡ç¨‹çš„è¾“å…¥å’Œè¾“å‡ºæ•°æ®æ˜¯ä»€ä¹ˆã€‚ 16.åè¯è§£é‡Šï¼šä¼ä¸šå®ä½“æ³• ä¼ä¸šçš„å®ä½“æ˜¯æŒ‡é¡¾å®¢ã€äº§å“ã€ææ–™åŠäººå‘˜ç­‰ä¼ä¸šä¸­å®¢è§‚å­˜åœ¨çš„ä¸œè¥¿ï¼Œè”ç³»äºæ¯ä¸ªå®ä½“çš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µå°±æœ‰å„ç§æ•°æ®ï¼Œå¦‚äº‹ç‰©å‹ã€è®¡åˆ’å‹å’Œç»Ÿè®¡å‹ç­‰ã€‚ è®¾è®¡ç³»ç»Ÿæ€»ä½“ç»“æ„ä¸å¼€å‘é¡ºåº 1.ç¡®å®šå­ç³»ç»Ÿå¼€å‘ä¼˜å…ˆé¡ºåºçš„ä¸€ä¸ªåŸºæœ¬åŸåˆ™æ˜¯æ ¹æ®ï¼ˆCï¼‰ A å­ç³»ç»Ÿçš„è§„æ¨¡å¤§å° B å­ç³»ç»Ÿçš„å¤æ‚ç¨‹åº¦ C å­ç³»ç»Ÿéœ€æ±‚ç¨‹åº¦äºæ•ˆç›Šçš„è¯„ä¼° D ç³»ç»Ÿå¼€å‘è€…çš„ç»éªŒä¸åå¥½ 2.U/CçŸ©é˜µï¼ˆå›¾ï¼‰ä¸­æŸå•å…ƒæ ¼çš„Uè¡¨ç¤ºï¼ˆBï¼‰ A å•å…ƒæ ¼å¯¹åº”çš„ä¼ä¸šè¿‡ç¨‹ä½¿ç”¨å¯¹åº”çš„æ•°æ®ç±» B å•å…ƒæ ¼å¯¹åº”çš„ä¼ä¸šè¿‡ç¨‹äº§ç”Ÿå¯¹åº”çš„æ•°æ®ç±» C å•å…ƒæ ¼å¯¹åº”çš„æ•°æ®ç±»ä½¿ç”¨å¯¹åº”çš„ä¼ä¸šè¿‡ç¨‹ D å•å…ƒæ ¼å¯¹åº”çš„æ•°æ®ç±»ç”Ÿæˆå¯¹åº”çš„ä¼ä¸šè¿‡ç¨‹ 3.æ€»ä½“è§„åˆ’é˜¶æ®µç¡®å®šå­ç³»ç»Ÿåˆ’åˆ†çš„åŸºæœ¬åŸåˆ™ï¼Œæè¿°é”™è¯¯çš„æ˜¯ï¼ˆDï¼‰ A å­ç³»ç»Ÿåœ¨åŠŸèƒ½ä¸Šåº”æœ‰ç›¸å¯¹çš„ç‹¬ç«‹æ€§ B é€šå¸¸å­ç³»ç»Ÿå¯ä»¥è·¨è¶Šä¸¤ä¸ªä»¥ä¸Šçš„ä¼ä¸šè¿‡ç¨‹ C å­ç³»ç»Ÿåœ¨æ•°æ®ä¸Šåº”æœ‰è‡ªèº«çš„å®Œæ•´æ€§ D ä¸€èˆ¬ä¸€ä¸ªæ•°æ®ç±»åªèƒ½ç”±ä¸€ä¸ªå­ç³»ç»Ÿäº§ç”Ÿ 4.åˆ’åˆ†å­ç³»ç»Ÿé‡‡ç”¨ï¼ˆAï¼‰çš„æ–¹å¼ A U/Cå›¾ B æ•°æ®æµå›¾ C ä¸šåŠ¡æµç¨‹å›¾ D å®ä½“è”ç³»å›¾ 5.å­ç³»ç»Ÿä¸æ•°æ®ç±»çš„æ­£ç¡®å…³ç³»æ˜¯ï¼ˆBï¼‰ A ä¸€ä¸ªå­ç³»ç»ŸèŒèƒ½äº§ç”Ÿä¸€ä¸ªæ•°æ®ç±» B ä¸€ä¸ªæ•°æ®ç±»èŒèƒ½ç”±ä¸€ä¸ªå­ç³»ç»Ÿäº§ç”Ÿ C ä¸€ä¸ªå­ç³»ç»ŸèŒèƒ½æ¥å—ä¸€ä¸ªæ•°æ®ç±» D ä¸€ä¸ªæ•°æ®ç±»èŒèƒ½ä¹¦é¦™ä¸€ä¸ªå­ç³»ç»Ÿ 6.æ€»ä½“è§„åˆ’é˜¶æ®µç¡®å®šå­ç³»ç»Ÿå¼€å‘ä¼˜å…ˆé¡ºåºæè¿°ä¸æ­£ç¡®çš„æ˜¯ï¼ˆDï¼‰ A å­ç³»ç»Ÿéœ€æ±‚ç¨‹åº¦ä¸æ½œåœ¨æ•ˆç›Šçš„è¯„ä¼° B è¿›è¡ŒæŠ€æœ¯çº¦æŸåˆ†æ C æŒ‰ç¡®å®šçš„è¯„ä¼°å‡†åˆ™å¯¹æ¯ä¸ªå­ç³»ç»Ÿè¿›è¡Œè¯„ä¼° D å®é™…å·¥ä½œä¸­ï¼Œé‡‡ç”¨æµç¨‹å›¾æ–¹å¼è¿›è¡Œåˆ’åˆ† 7.ç¡®å®šå­ç³»ç»Ÿå¼€å‘ä¼˜å…ˆé¡ºåºçš„ä¸€ä¸ªé‡è¦åŸåˆ™æ˜¯æ ¹æ®å­ç³»ç»Ÿçš„éœ€æ±‚è¿«åˆ‡æ€§å’Œæ½œåœ¨æ•ˆç›Šé«˜ä½ã€‚ 8.å­ç³»ç»Ÿä¸æ•°æ®ç±»çš„æ­£ç¡®å…³ç³»æ˜¯ä¸€ä¸ªæ•°æ®ç±»ç”±ä¸€ä¸ªå­ç³»ç»Ÿäº§ç”Ÿã€‚ 9.ç®€è¿°BSPæ³•ä¸­å­ç³»ç»Ÿåˆ’åˆ†çš„æ–¹æ³• åœ¨BSPæ–¹æ³•ä¸­ï¼Œåˆ’åˆ†å­ç³»ç»Ÿçš„è¿‡ç¨‹å®é™…ä¸Šå°±æ˜¯å®šä¹‰ä¿¡æ¯ç»“æ„çš„è¿‡ç¨‹ã€‚å…·ä½“çš„åšæ³•æ˜¯ç”¨U/Cå›¾ï¼ŒUè¡¨ç¤ºä½¿ç”¨ï¼ŒCè¡¨ç¤ºäº§ç”Ÿã€‚U/Cå›¾çš„å·¦åˆ—æ˜¯ä¼ä¸šè¿‡ç¨‹ï¼Œæœ€ä¸Šä¸€è¡Œåˆ—å‡ºæ•°æ®ã€‚å¦‚æœæŸè¿‡ç¨‹äº§ç”ŸæŸæ•°æ®ï¼Œå°±åœ¨çŸ©é˜µæŸè¡ŒæŸåˆ—ä¸­å†™Cã€‚å¦‚æœæŸè¿‡ç¨‹ä½¿ç”¨æ•°æ®ï¼Œåˆ™åœ¨å…¶å¯¹åº”çš„å•å…ƒä¸­å†™Uã€‚å¼€å§‹æ—¶æ•°æ®ç±»å’Œè¿‡ç¨‹æ—¶éšæœºæ’åˆ—çš„ï¼›Uã€Cåœ¨çŸ©é˜µä¸­æ’åˆ—ä¹Ÿæ˜¯åˆ†æ•£çš„ã€‚æˆ‘ä»¬ä»¥è°ƒæ¢è¿‡ç¨‹å’Œæ•°æ®ç±»çš„é¡ºåºçš„æ–¹æ³•ï¼Œå°½é‡ä½¿Uã€Cé›†ä¸­åœ¨å¯¹è§’çº¿ä¸Šæ’åˆ—ã€‚ç„¶åæŠŠUã€Cæ¯”è¾ƒé›†ä¸­çš„åŒºåŸŸç”¨ç²—çº¿æ¡æ¡†èµ·æ¥ï¼Œè¿™æ ·å½¢æˆçš„ç‹‚å°±æ˜¯ä¸€ä¸ªä¸ªå­ç³»ç»Ÿã€‚åœ¨ç²—çº¿æ¡†å¤–çš„Uè¡¨ç¤ºä¸€ä¸ªç³»ç»Ÿç”¨å¦ä¸€ä¸ªç³»ç»Ÿçš„æ•°æ®ï¼Œå›¾ä¸­ç”¨å¸¦ç®­å¤´çš„çº¿è¡¨ç¤ºã€‚è¿™æ ·å°±å®Œæ•´äº†å­ç³»ç»Ÿçš„åˆ’åˆ†ï¼Œå³ç¡®å®šäº†ä¿¡æ¯ç»“æ„çš„ä¸»æµã€‚ 10.ç®€è¿°åœ¨æ€»ä½“è§„åˆ’é˜¶æ®µç¡®å®šå­ç³»ç»Ÿåˆ’åˆ†å’Œå¼€å‘ä¼˜å…ˆé¡ºåºçš„åŸºæœ¬åŸåˆ™ å­ç³»ç»Ÿåˆ’åˆ†çš„åŸºæœ¬åŸåˆ™ï¼š1.å­ç³»ç»Ÿåœ¨åŠŸèƒ½ä¸Šåº”æœ‰ç›¸å¯¹çš„ç‹¬ç«‹æ€§ï¼›2.å­ç³»ç»Ÿåœ¨æ•°æ®ä¸Šåº”æœ‰è‡ªèº«çš„å®Œæ•´æ€§ã€‚å¼€å‘ä¼˜å…ˆé¡ºåºçš„åŸºæœ¬åŸåˆ™ï¼š1.å­ç³»ç»Ÿéœ€æ±‚ç¨‹åº¦ä¸æ½œåœ¨æ•ˆç›Šçš„è¯„ä¼°ï¼›2.æŠ€æœ¯çº¦æŸåˆ†æã€‚ 11.ç®€è¿°é‡‡ç”¨U/CçŸ©é˜µåˆ’åˆ†å­ç³»ç»Ÿçš„æ­¥éª¤ 1.å»ºç«‹åˆæ­¥U/CçŸ©é˜µï¼›2.å¯¹åˆæ­¥U/CçŸ©é˜µè¿›è¡Œè¡Œåˆ—å˜æ¢ï¼›3.ç”¨ç®­å¤´æè¿°å­ç³»ç»Ÿé—´çš„æ•°æ®å…³ç³»ã€‚ 12.é‡‡ç”¨U/CçŸ©é˜µå›¾çš„æ–¹å¼è¿›è¡Œå­ç³»ç»Ÿåˆ’åˆ†ï¼Œä¸€èˆ¬åŒ…æ‹¬å“ªäº›æ­¥éª¤ï¼Ÿ 1.å»ºç«‹åˆæ­¥U/CçŸ©é˜µï¼Œæ ¹æ®è°ƒæŸ¥ç»“æœå»ºç«‹ä¼ä¸šè¿‡ç¨‹å’Œæ•°æ®ç±»çš„å¯¹åº”å…³ç³»ï¼›2.å¯¹åˆæ­¥U/CçŸ©é˜µè¿›è¡Œè¡Œåˆ—å˜æ¢ï¼Œå½¢æˆåˆæ­¥çš„å­ç³»ç»Ÿï¼›3.ç”¨ç®­å¤´æè¿°å­ç³»ç»Ÿé—´çš„æ•°æ®å…³ç³»ã€‚ 13.åè¯è§£é‡Šï¼šU/CçŸ©é˜µ U/CçŸ©é˜µæ˜¯ç”¨æ¥è¡¨è¾¾è¿‡ç¨‹ä¸æ•°æ®ä¸¤è€…ä¹‹é—´çš„å…³ç³»çš„çŸ©é˜µã€‚ç”¨Uè¡¨ç¤ºè¿‡ç¨‹å¯¹æ•°æ®ç±»çš„ä½¿ç”¨ï¼Œç”¨Cè¡¨ç¤ºè¿‡ç¨‹å¯¹æ•°æ®ç±»çš„äº§ç”Ÿã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äº”ç« _ç³»ç»Ÿåˆ†æ/ç¬¬ä¸€èŠ‚_ç³»ç»Ÿåˆ†ææ¦‚è®º.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äº”ç« _ç³»ç»Ÿåˆ†æ/ç¬¬ä¸€èŠ‚_ç³»ç»Ÿåˆ†ææ¦‚è®º.html","title":"ç¬¬ä¸€èŠ‚ï¼šç³»ç»Ÿåˆ†ææ¦‚è®º","keywords":"","body":"ç¬¬ä¸€èŠ‚ï¼šç³»ç»Ÿåˆ†ææ¦‚è®º ç³»ç»Ÿåˆ†æçš„ç›®çš„ä¸éš¾ç‚¹ 1.å…³äºç³»ç»Ÿåˆ†æçš„å¯¹ç­–ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A åšå¥½ç”¨æˆ·äº‹å‰åŸ¹è®­å·¥ä½œ B åšå¥½ç³»ç»Ÿå¼€å‘äººå‘˜çš„åŸ¹è®­å·¥ä½œ C é€‰æ‹©æ­£ç¡®çš„å¼€å‘æ–¹æ³•å’Œè‰¯å¥½çš„è¡¨è¾¾å·¥å…· D åªéœ€å¯¹ç”¨æˆ·çš„åŸ¹è®­ç®¡ç†ä¿¡æ¯ç³»ç»Ÿæ–¹é¢çš„çŸ¥è¯† 2.ç¡®å®šæ–°ç³»ç»Ÿåˆæ­¥çš„é€»è¾‘æ¨¡å‹ï¼Œå±äºç³»ç»Ÿå¼€å‘çš„é˜¶æ®µæ˜¯ï¼ˆBï¼‰ A ç³»ç»Ÿè§„åˆ’ B ç³»ç»Ÿåˆ†æ C ç³»ç»Ÿè®¾è®¡ D ç³»ç»Ÿç»´æŠ¤ 3.ä»ç³»ç»Ÿå¼€å‘çš„é˜¶æ®µåˆ’åˆ†æ¥çœ‹ï¼Œç³»ç»Ÿè®¾è®¡çš„å‰ä¸€é˜¶æ®µæ˜¯ï¼ˆBï¼‰ A ç³»ç»Ÿè§„åˆ’ B ç³»ç»Ÿåˆ†æ C ç³»ç»Ÿè¿è¡Œ D ç³»ç»Ÿå®æ–½ 4.ä»¥ä¸‹å±äºç»“æ„æ–¹æ³•å¼€å‘è¿‡ç¨‹çš„ç³»ç»Ÿåˆ†æé˜¶æ®µçš„å·¥ä½œæ˜¯ï¼ˆC) A ç¡®å®šç³»ç»Ÿç›®æ ‡ B è¯„ä»·ç³»ç»Ÿç»æµæ•ˆæœ C å»ºç«‹ç³»ç»Ÿé€»è¾‘æ¨¡å‹ D ç¡®å®šç³»ç»Ÿæ¨¡å—ç»“æ„ 5.å±äºç³»ç»Ÿåˆ†æä»»åŠ¡çš„æœ‰ï¼ˆAï¼‰ A è¯¦ç»†è°ƒæŸ¥æ”¶é›†å’Œåˆ†æç”¨æˆ·éœ€æ±‚ B å»ºç«‹è¿‡ç¨‹æ•°æ®çŸ©é˜µ C è®¾è®¡ä¿¡æ¯ç³»ç»Ÿæ€»ä½“ç»“æ„ D ç¡®å®šç³»ç»Ÿå»ºè®¾ç›®æ ‡ 6.ç³»ç»Ÿåˆ†æä»»åŠ¡ä¸åŒ…æ‹¬ï¼ˆBï¼‰ A è¯¦ç»†è°ƒæŸ¥æ”¶é›†å’Œåˆ†æç”¨æˆ·éœ€æ±‚ B è¿›è¡Œä¸šåŠ¡æµç¨‹åˆ†æ C ç¡®å®šæ–°ç³»ç»Ÿåˆæ­¥çš„é€»è¾‘æ¨¡å‹ D ç¼–åˆ¶ç³»ç»Ÿè¯´æ˜ä¹¦ 7.ç³»ç»Ÿåˆ†æçš„å·¥ä½œæˆæœæ˜¯ç³»ç»Ÿè®¾è®¡å’Œç³»ç»Ÿå®æ–½çš„ä¾æ®ã€‚ 8.ç³»ç»Ÿåˆ†æä¹Ÿç§°ä¸ºç³»ç»Ÿé€»è¾‘è®¾è®¡ã€‚ 9.å¼€å±•ç³»ç»Ÿåˆ†æå·¥ä½œçš„å…³é”®ç‚¹æˆ–ç§°å·¥ä½œè¦ç‚¹æ˜¯ç†è§£å’Œè¡¨è¾¾ç”¨æˆ·çš„éœ€æ±‚ï¼ˆæˆ–éœ€è¦ï¼‰ã€‚ 10.ç³»ç»Ÿåˆ†ææ—¨åœ¨è·å¾—ä¸€ä¸ªåˆç†çš„æ–°ç³»ç»Ÿçš„é€»è¾‘æ¨¡å‹ï¼Œä¸ºåä¸€é˜¶æ®µçš„ç³»ç»Ÿè®¾è®¡æä¾›è¯¦ç»†çš„å¼€å‘æ–¹æ¡ˆã€‚ 11.ç³»ç»Ÿåˆ†æçš„ç›®çš„æ˜¯å°†ç”¨æˆ·çš„éœ€æ±‚åŠå…¶è§£å†³æ–¹æ¡ˆç¡®å®šä¸‹æ¥ã€‚ 12.ç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦ä»»åŠ¡åŒ…æ‹¬ï¼šè¯¦ç»†è°ƒæŸ¥ã€æ”¶é›†å’Œåˆ†æç”¨æˆ·éœ€æ±‚ï¼Œç¡®å®šæ–°ç³»ç»Ÿåˆæ­¥çš„é€»è¾‘æ¨¡å‹ï¼Œç¼–åˆ¶ç³»ç»Ÿè¯´æ˜è¯´ã€‚ 13.ç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦ä»»åŠ¡åŒ…æ‹¬ï¼šè¯¦ç»†è°ƒæŸ¥æ”¶é›†å’Œåˆ†æç”¨æˆ·éœ€æ±‚ï¼Œç¡®å®šæ–°ç³»ç»Ÿåˆæ­¥çš„é€»è¾‘æ¨¡å‹ï¼Œç¼–åˆ¶ç³»ç»Ÿè¯´æ˜ä¹¦ã€‚ 14.ç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦ä»»åŠ¡ï¼šè¯¦ç»†è°ƒæŸ¥ã€æ”¶é›†å’Œåˆ†æç”¨æˆ·éœ€æ±‚ï¼Œç¡®å®šæ–°ç³»ç»Ÿåˆæ­¥çš„é€»è¾‘æ¨¡å‹ï¼Œç¼–åˆ¶ç³»ç»Ÿè¯´æ˜ä¹¦ã€‚ 15.åè¯è§£é‡Šï¼šä¿¡æ¯ç³»ç»Ÿçš„é€»è¾‘æ¨¡å‹ã€‚ é€»è¾‘æ¨¡å‹æ˜¯æŒ‡ä»…åœ¨é€»è¾‘ä¸Šç¡®å®šçš„æ–°ç³»ç»Ÿæ¨¡å‹ï¼Œè€Œä¸æ¶‰åŠå…·ä½“çš„ç‰©ç†å®ç°ï¼Œä¹Ÿå°±æ˜¯è¦è§£å†³ç³»ç»Ÿâ€œå¹²ä»€ä¹ˆâ€ï¼Œè€Œä¸æ˜¯â€œå¦‚ä½•å¹²â€ã€‚é€»è¾‘æ¨¡å‹ç”±ä¸€ç»„å›¾è¡¨å·¥å…·è¿›è¡Œæè¿°ã€‚ 16.å…³äºç³»ç»Ÿåˆ†æçš„å·¥ä½œéš¾ç‚¹ä¸å¯¹ç­–ï¼ŒåŸºæœ¬å¯¹ç­–è€ƒè™‘å“ªäº›æ–¹é¢ï¼Ÿ 1.åšå¥½ç”¨æˆ·äº‹å‰åŸ¹è®­å·¥ä½œï¼›2.åšå¥½ç³»ç»Ÿå¼€å‘äººå‘˜çš„åŸ¹è®­å·¥ä½œï¼›3.é€‰æ‹©æ­£ç¡®çš„å¼€å‘æ–¹æ³•å’Œè‰¯å¥½çš„è¡¨è¾¾å·¥å…·ã€‚ 17.ç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦ä»»åŠ¡ã€‚ 1.è¯¦ç»†è°ƒæŸ¥æ”¶é›†å’Œåˆ†æç”¨æˆ·éœ€æ±‚ï¼›2.ç¡®å®šæ–°ç³»ç»Ÿåˆæ­¥çš„é€»è¾‘æ¨¡å‹ï¼›3.ç¼–åˆ¶ç³»ç»Ÿè¯´æ˜ä¹¦ã€‚ ç³»ç»Ÿåˆ†æçš„é€»è¾‘ä¸æ­¥éª¤ 1.ï¼ˆAï¼‰æ¨¡å‹åæ˜ äº†ç³»ç»Ÿçš„æ€§è´¨ã€‚ A é€»è¾‘ B ç‰©ç† C è™šæ‹Ÿ D æ ‡å‡† 2.äº§ç”Ÿæ•°æ®æµå›¾çš„é˜¶æ®µæ˜¯ï¼ˆDï¼‰ A ç³»ç»Ÿè§„åˆ’ B ç³»ç»Ÿè®¾è®¡ C ç³»ç»Ÿå®æ–½ D ç³»ç»Ÿåˆ†æ 3.ç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦å·¥ä½œæœ‰ï¼ˆBï¼‰ A ç³»ç»Ÿæ€»ä½“è®¾è®¡ B ç¼–å†™ç³»ç»Ÿè®¾è®¡è¯´æ˜ä¹¦ C ä¸šåŠ¡æµç¨‹åˆ†æ D ç³»ç»Ÿè¯¦ç»†è®¾è®¡ 4.åœ¨ç»“æ„åŒ–æ–¹æ³•ä¸­ï¼Œç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦å·¥ä½œæ­¥éª¤æœ‰ï¼šè¯¦ç»†è°ƒæŸ¥ã€ä¸šåŠ¡æµç¨‹åˆ†æã€æ•°æ®æµç¨‹åˆ†æå’Œç¼–å†™ç³»ç»Ÿåˆ†æè¯´æ˜ä¹¦ã€‚ 5.é€»è¾‘æ¨¡å‹å’Œç‰©ç†æ¨¡å‹çš„ä¸»è¦å·®åˆ«æ˜¯åšä»€ä¹ˆå’Œå¦‚ä½•åšçš„å·®åˆ«ã€‚ 6.ç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦å·¥ä½œæ­¥éª¤æœ‰ï¼šè¯¦ç»†è°ƒæŸ¥ã€ä¸šåŠ¡æµç¨‹åˆ†æã€æ•°æ®æµç¨‹åˆ†æå’Œç¼–å†™ç³»ç»Ÿåˆ†æè¯´æ˜ä¹¦ã€‚ 7.é€»è¾‘æ¨¡å‹å’Œç‰©ç†æ¨¡å‹çš„ä¸»è¦å·®åˆ«æ˜¯åšä»€ä¹ˆå’Œå¦‚ä½•åšçš„å·®åˆ«ã€‚ 8.ç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦å·¥ä½œæ­¥éª¤åŒ…æ‹¬ï¼šè¯¦ç»†è°ƒæŸ¥ã€ä¸šåŠ¡æµç¨‹åˆ†æã€æ•°æ®æµç¨‹åˆ†æå’Œç¼–å†™ç³»ç»Ÿåˆ†æè¯´æ˜ä¹¦ã€‚ 9.ç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦å·¥ä½œæ­¥éª¤ã€‚ åœ¨ç»“æ„åŒ–æ–¹æ³•ä¸­ï¼Œç³»ç»Ÿåˆ†æé˜¶æ®µçš„ä¸»è¦å·¥ä½œæ­¥éª¤æœ‰ï¼šè¯¦ç»†è°ƒæŸ¥ã€ä¸šåŠ¡æµç¨‹åˆ†æã€æ•°æ®æµç¨‹åˆ†æå’Œç¼–å†™ç³»ç»Ÿåˆ†æè¯´æ˜ä¹¦ã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äº”ç« _ç³»ç»Ÿåˆ†æ/ç¬¬äºŒèŠ‚_è¯¦ç»†è°ƒæŸ¥.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äº”ç« _ç³»ç»Ÿåˆ†æ/ç¬¬äºŒèŠ‚_è¯¦ç»†è°ƒæŸ¥.html","title":"ç¬¬äºŒèŠ‚ï¼šè¯¦ç»†è°ƒæŸ¥","keywords":"","body":"ç¬¬äºŒèŠ‚ï¼šè¯¦ç»†è°ƒæŸ¥ è¯¦ç»†è°ƒæŸ¥çš„ç›®çš„å’Œéš¾ç‚¹ 1.éœ€è¦ææ¸…æ¥šç”¨æˆ·çš„æƒ³æ³•å’Œè¦æ±‚æ˜¯ï¼ˆAï¼‰çš„ç›®çš„ A è¯¦ç»†è°ƒæŸ¥ B ä¸šåŠ¡åˆ†æ C æ•°æ®åˆ†æ D ç³»ç»Ÿåˆ†æ 2.ç³»ç»Ÿåˆ†æè¯¦ç»†è°ƒæŸ¥ä¸­ï¼Œå±äºéš¾ç‚¹é—®é¢˜çš„æ˜¯ï¼ˆCï¼‰ A è¿‡å¤šçš„ç”¨æˆ·å‚ä¸ B ç”¨æˆ·éœ€æ±‚çš„å¤šæ ·æ€§ C ç”¨æˆ·ä¸å¼€å‘äººå‘˜çš„äº¤æµå›°éš¾ D ç”¨æˆ·è¿‡æ—©å‚ä¸ 3.è¯¦ç»†è°ƒæŸ¥é˜¶æ®µå·¥ä½œçš„ä¸»è¦éš¾ç‚¹ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A æ²¡æœ‰è¶³å¤Ÿçš„ç”¨æˆ·å‚ä¸ B ç”¨æˆ·çš„éœ€æ±‚ç»å¸¸å˜æ›´ C ç”¨æˆ·ä¸å¼€å‘äººå‘˜å¾ˆéš¾è¿›è¡Œäº¤æµ D æˆæœ¬å¤ªé«˜ 4.è¯¦ç»†è°ƒæŸ¥çš„ä¸»è¦éš¾ç‚¹æœ‰ï¼šæ²¡æœ‰è¶³å¤Ÿçš„ç”¨æˆ·å‚ä¸ï¼Œç”¨æˆ·çš„éœ€æ±‚ç»å¸¸å˜æ›´ï¼Œç”¨æˆ·ä¸å¼€å‘äººå‘˜å¾ˆéš¾è¿›è¡Œäº¤æµ 5.è¯¦ç»†è°ƒæŸ¥çš„ç›®çš„å°±æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„è°ƒç ”æ´»åŠ¨ï¼Œå°½å¯èƒ½å‡†ç¡®ã€è¯¦ç»†åœ°äº†è§£ç”¨æˆ·çš„éœ€æ±‚ã€‚ 6.ç®€è¿°è¯¦ç»†è°ƒæŸ¥çš„ç›®çš„ã€‚ è¯¦ç»†è°ƒæŸ¥çš„ç›®çš„å°±æ˜¯è¦ææ¸…æ¥šç”¨æˆ·çš„è¿™äº›æƒ³æ³•å’Œè¦æ±‚ï¼Œæ¢å¥è¯è¯´ï¼Œå°±æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„è°ƒç ”æ´»åŠ¨ï¼Œå°½å¯èƒ½å‡†ç¡®ã€è¯¦ç»†åœ°äº†è§£ç”¨æˆ·éœ€æ±‚ã€‚ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„éœ€æ±‚é—®é¢˜ï¼Œéƒ½æ˜¯ç”±äºè°ƒç ”ä¸æ¸…ã€ä¸ç»†é€ æˆçš„ï¼Œä¸ºäº†ä¿è¯ç³»ç»Ÿå¼€å‘çš„æˆæœï¼Œå¿…é¡»å¯¹è¿™ä¸€é˜¶æ®µç»™äºˆå……åˆ†çš„æ—¶é—´å’Œé«˜åº¦çš„é‡è§†ã€‚ 7.ç®€è¿°è¯¦ç»†è°ƒæŸ¥çš„ä¸»è¦éš¾ç‚¹ã€‚ å¯¹éœ€æ±‚è¿›è¡Œè¯¦ç»†è°ƒæŸ¥æ—¶ä¸€é¡¹é‡è¦çš„å·¥ä½œï¼Œä¹Ÿæ˜¯æœ€å›°éš¾çš„å·¥ä½œã€‚è¯¦ç»†è°ƒæŸ¥é˜¶æ®µå·¥ä½œçš„ä¸»è¦éš¾ç‚¹æœ‰ï¼š1.æ²¡æœ‰è¶³å¤Ÿçš„ç”¨æˆ·å‚ä¸ï¼›2.ç”¨æˆ·çš„éœ€æ±‚ç»å¸¸å˜æ›´ï¼›3.ç”¨æˆ·ä¸å¼€å‘äººå‘˜å¾ˆéš¾è¿›è¡Œäº¤æµã€‚ è¯¦ç»†è°ƒæŸ¥çš„ä¸»è¦å†…å®¹ 1.è´Ÿè´£å…¬å¸çš„ç»è¥ä¸æ—¥å¸¸å·¥ä½œçš„æ˜¯ï¼ˆBï¼‰ A ä¸´é«˜å†³ç­–å±‚ B ä¸šåŠ¡ç®¡ç†å±‚ C ä¸šåŠ¡æ‰§è¡Œå±‚ D æˆ˜ç•¥ç®¡ç†å±‚ 2.å…³äºæ•°æ®æµç¨‹è°ƒæŸ¥çš„ä»»åŠ¡ï¼Œè¯´æ³•é”™è¯¯çš„æ˜¯ï¼ˆDï¼‰ A æ”¶é›†å¯ä»¥æ”¶é›†çš„å•æ®ã€å‡­è¯ã€æŠ¥è¡¨ææ–™ B ææ¸…ææ–™çš„å‡ºå¤„å’Œç›¸äº’å…³ç³» C è°ƒæŸ¥æ¸…æ¥šæ•°æ®é—´çš„å‰åå…³ç³» D è°ƒæŸ¥éƒ¨åˆ†æ•°æ®çš„å‡ºå¤„ 3.è¯¦ç»†è°ƒæŸ¥ä¸­ç”¨æ¥æè¿°å½“å‰ç³»ç»Ÿç»“æ„çš„å±‚æ¬¡å’Œéš¶å±å…³ç³»çš„å›¾å½¢æ˜¯ï¼ˆAï¼‰ A ç»„ç»‡ç»“æ„å›¾ B æ•°æ®æµå›¾ C E-Rå›¾ D æ¨¡å—ç»“æ„å›¾ 4.ç”±ä¸‹å±åˆ†å…¬å¸ç­‰æœºæ„ç»„æˆï¼Œå®Œæˆæ—¥å¸¸çš„ç”Ÿäº§ã€ä¸šåŠ¡å’Œè°ƒåº¦ç­‰å·¥ä½œçš„æ˜¯ï¼ˆCï¼‰ A æˆ˜ç•¥ç®¡ç†å±‚ B ä¸šåŠ¡ç®¡ç†å±‚ C ä¸šåŠ¡æ‰§è¡Œå±‚ D æˆ˜æœ¯ç®¡ç†å±‚ 5.è´Ÿè´£æ‹Ÿå®šå…¬å¸ä¸­é•¿æœŸå‘å±•è§„åˆ’ã€ç»è¥æ–¹é’ˆã€èµ„æœ¬ç»è¥è§„åˆ’å’Œæ–¹æ¡ˆçš„ç®¡ç†å±‚æ˜¯ï¼ˆAï¼‰ A é¢†å¯¼å†³ç­–å±‚ B ä¸šåŠ¡æ‰§è¡Œå±‚ C ä¸šåŠ¡ç®¡ç†å±‚ D æˆ˜æœ¯ç®¡ç†å±‚ 6.æ•°æ®æµç¨‹è°ƒæŸ¥çš„å·¥ä½œåˆ†ä¸ºçš„ä¸¤ä¸ªæ­¥éª¤æ˜¯â€œåˆ†æâ€å’Œï¼ˆBï¼‰ A æ•´ç† B æ‰‹æœº C è®¾è®¡ D å®æ–½ 7.è´Ÿè´£æ‰§è¡Œè‘£äº‹ä¼šå†³è®®çš„æ˜¯ä¸šåŠ¡ç®¡ç†å±‚ã€‚ 8.è¯¦ç»†è°ƒæŸ¥çš„ä¸»è¦å†…å®¹åŒ…æ‹¬ï¼šç»„ç»‡æœºæ„çš„è°ƒæŸ¥ã€ä¸šåŠ¡æµç¨‹çš„è°ƒæŸ¥ã€æ•°æ®æµç¨‹çš„è°ƒæŸ¥ã€è–„å¼±ç¯èŠ‚çš„è°ƒæŸ¥å’Œå…¶ä»–ä¿¡æ¯çš„è°ƒæŸ¥ã€‚ 9.è¯¦ç»†è°ƒæŸ¥çš„ä¸»è¦å†…å®¹æœ‰ï¼šç»„ç»‡æœºæ„çš„è°ƒæŸ¥ã€ä¸šåŠ¡æµç¨‹çš„è°ƒæŸ¥ã€æ•°æ®æµç¨‹çš„è°ƒæŸ¥ã€è–„å¼±ç¯èŠ‚çš„è°ƒæŸ¥ä»¥åŠå…¶ä»–ä¿¡æ¯çš„è°ƒæŸ¥ã€‚ 10.è¯¦ç»†è°ƒæŸ¥çš„ä¸»è¦å†…å®¹æœ‰ï¼šç»„ç»‡æœºæ„çš„è°ƒæŸ¥ã€ä¸šåŠ¡æµç¨‹çš„è°ƒæŸ¥ã€æ•°æ®æµç¨‹çš„è°ƒæŸ¥ã€è–„å¼±ç¯èŠ‚çš„è°ƒæŸ¥ä»¥åŠå…¶ä»–ä¿¡æ¯çš„è°ƒæŸ¥ã€‚ 11.æ•°æ®æµç¨‹çš„ä¸‰ä¸ªä»»åŠ¡ã€‚ 1.æ”¶é›†å¯ä»¥æ”¶é›†çš„å•æ®ã€å‡­è¯ã€æŠ¥è¡¨ææ–™ï¼Œææ¸…å‡ºå¤„å’Œç›¸äº’å…³ç³»ï¼›2.å¿…é¡»è°ƒæŸ¥æ¸…æ¥šæ¯ä¸ªæ•°æ®çš„å‡ºå¤„ï¼›3.å¿…é¡»è°ƒæŸ¥æ¸…æ¥šæ•°æ®é—´çš„å‰åå…³ç³»ã€è¿ç®—å…¬å¼å’Œå‹¾ç¨½å…³ç³»ã€‚ 12.è¯¦ç»†è°ƒæŸ¥çš„ä¸»è¦å†…å®¹ã€‚ 1.ç»„ç»‡æœºæ„çš„è°ƒæŸ¥ï¼›2.ä¸šåŠ¡æµç¨‹çš„è°ƒæŸ¥ï¼›3.æ•°æ®æµç¨‹çš„è°ƒæŸ¥ï¼›4.è–„å¼±ç¯èŠ‚çš„è°ƒæŸ¥ï¼›5.å…¶ä»–ä¿¡æ¯çš„è°ƒæŸ¥ã€‚ è¯¦ç»†è°ƒæŸ¥çš„æ–¹æ³•ä¸åŸåˆ™ 1.è¯¦ç»†è°ƒæŸ¥çš„æ–¹æ³•ä¸åŸåˆ™æœ‰ï¼ˆDï¼‰ A è‡ªä¸‹è€Œä¸Šçš„å…¨é¢å¼€å±• B åªæŠ¢åˆ°åˆ†å·¥è€Œä¸å¼ºè°ƒåä½œ C å­˜åœ¨çš„ä¸€å®šæ˜¯åˆç†çš„ D äº‹å…ˆè®¡åˆ’ 2.äº†è§£ç°è¡Œç³»ç»Ÿçš„æ–¹æ³•æ˜¯ï¼ˆAï¼‰ A å‚ä¸ä¸šåŠ¡å®æˆ˜ B ä¹¦é¢è°ƒæŸ¥ C æ”¶é›†èµ„æ–™ D å¼€è°ƒæŸ¥ä¼š 3.è¯¦ç»†è°ƒæŸ¥çš„åŸºæœ¬æ–¹æ³•ä¸­ï¼Œæœ€æœ‰æ•ˆçš„æ˜¯ï¼ˆAï¼‰ A å¼€è°ƒæŸ¥ä¼š B å‚ä¸ä¸šåŠ¡å®æˆ˜ C æ‰‹æœºèµ„æ–™ D ä¹¦é¢è°ƒæŸ¥ 4.è¯¦ç»†è°ƒæŸ¥çš„åŸåˆ™ä¸åŒ…æ‹¬ï¼ˆDï¼‰ A äº‹å…ˆè®¡åˆ’ B é‡‡è®¿æŒå…³é”®ä¿¡æ¯çš„äºº C è‡ªé¡¶å‘ä¸‹å…¨é¢å±•å¼€ D å­˜åœ¨å³åˆç† 5.éœ€æ±‚è°ƒæŸ¥äººå‘˜åº”æ³¨æ„çš„äº‹é¡¹æè¿°æœ‰è¯¯çš„æ˜¯ï¼ˆAï¼‰ A é€‰æ‹©ä¸“ä¸šçš„è¯­è¨€ B å€¾å¬æ¯”è¡¨è¾¾é‡è¦ C åŠæ—¶åæ˜ é¿å…è¯¯è§£ D ä»¥å­¦ä¹ çš„æ€åº¦å±•å¼€å·¥ä½œ 6.ç”¨è°ƒæŸ¥è¡¨å‘æœ‰å…³éƒ¨é—¨å’Œä¸ªäººå¾æ±‚æ„è§å’Œæ‰‹æœºæ•°æ®çš„è°ƒæŸ¥æ–¹æ³•æ˜¯ï¼ˆCï¼‰ A æ”¶é›†èµ„æ–™ B å¼€è°ƒæŸ¥ä¼šæˆ–ä¸ªåˆ«è®¿é—® C ä¹¦é¢è°ƒæŸ¥ D å‚åŠ ä¸šåŠ¡å®è·µ 7.ä¸‹è¿°å…³äºç³»ç»Ÿè¯¦ç»†è°ƒæŸ¥åŸåˆ™çš„è¯´æ³•ä¸­ï¼Œé”™è¯¯çš„æ˜¯ï¼ˆCï¼‰ A é‡‡è®¿æŒå…³é”®ä¿¡æ¯çš„äºº B è‡ªé¡¶å‘ä¸‹å…¨é¢å±•å¼€ C å­˜åœ¨çš„å°±æ˜¯åˆç†çš„ D åˆ†å·¥åä½œç›¸ç»“åˆ 8.äº†è§£ç°è¡Œç³»ç»Ÿæœ€å¥½çš„æ–¹æ³•ï¼ˆDï¼‰ A æ”¶é›†èµ„æ–™ B ä¹¦é¢è°ƒæŸ¥ C ä¸ªåˆ«è°ƒæŸ¥ D å‚åŠ ä¸šåŠ¡å®è·µ 9.å…³äºè¯¦ç»†è°ƒæŸ¥çš„åŸºæœ¬æ–¹æ³•ï¼Œä¸åŒ…æ‹¬çš„æ˜¯ï¼ˆAï¼‰ A å†™åˆ†ææŠ¥å‘Š B ä¹¦é¢è°ƒæŸ¥ C å¼€è°ƒæŸ¥ä¼šæˆ–ä¸ªåˆ«è®¿é—® D æ”¶é›†èµ„æ–™ 10.è¯¦ç»†è°ƒæŸ¥çš„åŸåˆ™ä¸­ï¼Œæ˜¯è‡ªé¡¶å‘ä¸‹å…¨é¢å±•å¼€ã€‚ 11.è¯¦ç»†è°ƒæŸ¥çš„åŸºæœ¬æ–¹æ³•æœ‰ï¼šæ”¶é›†èµ„æ–™ã€å¼€è°ƒæŸ¥ä¼šæˆ–ä¸ªåˆ«è®¿é—®ã€ä¹¦é¢è°ƒæŸ¥å’Œå‚åŠ ä¸šåŠ¡å®æˆ˜ã€‚ 12.è¯¦ç»†è°ƒæŸ¥çš„åŸºæœ¬æ–¹æ³•åŒ…æ‹¬ï¼šæ”¶é›†èµ„æ–™ã€å¼€è°ƒæŸ¥ä¼šæˆ–ä¸ªåˆ«è®¿é—®ã€ä¹¦é¢è°ƒæŸ¥å’Œå‚åŠ ä¸šåŠ¡å®æˆ˜ã€‚ 13.è¯¦ç»†è°ƒæŸ¥çš„åŸºæœ¬æ–¹æ³•ã€‚ 1.æ”¶é›†èµ„æ–™ï¼›2.å¼€è°ƒæŸ¥ä¼šæˆ–ä¸ªåˆ«è®¿é—®ï¼›3.ä¹¦é¢è°ƒæŸ¥ï¼›4.å‚åŠ ä¸šåŠ¡å®æˆ˜ã€‚ 14.éœ€æ±‚è°ƒæŸ¥äººå‘˜éœ€è¦æ³¨æ„å“ªäº›åŸåˆ™ï¼Ÿ 1.é€‰æ‹©é»˜å¥‘çš„è¯­è¨€ï¼›2.å€¾å¬æ¯”è¡¨è¾¾é‡è¦ï¼›3.åŠæ—¶ç¿»è¯‘é¿å…è¯¯è§£ï¼›4.ä»¥å­¦ä¹ çš„æ€åº¦å±•å¼€å·¥ä½œã€‚ 15.è¯¦ç»†è°ƒæŸ¥çš„åŸåˆ™ã€‚ 1.äº‹å…ˆè®¡åˆ’ï¼›2.é‡‡è®¿æŒå…³é”®ä¿¡æ¯çš„äººï¼›3.è‡ªé¡¶å‘ä¸‹å…¨é¢å±•å¼€ï¼›4.å­˜åœ¨çš„ä¸ä¸€å®šæ˜¯åˆç†çš„ï¼›5.åˆ†å·¥å’Œåä½œç›¸ç»“åˆï¼›6.ä¸»åŠ¨æ²Ÿé€šçš„å·¥ä½œæ–¹å¼ï¼› "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äº”ç« _ç³»ç»Ÿåˆ†æ/ç¬¬ä¸‰èŠ‚_ä¸šåŠ¡æµç¨‹åˆ†æ.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äº”ç« _ç³»ç»Ÿåˆ†æ/ç¬¬ä¸‰èŠ‚_ä¸šåŠ¡æµç¨‹åˆ†æ.html","title":"ç¬¬ä¸‰èŠ‚ï¼šä¸šåŠ¡æµç¨‹åˆ†æ","keywords":"","body":"ç¬¬ä¸‰èŠ‚ï¼šä¸šåŠ¡æµç¨‹åˆ†æ ä¸šåŠ¡æµç¨‹çš„æ¦‚å¿µ 1.ä¸šåŠ¡æµç¨‹çš„ç‰¹ç‚¹æ˜¯ï¼ˆAï¼‰ A ç›®æ ‡æ€§ã€é€»è¾‘æ€§ã€å®Œæ•´æ€§ B ç›®æ ‡æ€§ã€é€»è¾‘æ€§ã€å±‚æ¬¡æ€§ C ä¸¥è°¨æ€§ã€å¯è§†æ€§ã€å®Œæ•´æ€§ D å¯è§†æ€§ã€ä¸¥è°¨æ€§ã€å±‚æ¬¡æ€§ 2.ä¸šåŠ¡æµç¨‹çš„ç‰¹ç‚¹æ²¡æœ‰ï¼ˆAï¼‰ A åŒé‡æ€§ B ç›®æ ‡æ€§ C é€»è¾‘æ€§ D å±‚æ¬¡æ€§ 3.ä¸šåŠ¡æµç¨‹çš„åŠŸèƒ½åæ˜ äº†æ´»åŠ¨é—´çš„å…³ç³»ã€‚ 4.ä¸šåŠ¡æµç¨‹å…·æœ‰ç›®æ ‡æ€§ã€é€»è¾‘æ€§å’Œå±‚æ¬¡æ€§ç­‰ç‰¹ç‚¹ã€‚ 5.ä¸šåŠ¡æµç¨‹æ˜¯æŒ‡ä¸€ç»„å…±åŒä¸ºé¡¾å®¢åˆ›é€ ä»·å€¼è€Œåˆäº’ç›¸å…³è”çš„æ´»åŠ¨ã€‚ 6.ä¸€ç»„å…±åŒä¸ºé¡¾å®¢åˆ›é€ ä»·å€¼è€Œåˆç›¸äº’å…³è”çš„æ´»åŠ¨æŒ‡çš„æ˜¯ä¸šåŠ¡æµç¨‹ã€‚ 7.ä¸šåŠ¡æµç¨‹çš„ç‰¹ç‚¹ã€‚ ä¸šåŠ¡æµç¨‹çš„ç‰¹ç‚¹æœ‰ï¼šç›®æ ‡æ€§ï¼Œå®Œæˆå°†æŠ•å…¥è½¬åŒ–ä¸ºäº§å‡ºçš„ç‰¹å®šçš„ä»»åŠ¡ï¼›é€»è¾‘æ€§ï¼Œç»„æˆæµç¨‹çš„æ´»åŠ¨ä¹‹é—´å…·æœ‰ç›¸äº’è”ç³»ã€ç›¸äº’ä½œç”¨çš„æ–¹å¼ï¼›å±‚æ¬¡æ€§ï¼Œæµç¨‹å¤æ‚ï¼Œå¯ä»¥ç”±é«˜è‡³ä½ä¸€å±‚ä¸€å±‚åˆ†è§£ã€‚ 8.ä¸šåŠ¡æµç¨‹çš„åŠŸèƒ½ã€‚ ä¸šåŠ¡æµç¨‹çš„åŠŸèƒ½ï¼š1.å®ç°ä¸åŒåˆ†å·¥æ´»åŠ¨çš„ç»“æœé“¾æ¥ï¼›2.åæ˜ æ´»åŠ¨é—´çš„å…³ç³»ã€‚ 9.åè¯è§£é‡Šï¼šæµç¨‹ã€‚ æµç¨‹ç”±ä¸€ç³»åˆ—çš„æ´»åŠ¨æˆ–è€…å®è·µç»„æˆï¼Œå¯ä»¥æ¸å˜çš„è¿ç»­æ€§æµç¨‹ã€‚ 10.åè¯è§£é‡Šï¼šä¸šåŠ¡æµç¨‹ã€‚ ä¸šåŠ¡æµç¨‹çš„æ¦‚å¿µæ˜¯æŒ‡ä¸€ç»„å…±åŒä¸ºé¡¾å®¢åˆ›é€ ä»·å€¼è€Œåˆç›¸äº’å…³è”çš„æ´»åŠ¨ã€‚ ä¸šåŠ¡æµç¨‹åˆ†æçš„æ–¹æ³• 1.å±äºä¸šåŠ¡æµç¨‹åˆ†ææ­¥éª¤çš„æœ‰ï¼ˆDï¼‰ A ç¼–ç è®¾è®¡ B ç»˜åˆ¶å®ä½“ - è”ç³»å›¾ C ç•Œé¢è®¾è®¡ D ä¸šåŠ¡æµç¨‹ä¼˜åŒ– 2.ä¸šåŠ¡æµç¨‹çš„ä¸»è¦æ­¥éª¤ä¸åŒ…æ‹¬ï¼ˆBï¼‰ A è°ƒæŸ¥ä¼ä¸šçš„ç»„ç»‡ç»“æ„ B åˆ†å·¥åä½œ C è°ƒæŸ¥ä¼ä¸šçš„å…·ä½“ä¸šåŠ¡æµç¨‹ D ç»˜åˆ¶ä¸šåŠ¡æµç¨‹å›¾ 3.ä¸šåŠ¡æµç¨‹åˆ†æä¸»è¦æ˜¯ä¸ºäº†æè¿°ç°è¡Œç³»ç»Ÿçš„ï¼ˆCï¼‰ A æ•°æ®æ¨¡å‹ B é€»è¾‘æ¨¡å‹ C ç‰©ç†æ¨¡å‹ D ç½‘ç»œæ¨¡å‹ 4.åœ¨ä¸šåŠ¡æµç¨‹å›¾ä¸­ï¼Œè¡¨ç¤ºä¸šåŠ¡å’Œæ•°æ®æµç¨‹æ–¹å‘é€šå¸¸ç”¨ï¼ˆAï¼‰ A å•ç®­å¤´ B åœ†ç‚¹ C çŸ©å½¢ D æ¨ªçº¿ 5.ä¸šåŠ¡æµç¨‹ä¸­ï¼Œé€šå¸¸æ˜¯æŒ‡å‚ä¸æŸé¡¹ä¸šåŠ¡çš„éƒ¨é—¨æˆ–äººã€è¡¨è¾¾æ•´ä¸ªä¸šåŠ¡æµç¨‹çš„èµ·ç‚¹å’Œç»ˆç‚¹çš„ç¬¦å·ç§°ä¸ºï¼ˆDï¼‰ A ä¸šåŠ¡åŠŸèƒ½æè¿° B æ•°æ®æµ C ä¸šåŠ¡å’Œæ•°æ®æµåŠ¨æ–¹å‘ D å¤–éƒ¨å®ä½“ 6.ä¸šåŠ¡æµç¨‹åˆ†æé‡‡ç”¨çš„æ˜¯è‡ªé¡¶å‘ä¸‹çš„æ–¹æ³•ï¼Œé¦–å…ˆç”»å‡ºé«˜å±‚ç®¡ç†çš„ä¸šåŠ¡æµç¨‹å›¾ï¼Œç„¶åå†å¯¹æ¯ä¸€ä¸ªåŠŸèƒ½éƒ¨åˆ†è¿›è¡Œåˆ†è§£ã€‚ 7.ä¸šåŠ¡æµç¨‹åˆ†æä¸»è¦æ˜¯ä¸ºäº†æè¿°ç°è¡Œç³»ç»Ÿçš„ç‰©ç†æ¨¡å‹ã€‚ 8.è°ƒæŸ¥ä¼ä¸šçš„ä¸šåŠ¡æµç¨‹é€šå¸¸å¯æŒ‰åŸæœ‰çš„ä¿¡æ¯æµåŠ¨è¿‡ç¨‹ï¼Œé€ä¸ªè°ƒæŸ¥å½“å‰ç³»ç»Ÿä¸­æ¯ä¸ªç¯èŠ‚çš„å¤„ç†ä»»åŠ¡ï¼Œå¤„ç†é¡ºåºå’Œå¯¹æ—¶é—´çš„è¦æ±‚ç­‰æƒ…å†µï¼Œå¼„æ¸…æ¯ä¸ªç¯èŠ‚çš„ä¿¡æ¯æ¥æºå’Œå»å‘ã€‚ 9.ä¸šåŠ¡æµç¨‹å›¾æè¿°çš„å†…å®¹åŒ…æ‹¬ï¼šå¤–éƒ¨å®ä½“ã€ä¸šåŠ¡åŠŸèƒ½æè¿°å’Œä¸šåŠ¡æµç¨‹æµåŠ¨æ–¹å‘ã€‚ 10.ä¸šåŠ¡æµç¨‹åˆ†æçš„ä¸»è¦æ­¥éª¤ã€‚ 1.è°ƒæŸ¥ä¼ä¸šçš„ç»„ç»‡ç»“æ„ï¼›2.è°ƒæŸ¥ä¼ä¸šçš„å…·ä½“ä¸šåŠ¡æµç¨‹ï¼›3.ç»˜åˆ¶ä¸šåŠ¡æµç¨‹å›¾ï¼›4.ä¸šåŠ¡æµç¨‹ä¼˜åŒ–ï¼› ä¸šåŠ¡æµç¨‹é‡ç»„ã€‚ 1.ä»¥ä¸‹å…³äºä¸šåŠ¡æµç¨‹é‡ç»„çš„åŸåˆ™ï¼Œæ­£ç¡®çš„æ˜¯ï¼ˆCï¼‰ A å›´ç»•å…·ä½“ä»»åŠ¡è€Œéæœ€ç»ˆç»“æœæ¥è¯•è¯•å†é€ å·¥ä½œ B ä¸è®©åç»­è¿‡ç¨‹çš„æœ‰å…³äººå‘˜å‚ä¸å‰ç«¯è¿‡ç¨‹ C å°†ä¿¡æ¯å¤„ç†èå…¥äº§ç”Ÿè¯¥ä¿¡æ¯çš„å®é™…å·¥ä½œä¸­å» D èµ„æºåˆ†æ•£åŒ– 2.BPRçš„æ ¸å¿ƒåŸºæœ¬ç‰¹å¾ä¸åŒ…æ‹¬ï¼ˆCï¼‰ A æ ¹æœ¬æ€§ B å½»åº•æ€§ C ç»Ÿä¸€æ€§ D æµç¨‹ 3.ä¸šåŠ¡æµç¨‹é‡ç»„çš„åŸåˆ™ä¸åŒ…æ‹¬ï¼ˆBï¼‰ A å›´ç»•æœ€ç»ˆç»“æœè€Œéå…·ä½“ä»»åŠ¡æ¥å®æ–½åœ¨é€ å·¥ä½œ B è®©åç»­è¿‡ç¨‹çš„æœ‰å…³äººå‘˜å‚ä¸åç«¯è¿‡ç¨‹ C å°†ä¿¡æ¯å¤„ç†èå…¥äº§ç”Ÿè¯¥ä¿¡æ¯çš„å®é™…å·¥ä½œä¸­å» D å°†å¹³è¡Œå·¥åºé“¾æ¥èµ·æ¥è€Œä¸æ˜¯é›†æˆå…¶ç»“æœ 4.BPRæ˜¯ä¸ºäº†é€‚åº”ä»¥é¡¾å®¢ã€ç«äº‰ã€å˜åŒ–ä¸ºç‰¹å¾çš„ç°ä»£ä¼ä¸šç»è¥ç¯å¢ƒã€‚ 5.BPRæ˜¯ä¸ºäº†é€‚åº”ä»¥é¡¾å®¢ã€ç«äº‰ã€å˜åŒ–ä¸ºç‰¹å¾çš„ç°ä»£ä¼ä¸šç»è¥ç¯å¢ƒã€‚ 6.ç®¡ç†ä¿¡æ¯ç³»ç»Ÿä¸­ï¼ŒBPRæŒ‡çš„æ˜¯ä¸šåŠ¡æµç¨‹é‡ç»„ã€‚ 7.åœ¨BPRçš„å®šä¹‰ä¸­ï¼Œâ€œæ ¹æœ¬æ€§â€ã€â€œå½»åº•æ€§â€ã€â€œæ˜¾è‘—æ”¹å–„â€å’Œâ€œæµç¨‹â€æ˜¯å››ä¸ªæ ¸å¿ƒåŸºæœ¬ç‰¹å¾ã€‚ 8.ä¼ä¸šç»è¥è¿‡ç¨‹é‡æ„ï¼ˆBPRï¼‰é›†ä¼ä¸šä¸šåŠ¡æµç¨‹ä¸ç®¡ç†ä¿¡æ¯ç³»ç»Ÿå¼€å‘äºä¸€ä½“ã€‚ 9.BPRçš„åŸºæœ¬ç‰¹å¾åŒ…æ‹¬ï¼šâ€œæ ¹æœ¬æ€§â€æ€è€ƒã€â€œå½»åº•æ€§â€å†è®¾è®¡ï¼Œâ€œæ˜¾è‘—æ”¹å–„â€å’Œâ€œæµç¨‹â€è¿™å››ä¸ªæ ¸å¿ƒåŸºæœ¬ç‰¹å¾ã€‚ 10.åœ¨BPRçš„å®šä¹‰ä¸­ï¼Œâ€œæ ¹æœ¬æ€§â€æ€è€ƒã€â€œå½»åº•æ€§â€å†è®¾è®¡ï¼Œâ€œæ˜¾è‘—æ”¹å–„â€å’Œâ€œæµç¨‹â€æ˜¯å››ä¸ªæ ¸å¿ƒåŸºæœ¬ç‰¹å¾ã€‚ 11.BPRçš„å››ä¸ªæ ¸å¿ƒåŸºæœ¬ç‰¹å¾åŒ…æ‹¬â€œæ ¹æœ¬æ€§â€ã€â€œå½»åº•æ€§â€ã€â€œæ˜¾è‘—æ”¹å–„â€å’Œâ€œæµç¨‹â€ã€‚ 12.BPRçš„åŸºæœ¬ç‰¹å¾ã€‚ åœ¨BPRçš„å®šä¹‰ä¸­ï¼Œâ€œæ ¹æœ¬æ€§â€ã€â€œå½»åº•æ€§â€ã€â€œæ˜¾è‘—æ”¹å–„â€å’Œâ€œæµç¨‹â€æ˜¯å››ä¸ªæ ¸å¿ƒåŸºæœ¬ç‰¹å¾ã€‚ 13.ä¸šåŠ¡æµç¨‹é‡ç»„çš„åŸåˆ™ã€‚ ä¸šåŠ¡æµç¨‹é‡ç»„çš„åŸåˆ™ä¸»è¦æœ‰ï¼š1.å›´ç»•æœ€ç»ˆç»“æœè€Œéå…·ä½“ä»»åŠ¡æ¥å®æ–½å†é€ å·¥ä½œã€‚2.è®©åç»­è¿‡ç¨‹çš„æœ‰å…³äººå‘˜å‚ä¸å‰ç«¯è¿‡ç¨‹ã€‚3.å°†ä¿¡æ¯å¤„ç†èå…¥äº§ç”Ÿè¯¥ä¿¡æ¯çš„å®é™…å·¥ä½œä¸­å»ã€‚4.å°†åœ°åŸŸä¸Šåˆ†æ•£çš„èµ„æºé›†ä¸­åŒ–ã€‚5.å°†å¹³è¡Œå·¥åºè¿æ¥èµ·æ¥è€Œä¸æ˜¯é›†æˆå…¶ç»“æœã€‚6.å†³ç­–ç‚¹ä¸‹ç§»å¹¶å°†æ§åˆ¶èå…¥è¿‡ç¨‹ä¸­ã€‚7.åœ¨æºå¤´è·å–ä¿¡æ¯ã€‚ 14.åè¯è§£é‡Šï¼šä¸šåŠ¡æµç¨‹é‡ç»„ã€‚ ä¸šåŠ¡æµç¨‹é‡ç»„ç®€ç§°BPRï¼Œå®ƒæ˜¯å¯¹ä¼ä¸šçš„ä¸šåŠ¡æµç¨‹ä½œæ ¹æœ¬æ€§çš„æ€è€ƒå’Œå½»åº•é‡å»ºï¼Œå…¶ç›®çš„æ˜¯æˆæœ¬ã€è´¨é‡ã€æœåŠ¡å’Œé€Ÿåº¦ç­‰æ–¹é¢å–å¾—æ˜¾è‘—çš„æ”¹å–„ï¼Œä½¿å¾—ä¼ä¸šèƒ½æœ€å¤§é™åº¦åœ°é€‚åº”ä»¥é¡¾å®¢ã€ç«äº‰ã€å˜åŒ–ä¸ºç‰¹å¾çš„ç°ä»£ä¼ä¸šç»è¥ç¯å¢ƒã€‚ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äº”ç« _ç³»ç»Ÿåˆ†æ/ç¬¬å››èŠ‚_æ•°æ®æµç¨‹åˆ†æçš„æ¦‚å¿µ.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äº”ç« _ç³»ç»Ÿåˆ†æ/ç¬¬å››èŠ‚_æ•°æ®æµç¨‹åˆ†æçš„æ¦‚å¿µ.html","title":"ç¬¬å››èŠ‚ï¼šæ•°æ®æµç¨‹åˆ†æçš„æ¦‚å¿µ","keywords":"","body":"ç¬¬å››èŠ‚ï¼šæ•°æ®æµç¨‹åˆ†æçš„æ¦‚å¿µ æ•°æ®æµç¨‹åˆ†æçš„æ¦‚å¿µ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äº”ç« _ç³»ç»Ÿåˆ†æ/ç¬¬äº”èŠ‚_æ–°ç³»ç»Ÿé€»è¾‘æ¨¡å‹.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äº”ç« _ç³»ç»Ÿåˆ†æ/ç¬¬äº”èŠ‚_æ–°ç³»ç»Ÿé€»è¾‘æ¨¡å‹.html","title":"ç¬¬äº”èŠ‚ï¼šæ–°ç³»ç»Ÿé€»è¾‘æ¨¡å‹","keywords":"","body":"ç¬¬äº”èŠ‚ï¼šæ–°ç³»ç»Ÿé€»è¾‘æ¨¡å‹ "},"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äº”ç« _ç³»ç»Ÿåˆ†æ/ç¬¬å…­èŠ‚_ç³»ç»Ÿåˆ†ææŠ¥å‘Š.html":{"url":"pages/ä¿¡æ¯ç³»ç»Ÿå¼€å‘ä¸ç®¡ç†/ç¬¬äº”ç« _ç³»ç»Ÿåˆ†æ/ç¬¬å…­èŠ‚_ç³»ç»Ÿåˆ†ææŠ¥å‘Š.html","title":"ç¬¬å…­èŠ‚ï¼šç³»ç»Ÿåˆ†ææŠ¥å‘Š","keywords":"","body":"ç¬¬å…­èŠ‚ï¼šç³»ç»Ÿåˆ†ææŠ¥å‘Š "},"pages/æŒç»­åŒ–é›†æˆCI/01_ä½¿ç”¨shellæ‰“åŒ….html":{"url":"pages/æŒç»­åŒ–é›†æˆCI/01_ä½¿ç”¨shellæ‰“åŒ….html","title":"1.ä½¿ç”¨shellæ‰“åŒ…","keywords":"","body":"ä½¿ç”¨shellæ‰“åŒ… éœ€æ±‚ ä½¿ç”¨shellè„šæœ¬ï¼Œå¯¼å‡ºadhoc/appstoreçš„åŒ…ï¼Œç„¶åä¸Šä¼ è‡³appstore/fir/pgyç­‰å¹³å°ã€‚ ä¸€ã€å‡†å¤‡adhoc/appstoreçš„è¯ä¹¦æè¿°æ–‡ä»¶ æ–°å»ºiOS Distribution (App Store and Ad Hoc)è¯ä¹¦ã€‚ æ–°å¢(Ad Hoc/App Store) Provisioning Profileè¯ä¹¦æè¿°æ–‡ä»¶ï¼ˆè¯¥æ–‡ä»¶ä¼šå…³è”Appã€Distributionè¯ä¹¦ã€iPhoneè®¾å¤‡ï¼‰ã€‚ äºŒã€å‡†å¤‡å¯¼å‡ºplisté…ç½®æ–‡ä»¶ åœ¨æˆ‘ä»¬æ‰‹åŠ¨ä½¿ç”¨Xcodeæ‰“åŒ…çš„æ—¶å€™ï¼Œå¯¼å‡ºå®Œæ¯•åå¯ä»¥å¾—åˆ°å¯¹åº”ExportOptions.plistï¼Œç›´æ¥ä½¿ç”¨å³å¯ã€‚ æ³¨æ„ï¼šadhocçš„plistè¯·ä½¿ç”¨adhocçš„è¯ä¹¦æè¿°æ–‡ä»¶ï¼ˆAdHocProvisioningProfileï¼‰æ‰“åŒ…ï¼Œappstoreçš„åˆ™ä½¿ç”¨appstoreçš„è¯ä¹¦æè¿°æ–‡ä»¶ï¼ˆAppStoreProvisioningProfileï¼‰æ‰“åŒ…ã€‚ AdHocExportOptions.plist compileBitcode method ad-hoc provisioningProfiles com.******.packagewithscript AdHocProvisioningProfile signingCertificate Apple Distribution signingStyle manual stripSwiftSymbols teamID ****** thinning &lt;none&gt; AppStoreExportOptions compileBitcode method app-store provisioningProfiles com.******.packagewithscript AppStoreProvisioningProfile signingCertificate Apple Distribution signingStyle manual stripSwiftSymbols teamID ****** thinning &lt;none&gt; ä¸‰ã€é…ç½®è¡¨æ ¼ è¯ä¹¦ç±»å‹ è¯ä¹¦æè¿°æ–‡ä»¶ç±»å‹ è¯ä¹¦æè¿°æ–‡ä»¶åç§° plistæ–‡ä»¶ iOS Distribution (App Store and Ad Hoc) Ad Hoc AdHocProvisioningProfile AdHocExportOptions iOS Distribution (App Store and Ad Hoc) App Store AppStoreProvisioningProfile AppStoreExportOptions å››ã€xcodebuildå’Œxcrunå®‰è£… xcodebuildå’Œxcrunéƒ½æ˜¯æ¥è‡ªCommand Line Toolsï¼ŒXcodeè‡ªå¸¦ï¼Œå¦‚æœæ²¡æœ‰å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š xcode-select --install æˆ–è€…åœ¨ä¸‹é¢çš„é“¾æ¥ä¸‹è½½å®‰è£…ï¼š https://developer.apple.com/downloads/ å®‰è£…å®Œå¯åœ¨ä»¥ä¸‹è·¯å¾„çœ‹åˆ°è¿™ä¸¤ä¸ªå·¥å…·ï¼š /Applications/Xcode.app/Contents/Developer/usr/bin/ äº”ã€xcodebuild xcodebuildä»å…¥é—¨åˆ°ç²¾é€š è„šæœ¬æ‰“åŒ…ipaä¼šä½¿ç”¨åˆ°å¦‚ä¸‹å‘½ä»¤ï¼š æ¸…ç† xcodebuild \\ clean -configuration ${development_mode} -quiet || rollbackIfNeed 'æ¸…ç†å¤±è´¥' ç¼–è¯‘ xcodebuild \\ archive -project ${project_name}.xcodeproj \\ -scheme ${scheme_name} \\ -configuration ${development_mode} \\ -archivePath ${buildPath}/${project_name}.xcarchive -quiet || rollbackIfNeed 'ç¼–è¯‘å¤±è´¥' å¯¼å‡º xcodebuild -exportArchive -archivePath ${buildPath}/${project_name}.xcarchive \\ -configuration ${development_mode} \\ -exportPath ${exportFilePath} \\ -exportOptionsPlist ${exportOptionsPlistPath} \\ -quiet || rollbackIfNeed 'æ‰“åŒ…å¤±è´¥' äº”ã€altool è„šæœ¬ä¸Šä¼ ipaè‡³apptoreä¼šä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š # éªŒè¯å¹¶ä¸Šä¼ åˆ°App Store # ${exportFilePath}/${scheme_name}.ipaï¼šipaè·¯å¾„ # ******@126.com: è‹¹æœè´¦å· # ****-****-vlnc-hillï¼šåŒé‡è®¤è¯å¯†ç  xcrun altool --validate-app -f ${exportFilePath}/${scheme_name}.ipa -t ios -u ******@126.com -p ****-****-vlnc-hill --output-format xml || rollbackIfNeed 'ipaæ ¡éªŒå¤±è´¥' xcrun altool --upload-app -f ${exportFilePath}/${scheme_name}.ipa -t ios -u ******@126.com -p ****-****-vlnc-hill --output-format xml || rollbackIfNeed 'ipaä¸Šä¼ å¤±è´¥' é€šè¿‡ altool ä¸Šä¼  App çš„äºŒè¿›åˆ¶æ–‡ä»¶ ipaä¸Šä¼  ipaä¸Šä¼ stackflow æ³¨ï¼šXcode 11 çš„ altool å·²ç»è¢«å‘½ä»¤ xcrun altool æ›¿ä»£ã€‚åœ¨ç»ˆç«¯è¿è¡Œxcrun altool -hå¯ä»¥æŸ¥çœ‹è¯´æ˜ã€‚ å…­ã€fir-cli fir-cliå®‰è£… è„šæœ¬ä¸Šä¼ ipaè‡³firä¼šä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š # ä¸Šä¼ åˆ°Fir # å°†******æ›¿æ¢æˆè‡ªå·±çš„Firå¹³å°çš„token fir login -T ****** || rollbackIfNeed 'ç™»å½•firå¤±è´¥' fir publish $exportFilePath/$scheme_name.ipa || rollbackIfNeed 'å‘å¸ƒipaåŒ…è‡³firå¤±è´¥' ä¸ƒã€è’²å…¬è‹± ä½¿ç”¨ä¸€æ¡å‘½ä»¤å¿«é€Ÿä¸Šä¼ åº”ç”¨ è„šæœ¬ä¸Šä¼ ipaè‡³firä¼šä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š # ä¸Šä¼ åˆ°è’²å…¬è‹± # è’²å…¬è‹±aipKey MY_PGY_API_K=****** # è’²å…¬è‹±uKey MY_PGY_UK=****** curl -F \"file=@${exportFilePath}/${scheme_name}.ipa\" \\ -F \"uKey=${MY_PGY_UK}\" \\ -F \"_api_key=${MY_PGY_API_K}\" \\ https://www.pgyer.com/apiv1/app/upload || rollbackIfNeed 'å‘å¸ƒipaåŒ…è‡³pgyå¤±è´¥' å…«ã€å®Œæ•´è„šæœ¬ xcodebuild.sh ä¹ã€å‚è€ƒé“¾æ¥ è’²å…¬è‹± fir While executing gem ... (Gem::FilePermissionError) è¯¦è§£Shellè„šæœ¬å®ç°iOSè‡ªåŠ¨åŒ–ç¼–è¯‘æ‰“åŒ…æäº¤ "},"pages/æŒç»­åŒ–é›†æˆCI/02_ä½¿ç”¨fastlaneæ‰“åŒ….html":{"url":"pages/æŒç»­åŒ–é›†æˆCI/02_ä½¿ç”¨fastlaneæ‰“åŒ….html","title":"2.ä½¿ç”¨fastlaneæ‰“åŒ…","keywords":"","body":"ä½¿ç”¨fastlaneæ‰“åŒ… fastlaneç†è§£ ä¹‹å‰å†™äº†ä¸€ç¯‡ä½¿ç”¨shellæ‰“åŒ…çš„æ–‡ç« ï¼Œä»è¿™ç¯‡æ–‡ç« æ‰“åŒ…æ˜¯å¯ä»¥é€šè¿‡ç¼–å†™shellè„šæœ¬å®Œæˆï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜éœ€è¦fastlaneå‘¢ï¼Ÿ fastlaneå¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„é€šè¿‡ç®€å•å‘½ä»¤æ¥å®Œæˆè¯¸å¦‚æˆªå›¾ã€è·å–è¯ä¹¦ã€ç¼–è¯‘ã€å¯¼å‡ºå®‰è£…åŒ…ï¼Œè€Œä¸éœ€è¦å»å…³å¿ƒå¦‚ä½•å»å†™å¤§é‡çš„æ‰“åŒ…è„šæœ¬ã€‚ fastlaneå¯ä»¥å®šä¹‰å¤šä¸ªä»»åŠ¡ï¼Œä¾‹å¦‚ï¼šæ‰“åŒ…åˆ°ä¸åŒæ¸ é“åŒ…æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¤šä¸ªä»»åŠ¡ï¼Œåªéœ€è¦ä¸€è¡Œç®€å•å‘½ä»¤ã€‚ fastlaneæ‰“åŒ…ç›´æ¥å°±åŒ…å«äº†dsymç­‰æ–‡ä»¶ï¼Œè€Œä½¿ç”¨è„šæœ¬è¿˜å¾—è‡ªå·±å»å®ç°ã€‚ fastlaneå®‰è£…åŠé…ç½® fastlaneå®‰è£… sudo gem install fastlane -n /usr/local/bin fastlaneå‡çº§ bundle update fastlane fastlaneé…ç½® cd é¡¹ç›®ç›®å½• fastlane init æ‰§è¡Œä»¥ä¸Šå‘½ä»¤ï¼Œé¡¹ç›®ç›®å½•ä¸‹ä¼šç”Ÿæˆç›¸åº”çš„Appfileã€Fastfileã€‚ æ‰§è¡Œfastlane init,bundle updateå¡ä½äº† Appfile Appfileæ˜¯ç”¨æ¥é…ç½®ä¸€äº›ç±»ä¼¼äºAppleIDã€BundleIDå‚æ•°(å‚æ•°æ˜¯fastlaneå·²ç»å®šä¹‰å¥½çš„ï¼Œæ–°å¢çš„å¹¶æ²¡æœ‰ç”¨ï¼Œå¦‚æœæƒ³æ–°å¢å˜é‡éœ€è¦ä½¿ç”¨.envæ–¹å¼)ï¼Œå¯ä»¥åœ¨Fastfileä¸­ä½¿ç”¨ï¼ŒAppleIDã€BundleIDç­‰å…¶å®ä¼šè¢«ä¸€äº›actionsç›´æ¥è°ƒç”¨ï¼Œå¹¶ä¸éœ€è¦å†™å‡ºæ¥ä¼ é€’ã€‚ æ™®é€šé…ç½®æ–¹å¼ ç›´æ¥åœ¨Appfileé‡Œå¡«å†™app_identifierã€apple_idã€team_idç­‰ï¼Œç„¶åæ ¹æ®laneçš„ä¸åŒå¯ä»¥è®¾ç½®æˆä¸åŒã€‚ # é»˜è®¤é…ç½® app_identifier \"com.devhy.test\" apple_id \"devhy1@xxxx.com\" team_id \"xxxxxxxxx1\" # å¦‚æœlaneæ˜¯entæ¢æˆDevçš„é…ç½® for_lane :ent do app_identifier \"com.devhy.testDev\" apple_id \"devhy2@xxxx.com\" team_id \"xxxxxxxxx2\" end ä½¿ç”¨.envé…ç½®æ–¹å¼ .envè¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨æ˜¯ä½œä¸ºç¯å¢ƒå˜é‡çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨fastlane initè¿›è¡Œåˆå§‹åŒ–åå¹¶ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œå¦‚æœéœ€è¦å¯ä»¥è‡ªå·±åˆ›å»ºã€‚ æ‰§è¡Œæ—¶é»˜è®¤ä¼šè¯»å–.envå’Œ.env.defaultæ–‡ä»¶é‡Œçš„é…ç½®ã€‚é€šè¿‡æ‰§è¡Œfastlane [lane-name] --env [envName]æ¥æŒ‡å®šä½¿ç”¨é…ç½®æ–‡ä»¶.env.[envName]ï¼Œè¯»å–é¡ºåºæ˜¯.env -> .env.default -> .env.ï¼Œç›¸åŒçš„å˜é‡åä¼šè¢«åé¢çš„è¦†ç›–ã€‚ å¦‚æˆ‘å»ºäº†æ–‡ä»¶.env.myDevï¼Œé‡Œé¢å†™äº†ä¸€äº›å‚æ•°ï¼Œé‚£åœ¨æ‰§è¡Œçš„æ—¶å€™ä½¿ç”¨fastlane [lane-name] --env myDevå³å¯ï¼Œæƒ³åœ¨Appfileã€Deliverfileã€Fastfileç­‰è°ƒç”¨ï¼Œç›´æ¥ä½¿ç”¨ENV['keyName']å³å¯ã€‚ # .env.myDevæ–‡ä»¶ # bundle id App_Identifier = \"com.devhy.testDev\" # å¼€å‘è€…è´¦å· Apple_Id = \"xx2@xxxx.com\" # å¼€å‘è€…TeamId Team_Id = \"xxxxxxxxx2\" # projectçš„target schemeåç§° Scheme = \"HYTestDev\" # Appfileä½¿ç”¨.envæ–¹å¼ç›´æ¥è¯»å–å˜é‡å³å¯ app_identifier ENV['App_Identifier'] apple_id ENV['Apple_Id'] team_id ENV['Team_Id'] æ³¨æ„ï¼šå› ä¸ºæ˜¯.envæ–‡ä»¶æ˜¯.å¼€å¤´æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯åœ¨finderä¸­éšè—çš„ï¼Œéœ€è¦é€šè¿‡æ‰§è¡Œä¸€ä¸‹å‘½ä»¤æ¥æ˜¾ç¤ºï¼š # è®¾ç½®éšè—æ–‡ä»¶å¯è§ defaults write com.apple.finder AppleShowAllFiles TRUE # é‡å¯finderæœåŠ¡ä»¥ç”Ÿæ•ˆ killall Finder é…ç½®æ–¹å¼å¯¹æ¯” æ™®é€šé…ç½®æ–¹å¼ï¼šç®€å•æ˜“æ‡‚ï¼Œä½†ä¸èƒ½è‡ªå®šä¹‰å˜é‡ï¼Œä¸”æ¯ä¸ªlaneæƒ³ä¸ä¸€æ ·éƒ½è¦å†™ä¸€ä¸ªfor_lane .envé…ç½®æ–¹å¼ï¼šåŠŸèƒ½æ€§å¼ºï¼Œä½†é…ç½®èµ·æ¥ç¨å¾®éº»çƒ¦ä¸€ç‚¹ã€‚ Deliverfile Deliverfileæ˜¯ç”¨æ¥é…ç½®ä¸Šä¼ åˆ°iTunesConnectæ‰€éœ€ä¿¡æ¯çš„ï¼Œç”±äºæˆ‘ä»¬ä¸»è¦ç”¨fastlaneæ¥æ‰“åŒ…ï¼Œå‘å¸ƒæ˜¯æ‰‹åŠ¨å°†ipaåŒ…æäº¤å®¡æ ¸ï¼Œç”±äºæ²¡æœ‰è¿›è¡Œè¿‡å°è¯•æ‰€ä»¥è¯¥æ–‡ä»¶é…ç½®æ–¹å¼å°±ä¸å™è¿°äº†ã€‚ Fastfile Fastfileæ˜¯å¯¹æµç¨‹è¿›è¡Œæ§åˆ¶çš„æ ¸å¿ƒæ–‡ä»¶ï¼Œéœ€è¦è®¾å®šæ”¯æŒçš„å¹³å°å’Œåœ¨ä¸€äº›ç¯èŠ‚é‡Œéœ€è¦åšçš„äº‹æƒ…ã€‚ åŸºæœ¬ç»“æ„ Fastfileä¸»è¦æ˜¯æ ¹æ®è®¾å®šçš„å¹³å°ï¼Œå¯ä»¥åœ¨before_allã€after_allã€errorä¸­åšä¸€äº›æ“ä½œä»¥åŠå»ºç«‹ä¸€äº›laneä½œä¸ºå…³é”®çš„æ‰§è¡Œé€»è¾‘ï¼Œå¯ä»¥åœ¨å…¶ä¸­ä½¿ç”¨fastlaneå†…ç½®çš„actionï¼Œä¹Ÿå¯ä»¥è°ƒç”¨è‡ªå»ºactionï¼Œè¿˜å¯ä»¥è°ƒç”¨åˆ«çš„laneã€‚ # å› ä¸ºfastlaneå­˜åœ¨æ–°è€ç‰ˆæœ¬å…¼å®¹é—®é¢˜ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šæŒ‡å®šfastlaneç‰ˆæœ¬ fastlane_version \"2.62.0\" default_platform :ios platform :ios do # æ‰€æœ‰laneæ‰§è¡Œä¹‹å‰ï¼Œå¯ä»¥åšå¦‚æ‰§è¡Œcocoapodsçš„pod install before_all do cocoapods end # åå­—å«entçš„laneï¼Œå‘½ä»¤è¡Œé‡Œæ‰§è¡Œfastlane ent lane :ent do # æ‰§è¡Œä¸€äº›actionï¼Œå¦‚certä¸‹è½½è¯ä¹¦ï¼Œsighä¸‹è½½ppæ–‡ä»¶ï¼Œgymè¿›è¡Œç¼–è¯‘å’Œå¯¼å‡ºåŒ… end # æ‰§è¡Œfastlane storeå³å¯ lane :store do # è°ƒç”¨ä¸€äº›action # è°ƒç”¨åˆ«çš„laneï¼Œæ¯”å¦‚send_msg send_msg end lane :send_msg do # è°ƒç”¨ä¸€äº›action end # æ‰€æœ‰laneå®Œæˆä¹‹åï¼Œå¯ä»¥é€‚ç”¨å‚æ•°laneæ¥åŒºåˆ† after_all do |lane| end # æ‰€æœ‰laneå¤±è´¥ä¹‹åï¼Œå¯ä»¥é€‚ç”¨å‚æ•°laneæ¥åŒºåˆ† error do |lane, exception| end end Fastfileæ ·ä¾‹ ä¸‹é¢çš„Fastfileæ ·ä¾‹æ˜¯é…ç½®äº†.env+Appfileåè¿›è¡Œç¼–å†™ï¼Œå› ä¸ºè¿™æ ·åœ¨é…ç½®actionæ—¶ï¼Œå¯ä»¥çœå»ä¸€äº›å…¥å‚ã€‚ å› ä¸ºä½¿ç”¨äº†Appfileï¼Œcertçš„usernameã€team_id ä»¥åŠ sighçš„app_identifierã€usernameã€team_id å¯ä»¥ä¸ç”¨ä¼ å…¥äº†ï¼Œfastlaneåœ¨æ‰§è¡Œæ—¶ä¼šè‡ªå·±å»ä»Appfileé‡Œå–ã€‚ä»¥åŠä¹‹å‰åœ¨.envç¯å¢ƒé…ç½®ä¸­è®¾å®šäº†ä¸€ä¸ªSchemeçš„å­—æ®µï¼Œé‚£ä¹ˆgymçš„schemeæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ENV['Scheme']æ¥è°ƒç”¨ã€‚ fastlane_version \"2.62.0\" default_platform :ios platform :ios do before_all do cocoapods end lane :store do # action(cert)ï¼Œä¸‹è½½[å¼€å‘è€…è¯ä¹¦.cer] # ä¸‹è½½çš„æ–‡ä»¶ä¼šå­˜åœ¨é¡¹ç›®æ ¹ç›®å½•çš„buildæ–‡ä»¶å¤¹ä¸‹ # fastlaneä¼šè®©ä½ åœ¨å‘½ä»¤è¡Œç™»å½•å¼€å‘è€…è´¦å·ï¼Œç™»å½•æˆåŠŸåï¼Œä¼šåœ¨ä½ çš„[é’¥åŒ™ä¸²]ä¸­åˆ›å»ºä¸€ä¸ª {deliver.[username]} çš„ç™»å½•è´¦æˆ· cert( # Appfileè®¾ç½®äº†è¿™è¾¹å°±å¯ä»¥ä¸ç”¨äº† # username: \"devhy2@xxxx.com\", # team_id: \"xxxxxxxxx2\", # ä¸‹è½½.ceræ–‡ä»¶çš„ä½ç½® output_path: \"build\", ) # action(sigh)ï¼Œä¸‹è½½[å®‰è£…appåŒ¹é…çš„Provision Profileæ–‡ä»¶(ppæ–‡ä»¶)] # å»ºè®®è‡ªå·±å»è‹¹æœå¼€å‘è€…ç½‘ç«™è¯ä¹¦ä¸­æ‰‹åŠ¨å¤„ç†ä¸€æ³¢provision_profile # å»ºè®®ç”¨ bundleId_å¯¼å‡ºæ–¹å¼ æ¥å‘½åæ¯”å¦‚: # ä¼ä¸šåŒ…ppæ–‡ä»¶å« testDev_InHouse.mobileprovision sigh( # Appfileè®¾ç½®äº†è¿™è¾¹å°±å¯ä»¥ä¸ç”¨äº† # app_identifier: \"com.devhy.testDev\", # username: \"devhy2@xxxx.com\", # team_id: \"xxxxxxxxx2\", # ä¸‹è½½ppæ–‡ä»¶çš„ä½ç½® output_path: \"build\", # è‡ªåŠ¨ä¸‹è½½ç­¾åæ—¶ï¼Œadcé‡Œppåå­—ï¼Œä¸å†™ä¹Ÿå¯ä»¥ä¼šæ ¹æ®ä½ çš„bundle idã€adhocä¸å¦å»ä¸‹è½½æœ€æ–°çš„ä¸€ä¸ª # provisioning_name: \"testDev_InHouse\", # ä»…ä¸‹è½½ä¸åˆ›å»ºï¼Œé»˜è®¤æ˜¯false readonly: true, # å› ä¸ºæ˜¯æ ¹æ®BundleIDä¸‹è½½ï¼Œå¯¼è‡´adhocå’Œappstoreä¼šä¼˜å…ˆappstoreï¼Œå¯¼è‡´æœ€åå¯¼å‡ºæŠ¥é”™ï¼Œå¦‚æœæ˜¯adhocåŒ…è¯·è®¾ç½®ä¸ºtrue adhoc: true, ) # ç¼–è¯‘é…ç½®ï¼Œç¼–è¯‘çš„schemeï¼Œå¯¼å‡ºåŒ…æ–¹å¼ gym( # ä½¿ç”¨.envé…ç½®çš„ç¯å¢ƒå˜é‡ scheme: ENV['Scheme'], # app-store, ad-hoc, package, enterprise, development, developer-id export_method: \"enterprise\", # è¾“å‡ºæ—¥å¿—çš„ç›®å½• buildlog_path: \"fastlanelog\", # è¾“å‡ºç¼–è¯‘ç»“æœ output_directory: \"build\", include_bitcode: false ) end after_all do |lane| end error do |lane, exception| end end actions åœ¨fastlaneä¸­ä½¿ç”¨çš„è¯¸å¦‚cer()ã€sigh()ã€gym()éƒ½æ˜¯actionï¼Œå…¶æœ¬è´¨æ˜¯é¢„å…ˆå†™å¥½çš„rubyè„šæœ¬(å¦‚:sigh.rb)ï¼Œfastlaneä¸­æœ‰å¾ˆå¤šå·²ç»å†™å¥½çš„actionsï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è‡ªå·±è¿›è¡Œç¼–å†™ã€‚ å‘½ä»¤è¡Œå¸¸ç”¨çš„æ“ä½œæœ‰ï¼š 1. æŸ¥çœ‹æ‰€æœ‰Action fastlane actions 2. æŸ¥çœ‹æŸä¸ªActionçš„å‚æ•°è¯´æ˜ fastlane action [action_name]å¦‚(fastlane action gym) ç‰ˆæœ¬è‡ªå¢åŠæŒ‡å®š # ç‰ˆæœ¬å¤„ç† def setup_version_build(options) if \"#{options[:build]}\".empty? increment_build_number( xcodeproj: ENV['Xcodeproj'] ) else increment_build_number( xcodeproj: ENV['Xcodeproj'], build_number:options[:build] ) end unless \"#{options[:version]}\".empty? increment_version_number( xcodeproj: ENV['Xcodeproj'], version_number:options[:version] ) end end ä½¿ç”¨fastlaneä¸Šä¼ Appåˆ°è’²å…¬è‹± https://www.pgyer.com/doc/view/fastlane ä½¿ç”¨fastlaneä¸Šä¼ Appåˆ°è’²å…¬è‹± fastlane-plugin-firim Fastlane && AppStore Connect API Fastlane && AppStore Connect API é…ç½®åçš„ä½¿ç”¨ ç¼–å†™å®Œå„ç§é…ç½®åæ€ä¹ˆä½¿ç”¨ï¼Ÿå…¶å®ä½¿ç”¨æ–¹æ³•è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œä¸ä½¿ç”¨.envé…ç½®ï¼Œæ‰§è¡Œfastlane [lane_name]å³å¯ã€‚ ä½¿ç”¨æŸä¸ª.envé…ç½®ï¼Œæ‰§è¡Œfastlane [lane_name] --env [env_name]å³å¯ ï¼Œæ¯”å¦‚æˆ‘åœ¨éœ€è¦æ‰§è¡Œæ ·ä¾‹çš„Fastfileçš„storeï¼Œå¹¶ä½¿ç”¨.env.myDevé…ç½®ï¼Œé‚£æˆ‘å¯ä»¥æ‰§è¡Œfastlane store --env myDevã€‚ å®Œæ•´è„šæœ¬ Fastfile å‚è€ƒé“¾æ¥ macOS Mojave 'ruby/config.h' file not found å’Œé‡å¤åŠ³åŠ¨è¯´å†è§-ä½¿ç”¨fastlaneè¿›è¡ŒiOSæ‰“åŒ… iOSå¼€å‘çƒ­é—¨-è‡ªåŠ¨æ‰“åŒ…fastlane fastlaneæ–‡æ¡£ Mac ä¸‹ fastlane å®‰è£… ä»¥åŠå¸¸è§é”™è¯¯å¤„ç† Automating Version and Build Numbers Using agvtool iOSè‡ªåŠ¨æ‰“åŒ… fastlane åœ¨macä¸Šé…ç½®iOSè‡ªåŠ¨åŒ–ä¸Šæ¶ deliver ä½¿ç”¨fastlane deliver è‡ªåŠ¨ä¸Šä¼ App Store Connect ç‰©æ–™å’Œæˆªå›¾ itunesconnect fastlaneå®˜ç½‘ "},"pages/æŒç»­åŒ–é›†æˆCI/03_ä½¿ç”¨jenkinsæ‰“åŒ….html":{"url":"pages/æŒç»­åŒ–é›†æˆCI/03_ä½¿ç”¨jenkinsæ‰“åŒ….html","title":"3.ä½¿ç”¨jenkinsæ‰“åŒ…","keywords":"","body":"ä½¿ç”¨jenkinsæ‰“åŒ… å®‰è£…jenkins ä¸‹è½½warï¼Œä¸‹è½½åœ°å€ å¯åŠ¨jenkins java -jar jenkins.war --httpPort=8080 ä¸‹è½½jdk8 è¯·ä»æœ¬åœ°å¤åˆ¶å¯†ç å¹¶ç²˜è´´åˆ°ä¸‹é¢ã€‚ /Users/mengru.tian/.jenkins/secrets/initialAdminPassword åˆ›å»ºç¬¬ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ· å®‰è£…æ’ä»¶ ç‚¹å‡»Manage Jenkins é€‰æ‹©Manage Plugins ç‚¹å‡»Available å®‰è£…è¯ä¹¦æ’ä»¶ æœç´¢keychain ç‚¹å‡»â€œDownload now and install after restartâ€ å®‰è£…è’²å…¬è‹±æ’ä»¶ æœç´¢pgyer ç‚¹å‡»â€œDownload now and install after restartâ€ å®‰è£…Git Parameteræ’ä»¶ è¯ä¹¦é…ç½® ç‚¹å‡»Manage Jenkins ç‚¹å‡»Keychains and Provisioning Profiles Management cp ~/Library/Keychains/login.keychain-db /Users/Shared/Jenkins/login.keychain é…ç½®æ„å»ºå‚æ•° Macä¸‹ä½¿ç”¨å‘½ä»¤è¡Œå®‰è£… jenkins æ–¹æ³• Macå®‰è£…jenkins åˆ©ç”¨JenkinsæŒç»­é›†æˆiOSé¡¹ç›® Jenkinså®‰è£…ä¸é…ç½® å…³äºjenkins è‡ªåŠ¨åŒ–æ‰“åŒ…éƒ¨ç½²çš„é—®é¢˜ã€‚ iOS Jenkinsè‡ªåŠ¨åŒ–æ‰“åŒ…ä¸Šä¼ åˆ°è’²å…¬è‹± Git Parameter æ’ä»¶ MacOS Jenkinså¸è½½æ–¹æ³• Jenkinså‚æ•°è®¾ç½®å•é€‰æ¡†ã€å¤šé€‰æ¡†ã€Gitåˆ†æ”¯æ¡† jenkins æ„å»ºåshell_å¦‚ä½•/ä½•æ—¶æ‰§è¡ŒShellæ ‡è®°ä¸€ä¸ªæ„å»ºå¤±è´¥åœ¨Jenkinsï¼Ÿ ä½¿ç”¨ Jenkins æ’ä»¶ä¸Šä¼ åº”ç”¨åˆ°è’²å…¬è‹± "},"pages/å®‰å…¨æ”»é˜²/01_å¸¸ç”¨å·¥å…·.html":{"url":"pages/å®‰å…¨æ”»é˜²/01_å¸¸ç”¨å·¥å…·.html","title":"1.å¸¸ç”¨å·¥å…·","keywords":"","body":"1.å¸¸ç”¨å·¥å…· Alfred 3.2 Macç ´è§£ç‰ˆ å®‰è£…åœ°å€ â€œXXX.app å·²æŸåï¼Œæ‰“ä¸å¼€ã€‚æ‚¨åº”è¯¥å°†å®ƒç§»åˆ°åºŸçº¸ç¯“â€ï¼ŒMacåº”ç”¨ç¨‹åºæ— æ³•æ‰“å¼€æˆ–æ–‡ä»¶æŸåçš„å¤„ç†æ–¹æ³• 5åˆ†é’Ÿä¸Šæ‰‹Macæ•ˆç‡ç¥å™¨Alfredä»¥åŠAlfredå¸¸ç”¨æ“ä½œ Setting the Terminal/Shell to \"Custom\" (iTerm). Mac OS ç»ˆç«¯åˆ©å™¨ iTerm2 å®‰è£…æ•™ç¨‹ How do I hide the â€œuser@hostnameâ€ info #39 MAC TERMINALç»ˆç«¯æˆ–ITERM2å‡ºç°é—®å·è§£å†³æ–¹æ¡ˆ git - è­¦å‘Š:ä¸å»ºè®®ä½¿ç”¨æ­¤è„šæœ¬ï¼Œè¯·å‚é˜…git-completion.zsh SwitchHosts å®‰è£…åœ°å€ å¦‚ä½•è§£å†³ç±»ä¼¼ curl: (7) Failed to connect to raw.githubusercontent.com port 443: Connection refused çš„é—®é¢˜ #10 OpenInTerminal å®‰è£…æ•™ç¨‹ ios-app-signer ä¸‹è½½åœ°å€ idapro IDA Pro 7.0.zipï¼ˆMACç‰ˆæœ¬ï¼Œä¸‹è½½ä¸‹æ¥å¯ç›´æ¥æ‰“å¼€å³å¯ï¼Œåœ¨10.15.4æµ‹è¯•é€šè¿‡ï¼‰ IDA Pro Macç‰ˆ V7.0-pc6 IDA Pro 7.0 for Mac(é™æ€åç¼–è¯‘è½¯ä»¶) v7.0.170914ä¸­æ–‡ç‰ˆ IDA Pro 7.0 macOS 10.15å®‰è£… cycript å®‰è£…CycriptæŠ¥é”™æ‰¾ä¸åˆ°libruby.2.0.0.dylib å®‰è£…cycripté‡åˆ°çš„é—®é¢˜ iOS é€†å‘å¿…å¤‡å·¥å…·å’Œå®‰è£…è¿‡ç¨‹ csrutil disable sudo mkdir -p /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ sudo ln -s /System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/lib/libruby.2.6.dylib /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/libruby.2.0.0.dylib macä¸‹å®‰è£…ruby2.2.0 MacOS ä¸‹å®‰è£… Ruby pod updateæŠ¥é”™ï¼š Traceback (most recent call last): 2: from /usr/local/bin/pod:23:in `' 1: from /Library/Ruby/Site/2.6.0/rubygems.rb:296:in `activate_bin_path' ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è§£å†³ï¼Œå‚è€ƒé“¾æ¥ï¼š sudo gem install cocoapods "},"pages/å®‰å…¨æ”»é˜²/02_MonkeyDev.html":{"url":"pages/å®‰å…¨æ”»é˜²/02_MonkeyDev.html","title":"2.MonkeyDev","keywords":"","body":"2.MonkeyDev ä¸€ã€å®‰è£… å®‰è£…æ­¥éª¤ xcode 12 Types.xcspec not found #266 MonkeyDevæ’ä»¶çš„å®‰è£… äºŒã€è¿è¡Œå·¥ç¨‹ ä½¿ç”¨Monkeyåˆ›å»ºå·¥ç¨‹ï¼Œå¯¼å…¥.appåŒ…ä¹‹åï¼Œé…ç½®å¥½å·¥ç¨‹è¯ä¹¦åï¼Œç‚¹å‡»è¿è¡Œå‘ç°å¦‚ä¸‹é”™è¯¯ï¼š error: Signing for â€œmonkeyTestDylibâ€ requires a development team è§£å†³åŠæ³•ï¼š é€‰ä¸­â€œmonkeytestDylibâ€Target->Build Settings->æœç´¢Code Sign Style->Manualã€‚ Development Teamå†è®¾ç½®ä¸‹ã€‚ æºç  "},"pages/åœ°å›¾èšåˆSDK/01_åœ°å›¾æ˜¾ç¤º.html":{"url":"pages/åœ°å›¾èšåˆSDK/01_åœ°å›¾æ˜¾ç¤º.html","title":"1.åœ°å›¾æ˜¾ç¤º","keywords":"","body":"1.åœ°å›¾æ˜¾ç¤º å‚è€ƒé“¾æ¥ ç™¾åº¦åœ°å›¾SDK ç™¾åº¦å®šä½SDK é«˜å¾·åœ°å›¾SDK é«˜å¾·å®šä½SDK é«˜å¾·åœ°å›¾Doc ç”¨é«˜å¾·åœ°å›¾API é€šè¿‡è¯¦ç»†åœ°å€è·å¾—ç»çº¬åº¦ WebæœåŠ¡APIç®€ä»‹ IOSé«˜å¾·3Dåœ°å›¾ç”»å¤šè¾¹å½¢ï¼Œä»¥åŠåˆ¤æ–­æŸä¸€ç»çº¬åº¦æ˜¯å¦åœ¨è¯¥å¤šè¾¹å½¢å†… ä¸€ã€é›†æˆç™¾åº¦åœ°å›¾ ç¬¬1æ­¥ï¼šæ³¨å†Œå’Œè·å–å¯†é’¥ ç¬¬2æ­¥ï¼šCocoaPods è‡ªåŠ¨é…ç½®ï¼Œåœ¨.podspecæ–‡ä»¶ä¸­å¢åŠ ä¾èµ– s.dependency 'BaiduMapKit', '6.3.0' äºŒã€é›†æˆé«˜å¾·åœ°å›¾ ç¬¬1æ­¥ï¼šè·å–Key ç¬¬2æ­¥ï¼šCocoaPods è‡ªåŠ¨é…ç½®ï¼Œåœ¨.podspecæ–‡ä»¶ä¸­å¢åŠ ä¾èµ– s.dependency 'AMap3DMap', '7.9.0' ä¸‰ã€æŠ½è±¡å·¥å‚ ç‰¹ç‚¹->æ¯”å·¥å‚æ–¹æ³•äº§å“ç§ç±»å¤šã€‚ æŠ½è±¡äº§å“ å…·ä½“äº§å“ æŠ½è±¡å·¥å‚ å…·ä½“å·¥å‚ ç®€å•å·¥å‚ - 1 - N å·¥å‚æ–¹æ³• 1 N 1 N æŠ½è±¡å·¥å‚ N N 1 N å››ã€åœ°å›¾SDKè§’è‰²åˆ†æ æŠ½è±¡äº§å“ï¼šMapViewProtocolã€MapLocationProtocol å…·ä½“äº§å“ï¼šBaiduMapViewã€GaodeMapViewã€BaiduMapLocationã€GaodeMapLocation æŠ½è±¡å·¥å‚ï¼šMapFactoryProtocol å…·ä½“å·¥å‚ï¼šBaiduMapFactoryã€GaodeMapFactory åœ°å›¾å¼•æ“ï¼šMapEngine äº”ã€æ˜¾ç¤ºåœ°å›¾ ç¬¬1æ­¥ï¼šæŠ½è±¡åœ°å›¾åè®® /// åœ°å›¾åè®® public protocol MapViewProtocol: NSObjectProtocol { /// åˆå§‹åŒ– /// - Parameter frame: init(frame: CGRect) /// è·å–åœ°å›¾ func getView() -> UIView } ç¬¬2æ­¥ï¼šå®šä¹‰å…·ä½“åœ°å›¾ é«˜å¾·åœ°å›¾ import MAMapKit /// é«˜å¾·åœ°å›¾ class GaodeMapView: NSObject, MapViewProtocol { private var mapView: MAMapView! /// åˆå§‹åŒ– /// - Parameter frame: required init(frame: CGRect) { super.init() mapView = MAMapView(frame: frame) } /// è·å–åœ°å›¾ func getView() -> UIView { return mapView } } ç™¾åº¦åœ°å›¾ import BaiduMapAPI_Map /// ç™¾åº¦åœ°å›¾ class BaiduMapView: NSObject, MapViewProtocol { private var mapView: BMKMapView! /// åˆå§‹åŒ– /// - Parameter frame: required init(frame: CGRect) { super.init() mapView = BMKMapView(frame: frame) } /// è·å–åœ°å›¾ func getView() -> UIView { return mapView } } ç¬¬3æ­¥ï¼šæŠ½è±¡å·¥å‚ /// åœ°å›¾å·¥å‚æ ‡å‡† public protocol MapFactoryProtocol: NSObjectProtocol { /// åˆå§‹åŒ– /// - Parameter appKey: ç¬¬ä¸‰æ–¹åœ°å›¾AppKey init(appKey: String) /// è·å–åœ°å›¾ /// - Parameter frame: func getMapView(frame: CGRect) -> MapViewProtocol } ç¬¬4æ­¥ï¼šå®šä¹‰å…·ä½“åœ°å›¾å·¥å‚ é«˜å¾·åœ°å›¾å·¥å‚ import MAMapKit /// é«˜å¾·åœ°å›¾å·¥å‚ class GaodeMapFactory: NSObject, MapFactoryProtocol { /// åˆå§‹åŒ– /// - Parameter appKey: ç¬¬ä¸‰æ–¹åœ°å›¾AppKey required init(appKey: String) { super.init() AMapServices.shared()?.apiKey = appKey } /// è·å–åœ°å›¾ /// - Parameter frame: func getMapView(frame: CGRect) -> MapViewProtocol { return GaodeMapView(frame: frame) } } ç™¾åº¦åœ°å›¾å·¥å‚ import BaiduMapAPI_Map /// é«˜å¾·åœ°å›¾å·¥å‚ class BaiduMapFactory: NSObject, MapFactoryProtocol { private let mapManager = BMKMapManager() /// åˆå§‹åŒ– /// - Parameter appKey: ç¬¬ä¸‰æ–¹åœ°å›¾AppKey required init(appKey: String) { super.init() let result = mapManager.start(appKey, generalDelegate: self) if !result { print(\"manager start failed!!!\") } } /// è·å–åœ°å›¾ /// - Parameter frame: func getMapView(frame: CGRect) -> MapViewProtocol { return BaiduMapView(frame: frame) } } ç™¾åº¦åœ°å›¾å·¥å‚éœ€è¦å®ç°ä¸‹åˆ›å»ºåè®® extension BaiduMapFactory: BMKGeneralDelegate { func onGetNetworkState(_ iError: Int32) { if iError == 0 { print(\"è”ç½‘æˆåŠŸ\") } else { print(\"onGetNetworkState:\\(iError)\") } } func onGetPermissionState(_ iError: Int32) { if iError == 0 { print(\"æˆæƒæˆåŠŸ\") } else { print(\"onGetPermissionState:\\(iError)\") } } } ç¬¬5æ­¥ï¼šå®šä¹‰åœ°å›¾å¼•æ“ é€šè¿‡è¯»å–å·¥å‚é…ç½®ï¼Œè·å–æ¿€æ´»çš„åœ°å›¾å·¥å‚ã€‚ æ³¨æ„ï¼šCQConfigManagerå¯ä»¥è¯»å–config.xml,è·å–å½“å‰æ¿€æ´»çš„åœ°å›¾å·¥å‚ï¼Œè¿™æ ·å¯ä»¥ä¸ä¿®æ”¹ä»£ç ï¼Œæ— ç¼åˆ‡æ¢ç™¾åº¦/é«˜å¾·åœ°å›¾ã€‚ /// åœ°å›¾å¼•æ“ public class MapEngine: NSObject { /// æ ¹æ®é…ç½®è·å–åœ°å›¾å·¥å‚ /// - Returns: åœ°å›¾å·¥å‚ public func getFactory() -> MapFactoryProtocol? { let mapPlatform = CQConfigManager.shared.config.mapPlatform if let factoryName = mapPlatform?.factoryName, let appKey = mapPlatform?.appKey { // ç™¾åº¦åœ°å›¾å·¥å‚ if factoryName == \"BaiduMapFactory\" { return BaiduMapFactory(appKey: appKey) } // é«˜å¾·åœ°å›¾å·¥å‚ if factoryName == \"GaodeMapFactory\" { return GaodeMapFactory(appKey: appKey) } } return nil } } ç¬¬6æ­¥ï¼šæ˜¾ç¤ºåœ°å›¾ æ³¨æ„ï¼šCQMapSDKæ˜¯åœ°å›¾SDKï¼ŒåŒ…å«ä»¥ä¸Šçš„æºä»£ç ï¼Œè€ŒViewControlleråˆ™æ˜¯Demoå·¥ç¨‹çš„é¡µé¢ã€‚ import CQMapSDK class ViewController: UIViewController { override func viewDidLoad() { super.viewDidLoad() // æ˜¾ç¤ºåœ°å›¾ let engine = MapEngine() let factory = engine.getFactory() if let mapView = factory?.getMapView(frame: view.bounds) { view.addSubview(mapView.getView()) } } } "},"pages/åœ°å›¾èšåˆSDK/02_æ˜¾ç¤ºé«˜å¾·ç”¨æˆ·å®šä½.html":{"url":"pages/åœ°å›¾èšåˆSDK/02_æ˜¾ç¤ºé«˜å¾·ç”¨æˆ·å®šä½.html","title":"2.æ˜¾ç¤ºé«˜å¾·ç”¨æˆ·å®šä½","keywords":"","body":"2.æ˜¾ç¤ºé«˜å¾·ç”¨æˆ·å®šä½ å…­ã€æ˜¾ç¤ºé«˜å¾·ç”¨æˆ·å®šä½ æ˜¾ç¤ºå®šä½è“ç‚¹ ç¬¬1æ­¥ï¼šåœ°å›¾åè®®å¢åŠ æ˜¾ç¤ºç”¨æˆ·å®šä½å±æ€§ ......çœç•¥éƒ¨åˆ†ä»£ç  /// åœ°å›¾åè®® public protocol MapViewProtocol: NSObjectProtocol { ...... /// è®¾å®šæ˜¯å¦æ˜¾ç¤ºå®šä½å›¾å±‚ var showsUserLocation: Bool { get set } } /// é«˜å¾·åœ°å›¾ class GaodeMapView: NSObject, MapViewProtocol { ...... /// è®¾å®šæ˜¯å¦æ˜¾ç¤ºå®šä½å›¾å±‚ var showsUserLocation: Bool = false { didSet { mapView.showsUserLocation = showsUserLocation } } } /// ç™¾åº¦åœ°å›¾ class BaiduMapView: NSObject, MapViewProtocol { ....... /// è®¾å®šæ˜¯å¦æ˜¾ç¤ºå®šä½å›¾å±‚ var showsUserLocation: Bool = false { didSet { mapView.showsUserLocation = showsUserLocation } } } ç¬¬2æ­¥ï¼šæµ‹è¯•ä»£ç  class ViewController: UIViewController { override func viewDidLoad() { super.viewDidLoad() ...... if let mapView = factory?.getMapView(frame: view.bounds) { // æ˜¾ç¤ºç”¨æˆ·å®šä½ mapView.showsUserLocation = true view.addSubview(mapView.getView()) } } } å¢åŠ å¦‚ä¸Šä»£ç åï¼Œé«˜å¾·/ç™¾åº¦éƒ½æ²¡æœ‰æ˜¾ç¤ºç”¨æˆ·å®šä½ã€‚ å‘ç°é—®é¢˜1: [MAMapKit] è¦åœ¨iOS 11åŠä»¥ä¸Šç‰ˆæœ¬ä½¿ç”¨å®šä½æœåŠ¡, éœ€è¦åœ¨Info.plistä¸­æ·»åŠ NSLocationAlwaysAndWhenInUseUsageDescriptionå’ŒNSLocationWhenInUseUsageDescriptionå­—æ®µã€‚ è§£å†³åŠæ³•ï¼šinfo.plistæ–°å¢ï¼š NSLocationAlwaysAndWhenInUseUsageDescription CQMapSDKéœ€è¦ä½¿ç”¨å®šä½æœåŠ¡ NSLocationWhenInUseUsageDescription CQMapSDKéœ€è¦ä½¿ç”¨å®šä½æœåŠ¡ å‘ç°é—®é¢˜2: App Transport Security has blocked a cleartext HTTP (http://) resource load since it is insecure. Temporary exceptions can be configured via your app's Info.plist file. è§£å†³åŠæ³•ï¼šinfo.plistæ–°å¢ï¼š NSAppTransportSecurity NSAllowsArbitraryLoads å‘ç°é—®é¢˜3: [MAMapKit] è¦åœ¨iOS 11åŠä»¥ä¸Šç‰ˆæœ¬ä½¿ç”¨åå°å®šä½æœåŠ¡, éœ€è¦å®ç°mapViewRequireLocationAuth: ä»£ç†æ–¹æ³• è§£å†³åŠæ³•ï¼šå®ç°mapViewRequireLocationAuth 1.å®šä¹‰åœ°å›¾ä»£ç†åè®® /// åœ°å›¾ä»£ç†åè®® public protocol MapViewDelegateProtocol: NSObjectProtocol { } public extension MapViewDelegateProtocol { } 2.æ–°å¢é«˜å¾·åœ°å›¾ä»£ç†å®ç° import MAMapKit /// é«˜å¾·åœ°å›¾ä»£ç†å®ç° class MAMapViewDelegateImpl: NSObject, MAMapViewDelegate { weak var delegate: MapViewDelegateProtocol? /** * @brief å½“plisté…ç½®NSLocationAlwaysUsageDescriptionæˆ–è€…NSLocationAlwaysAndWhenInUseUsageDescriptionï¼Œå¹¶ä¸”[CLLocationManager authorizationStatus] == kCLAuthorizationStatusNotDeterminedï¼Œä¼šè°ƒç”¨ä»£ç†çš„æ­¤æ–¹æ³•ã€‚ * æ­¤æ–¹æ³•å®ç°è°ƒç”¨åå°æƒé™APIå³å¯ï¼ˆ è¯¥å›è°ƒå¿…é¡»å®ç° [locationManager requestAlwaysAuthorization] ï¼‰; since 6.8.0 * - Parameter locationManager: åœ°å›¾çš„CLLocationManagerã€‚ */ func mapViewRequireLocationAuth(_ locationManager: CLLocationManager!) { locationManager.requestAlwaysAuthorization() } } 3.é«˜å¾·åœ°å›¾å®ç°å¢åŠ ä»£ç† /// é«˜å¾·åœ°å›¾ class GaodeMapView: NSObject, MapViewProtocol { ...... private var mapDelegate = MAMapViewDelegateImpl() ...... /// åœ°å›¾ä»£ç† var delegate: MapViewDelegateProtocol? { didSet { if let delegate = delegate { mapDelegate.delegate = delegate mapView.delegate = mapDelegate } } } ...... } 4.æµ‹è¯•ç”¨æˆ·å®šä½æ˜¾ç¤º class ViewController: UIViewController { override func viewDidLoad() { ...... if let mapView = factory?.getMapView(frame: view.bounds) { ...... // è®¾ç½®ä»£ç† mapView.delegate = self ...... } } } ç°åœ¨ä½¿ç”¨é«˜å¾·åœ°å›¾å°±å¯ä»¥æ­£å¸¸æ˜¾ç¤ºç”¨æˆ·å®šä½å•¦ï¼ "},"pages/åœ°å›¾èšåˆSDK/03_å¦‚ä½•æ˜¾ç¤ºç™¾åº¦ç”¨æˆ·å®šä½.html":{"url":"pages/åœ°å›¾èšåˆSDK/03_å¦‚ä½•æ˜¾ç¤ºç™¾åº¦ç”¨æˆ·å®šä½.html","title":"3.å¦‚ä½•æ˜¾ç¤ºç™¾åº¦ç”¨æˆ·å®šä½","keywords":"","body":"3.å¦‚ä½•æ˜¾ç¤ºç™¾åº¦ç”¨æˆ·å®šä½ ä¸ƒã€å¦‚ä½•æ˜¾ç¤ºç™¾åº¦ç”¨æˆ·å®šä½ï¼Ÿ åˆ†æç™¾åº¦åœ°å›¾è¿˜æ˜¯æ— æ³•æ˜¾ç¤ºç”¨æˆ·å®šä½ï¼Œç»è¿‡æŸ¥çœ‹ç™¾åº¦Demoå·¥ç¨‹ï¼Œå¿…é¡»å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š ç¬¬1æ­¥ï¼šåˆå§‹åŒ–å®šä½SDK,è®¾ç½®showsUserLocation=true BMKLocationAuth.sharedInstance()?.checkPermision(withKey: appKey, authDelegate: self) ç¬¬2æ­¥ï¼šæ‰“å¼€ç”¨æˆ·å®šä½ï¼Œå¹¶ä¸”ç¡®ä¿å®šä½æˆåŠŸ //å¼€å¯å®šä½æœåŠ¡ locationManager.startUpdatingHeading() locationManager.startUpdatingLocation() ç¬¬3æ­¥ï¼šåœ¨å®šä½ä»£ç†ä¸­æ›´æ–°ç”¨æˆ·ä½ç½® //MARK:BMKLocationManagerDelegate /** @brief è¯¥æ–¹æ³•ä¸ºBMKLocationManageræä¾›è®¾å¤‡æœå‘çš„å›è°ƒæ–¹æ³• @param manager æä¾›è¯¥å®šä½ç»“æœçš„BMKLocationManagerç±»çš„å®ä¾‹ @param heading è®¾å¤‡çš„æœå‘ç»“æœ */ func bmkLocationManager(_ manager: BMKLocationManager, didUpdate heading: CLHeading?) { NSLog(\"ç”¨æˆ·æ–¹å‘æ›´æ–°\") userLocation.heading = heading mapView.updateLocationData(userLocation) } /** @brief è¿ç»­å®šä½å›è°ƒå‡½æ•° @param manager å®šä½ BMKLocationManager ç±» @param location å®šä½ç»“æœï¼Œå‚è€ƒBMKLocation @param error é”™è¯¯ä¿¡æ¯ã€‚ */ func bmkLocationManager(_ manager: BMKLocationManager, didUpdate location: BMKLocation?, orError error: Error?) { if let _ = error?.localizedDescription { NSLog(\"locError:%@;\", (error?.localizedDescription)!) } NSLog(\"ç”¨æˆ·å®šä½æ›´æ–°\") userLocation.location = location?.location //å®ç°è¯¥æ–¹æ³•ï¼Œå¦åˆ™å®šä½å›¾æ ‡ä¸å‡ºç° mapView.updateLocationData(userLocation) } ç¬¬4æ­¥ï¼šåœ¨å®šä½ä»£ç†å®ç°å®šä½æˆæƒ func bmkLocationManager(_ manager: BMKLocationManager, doRequestAlwaysAuthorization locationManager: CLLocationManager) { locationManager.requestAlwaysAuthorization() } ä¸‹é¢æˆ‘ä»¬é›†æˆç™¾åº¦å®šä½SDKï¼Œåœ¨éªŒè¯ä¸Šé¢çš„æ­¥éª¤æ˜¯å¦å¯ä»¥æ­£ç¡®æ˜¾ç¤ºç™¾åº¦å®šä½ï¼Ÿ å…«ã€é›†æˆç™¾åº¦å®šä½ ç¬¬1æ­¥ï¼šè¿™é‡Œä½¿ç”¨Cocoapodçš„é…ç½®ï¼Œå‚è€ƒç™¾åº¦å®šä½SDK-ä»£ç ï¼Œä»¥ä¸‹æ˜¯CQMapSDK.podspecå…³é”®é…ç½®ï¼š s.static_framework = true s.swift_version = '5.0' s.ios.deployment_target = '9.0' s.source_files = 'CQMapSDK/Classes/**/*',\"framework/*.framework/Headers/*.h\" s.public_header_files = \"framework/*.framework/Headers/*.h\" s.vendored_frameworks = \"framework/*.framework\" s.frameworks = \"CoreLocation\", \"Foundation\", \"UIKit\", \"SystemConfiguration\", \"AdSupport\", \"Security\", \"CoreTelephony\" s.libraries = \"sqlite3.0\",\"c++\" s.requires_arc = true s.pod_target_xcconfig = { 'EXCLUDED_ARCHS[sdk=iphonesimulator*]' => 'arm64' } s.user_target_xcconfig = { 'EXCLUDED_ARCHS[sdk=iphonesimulator*]' => 'arm64' } å¢åŠ äº†ä»¥ä¸Šä»£ç ï¼Œæ‰§è¡Œpod update ç¬¬2æ­¥ï¼šå®šä¹‰å®šä½ç›¸å…³åè®®ï¼šLocationProtocolã€LocationManagerProtocolã€LocationManagerDelegateProtocol å®šä½æˆåŠŸï¼Œè¿”å›çš„å®šä½æ•°æ®åè®®ï¼š /// å®šä½æ•°æ® public protocol LocationProtocol: NSObjectProtocol { /// ä½ç½®æ•°æ® var location: CLLocation? { get } /// åˆå§‹åŒ–LocationProtocolå®ä¾‹ /// - Parameter loc: CLLocationå¯¹è±¡ init(location loc: CLLocation?) } å®šä½ç®¡ç†ä»£ç†åè®®ï¼š /// åœ°å›¾å®šä½ç®¡ç†ä»£ç†åè®® public protocol LocationManagerDelegateProtocol : NSObjectProtocol { /// ä¸ºäº†é€‚é…app storeå…³äºæ–°çš„åå°å®šä½çš„å®¡æ ¸æœºåˆ¶ï¼ˆapp storeè¦æ±‚å¦‚æœå¼€å‘è€…åªé…ç½®äº†ä½¿ç”¨æœŸé—´å®šä½ï¼Œåˆ™ä»£ç ä¸­ä¸èƒ½å‡ºç°ç”³è¯·åå°å®šä½çš„é€»è¾‘ï¼‰ï¼Œå½“å¼€å‘è€…åœ¨plisté…ç½®NSLocationAlwaysUsageDescriptionæˆ–è€…NSLocationAlwaysAndWhenInUseUsageDescriptionæ—¶ï¼Œéœ€è¦åœ¨è¯¥delegateä¸­è°ƒç”¨åå°å®šä½apiï¼š[locationManager requestAlwaysAuthorization]ã€‚å¼€å‘è€…å¦‚æœåªé…ç½®äº†NSLocationWhenInUseUsageDescriptionï¼Œä¸”åªæœ‰ä½¿ç”¨æœŸé—´çš„å®šä½éœ€æ±‚ï¼Œåˆ™æ— éœ€åœ¨delegateä¸­å®ç°é€»è¾‘ã€‚ /// - Parameters: /// - manager: å®šä½ LocationManagerProtocol å®ç°ç±»ã€‚ /// - locationManager: ç³»ç»Ÿ CLLocationManager ç±» ã€‚ func locationManager(_ manager: LocationManagerProtocol, doRequestAlwaysAuthorization locationManager: CLLocationManager) /// å½“å®šä½å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šè°ƒç”¨ä»£ç†çš„æ­¤æ–¹æ³•ã€‚ /// - Parameters: /// - manager: å®šä½ LocationManagerProtocol å®ç°ç±»ã€‚ /// - error: è¿”å›çš„é”™è¯¯ï¼Œå‚è€ƒ CLError func locationManager(_ manager: LocationManagerProtocol, didFailWithError error: Error?) /// è¿ç»­å®šä½å›è°ƒå‡½æ•°ã€‚ /// - Parameters: /// - manager: å®šä½ LocationManagerProtocol å®ç°ç±»ã€‚ /// - location: å®šä½ç»“æœ /// - error: é”™è¯¯ä¿¡æ¯ã€‚ func locationManager(_ manager: LocationManagerProtocol, didUpdate location: LocationProtocol?, orError error: Error?) /// æä¾›è®¾å¤‡æœå‘çš„å›è°ƒæ–¹æ³•ã€‚ /// - Parameters: /// - manager: å®šä½ LocationManagerProtocol å®ç°ç±»ã€‚ /// - heading: è®¾å¤‡çš„æœå‘ç»“æœ func locationManager(_ manager: LocationManagerProtocol, didUpdate heading: CLHeading?) } extension LocationManagerDelegateProtocol { func locationManager(_ manager: LocationManagerProtocol, doRequestAlwaysAuthorization locationManager: CLLocationManager) { } func locationManager(_ manager: LocationManagerProtocol, didFailWithError error: Error?){ } func locationManager(_ manager: LocationManagerProtocol, didUpdate location: LocationProtocol?, orError error: Error?){ } func locationManager(_ manager: LocationManagerProtocol, didUpdate heading: CLHeading?){ } } å®šä½ç®¡ç†åè®®ï¼š /// åœ°å›¾å®šä½ç®¡ç†åè®® public protocol LocationManagerProtocol: NSObjectProtocol { /// å®ç°äº† LocationManagerDelegateProtocol åè®®çš„ç±»æŒ‡é’ˆã€‚ var delegate: LocationManagerDelegateProtocol? { get set } /// å¼€å§‹è¿ç»­å®šä½ã€‚è°ƒç”¨æ­¤æ–¹æ³•ä¼šcancelæ‰æ‰€æœ‰çš„å•æ¬¡å®šä½è¯·æ±‚ã€‚ func startUpdatingLocation() /// åœæ­¢è¿ç»­å®šä½ã€‚è°ƒç”¨æ­¤æ–¹æ³•ä¼šcancelæ‰æ‰€æœ‰çš„å•æ¬¡å®šä½è¯·æ±‚ï¼Œå¯ä»¥ç”¨æ¥å–æ¶ˆå•æ¬¡å®šä½ã€‚ func stopUpdatingLocation() /// å¼€å§‹è®¾å¤‡æœå‘äº‹ä»¶å›è°ƒã€‚ func startUpdatingHeading() /// råœæ­¢è®¾å¤‡æœå‘äº‹ä»¶å›è°ƒã€‚ func stopUpdatingHeading() } ç¬¬3æ­¥ï¼šç™¾åº¦å®šä½SDKå®ç°ç±»ï¼šBaiduLocationã€BaiduLocationManagerã€BMKLocationManagerDelegateImpl ç™¾åº¦å®šä½æ•°æ®å®ç°ï¼š /// ç™¾åº¦å®šä½æ•°æ® class BaiduLocation: NSObject, LocationProtocol { /// ä½ç½®æ•°æ® private(set) var location: CLLocation? /// åˆå§‹åŒ–LocationProtocolå®ä¾‹ /// - Parameter loc: CLLocationå¯¹è±¡ required init(location loc: CLLocation?) { super.init() location = loc } } ç™¾åº¦å®šä½ç®¡ç†ä»£ç†å®ç°ï¼š /// ç™¾åº¦åœ°å›¾å®šä½ç®¡ç†ä»£ç†å®ç°ç±» class BMKLocationManagerDelegateImpl: NSObject, BMKLocationManagerDelegate { weak var delegate: LocationManagerDelegateProtocol? private var managerProtocol: LocationManagerProtocol! init(managerProtocol: LocationManagerProtocol) { super.init() self.managerProtocol = managerProtocol } func bmkLocationManager(_ manager: BMKLocationManager, doRequestAlwaysAuthorization locationManager: CLLocationManager) { delegate?.locationManager(managerProtocol, doRequestAlwaysAuthorization: locationManager) } func bmkLocationManager(_ manager: BMKLocationManager, didFailWithError error: Error?) { delegate?.locationManager(managerProtocol, didFailWithError: error) } func bmkLocationManager(_ manager: BMKLocationManager, didUpdate location: BMKLocation?, orError error: Error?) { let bmkLocation = BaiduLocation(location: location?.location) delegate?.locationManager(managerProtocol, didUpdate: bmkLocation, orError: error) } func bmkLocationManager(_ manager: BMKLocationManager, didUpdate heading: CLHeading?) { delegate?.locationManager(managerProtocol, didUpdate: heading) } } ç™¾åº¦å®šä½ç®¡ç†ï¼š /// ç™¾åº¦åœ°å›¾å®šä½ç®¡ç† class BaiduLocationManager: NSObject, LocationManagerProtocol { private lazy var delegateImpl: BMKLocationManagerDelegateImpl = { BMKLocationManagerDelegateImpl(managerProtocol: self) }() private lazy var locationManager: BMKLocationManager = { //åˆå§‹åŒ–BMKLocationManagerçš„å®ä¾‹ let manager = BMKLocationManager() //è®¾ç½®å®šä½ç®¡ç†ç±»å®ä¾‹çš„ä»£ç† manager.delegate = delegateImpl //è®¾å®šå®šä½åæ ‡ç³»ç±»å‹ï¼Œé»˜è®¤ä¸º BMKLocationCoordinateTypeGCJ02 manager.coordinateType = BMKLocationCoordinateType.BMK09LL //è®¾å®šå®šä½ç²¾åº¦ï¼Œé»˜è®¤ä¸º kCLLocationAccuracyBest manager.desiredAccuracy = kCLLocationAccuracyBest //è®¾å®šå®šä½ç±»å‹ï¼Œé»˜è®¤ä¸º CLActivityTypeAutomotiveNavigation manager.activityType = CLActivityType.automotiveNavigation //æŒ‡å®šå®šä½æ˜¯å¦ä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨æš‚åœï¼Œé»˜è®¤ä¸ºNO manager.pausesLocationUpdatesAutomatically = false /** æ˜¯å¦å…è®¸åå°å®šä½ï¼Œé»˜è®¤ä¸ºNOã€‚åªåœ¨iOS 9.0åŠä¹‹åèµ·ä½œç”¨ã€‚ è®¾ç½®ä¸ºYESçš„æ—¶å€™å¿…é¡»ä¿è¯ Background Modes ä¸­çš„ Location updates å¤„äºé€‰ä¸­çŠ¶æ€ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ ç”±äºiOSç³»ç»Ÿé™åˆ¶ï¼Œéœ€è¦åœ¨å®šä½æœªå¼€å§‹ä¹‹å‰æˆ–å®šä½åœæ­¢ä¹‹åï¼Œä¿®æ”¹è¯¥å±æ€§çš„å€¼æ‰ä¼šæœ‰æ•ˆæœã€‚ */ manager.allowsBackgroundLocationUpdates = false /** æŒ‡å®šå•æ¬¡å®šä½è¶…æ—¶æ—¶é—´,é»˜è®¤ä¸º10sï¼Œæœ€å°å€¼æ˜¯2sã€‚æ³¨æ„å•æ¬¡å®šä½è¯·æ±‚å‰è®¾ç½®ã€‚ æ³¨æ„: å•æ¬¡å®šä½è¶…æ—¶æ—¶é—´ä»ç¡®å®šäº†å®šä½æƒé™(ékCLAuthorizationStatusNotDeterminedçŠ¶æ€) åå¼€å§‹è®¡ç®—ã€‚ */ manager.locationTimeout = 10 return manager }() /// å®ç°äº† LocationManagerDelegateProtocol åè®®çš„ç±»æŒ‡é’ˆã€‚ weak var delegate: LocationManagerDelegateProtocol? { didSet { delegateImpl.delegate = delegate } } /// å¼€å§‹è¿ç»­å®šä½ã€‚è°ƒç”¨æ­¤æ–¹æ³•ä¼šcancelæ‰æ‰€æœ‰çš„å•æ¬¡å®šä½è¯·æ±‚ã€‚ func startUpdatingLocation() { locationManager.startUpdatingLocation() } /// åœæ­¢è¿ç»­å®šä½ã€‚è°ƒç”¨æ­¤æ–¹æ³•ä¼šcancelæ‰æ‰€æœ‰çš„å•æ¬¡å®šä½è¯·æ±‚ï¼Œå¯ä»¥ç”¨æ¥å–æ¶ˆå•æ¬¡å®šä½ã€‚ func stopUpdatingLocation() { locationManager.stopUpdatingLocation() } /// å¼€å§‹è®¾å¤‡æœå‘äº‹ä»¶å›è°ƒã€‚ func startUpdatingHeading() { locationManager.startUpdatingHeading() } /// råœæ­¢è®¾å¤‡æœå‘äº‹ä»¶å›è°ƒã€‚ func stopUpdatingHeading() { locationManager.stopUpdatingHeading() } } ç¬¬4æ­¥ï¼šé«˜å¾·å®šä½SDKå®ç°ç±»ï¼šGaodeLocationã€GaodeLocationManagerã€AMapLocationManagerDelegateImplï¼Œåç»­å†åšå…·ä½“æ–¹æ³•å®ç°ã€‚ /// é«˜å¾·å®šä½æ•°æ® class GaodeLocation: NSObject, LocationProtocol { /// ä½ç½®æ•°æ® private(set) var location: CLLocation? /// åˆå§‹åŒ–LocationProtocolå®ä¾‹ /// - Parameter loc: CLLocationå¯¹è±¡ required init(location loc: CLLocation?) { super.init() location = loc } } /// é«˜å¾·åœ°å›¾å®šä½ç®¡ç†ä»£ç†å®ç°ç±» class AMapLocationManagerDelegateImpl: NSObject { weak var delegate: LocationManagerDelegateProtocol? private var managerProtocol: LocationManagerProtocol! init(managerProtocol: LocationManagerProtocol) { super.init() self.managerProtocol = managerProtocol } } /// é«˜å¾·åœ°å›¾å®šä½ç®¡ç† class GaodeLocationManager: NSObject, LocationManagerProtocol { private lazy var delegateImpl: BMKLocationManagerDelegateImpl = { BMKLocationManagerDelegateImpl(managerProtocol: self) }() /// å®ç°äº† LocationManagerDelegateProtocol åè®®çš„ç±»æŒ‡é’ˆã€‚ weak var delegate: LocationManagerDelegateProtocol? { didSet { delegateImpl.delegate = delegate } } /// å¼€å§‹è¿ç»­å®šä½ã€‚è°ƒç”¨æ­¤æ–¹æ³•ä¼šcancelæ‰æ‰€æœ‰çš„å•æ¬¡å®šä½è¯·æ±‚ã€‚ func startUpdatingLocation() { } /// åœæ­¢è¿ç»­å®šä½ã€‚è°ƒç”¨æ­¤æ–¹æ³•ä¼šcancelæ‰æ‰€æœ‰çš„å•æ¬¡å®šä½è¯·æ±‚ï¼Œå¯ä»¥ç”¨æ¥å–æ¶ˆå•æ¬¡å®šä½ã€‚ func stopUpdatingLocation() { } /// å¼€å§‹è®¾å¤‡æœå‘äº‹ä»¶å›è°ƒã€‚ func startUpdatingHeading() { } /// råœæ­¢è®¾å¤‡æœå‘äº‹ä»¶å›è°ƒã€‚ func stopUpdatingHeading() { } } ç¬¬5æ­¥ï¼šæ–°å¢åŠä¿®æ”¹åœ°å›¾ç›¸å…³åè®® 1.æ–°å¢UserLocationProtocol /// ç”¨æˆ·å®šä½åè®® public protocol UserLocationProtocol: NSObjectProtocol { /// ä½ç½®æ›´æ–°çŠ¶æ€ï¼Œå¦‚æœæ­£åœ¨æ›´æ–°ä½ç½®ä¿¡æ¯ï¼Œåˆ™è¯¥å€¼ä¸ºYES var updating: Bool { get set } /// ä½ç½®ä¿¡æ¯ï¼Œå°šæœªå®šä½æˆåŠŸï¼Œåˆ™è¯¥å€¼ä¸ºnil var location: CLLocation? { get set } /// headingä¿¡æ¯ï¼Œå°šæœªå®šä½æˆåŠŸï¼Œåˆ™è¯¥å€¼ä¸ºnil var heading: CLHeading? { get set } /// å®šä½æ ‡æ³¨ç‚¹è¦æ˜¾ç¤ºçš„æ ‡é¢˜ä¿¡æ¯ var title: String? { get set } /// å®šä½æ ‡æ³¨ç‚¹è¦æ˜¾ç¤ºçš„å­æ ‡é¢˜ä¿¡æ¯ var subtitle: String? { get set } } 2.ä¿®æ”¹MapViewProtocol /// åœ°å›¾åè®® public protocol MapViewProtocol: NSObjectProtocol { ...... /// è®¾å®šæ˜¯å¦æ˜¾ç¤ºå®šä½å›¾å±‚ var showsUserLocation: Bool { get set } } 3.ä¿®æ”¹MapViewDelegateProtocol /// åœ°å›¾ä»£ç†åè®® public protocol MapViewDelegateProtocol: NSObjectProtocol { /// å½“plisté…ç½®NSLocationAlwaysUsageDescriptionæˆ–è€…NSLocationAlwaysAndWhenInUseUsageDescriptionï¼Œå¹¶ä¸”[CLLocationManager authorizationStatus] == kCLAuthorizationStatusNotDeterminedï¼Œä¼šè°ƒç”¨ä»£ç†çš„æ­¤æ–¹æ³•ã€‚æ­¤æ–¹æ³•å®ç°è°ƒç”¨åå°æƒé™APIå³å¯ï¼ˆ è¯¥å›è°ƒå¿…é¡»å®ç° [locationManager requestAlwaysAuthorization] ï¼‰; since 6.8.0 /// - Parameter locationManager: åœ°å›¾çš„CLLocationManagerã€‚ func mapViewRequireLocationAuth(_ mapView: MapViewProtocol, locationManager: CLLocationManager) } public extension MapViewDelegateProtocol { func mapViewRequireLocationAuth(_ mapView: MapViewProtocol, locationManager: CLLocationManager) { } } ç¬¬6æ­¥ï¼šæ–°å¢åŠä¿®æ”¹ç™¾åº¦åœ°å›¾ç›¸å…³åè®®å®ç° /// ç™¾åº¦ç”¨æˆ·å®šä½ class BaiduUserLocation: NSObject, UserLocationProtocol { /// ä½ç½®æ›´æ–°çŠ¶æ€ï¼Œå¦‚æœæ­£åœ¨æ›´æ–°ä½ç½®ä¿¡æ¯ï¼Œåˆ™è¯¥å€¼ä¸ºYES var updating: Bool = false /// ä½ç½®ä¿¡æ¯ï¼Œå°šæœªå®šä½æˆåŠŸï¼Œåˆ™è¯¥å€¼ä¸ºnil var location: CLLocation? /// headingä¿¡æ¯ï¼Œå°šæœªå®šä½æˆåŠŸï¼Œåˆ™è¯¥å€¼ä¸ºnil var heading: CLHeading? /// å®šä½æ ‡æ³¨ç‚¹è¦æ˜¾ç¤ºçš„æ ‡é¢˜ä¿¡æ¯ var title: String? /// å®šä½æ ‡æ³¨ç‚¹è¦æ˜¾ç¤ºçš„å­æ ‡é¢˜ä¿¡æ¯ var subtitle: String? } /// ç™¾åº¦åœ°å›¾ä»£ç†å®ç° class BMKMapViewDelegateImpl: NSObject, BMKMapViewDelegate { weak var delegate: MapViewDelegateProtocol? private weak var mapViewProtocol: MapViewProtocol! init(mapViewProtocol: MapViewProtocol) { super.init() self.mapViewProtocol = mapViewProtocol } } /// ç™¾åº¦åœ°å›¾ class BaiduMapView: NSObject, MapViewProtocol { ....... private lazy var mapDelegate: BMKMapViewDelegateImpl = { BMKMapViewDelegateImpl(mapViewProtocol: self) }() /// åˆå§‹åŒ– /// - Parameter frame: required init(frame: CGRect) { super.init() mapView = BMKMapView(frame: frame) mapView.delegate = mapDelegate } ...... /// åœ°å›¾ä»£ç† var delegate: MapViewDelegateProtocol? { didSet { if let delegate = delegate { mapDelegate.delegate = delegate } } } ...... /// åŠ¨æ€æ›´æ–°æˆ‘çš„ä½ç½®æ•°æ® /// - Parameter userLocation: å®šä½æ•°æ® func updateLocationData(_ userLocation: UserLocationProtocol) { let bmkUserLoc = BMKUserLocation() bmkUserLoc.location = userLocation.location mapView.updateLocationData(bmkUserLoc) } } ç¬¬7æ­¥ï¼šæ–°å¢åŠä¿®æ”¹é«˜å¾·åœ°å›¾ç›¸å…³åè®®å®ç° /// é«˜å¾·ç”¨æˆ·å®šä½ class GaodeUserLocation: NSObject, UserLocationProtocol { /// ä½ç½®æ›´æ–°çŠ¶æ€ï¼Œå¦‚æœæ­£åœ¨æ›´æ–°ä½ç½®ä¿¡æ¯ï¼Œåˆ™è¯¥å€¼ä¸ºYES var updating: Bool = false /// ä½ç½®ä¿¡æ¯ï¼Œå°šæœªå®šä½æˆåŠŸï¼Œåˆ™è¯¥å€¼ä¸ºnil var location: CLLocation? /// headingä¿¡æ¯ï¼Œå°šæœªå®šä½æˆåŠŸï¼Œåˆ™è¯¥å€¼ä¸ºnil var heading: CLHeading? /// å®šä½æ ‡æ³¨ç‚¹è¦æ˜¾ç¤ºçš„æ ‡é¢˜ä¿¡æ¯ var title: String? /// å®šä½æ ‡æ³¨ç‚¹è¦æ˜¾ç¤ºçš„å­æ ‡é¢˜ä¿¡æ¯ var subtitle: String? } /// é«˜å¾·åœ°å›¾ä»£ç†å®ç° class MAMapViewDelegateImpl: NSObject, MAMapViewDelegate { weak var delegate: MapViewDelegateProtocol? private weak var mapViewProtocol: MapViewProtocol! init(mapViewProtocol: MapViewProtocol) { super.init() self.mapViewProtocol = mapViewProtocol } /// å½“plisté…ç½®NSLocationAlwaysUsageDescriptionæˆ–è€…NSLocationAlwaysAndWhenInUseUsageDescriptionï¼Œå¹¶ä¸”[CLLocationManager authorizationStatus] == kCLAuthorizationStatusNotDeterminedï¼Œä¼šè°ƒç”¨ä»£ç†çš„æ­¤æ–¹æ³•ã€‚æ­¤æ–¹æ³•å®ç°è°ƒç”¨åå°æƒé™APIå³å¯ï¼ˆ è¯¥å›è°ƒå¿…é¡»å®ç° [locationManager requestAlwaysAuthorization] ï¼‰; since 6.8.0 /// - Parameter locationManager: åœ°å›¾çš„CLLocationManagerã€‚ func mapViewRequireLocationAuth(_ locationManager: CLLocationManager!) { delegate?.mapViewRequireLocationAuth(mapViewProtocol, locationManager: locationManager) } } /// é«˜å¾·åœ°å›¾ class GaodeMapView: NSObject, MapViewProtocol { ...... private lazy var mapDelegate: MAMapViewDelegateImpl = { MAMapViewDelegateImpl(mapViewProtocol: self) }() /// åˆå§‹åŒ– /// - Parameter frame: required init(frame: CGRect) { super.init() mapView = MAMapView(frame: frame) mapView.delegate = mapDelegate } ...... /// åœ°å›¾ä»£ç† var delegate: MapViewDelegateProtocol? { didSet { if let delegate = delegate { mapDelegate.delegate = delegate } } } ...... /// åŠ¨æ€æ›´æ–°æˆ‘çš„ä½ç½®æ•°æ® /// - Parameter userLocation: å®šä½æ•°æ® func updateLocationData(_ userLocation: UserLocationProtocol) { } } ç¬¬8æ­¥ï¼šä¿®æ”¹å·¥å‚åè®®åŠå®ç° /// åœ°å›¾å·¥å‚æ ‡å‡† public protocol MapFactoryProtocol: NSObjectProtocol { ...... /// è·å–å®šä½ç®¡ç†å¯¹è±¡ func getLocationManager() -> LocationManagerProtocol /// è·å–ç”¨æˆ·å®šä½æ•°æ® func getUserLocation() -> UserLocationProtocol } /// é«˜å¾·åœ°å›¾å·¥å‚ class BaiduMapFactory: NSObject, MapFactoryProtocol { ...... /// åˆå§‹åŒ– /// - Parameter appKey: ç¬¬ä¸‰æ–¹åœ°å›¾AppKey required init(appKey: String) { super.init() BMKLocationAuth.sharedInstance()?.checkPermision(withKey: appKey, authDelegate: self) ...... } ...... /// è·å–å®šä½ç®¡ç†å¯¹è±¡ func getLocationManager() -> LocationManagerProtocol { return BaiduLocationManager() } /// è·å–ç”¨æˆ·å®šä½æ•°æ® func getUserLocation() -> UserLocationProtocol { return BaiduUserLocation() } } /// é«˜å¾·åœ°å›¾å·¥å‚ class GaodeMapFactory: NSObject, MapFactoryProtocol { ...... /// è·å–å®šä½ç®¡ç†å¯¹è±¡ func getLocationManager() -> LocationManagerProtocol { return GaodeLocationManager() } /// è·å–ç”¨æˆ·å®šä½æ•°æ® func getUserLocation() -> UserLocationProtocol { return GaodeUserLocation() } } ç¬¬9æ­¥ï¼šéªŒè¯ç™¾åº¦åœ°å›¾æ˜¾ç¤ºå®šä½ class ViewController: UIViewController { /// åœ°å›¾å®ä¾‹ private var mapView: MapViewProtocol! /// ç”¨æˆ·å®šä½å®ä¾‹ private var userLocation: UserLocationProtocol! /// å®šä½ç®¡ç†å®ä¾‹ private var locationManager: LocationManagerProtocol! override func viewDidLoad() { super.viewDidLoad() // è·å–åœ°å›¾å·¥å‚ let engine = MapEngine() let factory = engine.getFactory()! // å¼€å¯å®šä½ userLocation = factory.getUserLocation() locationManager = factory.getLocationManager() locationManager.delegate = self locationManager.startUpdatingHeading() locationManager.startUpdatingLocation() // æ˜¾ç¤ºåœ°å›¾ mapView = factory.getMapView(frame: view.bounds) // è®¾ç½®ä»£ç† mapView.delegate = self // æ˜¾ç¤ºç”¨æˆ·å®šä½(æ”¾åœ¨è®¾ç½®ä»£ç†ä¹‹åï¼Œç¡®ä¿å¯ä»¥è°ƒç”¨locationManager.requestAlwaysAuthorization()) mapView.showsUserLocation = true view.addSubview(mapView.getView()) } ...... } extension ViewController: MapViewDelegateProtocol { /// å½“plisté…ç½®NSLocationAlwaysUsageDescriptionæˆ–è€…NSLocationAlwaysAndWhenInUseUsageDescriptionï¼Œå¹¶ä¸”[CLLocationManager authorizationStatus] == kCLAuthorizationStatusNotDeterminedï¼Œä¼šè°ƒç”¨ä»£ç†çš„æ­¤æ–¹æ³•ã€‚æ­¤æ–¹æ³•å®ç°è°ƒç”¨åå°æƒé™APIå³å¯ï¼ˆ è¯¥å›è°ƒå¿…é¡»å®ç° [locationManager requestAlwaysAuthorization] ï¼‰; since 6.8.0 /// - Parameter locationManager: åœ°å›¾çš„CLLocationManagerã€‚ func mapViewRequireLocationAuth(_ mapView: MapViewProtocol, locationManager: CLLocationManager) { locationManager.requestAlwaysAuthorization() } } extension ViewController: LocationManagerDelegateProtocol { /// ä¸ºäº†é€‚é…app storeå…³äºæ–°çš„åå°å®šä½çš„å®¡æ ¸æœºåˆ¶ï¼ˆapp storeè¦æ±‚å¦‚æœå¼€å‘è€…åªé…ç½®äº†ä½¿ç”¨æœŸé—´å®šä½ï¼Œåˆ™ä»£ç ä¸­ä¸èƒ½å‡ºç°ç”³è¯·åå°å®šä½çš„é€»è¾‘ï¼‰ï¼Œå½“å¼€å‘è€…åœ¨plisté…ç½®NSLocationAlwaysUsageDescriptionæˆ–è€…NSLocationAlwaysAndWhenInUseUsageDescriptionæ—¶ï¼Œéœ€è¦åœ¨è¯¥delegateä¸­è°ƒç”¨åå°å®šä½apiï¼š[locationManager requestAlwaysAuthorization]ã€‚å¼€å‘è€…å¦‚æœåªé…ç½®äº†NSLocationWhenInUseUsageDescriptionï¼Œä¸”åªæœ‰ä½¿ç”¨æœŸé—´çš„å®šä½éœ€æ±‚ï¼Œåˆ™æ— éœ€åœ¨delegateä¸­å®ç°é€»è¾‘ã€‚ /// - Parameters: /// - manager: å®šä½ LocationManagerProtocol å®ç°ç±»ã€‚ /// - locationManager: ç³»ç»Ÿ CLLocationManager ç±» ã€‚ func locationManager(_ manager: LocationManagerProtocol, doRequestAlwaysAuthorization locationManager: CLLocationManager) { locationManager.requestAlwaysAuthorization() } /// å½“å®šä½å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šè°ƒç”¨ä»£ç†çš„æ­¤æ–¹æ³•ã€‚ /// - Parameters: /// - manager: å®šä½ LocationManagerProtocol å®ç°ç±»ã€‚ /// - error: è¿”å›çš„é”™è¯¯ï¼Œå‚è€ƒ CLError func locationManager(_ manager: LocationManagerProtocol, didFailWithError error: Error?) { NSLog(\"å®šä½å¤±è´¥\") } /// è¿ç»­å®šä½å›è°ƒå‡½æ•°ã€‚ /// - Parameters: /// - manager: å®šä½ LocationManagerProtocol å®ç°ç±»ã€‚ /// - location: å®šä½ç»“æœ /// - error: é”™è¯¯ä¿¡æ¯ã€‚ func locationManager(_ manager: LocationManagerProtocol, didUpdate location: LocationProtocol?, orError error: Error?) { if let _ = error?.localizedDescription { print(\"locError:(error?.localizedDescription)!\") } print(\"ç”¨æˆ·å®šä½æ›´æ–°\") userLocation.location = location?.location //å®ç°è¯¥æ–¹æ³•ï¼Œå¦åˆ™å®šä½å›¾æ ‡ä¸å‡ºç° mapView.updateLocationData(userLocation) } /// æä¾›è®¾å¤‡æœå‘çš„å›è°ƒæ–¹æ³•ã€‚ /// - Parameters: /// - manager: å®šä½ LocationManagerProtocol å®ç°ç±»ã€‚ /// - heading: è®¾å¤‡çš„æœå‘ç»“æœ func locationManager(_ manager: LocationManagerProtocol, didUpdate heading: CLHeading?) { print((\"ç”¨æˆ·æ–¹å‘æ›´æ–°\")) userLocation.heading = heading mapView.updateLocationData(userLocation) } } è¿™æ ·å°±å¯ä»¥æˆåŠŸæ˜¾ç¤ºç™¾åº¦å®šä½å•¦ï¼ "},"pages/åœ°å›¾èšåˆSDK/04_é›†æˆé«˜å¾·å®šä½.html":{"url":"pages/åœ°å›¾èšåˆSDK/04_é›†æˆé«˜å¾·å®šä½.html","title":"4.é›†æˆé«˜å¾·å®šä½","keywords":"","body":"4.é›†æˆé«˜å¾·å®šä½ ä¹ã€é›†æˆé«˜å¾·å®šä½ ç¬¬1æ­¥ï¼šä¿®æ”¹CQMapSDK.podspec æ–°å¢ä¾èµ–s.dependency 'AMapLocation', '2.6.8',æ‰§è¡Œpod update ç¬¬2æ­¥ï¼šä¿®æ”¹é«˜å¾·å®šä½å®ç° import AMapLocationKit /// é«˜å¾·åœ°å›¾å®šä½ç®¡ç†ä»£ç†å®ç°ç±» class AMapLocationManagerDelegateImpl: NSObject, AMapLocationManagerDelegate { weak var delegate: LocationManagerDelegateProtocol? private var managerProtocol: LocationManagerProtocol! init(managerProtocol: LocationManagerProtocol) { super.init() self.managerProtocol = managerProtocol } func amapLocationManager(_ manager: AMapLocationManager!, didFailWithError error: Error!) { delegate?.locationManager(managerProtocol, didFailWithError: error) } func amapLocationManager(_ manager: AMapLocationManager!, didUpdate location: CLLocation!) { let amapLocation = GaodeLocation(location: location) delegate?.locationManager(managerProtocol, didUpdate: amapLocation, orError: nil) } func amapLocationManager(_ manager: AMapLocationManager!, didUpdate newHeading: CLHeading!) { delegate?.locationManager(managerProtocol, didUpdate: newHeading) } } ç¬¬3æ­¥ï¼šæ›´æ–°å®šä½ç®¡ç† import AMapLocationKit /// é«˜å¾·åœ°å›¾å®šä½ç®¡ç† class GaodeLocationManager: NSObject, LocationManagerProtocol { private lazy var delegateImpl: AMapLocationManagerDelegateImpl = { AMapLocationManagerDelegateImpl(managerProtocol: self) }() private lazy var locationManager: AMapLocationManager = { //åˆå§‹åŒ–BMKLocationManagerçš„å®ä¾‹ let manager = AMapLocationManager() //è®¾ç½®å®šä½ç®¡ç†ç±»å®ä¾‹çš„ä»£ç† manager.delegate = delegateImpl //è®¾å®šå®šä½åæ ‡ç³»ç±»å‹ï¼Œé»˜è®¤ä¸º BMKLocationCoordinateTypeGCJ02 //manager.coordinateType = BMKLocationCoordinateType.BMK09LL //è®¾å®šå®šä½ç²¾åº¦ï¼Œé»˜è®¤ä¸º kCLLocationAccuracyBest manager.desiredAccuracy = kCLLocationAccuracyBest //è®¾å®šå®šä½ç±»å‹ï¼Œé»˜è®¤ä¸º CLActivityTypeAutomotiveNavigation //manager.activityType = CLActivityType.automotiveNavigation //æŒ‡å®šå®šä½æ˜¯å¦ä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨æš‚åœï¼Œé»˜è®¤ä¸ºNO manager.pausesLocationUpdatesAutomatically = false /** æ˜¯å¦å…è®¸åå°å®šä½ï¼Œé»˜è®¤ä¸ºNOã€‚åªåœ¨iOS 9.0åŠä¹‹åèµ·ä½œç”¨ã€‚ è®¾ç½®ä¸ºYESçš„æ—¶å€™å¿…é¡»ä¿è¯ Background Modes ä¸­çš„ Location updates å¤„äºé€‰ä¸­çŠ¶æ€ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ ç”±äºiOSç³»ç»Ÿé™åˆ¶ï¼Œéœ€è¦åœ¨å®šä½æœªå¼€å§‹ä¹‹å‰æˆ–å®šä½åœæ­¢ä¹‹åï¼Œä¿®æ”¹è¯¥å±æ€§çš„å€¼æ‰ä¼šæœ‰æ•ˆæœã€‚ */ manager.allowsBackgroundLocationUpdates = false /** æŒ‡å®šå•æ¬¡å®šä½è¶…æ—¶æ—¶é—´,é»˜è®¤ä¸º10sï¼Œæœ€å°å€¼æ˜¯2sã€‚æ³¨æ„å•æ¬¡å®šä½è¯·æ±‚å‰è®¾ç½®ã€‚ æ³¨æ„: å•æ¬¡å®šä½è¶…æ—¶æ—¶é—´ä»ç¡®å®šäº†å®šä½æƒé™(ékCLAuthorizationStatusNotDeterminedçŠ¶æ€) åå¼€å§‹è®¡ç®—ã€‚ */ manager.locationTimeout = 10 return manager }() /// å®ç°äº† LocationManagerDelegateProtocol åè®®çš„ç±»æŒ‡é’ˆã€‚ weak var delegate: LocationManagerDelegateProtocol? { didSet { delegateImpl.delegate = delegate } } /// å¼€å§‹è¿ç»­å®šä½ã€‚è°ƒç”¨æ­¤æ–¹æ³•ä¼šcancelæ‰æ‰€æœ‰çš„å•æ¬¡å®šä½è¯·æ±‚ã€‚ func startUpdatingLocation() { locationManager.startUpdatingLocation() } /// åœæ­¢è¿ç»­å®šä½ã€‚è°ƒç”¨æ­¤æ–¹æ³•ä¼šcancelæ‰æ‰€æœ‰çš„å•æ¬¡å®šä½è¯·æ±‚ï¼Œå¯ä»¥ç”¨æ¥å–æ¶ˆå•æ¬¡å®šä½ã€‚ func stopUpdatingLocation() { locationManager.stopUpdatingLocation() } /// å¼€å§‹è®¾å¤‡æœå‘äº‹ä»¶å›è°ƒã€‚ func startUpdatingHeading() { locationManager.startUpdatingHeading() } /// råœæ­¢è®¾å¤‡æœå‘äº‹ä»¶å›è°ƒã€‚ func stopUpdatingHeading() { locationManager.stopUpdatingHeading() } } "},"pages/åœ°å›¾èšåˆSDK/05_æ–°å¢å®šä½å±æ€§.html":{"url":"pages/åœ°å›¾èšåˆSDK/05_æ–°å¢å®šä½å±æ€§.html","title":"5.æ–°å¢å®šä½å±æ€§","keywords":"","body":"5.æ–°å¢å®šä½å±æ€§ åã€æ–°å¢å®šä½å±æ€§ ç¬¬1æ­¥ï¼šä¿®æ”¹å®šä½ç®¡ç†åè®® /// åœ°å›¾å®šä½ç®¡ç†åè®® public protocol LocationManagerProtocol: NSObjectProtocol { ///è®¾å®šæœŸæœ›çš„å®šä½ç²¾åº¦ã€‚å•ä½ç±³ï¼Œé»˜è®¤ä¸º kCLLocationAccuracyBestã€‚å®šä½æœåŠ¡ä¼šå°½å¯èƒ½å»è·å–æ»¡è¶³desiredAccuracyçš„å®šä½ç»“æœï¼Œä½†ä¸ä¿è¯ä¸€å®šä¼šå¾—åˆ°æ»¡è¶³æœŸæœ›çš„ç»“æœã€‚ ///æ³¨æ„ï¼šè®¾ç½®ä¸ºkCLLocationAccuracyBestæˆ–kCLLocationAccuracyBestForNavigationæ—¶ï¼Œå•æ¬¡å®šä½ä¼šåœ¨è¾¾åˆ°locationTimeoutè®¾å®šçš„æ—¶é—´åï¼Œå°†æ—¶é—´å†…è·å–åˆ°çš„æœ€é«˜ç²¾åº¦çš„å®šä½ç»“æœè¿”å›ã€‚ ///âš ï¸ å½“iOS14åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæ¨¡ç³Šå®šä½æƒé™ä¸‹å¯èƒ½æ‹¿ä¸åˆ°è®¾ç½®ç²¾åº¦çš„ç»çº¬åº¦ var desiredAccuracy: CLLocationAccuracy { get set } ///è®¾å®šå®šä½çš„æœ€å°æ›´æ–°è·ç¦»ã€‚å•ä½ç±³ï¼Œé»˜è®¤ä¸º kCLDistanceFilterNoneï¼Œè¡¨ç¤ºåªè¦æ£€æµ‹åˆ°è®¾å¤‡ä½ç½®å‘ç”Ÿå˜åŒ–å°±ä¼šæ›´æ–°ä½ç½®ä¿¡æ¯ã€‚ var distanceFilter: CLLocationDistance { get set } ///æŒ‡å®šå®šä½æ˜¯å¦ä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨æš‚åœã€‚é»˜è®¤ä¸ºNOã€‚ var pausesLocationUpdatesAutomatically: Bool { get set } ///æ˜¯å¦å…è®¸åå°å®šä½ã€‚é»˜è®¤ä¸ºNOã€‚åªåœ¨iOS 9.0åŠä¹‹åèµ·ä½œç”¨ã€‚è®¾ç½®ä¸ºYESçš„æ—¶å€™å¿…é¡»ä¿è¯ Background Modes ä¸­çš„ Location updates å¤„äºé€‰ä¸­çŠ¶æ€ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ç”±äºiOSç³»ç»Ÿé™åˆ¶ï¼Œéœ€è¦åœ¨å®šä½æœªå¼€å§‹ä¹‹å‰æˆ–å®šä½åœæ­¢ä¹‹åï¼Œä¿®æ”¹è¯¥å±æ€§çš„å€¼æ‰ä¼šæœ‰æ•ˆæœã€‚ var allowsBackgroundLocationUpdates: Bool { get set } ///æŒ‡å®šå•æ¬¡å®šä½è¶…æ—¶æ—¶é—´,é»˜è®¤ä¸º10sã€‚æœ€å°å€¼æ˜¯2sã€‚æ³¨æ„å•æ¬¡å®šä½è¯·æ±‚å‰è®¾ç½®ã€‚æ³¨æ„: å•æ¬¡å®šä½è¶…æ—¶æ—¶é—´ä»ç¡®å®šäº†å®šä½æƒé™(ékCLAuthorizationStatusNotDeterminedçŠ¶æ€)åå¼€å§‹è®¡ç®—ã€‚ var locationTimeout: Int { get set } ///æŒ‡å®šå•æ¬¡å®šä½é€†åœ°ç†è¶…æ—¶æ—¶é—´,é»˜è®¤ä¸º5sã€‚æœ€å°å€¼æ˜¯2sã€‚æ³¨æ„å•æ¬¡å®šä½è¯·æ±‚å‰è®¾ç½®ã€‚ var reGeocodeTimeout: Int { get set } ...... } ç¬¬2æ­¥ï¼šä¿®æ”¹é«˜å¾·ç™¾åº¦å®ç° ///è®¾å®šæœŸæœ›çš„å®šä½ç²¾åº¦ã€‚å•ä½ç±³ï¼Œé»˜è®¤ä¸º kCLLocationAccuracyBestã€‚å®šä½æœåŠ¡ä¼šå°½å¯èƒ½å»è·å–æ»¡è¶³desiredAccuracyçš„å®šä½ç»“æœï¼Œä½†ä¸ä¿è¯ä¸€å®šä¼šå¾—åˆ°æ»¡è¶³æœŸæœ›çš„ç»“æœã€‚ ///æ³¨æ„ï¼šè®¾ç½®ä¸ºkCLLocationAccuracyBestæˆ–kCLLocationAccuracyBestForNavigationæ—¶ï¼Œå•æ¬¡å®šä½ä¼šåœ¨è¾¾åˆ°locationTimeoutè®¾å®šçš„æ—¶é—´åï¼Œå°†æ—¶é—´å†…è·å–åˆ°çš„æœ€é«˜ç²¾åº¦çš„å®šä½ç»“æœè¿”å›ã€‚ ///âš ï¸ å½“iOS14åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæ¨¡ç³Šå®šä½æƒé™ä¸‹å¯èƒ½æ‹¿ä¸åˆ°è®¾ç½®ç²¾åº¦çš„ç»çº¬åº¦ var desiredAccuracy: CLLocationAccuracy = kCLLocationAccuracyBest { willSet { locationManager.desiredAccuracy = newValue } } ///è®¾å®šå®šä½çš„æœ€å°æ›´æ–°è·ç¦»ã€‚å•ä½ç±³ï¼Œé»˜è®¤ä¸º kCLDistanceFilterNoneï¼Œè¡¨ç¤ºåªè¦æ£€æµ‹åˆ°è®¾å¤‡ä½ç½®å‘ç”Ÿå˜åŒ–å°±ä¼šæ›´æ–°ä½ç½®ä¿¡æ¯ã€‚ var distanceFilter: CLLocationDistance = kCLDistanceFilterNone { willSet { locationManager.distanceFilter = newValue } } ///æŒ‡å®šå®šä½æ˜¯å¦ä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨æš‚åœã€‚é»˜è®¤ä¸ºNOã€‚ var pausesLocationUpdatesAutomatically: Bool = false { willSet { locationManager.pausesLocationUpdatesAutomatically = newValue } } ///æ˜¯å¦å…è®¸åå°å®šä½ã€‚é»˜è®¤ä¸ºNOã€‚åªåœ¨iOS 9.0åŠä¹‹åèµ·ä½œç”¨ã€‚è®¾ç½®ä¸ºYESçš„æ—¶å€™å¿…é¡»ä¿è¯ Background Modes ä¸­çš„ Location updates å¤„äºé€‰ä¸­çŠ¶æ€ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ç”±äºiOSç³»ç»Ÿé™åˆ¶ï¼Œéœ€è¦åœ¨å®šä½æœªå¼€å§‹ä¹‹å‰æˆ–å®šä½åœæ­¢ä¹‹åï¼Œä¿®æ”¹è¯¥å±æ€§çš„å€¼æ‰ä¼šæœ‰æ•ˆæœã€‚ var allowsBackgroundLocationUpdates: Bool = false { willSet { locationManager.allowsBackgroundLocationUpdates = newValue } } ///æŒ‡å®šå•æ¬¡å®šä½è¶…æ—¶æ—¶é—´,é»˜è®¤ä¸º10sã€‚æœ€å°å€¼æ˜¯2sã€‚æ³¨æ„å•æ¬¡å®šä½è¯·æ±‚å‰è®¾ç½®ã€‚æ³¨æ„: å•æ¬¡å®šä½è¶…æ—¶æ—¶é—´ä»ç¡®å®šäº†å®šä½æƒé™(ékCLAuthorizationStatusNotDeterminedçŠ¶æ€)åå¼€å§‹è®¡ç®—ã€‚ var locationTimeout: Int = 10 { willSet { locationManager.locationTimeout = newValue } } ///æŒ‡å®šå•æ¬¡å®šä½é€†åœ°ç†è¶…æ—¶æ—¶é—´,é»˜è®¤ä¸º5sã€‚æœ€å°å€¼æ˜¯2sã€‚æ³¨æ„å•æ¬¡å®šä½è¯·æ±‚å‰è®¾ç½®ã€‚ var reGeocodeTimeout: Int = 5 { willSet { locationManager.reGeocodeTimeout = newValue } } "},"pages/åœ°å›¾èšåˆSDK/06_æ–°å¢å•æ¬¡å®šä½.html":{"url":"pages/åœ°å›¾èšåˆSDK/06_æ–°å¢å•æ¬¡å®šä½.html","title":"6.æ–°å¢å•æ¬¡å®šä½","keywords":"","body":"6.æ–°å¢å•æ¬¡å®šä½ åä¸€ã€æ–°å¢å•æ¬¡å®šä½ ç¬¬1æ­¥ï¼šå®šä¹‰å®šä½å›è°ƒ /// å•æ¬¡å®šä½å›è°ƒ public typealias LocatingCompletionBlock = (LocationProtocol?, Error?) -> Void ç¬¬2æ­¥ï¼šä¿®æ”¹å®šä½ç®¡ç†åè®® /// åœ°å›¾å®šä½ç®¡ç†åè®® public protocol LocationManagerProtocol: NSObjectProtocol { ...... /// - Parameters: /// - withReGeocode: æ˜¯å¦å¸¦æœ‰é€†åœ°ç†ä¿¡æ¯(è·å–é€†åœ°ç†ä¿¡æ¯éœ€è¦è”ç½‘) /// - withNetworkState: æ˜¯å¦å¸¦æœ‰ç§»åŠ¨çƒ­ç‚¹è¯†åˆ«çŠ¶æ€(éœ€è¦è”ç½‘) /// - completionBlock: å•æ¬¡å®šä½å®Œæˆåçš„Block /// - return: æ˜¯å¦æˆåŠŸæ·»åŠ å•æ¬¡å®šä½Request func requestLocation(withReGeocode code: Bool, withNetworkState state: Bool, completionBlock: @escaping LocatingCompletionBlock) -> Bool } ç¬¬3æ­¥ï¼šå¢åŠ ç™¾åº¦åœ°å›¾å®ç° /// ç™¾åº¦åœ°å›¾å®šä½ç®¡ç† class BaiduLocationManager: NSObject, LocationManagerProtocol { ...... /// - Parameters: /// - withReGeocode: æ˜¯å¦å¸¦æœ‰é€†åœ°ç†ä¿¡æ¯(è·å–é€†åœ°ç†ä¿¡æ¯éœ€è¦è”ç½‘) /// - withNetworkState: æ˜¯å¦å¸¦æœ‰ç§»åŠ¨çƒ­ç‚¹è¯†åˆ«çŠ¶æ€(éœ€è¦è”ç½‘) /// - completionBlock: å•æ¬¡å®šä½å®Œæˆåçš„Block /// - return: æ˜¯å¦æˆåŠŸæ·»åŠ å•æ¬¡å®šä½Request func requestLocation(withReGeocode code: Bool, withNetworkState state: Bool, completionBlock: @escaping LocatingCompletionBlock) -> Bool { let block: BMKLocatingCompletionBlock = { (bmkLocation, state, error) -> Void in let location = BaiduLocation(location: bmkLocation?.location) completionBlock(location, error) } return locationManager.requestLocation(withReGeocode: code, withNetworkState: state, completionBlock: block) } } åäºŒã€æ–°å¢åœ°å›¾æ›´å¤šå±æ€§ ç¬¬1æ­¥ï¼šåœ°å›¾åè®®ä¿®æ”¹ /// åœ°å›¾åè®® public protocol MapViewProtocol: NSObjectProtocol { ...... /// å½“å‰åœ°å›¾çš„ä¸­å¿ƒç‚¹ï¼Œæ”¹å˜è¯¥å€¼æ—¶ï¼Œåœ°å›¾çš„æ¯”ä¾‹å°ºçº§åˆ«ä¸ä¼šå‘ç”Ÿå˜åŒ– var centerCoordinate: CLLocationCoordinate2D? { get set } /// å®šä½ç”¨æˆ·ä½ç½®çš„æ¨¡å¼ var userTrackingMode: UserTrackingMode { get set } /// åŠ¨æ€æ›´æ–°æˆ‘çš„ä½ç½®æ•°æ® /// - Parameter userLocation: å®šä½æ•°æ® func updateLocationData(_ userLocation: UserLocationProtocol?) } ç¬¬2æ­¥ï¼šæ›´æ–°åœ°å›¾å®ç° é«˜å¾·åœ°å›¾ /// é«˜å¾·åœ°å›¾ class GaodeMapView: NSObject, MapViewProtocol { ...... /// å½“å‰åœ°å›¾çš„ä¸­å¿ƒç‚¹ï¼Œæ”¹å˜è¯¥å€¼æ—¶ï¼Œåœ°å›¾çš„æ¯”ä¾‹å°ºçº§åˆ«ä¸ä¼šå‘ç”Ÿå˜åŒ– var centerCoordinate: CLLocationCoordinate2D? { didSet { if let centerCoordinate = centerCoordinate { mapView.centerCoordinate = centerCoordinate } } } /// å®šä½ç”¨æˆ·ä½ç½®çš„æ¨¡å¼ var userTrackingMode: UserTrackingMode = .none { didSet { switch userTrackingMode { case .none:/// æ™®é€šå®šä½æ¨¡å¼ mapView.userTrackingMode = .none break case .heading:/// å®šä½æ–¹å‘æ¨¡å¼ mapView.userTrackingMode = .none break case .follow:/// å®šä½è·Ÿéšæ¨¡å¼ mapView.userTrackingMode = .follow break case .followWithHeading:/// å®šä½ç½—ç›˜æ¨¡å¼ mapView.userTrackingMode = .followWithHeading break } } } /// åŠ¨æ€æ›´æ–°æˆ‘çš„ä½ç½®æ•°æ® /// - Parameter userLocation: å®šä½æ•°æ® func updateLocationData(_ userLocation: UserLocationProtocol?) { } } ç™¾åº¦åœ°å›¾ /// ç™¾åº¦åœ°å›¾ class BaiduMapView: NSObject, MapViewProtocol { ...... /// å½“å‰åœ°å›¾çš„ä¸­å¿ƒç‚¹ï¼Œæ”¹å˜è¯¥å€¼æ—¶ï¼Œåœ°å›¾çš„æ¯”ä¾‹å°ºçº§åˆ«ä¸ä¼šå‘ç”Ÿå˜åŒ– var centerCoordinate: CLLocationCoordinate2D? { didSet { if let centerCoordinate = centerCoordinate { mapView.centerCoordinate = centerCoordinate } } } /// å®šä½ç”¨æˆ·ä½ç½®çš„æ¨¡å¼ var userTrackingMode: UserTrackingMode = .none { didSet { switch userTrackingMode { case .none:/// æ™®é€šå®šä½æ¨¡å¼ mapView.userTrackingMode = BMKUserTrackingModeNone break case .heading:/// å®šä½æ–¹å‘æ¨¡å¼ mapView.userTrackingMode = BMKUserTrackingModeHeading break case .follow:/// å®šä½è·Ÿéšæ¨¡å¼ mapView.userTrackingMode = BMKUserTrackingModeFollow break case .followWithHeading:/// å®šä½ç½—ç›˜æ¨¡å¼ mapView.userTrackingMode = BMKUserTrackingModeFollowWithHeading break } } } /// åŠ¨æ€æ›´æ–°æˆ‘çš„ä½ç½®æ•°æ® /// - Parameter userLocation: å®šä½æ•°æ® func updateLocationData(_ userLocation: UserLocationProtocol?) { guard let userLocation = userLocation else { return } let bmkUserLoc = BMKUserLocation() bmkUserLoc.location = userLocation.location mapView.updateLocationData(bmkUserLoc) } } ç¬¬3æ­¥ï¼šæµ‹è¯• å•æ¬¡å®šä½å®Œæˆè®¾ç½®å®šä½ä¸ºåœ°å›¾ä¸­å¿ƒ /// å•æ¬¡å®šä½ private func singleRequestLocation() { _ = locationManager.requestLocation(withReGeocode: true, withNetworkState: true) {[weak self] (location, error) in if let error = error { print(\"å•æ¬¡å®šä½å¤±è´¥ï¼š\", error.localizedDescription) } else { let latitude = location?.location?.coordinate.latitude ?? 0 let longitude = location?.location?.coordinate.longitude ?? 0 print(\"å•æ¬¡å®šä½æˆåŠŸï¼šaltitude:\\(latitude),longitude:\\(longitude)\") self?.userLocation.location = location?.location // å®ç°è¯¥æ–¹æ³•ï¼Œå¦åˆ™å®šä½å›¾æ ‡ä¸å‡ºç° if let userLocation = self?.userLocation { self?.mapView.updateLocationData(userLocation) } // è®¾ç½®ä¸­å¿ƒç‚¹ self?.mapView.centerCoordinate = location?.location?.coordinate } } } ç¬¬4æ­¥ï¼šå¢åŠ é«˜å¾·åœ°å›¾å®ç° æ³¨æ„ï¼šé«˜å¾·åœ°å›¾è¦å®ç°å•æ¬¡å®šä½ï¼Œéœ€è¦ä¿è¯\"Background Modes\"ä¸­çš„\"Location updates\"å¤„äºé€‰ä¸­çŠ¶æ€ã€‚ /// é«˜å¾·åœ°å›¾å®šä½ç®¡ç† class GaodeLocationManager: NSObject, LocationManagerProtocol { ...... /// - Parameters: /// - withReGeocode: æ˜¯å¦å¸¦æœ‰é€†åœ°ç†ä¿¡æ¯(è·å–é€†åœ°ç†ä¿¡æ¯éœ€è¦è”ç½‘) /// - withNetworkState: æ˜¯å¦å¸¦æœ‰ç§»åŠ¨çƒ­ç‚¹è¯†åˆ«çŠ¶æ€(éœ€è¦è”ç½‘) /// - completionBlock: å•æ¬¡å®šä½å®Œæˆåçš„Block /// - return: æ˜¯å¦æˆåŠŸæ·»åŠ å•æ¬¡å®šä½Request func requestLocation(withReGeocode code: Bool, withNetworkState state: Bool, completionBlock: @escaping LocatingCompletionBlock) -> Bool { let block: AMapLocatingCompletionBlock = { (amapLocation, regeocode, error) -> Void in let location = GaodeLocation(location: amapLocation) completionBlock(location, error) } return locationManager.requestLocation(withReGeocode: code, completionBlock: block) } } "},"pages/åœ°å›¾èšåˆSDK/07_ä¸°å¯Œåœ°å›¾ä»£ç†.html":{"url":"pages/åœ°å›¾èšåˆSDK/07_ä¸°å¯Œåœ°å›¾ä»£ç†.html","title":"7.ä¸°å¯Œåœ°å›¾ä»£ç†","keywords":"","body":"7.ä¸°å¯Œåœ°å›¾ä»£ç† åä¸‰ã€ä¸°å¯Œåœ°å›¾ä»£ç† ç¬¬1æ­¥ï¼šä¿®æ”¹åœ°å›¾ä»£ç†åè®® /// åœ°å›¾ä»£ç†åè®® public protocol MapViewDelegateProtocol: NSObjectProtocol { ...... /// åœ°å›¾åŒºåŸŸå³å°†æ”¹å˜æ—¶ä¼šè°ƒç”¨æ­¤æ¥å£ /// - Parameters: /// - mapView: åœ°å›¾å®ä¾‹ /// - animated: æ˜¯å¦åŠ¨ç”» func mapView(_ mapView: MapViewProtocol, regionWillChangeAnimated animated: Bool) /// åœ°å›¾åŒºåŸŸæ”¹å˜å®Œæˆåä¼šè°ƒç”¨æ­¤æ¥å£ /// - Parameters: /// - mapView: åœ°å›¾å®ä¾‹ /// - animated: æ˜¯å¦åŠ¨ç”» /// - wasUserAction: æ ‡è¯†æ˜¯å¦æ˜¯ç”¨æˆ·åŠ¨ä½œ func mapView(_ mapView: MapViewProtocol, regionDidChangeAnimated animated: Bool, wasUserAction: Bool) /// ä½ç½®æˆ–è€…è®¾å¤‡æ–¹å‘æ›´æ–°åï¼Œä¼šè°ƒç”¨æ­¤å‡½æ•° /// - Parameters: /// - mapView: åœ°å›¾å®ä¾‹ /// - userLocation: ç”¨æˆ·å®šä½ä¿¡æ¯(åŒ…æ‹¬ä½ç½®ä¸è®¾å¤‡æ–¹å‘ç­‰æ•°æ®) /// - updatingLocation: æ ‡ç¤ºæ˜¯å¦æ˜¯locationæ•°æ®æ›´æ–°, YES:locationæ•°æ®æ›´æ–° NO:headingæ•°æ®æ›´æ–° func mapView(_ mapView: MapViewProtocol, didUpdate userLocation: UserLocationProtocol, updatingLocation: Bool) } ç¬¬2æ­¥ï¼šä¿®æ”¹åœ°å›¾ä»£ç†å®ç° é«˜å¾·åœ°å›¾ /// é«˜å¾·åœ°å›¾ä»£ç†å®ç° class MAMapViewDelegateImpl: NSObject, MAMapViewDelegate { ...... func mapView(_ mapView: MAMapView!, regionWillChangeAnimated animated: Bool) { delegate?.mapView(mapViewProtocol, regionWillChangeAnimated: animated) } func mapView(_ mapView: MAMapView!, regionDidChangeAnimated animated: Bool, wasUserAction: Bool) { delegate?.mapView(mapViewProtocol, regionDidChangeAnimated: animated, wasUserAction: wasUserAction) } func mapView(_ mapView: MAMapView!, didUpdate userLocation: MAUserLocation!, updatingLocation: Bool) { let gaodeUserLocation = GaodeUserLocation() gaodeUserLocation.location = userLocation.location gaodeUserLocation.heading = userLocation.heading gaodeUserLocation.updating = userLocation.isUpdating delegate?.mapView(mapViewProtocol, didUpdate: gaodeUserLocation, updatingLocation: updatingLocation) } } ç™¾åº¦åœ°å›¾ /// ç™¾åº¦åœ°å›¾ä»£ç†å®ç° class BMKMapViewDelegateImpl: NSObject, BMKMapViewDelegate { ...... func mapView(_ mapView: BMKMapView!, regionWillChangeAnimated animated: Bool) { delegate?.mapView(mapViewProtocol, regionWillChangeAnimated: animated) } func mapView(_ mapView: BMKMapView!, regionDidChangeAnimated animated: Bool, reason: BMKRegionChangeReason) { let wasUserAction = reason == BMKRegionChangeReasonGesture delegate?.mapView(mapViewProtocol, regionDidChangeAnimated: animated, wasUserAction: wasUserAction) } } "},"pages/åœ°å›¾èšåˆSDK/08_åœ°å›¾æ–°å¢ç¼©æ”¾ç­‰çº§.html":{"url":"pages/åœ°å›¾èšåˆSDK/08_åœ°å›¾æ–°å¢ç¼©æ”¾ç­‰çº§.html","title":"8.åœ°å›¾æ–°å¢ç¼©æ”¾ç­‰çº§","keywords":"","body":"8.åœ°å›¾æ–°å¢ç¼©æ”¾ç­‰çº§ åå››ã€åœ°å›¾æ–°å¢ç¼©æ”¾ç­‰çº§ ç¬¬1æ­¥ï¼šä¿®æ”¹åœ°å›¾åè®® /// åœ°å›¾åè®® public protocol MapViewProtocol: NSObjectProtocol { ...... /// ç¼©æ”¾çº§åˆ«ï¼ˆé»˜è®¤3-19ï¼Œæœ‰å®¤å†…åœ°å›¾æ—¶ä¸º3-20ï¼‰ var zoomLevel: CGFloat { get set } /// æœ€å°ç¼©æ”¾çº§åˆ« var minZoomLevel: CGFloat { get set } /// æœ€å¤§ç¼©æ”¾çº§åˆ«ï¼ˆæœ‰å®¤å†…åœ°å›¾æ—¶æœ€å¤§ä¸º20ï¼Œå¦åˆ™ä¸º19ï¼‰ var maxZoomLevel: CGFloat { get set } } ç¬¬2æ­¥ï¼šä¿®æ”¹åœ°å›¾å®ç° é«˜å¾·åœ°å›¾ /// é«˜å¾·åœ°å›¾ class GaodeMapView: NSObject, MapViewProtocol { ...... /// ç¼©æ”¾çº§åˆ«ï¼ˆé»˜è®¤3-19ï¼Œæœ‰å®¤å†…åœ°å›¾æ—¶ä¸º3-20ï¼‰ var zoomLevel: CGFloat { get { mapView.zoomLevel } set { mapView.zoomLevel = newValue } } /// æœ€å°ç¼©æ”¾çº§åˆ« var minZoomLevel: CGFloat { get { mapView.minZoomLevel } set { mapView.minZoomLevel = newValue } } /// æœ€å¤§ç¼©æ”¾çº§åˆ«ï¼ˆæœ‰å®¤å†…åœ°å›¾æ—¶æœ€å¤§ä¸º20ï¼Œå¦åˆ™ä¸º19ï¼‰ var maxZoomLevel: CGFloat { get { mapView.maxZoomLevel } set { mapView.maxZoomLevel = newValue } } } ç™¾åº¦åœ°å›¾ /// ç™¾åº¦åœ°å›¾ class BaiduMapView: NSObject, MapViewProtocol { ...... /// ç¼©æ”¾çº§åˆ«ï¼ˆé»˜è®¤3-19ï¼Œæœ‰å®¤å†…åœ°å›¾æ—¶ä¸º3-20ï¼‰ var zoomLevel: CGFloat { get { CGFloat(mapView.zoomLevel) } set { mapView.zoomLevel = Float(newValue) } } /// æœ€å°ç¼©æ”¾çº§åˆ« var minZoomLevel: CGFloat { get { CGFloat(mapView.minZoomLevel) } set { mapView.minZoomLevel = Float(newValue) } } /// æœ€å¤§ç¼©æ”¾çº§åˆ«ï¼ˆæœ‰å®¤å†…åœ°å›¾æ—¶æœ€å¤§ä¸º20ï¼Œå¦åˆ™ä¸º19ï¼‰ var maxZoomLevel: CGFloat { get { CGFloat(mapView.maxZoomLevel) } set { mapView.maxZoomLevel = Float(newValue) } } } "},"pages/åœ°å›¾èšåˆSDK/09_åœ°å›¾æ ‡æ³¨å®ç°.html":{"url":"pages/åœ°å›¾èšåˆSDK/09_åœ°å›¾æ ‡æ³¨å®ç°.html","title":"9.åœ°å›¾æ ‡æ³¨å®ç°","keywords":"","body":"9.åœ°å›¾æ ‡æ³¨å®ç° åäº”ã€åœ°å›¾æ ‡æ³¨å®ç° ç¬¬1æ­¥ï¼šæ–°å¢æ ‡æ³¨åè®®ã€æ ‡æ³¨viewåè®® AnnotationProtocolï¼ˆé€šç”¨æ ‡æ³¨åè®®ï¼‰ã€AnnotationViewProtocolï¼ˆé€šç”¨æ ‡æ³¨viewåè®®ï¼‰ã€PinAnnotationViewProtocolï¼ˆå¤§å¤´é’ˆæ ‡æ³¨viewåè®®ï¼‰ /// æ ‡æ³¨åè®® public protocol AnnotationProtocol: NSObjectProtocol { /// æ ‡æ³¨viewä¸­å¿ƒåæ ‡ var coordinate: CLLocationCoordinate2D? { get set} /// annotationæ ‡é¢˜ var title: String? { get set } /// annotationå‰¯æ ‡é¢˜ var subtitle: String? { get set } /// å…·ä½“åœ°å›¾æ ‡æ³¨å®ç° var annotationImpl: Any? { get } /// æ„é€ æ–¹æ³• /// - Parameter annotationImpl: å…·ä½“åœ°å›¾æ ‡æ³¨å®ç° init(annotationImpl: Any?) } /// æ ‡æ³¨viewåè®® public protocol AnnotationViewProtocol: NSObjectProtocol { /// æ˜¯å¦å…è®¸å¼¹å‡ºcallout var canShowCallout: Bool { get set } /// æ˜¾ç¤ºåœ¨é»˜è®¤å¼¹å‡ºæ¡†å³ä¾§çš„view var rightCalloutAccessoryView: UIView? { get set } /// æ˜¯å¦æ”¯æŒæ‹–åŠ¨ var draggable: Bool { get set } /// å…·ä½“åœ°å›¾æ ‡æ³¨viewå®ç° var annotationViewImpl: UIView? { get } /// æ„é€ æ–¹æ³• /// - Parameter annotationViewImpl: å…·ä½“åœ°å›¾æ ‡æ³¨viewå®ç° init(annotationViewImpl: UIView?) } /// å¤§å¤´é’ˆæ ‡æ³¨viewé¢œè‰² public enum PinAnnotationColor: Int { /// ç¬¬2æ­¥ï¼šæ–°å¢æ ‡æ³¨å®ç°ã€æ ‡æ³¨viewå®ç° GaodePointAnnotationï¼ˆé«˜å¾·æ ‡æ³¨ï¼‰ã€GaodePinAnnotationViewï¼ˆé«˜å¾·å¤§å¤´é’ˆï¼‰ BaiduPointAnnotationï¼ˆç™¾åº¦æ ‡æ³¨ï¼‰ã€BaiduPinAnnotationViewï¼ˆç™¾åº¦å¤§å¤´é’ˆï¼‰ PointAnnotationï¼ˆé€šç”¨æ ‡æ³¨ï¼‰ã€PinAnnotationViewï¼ˆé€šç”¨å¤§å¤´é’ˆï¼‰ /// é«˜å¾·æ ‡æ³¨ public class GaodePointAnnotation: MAPointAnnotation { /// èšåˆæ ‡æ³¨ weak var annotation: PointAnnotation? } /// é«˜å¾·å¤§å¤´é’ˆæ ‡å‡†view public class GaodePinAnnotationView: MAPinAnnotationView { } /// ç™¾åº¦æ ‡æ³¨ public class BaiduPointAnnotation: BMKPointAnnotation { /// èšåˆæ ‡æ³¨ weak var annotation: PointAnnotation? } /// ç™¾åº¦å¤§å¤´é’ˆæ ‡å‡†view public class BaiduPinAnnotationView: BMKPinAnnotationView { } /// æ ‡æ³¨å®ç° public class PointAnnotation: NSObject, AnnotationProtocol { /// æ ‡æ³¨viewä¸­å¿ƒåæ ‡ public var coordinate: CLLocationCoordinate2D? { get { if let annotation = gaodeAnnotation { return annotation.coordinate } if let annotation = baiduAnnotation { return annotation.coordinate } return nil } set { if let coordinate = newValue, let annotation = gaodeAnnotation { annotation.coordinate = coordinate } if let coordinate = newValue, let annotation = baiduAnnotation { annotation.coordinate = coordinate } } } /// annotationæ ‡é¢˜ public var title: String? { get { if let annotation = gaodeAnnotation { return annotation.title } if let annotation = baiduAnnotation { return annotation.title } return nil } set { if let title = newValue, let annotation = gaodeAnnotation { annotation.title = title } if let title = newValue, let annotation = baiduAnnotation { annotation.title = title } } } /// annotationå‰¯æ ‡é¢˜ public var subtitle: String? { get { if let annotation = gaodeAnnotation { return annotation.subtitle } if let annotation = baiduAnnotation { return annotation.subtitle } return nil } set { if let subtitle = newValue, let annotation = gaodeAnnotation { annotation.subtitle = subtitle } if let subtitle = newValue, let annotation = baiduAnnotation { annotation.subtitle = subtitle } } } /// å…·ä½“åœ°å›¾æ ‡æ³¨å®ç° private(set) public var annotationImpl: Any? /// é«˜å¾·æ ‡æ³¨ private var gaodeAnnotation: GaodePointAnnotation? { if let annotation = annotationImpl as? GaodePointAnnotation { return annotation } return nil } /// ç™¾åº¦æ ‡æ³¨ private var baiduAnnotation: BaiduPointAnnotation? { if let annotation = annotationImpl as? BaiduPointAnnotation { return annotation } return nil } /// æ„é€ æ–¹æ³• /// - Parameter annotationImpl: å…·ä½“åœ°å›¾æ ‡æ³¨å®ç° public required init(annotationImpl: Any?) { super.init() self.annotationImpl = annotationImpl gaodeAnnotation?.annotation = self baiduAnnotation?.annotation = self } } /// é€šç”¨å¤§å¤´é’ˆæ ‡æ³¨view public class PinAnnotationView: NSObject, PinAnnotationViewProtocol { /// æ˜¯å¦å…è®¸å¼¹å‡ºcallout public var canShowCallout: Bool { get { if let annotationView = gaodeAnnotationView { return annotationView.canShowCallout } if let annotationView = baiduAnnotationView { return annotationView.canShowCallout } return false } set { if let annotationView = gaodeAnnotationView { annotationView.canShowCallout = newValue } if let annotationView = baiduAnnotationView { annotationView.canShowCallout = newValue } } } /// æ˜¾ç¤ºåœ¨é»˜è®¤å¼¹å‡ºæ¡†å³ä¾§çš„view public var rightCalloutAccessoryView: UIView? { get { if let annotationView = gaodeAnnotationView { return annotationView.rightCalloutAccessoryView } if let annotationView = baiduAnnotationView { return annotationView.rightCalloutAccessoryView } return nil } set { if let annotationView = gaodeAnnotationView { annotationView.rightCalloutAccessoryView = newValue } if let annotationView = baiduAnnotationView { annotationView.rightCalloutAccessoryView = newValue } } } /// æ˜¯å¦æ”¯æŒæ‹–åŠ¨ public var draggable: Bool { get { if let annotationView = gaodeAnnotationView { return annotationView.isDraggable } if let annotationView = baiduAnnotationView { return annotationView.isDraggable } return false } set { if let annotationView = gaodeAnnotationView { annotationView.isDraggable = newValue } if let annotationView = baiduAnnotationView { annotationView.isDraggable = newValue } } } /// å¤§å¤´é’ˆçš„é¢œè‰² public var pinColor: PinAnnotationColor { get { if let annotationView = gaodeAnnotationView { return PinAnnotationColor(rawValue: annotationView.pinColor.rawValue) ?? .red } if let annotationView = baiduAnnotationView { return PinAnnotationColor(rawValue: Int(annotationView.pinColor)) ?? .red } return .red } set { if let annotationView = gaodeAnnotationView, let pinColor = MAPinAnnotationColor(rawValue: newValue.rawValue) { annotationView.pinColor = pinColor } if let annotationView = baiduAnnotationView { annotationView.pinColor = BMKPinAnnotationColor(newValue.rawValue) } } } /// æ·»åŠ åˆ°åœ°å›¾æ—¶æ˜¯å¦ä½¿ç”¨ä¸‹è½åŠ¨ç”»æ•ˆæœ public var animatesDrop: Bool { get { if let annotationView = gaodeAnnotationView { return annotationView.animatesDrop } if let annotationView = baiduAnnotationView { return annotationView.animatesDrop } return false } set { if let annotationView = gaodeAnnotationView { annotationView.animatesDrop = newValue } if let annotationView = baiduAnnotationView { annotationView.animatesDrop = newValue } } } /// å…·ä½“åœ°å›¾æ ‡æ³¨viewå®ç° private(set) public var annotationViewImpl: UIView? /// é«˜å¾·åœ°å›¾æ ‡æ³¨view private var gaodeAnnotationView: MAPinAnnotationView? { return annotationViewImpl as? MAPinAnnotationView } /// ç™¾åº¦åœ°å›¾æ ‡æ³¨view private var baiduAnnotationView: BMKPinAnnotationView? { return annotationViewImpl as? BMKPinAnnotationView } /// æ„é€ æ–¹æ³• /// - Parameter annotationViewImpl: å…·ä½“åœ°å›¾æ ‡æ³¨viewå®ç° public required init(annotationViewImpl: UIView?) { self.annotationViewImpl = annotationViewImpl } } ç¬¬3æ­¥ï¼šåœ°å›¾å·¥å‚æ ‡å‡†ä¿®æ”¹åŠå®ç° /// åœ°å›¾å·¥å‚æ ‡å‡† public protocol MapFactoryProtocol: NSObjectProtocol { ...... /// è·å–åœ°å›¾æ ‡æ³¨ func getPointAnnotation() -> PointAnnotation /// è·å–æ ‡æ³¨view /// - Parameters: /// - annotation: æ ‡æ³¨ /// - reuseIdentifier: é‡ç”¨ID func getPinAnnotationView(annotation: AnnotationProtocol, reuseIdentifier: String) -> PinAnnotationViewProtocol } /// ç™¾åº¦åœ°å›¾å·¥å‚ class BaiduMapFactory: NSObject, MapFactoryProtocol { ...... /// è·å–åœ°å›¾æ ‡æ³¨ func getPointAnnotation() -> PointAnnotation { let annotationImpl = BaiduPointAnnotation() return PointAnnotation(annotationImpl: annotationImpl) } /// è·å–æ ‡æ³¨view /// - Parameters: /// - annotation: æ ‡æ³¨ /// - reuseIdentifier: é‡ç”¨ID func getPinAnnotationView(annotation: AnnotationProtocol, reuseIdentifier: String) -> PinAnnotationViewProtocol { var annotationImpl = BaiduPointAnnotation() if let annotationImplParam = annotation.annotationImpl as? BaiduPointAnnotation { annotationImpl = annotationImplParam } let annotationViewImpl = BaiduPinAnnotationView(annotation: annotationImpl, reuseIdentifier: reuseIdentifier) return PinAnnotationView(annotationViewImpl: annotationViewImpl) } } /// é«˜å¾·åœ°å›¾å·¥å‚ class GaodeMapFactory: NSObject, MapFactoryProtocol { ...... /// è·å–åœ°å›¾æ ‡æ³¨ func getPointAnnotation() -> PointAnnotation { let annotationImpl = GaodePointAnnotation() return PointAnnotation(annotationImpl: annotationImpl) } /// è·å–æ ‡æ³¨view /// - Parameters: /// - annotation: æ ‡æ³¨ /// - reuseIdentifier: é‡ç”¨ID func getPinAnnotationView(annotation: AnnotationProtocol, reuseIdentifier: String) -> PinAnnotationViewProtocol { var annotationImpl = GaodePointAnnotation() if let annotationImplParam = annotation.annotationImpl as? GaodePointAnnotation { annotationImpl = annotationImplParam } let annotationViewImpl = GaodePinAnnotationView(annotation: annotationImpl, reuseIdentifier: reuseIdentifier) return PinAnnotationView(annotationViewImpl: annotationViewImpl) } } ç¬¬4æ­¥ï¼šåœ°å›¾åè®®ä¿®æ”¹åŠå®ç° /// åœ°å›¾åè®® public protocol MapViewProtocol: NSObjectProtocol { ...... /// å‘åœ°å›¾çª—å£æ·»åŠ æ ‡æ³¨ /// - Parameter annotation: è¦æ·»åŠ çš„æ ‡æ³¨ func addAnnotation(_ annotation: AnnotationProtocol) /// å‘åœ°å›¾çª—å£æ·»åŠ ä¸€ç»„æ ‡æ³¨ï¼Œéœ€è¦å®ç°MAMapViewDelegateçš„-mapView:viewForAnnotation:å‡½æ•°æ¥ç”Ÿæˆæ ‡æ³¨å¯¹åº”çš„View /// - Parameter annotations: è¦æ·»åŠ çš„æ ‡æ³¨æ•°ç»„ func addAnnotations(_ annotations: [AnnotationProtocol]) /// è®¾ç½®åœ°å›¾ä½¿å…¶å¯ä»¥æ˜¾ç¤ºæ•°ç»„ä¸­æ‰€æœ‰çš„annotation, å¦‚æœæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªåˆ™ç›´æ¥è®¾ç½®åœ°å›¾ä¸­å¿ƒä¸ºannotationçš„ä½ç½®ã€‚ /// - Parameters: /// - annotations: éœ€è¦æ˜¾ç¤ºçš„annotation /// - animated: æ˜¯å¦æ‰§è¡ŒåŠ¨ç”» func showAnnotations(_ annotations: [AnnotationProtocol], animated: Bool) /// ä»å¤ç”¨å†…å­˜æ± ä¸­è·å–åˆ¶å®šå¤ç”¨æ ‡è¯†çš„annotation view /// - Parameter withIdentifier: å¤ç”¨æ ‡è¯† /// - Returns: annotation view func dequeueReusableAnnotationView(withIdentifier: String) -> PinAnnotationViewProtocol? } /// é«˜å¾·åœ°å›¾ class GaodeMapView: NSObject, MapViewProtocol { ...... /// å‘åœ°å›¾çª—å£æ·»åŠ æ ‡æ³¨ /// - Parameter annotation: è¦æ·»åŠ çš„æ ‡æ³¨ func addAnnotation(_ annotation: AnnotationProtocol) { if let annotationImpl = annotation.annotationImpl as? MAAnnotation { mapView.addAnnotation(annotationImpl) } } /// å‘åœ°å›¾çª—å£æ·»åŠ ä¸€ç»„æ ‡æ³¨ï¼Œéœ€è¦å®ç°MAMapViewDelegateçš„-mapView:viewForAnnotation:å‡½æ•°æ¥ç”Ÿæˆæ ‡æ³¨å¯¹åº”çš„View /// - Parameter annotations: è¦æ·»åŠ çš„æ ‡æ³¨æ•°ç»„ func addAnnotations(_ annotations: [AnnotationProtocol]) { var annotationImpls: [Any] = [] for annotation in annotations { if let annotationImpl = annotation.annotationImpl { annotationImpls.append(annotationImpl) } } mapView.addAnnotations(annotationImpls) } /// è®¾ç½®åœ°å›¾ä½¿å…¶å¯ä»¥æ˜¾ç¤ºæ•°ç»„ä¸­æ‰€æœ‰çš„annotation, å¦‚æœæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªåˆ™ç›´æ¥è®¾ç½®åœ°å›¾ä¸­å¿ƒä¸ºannotationçš„ä½ç½®ã€‚ /// - Parameters: /// - annotations: éœ€è¦æ˜¾ç¤ºçš„annotation /// - animated: æ˜¯å¦æ‰§è¡ŒåŠ¨ç”» func showAnnotations(_ annotations: [AnnotationProtocol], animated: Bool) { var annotationImpls: [Any] = [] for annotation in annotations { if let annotationImpl = annotation.annotationImpl { annotationImpls.append(annotationImpl) } } mapView.showAnnotations(annotationImpls, animated: animated) } /// ä»å¤ç”¨å†…å­˜æ± ä¸­è·å–åˆ¶å®šå¤ç”¨æ ‡è¯†çš„annotation view /// - Parameter withIdentifier: å¤ç”¨æ ‡è¯† /// - Returns: annotation view func dequeueReusableAnnotationView(withIdentifier: String) -> PinAnnotationViewProtocol? { if let annotationViewImpl = mapView.dequeueReusableAnnotationView(withIdentifier: withIdentifier) as? GaodePinAnnotationView { return PinAnnotationView(annotationViewImpl: annotationViewImpl) } return nil } } /// é«˜å¾·åœ°å›¾ä»£ç†å®ç° class MAMapViewDelegateImpl: NSObject, MAMapViewDelegate { ...... func mapView(_ mapView: MAMapView!, viewFor annotation: MAAnnotation!) -> MAAnnotationView! { if let pointAnnotation = annotation as? GaodePointAnnotation, let anno = pointAnnotation.annotation { if let pinAnnotationView = delegate?.mapView(mapViewProtocol, viewFor: anno)?.annotationViewImpl as? MAAnnotationView { return pinAnnotationView } return nil } return nil } } /// ç™¾åº¦åœ°å›¾ class BaiduMapView: NSObject, MapViewProtocol { ...... /// å‘åœ°å›¾çª—å£æ·»åŠ æ ‡æ³¨ /// - Parameter annotation: è¦æ·»åŠ çš„æ ‡æ³¨ func addAnnotation(_ annotation: AnnotationProtocol) { if let annotationImpl = annotation.annotationImpl as? BMKAnnotation { mapView.addAnnotation(annotationImpl) } } /// å‘åœ°å›¾çª—å£æ·»åŠ ä¸€ç»„æ ‡æ³¨ï¼Œéœ€è¦å®ç°MAMapViewDelegateçš„-mapView:viewForAnnotation:å‡½æ•°æ¥ç”Ÿæˆæ ‡æ³¨å¯¹åº”çš„View /// - Parameter annotations: è¦æ·»åŠ çš„æ ‡æ³¨æ•°ç»„ func addAnnotations(_ annotations: [AnnotationProtocol]) { var annotationImpls: [BMKAnnotation] = [] for annotation in annotations { if let annotationImpl = annotation.annotationImpl as? BMKAnnotation { annotationImpls.append(annotationImpl) } } mapView.addAnnotations(annotationImpls) } /// è®¾ç½®åœ°å›¾ä½¿å…¶å¯ä»¥æ˜¾ç¤ºæ•°ç»„ä¸­æ‰€æœ‰çš„annotation, å¦‚æœæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªåˆ™ç›´æ¥è®¾ç½®åœ°å›¾ä¸­å¿ƒä¸ºannotationçš„ä½ç½®ã€‚ /// - Parameters: /// - annotations: éœ€è¦æ˜¾ç¤ºçš„annotation /// - animated: æ˜¯å¦æ‰§è¡ŒåŠ¨ç”» func showAnnotations(_ annotations: [AnnotationProtocol], animated: Bool) { var annotationImpls: [BMKAnnotation] = [] for annotation in annotations { if let annotationImpl = annotation.annotationImpl as? BMKAnnotation { annotationImpls.append(annotationImpl) } } mapView.showAnnotations(annotationImpls, animated: animated) } /// ä»å¤ç”¨å†…å­˜æ± ä¸­è·å–åˆ¶å®šå¤ç”¨æ ‡è¯†çš„annotation view /// - Parameter withIdentifier: å¤ç”¨æ ‡è¯† /// - Returns: annotation view func dequeueReusableAnnotationView(withIdentifier: String) -> PinAnnotationViewProtocol? { if let annotationViewImpl = mapView.dequeueReusableAnnotationView(withIdentifier: withIdentifier) as? BaiduPinAnnotationView { return PinAnnotationView(annotationViewImpl: annotationViewImpl) } return nil } } /// ç™¾åº¦åœ°å›¾ä»£ç†å®ç° class BMKMapViewDelegateImpl: NSObject, BMKMapViewDelegate { ...... func mapView(_ mapView: BMKMapView!, viewFor annotation: BMKAnnotation!) -> BMKAnnotationView! { if let pointAnnotation = annotation as? BaiduPointAnnotation, let anno = pointAnnotation.annotation { if let pinAnnotationView = delegate?.mapView(mapViewProtocol, viewFor: anno)?.annotationViewImpl as? BMKAnnotationView{ return pinAnnotationView } } return nil } } ç¬¬5æ­¥ï¼šæµ‹è¯•é¡µé¢ class PointAnnotationViewController: UIViewController { /// åœ°å›¾å·¥å‚ private lazy var factory: MapFactoryProtocol = { let factory = MapEngine.shared.getFactory()! return factory }() /// åœ°å›¾å®ä¾‹ private lazy var mapView: MapViewProtocol = { // æ˜¾ç¤ºåœ°å›¾ let mapView = factory.getMapView(frame: view.bounds) // è®¾ç½®ä»£ç† mapView.delegate = self // æ˜¾ç¤ºç”¨æˆ·å®šä½(æ”¾åœ¨è®¾ç½®ä»£ç†ä¹‹åï¼Œç¡®ä¿å¯ä»¥è°ƒç”¨locationManager.requestAlwaysAuthorization()) mapView.showsUserLocation = true // è·Ÿè¸ªæ¨¡å¼ mapView.userTrackingMode = .followWithHeading // è®¾ç½®ç¼©æ”¾ mapView.zoomLevel = 16 return mapView }() /// æ ‡æ³¨æ•°ç»„ private lazy var annotations: Array = { var annotations = Array() let coordinates: [CLLocationCoordinate2D] = [ CLLocationCoordinate2D(latitude: 39.992520, longitude: 116.336170), CLLocationCoordinate2D(latitude: 39.978234, longitude: 116.352343), CLLocationCoordinate2D(latitude: 39.998293, longitude: 116.348904), CLLocationCoordinate2D(latitude: 40.004087, longitude: 116.353915), CLLocationCoordinate2D(latitude: 40.001442, longitude: 116.353915), CLLocationCoordinate2D(latitude: 39.989105, longitude: 116.360200), CLLocationCoordinate2D(latitude: 39.989098, longitude: 116.360201), CLLocationCoordinate2D(latitude: 39.998439, longitude: 116.324219), CLLocationCoordinate2D(latitude: 39.979590, longitude: 116.352792)] for (idx, coor) in coordinates.enumerated() { var anno = factory.getPointAnnotation() anno.coordinate = coor anno.title = String(idx) annotations.append(anno) } return annotations }() override func viewDidLoad() { super.viewDidLoad() view.backgroundColor = .white view.addSubview(mapView.getView()) } override func viewDidAppear(_ animated: Bool) { super.viewDidAppear(animated) mapView.addAnnotations(annotations) mapView.showAnnotations(annotations, animated: false) } } extension PointAnnotationViewController: MapViewDelegateProtocol { func mapView(_ mapView: MapViewProtocol, viewFor annotation: AnnotationProtocol) -> PinAnnotationViewProtocol? { if annotation.isKind(of: PointAnnotation.self) { let pointReuseIndetifier = \"pointReuseIndetifier\" var annotationView = mapView.dequeueReusableAnnotationView(withIdentifier: pointReuseIndetifier) if annotationView == nil { annotationView = factory.getPinAnnotationView(annotation: annotation, reuseIdentifier: pointReuseIndetifier) } annotationView!.canShowCallout = true annotationView!.animatesDrop = true annotationView!.draggable = true annotationView!.rightCalloutAccessoryView = UIButton(type: .detailDisclosure) let idx = annotations.index(of: annotation as! PointAnnotation) annotationView!.pinColor = PinAnnotationColor(rawValue: (idx ?? 3) % 3)! return annotationView } return nil } } "},"pages/åœ°å›¾èšåˆSDK/10_åœ°å›¾å¤šè¾¹å½¢å®ç°.html":{"url":"pages/åœ°å›¾èšåˆSDK/10_åœ°å›¾å¤šè¾¹å½¢å®ç°.html","title":"10.åœ°å›¾å¤šè¾¹å½¢å®ç°","keywords":"","body":"10.åœ°å›¾å¤šè¾¹å½¢å®ç° åå…­ã€åœ°å›¾å¤šè¾¹å½¢å®ç° ç¬¬1æ­¥ï¼šæ–°å¢åœ°å›¾è¦†ç›–ç‰©åè®®ã€åœ°å›¾è¦†ç›–ç‰©Rendereråè®® OverlayProtocolï¼ˆåœ°å›¾è¦†ç›–ç‰©åè®®ï¼‰ã€OverlayRendererProtocolï¼ˆåœ°å›¾è¦†ç›–ç‰©Rendereråè®®ï¼‰ /// åœ°å›¾è¦†ç›–ç‰©åè®®ï¼Œæ‰€æœ‰åœ°å›¾çš„è¦†ç›–ç‰©éœ€è¦å®ç° public protocol OverlayProtocol: NSObjectProtocol { /// å…·ä½“åœ°å›¾è¦†ç›–ç‰©å®ç° var overlayImpl: Any? { get } /// æ„é€ æ–¹æ³• /// - Parameter annotationImpl: å…·ä½“åœ°å›¾è¦†ç›–ç‰©å®ç° init(overlayImpl: Any?) } /// åœ°å›¾è¦†ç›–ç‰©Rendereråè®® public protocol OverlayRendererProtocol: NSObjectProtocol { /// å¡«å……é¢œè‰²,é»˜è®¤æ˜¯kMAOverlayRendererDefaultFillColor var fillColor: UIColor { get set } /// ç¬”è§¦é¢œè‰²,é»˜è®¤æ˜¯kMAOverlayRendererDefaultStrokeColor var strokeColor: UIColor { get set } ///ç¬”è§¦å®½åº¦, å•ä½å±å¹•ç‚¹åæ ‡ï¼Œé»˜è®¤æ˜¯0 var lineWidth: CGFloat { get set } /// å…·ä½“åœ°å›¾æ ‡æ³¨viewå®ç° var overRendererImpl: Any? { get } /// æ„é€ æ–¹æ³• /// - Parameter overRendererImpl: å…·ä½“åœ°å›¾è¦†ç›–ç‰©Rendererå®ç° init(overRendererImpl: Any?) } ç¬¬2æ­¥ï¼šæ–°å¢åœ°å›¾å¤šè¾¹å½¢å®ç°ã€åœ°å›¾å¤šè¾¹å½¢Rendererå®ç° GaodePolygonï¼ˆé«˜å¾·åœ°å›¾å¤šè¾¹å½¢ï¼‰ã€GaodePolygonRendererï¼ˆé«˜å¾·åœ°å›¾å¤šè¾¹å½¢Rendererï¼‰ BaiduPolygonï¼ˆç™¾åº¦åœ°å›¾å¤šè¾¹å½¢ï¼‰ã€BaiduPolygonRendererï¼ˆç™¾åº¦åœ°å›¾å¤šè¾¹å½¢Rendererï¼‰ Polygonï¼ˆé€šç”¨å¤šè¾¹å½¢ï¼‰ã€PolygonRendererï¼ˆé€šç”¨å¤šè¾¹å½¢Rendererï¼‰ /// é«˜å¾·åœ°å›¾å¤šè¾¹å½¢ public class GaodePolygon: MAPolygon { /// èšåˆå¤šè¾¹å½¢åŒºåŸŸl weak var polygon: Polygon? } /// é«˜å¾·åœ°å›¾å¤šè¾¹å½¢Renderer public class GaodePolygonRenderer: MAPolygonRenderer { } /// ç™¾åº¦å¤šè¾¹å½¢ public class BaiduPolygon: BMKPolygon { /// èšåˆå¤šè¾¹å½¢åŒºåŸŸl weak var polygon: Polygon? } /// ç™¾åº¦å¤šè¾¹å½¢Renderer public class BaiduPolygonRenderer: BMKPolygonView { } /// é€šç”¨å¤šè¾¹å½¢ public class Polygon: NSObject, OverlayProtocol { /// å…·ä½“åœ°å›¾è¦†ç›–ç‰©å®ç° private(set) public var overlayImpl: Any? /// é«˜å¾·è¦†ç›–ç‰© private var gaodePolygon: GaodePolygon? { if let overlay = overlayImpl as? GaodePolygon { return overlay } return nil } /// ç™¾åº¦è¦†ç›–ç‰© private var baiduPolygon: BaiduPolygon? { if let overlay = overlayImpl as? BaiduPolygon { return overlay } return nil } /// æ„é€ æ–¹æ³• /// - Parameter overlayImpl: å…·ä½“åœ°å›¾è¦†ç›–ç‰©å®ç° public required init(overlayImpl: Any?) { super.init() self.overlayImpl = overlayImpl gaodePolygon?.polygon = self baiduPolygon?.polygon = self } } /// é€šç”¨å¤šè¾¹å½¢Renderer public class PolygonRenderer: NSObject, OverlayRendererProtocol { /// å¡«å……é¢œè‰²,é»˜è®¤æ˜¯kMAOverlayRendererDefaultFillColor public var fillColor: UIColor { get { if let overRenderer = gaodeOverRenderer { return overRenderer.fillColor } if let overRenderer = baiduOverRenderer { return overRenderer.fillColor } return .red } set { if let overRenderer = gaodeOverRenderer { overRenderer.fillColor = newValue } if let overRenderer = baiduOverRenderer { overRenderer.fillColor = newValue } } } /// ç¬”è§¦é¢œè‰²,é»˜è®¤æ˜¯kMAOverlayRendererDefaultStrokeColor public var strokeColor: UIColor { get { if let overRenderer = gaodeOverRenderer { return overRenderer.strokeColor } if let overRenderer = baiduOverRenderer { return overRenderer.strokeColor } return .red } set { if let overRenderer = gaodeOverRenderer { overRenderer.strokeColor = newValue } if let overRenderer = baiduOverRenderer { overRenderer.strokeColor = newValue } } } ///ç¬”è§¦å®½åº¦, å•ä½å±å¹•ç‚¹åæ ‡ï¼Œé»˜è®¤æ˜¯0 public var lineWidth: CGFloat { get { if let overRenderer = gaodeOverRenderer { return overRenderer.lineWidth } if let overRenderer = baiduOverRenderer { return overRenderer.lineWidth } return 0 } set { if let overRenderer = gaodeOverRenderer { overRenderer.lineWidth = newValue } if let overRenderer = baiduOverRenderer { overRenderer.lineWidth = newValue } } } /// å…·ä½“åœ°å›¾è¦†ç›–ç‰©å®ç° public private(set) var overRendererImpl: Any? /// é«˜å¾·åœ°å›¾è¦†ç›–ç‰© private var gaodeOverRenderer: GaodePolygonRenderer? { return overRendererImpl as? GaodePolygonRenderer } /// ç™¾åº¦åœ°å›¾è¦†ç›–ç‰© private var baiduOverRenderer: BaiduPolygonRenderer? { return overRendererImpl as? BaiduPolygonRenderer } /// æ„é€ æ–¹æ³• /// - Parameter overRendererImpl: å…·ä½“åœ°å›¾è¦†ç›–ç‰©Rendererå®ç° public required init(overRendererImpl: Any?) { self.overRendererImpl = overRendererImpl } } ç¬¬3æ­¥ï¼šåœ°å›¾å·¥å‚æ ‡å‡†ä¿®æ”¹åŠå®ç° /// åœ°å›¾å·¥å‚æ ‡å‡† public protocol MapFactoryProtocol: NSObjectProtocol { ...... /// æ ¹æ®ç»çº¬åº¦åæ ‡æ•°æ®ç”Ÿæˆé—­åˆå¤šè¾¹å½¢ /// - Parameters: /// - coordinates: ç»çº¬åº¦åæ ‡ç‚¹æ•°æ®,coordså¯¹åº”çš„å†…å­˜ä¼šæ‹·è´,è°ƒç”¨è€…è´Ÿè´£è¯¥å†…å­˜çš„é‡Šæ”¾ /// - count: ç»çº¬åº¦åæ ‡ç‚¹æ•°ç»„ä¸ªæ•° /// - Returns: æ–°ç”Ÿæˆçš„å¤šè¾¹å½¢ func getPolygon(coordinates: UnsafeMutablePointer, count: UInt) -> Polygon /// æ ¹æ®æŒ‡å®šçš„å¤šè¾¹å½¢ç”Ÿæˆä¸€ä¸ªå¤šè¾¹å½¢Renderer /// - Parameter overlay: æŒ‡å®šçš„å¤šè¾¹å½¢æ•°æ®å¯¹è±¡ /// - Returns: æ–°ç”Ÿæˆçš„å¤šè¾¹å½¢Renderer func getPolygonRenderer(overlay: OverlayProtocol) -> OverlayRendererProtocol } /// é«˜å¾·åœ°å›¾å·¥å‚ class GaodeMapFactory: NSObject, MapFactoryProtocol { ...... /// æ ¹æ®ç»çº¬åº¦åæ ‡æ•°æ®ç”Ÿæˆé—­åˆå¤šè¾¹å½¢ /// - Parameters: /// - coordinates: ç»çº¬åº¦åæ ‡ç‚¹æ•°æ®,coordså¯¹åº”çš„å†…å­˜ä¼šæ‹·è´,è°ƒç”¨è€…è´Ÿè´£è¯¥å†…å­˜çš„é‡Šæ”¾ /// - count: ç»çº¬åº¦åæ ‡ç‚¹æ•°ç»„ä¸ªæ•° /// - Returns: æ–°ç”Ÿæˆçš„å¤šè¾¹å½¢ func getPolygon(coordinates: UnsafeMutablePointer, count: UInt) -> Polygon { let polygonImpl = GaodePolygon(coordinates: coordinates, count: count) return Polygon(overlayImpl: polygonImpl) } /// æ ¹æ®æŒ‡å®šçš„å¤šè¾¹å½¢ç”Ÿæˆä¸€ä¸ªå¤šè¾¹å½¢Renderer /// - Parameter overlay: æŒ‡å®šçš„å¤šè¾¹å½¢æ•°æ®å¯¹è±¡ /// - Returns: æ–°ç”Ÿæˆçš„å¤šè¾¹å½¢Renderer func getPolygonRenderer(overlay: OverlayProtocol) -> OverlayRendererProtocol { var polygonImpl = GaodePolygon() if let overlayImplParam = overlay.overlayImpl as? GaodePolygon { polygonImpl = overlayImplParam } let polygonRendererImpl = GaodePolygonRenderer(overlay: polygonImpl) return PolygonRenderer(overRendererImpl: polygonRendererImpl) } } /// ç™¾åº¦åœ°å›¾å·¥å‚ class BaiduMapFactory: NSObject, MapFactoryProtocol { ...... /// æ ¹æ®ç»çº¬åº¦åæ ‡æ•°æ®ç”Ÿæˆé—­åˆå¤šè¾¹å½¢ /// - Parameters: /// - coordinates: ç»çº¬åº¦åæ ‡ç‚¹æ•°æ®,coordså¯¹åº”çš„å†…å­˜ä¼šæ‹·è´,è°ƒç”¨è€…è´Ÿè´£è¯¥å†…å­˜çš„é‡Šæ”¾ /// - count: ç»çº¬åº¦åæ ‡ç‚¹æ•°ç»„ä¸ªæ•° /// - Returns: æ–°ç”Ÿæˆçš„å¤šè¾¹å½¢ func getPolygon(coordinates: UnsafeMutablePointer, count: UInt) -> Polygon { let polygonImpl = BaiduPolygon(coordinates: coordinates, count: count) return Polygon(overlayImpl: polygonImpl) } /// æ ¹æ®æŒ‡å®šçš„å¤šè¾¹å½¢ç”Ÿæˆä¸€ä¸ªå¤šè¾¹å½¢Renderer /// - Parameter overlay: æŒ‡å®šçš„å¤šè¾¹å½¢æ•°æ®å¯¹è±¡ /// - Returns: æ–°ç”Ÿæˆçš„å¤šè¾¹å½¢Renderer func getPolygonRenderer(overlay: OverlayProtocol) -> OverlayRendererProtocol { var polygonImpl = BaiduPolygon() if let overlayImplParam = overlay.overlayImpl as? BaiduPolygon { polygonImpl = overlayImplParam } let polygonRendererImpl = BaiduPolygonRenderer(overlay: polygonImpl) return PolygonRenderer(overRendererImpl: polygonRendererImpl) } } ç¬¬4æ­¥ï¼šåœ°å›¾åè®®ä¿®æ”¹åŠå®ç° /// åœ°å›¾åè®® public protocol MapViewProtocol: NSObjectProtocol { ...... /// å‘åœ°å›¾çª—å£æ·»åŠ ä¸€ç»„Overlayï¼Œéœ€è¦å®ç°MAMapViewDelegateçš„-mapView:rendererForOverlay:å‡½æ•°æ¥ç”Ÿæˆæ ‡æ³¨å¯¹åº”çš„Renderer /// - Parameter overlays: è¦æ·»åŠ çš„overlayæ•°ç»„ func addOverlays(overlays: [OverlayProtocol]) /// è®¾ç½®åœ°å›¾ä½¿å…¶å¯ä»¥æ˜¾ç¤ºæ•°ç»„ä¸­æ‰€æœ‰çš„overlay, å¦‚æœæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªåˆ™ç›´æ¥è®¾ç½®åœ°å›¾ä¸­å¿ƒä¸ºoverlayçš„ä½ç½®ã€‚ /// - Parameters: /// - overlays: éœ€è¦æ˜¾ç¤ºçš„overlays /// - animated: æ˜¯å¦æ‰§è¡ŒåŠ¨ç”» func showOverlays(overlays: [OverlayProtocol], animated: Bool) } /// é«˜å¾·åœ°å›¾ class GaodeMapView: NSObject, MapViewProtocol { ...... /// å‘åœ°å›¾çª—å£æ·»åŠ ä¸€ç»„Overlayï¼Œéœ€è¦å®ç°MAMapViewDelegateçš„-mapView:rendererForOverlay:å‡½æ•°æ¥ç”Ÿæˆæ ‡æ³¨å¯¹åº”çš„Renderer /// - Parameter overlays: è¦æ·»åŠ çš„overlayæ•°ç»„ func addOverlays(overlays: [OverlayProtocol]) { var overlayImpls: [Any] = [] for overlay in overlays { if let overlayImpl = overlay.overlayImpl { overlayImpls.append(overlayImpl) } } mapView.addOverlays(overlayImpls) } /// è®¾ç½®åœ°å›¾ä½¿å…¶å¯ä»¥æ˜¾ç¤ºæ•°ç»„ä¸­æ‰€æœ‰çš„overlay, å¦‚æœæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªåˆ™ç›´æ¥è®¾ç½®åœ°å›¾ä¸­å¿ƒä¸ºoverlayçš„ä½ç½®ã€‚ /// - Parameters: /// - overlays: éœ€è¦æ˜¾ç¤ºçš„overlays /// - animated: æ˜¯å¦æ‰§è¡ŒåŠ¨ç”» func showOverlays(overlays: [OverlayProtocol], animated: Bool) { var overlayImpls: [Any] = [] for overlay in overlays { if let overlayImpl = overlay.overlayImpl { overlayImpls.append(overlayImpl) } } mapView.showOverlays(overlayImpls, animated: animated) } } /// é«˜å¾·åœ°å›¾ä»£ç†å®ç° class MAMapViewDelegateImpl: NSObject, MAMapViewDelegate { ...... func mapView(_ mapView: MAMapView!, rendererFor overlay: MAOverlay!) -> MAOverlayRenderer! { if let polygonOverlay = overlay as? GaodePolygon, let poly = polygonOverlay.polygon { if let polygonRenderer = delegate?.mapView(mapViewProtocol, rendererFor: poly)?.overRendererImpl as? MAPolygonRenderer { return polygonRenderer } } return nil } } /// ç™¾åº¦åœ°å›¾ class BaiduMapView: NSObject, MapViewProtocol { ...... /// å‘åœ°å›¾çª—å£æ·»åŠ ä¸€ç»„Overlayï¼Œéœ€è¦å®ç°MAMapViewDelegateçš„-mapView:rendererForOverlay:å‡½æ•°æ¥ç”Ÿæˆæ ‡æ³¨å¯¹åº”çš„Renderer /// - Parameter overlays: è¦æ·»åŠ çš„overlayæ•°ç»„ func addOverlays(overlays: [OverlayProtocol]) { var overlayImpls: [BMKOverlay] = [] for overlay in overlays { if let overlayImpl = overlay.overlayImpl as? BMKOverlay { overlayImpls.append(overlayImpl) } } mapView.addOverlays(overlayImpls) } /// è®¾ç½®åœ°å›¾ä½¿å…¶å¯ä»¥æ˜¾ç¤ºæ•°ç»„ä¸­æ‰€æœ‰çš„overlay, å¦‚æœæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªåˆ™ç›´æ¥è®¾ç½®åœ°å›¾ä¸­å¿ƒä¸ºoverlayçš„ä½ç½®ã€‚ /// - Parameters: /// - overlays: éœ€è¦æ˜¾ç¤ºçš„overlays /// - animated: æ˜¯å¦æ‰§è¡ŒåŠ¨ç”» func showOverlays(overlays: [OverlayProtocol], animated: Bool) { var overlayImpls: [BMKOverlay] = [] for overlay in overlays { if let overlayImpl = overlay.overlayImpl as? BMKOverlay { overlayImpls.append(overlayImpl) } } } } /// ç™¾åº¦åœ°å›¾ä»£ç†å®ç° class BMKMapViewDelegateImpl: NSObject, BMKMapViewDelegate { ...... func mapView(_ mapView: BMKMapView!, viewFor overlay: BMKOverlay!) -> BMKOverlayView! { if let polygonOverlay = overlay as? BaiduPolygon, let poly = polygonOverlay.polygon { if let polygonRenderer = delegate?.mapView(mapViewProtocol, rendererFor: poly)?.overRendererImpl as? BMKPolygonView { return polygonRenderer } } return nil } } ç¬¬5æ­¥ï¼šæµ‹è¯•é¡µé¢ class PolygonViewController: UIViewController { /// åœ°å›¾å·¥å‚ private lazy var factory: MapFactoryProtocol = { let factory = MapEngine.shared.getFactory()! return factory }() /// åœ°å›¾å®ä¾‹ private lazy var mapView: MapViewProtocol = { // æ˜¾ç¤ºåœ°å›¾ let mapView = factory.getMapView(frame: view.bounds) // è®¾ç½®ä»£ç† mapView.delegate = self // æ˜¾ç¤ºç”¨æˆ·å®šä½(æ”¾åœ¨è®¾ç½®ä»£ç†ä¹‹åï¼Œç¡®ä¿å¯ä»¥è°ƒç”¨locationManager.requestAlwaysAuthorization()) mapView.showsUserLocation = true // è·Ÿè¸ªæ¨¡å¼ mapView.userTrackingMode = .followWithHeading // è®¾ç½®ç¼©æ”¾ mapView.zoomLevel = 16 return mapView }() /// æ ‡æ³¨æ•°ç»„ private lazy var polygons: Array = { var polygons = Array() var polygonCoordinates: [CLLocationCoordinate2D] = [ CLLocationCoordinate2D(latitude: 39.781892, longitude: 116.283413), CLLocationCoordinate2D(latitude: 39.787600, longitude: 116.391842), CLLocationCoordinate2D(latitude: 39.733187, longitude: 116.417932), CLLocationCoordinate2D(latitude: 39.704653, longitude: 116.338255)] let polygon = factory.getPolygon(coordinates: &polygonCoordinates, count: UInt(polygonCoordinates.count)) polygons.append(polygon) return polygons }() override func viewDidLoad() { super.viewDidLoad() view.backgroundColor = .white view.addSubview(mapView.getView()) } override func viewDidAppear(_ animated: Bool) { super.viewDidAppear(animated) mapView.addOverlays(overlays: polygons) mapView.showOverlays(overlays: polygons, animated: false) } } extension PolygonViewController: MapViewDelegateProtocol { func mapView(_ mapView: MapViewProtocol, rendererFor overlay: OverlayProtocol) -> OverlayRendererProtocol? { if overlay.isKind(of: Polygon.self) { let renderer = factory.getPolygonRenderer(overlay: overlay) renderer.lineWidth = 8.0 renderer.strokeColor = UIColor.magenta renderer.fillColor = UIColor.yellow.withAlphaComponent(0.4) return renderer } return nil } } "},"pages/ç¬¬ä¸‰æ–¹åˆ†äº«/å¾®ä¿¡åˆ†äº«.html":{"url":"pages/ç¬¬ä¸‰æ–¹åˆ†äº«/å¾®ä¿¡åˆ†äº«.html","title":"å¾®ä¿¡åˆ†äº«","keywords":"","body":"å¾®ä¿¡åˆ†äº« å¾®ä¿¡å¼€å‘å¹³å° https://open.weixin.qq.com/ å®˜æ–¹Demoè¿è¡Œ 1.åœ¨èµ„æºä¸‹è½½é¡µé¢ä¸‹è½½å¥½æœ€æ–°çš„iOSå¼€å‘å·¥å…·åŒ…å’ŒèŒƒä¾‹ä»£ç ã€‚ 2.å°†ä¸‹è½½å¥½çš„â€œOpenSDK1.8.9â€æ‹·è´è‡³â€œReleaseSampleâ€ä¸‹ã€‚ 3.æ‰“å¼€SDKSampleï¼Œåˆ é™¤æ˜¾ç¤ºçº¢è‰²çš„â€œSDKExportâ€ï¼Œå³é”®å·¥ç¨‹æ–‡ä»¶é€šè¿‡â€œAdd Files ...â€å°†â€œOpenSDK1.8.9â€å¯¼å…¥å·¥ç¨‹ã€‚ 4.ç‚¹å‡»SDKSampleï¼Œé€‰ä¸­Target,åœ¨Frameworksä¸‹å¢åŠ WebKit.frameworkã€‚ 5.æ›´æ–°å¯ç”¨çš„bundleIDåŠè¯ä¹¦ï¼ŒçœŸæœºå°±å¯ä»¥è¿è¡Œäº†ã€‚ å½“æ—¶æœ€æ–°çš„æ˜¯ï¼ˆ1.8.9ç‰ˆæœ¬ï¼ŒåŒ…å«æ”¯ä»˜åŠŸèƒ½ï¼‰ï¼Œè¿™é‡Œé€‰æ‹©åŒ…å«æ”¯ä»˜ç‰ˆæœ¬çš„ï¼Œå› ä¸ºå®˜æ–¹Demoä½¿ç”¨çš„æ˜¯åŒ…å«æ”¯ä»˜åŠŸèƒ½çš„ã€‚ â€œèŒƒä¾‹ä»£ç â€ä¸åŒ…å«SDKï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨å¯¼å…¥ï¼›â€œèŒƒä¾‹ä»£ç â€æ²¡æœ‰ä¾èµ–WebKit.framework,ä¹Ÿéœ€è¦æ‰‹åŠ¨å¯¼å…¥ï¼›çœŸæœºè¿è¡Œï¼Œéœ€è¦æ›´æ–°å¯ç”¨çš„bundleIDåŠè¯ä¹¦ã€‚ æ–°å»ºå·¥ç¨‹ 1.ç‚¹å‡»Fileï¼Œé€‰æ‹©New->Project->Appï¼Œä¸€ç›´Nextç›´åˆ°å®Œæˆã€‚ 2.åˆ é™¤SceneDelegateï¼Œç›´æ¥Move To Trashã€‚ 3.åˆ é™¤AppDelegateä¸­å…³äºSceneçš„æŠ¥é”™ä»£ç ã€‚ 4.åˆ é™¤Info.plistçš„UIApplicationSceneManifeståŠValueã€‚ 5.åœ¨AppDelegateä¸­å¢åŠ å¦‚ä¸‹ä»£ç ã€‚ var window: UIWindow? æ²¡æœ‰ç¬¬5æ­¥ï¼Œå·¥ç¨‹è¿è¡Œä¼šæ˜¯é»‘å±ï¼Œæ§åˆ¶å°ä¼šæ˜¾ç¤ºâ€œThe app delegate must implement the window property if it wants to use a main storyboard file.â€ã€‚ é›†æˆOpenSDKï¼ˆSwiftï¼‰ å®˜æ–¹æ¥å…¥ç‚¹æŒ‡å— 1.é¦–å…ˆæ–°å»ºSwiftå·¥ç¨‹ï¼Œå·¥ç¨‹åwechatshareï¼Œæ­¥éª¤å¦‚ä¸Šã€‚ 2.å³é”®â€œwechatshareâ€groupï¼Œé€šè¿‡â€œAdd Files ...â€å°†â€œOpenSDK1.8.9â€å¯¼å…¥å·¥ç¨‹ã€‚ æ³¨æ„å‹¾é€‰â€œCopy items if neededâ€ã€‚ 3.æ–°å»ºSwiftæ¡¥æ¥OCçš„æ–‡ä»¶ï¼Œæœ‰ä¸€ä¸‹ä¸¤ç§æ–¹å¼ï¼š 3.1. æ–°å»ºä¸€ä¸ªOCæ–‡ä»¶è‡ªåŠ¨åˆ›å»ºXXX-Bridging-Header.hã€‚ 3.2. å³é”®â€œwechatshareâ€groupï¼ŒNew File...->Header File->wechatshare-Bridging-Header.hï¼Œ ç„¶åç‚¹å‡»Target->Build Settings->æœç´¢Objective-C Bridging Header->å¡«å†™wechatshare/wecha tshare-Bridging-Header.hï¼Œè¿™ä¸ªæ˜¯é¡¹ç›®çš„ç›¸å¯¹è·¯å¾„ã€‚ 4.æµ‹è¯•sdkçš„ä½¿ç”¨ 4.1.é…ç½®çœŸæœºè¯ä¹¦ï¼Œè®¾ç½®iOS Deployment Targetä¸ºçœŸæœºæ”¯æŒçš„ç³»ç»Ÿç‰ˆæœ¬ï¼Œæ–°å»ºå·¥ç¨‹çš„æ—¶å€™è¿™é‡Œæ˜¯æœ€æ–°çš„iOSç‰ˆæœ¬ï¼Œå¯èƒ½æ‰‹æœºä¸æ˜¯æœ€æ–°çš„ï¼Œè¿™é‡Œä¿®æ”¹ä¸‹å°±å¥½ã€‚ 4.2.wechatshare-Bridging-Header.hå¢åŠ å¦‚ä¸‹ä»£ç  #import \"WXApi.h\" 4.3.AppDelegate.swiftå¢åŠ å¦‚ä¸‹ä»£ç  class AppDelegate: UIResponder, UIApplicationDelegate, WXApiDelegate { var window: UIWindow? func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool { // Override point for customization after application launch. WXApi.registerApp(\"\", universalLink: \"\") return true } } 4.4.è¿è¡Œå·¥ç¨‹ï¼ŒæŠ¥é”™è¯¯ï¼š Undefined symbols for architecture arm64: \"operator delete[](void*)\", referenced from: +[WeChatApiUtil EncodeBase64:] in libWeChatSDK.a(WeChatApiUtil.o) +[WeChatApiUtil NsDataEncodeBase64:] in libWeChatSDK.a(WeChatApiUtil.o) +[WeChatApiUtil DecodeWithBase64:] in libWeChatSDK.a(WeChatApiUtil.o) +[WeChatApiUtil DecodeBase64:] in libWeChatSDK.a(WeChatApiUtil.o) \"operator new[](unsigned long)\", referenced from: +[WeChatApiUtil EncodeBase64:] in libWeChatSDK.a(WeChatApiUtil.o) +[WeChatApiUtil NsDataEncodeBase64:] in libWeChatSDK.a(WeChatApiUtil.o) +[WeChatApiUtil DecodeWithBase64:] in libWeChatSDK.a(WeChatApiUtil.o) +[WeChatApiUtil DecodeBase64:] in libWeChatSDK.a(WeChatApiUtil.o) \"_OBJC_CLASS_$_WKWebView\", referenced from: objc-class-ref in libWeChatSDK.a(WapAuthHandler.o) \"_OBJC_CLASS_$_WKWebViewConfiguration\", referenced from: objc-class-ref in libWeChatSDK.a(WapAuthHandler.o) ld: symbol(s) not found for architecture arm64 clang: error: linker command failed with exit code 1 (use -v to see invocation) 4.5.ä¿®å¤æŠ¥é”™ï¼š å¼€å‘è€…éœ€è¦åœ¨å·¥ç¨‹ä¸­é“¾æ¥ä¸Š:Security.frameworkï¼ŒCoreGraphics.frameworkï¼ŒWebKit.frameworkï¼Œlibc++.tbdã€‚ å®˜æ–¹æ–‡æ¡£æ˜¯ä¸Šæ²¡æœ‰å†™éœ€è¦æ¥å…¥libc++.tbdï¼Œä½†æ˜¯å®é™…æ˜¯éœ€è¦çš„ï¼Œè¦ä¸ç„¶ç¼–è¯‘ä¼šé‡åˆ°é”™è¯¯ 5.å‡†å¤‡appidåŠuniversalLink 5.1.ç™»å½•å¼€å‘è€…è€…ä¸­å¿ƒï¼Œç¡®ä¿appå¼€å¯äº†Associated Domainsçš„åŠŸèƒ½ã€‚ 5.2.æ›´æ–°è¯ä¹¦æè¿°æ–‡ä»¶ï¼Œç¡®ä¿åŒ…å«äº†Associated Domainsçš„åŠŸèƒ½ã€‚ 5.4.åœ¨é¡¹ç›®ä¸­é…ç½®applinks:xxxxã€‚ 5.5.å»å¾®ä¿¡å¼€å‘å¹³å°æ³¨å†Œç”¨æˆ·è·å¾—appidã€‚ 5.6.æ›´æ–°AppDelegate.swift class AppDelegate: UIResponder, UIApplicationDelegate, WXApiDelegate { var window: UIWindow? func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool { // Override point for customization after application launch. WXApi.registerApp(\"wx536bce0bc6a71ffd\", universalLink: \"https://huya.gq/demo.html\") return true } } // å¤„ç†universallink extension AppDelegate { func application(_ application: UIApplication, handleOpen url: URL) -> Bool { return WXApi.handleOpen(url, delegate: self) } func application(_ application: UIApplication, open url: URL, sourceApplication: String?, annotation: Any) -> Bool { return WXApi.handleOpen(url, delegate: self) } func application(_ application: UIApplication, continue userActivity: NSUserActivity, restorationHandler: @escaping ([UIUserActivityRestoring]?) -> Void) -> Bool { return WXApi.handleOpenUniversalLink(userActivity, delegate: self) } } 6.åˆ†äº«è¶…é“¾æ¥ 6.1.åœ¨ViewController.swiftå¢åŠ å¦‚ä¸‹ä»£ç ï¼Œç‚¹å‡»æŒ‰é’®è§¦å‘åˆ†äº«ï¼š /// å‘é€Linkæ¶ˆæ¯ç»™å¾®ä¿¡ @IBAction @objc private func sendLinkContent() { let webpageObject = WXWebpageObject() webpageObject.webpageUrl = Constant.kLinkURL let message = WXMediaMessage() message.title = Constant.kLinkTitle; message.description = Constant.kLinkDescription; message.setThumbImage(UIImage(named: \"res2.png\")!) //åˆ†äº«åå±•ç¤ºå›¾ç‰‡ï¼Œæ²¡æœ‰å°±æ˜¾ç¤ºå¤§å¤§çš„é—®å·å›¾ç‰‡ã€‚ message.mediaObject = webpageObject; let req = SendMessageToWXReq(); req.bText = false; req.message = message; req.scene = Int32(WXSceneSession.rawValue);//WXSceneSession; WXApi.send(req) { (result) in} } 6.2.å‘ç°æŠ¥é”™ï¼š -canOpenURL: failed for URL: \"weixinULAPI://\" - error: \"This app is not allowed to query for scheme weixinulapi\" 6.3.è§£å†³æŠ¥é”™ æ‰“å¼€info.plist,å¢åŠ å¦‚ä¸‹ä»£ç ï¼š LSApplicationQueriesSchemes weixin weixinULAPI CFBundleURLTypes CFBundleURLName weixin CFBundleURLSchemes wx536bce0bc6a7**** 6.4.æ¥ç€æŠ¥é”™ï¼š *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '+[WXApi genExtraUrlByReq:withAppData:]: unrecognized selector sent to class 0x100286398' 6.5.è§£å†³æŠ¥é”™ åœ¨ä½ çš„å·¥ç¨‹æ–‡ä»¶ä¸­é€‰æ‹© Build Settingï¼Œåœ¨\"Other Linker Flags\"ä¸­åŠ å…¥\"-ObjC -all_load\" ä»£ç  "},"pages/ç¬¬ä¸‰æ–¹åˆ†äº«/Messengeråˆ†äº«.html":{"url":"pages/ç¬¬ä¸‰æ–¹åˆ†äº«/Messengeråˆ†äº«.html","title":"Messengeråˆ†äº«","keywords":"","body":"Messengeråˆ†äº« åˆ†äº«åˆ° iOS å’Œ Android ç‰ˆ Messenger iOSåˆ†äº«åˆ°å›½å¤–ç¤¾äº¤APPè°ƒç ” æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å®‰è£…äº†iOS 9çš„Facebook Messenger åº”ç”¨çš„ iOS9 å…¼å®¹å‡†å¤‡ é‡åˆ°ä¸ªé—®é¢˜ï¼šæˆ‘ä¹‹å‰ä»¥ä¸ºFacebookå’ŒMesseæ˜¯ä¸€ä¸ªAppï¼Œå¯¼è‡´åœ¨æ²¡æœ‰è£…Messengerçš„æƒ…å†µä¸€ä¸‹ä¸€ç›´åˆ†äº«æŠ¥é”™ï¼šâ€œè¯´å¼¹çª—æ²¡æœ‰æ„ä¹‰â€ï¼Œåæ¥æ‰å‘ç°æˆ‘æ²¡æœ‰è£…Messengerï¼Œé—®é¢˜è§£å†³ï¼ "},"pages/ç¬¬ä¸‰æ–¹åˆ†äº«/LinkedInåˆ†äº«.html":{"url":"pages/ç¬¬ä¸‰æ–¹åˆ†äº«/LinkedInåˆ†äº«.html","title":"LinkedInåˆ†äº«","keywords":"","body":"LinkedInåˆ†äº« iOS LinkedInç™»å½•åŠä¿¡æ¯è·å– å¦‚ä½•ä½¿ç”¨ OAuth 2.0 å°† LinkedIn é›†æˆå…¥ iOS åº”ç”¨ linkedinå¼€å‘è€…ä¸­å¿ƒ é€šè¿‡iOSåº”ç”¨åœ¨LinkedInä¸Šå…±äº«URL å¦‚ä½•ä½¿ç”¨ OAuth 2.0 å°† LinkedIn é›†æˆå…¥ iOS åº”ç”¨ "},"pages/iOSç»„ä»¶åŒ–/å‚è€ƒé“¾æ¥.html":{"url":"pages/iOSç»„ä»¶åŒ–/å‚è€ƒé“¾æ¥.html","title":"å‚è€ƒé“¾æ¥","keywords":"","body":"å‚è€ƒé“¾æ¥ iOSç»„ä»¶åŒ–ä¹‹æ¶æ„é€šç”¨è®¾è®¡ å†™iOS SDKæ³¨æ„äº‹é¡¹ BeeHive CocoaPods åˆ›å»ºç§æœ‰ä»“åº“ï¼ˆObjCï¼‰ iOSç»„ä»¶åŒ–ï¼ˆä¸‹ç¯‡ï¼‰-åŠ è½½XIBã€å›¾ç‰‡èµ„æº iOSå¼€å‘â€”â€”ç»„ä»¶åŒ–åŠå»ModeåŒ–æ–¹æ¡ˆ CTModule Githubæœç´¢BundleNameå‘ç°äº†ä¸å°‘å¥½çš„ä»“åº“ åŸºäºCTMediatorçš„ç»„ä»¶åŒ–ä¸­é—´ä»¶ LocalizedStringKit UCPlanKit YXResources.h ZJBundleRes.h ImageCachePool.m LBResourceBundleManager NSBundle+DFBundle.h ZUXBundle.h NSBundle+DFBundle.h NSBundle+Resource.h NSBundle+Extension.h UIImage+QIBundle.m CCCommentsHeader.h UCUIMacro.h "},"pages/iOSç»„ä»¶åŒ–/åˆ›å»ºç§æœ‰åº“.html":{"url":"pages/iOSç»„ä»¶åŒ–/åˆ›å»ºç§æœ‰åº“.html","title":"1.åˆ›å»ºç§æœ‰åº“","keywords":"","body":"åˆ›å»ºç§æœ‰åº“ ä¸€ã€åˆ›å»ºå­˜æ”¾podsepcçš„ç§æœ‰ä»“åº“ åœ¨è‡ªå·±çš„gitæœåŠ¡å™¨ä¸­åˆ›å»ºä¸€ä¸ªä¿å­˜podspecçš„ä»“åº“ï¼š[repo name]ã€‚ åˆ›å»ºå®Œä»“åº“ä¹‹åè·å–ä»“åº“åœ°å€ åœ¨terminalä¸­æ‰§è¡Œpodçš„æŒ‡ä»¤å°†ä»“åº“æ·»åŠ åˆ°æœ¬åœ°çš„pod repoä¸­ã€‚ pod repo add [repo name] [url] æ·»åŠ å®Œæˆä¹‹åï¼Œåœ¨~/.cocoapods/reposä¸­å°±å¯ä»¥çœ‹åˆ°åç§°ä¸º[repo name]çš„æ–‡ä»¶å¤¹ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„ç§æœ‰podä»“åº“ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨pod repo remove [repo name]ç§»é™¤repoã€‚ äºŒã€åˆ›å»ºå­˜æ”¾æºç çš„ä»“åº“å¹¶æ¨é€åˆ°ç§æœ‰ä»“åº“ åœ¨gitæœåŠ¡å™¨ä¸Šå†åˆ›å»ºä¸€ä¸ªä»“åº“ç”¨äºå­˜æ”¾æºä»£ç ã€‚ åœ¨terminalä¸­æ‰§è¡Œpod lib create [lib name]åˆ›å»ºä¸€ä¸ªcocoapodsçš„demoå·¥ç¨‹ã€‚ æ‰§è¡Œä¹‹åä¼šä»gitå…‹éš†ä¸€ä¸ªæ¨¡æ¿ï¼Œå¹¶ä¼šé—®å‡ ä¸ªé—®é¢˜ï¼Œä¾æ¬¡æŒ‰ç…§éœ€æ±‚é€‰æ‹©å³å¯ï¼Œå®Œæˆä¹‹åä¼šæ‰“å¼€ä¸€ä¸ªXcode projectã€‚ ä¸‰ã€ç¼–è¾‘podspecæ–‡ä»¶ Pod::Spec.new do |s| s.name = 'åå­—' s.version = 'ç‰ˆæœ¬å· éœ€è¦å’Œgit tagä¿æŒä¸€è‡´' s.summary = 'ç®€è¿°' # This description is used to generate tags and improve search results. # * Think: What does it do? Why did you write it? What is the focus? # * Try to keep it short, snappy and to the point. # * Write the description between the DESC delimiters below. # * Finally, don't worry about the indent, CocoaPods strips it! s.description = 'MIT', :file => 'LICENSE' } s.author = { 'changqing.chen' => 'chenchangqing198@126.com' } s.source = { :git => 'gitä»“åº“åœ°å€', :tag => s.version.to_s } # s.social_media_url = 'https://twitter.com/' s.ios.deployment_target = '9.0' s.source_files = 'utlogin/Classes/**/*' # s.resource_bundles = { # 'utlogin' => ['utlogin/Assets/*.png'] # } # s.public_header_files = 'Pod/Classes/**/*.h' # s.frameworks = 'UIKit', 'MapKit' # s.dependency 'AFNetworking', '~> 2.3' end å››ã€æ ¡éªŒpodspecæ–‡ä»¶ ç¼–è¾‘å®Œæˆä¹‹åï¼Œä½¿ç”¨pod lib lintæ¥éªŒè¯podspecå¡«å†™çš„å‡†ç¡®æ€§ï¼Œå¯ä»¥é€‰æ‹©å‚æ•°: --verboseæŸ¥çœ‹æ•´ä¸ªè¿‡ç¨‹ --allow-warningså…è®¸ä¸€äº›è­¦å‘Šé€šè¿‡éªŒè¯ï¼Œå¦‚æœéªŒè¯å‡ºé”™ï¼Œè€Œproject build successå¯ä»¥å°è¯•æ·»åŠ è¿™ä¸ªå‚æ•° --sourceå¦‚æœä¾èµ–çš„åº“æ˜¯ä¸€ä¸ªç§æœ‰ä»“åº“åˆ›å»ºçš„åº“ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‚æ•°æŒ‡å®šç§æœ‰ä»“åº“çš„podspecä»“åº“ï¼Œé™¤æ­¤ä¹‹å¤–æœ€å¥½å°†cocoapodså…¬æœ‰åº“çš„sourceä¹ŸæŒ‡å®šä¸€ä¸‹ æŒ‡å®šsource pod lib lint --sources='[ç§æœ‰podsepecä»“åº“åœ°å€],https://github.com/CocoaPods/Specs' --verbose --allow-warnings --no-clean ä¸æŒ‡å®šsource pod lib lint --verbose --allow-warnings --no-clean æ‰§è¡Œé—®pod lib lintï¼Œçœ‹åˆ°[lib name] passed validationåå°±ç®—é€šè¿‡æ ¡éªŒã€‚ äº”ã€æ¨é€è‡³ç§æœ‰ä»“åº“ ç¼–è¾‘.gitignoreï¼Œå°†# Pods/ä¿®æ”¹ä¸ºPods/ï¼Œå¿½ç•¥Podsæ–‡ä»¶å¤¹ï¼Œç¬¬ä¸‰æ–¹ä»£ç å°±ä¸ä¼šä¸Šä¼ ã€‚ é€šè¿‡éªŒè¯åï¼Œå°†æºç æ¨é€è‡³gitä»“åº“ï¼š git init git add . git commit -am 'desc' git remote add origin 'url' git push origin master git tag 'tag' git push --tags å°†podsepcæ·»åŠ åˆ°ç§æœ‰repoä¸­ä½¿ç”¨å‘½ä»¤ï¼š pod repo push [repo name] [name.podspec] --verbose --allow-warnings "},"pages/iOSç»„ä»¶åŒ–/ä½¿ç”¨ä¸­é—´ä»¶.html":{"url":"pages/iOSç»„ä»¶åŒ–/ä½¿ç”¨ä¸­é—´ä»¶.html","title":"2.ä½¿ç”¨ä¸­é—´ä»¶","keywords":"","body":"2.ä½¿ç”¨ä¸­é—´ä»¶ CTMediator æœ¬æ–‡åªä»‹ç»ObjCå¦‚ä½•ä½¿ç”¨CTMediatorã€‚ ä¸€ã€æ–°å»ºä¸šåŠ¡ç»„ä»¶Target é€šè¿‡ä¸‹è½½CTMediatorçš„Demoï¼Œæ¯ä¸ªç»„ä»¶éƒ½ä¼šæœ‰ä¸€ä¸ªTargetçš„ç±»ï¼Œç”¨äºæä¾›å¯¹å¤–æ–¹æ³•çš„å®ç°ã€‚ Targetç±»çš„å‘½åè§„åˆ™ï¼šâ€œTarget_[lib name]â€ï¼Œä¾‹å¦‚ï¼šTarget_Aï¼ŒAæ˜¯ç»„ä»¶åç§°ï¼ŒTargetæ˜¯å›ºå®šä¸å˜çš„ã€‚ Targetæ–¹æ³•å‘½åè§„åˆ™ï¼šâ€œAction_[method name]â€ï¼Œä¾‹å¦‚ï¼šAction_ViewControllerï¼ŒViewControlleræ˜¯æ–¹æ³•åç§°ï¼ŒActionæ˜¯å›ºå®šä¸å˜çš„ã€‚ @implementation Target_testlib - (UIViewController *)Action_OneKeyLoginVC:(NSDictionary *)params { typedef void (^CallbackType)(NSString *); CallbackType callback = params[@\"callback\"]; if (callback) { callback(@\"success\"); } UTOneKeyLoginVC *viewController = [[UTOneKeyLoginVC alloc] init]; return viewController; } @end äºŒã€æ–°å»ºä¸šåŠ¡ç»„ä»¶å¯¹å¤–æ¥å£ CTMediatoræ˜¯é€šè¿‡Target-Actionçš„æ–¹å¼å®ç°ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç»™CTMediatorå¢åŠ Categoryï¼Œåœ¨Categoryå†™ç»„ä»¶å¯¹å¤–çš„æ–¹æ³•å’Œå®ç°å³å¯ã€‚ åœ¨gitæœåŠ¡å™¨åˆ›å»ºä¸­é—´ä»¶ä»“åº“ï¼Œé€šè¿‡pod lib create [ä¸­é—´ä»¶åç§°]åˆ›å»ºä¸­é—´ä»¶å·¥ç¨‹ã€‚ ç¼–è¾‘podspecæ–‡ä»¶ï¼Œå¢åŠ s.dependency 'CTMediator'ï¼Œç„¶åæ‰§è¡Œpod installï¼Œå®ŒæˆCTMediatorçš„ä¾èµ–ã€‚ é€šè¿‡æ–°å¢CTMediatorçš„åˆ†ç±»ï¼Œå®ç°ç»„ä»¶å¯¹å¤–çš„æ¥å£ã€‚ åˆ†ç±»çš„å‘½åï¼šCTMediator+[lib name]ï¼Œä¾‹å¦‚ï¼šCTMediator+testlib.hã€‚ æ–¹æ³•çš„å‘½åï¼š[lib name]_[method name]ï¼Œä¾‹å¦‚ï¼šutlogin_OneKeyLoginVCWithCallbackã€‚ ä¸ºCTMediatorå¢åŠ åˆ†ç±»ï¼Œç¼–å†™ä¸šåŠ¡ç»„ä»¶çš„æ¥å£æ–¹æ³•ï¼š @implementation CTMediator (utlogin) /// ä¸€é”®ç™»å½•é¡µé¢ /// @param callback å›è°ƒ - (UIViewController *)utlogin_OneKeyLoginVCWithCallback:(void(^)(NSString *result))callback; { NSMutableDictionary *params = [[NSMutableDictionary alloc] init]; params[@\"callback\"] = callback; return [self performTarget:@\"utlogin\" action:@\"OneKeyLoginVC\" params:params shouldCacheTarget:NO]; } @end è¿™æ ·å°±å®Œæˆäº†ç»„ä»¶å¯¹å¤–çš„æ¥å£äº†ï¼Œå®¿ä¸»å·¥ç¨‹å¯ä»¥é€šè¿‡ä¾èµ–ä¸­é—´ä»¶ç›´æ¥è°ƒç”¨åˆ°ç»„ä»¶çš„Target_testlibçš„å®ç°ã€‚ ä¸‰ã€æ–°å»ºå®¿ä¸»å·¥ç¨‹ ä½¿ç”¨xcodeåˆ›å»ºå®¿ä¸»å·¥ç¨‹ï¼Œåœ¨é€šè¿‡pod initåˆ›å»ºPodfileæ–‡ä»¶ã€‚ using-cocoapods ç¼–è¾‘Podfileæ–‡ä»¶ï¼š # Uncomment the next line to define a global platform for your project # platform :ios, '9.0' source 'ç§æœ‰ä»“åº“åœ°å€' source 'https://github.com/CocoaPods/Specs.git' target 'utopia' do # Comment the next line if you don't want to use dynamic frameworks use_frameworks! use_modular_headers! # Pods for utopia pod 'testlib'#ä¸šåŠ¡ç»„ä»¶ pod 'testmediatro'#ä¸­é—´ä»¶ end æ‰§è¡Œpod installã€‚ "},"pages/iOSç»„ä»¶åŒ–/åŠ è½½å›¾ç‰‡èµ„æº.html":{"url":"pages/iOSç»„ä»¶åŒ–/åŠ è½½å›¾ç‰‡èµ„æº.html","title":"3.åŠ è½½å›¾ç‰‡èµ„æº","keywords":"","body":"3.åŠ è½½å›¾ç‰‡èµ„æº NSBundle+Resource.h #import NS_ASSUME_NONNULL_BEGIN @interface NSBundle (Resource) /** è·å–èµ„æºçš„bundle @param className frameworkä¸­çš„ç±»å @param bundleName èµ„æºbundleçš„åå­— */ + (instancetype)resourceBundleWithClassName:(NSString *)className bundleName:(NSString *)bundleName; /** è·å–èµ„æºçš„bundle,é»˜è®¤bundleä¸ºå½“å‰ç±»æ‰€åœ¨çš„bundle @param bundleName èµ„æºbundleçš„åå­— */ + (instancetype)resourceBundleWithBundleName:(NSString *)bundleName; /** æ ¹æ®pathæ¥åŠ è½½bundle è·å–èµ„æºçš„bundle @param frameworkName ä¸ºèµ„æºæ‰€åœ¨çš„frameworkçš„åå­— @param bundleName èµ„æºbundleçš„åå­— */ + (instancetype)resourceBundleWithFramework:(NSString *)frameworkName bundleName:(NSString *)bundleName; /** è¿™ä¸ªæ–¹æ³•ä¼šç›´æ¥ç»™å‡º frameworkçš„bundle @param className frameworkä¸­çš„ä»»æ„ç±»å */ + (instancetype)getFrameworkBundleWithClassName:(NSString *)className; /** è¿™ä¸ªæ–¹æ³•ä¼šç›´æ¥ç»™å‡º frameworkçš„bundle @param frameworkName frameworkçš„åç§° */ + (instancetype)getFrameworkBundleWithFramework:(NSString *)frameworkName; /** åŠ è½½main bundleä¸‹ èµ„æºbundle @param bundleName èµ„æºbundleåå­— */ + (instancetype)getMainBundleWithResourceBundle:(NSString *)bundleName; @end NS_ASSUME_NONNULL_END NSBundle+Resource.m #import \"NSBundle+Resource.h\" @implementation NSBundle (Resource) + (instancetype)resourceBundleWithClassName:(NSString *)className bundleName:(NSString *)bundleName{ if (!className) { NSAssert(!className, @\"è·å–èµ„æºè·¯å¾„bundleæ—¶ï¼Œç±»åä¸ºç©º\"); return nil; } NSBundle *frameworkBundle = [NSBundle bundleForClass:NSClassFromString(className)]; if (!frameworkBundle) { NSAssert(!className, @\"è·å–èµ„æºè·¯å¾„bundleæ—¶ï¼Œè·å–frameworkçš„bundleä¸ºç©º\"); return nil; } NSURL *frameworkBundleUrl = [frameworkBundle URLForResource:bundleName withExtension:@\"bundle\"]; if (!frameworkBundleUrl) { NSAssert(!className, @\"è·å–èµ„æºè·¯å¾„bundleæ—¶ï¼Œè·å–frameworkbundleURLä¸ºç©º\"); return nil; } return [self bundleWithURL:frameworkBundleUrl]; } + (instancetype)resourceBundleWithBundleName:(NSString *)bundleName{ return [self resourceBundleWithClassName:NSStringFromClass(self) bundleName:bundleName]; } + (instancetype)resourceBundleWithFramework:(NSString *)frameworkName bundleName:(NSString *)bundleName{ NSURL *frameworksURL = [[NSBundle mainBundle] URLForResource:@\"Frameworks\" withExtension:nil]; if (!frameworkName) { NSAssert(!frameworkName, @\"è·å–èµ„æºè·¯å¾„bundleæ—¶ï¼ŒframeworkNameä¸ºç©º\"); } NSURL* libFrameworkURL = [frameworksURL URLByAppendingPathComponent:frameworkName]; libFrameworkURL = [libFrameworkURL URLByAppendingPathExtension:@\"framework\"]; NSBundle *libFrameworkBundle = [NSBundle bundleWithURL:libFrameworkURL]; if (!libFrameworkBundle) { NSAssert(!libFrameworkBundle, @\"è·å–èµ„æºè·¯å¾„bundleæ—¶ï¼Œè·å–frameworkçš„bundleä¸ºç©º\"); } NSURL* libResourceBundleUrl = [libFrameworkBundle URLForResource:bundleName withExtension:@\"bundle\"]; return [self bundleWithURL:libResourceBundleUrl]; } + (instancetype)getFrameworkBundleWithClassName:(NSString *)className{ if (!className) { NSAssert(!className, @\"è·å–èµ„æºè·¯å¾„bundleæ—¶ï¼Œç±»åä¸ºç©º\"); return nil; } NSBundle *frameworkBundle = [self bundleForClass:NSClassFromString(className)]; return frameworkBundle; } + (instancetype)getFrameworkBundleWithFramework:(NSString *)frameworkName{ NSURL *frameworksURL = [[NSBundle mainBundle] URLForResource:@\"Frameworks\" withExtension:nil]; if (!frameworkName) { NSAssert(!frameworkName, @\"è·å–èµ„æºè·¯å¾„bundleæ—¶ï¼ŒframeworkNameä¸ºç©º\"); } NSURL* libFrameworkURL = [frameworksURL URLByAppendingPathComponent:frameworkName]; libFrameworkURL = [libFrameworkURL URLByAppendingPathExtension:@\"framework\"]; NSBundle *libFrameworkBundle = [self bundleWithURL:libFrameworkURL]; return libFrameworkBundle; } + (instancetype)getMainBundleWithResourceBundle:(NSString *)bundleName{ NSBundle *mainBundle = [NSBundle mainBundle]; NSURL *resourceUrl = [mainBundle URLForResource:bundleName withExtension:@\"bundle\"]; return [self bundleWithURL:resourceUrl]; } @end UIImage+Resource.h #import NS_ASSUME_NONNULL_BEGIN @interface UIImage (Resource) /** é€šè¿‡å›¾ç‰‡åç§°ï¼Œå›¾ç‰‡bundleæ‰€åœ¨frameworkçš„ç±»åå’Œå›¾ç‰‡æ‰€åœ¨bundle æ¥åŠ è½½å›¾ç‰‡ @param imageName å›¾ç‰‡åç§° @param className å›¾ç‰‡æ‰€åœ¨frameworkä¸­ä»»æ„ä¸€ä¸ªç±»çš„åç§° @param bundleName å›¾ç‰‡æ‰€åœ¨ bundle */ + (UIImage *)imageNamed:(NSString *)imageName className:(NSString *)className bundleName:(NSString *)bundleName; /** é€šè¿‡å›¾ç‰‡åç§°ï¼Œå›¾ç‰‡æ‰€åœ¨frameworkçš„ç±»å æ­¤æ—¶å›¾ç‰‡ç›´æ¥ä½äºframework bundleä¸‹ @param imageName å›¾ç‰‡åç§° @param className å›¾ç‰‡æ‰€åœ¨frameworkä¸­ä»»æ„ä¸€ä¸ªç±»çš„åç§° */ + (UIImage *)imageNamed:(NSString *)imageName className:(NSString *)className; /** é€šè¿‡å›¾ç‰‡åç§°ï¼Œå›¾ç‰‡æ‰€åœ¨frameworkçš„ç±»å æ­¤æ—¶å›¾ç‰‡ç›´æ¥ä½äºframework bundleä¸‹ @param imageName å›¾ç‰‡åç§° @param frameworkName å›¾ç‰‡æ‰€åœ¨frameworkä¸­ä»»æ„ä¸€ä¸ªç±»çš„åç§° */ + (UIImage *)imageNamed:(NSString *)imageName frameworkName:(NSString *)frameworkName; /** é€šè¿‡å›¾ç‰‡åç§°ï¼Œå›¾ç‰‡bundleæ‰€åœ¨framework å’Œ å›¾ç‰‡æ‰€åœ¨çš„bundle æ¥åŠ è½½å›¾ç‰‡ @param imageName å›¾ç‰‡åç§° @param frameworkName æ¡†æ¶åç§° @param bundleName bundle åå­— */ + (UIImage *)imageNamed:(NSString *)imageName framework:(NSString *)frameworkName bundleName:(NSString *)bundleName; /** åŠ è½½main bundleä¸‹çš„å›¾ç‰‡ @param imageName å›¾ç‰‡åç§° @param bundleName bundleåç§° */ + (UIImage *)imageNamed:(NSString *)imageName bundleName:(NSString *)bundleName; @end NS_ASSUME_NONNULL_END UIImage+Resource.m #import \"UIImage+Resource.h\" #import \"NSBundle+Resource.h\" @implementation UIImage (Resource) + (UIImage *)imageNamed:(NSString *)imageName className:(NSString *)className bundleName:(NSString *)bundleName{ NSBundle *bundle = [NSBundle resourceBundleWithClassName:className bundleName:bundleName]; UIImage *image = [UIImage imageNamed:imageName inBundle:bundle compatibleWithTraitCollection:nil]; return image; } + (UIImage *)imageNamed:(NSString *)imageName framework:(NSString *)frameworkName bundleName:(NSString *)bundleName{ NSBundle *bundle = [NSBundle resourceBundleWithFramework:frameworkName bundleName:bundleName]; UIImage *image = [UIImage imageNamed:imageName inBundle:bundle compatibleWithTraitCollection:nil]; return image; } + (UIImage *)imageNamed:(NSString *)imageName className:(NSString *)className{ NSBundle *bundle = [NSBundle getFrameworkBundleWithClassName:className]; UIImage *image = [UIImage imageNamed:imageName inBundle:bundle compatibleWithTraitCollection:nil]; return image; } + (UIImage *)imageNamed:(NSString *)imageName frameworkName:(NSString *)frameworkName{ NSBundle *bundle = [NSBundle getFrameworkBundleWithFramework:frameworkName]; UIImage *image = [UIImage imageNamed:imageName inBundle:bundle compatibleWithTraitCollection:nil]; return image; } + (UIImage *)imageNamed:(NSString *)imageName bundleName:(NSString *)bundleName{ if (!imageName || !bundleName) { NSAssert(!imageName || !bundleName, @\"image name æˆ–è€… bundle name ä¸ºç©º\"); return nil; } NSBundle *bundle = [NSBundle getMainBundleWithResourceBundle:bundleName]; UIImage *image = [UIImage imageNamed:imageName inBundle:bundle compatibleWithTraitCollection:nil]; return image; } @end "},"pages/å…¶ä»–/é•¿åŸæ±½è½¦Swiftç¼–ç¨‹è§„çº¦.html":{"url":"pages/å…¶ä»–/é•¿åŸæ±½è½¦Swiftç¼–ç¨‹è§„çº¦.html","title":"é•¿åŸæ±½è½¦Swiftç¼–ç¨‹è§„çº¦","keywords":"","body":"1.é•¿åŸæ±½è½¦Swiftç¼–ç¨‹è§„çº¦ å‰è¨€ å¥½çš„ä»£ç æœ‰ä¸€äº›ç‰¹æ€§ï¼šç®€æ˜ï¼Œè‡ªæˆ‘è§£é‡Šï¼Œä¼˜ç§€çš„ç»„ç»‡ï¼Œè‰¯å¥½çš„æ–‡æ¡£ï¼Œè‰¯å¥½çš„å‘½åï¼Œä¼˜ç§€çš„è®¾è®¡ä»¥åŠå¯ä»¥è¢«ä¹…ç»è€ƒéªŒã€‚å‚ä¸é•¿åŸç³»åˆ—APPå¼€å‘çš„å›¢é˜Ÿæˆå‘˜åº”ä¸¥æ ¼éµç…§è§„çº¦ç¼–å†™ä»£ç ã€‚è§„çº¦ä¼šè¶Šæ¥è¶Šå®Œå–„ï¼ŒåˆæœŸå…ˆæŒ‰ç…§ä»¥ä¸‹è§„èŒƒã€‚ ç¬¬ä¸€æ¬¡ç¼–è¾‘æ—¶é—´:2020-01-28 æ ¸å¿ƒåŸåˆ™ æœ€é‡è¦çš„ç›®æ ‡ï¼šæ¯ä¸ªå…ƒç´ éƒ½èƒ½å¤Ÿå‡†ç¡®æ¸…æ™°çš„è¡¨è¾¾å‡ºå®ƒçš„å«ä¹‰ã€‚åšå‡º API è®¾è®¡ã€å£°æ˜åè¦æ£€æŸ¥åœ¨ä¸Šä¸‹æ–‡ä¸­æ˜¯å¦è¶³å¤Ÿæ¸…æ™°æ˜ç™½ã€‚ æ¸…æ™°æ¯”ç®€æ´é‡è¦ã€‚è™½ç„¶ swift ä»£ç å¯ä»¥è¢«å†™å¾—å¾ˆç®€çŸ­ï¼Œä½†æ˜¯è®©ä»£ç å°½é‡å°‘ä¸æ˜¯ swift çš„ç›®æ ‡ã€‚ç®€æ´çš„ä»£ç æ¥æºäºå®‰å…¨ã€å¼ºå¤§çš„ç±»å‹ç³»ç»Ÿå’Œå…¶ä»–ä¸€äº›è¯­è¨€ç‰¹æ€§å‡å°‘äº†ä¸å¿…è¦çš„æ¨¡æ¿ä»£ç ã€‚è€Œä¸æ˜¯ä¸»è§‚ä¸Šå†™å‡ºæœ€å°‘çš„ä»£ç ã€‚ ä¸ºæ¯ä¸€ä¸ªå£°æ˜å†™æ³¨é‡Šæ–‡æ¡£ã€‚ç¼–å†™æ–‡æ¡£è¿‡ç¨‹ä¸­è·å¾—çš„ç†è§£å¯ä»¥å¯¹è®¾è®¡äº§ç”Ÿæ·±è¿œçš„å½±å“ï¼Œæ‰€ä»¥ä¸è¦å›é¿æ‹–å»¶ã€‚ å¦‚æœä½ ä¸èƒ½å¾ˆå¥½çš„æè¿° API çš„åŠŸèƒ½ï¼Œå¾ˆå¯èƒ½è¿™ä¸ª API çš„è®¾è®¡å°±æ˜¯æœ‰é—®é¢˜çš„ã€‚ å‘½åè§„çº¦ ä¸è¦ä½¿ç”¨çº¦å®šå‘½åæ ·å¼ä»£æ›¿è®¿é—®æ§åˆ¶ å¦‚æœè¦æ§åˆ¶è®¿é—®æƒé™åº”è¯¥ä½¿ç”¨è®¿é—®æ§åˆ¶ï¼ˆinternalã€fileprivateã€privateï¼‰ï¼Œä¸ç”¨ä½¿ç”¨è‡ªå®šä¹‰çš„å‘½åæ–¹å¼æ¥åŒºåˆ†ï¼Œæ¯”å¦‚åœ¨æ–¹æ³•å‰å‰ä¸‹åˆ’çº¿è¡¨ç¤ºç§æœ‰ã€‚ åªæœ‰åœ¨æç«¯çš„æƒ…å†µä¸‹æ‰ä¼šé‡‡ç”¨è¿™ç§è‡ªå®šä¹‰å‘½åè¡¨ç¤ºã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªæ–¹æ³•åªæ˜¯ä¸ºäº†æŸä¸ªæ¨¡æ¿è°ƒç”¨æ‰å…¬å¼€çš„ï¼Œè¿™ç§æƒ…å†µä¸‹æœ¬æ„æ˜¯ç§æœ‰çš„ï¼Œä½†æ˜¯åˆå¿…é¡»å£°æ˜æˆ publicï¼Œå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„å‘½åæƒ¯ä¾‹ã€‚ ä»£ç ä¸­çš„å‘½åä¸¥ç¦ä½¿ç”¨æ‹¼éŸ³ä¸è‹±æ–‡æ··åˆçš„æ–¹å¼ï¼Œæ›´ä¸å…è®¸ç›´æ¥ä½¿ç”¨ä¸­æ–‡çš„æ–¹å¼ã€‚ âœ… var productDiskDataArray: Array? var productDiskDataString: String! âŒ var chanpinDataArray: Array? var chanpinDataString: String! ç±», ç»“æ„ä½“, æšä¸¾, åè®®å‘½åä½¿ç”¨ UpperCamelCase é£æ ¼ï¼Œå¿…é¡»éµä»é©¼å³°å½¢å¼ã€‚ç‰¹åˆ«æ³¨æ„ç±»åå¼€å¤´å¤§å†™ã€‚ âœ… class GWElecFenceFlowLayout: UICollectionViewFlowLayout âŒ class gwElecFenceFlowLayout: UICollectionViewFlowLayout èµ„æºæ–‡ä»¶æŒ‰ç…§åŒˆç‰™åˆ©å‘½åæ³•ã€‚ æ¨¡å—å+å›¾ç‰‡ç‰¹å¾æè¿°+çŠ¶æ€ æè¿°æ¸…æ™°æœ‰ç« æ³•å³å¯ã€‚ âœ… nav_add_normal@2X.png âŒ navAddNormal@2X.png NAV_ADD_NORMAL@2x.png æ–¹æ³•åã€å‚æ•°åã€æˆå‘˜å˜é‡ã€å±€éƒ¨å˜é‡éƒ½ç»Ÿä¸€ä½¿ç”¨ lowerCamelCase é£æ ¼ï¼Œå¿…é¡»éµä»é©¼å³°å½¢å¼ã€‚ âœ… func viewDidLoad() func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int let automaticDimension: CGFloat let gradientShapeLayer = CAShapeLayer() âŒ func ViewDidLoad() func tableView(_ tableV: UITableView, numberOfRowsInSection section: Int) -> Int var FILLCOLOR: CGColor? let gradientshapeLayer = CAShapeLayer() å…¨å±€å¸¸é‡å°±æ­£å¸¸å˜é‡ä¸€æ ·ä½¿ç”¨åŒˆç‰™åˆ©å‘½åæ–¹å¼ï¼Œä¸è¦åœ¨å‰é¢åŠ ä¸Š gã€k æˆ–å…¶ä»–ç‰¹åˆ«çš„æ ¼å¼ã€‚ âœ… let secondsPerMinute = 60 âŒ let SecondsPerMinute = 60 let kSecondsPerMinute = 60 let gSecondsPerMinute = 60 let SECONDS_PER_MINUTE = 60 æœç»å®Œå…¨ä¸è§„èŒƒçš„ç¼©å†™ï¼Œé¿å…æœ›æ–‡ä¸çŸ¥ä¹‰ã€‚ âŒ var abcAry: Array? ä¿è¯è‹±æ–‡æ‹¼å†™æ­£ç¡® âŒ class AysncDat: NSObject å•ä¾‹å¯¹è±¡ä¸€èˆ¬å‘½åä¸º shared æˆ–è€… defaultã€‚ âœ… /// è·¯ç”±å•ä¾‹ public static let shared = GWNavigator() /// å±è”½å®ç°æ–¹å¼(å¯æ ¹æ®å…·ä½“ä½¿ç”¨æƒ…å†µçµæ´»è°ƒæ•´) private override init() {} æ ¼å¼è§„çº¦ æ‹¬å· éç©ºçš„ block èŠ±æ‹¬å·é»˜è®¤ä½¿ç”¨ K&R styleã€‚æ¯”å¦‚ï¼š while (x == y) { something() somethingelse() } é™¤äº†ä¸€äº› Swift ç‰¹åˆ«è¦æ±‚çš„æƒ…å†µï¼š å·¦èŠ±æ‹¬å·ï¼ˆ { ï¼‰å‰çš„ä»£ç ä¸ä¼šæ¢è¡Œï¼Œé™¤éè¶…è¿‡å‰é¢æåˆ°çš„ä»£ç é•¿åº¦è¶…è¿‡é™åˆ¶ã€‚ å·¦èŠ±æ‹¬å·åæ˜¯ä¸€ä¸ªæ¢è¡Œï¼Œé™¤éï¼š åé¢è¦å£°æ˜é—­åŒ…çš„å‚æ•°ï¼Œæ”¹ä¸ºåœ¨ in å…³é”®å­—åé¢æ¢è¡Œã€‚ ç¬¦åˆæ¯è¡Œåªå£°æ˜ä¸€ä»¶äº‹é‡Œæƒ…å†µï¼Œå¿½ç•¥æ¢è¡Œï¼ŒæŠŠå†…å®¹å†™åœ¨ä¸€è¡Œé‡Œã€‚ å¦‚æœæ˜¯ç©ºçš„ block ï¼Œç›´æ¥å£°æ˜ä¸º { }ã€‚ å¦‚æœå³èŠ±æ‹¬å·ï¼ˆ } ï¼‰ç»“æŸäº†ä¸€ä¸ªå£°æ˜ï¼Œåé¢æ¥ä¸Šä¸€ä¸ªæ¢è¡Œã€‚æ¯”å¦‚å¦‚æœå³èŠ±æ‹¬å·åé¢è·Ÿçš„æ˜¯ else ï¼Œé‚£ä¹ˆåé¢å°±ä¸ä¼šè·Ÿæ¢è¡Œï¼Œè€Œä¼šå†™æˆè¿™æ · } else { è¡”æ¥ã€‚ æ¯è¡Œåªå£°æ˜ä¸€ä»¶äº‹ æ¯è¡Œæœ€å¤šåªå£°æ˜ä¸€ä»¶äº‹ï¼Œæ¯è¡Œç»“å°¾ç”¨æ¢è¡Œåˆ†éš”ã€‚é™¤éç»“å°¾è·Ÿçš„æ˜¯ä¸€ä¸ªæ€»å…±åªæœ‰ä¸€è¡Œå£°æ˜çš„é—­åŒ…ã€‚ âœ… guard let value = value else { return 0 } defer { file.close() } switch someEnum { case .first: return 5 case .second: return 10 case .third: return 20 } let squares = numbers.map { $0 * $0 } var someProperty: Int { get { return otherObject.property } set { otherObject.property = newValue } } var someProperty: Int { return otherObject.somethingElse() } required init?(coder aDecoder: NSCoder) { fatalError(\"no coder\") } å¦‚æœé—­åŒ…æ˜¯æå‰è¿”å›ä¸€ä¸ªå€¼ï¼Œå†™åœ¨ä¸€è¡Œé‡Œå¯è¯»æ€§å°±ä¼šå¥½ä¸€äº›ã€‚å¦‚æœæ˜¯ä¸€ä¸ªæ­£å¸¸çš„æ“ä½œï¼Œå¯ä»¥è§†æƒ…å†µæ˜¯å¦å†™åœ¨ä¸€è¡Œé‡Œã€‚å› ä¸ºæœªæ¥ä¹Ÿæœ‰å¯èƒ½é‡Œé¢å†å¢åŠ ä»£ç çš„æ“ä½œã€‚ ä»£ç æ¢è¡Œ ä»£ç ä¸­çš„ç©ºæ ¼ é™¤äº†è¯­è¨€æˆ–è€…å…¶ä»–æ ·å¼çš„è¦æ±‚ï¼Œæ–‡å­—å’Œæ³¨é‡Šä¹‹å¤–ï¼Œä¸€ä¸ªUnicodeç©ºæ ¼ä¹Ÿåªå‡ºç°åœ¨ä»¥ä¸‹åœ°æ–¹: æ¡ä»¶å…³é”®å­—åé¢å’Œè·Ÿç€çš„æ‹¬å· âœ… if (x == 0 && y == 0) || z == 0 { // ... } âŒ if(x == 0 && y == 0) || z == 0 { // ... } å¦‚æœé—­åŒ…ä¸­çš„ä»£ç åœ¨åŒä¸€è¡Œï¼Œå·¦èŠ±æ‹¬å·çš„å‰é¢ã€åé¢ï¼Œå³èŠ±æ‹¬å·çš„å‰é¢æœ‰ç©ºæ ¼ âœ… let nonNegativeCubes = numbers.map { $0 * $0 * $0 }.filter { $0 >= 0 } âŒ let nonNegativeCubes = numbers.map { $0 * $0 * $0 } .filter { $0 >= 0 } âŒ let nonNegativeCubes = numbers.map{$0 * $0 * $0}.filter{$0 >= 0} åœ¨ä»»ä½•äºŒå…ƒæˆ–ä¸‰å…ƒè¿ç®—ç¬¦çš„ä¸¤è¾¹ è¿˜æœ‰ä»¥ä¸‹çš„æƒ…å†µï¼š ä½¿ç”¨äºèµ‹å€¼ï¼Œåˆå§‹åŒ–å˜é‡ã€å±æ€§ï¼Œé»˜è®¤å‚æ•°çš„ç­‰å·ä¸¤è¾¹ã€‚ âœ… var x = 5 func sum(_ numbers: [Int], initialValue: Int = 0) { // ... } âŒ var x=5 func sum(_ numbers: [Int], initialValue: Int=0) { // ... } è¡¨ç¤ºåœ¨åè®®ä¸­è¡¨ç¤ºåˆæˆç±»å‹çš„ & ä¸¤è¾¹ã€‚ âœ… func sayHappyBirthday(to person: NameProviding & AgeProviding) { // ... } âŒ func sayHappyBirthday(to person: NameProviding&AgeProviding) { // ... } è‡ªå®šä¹‰è¿ç®—ç¬¦çš„ä¸¤è¾¹ã€‚ âœ… static func == (lhs: MyType, rhs: MyType) -> Bool { // ... } âŒ static func ==(lhs: MyType, rhs: MyType) -> Bool { // ... } è¡¨ç¤ºè¿”å›å€¼çš„ -> ä¸¤è¾¹ã€‚ âœ… func sum(_ numbers: [Int]) -> Int { // ... } âŒ func sum(_ numbers: [Int])->Int { // ... } ä¾‹å¤–ï¼šè¡¨ç¤ºå¼•ç”¨å€¼ã€æˆå‘˜çš„ç‚¹ä¸¤è¾¹æ²¡æœ‰ç©ºæ ¼ã€‚ âœ… let width = view.bounds.width âŒ let width = view . bounds . width ä¾‹å¤–ï¼šè¡¨ç¤ºåŒºåŸŸèŒƒå›´çš„ .. âœ… for number in 1...5 { // ... } âŒ let substring = string[index.. å‚æ•°åˆ—è¡¨ã€æ•°ç»„ã€tupleã€å­—å…¸é‡Œçš„é€—å·åé¢æœ‰ä¸€ä¸ªç©ºæ ¼ âœ… let numbers = [1, 2, 3] âŒ let numbers = [1,2,3] let numbers = [1 ,2 ,3] let numbers = [1 , 2 , 3] å†’å·çš„åé¢æœ‰ä¸€ä¸ªç©ºæ ¼ âœ… // ç±»å‹å£°æ˜ struct HashTable: Collection { // ... } struct AnyEquatable: Equatable { // ... } // å‚æ•°æ ‡ç­¾ let tuple: (x: Int, y: Int) func sum(_ numbers: [Int]) { // ... } // å˜é‡å£°æ˜ let number: Int = 5 // å­—å…¸å£°æ˜ var nameAgeMap: [String: Int] = [] // å­—å…¸å­—é¢é‡ let nameAgeMap = [\"Ed\": 40, \"Timmy\": 9] ä»£ç åçš„æ³¨é‡Šç¬¦å· // ä¸ä»£ç æœ‰ä¸¤ä¸ªç©ºæ ¼è·ç¦» âœ… let initialFactor = 2 // Warm up the modulator. âŒ let initialFactor = 2 // Warm up the modulator. è¡¨ç¤ºå­—å…¸ã€æ•°ç»„å­—é¢é‡çš„ä¸­æ‹¬å·å¤–é¢æœ‰ä¸€ä¸ªç©ºæ ¼ âœ… let numbers = [1, 2, 3] âŒ let numbers = [ 1, 2, 3 ] ç¦æ­¢å˜é‡ã€å±æ€§æ°´å¹³å¯¹é½ æ°´å¹³å¯¹é½æ˜¯æ˜ç¡®ç¦æ­¢çš„ï¼Œé™¤éæ˜¯åœ¨å†™æ˜æ˜¾çš„è¡¨æ ¼æ•°æ®æ—¶ï¼Œçœç•¥å¯¹é½ä¼šæŸå®³å¯è¯»æ€§ã€‚å¼•å…¥æ°´å¹³å¯¹é½åï¼Œå¦‚æœæ·»åŠ ä¸€ä¸ªæ–°çš„æˆå‘˜å¯èƒ½ä¼šéœ€è¦å…¶ä»–æˆå‘˜å†å¯¹é½ä¸€æ¬¡ï¼Œè¿™ç»™ç»´æŠ¤å¢åŠ äº†è´Ÿæ‹…ã€‚ âœ… struct DataPoint { var value: Int var primaryColor: UIColor } âŒ struct DataPoint { var value: Int var primaryColor: UIColor } ç©ºè¡Œé€»è¾‘ åœ¨ç»„ç»‡ä»£ç é€»è¾‘å…³ç³»æ—¶ï¼Œå¯ä»¥ç”¨ç©ºè¡Œéš”å¼€è¿›è¡Œåˆ†ç»„ã€‚ å‡½æ•°ç»“å°¾ä¸ç©ºè¡Œ å‡½æ•°å†…ä½œç”¨ä¸åŒä»£ç å—ç©ºä¸€è¡Œ è§„èŒƒé‡Œå…¶ä»–åœ°æ–¹è¦æ±‚æœ‰ç©ºè¡Œçš„åœ°æ–¹ã€‚ æ‹¬å· æœ€é¡¶çº§çš„ ifã€guardã€whileã€switch çš„æ¡ä»¶ä¸ä½¿ç”¨æ‹¬å·ã€‚ âœ… if x == 0 { print(\"x is zero\") } if (x == 0 || y == 1) && z == 2 { print(\"...\") } âŒ if (x == 0) { print(\"x is zero\") } if ((x == 0 || y == 1) && z == 2) { print(\"...\") } åœ¨æœ‰å¤æ‚çš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œåªæœ‰ä½œè€…å’Œ review çš„äººåŒæ—¶è®¤ä¸ºçœç•¥æ‹¬å·ä¸ä¼šå½±å“ä»£ç çš„å¯è¯»æ€§æ‰ä¼šçœç•¥ã€‚ä¸èƒ½å‡è®¾æ¯ä¸ªè¯»è€…éƒ½å®Œå…¨äº†è§£å¯¹ swift çš„è¿ç®—ç¬¦ä¼˜å…ˆçº§ï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µä¸‹çš„æ‹¬å·æç¤ºç”¨æˆ·çš„è®¡ç®—ä¼˜å…ˆçº§æ˜¯åˆç†çš„ã€‚ é›†åˆå¤„ç† ä¸è¦åœ¨ forin å¾ªç¯é‡Œè¿›è¡Œå…ƒç´ çš„ remove/add æ“ä½œã€‚ âŒ var someInts:[Int] = [10, 20, 30] for index in someInts { someInts.insert(44 + index, at: index) } å¹¶å‘å¤„ç† è·å–å•ä¾‹å¯¹è±¡éœ€è¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå…¶ä¸­çš„æ–¹æ³•ä¹Ÿè¦ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚ åˆ›å»ºçº¿ç¨‹æˆ–çº¿ç¨‹æ± æ—¶è¯·æŒ‡å®šæœ‰æ„ä¹‰çš„çº¿ç¨‹åç§°ï¼Œæ–¹ä¾¿å‡ºé”™æ—¶å›æº¯ã€‚ æ¨è: dispatch_queue_t gwhUpdateQueue = dispatch_queue_create(\"\", DISPATCH_QUEUE_SERIAL); let queue = DispatchQueue(label: \"com.gwh.app.update\", attributes: .concurrent) é«˜å¹¶å‘æ—¶ï¼ŒåŒæ­¥è°ƒç”¨åº”è¯¥å»è€ƒé‡é”çš„æ€§èƒ½æŸè€—ã€‚èƒ½ç”¨æ— é”æ•°æ®ç»“æ„ï¼Œå°±ä¸è¦ç”¨é”;èƒ½é”åŒºå—ï¼Œå°±ä¸è¦é”æ•´ä¸ªæ–¹æ³•ä½“;èƒ½ç”¨å¯¹è±¡é”ï¼Œå°±ä¸è¦ç”¨ç±»é”ã€‚ å¯¹å¤šä¸ªèµ„æºã€æ•°æ®åº“è¡¨ã€å¯¹è±¡åŒæ—¶åŠ é”æ—¶ï¼Œéœ€è¦ä¿æŒä¸€è‡´çš„åŠ é”é¡ºåºï¼Œå¦åˆ™å¯èƒ½ä¼šé€ æˆæ­»é”ã€‚ å¹¶å‘ä¿®æ”¹åŒä¸€è®°å½•æ—¶ï¼Œé¿å…æ›´æ–°ä¸¢å¤±ï¼Œè¦ä¹ˆåœ¨åº”ç”¨å±‚åŠ é”ï¼Œè¦ä¹ˆåœ¨ç¼“å­˜åŠ é”ï¼Œè¦ä¹ˆåœ¨æ•°æ®åº“å±‚ä½¿ç”¨ä¹è§‚é”ï¼Œä½¿ç”¨ version ä½œä¸ºæ›´æ–°ä¾æ®ã€‚ æ§åˆ¶è¯­å¥ æå‰è¿”å›ä½¿ç”¨ guard âœ… func discombobulate(_ values: [Int]) throws -> Int { guard let first = values.first else { throw DiscombobulationError.arrayWasEmpty } guard first >= 0 else { throw DiscombobulationError.negativeEnergy } var result = 0 for value in values { result += invertedCombobulatoryFactory(of: value) } return result } âŒ func discombobulate(_ values: [Int]) throws -> Int { if let first = values.first { if first >= 0 { var result = 0 for value in values { result += invertedCombobulatoryFactor(of: value) } return result } else { throw DiscombobulationError.negativeEnergy } } else { throw DiscombobulationError.arrayWasEmpty } } for-where å¾ªç¯ å¦‚æœæ•´ä¸ª for å¾ªç¯åœ¨å‡½æ•°ä½“é¡¶éƒ¨åªæœ‰ä¸€ä¸ª if åˆ¤æ–­ï¼Œä½¿ç”¨ for where æ›¿æ¢ï¼š âœ… for item in collection where item.hasProperty { // ... } âŒ for item in collection { if item.hasProperty { // ... } } Switch ä¸­çš„ fallthrough Switch ä¸­å¦‚æœæœ‰å‡ ä¸ª case éƒ½å¯¹åº”ç›¸åŒçš„é€»è¾‘ï¼Œcase ä½¿ç”¨é€—å·è¿æ¥æ¡ä»¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ fallthroughï¼š âœ… switch value { case 1: print(\"one\") case 2...4: print(\"two to four\") case 5, 7: print(\"five or seven\") default: break } âŒ switch value { case 1: print(\"one\") case 2: fallthrough case 3: fallthrough case 4: print(\"two to four\") case 5: fallthrough case 7: print(\"five or seven\") default: break } æ¢å¥è¯è¯´ï¼Œä¸å­˜åœ¨ case ä¸­åªæœ‰ fallthrough çš„æƒ…å†µã€‚å¦‚æœ case ä¸­æœ‰è‡ªå·±çš„ä»£ç é€»è¾‘å† fallthrough æ˜¯åˆç†çš„ã€‚ æ³¨é‡Šè§„çº¦ æ‰€ä½¿ç”¨çš„ä»»ä½•æ³¨é‡Šå¿…é¡»ä¿æŒæœ€æ–°å¦åˆ™åˆ é™¤æ‰ã€‚ä»£ç ä¿®æ”¹çš„åŒæ—¶ï¼Œæ³¨é‡Šä¹Ÿè¦è¿›è¡Œç›¸åº”çš„ä¿®æ”¹ï¼Œå°¤å…¶æ˜¯å‚æ•°ã€è¿”å›å€¼ã€å¼‚å¸¸ã€æ ¸å¿ƒé€»è¾‘ç­‰çš„ä¿®æ”¹ã€‚ ç±»ã€ç±»å±æ€§ã€ç±»æ–¹æ³•çš„æ³¨é‡Šå¿…é¡»ä½¿ç”¨ appledoc è§„èŒƒï¼Œä½¿ç”¨/*å†…å®¹/æ ¼å¼ã€‚option+command+/ã€‚å¯¹äºæ³¨é‡Šçš„è¦æ±‚:ç¬¬ä¸€ã€èƒ½å¤Ÿå‡†ç¡®ååº”è®¾è®¡æ€æƒ³å’Œä»£ç é€»è¾‘;ç¬¬äºŒã€èƒ½å¤Ÿæè¿°ä¸šåŠ¡å«ä¹‰ï¼Œä½¿åˆ«çš„ç¨‹åºå‘˜èƒ½å¤Ÿè¿…é€Ÿäº†è§£åˆ°ä»£ç èƒŒåçš„ä¿¡æ¯ã€‚å®Œå…¨æ²¡æœ‰æ³¨é‡Šçš„å¤§æ®µä»£ç å¯¹äºé˜…è¯»è€…å½¢åŒå¤©ä¹¦ï¼Œæ³¨é‡Šæ˜¯ç»™è‡ªå·±çœ‹çš„ï¼Œå³ä½¿éš”å¾ˆé•¿æ—¶é—´ï¼Œä¹Ÿèƒ½æ¸…æ™°ç†è§£å½“æ—¶çš„æ€è·¯;æ³¨é‡Šä¹Ÿæ˜¯ç»™ç»§ä»»è€…çœ‹çš„ï¼Œä½¿å…¶èƒ½å¤Ÿå¿«é€Ÿæ¥æ›¿è‡ªå·±çš„å·¥ä½œã€‚ å¥½çš„å‘½åã€ä»£ç ç»“æ„æ˜¯è‡ªè§£é‡Šçš„ï¼Œæ³¨é‡ŠåŠ›æ±‚ç²¾ç®€å‡†ç¡®ã€è¡¨è¾¾åˆ°ä½ã€‚é¿å…å‡ºç°æ³¨é‡Šçš„ä¸€ä¸ªæç«¯:è¿‡å¤šè¿‡æ»¥çš„æ³¨é‡Šï¼Œä»£ç çš„é€»è¾‘ä¸€æ—¦ä¿®æ”¹ï¼Œä¿®æ”¹æ³¨é‡Šæ˜¯ç›¸å½“å¤§çš„è´Ÿæ‹…ã€‚ è¡¥å……è§„èŒƒ ä»£ç è­¦å‘Šâš ï¸åº”è¯¥å°½å¯èƒ½å»é™¤ã€‚é™¤éæ˜ç¡®ä¸ºäº†æé†’ä½œç”¨ã€‚ å°ä»£ç å— ä¿è¯é€»è¾‘çš„å®Œæ•´ä¸è¿è´¯æ€§ ä½¿ç”¨ä¾¿äºç†è§£çš„API æ— ç”¨æ³¨é‡Šä¸ä»£ç çš„åˆ é™¤å°½é‡åˆ é™¤ä¾¿äºç†è§£ ä¼˜å…ˆä½¿ç”¨å·¥å…·ç±»æ–¹æ³• æœåŠ¡å™¨å®šä¹‰çš„å­—æ®µä¸ºå¤§å†™ï¼Œå®¢æˆ·ç«¯model ä¹Ÿåº”è¯¥ä½¿ç”¨å°å†™ å®ç°é€»è¾‘å°½é‡æ‰ç”¨æ™®éå¥½ç†è§£çš„æ–¹æ³• importå¤´æ–‡ä»¶çš„æ’ç‰ˆ, å½“importè¶…è¿‡7ä¸ª âœ… #import \"GWHProductViewController.h\" //model #import \"GWHProductModel.h\" #import \"GWHCarModel.h\" #import \"GWHCommunityModel.h\" //view #import \"GWHProducPackageView.h\" #import \"GWHCarCell.h\" #import \"GWHCommunityCell.h\" //tool #import #import \"MJRefresh.h\" #import \"NSDateFormatter+Utility.h\" #import \"Masonry.h\" #import \"HttpUtils+GWHNetTool.h\" #import \"GWHUserManager.h\" //viewController #import \"GWHServiceProductRecViewController.h\" #import \"GWHPageController.h\" âŒ #import \"GWHProductViewController.h\" #import \"GWHProductModel.h\" #import \"GWHCarCell.h\" #import \"GWHCommunityCell.h\" #import #import \"MJRefresh.h\" #import \"NSDateFormatter+Utility.h\" #import \"HttpUtils+GWHNetTool.h\" #import \"GWHUserManager.h\" #import \"GWHServiceProductRecViewController.h\" #import \"GWHCarModel.h\" #import \"GWHCommunityModel.h\" #import \"GWHProducPackageView.h\" #import \"Masonry.h\" #import \"GWHPageController.h\" ä»£ç æäº¤é€»è¾‘ æäº¤ commit çš„ç±»å‹ feat: å…¶ä»– fix: ä¿®å¤bug ç›®å‰é™¤äº†fixéœ€è¦é™„å¸¦bugç¼–å·, åˆ«çš„ç»Ÿä¸€ç”¨feat. "},"pages/å…¶ä»–/WebViewä¸iOSåŸç”Ÿçš„äº¤äº’.html":{"url":"pages/å…¶ä»–/WebViewä¸iOSåŸç”Ÿçš„äº¤äº’.html","title":"WebViewä¸iOSåŸç”Ÿçš„äº¤äº’","keywords":"","body":"1.WebViewä¸iOSåŸç”Ÿçš„äº¤äº’ ä¸€ã€WKWebViewçš„ä»£ç†æ–¹æ³• 1.1 WKNavigationDelegate è¯¥ä»£ç†æä¾›çš„æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥è¿½è¸ªåŠ è½½è¿‡ç¨‹ï¼ˆé¡µé¢å¼€å§‹åŠ è½½ã€åŠ è½½å®Œæˆã€åŠ è½½å¤±è´¥ï¼‰ã€å†³å®šæ˜¯å¦æ‰§è¡Œè·³è½¬ã€‚ // é¡µé¢å¼€å§‹åŠ è½½æ—¶è°ƒç”¨ optional func webView(_ webView: WKWebView, didStartProvisionalNavigation navigation: WKNavigation!) // å½“å†…å®¹å¼€å§‹è¿”å›æ—¶è°ƒç”¨ optional func webView(_ webView: WKWebView, didCommit navigation: WKNavigation!) // é¡µé¢åŠ è½½å®Œæˆä¹‹åè°ƒç”¨ optional func webView(_ webView: WKWebView, didFinish navigation: WKNavigation!) // é¡µé¢åŠ è½½å¤±è´¥æ—¶è°ƒç”¨ optional func webView(_ webView: WKWebView, didFailProvisionalNavigation navigation: WKNavigation!, withError error: Error) é¡µé¢è·³è½¬çš„ä»£ç†æ–¹æ³•æœ‰ä¸‰ç§ï¼Œåˆ†ä¸ºï¼ˆæ”¶åˆ°è·³è½¬ä¸å†³å®šæ˜¯å¦è·³è½¬ä¸¤ç§ï¼‰ï¼š // æ¥æ”¶åˆ°æœåŠ¡å™¨è·³è½¬è¯·æ±‚ä¹‹åè°ƒç”¨ optional func webView(_ webView: WKWebView, didReceiveServerRedirectForProvisionalNavigation navigation: WKNavigation!) // åœ¨æ”¶åˆ°å“åº”åï¼Œå†³å®šæ˜¯å¦è·³è½¬ optional func webView(_ webView: WKWebView, decidePolicyFor navigationResponse: WKNavigationResponse, decisionHandler: @escaping (WKNavigationResponsePolicy) -> Void) // åœ¨å‘é€è¯·æ±‚ä¹‹å‰ï¼Œå†³å®šæ˜¯å¦è·³è½¬ optional func webView(_ webView: WKWebView, decidePolicyFor navigationAction: WKNavigationAction, decisionHandler: @escaping (WKNavigationActionPolicy) -> Void) 1.2 WKUIDelegate optional func webView(_ webView: WKWebView, createWebViewWith configuration: WKWebViewConfiguration, for navigationAction: WKNavigationAction, windowFeatures: WKWindowFeatures) -> WKWebView? ä¸‹é¢ä»£ç†æ–¹æ³•å…¨éƒ½æ˜¯ä¸ç•Œé¢å¼¹å‡ºæç¤ºæ¡†ç›¸å…³çš„ï¼Œé’ˆå¯¹äºwebç•Œé¢çš„ä¸‰ç§æç¤ºæ¡†ï¼ˆè­¦å‘Šæ¡†ã€ç¡®è®¤æ¡†ã€è¾“å…¥æ¡†ï¼‰åˆ†åˆ«å¯¹åº”ä¸‰ç§ä»£ç†æ–¹æ³•ã€‚ä¸‹é¢åªåˆ—ä¸¾äº†è­¦å‘Šæ¡†çš„æ–¹æ³•ã€‚ optional func webView(_ webView: WKWebView, runJavaScriptAlertPanelWithMessage message: String, initiatedByFrame frame: WKFrameInfo, completionHandler: @escaping () -> Void) 1.3 WKScriptMessageHandler WKScriptMessageHandlerå…¶å®å°±æ˜¯ä¸€ä¸ªéµå¾ªçš„åè®®ï¼Œå®ƒèƒ½è®©ç½‘é¡µé€šè¿‡JSæŠŠæ¶ˆæ¯å‘é€ç»™OCã€‚å…¶ä¸­åè®®æ–¹æ³•ã€‚ // ä»webç•Œé¢ä¸­æ¥æ”¶åˆ°ä¸€ä¸ªè„šæœ¬æ—¶è°ƒç”¨ func userContentController(_ userContentController: WKUserContentController, didReceive message: WKScriptMessage) ä»åè®®ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™é‡Œä½¿ç”¨äº†ä¸¤ä¸ªç±»WKUserContentControllerå’ŒWKScriptMessageã€‚WKUserContentControllerå¯ä»¥ç†è§£ä¸ºè°ƒåº¦å™¨ï¼ŒWKScriptMessageåˆ™æ˜¯æºå¸¦çš„æ•°æ®ã€‚ 1.4 WKUserContentController WKUserContentControlleræœ‰ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼Œä¹Ÿæ˜¯å®ƒçš„æ ¸å¿ƒåŠŸèƒ½ã€‚ // jsæ³¨å…¥ï¼Œå³å‘ç½‘é¡µä¸­æ³¨å…¥æˆ‘ä»¬çš„jsæ–¹æ³•ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œå¼€å‘ä¸­è¦æ…ç”¨ã€‚ open func addUserScript(_ userScript: WKUserScript) // æ·»åŠ ä¾›jsè°ƒç”¨ocçš„æ¡¥æ¢ã€‚è¿™é‡Œçš„nameå¯¹åº”WKScriptMessageä¸­çš„nameï¼Œå¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬è®¤ä¸ºå®ƒå°±æ˜¯æ–¹æ³•åã€‚ open func add(_ scriptMessageHandler: WKScriptMessageHandler, name: String) 1.5 WKScriptMessage WKScriptMessageå°±æ˜¯jsé€šçŸ¥ocçš„æ•°æ®ã€‚å…¶ä¸­æœ‰ä¸¤ä¸ªæ ¸å¿ƒå±æ€§ç”¨çš„å¾ˆå¤šã€‚ open var name: String { get } å¯¹åº”func add(_ scriptMessageHandler: WKScriptMessageHandler, name: String)æ·»åŠ çš„nameã€‚ open var body: Any { get } æºå¸¦çš„æ ¸å¿ƒæ•°æ®ã€‚jsè°ƒç”¨æ—¶åªéœ€window.webkit.messageHandlers.#name#.postMessage() è¿™é‡Œçš„nameå°±æ˜¯æˆ‘ä»¬æ·»åŠ çš„nameï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å¾ˆçˆ½ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥å…·ä½“å®ç°ã€‚ äºŒã€è‡ªå®šä¹‰CQWebView class CQWebView: UIView { // å¢åŠ webViewå±æ€§ private lazy var webView: WKWebView = { let conf = WKWebViewConfiguration() conf.preferences.javaScriptEnabled = true conf.selectionGranularity = WKSelectionGranularity.character conf.allowsInlineMediaPlayback = true let webView = WKWebView(frame: .zero, configuration: conf) ... return webView }() } 2.1 å¢åŠ js/ocäº¤äº’æ–¹æ³• class CQWebView: UIView { ... // å¢åŠ jsæ¶ˆæ¯ç›‘å¬ func adddScriptMessageHandler(forName name: String) { webView.configuration.userContentController.add(self, name: name) } // ç§»é™¤jsæ¶ˆæ¯ç›‘å¬ func removeScriptMessageHandler(forName name: String) { webView.configuration.userContentController.removeScriptMessageHandler(forName: name) } // ocæ‰§è¡Œjs func evaluateJavaScript(_ javaScriptString: String, completionHandler: ((Any?, Error?) -> Void)? = nil) { webView.evaluateJavaScript(javaScriptString, completionHandler: completionHandler) } } 2.2 å¢åŠ ä»£ç†å±æ€§ // WebViewä»£ç† @objc protocol CQWebViewDelegate { // æ¥æ”¶ js å‘æ¥çš„æ¶ˆæ¯ @objc optional func webView(_ webView: CQWebView, didReceiveMessage name: String, body: Any) } class CQWebView: UIView { ... weak var delegate: CQWebViewDelegate? } 2.3 å®ç°WKScriptMessageHandler // js å’Œ swift çš„äº¤äº’ extension CQWebView: WKScriptMessageHandler { // æ¥æ”¶ js å‘æ¥çš„æ¶ˆæ¯ func userContentController(_ userContentController: WKUserContentController, didReceive message: WKScriptMessage) { delegate?.webView?(self, didReceiveMessage: message.name, body: message.body) } } ä¸‰ã€JSè°ƒç”¨Swift 2.1 å®Œæ•´html Untitled Document jsè°ƒç”¨swift // jsè°ƒç”¨swift function jsCallSwift(obj) { // å‘ swift å‘é€æ•°æ®ï¼Œè¿™é‡Œçš„â€˜msgBridgeâ€™å°±æ˜¯ swift ä¸­æ·»åŠ çš„æ¶ˆæ¯é€šé“çš„ name window.webkit.messageHandlers.msgBridge.postMessage(obj); } // swiftè°ƒç”¨js function swiftCallJs(msg){ document.getElementById('h').innerText+=msg; } 3.2 å¢åŠ å¯¹jsæ¶ˆæ¯çš„ç›‘å¬ åªéœ€è¦è°ƒç”¨CQWebViewçš„adddScriptMessageHandleræ–¹æ³•ã€‚ class ViewController: UIViewController { // MARK: - Properties private lazy var webView: CQWebView = { let webView = CQWebView(frame: .zero) webView.delegate = self webView.adddScriptMessageHandler(forName: \"msgBridge\") ... return webView }() } 3.2 å®ç°å¯¹jsæ¶ˆæ¯çš„å¤„ç† extension ViewController: CQWebViewDelegate { func webView(_ webView: CQWebView, didReceiveMessage name: String, body: Any) { switch name { case \"msgBridge\": ... break default: break } } } å››ã€Swiftè°ƒç”¨JS 4.1 evaluateJavaScriptæ–¹æ³•ä½¿ç”¨ åœ¨htmlçš„jsä¸­å·²ç»å®šä¹‰äº†swiftCallJsæ–¹æ³•ç­‰å¾…è°ƒç”¨ï¼Œåªéœ€è¦è°ƒç”¨CQWebViewçš„evaluateJavaScriptæ–¹æ³•å³å¯ã€‚ //swift è°ƒ jså‡½æ•° webView.evaluateJavaScript(\"swiftCallJs('\\( dic[\"msg\"] as! String)')\", completionHandler: { (any, error) in if (error != nil) { print(error ?? \"err\") } }) 4.2 WKWebViewåŠ è½½JS NSString *js = @\"\"; // æ ¹æ®JSå­—ç¬¦ä¸²åˆå§‹åŒ–WKUserScriptå¯¹è±¡ WKUserScript *script = [[WKUserScript alloc] initWithSource:js injectionTime:WKUserScriptInjectionTimeAtDocumentEnd forMainFrameOnly:YES]; // æ ¹æ®ç”Ÿæˆçš„WKUserScriptå¯¹è±¡ï¼Œåˆå§‹åŒ–WKWebViewConfiguration WKWebViewConfiguration *config = [[WKWebViewConfiguration alloc] init]; [config.userContentController addUserScript:script]; å‚è€ƒæ–‡ç«  æºç  Safariè°ƒè¯•iOSä¸­çš„JS iOS WKWebView åŠ è½½æœ¬åœ°htmlæ–‡ä»¶ï¼ˆswiftï¼‰ å­¦ä¹ -WebKit(WKScriptMessageHandler) iOSä¸‹OCä¸JSçš„äº¤äº’(WKWebview-MessageHandlerå®ç°) è‡ªå·±åŠ¨æ‰‹æ‰“é€ åŸºäº WKWebView çš„æ··åˆå¼€å‘æ¡†æ¶ï¼ˆäºŒï¼‰â€”â€”js å‘ Native ä¸€å¥è¯ä¼ å€¼å¹¶åå°„å‡º Swift å¯¹è±¡æ‰§è¡ŒæŒ‡å®šå‡½æ•° WkWebKit - javascript on loaded page finds window.webkit is undefined WKWebviewä½¿ç”¨äºŒä¸‰äº‹ "},"pages/å…¶ä»–/ç†è§£MVVMæ¶æ„æ¨¡å¼.html":{"url":"pages/å…¶ä»–/ç†è§£MVVMæ¶æ„æ¨¡å¼.html","title":"ç†è§£MVVMæ¶æ„æ¨¡å¼","keywords":"","body":"ç†è§£MVVMæ¶æ„æ¨¡å¼ åç»­è¡¥å……è‡ªå·±çš„ç†è§£ä¸å®æˆ˜ å‚è€ƒæ–‡ç«  iOS å…³äºMVCå’ŒMVVMè®¾è®¡æ¨¡å¼çš„é‚£äº›äº‹ iOS å…³äºMVVM Without ReactiveCocoaè®¾è®¡æ¨¡å¼çš„é‚£äº›äº‹ iOS å…³äºMVVM With ReactiveCocoaè®¾è®¡æ¨¡å¼çš„é‚£äº›äº‹ iOS æ­å»ºAppæ¡†æ¶ï¼ˆMVVM+RAC+è·¯ç”±ï¼‰ è¯´è¯´MVVM "},"pages/å…¶ä»–/Swiftåˆ¤æ–­åˆ˜æµ·å±å¹•.html":{"url":"pages/å…¶ä»–/Swiftåˆ¤æ–­åˆ˜æµ·å±å¹•.html","title":"Swiftåˆ¤æ–­åˆ˜æµ·å±å¹•","keywords":"","body":"Swiftåˆ¤æ–­åˆ˜æµ·å±å¹• ç›´æ¥ä¸Šä»£ç  static var isFullScreen: Bool { if #available(iOS 11, *) { guard let w = UIApplication.shared.delegate?.window, let unwrapedWindow = w else { return false } if unwrapedWindow.safeAreaInsets.left > 0 || unwrapedWindow.safeAreaInsets.bottom > 0 { print(unwrapedWindow.safeAreaInsets) return true } } return false } é¦–å…ˆ,åˆ˜æµ·å±åœ¨iOS 11ä¹‹åæ‰æ¨å‡º,è€Œé‡ä¸­ä¹‹é‡çš„æ˜¯safeAreaInsetså±æ€§ ä»¥ä¸‹åˆ†åˆ«æ˜¯ç«–å±ä¸æ¨ªå±çš„æ—¶å€™,safeAreaInsetsæ‰“å°çš„å€¼ UIEdgeInsets(top: 44.0, left: 0.0, bottom: 34.0, right: 0.0) UIEdgeInsets(top: 0.0, left: 44.0, bottom: 21.0, right: 44.0) å…¶å®å•å•åˆ¤æ–­bottom > 0 è¿™ä¸ªå±æ€§å°±å®Œå…¨å¯ä»¥è§£å†³é—®é¢˜äº† static var kNavigationBarHeight: CGFloat { //return UIApplication.shared.statusBarFrame.height == 44 ? 88 : 64 return isFullScreen ? 88 : 64 } static var kBottomSafeHeight: CGFloat { //return UIApplication.shared.statusBarFrame.height == 44 ? 34 : 0 return isFullScreen ? 34 : 0 } å½“ç„¶å¦‚æœåªæ˜¯æƒ³ç®€å•é€‚é… ç‰¹åˆ«æ˜¯ç«–å±çš„è¯ ä¸‹é¢è¿™æ®µä»£ç å…¶å®å°±èƒ½è§£å†³å¾ˆå¤šé—®é¢˜ UIApplication.shared.statusBarFrame.height == 44 "},"pages/å…¶ä»–/å®¢æˆ·ç«¯ç½‘ç»œé€»è¾‘æ•´ç†åŠå»ºè®®.html":{"url":"pages/å…¶ä»–/å®¢æˆ·ç«¯ç½‘ç»œé€»è¾‘æ•´ç†åŠå»ºè®®.html","title":"å®¢æˆ·ç«¯ç½‘ç»œé€»è¾‘æ•´ç†åŠå»ºè®®","keywords":"","body":"å®¢æˆ·ç«¯ç½‘ç»œé€»è¾‘æ•´ç†åŠå»ºè®® ç¬¬ä¸€æ¬¡è¿›å…¥é¡µé¢æ˜¾ç¤ºå ä½ ä¸‹é¢æ˜¯å·²æœ‰é€»è¾‘ï¼Œä»¥åä¿æŒç›®å‰é€»è¾‘ï¼Œç»Ÿä¸€å¤„ç†ã€‚ æ— ç½‘ç»œï¼ˆæ²¡æœ‰Wifiï¼Œæ²¡æœ‰4Gï¼‰ï¼ŒæœŸæœ›æç¤ºè¯­ï¼šNo networkã€‚ æœåŠ¡ç«¯æŠ¥é”™ï¼ŒæœŸæœ›æç¤ºè¯­ï¼šLoading failedã€‚ æœåŠ¡ç«¯è¿”å›ç©ºï¼ŒæœŸæœ›æç¤ºè¯­ï¼šNo dataã€‚ ç¬¬ä¸€æ¬¡è¿›å…¥é¡µé¢loadingæ˜¾ç¤º loadingæ˜¾ç¤ºåœºæ™¯ä¸æ˜ç¡®ï¼Œå¯¼è‡´å¼€å‘è‡ªå·±æƒ³è±¡ï¼Œæ¯”å¦‚è¿›å…¥â€œæ¶ˆæ¯ä¸­å¿ƒâ€æœ‰loadingï¼Œè¿›å…¥â€œé¦–é¡µâ€æ²¡æœ‰ã€‚ loadingæ ·å¼æ ¹æ®åœºæ™¯åšä¸åŒçš„åŒºåˆ«ï¼Œæ¯”å¦‚ç¬¬ä¸€æ¬¡è¿›å…¥é¡µé¢ä¸ç‚¹å‡»äº‹ä»¶çš„loadingå¯ä»¥æœ‰ä¸åŒçš„è§†è§‰æ•ˆæœã€‚ loadingå¼€å§‹æ˜¾ç¤ºä¸ç»“æŸçš„é€»è¾‘éœ€è¦æ˜ç¡®ï¼Œæ¯”å¦‚ä¸€ä¸ªé¡µé¢åŠ è½½æœ‰2ä¸ªè¯·æ±‚ï¼Œæ˜¯ç­‰ä¸€ä¸ªè¯·æ±‚å®Œæˆåæ¶ˆå¤±è¿˜æ˜¯ä¸¤ä¸ªéƒ½å®Œæˆåæ¶ˆå¤±ï¼Œæ¯”å¦‚ï¼šé¦–é¡µã€‚ ç‚¹å‡»äº‹ä»¶åŠåé¦ˆ æ˜ç¡®æ˜¯å¦éœ€è¦å¢åŠ loadingç­‰å¾…ï¼Œæ¯”å¦‚ç›®å‰é€»è¾‘ï¼šç‚¹èµä¸æ˜¾ç¤ºloadingï¼Œå‘å¸ƒåŠ¨æ€æ˜¾ç¤ºloadingã€‚ æ¶‰åŠç½‘ç»œè¯·æ±‚çš„ç‚¹å‡»ï¼Œåé¦ˆæç¤ºä¸æ˜ç¡®ï¼Œåº”è¯¥å¦‚ä½•æç¤ºï¼Œä¸ªäººè®¤ä¸ºå¦‚æœäº§å“æ²¡æœ‰å®šä¹‰ï¼Œå®¢æˆ·ç«¯ä¸åº”è¯¥å­˜åœ¨æç¤ºï¼Œå› ä¸ºå®¢æˆ·ç«¯ä¹Ÿä¸çŸ¥é“å¦‚ä½•æç¤ºã€‚ å…è®¸ç”¨æˆ·æœ€å¤§çš„ç­‰å¾…æ—¶é—´ä¸æ˜ç¡®ï¼Œç›®å‰å®¢æˆ·ç«¯ç»Ÿä¸€çš„è¶…æ—¶æ—¶é—´æ˜¯30sï¼Œæ˜¯å¦åˆç†ï¼Œæœ‰å¾…ç¡®å®šã€‚ ç»Ÿä¸€é”™è¯¯æç¤ºéœ€è¦æ˜ç¡®ï¼Œæ¯”å¦‚ï¼šç½‘ç»œè¶…æ—¶ï¼Œæ²¡æœ‰ç½‘ç»œï¼ŒæœåŠ¡ç«¯æŠ¥é”™ï¼Œæ ¹æ®ä¸åŒé”™è¯¯ç ç»™å‡ºæŒ‡å®šæç¤ºã€‚ é‡å¤ç‚¹å‡»å¤„ç†ï¼Œç”¨æˆ·å¯èƒ½é‡å¤å‘å‡ºå¤šä¸ªäº‹ä»¶åŠè¯·æ±‚ã€‚ ç½‘ç»œç›‘å¬å¤„ç† ç”¨æˆ·ç¬¬ä¸€æ¬¡è¿›å…¥é¡µé¢ï¼Œæ²¡æœ‰ç½‘ç»œï¼Œé¡µé¢æ˜¾ç¤ºäº†ç©ºå ä½ï¼Œæ˜¯å¦é€šè¿‡ç½‘ç»œç›‘å¬è‡ªåŠ¨é‡æ–°åŠ è½½æ•°æ®ã€‚ ç”¨æˆ·çœ‹è§†é¢‘çš„æ—¶å€™ï¼Œæ˜¯å¦æç¤ºç”¨æˆ·æ­£åœ¨ä½¿ç”¨4gã€‚ ä¸Šæ‹‰ä¸‹æ‹‰åˆ·æ–° å½“é¡µé¢å·²ç»æœ‰æ•°æ®çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™ä¸‹æ‹‰åˆ·æ–°ï¼ŒæœåŠ¡ç«¯æŠ¥é”™ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯æ˜¾ç¤ºç©ºè¿˜æ˜¯ç»§ç»­æ˜¾ç¤ºæ•°æ®ï¼Œæ˜¯å¦ç»™å‡ºé”™è¯¯æç¤ºã€‚ å½“é¡µé¢å·²ç»æœ‰æ•°æ®çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™ä¸Šæ‹‰åŠ è½½æ›´å¤šï¼ŒæœåŠ¡ç«¯æŠ¥é”™ï¼Œæ˜¯å¦ç»™å‡ºé”™è¯¯æç¤ºã€‚ Toasté‡å  å½“ç”¨ç‚¹å‡»äº†ä¸¤ä¸ªæœ‰æç¤ºçš„æŒ‰é’®ï¼Œå¯èƒ½å¯¼è‡´Toasté‡å ã€‚ Appå¼¹çª—æ˜¾ç¤ºé€»è¾‘å¤„ç†ï¼Œå½“Appé¦–é¡µå­˜åœ¨å¤šä¸ªçª—å£çš„æ—¶å€™ï¼Œé‚£ä¹ˆéœ€è¦å¤„ç†ã€‚ æ—¥å¿—å®Œå–„ ç¡®ä¿æ¯ä¸ªè¯·æ±‚éƒ½åœ¨æ§åˆ¶å°æœ‰æ—¥å¿—æ‰“å°ï¼Œç›®å‰æœ‰äº›ç½‘ç»œè¯·æ±‚æ²¡æœ‰ã€‚ è°ƒè¯•æ—¥å¿—å®Œå–„ï¼ŒGWLogå¢åŠ ä¸ŠæŠ¥æˆ–è€…æ”¯æŒæ²™ç›’ã€‚ "},"pages/å…¶ä»–/é—®é¢˜è®°å½•.html":{"url":"pages/å…¶ä»–/é—®é¢˜è®°å½•.html","title":"é—®é¢˜è®°å½•","keywords":"","body":"é—®é¢˜è®°å½• iOS 13.1.3ä¸‹ï¼Œä¿®å¤UITextViewå¯Œæ–‡æœ¬ç‚¹å‡»äº§ç”Ÿå¤šæ¬¡å›è°ƒ åˆ›å»ºå¯Œæ–‡æœ¬ // åˆ é™¤ let result = NSMutableAttributedString(string: \" \\(GWLocalized.delete)\") let range = NSRange(location: 0, length: result.string.count) result.addAttribute(NSAttributedString.Key.link, value: \"Delete://\", range: range) result.addAttribute(NSAttributedString.Key.font, value: UIFont(regularFontWithSize: level == 1 ? 16 : 14)!, range: range) textView?.tintColor = UIColor(hexString: \"#848484\") ç‚¹å‡»å¯Œæ–‡æœ¬ // ç‚¹å‡»äº‹ä»¶ func textView(_ textView: UITextView, shouldInteractWith URL: URL, in characterRange: NSRange, interaction: UITextItemInteraction) -> Bool { // fix:iphone 7 plus 13.1.3æ´»åŠ¨çš„è¯„è®ºï¼Œç‚¹å‡»åˆ é™¤ï¼Œå¼¹å‡ºä¸‰ä¸ªå…³é—­æ¡† var recognizedTapGesture = false for ges in textView.gestureRecognizers ?? [] { if let tapGes = ges as? UITapGestureRecognizer, tapGes.state == .ended { recognizedTapGesture = true } } if !recognizedTapGesture { return true } if URL.scheme == \"Delete\" { let commentId = reactor?.currentState.comment.commentId let level = reactor?.currentState.level reactor?.action.onNext(.deleteComment(commentId: commentId, level: level)) } return true } "},"pages/å…¶ä»–/å¼‚å¸¸å ä½å›¾çš„å°è£….html":{"url":"pages/å…¶ä»–/å¼‚å¸¸å ä½å›¾çš„å°è£….html","title":"å¼‚å¸¸å ä½å›¾çš„å°è£…","keywords":"","body":"è§£å†³é—®é¢˜ ç»Ÿä¸€çš„å¼‚å¸¸å ä½å¤„ç† ä»£ç å¤ç”¨æ€§ ä¸€ã€å ä½å›¾å°è£… import Foundation import GWI18n import MJRefresh extension UIView { private enum RuntimeKey { static let emptyView = UnsafeRawPointer(bitPattern: \"emptyView\".hashValue) } } public extension UIView { enum EmptyType { case custom(image: UIImage?, title: String?, top: CGFloat = 0) // è‡ªå®šä¹‰ case empty(Bool = true) // æ— æ•°æ® case netError // æ— ç½‘ç»œ case serverError // æœåŠ¡å™¨é”™è¯¯ } func showEmptyData(type: EmptyType = .empty(), reloadBlock: ((UIButton) -> Void)? = nil) { var emptyView: EmptyDataView! switch type { case let .empty(showReloadBt): emptyView = EmptyDataView(frame: CGRect(x: 0, y: 0, width: self.width, height: self.height)) emptyView.logo_ImgV.image = UIImage(inUtilCore: \"no_content\") emptyView.desc_Lb.text = GWI18n.R.string.localizable.base_date_empty() if !showReloadBt { emptyView.reload_Btn.isHidden = true } else { emptyView.reload_Btn.isHidden = false } case .netError: emptyView = EmptyDataView(frame: CGRect(x: 0, y: 0, width: self.width, height: self.height)) emptyView.logo_ImgV.image = UIImage(inUtilCore: \"no_network\") emptyView.desc_Lb.text = GWI18n.R.string.localizable.base_net_lost() case .serverError: emptyView = EmptyDataView(frame: CGRect(x: 0, y: 0, width: self.width, height: self.height)) emptyView.logo_ImgV.image = UIImage(inUtilCore: \"load_failure\") emptyView.desc_Lb.text = GWI18n.R.string.localizable.base_loading_failed() case let .custom(image, title, top): emptyView = EmptyDataView(frame: CGRect(x: 0, y: top, width: self.width, height: self.height - top)) emptyView.logo_ImgV.image = image emptyView.desc_Lb.text = title } emptyView.backgroundColor = .white emptyView.reload_block = reloadBlock emptyView.reload_Btn.setTitle(GWI18n.R.string.localizable.base_re_load(), for: .normal) if let scrollView = self as? UIScrollView { scrollView.mj_footer?.isHidden = true } self.emptyDataView = emptyView } func hideEmptyData() { if let scrollView = self as? UIScrollView { scrollView.mj_footer?.isHidden = false } self.emptyDataView = nil } private var emptyDataView: EmptyDataView? { set(newValue) { self.emptyDataView?.removeFromSuperview() objc_setAssociatedObject(self, RuntimeKey.emptyView!, newValue, .OBJC_ASSOCIATION_RETAIN_NONATOMIC) guard let newView = newValue else { return } self.addSubview(newView) self.bringSubviewToFront(newView) } get { return objc_getAssociatedObject(self, RuntimeKey.emptyView!) as? EmptyDataView } } } äºŒã€ä½¿ç”¨æ–¹æ³• /// è¯·æ±‚å¤±è´¥æ—¶æ˜¾ç¤ºé»˜è®¤å ä½å›¾ self.tableView.showEmptyData(type: .netError) { [weak self] _ in /// é‡æ–°è¯·æ±‚ DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + 1) { /// éšè—å ä½å›¾ self?.tableView.hideEmptyData() } } ä¸‰ã€ä½¿ç”¨æ–¹æ³•ï¼ˆæ–°å¢ï¼‰ åŸºäºGWNetworkçš„GWErroré‡æ„ï¼Œå½“ç½‘ç»œè¯·æ±‚æ—¶ï¼Œå¦‚æœæ²¡æœ‰ç½‘ç»œä¼šç«‹é©¬è¿”å›noNetworkçš„é”™è¯¯ï¼Œæ‰€æœ‰å¢åŠ ä¼ å…¥erroræ˜¾ç¤ºå¼‚å¸¸å ä½çš„æ–¹æ³•: // æ ¹æ®é”™è¯¯æ˜¾ç¤ºå ä½ func showEmptyData(error: Swift.Error, reloadBlock: ((UIButton) -> Void)? = nil) { if let gwError = error as? GWError { // æœåŠ¡å™¨æŠ¥é”™ var emptyType: UIView.EmptyType = .serverError switch gwError { case let .client(cError): // æ— ç½‘ç»œ if cError == .noNetwork { emptyType = .netError } break default: break } self.showEmptyData(type: emptyType, reloadBlock: reloadBlock) } else { self.showEmptyData(type: .serverError, reloadBlock: reloadBlock) } } å¦‚ä½•ä½¿ç”¨ï¼š }).catchError {[weak tableView, weak self] (error) -> Observable in GWSwiftSpinner.hide() tableView?.endLoadMore() GWToast(error.localizedDescription) // ç©ºè§†å›¾æ˜¾ç¤º tableView?.showEmptyData(error: error, reloadBlock: { (_) in self?.action.onNext(.setup(messageTypeId: messageTypeId, page: page, tableView: tableView)) }) return PublishSubject() } "},"pages/å…¶ä»–/RxSwiftçš„Timer.html":{"url":"pages/å…¶ä»–/RxSwiftçš„Timer.html","title":"RxSwiftçš„Timer","keywords":"","body":"RxSwiftçš„Timer // MARK: - æ¶ˆæ¯åŠŸèƒ½ private let queryUnreadMsgTimerStopped = BehaviorRelay(value: false) // å¼€å¯è®¡æ—¶å™¨ private func startQueryUnreadMsgTimer() { guard let reactor = self.reactor else { return } // å®šæ—¶è¯·æ±‚æœªè¯»æ¶ˆæ¯ queryUnreadMsgTimerStopped.accept(false) Observable.interval(DispatchTimeInterval.seconds(60), scheduler: MainScheduler.instance).startWith(0).takeWhile{_ in UserManager.isLogin }.map{_ in GWHHomeReactor.Action.queryUnreadCount }.takeUntil(queryUnreadMsgTimerStopped.asObservable().filter{ $0 }).bind(to: reactor.action).disposed(by: disposeBag) } // å…³é—­è®¡æ—¶å™¨ private func stopQueryUnreadMsgTimer() { queryUnreadMsgTimerStopped.accept(true) } "},"pages/å…¶ä»–/AppTimerçš„ä½¿ç”¨.html":{"url":"pages/å…¶ä»–/AppTimerçš„ä½¿ç”¨.html","title":"AppTimerçš„ä½¿ç”¨","keywords":"","body":"AppTimerçš„ä½¿ç”¨ æŠ€æœ¯ï¼šRxSwiftå®ç°Timerã€‚ åœºæ™¯ï¼šä¸ºäº†è§£å†³Appå¤šä¸ªç»„ä»¶ï¼ˆçˆ±è½¦ã€ç¤¾åŒºï¼‰åˆ†åˆ«ä½¿ç”¨Timerï¼Œé€ æˆèµ„æºæµªè´¹çš„é—®é¢˜ï¼Œåœ¨GWCommonComponentå†™äº†ä¸€ä¸ªAppTimerã€‚ åŠŸèƒ½ åœ¨Appå¯åŠ¨æ—¶è°ƒç”¨ï¼Œè·ŸéšAppç”Ÿå‘½å‘¨æœŸï¼Œç›®å‰ä¼šå‘å¸ƒ1s,10s,60sçš„é€šçŸ¥ã€‚ å½“Appè¿›å…¥åå°åœæ­¢è®¡æ—¶ï¼Œå½“Appå°†è¦è¿›å…¥å‰å°é‡æ–°å¼€å§‹è®¡æ—¶ã€‚ å¦‚ä½•ä½¿ç”¨ åŠ¡å¿…åœ¨æ¯ä¸ªå›½å®¶çš„å®¿ä¸»å·¥ç¨‹AppLaunchï¼ˆå£³å·¥ç¨‹è°ƒç”¨ï¼‰ã€‚ func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -> Bool { ...... window?.rootViewController = tabBarController window?.makeKeyAndVisible() AppTimer.shared.start() return true } æºç  import UIKit import RxSwift import GWUtilCore /** è·ŸéšAppç”Ÿå‘½å‘¨æœŸçš„Timer ä¸šåŠ¡ï¼šæ¶ˆæ¯ä¸­å¿ƒï¼Œçˆ±è½¦ */ public class AppTimer { public static let shared = AppTimer() private let timer = Observable.interval(.seconds(1), scheduler: MainScheduler.instance) private var disposable: Disposable? /// AppTimeråˆ°1sçš„åºåˆ— public let reach1sObservable = PublishSubject() /// AppTimeråˆ°10sçš„åºåˆ— public let reach10sObservable = PublishSubject() /// AppTimeråˆ°60sçš„åºåˆ— public let reach60sObservable = PublishSubject() init() { _ = NotificationCenter.default.rx.notification(UIApplication.willEnterForegroundNotification).subscribe(onNext: {[weak self] _ in GWLog(\"----- Appè¿›å…¥å‰å° ------\") self?.start() }) _ = NotificationCenter.default.rx.notification(UIApplication.didEnterBackgroundNotification).subscribe(onNext: {[weak self] _ in GWLog(\"----- Appè¿›å…¥åå° ------\") self?.stop() }) } /// å¼€å¯è®¡æ—¶å™¨ public func start() { stop() GWLog(\"----- å¼€å§‹AppTimerè®¢é˜… ------\") disposable = timer.subscribe(onNext: {[weak self] count in GWLog(\"----- å½“å‰æ—¶é—´\\(count+1)s ------\") // 1sé€šçŸ¥ NotificationCenter.default.post(name: NSNotification.Name.appTimerReach1s, object: nil) self?.reach1sObservable.onNext(()) // 10sé€šçŸ¥ if (count + 1) % 10 == 0 { NotificationCenter.default.post(name: NSNotification.Name.appTimerReach10s, object: nil) self?.reach10sObservable.onNext(()) } // 60sé€šçŸ¥ if (count + 1) % 60 == 0 { NotificationCenter.default.post(name: NSNotification.Name.appTimerReach60s, object: nil) self?.reach60sObservable.onNext(()) } }, onDisposed: { GWLog(\"----- é‡Šæ”¾AppTimerè®¢é˜… ------\") }) } /// åœæ­¢è®¡æ—¶å™¨ public func stop() { disposable?.dispose() } } "},"pages/å…¶ä»–/UIViewControllerçš„Rxæ‰©å±•.html":{"url":"pages/å…¶ä»–/UIViewControllerçš„Rxæ‰©å±•.html","title":"UIViewControllerçš„å¸¸ç”¨Rxæ‰©å±•","keywords":"","body":"UIViewControllerçš„å¸¸ç”¨Rxæ‰©å±• https://www.hangge.com/blog/cache/detail_1943.html "},"pages/å…¶ä»–/Info.plistå›½é™…åŒ–.html":{"url":"pages/å…¶ä»–/Info.plistå›½é™…åŒ–.html","title":"Info.plistå›½é™…åŒ–","keywords":"","body":"Info.plistå›½é™…åŒ– æ–°å»ºä¸€ä¸ªInfoPlist.stingsæ–‡ä»¶ï¼Œé…ç½®ä¸åŒçš„è¯­è¨€ã€‚ å¦‚ä½•æ–°å»º New File -> Resourceä¸‹çš„Strings Fileã€‚ å‚è€ƒé“¾æ¥ 3åˆ†é’Ÿå®ç°iOSè¯­è¨€æœ¬åœ°åŒ–/å›½é™…åŒ–ï¼ˆå›¾æ–‡è¯¦è§£ï¼‰ how to localise the ios-info-plist-file iOSè°ƒç”¨ç³»ç»Ÿç›¸å†Œ\\ç›¸æœº æ˜¾ç¤ºä¸­æ–‡æ ‡é¢˜ iOSè®¾ç½®é»˜è®¤è¯­è¨€ è§£å†³iOS9/10ç®€ä½“ä¸­æ–‡,InfoPlist.stringæƒé™æè¿°å›½é™…åŒ–æ˜¾ç¤ºé—®é¢˜ "},"pages/å…¶ä»–/ç»Ÿä¸€è®¾ç½®é¡µé¢titleå­—ä½“æ ·å¼.html":{"url":"pages/å…¶ä»–/ç»Ÿä¸€è®¾ç½®é¡µé¢titleå­—ä½“æ ·å¼.html","title":"ç»Ÿä¸€è®¾ç½®é¡µé¢titleå­—ä½“æ ·å¼","keywords":"","body":"ç»Ÿä¸€è®¾ç½®é¡µé¢titleå­—ä½“æ ·å¼ æ–¹æ¡ˆå®ç° ç»™UINavigationBarå¢åŠ setTitleFontæ–¹æ³•çš„æ‰©å±•ã€‚ extension UINavigationBar { /// Set Navigation Bar title, title color and font. /// /// - Parameters: /// - font: title font /// - color: title text color (default is .black). public func setTitleFont(_ font: UIFont, color: UIColor = .black) { var attrs = [NSAttributedString.Key: Any]() attrs[.font] = font attrs[.foregroundColor] = color self.titleTextAttributes = attrs } } å¦‚ä½•ä½¿ç”¨ åœ¨åˆ›å»ºUINavigationControllerçš„æ—¶å€™ï¼Œæ‰‹åŠ¨è®¾ç½®titleå­—ä½“æ ·å¼ã€‚ navVc.navigationBar.setTitleFont(.appMediuFont(16)) ç»Ÿä¸€è®¾ç½®å¯¼èˆªæ èƒŒæ™¯é¢œè‰²ã€æ ‡é¢˜é¢œè‰²å’Œå¤§å°ã€çŠ¶æ€æ æ–‡æœ¬é¢œè‰² "},"pages/å…¶ä»–/ä¸šåŠ¡ç»„ä»¶æŒ‰å›½å®¶å­åº“åŒ–.html":{"url":"pages/å…¶ä»–/ä¸šåŠ¡ç»„ä»¶æŒ‰å›½å®¶å­åº“åŒ–.html","title":"ä¸šåŠ¡ç»„ä»¶æŒ‰å›½å®¶å­åº“åŒ–","keywords":"","body":"ä¸šåŠ¡ç»„ä»¶æŒ‰å›½å®¶å­åº“åŒ– å¦‚ä½•è§£å†³å¤šä¸ªå›½å®¶å¹¶è¡Œå¼€å‘ï¼Ÿ ä¸€ã€è§£å†³æ–¹æ¡ˆ æ–¹æ¡ˆä¸€ï¼šä¸åŒå›½å®¶ä¸åŒåˆ†æ”¯ ä¸€ä¸ªå›½å®¶å¯¹åº”ä¸€ä¸ªåˆ†æ”¯ï¼Œå¯¹åº”å›½å®¶çš„å®¿ä¸»å·¥ç¨‹ä¾èµ–å›½å®¶åˆ†æ”¯ã€‚ æ–¹æ¡ˆäºŒï¼šå¤šä¸ªå›½å®¶å¤šä¸ªå­åº“ æŒ‰å›½å®¶æ–°å»ºä¸åŒçš„å­åº“ï¼Œå¹¶ä¸”æ–°å»ºä¸åŒå›½å®¶çš„targetåˆ†åˆ«ä¾èµ–å­åº“ã€‚ å¯¹æ¯”ä¸¤ä¸ªæ–¹æ¡ˆï¼Œä¸ªäººå€¾å‘æ–¹æ¡ˆäºŒ æ–¹æ¡ˆä¸€ä¿®æ”¹ä»£ç æ¯”è¾ƒéº»çƒ¦ï¼Œä¸åˆ©äºä»£ç å¤ç”¨ã€‚ äºŒã€æ–°å»ºå­åº“ ä¸‹é¢ä»¥GWHModuleHomeä¸ºä¾‹ï¼š 2.1 æ•´ç†é¡¹ç›®æ–‡ä»¶å¤¹ï¼ŒæŒ‰å›½å®¶åˆ’åˆ† åœ¨Classesä¸‹åˆ†åˆ«æ–°å»ºCore/Thailand/Russiaæ–‡ä»¶å¤¹ã€‚ å°†ClassesåŸæ¥æ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹æ”¾å…¥Core Thailandå’ŒRussiaéšä¾¿æ”¾ä¸€ä¸ªswiftæ–‡ä»¶ï¼Œä¸ºäº†pod installå¯ä»¥æ˜¾ç¤ºè¿™ä¸¤ä¸ªå­åº“ã€‚ 2.2 ä¿®æ”¹GWHModuleHome.podspec è®¾ç½®é»˜è®¤å­åº“Coreã€‚ æ–°å»ºCore/Thailand/Russiaå­åº“ï¼Œæºæ–‡ä»¶åŠèµ„æºæ–‡ä»¶è·¯å¾„ä¸€å®šè¦æ­£ç¡®ã€‚ æ‰§è¡Œpod installï¼Œè¿™æ ·å°±å®Œæˆå­åº“æ–°å»ºã€‚ Pod::Spec.new do |s| ..... s.default_subspec = 'Core' s.subspec 'Core' do |ss| ss.source_files = 'GWHModuleHome/Classes/Core/**/*' ss.resource_bundles = { 'GWHModuleHome' => [ 'GWHModuleHome/Assets/**/{*}', 'GWHModuleHome/Classes/**/{*.storyboard,*.xib}' ] } ss.dependency 'GWHModuleMine' ss.dependency 'GWNetWork' ss.dependency 'GWCommonComponent' ss.dependency 'GWUserCenterBase' ss.dependency 'Aquaman' ss.dependency 'Trident' end s.subspec 'Russia' do |ss| ss.source_files = 'GWHModuleHome/Classes/Russia/**/*' ss.dependency 'GWHModuleHome/Core' end s.subspec 'Thailand' do |ss| ss.source_files = 'GWHModuleHome/Classes/Thailand/**/*' ss.dependency 'GWHModuleHome/Core' end end ä¸‰ã€æ–°å»ºtarget åˆ†åˆ«å‚è€ƒä¸‹é¢çš„é“¾æ¥ï¼š Xcode ä¸€ä¸ªé¡¹ç›®ä¸‹åˆ›å»ºå¤šä¸ªTarget é…ç½®å¤šä¸ªtargetåŠå¤šä¸ªTargetçš„podfileæ–‡ä»¶é…ç½® Xcodeä¸­Active Compilation Conditionså’ŒPreprocessor Macrosçš„åŒºåˆ« "},"pages/å…¶ä»–/Appæƒé™ç®¡ç†.html":{"url":"pages/å…¶ä»–/Appæƒé™ç®¡ç†.html","title":"Appæƒé™ç®¡ç†","keywords":"","body":"Appæƒé™ç®¡ç† GWUtilCoreç»„ä»¶å¢åŠ PrivacyManagerï¼Œç»Ÿä¸€Appå†…æƒé™è·å–ã€‚ è‡ªå®šä¹‰éšç§ç±»å‹ ç›®å‰Appåªæ¶‰åŠ3ç§æƒé™,å®šä¹‰å¦‚ä¸‹ï¼š /* * éšç§æƒé™ç±»å‹ 1. åœ¨Info.plistæ–‡ä»¶ä¸­é…ç½®åº”ç”¨æ‰€éœ€æƒé™ï¼› 2. åœ¨é¡¹ç›®çš„Targets->Capabilitiesä¸­å¼€å¯ç›¸åº”å¼€å…³ï¼Œç›®å‰Siriã€Healthã€NFCã€HomeKitéœ€è¦å¼€å¯ï¼› 3. å¼•å…¥ç›¸å…³åº“ï¼› 4. ä½¿ç”¨ä»£ç è·å–å¯¹åº”çš„éšç§æƒé™ã€‚ */ public enum PrivacyType { // ç›¸æœº Authorized Denied Unsupported Unkonw case camera // ç›¸å†Œ NotDetermined Authorized Denied Restricted Unkonw case photos // å®šä½ NotDetermined Unkonw Denied Authorized:AuthorizedAlways||AuthorizedWhenInUse case location public var title: String { ...... } public var subTitle: String { ...... } public static var all :[PrivacyType] { return [.location , .camera , .photos] } } è‡ªå®šä¹‰æƒé™ç±»å‹ å°†æƒé™ç»“æœç»Ÿä¸€åŒ…è£…ä¸ºè‡ªå®šä¹‰çš„ç±»å‹ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š /// è·å–éšç§æƒé™ç»“æœ public enum AuthorizationStatus{ // æœªçŸ¥ case unknow // æˆæƒ case authorized // æ‹’ç» case denied // ä¸æ”¯æŒ case unsupported // æœªå†³å®šï¼ˆç›¸å†Œï¼Œåœ°ç†ä½ç½®ï¼‰ case notDetermined public var title: String { ...... } public var titleColor: UIColor? { ...... } } éšç§æƒé™ç®¡ç† PrivacyManageræä¾›ä¸¤ä¸ªè¯·æ±‚éšç§æƒé™çš„ç±»æ–¹æ³•,å®šä¹‰å¦‚ä¸‹ï¼š synRequestAccessæ–¹æ³•ä¸ºåŒæ­¥æ–¹æ³•ï¼Œå¯ä»¥åŒæ­¥è·å–æŒ‡å®šéšç§çš„æƒé™ã€‚ /// åŒæ­¥è¯·æ±‚éšç§æƒé™ /// - Parameter type: éšç§æƒé™ç±»å‹ /// - Returns: éšç§æƒé™ public static func synRequestAccess(_ type: PrivacyType) -> AuthorizationStatus { switch type { case .photos: return shared.requestAccessPhotos(nil) case .location: return shared.requestAccessLocation(nil) case .camera: return shared.requestAccessCamera(nil) } } asynRequestAccessæ–¹æ³•ä¸ºå¼‚æ­¥æ–¹æ³•ï¼Œé€šè¿‡ä¼ å…¥completionHandleå¼‚æ­¥è·å–éšç§çš„æƒé™ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ä¼šè§¦å‘è¯¢é—®çª—å£ï¼Œå½“ç”¨æˆ·å†³å®šåï¼ŒcompletionHandleä¼šå°†å†³å®šåçš„ç»“æœè¿”å›ã€‚ /// å¼‚æ­¥è¯·æ±‚éšç§æƒé™ /// - Parameters: /// - type: éšç§æƒé™ç±»å‹ /// - completionHandle: éšç§æƒé™ç»“æœä»£ç å— public static func asynRequestAccess(_ type: PrivacyType , completionHandle: ((AuthorizationStatus) -> Void)?) { switch type { case .photos: _ = shared.requestAccessPhotos(completionHandle) break case .location: _ = shared.requestAccessLocation(completionHandle) break case .camera: _ = shared.requestAccessCamera(completionHandle) break } è¯·æ±‚æƒé™å®ç° extension PrivacyManager: CLLocationManagerDelegate { /// åœ¨ä¸»çº¿ç¨‹å›è°ƒéšç§æƒé™ç»“æœ /// - Parameters: /// - status: éšç§æƒé™ç»“æœ /// - completionHandle: éšç§æƒé™ç»“æœä»£ç å— private func response(status: AuthorizationStatus, completionHandle: ((AuthorizationStatus) -> Void)?) { DispatchQueue.main.async { completionHandle?(status) } } // MARK: è¯·æ±‚ç›¸æœºè®¿é—®æƒé™ func requestAccessCamera(_ completionHandle: ((AuthorizationStatus) -> Void)?) -> AuthorizationStatus { if UIImagePickerController.isSourceTypeAvailable(.camera) { let status = AVCaptureDevice.authorizationStatus(for: .video) if status == .notDetermined { if completionHandle != nil { AVCaptureDevice.requestAccess(for: .video) { [weak self] (granted) in if granted{ self?.response(status: .authorized, completionHandle: completionHandle) } else { self?.response(status: .denied, completionHandle: completionHandle) } } } return .notDetermined } else if status == .authorized{ response(status: .authorized, completionHandle: completionHandle) return .authorized } else if status == .denied || status == .restricted{ response(status: .denied, completionHandle: completionHandle) return .denied } else { response(status: .unknow, completionHandle: completionHandle) return .unknow } } else{ response(status: .unsupported, completionHandle: completionHandle) return .unsupported } } // MARK: è¯·æ±‚ç›¸å†Œæƒé™ func requestAccessPhotos(_ completionHandle: ((AuthorizationStatus) -> Void)?) -> AuthorizationStatus { let status = PHPhotoLibrary.authorizationStatus() if status == .notDetermined { if completionHandle != nil { PHPhotoLibrary.requestAuthorization { [weak self] (status) in if status == .notDetermined{ self?.response(status: .notDetermined, completionHandle: completionHandle) } else if status == .denied || status == .restricted { self?.response(status: .denied, completionHandle: completionHandle) } else{ self?.response(status: .authorized, completionHandle: completionHandle) } } } return .notDetermined } else if status == .authorized { response(status: .authorized, completionHandle: completionHandle) return .authorized } else if status == .denied || status == .restricted { response(status: .denied, completionHandle: completionHandle) return .denied } else{ response(status: .unknow, completionHandle: completionHandle) return .unknow } } // MARK: è¯·æ±‚å®šä½æƒé™ func requestAccessLocation(_ completionHandle: ((AuthorizationStatus) -> Void)?) -> AuthorizationStatus { let status = CLLocationManager.authorizationStatus() let serviceEnabled = CLLocationManager.locationServicesEnabled() if !serviceEnabled { return .unsupported } else if status == .notDetermined { if completionHandle != nil { PrivacyManager.shared.locationCompletionBlock = completionHandle let loc = CLLocationManager() loc.delegate = PrivacyManager.shared loc.requestWhenInUseAuthorization() loc.startUpdatingLocation() PrivacyManager.shared.locationManager = loc } return .notDetermined } else if status == .denied || status == .restricted { response(status: .denied, completionHandle: completionHandle) return .denied } else if status == .authorizedAlways || status == .authorizedWhenInUse{ response(status: .authorized, completionHandle: completionHandle) return .authorized } else{ response(status: .unknow, completionHandle: completionHandle) return .unknow } } public func locationManager(_ manager: CLLocationManager, didChangeAuthorization status: CLAuthorizationStatus) { switch status { case .notDetermined: response(status: .notDetermined, completionHandle: PrivacyManager.shared.locationCompletionBlock) break case .denied, .restricted: response(status: .denied, completionHandle: PrivacyManager.shared.locationCompletionBlock) PrivacyManager.shared.locationCompletionBlock = nil break case .authorizedAlways, .authorizedWhenInUse: response(status: .authorized, completionHandle: PrivacyManager.shared.locationCompletionBlock) PrivacyManager.shared.locationCompletionBlock = nil break @unknown default: response(status: .unknow, completionHandle: PrivacyManager.shared.locationCompletionBlock) PrivacyManager.shared.locationCompletionBlock = nil break } } } "},"pages/å…¶ä»–/Appå®šä½ç®¡ç†.html":{"url":"pages/å…¶ä»–/Appå®šä½ç®¡ç†.html","title":"Appå®šä½ç®¡ç†","keywords":"","body":"Appå®šä½ç®¡ç† é¡¹ç›®ä¸­å•†åŸåŠçˆ±è½¦åˆ†åˆ«ä½¿ç”¨åˆ°äº†ç³»ç»Ÿå®šä½ï¼Œæ•…å°†å®šä½ç®¡ç†ç±»ä»åœ°å›¾ä¸­æŠ½ç¦»å‡ºæ¥ã€‚ å®šä½ç®¡ç†ä½œä¸ºå•ä¾‹ï¼Œæä¾›â€œå¼€å§‹å®šä½â€ã€â€œåœæ­¢å®šä½â€ã€â€œå®šä½æ˜¯å¦å¯ç”¨â€ã€â€œæ£€ç´¢åœ°å€â€ç­‰æ–¹æ³•ã€‚ ç»†èŠ‚ï¼šå¼€å§‹å®šä½çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨åˆ°PrivacyManagerçš„å¼‚æ­¥è¯·æ±‚æƒé™çš„æ–¹æ³•ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨çš„æ—¶å€™ï¼Œä¼šæœ‰è¯¢é—®å¼¹çª—ï¼Œç”¨æˆ·å†³å®šæˆæƒåï¼Œä¼šç»§ç»­å®šä½ï¼Œå¦åˆ™å®šä½å¤±è´¥ã€‚ 2021.1.21:æ–°å¢func startLocating(subLocManager: SubCLLocationManager),æ”¯æŒåŒæ—¶è°ƒç”¨å¤šæ¬¡å®šä½,å®šä½å®ŒæˆsubLocManagerçš„locatingCompletionä¼šè¢«è°ƒç”¨ã€‚ import UIKit import CoreLocation /// ç³»ç»Ÿå®šä½çš„å­ç±» public class SubCLLocationManager: CLLocationManager { /// å®šä½å®Œæˆ public var locatingCompletion: ((CLLocation?) -> Void)? public override init() { super.init() desiredAccuracy = kCLLocationAccuracyBest } } /// è‡ªå®šä¹‰å®šä½ä»£ç† public protocol LocationManagerDelegate: NSObjectProtocol { /// æ›´æ–°å®šä½ /// - Parameter location: ç³»ç»Ÿå®šä½ func onLocationUpdated(location: CLLocation) /// å®šä½å¤±è´¥ func onLocationFailure() } public extension LocationManagerDelegate { func onLocationUpdated(location: CLLocation) { } func onLocationFailure() { } } /// è‡ªå®šä¹‰å®šä½ç®¡ç† public class LocationManager: NSObject { /// ä»£ç† public weak var delegate: LocationManagerDelegate? /// ç³»ç»Ÿç”¨æˆ·å®šä½ public var userLocation: CLLocation? /// ç³»ç»Ÿå®šä½ç®¡ç† private let locationManager = SubCLLocationManager() private var tempManagers = [SubCLLocationManager]() /// å•ä¾‹ public static let shared = LocationManager() /// å¼€å§‹å®šä½ public func startLocating() { startLocating(subLocManager: locationManager) } /// å¼€å§‹å®šä½ /// - Parameter subLocManager: æŒ‡å®šå®šä½ç®¡ç† public func startLocating(subLocManager: SubCLLocationManager) { tempManagers.append(subLocManager) PrivacyManager.asynRequestAccess(.location) {[weak self] (status) in switch status { case .authorized: subLocManager.delegate = self subLocManager.startUpdatingLocation() break default: subLocManager.delegate = self subLocManager.locatingCompletion?(nil) self?.delegate?.onLocationFailure() self?.remove(manager: subLocManager) break } } } /// åœæ­¢å®šä½ public func stopLocating() { stopLocating(subLocManager: locationManager) } /// åœæ­¢å®šä½ /// - Parameter subLocManager: æŒ‡å®šå®šä½ç®¡ç† public func stopLocating(subLocManager: SubCLLocationManager) { subLocManager.stopUpdatingLocation() remove(manager: subLocManager) } /// ç§»é™¤æŒ‡å®šå®šä½ç®¡ç† /// - Parameter manager: æŒ‡å®šå®šä½ç®¡ç† private func remove(manager: SubCLLocationManager) { if let index = tempManagers.firstIndex(of: manager) { tempManagers.remove(at: index) } } /// å®šä½æ˜¯å¦å¯ç”¨ /// - Returns: æ˜¯å¦å¯ç”¨ public func locationServiceEnable() -> Bool { return PrivacyManager.synRequestAccess(.location) == .authorized } /// æ£€ç´¢åœ°å€ /// - Parameter location: å®šä½ /// - Returns: åœ°å€ public func reverseGeocodeLocation(_ location: CLLocation, completionHandler: ((String?) -> Void)?) { CLGeocoder().reverseGeocodeLocation(location) { (placemarks, error) -> Void in if error != nil { GWLog(\"----- æ£€ç´¢åœ°å€å¤±è´¥ -----\") completionHandler?(nil) } else { let pm = CLPlacemark(placemark: placemarks![0] as CLPlacemark) var address: String = \"\" func addSymbol() -> String { if !address.isEmpty { address += \",\" } return address } if let subThoroughtare = pm.subThoroughfare // é—¨ç‰Œå· { address = addSymbol() + subThoroughtare } if let thoroughfare = pm.thoroughfare // è¡—é“ { address = addSymbol() + thoroughfare } if let subLocality = pm.subLocality // åŒº { address = addSymbol() + subLocality } if let locality = pm.locality // å¸‚ { address = addSymbol() + locality } if let administrativeArea = pm.administrativeArea // çœï¼ˆå·ï¼‰ { address = addSymbol() + administrativeArea } if let country = pm.country // å›½å®¶ { address = addSymbol() + country } GWLog(\"----- æ£€ç´¢åœ°å€ï¼š\\(address) -----\") completionHandler?(address) } } } } extension LocationManager: CLLocationManagerDelegate { /// å®šä½å›è°ƒ public func locationManager(_ manager: CLLocationManager, didUpdateLocations locations: [CLLocation]) { guard let lastLocation = locations.last else { GWLog(\"----- å®šä½å¤±è´¥:æ²¡æœ‰æ‰¾åˆ°æœ€åä¸€ä¸ªä½ç½® -----\") delegate?.onLocationFailure() if let manager = manager as? SubCLLocationManager { manager.locatingCompletion?(nil) } return } GWLog(\"----- å®šä½æˆåŠŸ:latitude-\\(lastLocation.coordinate.latitude),longitude-\\(lastLocation.coordinate.longitude) -----\") userLocation = lastLocation delegate?.onLocationUpdated(location: lastLocation) if let manager = manager as? SubCLLocationManager { manager.locatingCompletion?(lastLocation) } } /// å®šä½å¤±è´¥ public func locationManager(_ manager: CLLocationManager, didFailWithError error: Error) { if let error = error as? CLError, error.code == .denied { GWLog(\"----- ç”¨æˆ·æ‹’ç»å®šä½ -----\") if let manager = manager as? SubCLLocationManager { stopLocating(subLocManager: manager) } } GWLog(\"----- å®šä½å¤±è´¥:\\(error) -----\") delegate?.onLocationFailure() if let manager = manager as? SubCLLocationManager { manager.locatingCompletion?(nil) } } } é™„ï¼š placemark "},"pages/å…¶ä»–/èµ„æºåŒ…è£…ç±».html":{"url":"pages/å…¶ä»–/èµ„æºåŒ…è£…ç±».html","title":"èµ„æºåŒ…è£…ç±»","keywords":"","body":"èµ„æºåŒ…è£…ç±» èµ„æºï¼šé¡¹ç›®ä¸­ä½¿ç”¨çš„å›¾ç‰‡ã€é¢œè‰²ã€å­—ä½“ã€å¸¸é‡ã€å¤šè¯­è¨€ç­‰ã€‚ ä¸ºäº†æ–¹ä¾¿ç®¡ç†é¡¹ç›®èµ„æºï¼ŒUtilCoreç»„ä»¶æ–°å¢äº†å‡ ä¸ªèµ„æºåŒ…è£…ç±»ï¼Œåç»­è¯·ç¡®ä¿é¡¹ç›®ç»Ÿä¸€ä½¿ç”¨åŒ…è£…ç±»è°ƒç”¨èµ„æºã€‚ å¦‚æœåªåœ¨ä¸šåŠ¡ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œè¯·ä¸ºä»¥ä¸‹å‡ ä¸ªåŒ…è£…ç±»åˆ†åˆ«åšæ‰©å±•ï¼Œç¡®ä¿èµ„æºè°ƒç”¨çš„é«˜åº¦ç»Ÿä¸€ã€‚ è§£å†³çš„é—®é¢˜ æ˜ç¡®é¡¹ç›®ä¸­æ‰€æœ‰ä½¿ç”¨çš„å­—ä½“ã€é¢œè‰²ã€å›¾ç‰‡ç­‰ï¼Œèµ„æºç»Ÿä¸€ç®¡ç†ï¼Œä¸ºåç»­ä¸»é¢˜åšé“ºå«ã€‚ å¦‚æœé¡¹ç›®å…¨éƒ¨æ›¿æ¢ä¸ºé€šè¿‡åŒ…è£…ç±»ä½¿ç”¨èµ„æºï¼Œé‚£ä¹ˆä¸€æ—¦æŸä¸ªé¢œè‰²ã€å›¾ç‰‡ä¸ç”¨äº†ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤åŒ…è£…ç±»çš„å®šä¹‰ï¼Œå†åˆ é™¤å…·ä½“çš„èµ„æºï¼Œå‡å°‘åƒåœ¾èµ„æºçš„å­˜åœ¨ã€‚ ä»£ç é£æ ¼ç»Ÿä¸€ï¼Œè°ƒç”¨ç®€å•æ¸…æ™°ã€‚ GWColor.swift public extension UIColor { /// æ ¹æ®æ¨¡å¼ï¼ˆæ­£å¸¸/æš—é»‘ï¼‰æ¸²æŸ“é¢œè‰² /// - Parameters: /// - normal: æ­£å¸¸Hex /// - dark: æš—é»‘Hex /// - Returns: é¢œè‰² static func renderColor(_ color: GWDynamicColor) -> UIColor { var result: UIColor? if #available(iOS 13, *) { result = UIColor(dynamicProvider: { (traitCollection) -> UIColor in (traitCollection.userInterfaceStyle == .dark ? UIColor(hexString: color.dark) ?? UIColor.white : UIColor(hexString: color.normal)) ?? UIColor.white }) } else { result = UIColor(hexString: color.normal) } return result ?? UIColor.white } } /** é¢œè‰²åŒ…è£…ç±» - UtilCoreåŠå…¶å®ƒä¸šåŠ¡ç»„ä»¶é€šç”¨çš„é¢œè‰²åœ¨è¿™é‡Œå®šä¹‰ - é€šè¿‡ä½¿ç”¨åŒ…è£…ç±»æ–¹ä¾¿ç®¡ç†é¢œè‰² - ä¸šåŠ¡ç»„ä»¶å¯ä»¥é€šè¿‡Extensionså»æ‰©å±•è‡ªå·±çš„é¢œè‰² - ä½¿ç”¨ï¼šGWConstant.xC7C3C3 */ /// åŠ¨æ€é¢œè‰²ç±»å‹ public typealias GWDynamicColor = (normal: String, dark: String) public enum GWColor { public static let xC7C3C3 = UIColor.renderColor(GWDynamicColor(\"#C7C3C3\", \"#C7C3C3\")) public static let x2F2F2F = UIColor.renderColor(GWDynamicColor(\"#2F2F2F\", \"#2F2F2F\")) public static let xF6F6F6 = UIColor.renderColor(GWDynamicColor(\"#F6F6F6\", \"#F6F6F6\")) public static let x2D78FF = UIColor.renderColor(GWDynamicColor(\"#2D78FF\", \"#2D78FF\")) // ... } GWConstant.swift /** å¸¸é‡åŒ…è£…ç±» - UtilCoreåŠå…¶å®ƒä¸šåŠ¡ç»„ä»¶é€šç”¨çš„å¸¸é‡åœ¨è¿™é‡Œå®šä¹‰ - é€šè¿‡ä½¿ç”¨åŒ…è£…ç±»æ–¹ä¾¿ç®¡ç†å¸¸é‡ - ä¸šåŠ¡ç»„ä»¶å¯ä»¥é€šè¿‡Extensionså»æ‰©å±•è‡ªå·±çš„å¸¸é‡ - ä½¿ç”¨ï¼šGWConstant.xxx */ public struct GWConstant { } GWFont.swift /** å­—ä½“åŒ…è£…ç±» - UtilCoreåŠå…¶å®ƒä¸šåŠ¡ç»„ä»¶é€šç”¨çš„å­—ä½“åœ¨è¿™é‡Œå®šä¹‰ - é€šè¿‡ä½¿ç”¨åŒ…è£…ç±»æ–¹ä¾¿ç®¡ç†å­—ä½“ - ä¸šåŠ¡ç»„ä»¶å¯ä»¥é€šè¿‡Extensionså»æ‰©å±•è‡ªå·±çš„å­—ä½“ - ä½¿ç”¨ï¼šGWLocalized.r11 */ public struct GWFont { public static let r11 = UIFont.appRegularFontWith(size: 11) public static let r12 = UIFont.appRegularFontWith(size: 12) public static let r14 = UIFont.appRegularFontWith(size: 14) public static let r16 = UIFont.appRegularFontWith(size: 16) public static let r20 = UIFont.appRegularFontWith(size: 20) public static let m20 = UIFont(mediumFontWithSize: 20) } GWImage.swift /** å›¾ç‰‡åŒ…è£…ç±» - UtilCoreåŠå…¶å®ƒä¸šåŠ¡ç»„ä»¶é€šç”¨çš„å›¾ç‰‡åœ¨è¿™é‡Œå®šä¹‰ - é€šè¿‡ä½¿ç”¨åŒ…è£…ç±»æ–¹ä¾¿ç®¡ç†å›¾ç‰‡ - ä¸šåŠ¡ç»„ä»¶å¯ä»¥é€šè¿‡Extensionså»æ‰©å±•è‡ªå·±çš„å›¾ç‰‡ - ä½¿ç”¨ï¼šGWImage.ruNoContent */ public struct GWImage { // MARK: - UIView+Empty /// ä¿„ç½—æ–¯Â·æ²¡æ•°æ® static var ruNoContent: UIImage? { UIImage(inUtilCore: \"img_russia_common_no_content\") } /// ä¿„ç½—æ–¯Â·æ— ç½‘ç»œ static var ruNoNetwork: UIImage? { UIImage(inUtilCore: \"img_russia_common_no_network\") } /// æ³°å›½Â·æ²¡æ•°æ® static var thNoContent: UIImage? { UIImage(inUtilCore: \"no_content\") } /// æ³°å›½Â·æ— ç½‘ç»œ static var thNoNetwork: UIImage? { UIImage(inUtilCore: \"no_network\") } /// æ³°å›½Â·æœåŠ¡å™¨é”™è¯¯ static var thServerError: UIImage? { UIImage(inUtilCore: \"load_failure\") } } GWLocalized.swift /** å¤šè¯­è¨€åŒ…è£…ç±» - UtilCoreåŠå…¶å®ƒä¸šåŠ¡ç»„ä»¶é€šç”¨çš„å¤šè¯­è¨€åœ¨è¿™é‡Œå®šä¹‰ - é€šè¿‡ä½¿ç”¨åŒ…è£…ç±»æ–¹ä¾¿ç®¡ç†å¤šè¯­è¨€ - ä¸šåŠ¡ç»„ä»¶å¯ä»¥é€šè¿‡Extensionså»æ‰©å±•è‡ªå·±çš„å¤šè¯­è¨€ - ä½¿ç”¨ï¼šGWLocalized.loading */ public struct GWLocalized { /// æäº¤ä¸­ public static var loading: String { GWI18n.R.string.localizable.base_loading() } /// Yes public static var yes: String { GWI18n.R.string.localizable.base_yes() } /// No public static var no: String { GWI18n.R.string.localizable.base_no() } /// æ— ç½‘ç»œ public static var noNetwork: String { GWI18n.R.string.localizable.base_net_lost() } /// å‘å¸ƒ public static var publish: String { GWI18n.R.string.localizable.re_publish() } /// ç¡®è®¤ public static var confirm: String { GWI18n.R.string.localizable.base_sure() } /// å–æ¶ˆ public static var cancel: String { GWI18n.R.string.localizable.base_cancel() } } "},"pages/å…¶ä»–/åŒæ­¥æœªè¯»æ¶ˆæ¯.html":{"url":"pages/å…¶ä»–/åŒæ­¥æœªè¯»æ¶ˆæ¯.html","title":"åŒæ­¥æœªè¯»æ¶ˆæ¯","keywords":"","body":"åŒæ­¥æœªè¯»æ¶ˆæ¯ éœ€æ±‚ åªæœ‰ç”¨æˆ·å·²ç»ç™»å½•æ‰åŒæ­¥æœªè¯»æ¶ˆæ¯ã€‚ å½“æ”¶åˆ°æ¶ˆæ¯æ¨é€ï¼Œè§¦å‘åŒæ­¥ã€‚ å½“Appåœç•™åœ¨å‰å°ï¼Œæ¯ä¸ª60sï¼Œå¹¶ä¸”åœç•™åœ¨æŒ‡å®šé¡µé¢ï¼ˆé¦–é¡µã€æˆ‘çš„ï¼‰ï¼Œè§¦å‘åŒæ­¥ã€‚ å½“æŒ‡å®šé¡µé¢ï¼ˆé¦–é¡µã€æˆ‘çš„ï¼‰ç¬¬ä¸€æ¬¡æ˜¾ç¤ºï¼Œè§¦å‘åŒæ­¥ã€‚ å½“ç¦»å¼€æŒ‡å®šé¡µé¢ï¼ˆé¦–é¡µã€æˆ‘çš„ï¼‰è¶…è¿‡60så†å›æ¥ï¼Œè§¦å‘åŒæ­¥ã€‚ ä¸€ã€å…ˆå®ç°éœ€æ±‚4ã€5 ä¸ºvcå¢åŠ rxçš„æ‰©å±•åºåˆ—visibleDetailï¼Œå½“vcæ˜¾ç¤ºæˆ–è€…ç¦»å¼€æ—¶ä¼šå‘å‡ºâ€œæ˜¯å¦æ˜¾ç¤ºâ€ã€â€œæ˜¯å¦ç¬¬ä¸€æ¬¡æ˜¾ç¤ºâ€ã€â€œç¦»å¼€æ—¶é—´â€çš„å…ƒç»„ä¿¡å·ã€‚é€šè¿‡å¯¹visibleDetailçš„è®¢é˜…ï¼Œå½“å‘å‡ºä¿¡å·æ—¶ï¼Œå»åˆ¤æ–­æ˜¯å¦ç¬¬ä¸€æ¬¡ï¼Œå¦‚æœæ˜¯å°±è§¦å‘ä¸€æ¬¡åŒæ­¥ï¼Œå¦‚æœä¸æ˜¯ï¼Œå†åˆ¤æ–­ç¦»å¼€æ—¶é—´æ˜¯å¦è¶…è¿‡60sï¼Œå¦‚æœè¶…è¿‡ä¹Ÿéœ€è¦è§¦å‘ä¸€æ¬¡åŒæ­¥ã€‚ 1.1 å¦‚ä½•ä¸ºvcå¢åŠ æ‰©å±•åºåˆ—visibleDetail é¦–å…ˆå¢åŠ vcç”Ÿå‘½å‘¨æœŸçš„åŸºæœ¬æ‰©å±•ï¼Œä»£ç æ¥æºã€‚ public extension Reactive where Base: UIViewController { public var viewDidAppear: ControlEvent { let source = self.methodInvoked(#selector(Base.viewDidAppear)) .map { $0.first as? Bool ?? false } return ControlEvent(events: source) } public var viewWillDisappear: ControlEvent { let source = self.methodInvoked(#selector(Base.viewWillDisappear)) .map { $0.first as? Bool ?? false } return ControlEvent(events: source) } // è¡¨ç¤ºè§†å›¾æ˜¯å¦æ˜¾ç¤ºçš„å¯è§‚å¯Ÿåºåˆ—ï¼Œå½“VCæ˜¾ç¤ºçŠ¶æ€æ”¹å˜æ—¶ä¼šè§¦å‘ public var isVisible: Observable { let viewDidAppearObservable = self.base.rx.viewDidAppear.map { _ in true } let viewWillDisappearObservable = self.base.rx.viewWillDisappear .map { _ in false } return Observable.merge(viewDidAppearObservable, viewWillDisappearObservable) } ...... } ç»§ç»­ç»™vcå¢åŠ è¿›å…¥/ç¦»å¼€æ—¶é—´çš„å±æ€§æ‰©å±•ï¼Œç”¨äºè®°å½•é¡µé¢çš„è¿›å…¥/ç¦»å¼€çš„æ—¶é—´æ’®ã€‚ private var enterStampKey: Void? private var leaveStampKey: Void? public extension UIViewController { /// ç¦»å¼€æ—¶é—´æ’® var leaveStamp: TimeInterval? { set(newValue) { objc_setAssociatedObject(self, &leaveStampKey, newValue, .OBJC_ASSOCIATION_RETAIN) } get { return objc_getAssociatedObject(self, &leaveStampKey) as? TimeInterval } } /// è¿›å…¥æ—¶é—´æ’® var enterStamp: TimeInterval? { set(newValue) { objc_setAssociatedObject(self, &enterStampKey, newValue, .OBJC_ASSOCIATION_RETAIN) } get { return objc_getAssociatedObject(self, &enterStampKey) as? TimeInterval } } } æœ‰äº†ä»¥ä¸Šä¸¤ä¸ªæ‰©å±•ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä¸ºvcå¢åŠ rxæ‰©å±•åºåˆ—visibleDetailäº†,å¯ä»¥çœ‹ä¸‹é¢çš„å®ç°ï¼ŒvisibleDetailä¾èµ–äºisVisible,æ¯å½“é¡µé¢è¿›å…¥/ç¦»å¼€ä¼šè®°å½•æ—¶é—´æ’®ï¼ŒåŒæ—¶è¯¥åºåˆ—è¿”å›çš„ç±»å‹æ˜¯å…ƒç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯â€œæ˜¯å¦æ˜¾ç¤ºâ€ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯â€œæ˜¯å¦ç¬¬ä¸€æ¬¡æ˜¾ç¤ºâ€ï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ æ˜¯â€œç¦»å¼€æ—¶é—´â€ã€‚ public extension Reactive where Base: UIViewController { /// æ˜¾ç¤ºè¯¦æƒ… /// - Parameters: å‚æ•° /// - visibleï¼šæ˜¯å¦æ˜¾ç¤º /// - isFirstï¼šæ˜¯å¦ç¬¬ä¸€æ¬¡æ˜¾ç¤º /// - leaveTimeï¼šç¦»å¼€æ—¶é—´ï¼Œå•ä½sï¼Œé»˜è®¤è¿”å›0 typealias VisibleDetail = (visible: Bool,isFirst: Bool, leaveTime: Int) var visibleDetail: Observable { return self.base.rx.isVisible.map { (isVisible) -> VisibleDetail in if isVisible { let isFirst = self.base.enterStamp == nil// æ˜¯å¦ç¬¬ä¸€æ¬¡æ˜¾ç¤º var leaveTime: Int = 0// ç¦»å¼€æ—¶é—´ self.base.enterStamp = Date().timeIntervalSince1970 if let enterStamp = self.base.enterStamp, let leaveStamp = self.base.leaveStamp, enterStamp > leaveStamp { leaveTime = Int(enterStamp - leaveStamp) } return (true, isFirst, leaveTime) } else { self.base.leaveStamp = Date().timeIntervalSince1970 return (false, false, 0) } } } } 1.2 å¢åŠ SynMessageToolå•ä¾‹ SynMessageToolæ˜¯ä¸€ä¸ªå•ä¾‹ï¼Œæä¾›äº†ä¸€ä¸ªstartã€stopæ–¹æ³•ï¼Œstartæ–¹æ³•éœ€è¦ä¼ å…¥ä¸€ä¸ªvcï¼Œæ„æ€æ˜¯æ¶ˆæ¯åŒæ­¥æ˜¯éœ€è¦æ ¹æ®vcçš„ç”Ÿå‘½å‘¨æœŸæ¥æ§åˆ¶çš„ï¼Œå½“vcç¬¬ä¸€æ¬¡æ˜¾ç¤ºæˆ–è€…ç¦»å¼€vcè¶…è¿‡60så†å›æ¥å°±è§¦å‘åŒæ­¥ã€‚ /// åŒæ­¥æœªè¯»æ¶ˆæ¯ï¼Œå‘å‡ºé€šçŸ¥ public class SynMessageTool { public static let shared = SynMessageTool() /// SynMessageè®¢é˜…å–æ¶ˆ private var disposable: Disposable? /// åŒæ­¥æ¶ˆæ¯ï¼ˆæ•°å­—ï¼‰ /// - Parameters: /// - messageVc: åŒæ­¥æ¶ˆæ¯å…³è”vc public func start(messageVc: UIViewController?) { // ä¼ vcæ‰åŒæ­¥æ¶ˆæ¯ guard let vc = messageVc else { return } // åœæ­¢è®¢é˜… stop() GWLog(\"----- vc is \\(vc.classForCoder) -----\") /// é¡µé¢è§¦å‘åŒæ­¥åºåˆ— let synMessageObservable = vc.rx.visibleDetail.flatMap { (detail) -> Observable in if detail.isFirst { GWLog(\"----- ç¬¬ä¸€æ¬¡æ˜¾ç¤º -----\") return HomeViewModel.getUnreadCount } else if detail.leaveTime > 60 { GWLog(\"----- éç¬¬ä¸€æ¬¡æ˜¾ç¤ºï¼Œä½†æ˜¯ç¦»å¼€æ—¶é—´è¶…è¿‡60s -----\") return HomeViewModel.getUnreadCount } return Observable.of() } GWLog(\"----- å¼€å§‹SynMessageè®¢é˜… ------\") disposable = synMessageObservable.subscribe(onNext: { count in GWLog(\"----- å½“å‰æ¶ˆæ¯æ•°æ•°\\(count) ------\") // å‘é€šçŸ¥ NotificationCenter.default.post(name: .synMessageCount, object: count, userInfo: [\"count\":count]) }, onDisposed: { GWLog(\"----- é‡Šæ”¾SynMessageè®¢é˜… ------\") }) } public func stop() { disposable?.dispose() } } äºŒã€å®ç°éœ€æ±‚3 éœ€æ±‚ï¼šå½“Appåœç•™åœ¨å‰å°ï¼Œæ¯ä¸ª60sï¼Œå¹¶ä¸”åœç•™åœ¨æŒ‡å®šé¡µé¢ï¼ˆé¦–é¡µã€æˆ‘çš„ï¼‰ï¼Œè§¦å‘åŒæ­¥ã€‚ è¿™é‡Œéœ€è¦ä½¿ç”¨åˆ°AppTimeråŠvcçš„rxæ‰©å±•åºåˆ—isVisible,å°†AppTimerçš„åˆ°è¾¾60sçš„åºåˆ—ä¸isVisibleé€šè¿‡Observable.combineLatestç»„åˆæˆä¸€ä¸ªæ–°çš„åºåˆ—ï¼Œå†é€šè¿‡flatMapè½¬æ¢æˆæˆ‘ä»¬éœ€è¦çš„åºåˆ—ï¼Œå½“ç„¶è¿™é‡Œéœ€è¦åˆ¤æ–­â€œé¡µé¢æ˜¯å¦æ­£åœ¨æ˜¾ç¤ºâ€ï¼Œå¦‚æœæ˜¾ç¤ºæ‰ä¼šè§¦å‘åŒæ­¥ã€‚startæ–¹æ³•ä¿®æ”¹å¦‚ä¸‹ï¼š /// åŒæ­¥æ¶ˆæ¯ï¼ˆæ•°å­—ï¼‰ /// - Parameters: /// - messageVc: åŒæ­¥æ¶ˆæ¯å…³è”vc public func start(messageVc: UIViewController?) { // ä¼ vcæ‰åŒæ­¥æ¶ˆæ¯ guard let vc = messageVc else { return } // åœæ­¢è®¢é˜… stop() // åŒæ­¥æ¶ˆæ¯åºåˆ— var synMessageObservable: Observable! GWLog(\"----- vc is \\(vc.classForCoder) -----\") /// é¡µé¢è§¦å‘åŒæ­¥åºåˆ— let synMessageObservableByVc = vc.rx.visibleDetail.flatMap { (detail) -> Observable in if detail.isFirst { GWLog(\"----- ç¬¬ä¸€æ¬¡æ˜¾ç¤º -----\") return HomeViewModel.getUnreadCount } else if detail.leaveTime > 60 { GWLog(\"----- éç¬¬ä¸€æ¬¡æ˜¾ç¤ºï¼Œä½†æ˜¯ç¦»å¼€æ—¶é—´è¶…è¿‡60s -----\") return HomeViewModel.getUnreadCount } return Observable.of() } /// è®¡æ—¶å™¨åºåˆ— let synMessageObservableByTimer = Observable.combineLatest(AppTimer.shared.reach60sObservable,vc.rx.isVisible).flatMap { (tuple) -> Observable in GWLog(\"----- AppTimer è§¦å‘åŒæ­¥ -----\") if tuple.1 { return HomeViewModel.getUnreadCount } return Observable.of() } synMessageObservable = Observable.merge(synMessageObservableByVc,synMessageObservableByTimer) GWLog(\"----- å¼€å§‹SynMessageè®¢é˜… ------\") disposable = synMessageObservable.subscribe(onNext: { count in GWLog(\"----- å½“å‰æ¶ˆæ¯æ•°æ•°\\(count) ------\") // å‘é€šçŸ¥ NotificationCenter.default.post(name: .synMessageCount, object: count, userInfo: [\"count\":count]) }, onDisposed: { GWLog(\"----- é‡Šæ”¾SynMessageè®¢é˜… ------\") }) } ä¸‰ã€å®ç°éœ€æ±‚2 éœ€æ±‚ï¼šå½“æ”¶åˆ°æ¶ˆæ¯æ¨é€ï¼Œè§¦å‘åŒæ­¥ã€‚ SynMessageToolåªéœ€è¦å¢åŠ ä¸€ä¸ªç«‹å³åŒæ­¥çš„æ–¹æ³•ï¼Œåœ¨æ”¶åˆ°é€šçŸ¥çš„åœ°æ–¹è°ƒç”¨å³å¯ã€‚ /// ç«‹å³åŒæ­¥ public func immediatelyStart() { immediatelySynDisposable = HomeViewModel.getUnreadCount.subscribe(onNext: {[weak self] count in GWLog(\"----- immediately:å½“å‰æ¶ˆæ¯æ•°æ•°\\(count) ------\") // å‘é€šçŸ¥ NotificationCenter.default.post(name: .synMessageCount, object: count, userInfo: [\"count\":count]) // é‡Šæ”¾è®¢é˜… self?.immediatelyStop() }, onDisposed: { GWLog(\"----- immediately:é‡Šæ”¾SynMessageè®¢é˜… ------\") }) } å››ã€å®ç°éœ€æ±‚1 éœ€æ±‚ï¼šåªæœ‰ç”¨æˆ·å·²ç»ç™»å½•æ‰åŒæ­¥æœªè¯»æ¶ˆæ¯ã€‚ åªéœ€è¦åœ¨startå’ŒimmediatelyStartæ–¹æ³•ä¸­åŠ å…¥å¦‚ä¸‹ç™»å½•åˆ¤æ–­å³å¯ã€‚ // ç™»å½•åæ‰åŒæ­¥æ¶ˆæ¯ guard UserManager.isLogin else { return } äº”ã€å®Œæ•´ä»£ç  /// åŒæ­¥æœªè¯»æ¶ˆæ¯ï¼Œå‘å‡ºé€šçŸ¥ public class SynMessageTool { public static let shared = SynMessageTool() /// SynMessageè®¢é˜…å–æ¶ˆ private var disposable: Disposable? /// ç¡®ä¿åŒæ­¥ä¸€æ¬¡åå–æ¶ˆ private var immediatelySynDisposable: Disposable? /// åŒæ­¥æ¶ˆæ¯ï¼ˆæ•°å­—ï¼‰ /// - Parameters: /// - messageVc: åŒæ­¥æ¶ˆæ¯å…³è”vc public func start(messageVc: UIViewController?) { // ç™»å½•åæ‰åŒæ­¥æ¶ˆæ¯ guard UserManager.isLogin else { return } // ä¼ vcæ‰åŒæ­¥æ¶ˆæ¯ guard let vc = messageVc else { return } // åœæ­¢è®¢é˜… stop() // åŒæ­¥æ¶ˆæ¯åºåˆ— var synMessageObservable: Observable! GWLog(\"----- vc is \\(vc.classForCoder) -----\") /// é¡µé¢è§¦å‘åŒæ­¥åºåˆ— let synMessageObservableByVc = vc.rx.visibleDetail.flatMap { (detail) -> Observable in if detail.isFirst { GWLog(\"----- ç¬¬ä¸€æ¬¡æ˜¾ç¤º -----\") return HomeViewModel.getUnreadCount } else if detail.leaveTime > 60 { GWLog(\"----- éç¬¬ä¸€æ¬¡æ˜¾ç¤ºï¼Œä½†æ˜¯ç¦»å¼€æ—¶é—´è¶…è¿‡60s -----\") return HomeViewModel.getUnreadCount } return Observable.of() } /// è®¡æ—¶å™¨åºåˆ— let synMessageObservableByTimer = Observable.combineLatest(AppTimer.shared.reach60sObservable,vc.rx.isVisible).flatMap { (tuple) -> Observable in GWLog(\"----- AppTimer è§¦å‘åŒæ­¥ -----\") if tuple.1 { return HomeViewModel.getUnreadCount } return Observable.of() } synMessageObservable = Observable.merge(synMessageObservableByVc,synMessageObservableByTimer) GWLog(\"----- å¼€å§‹SynMessageè®¢é˜… ------\") disposable = synMessageObservable.subscribe(onNext: { count in GWLog(\"----- å½“å‰æ¶ˆæ¯æ•°æ•°\\(count) ------\") // å‘é€šçŸ¥ NotificationCenter.default.post(name: .synMessageCount, object: count, userInfo: [\"count\":count]) }, onDisposed: { GWLog(\"----- é‡Šæ”¾SynMessageè®¢é˜… ------\") }) } public func stop() { disposable?.dispose() } /// ç«‹å³åŒæ­¥ public func immediatelyStart() { // ç™»å½•åæ‰åŒæ­¥æ¶ˆæ¯ guard UserManager.isLogin else { return } immediatelySynDisposable = HomeViewModel.getUnreadCount.subscribe(onNext: {[weak self] count in GWLog(\"----- immediately:å½“å‰æ¶ˆæ¯æ•°æ•°\\(count) ------\") // å‘é€šçŸ¥ NotificationCenter.default.post(name: .synMessageCount, object: count, userInfo: [\"count\":count]) // é‡Šæ”¾è®¢é˜… self?.immediatelyStop() }, onDisposed: { GWLog(\"----- immediately:é‡Šæ”¾SynMessageè®¢é˜… ------\") }) } /// ç«‹å³åœæ­¢ public func immediatelyStop() { immediatelySynDisposable?.dispose() } } "},"pages/å…¶ä»–/è‡ªå®šä¹‰é”™è¯¯.html":{"url":"pages/å…¶ä»–/è‡ªå®šä¹‰é”™è¯¯.html","title":"è‡ªå®šä¹‰é”™è¯¯","keywords":"","body":"è‡ªå®šä¹‰é”™è¯¯ Swiftä¸­çš„Error å®˜æ–¹è§£é‡Š A type representing an error value that can be thrown. Any type that declares conformance to the Error protocol can be used to represent an error in Swiftâ€™s error handling system. Because the Error protocol has no requirements of its own, you can declare conformance on any custom type you create. protocol Error Erroråœ¨Swiftä¸­å°±æ˜¯æ˜¯ä¸ªåè®®ï¼Œè€Œä¸”ä¸éœ€è¦å®ç°ä»»ä½•å±æ€§æˆ–è€…æ–¹æ³•ï¼Œå› æ­¤ä»»ä½•å£°æ˜ç¬¦åˆErroråè®®çš„ç±»å‹éƒ½å¯ä»¥ç”¨æ¥è¡¨ç¤ºSwiftçš„é”™è¯¯ã€‚ ä½¿ç”¨æšä¸¾ä½œä¸ºé”™è¯¯ é€šå¸¸é”™è¯¯éƒ½æ˜¯æœ‰å¾ˆå¤šç§ï¼Œå› æ­¤æšä¸¾ç±»å‹æ˜¯ä½œä¸ºé”™è¯¯æœ€é€‚åˆä¸è¿‡ï¼Œä¸‹é¢æ˜¯å®˜æ–¹ç»™çš„ä¾‹å­ï¼š enum IntParsingError: Error { case overflow case invalidInput(Character) } ä½¿ç”¨ç»“æ„ä½“ä½œä¸ºé”™è¯¯ å®˜æ–¹è§£é‡Š Sometimes you may want different error states to include the same common data, such as the position in a file or some of your applicationâ€™s state. When you do, use a structure to represent errors. æ„æ€å°±æ˜¯å½“ä¸åŒé”™è¯¯ä¼šåŒ…å«é€šç”¨çš„å±æ€§ï¼Œä¾‹å¦‚æ–‡ä»¶ä¸­çš„æŸäº›ä½ç½®æˆ–åº”ç”¨çš„çŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ç»“æ„ä½“ä½œä¸ºé”™è¯¯äº†ï¼Œä¸‹é¢è¿˜æ˜¯å®˜æ–¹çš„ä¾‹å­ï¼š struct XMLParsingError: Error { enum ErrorKind { case invalidCharacter case mismatchedTag case internalError } let line: Int let column: Int let kind: ErrorKind } func parse(_ source: String) throws -> XMLDoc { // ... throw XMLParsingError(line: 19, column: 5, kind: .mismatchedTag) // ... } ä¸NSErrorçš„å…³ç³» æˆ‘ä»¬åœ¨Swiftä¸­è‡ªå®šä¹‰çš„Erroræ˜¯å¯ä»¥è½»æ¾é€šè¿‡asè½¬ä¸ºNSErrorçš„ï¼Œä½†æ˜¯æˆ‘ä»¬æ”¯æŒNSErrorä½¿ç”¨æ‹¥æœ‰localizedDescriptionã€codeã€domainã€UserInfoç­‰å±æ€§çš„ï¼Œåªæœ‰å®ç°äº†ä»¥ä¸‹ä¸¤ä¸ªåè®®ï¼Œè½¬æ¢åNSErrorçš„è¿™äº›å±æ€§å°±å¯ä»¥ç”Ÿæ•ˆã€‚ LocalizedError ç”¨æ¥æ¡¥æ¥åŸæ¥NSErrorä¸­çš„localizedDescriptionã€‚ public protocol LocalizedError : Error { var errorDescription: String? { get } // ... } CustomNSError ç”¨æ¥æ¡¥æ¥åŸæ¥NSErrorä¸­çš„codeã€domainã€UserInfoã€‚ public protocol CustomNSError : Error { /// The domain of the error. public static var errorDomain: String { get } /// The error code within the given domain. public var errorCode: Int { get } /// The user-info dictionary. public var errorUserInfo: [String : Any] { get } } é™„ï¼š è‹¹æœæ–‡æ¡£ Swiftï¼šCorelocationå¤„ç†didFailWithErrorä¸­çš„NSError Swift Error çš„ä»‹ç»å’Œä½¿ç”¨ Swift 3å¿…çœ‹ï¼šErrorä¸NSErrorçš„å…³ç³» fatalError "},"pages/å…¶ä»–/GWErrorçš„ä½¿ç”¨.html":{"url":"pages/å…¶ä»–/GWErrorçš„ä½¿ç”¨.html","title":"GWErrorçš„ä½¿ç”¨","keywords":"","body":"GWErrorçš„ä½¿ç”¨ æ ¹æ®ä¸šåŠ¡ï¼Œåœ¨é¡¹ç›®ä¸­å¯ä»¥å¯¹GWClientErroræˆ–GWSeverErrorå¢åŠ caseï¼Œè‡ªå®šä¹‰é”™è¯¯ã€‚ è§£å†³é—®é¢˜ å®¢æˆ·ç«¯è¯·æ±‚æ¥å£ï¼Œæˆ‘ä»¬éœ€è¦å¼¹å‡ºæŒ‡å®šçš„æç¤ºï¼Œä¾‹å¦‚ï¼šâ€œno networkï¼ˆæ²¡æœ‰ç½‘ç»œï¼‰â€ã€â€œnetwork errorï¼ˆæœåŠ¡å™¨é”™è¯¯ï¼‰â€ã€‚ å®¢æˆ·ç«¯è¯·æ±‚æ¥å£ï¼Œå¯¹æŒ‡å®šçš„é”™è¯¯ç è¿”å›è‡ªå®šçš„é”™è¯¯ï¼Œä¾‹å¦‚ï¼šåŠ¨æ€ä¸å­˜åœ¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›712200ï¼Œæˆ‘ä»¬éœ€è¦æŒ‰éœ€æ±‚è‡ªå®šä¹‰æç¤ºã€‚ ç¼–å†™æ ¡éªŒé€»è¾‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸åŒçš„æƒ…å†µè‡ªå®šä¹‰ä¸åŒçš„ErroræŠ›å‡ºï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥é€šè¿‡catchå¯¹é”™è¯¯ç»Ÿä¸€å¤„ç†ã€‚ GWError GWErroræ˜¯å¯¹GWClientErrorã€GWSeverErrorã€MoyaErrorçš„åŒ…è£…ï¼Œä¹Ÿå°±æ˜¯å¼•å‘é”™è¯¯çš„æ¥æºæ˜¯è¢«åŒ…è£…çš„ä¸‰ç§è‡ªå®šä¹‰é”™è¯¯ï¼š public enum GWError: Swift.Error { // Moyaé”™è¯¯ case moya(MoyaError) // å®¢æˆ·ç«¯é”™è¯¯ case client(GWClientError) // æœåŠ¡ç«¯é”™è¯¯ case server(GWSeverError) } GWErroråˆ†åˆ«å®ç°äº†LocalizedErrorã€CustomNSErrorï¼š extension GWError: LocalizedError { // é”™è¯¯æè¿° public var errorDescription: String? { switch self { case let .moya(error): return error.gwErrorDescription ?? GWI18n.R.string.localizable.base_net_erroe() case let .client(error): return error.errorDescription case let .server(error): return error.errorDescription } } } extension GWError: CustomNSError { /// The domain of the error. public static var errorDomain: String = \"com.gwm.error\" // é”™è¯¯ç  public var errorCode: Int { switch self { case let .moya(error): return error.errorCode case let .client(error): return error.errorCode case let .server(error): return error.errorCode } } // é”™è¯¯ä¿¡æ¯ public var errorUserInfo: [String: Any] { var userInfo: [String: Any] = [:] userInfo[NSLocalizedDescriptionKey] = errorDescription userInfo[NSUnderlyingErrorKey] = underlyingError return userInfo } // å†…éƒ¨é”™è¯¯ internal var underlyingError: Swift.Error? { switch self { case let .moya(error): return error case let .client(error): return error case let .server(error): return error } } } ä¸ºäº†å…¼å®¹è€ä»£ç ï¼Œä¿ç•™äº†statusCodeã€messageã€codeä¸‰ä¸ªå±æ€§ï¼š // çŠ¶æ€ç  public var statusCode: Int? { switch self { case let .moya(error): return error.response?.statusCode case let .client(error): return error.statusCode case let .server(error): return error.statusCode } } // é”™è¯¯æç¤º public var message: String { errorDescription ?? \"\" } // é”™è¯¯ç  public var code: String { switch self { case let .moya(error): return String(error.errorCode) case let .client(error): return String(error.code) case let .server(error): return String(error.code) } } GWClientError GWClientErroræ˜¯å®¢æˆ·ç«¯é”™è¯¯ï¼Œå¯ä»¥æ˜¯æ ¡éªŒé€»è¾‘ä¸­çš„ä»»ä½•ä¸€ç§å¼‚å¸¸çš„å°è£…ï¼ŒåŒæ ·åˆ†åˆ«å®ç°äº†LocalizedErrorã€CustomNSErrorï¼Œç›®å‰æœ‰å¦‚ä¸‹å®šä¹‰ï¼šã€‚ public enum GWClientError: Swift.Error { // æ²¡æœ‰ç½‘ç»œ case noNetwork // ç½‘ç»œå¼‚å¸¸ case networkException // ç¦è¨€é”™è¯¯ case muted // æäº¤è¯„è®ºå¤±è´¥ case postComment // çŠ¶æ€ç  public var statusCode: Int? { // ... } // é”™è¯¯æç¤º public var message: String { // ... } // é”™è¯¯ç  public var code: String { // ... } } extension GWClientError: LocalizedError { // é”™è¯¯æè¿° public var errorDescription: String? { // ... } } extension GWClientError: CustomNSError {/// The domain of the error. public static var errorDomain: String = \"com.gwm.error.client\" // é”™è¯¯ç  public var errorCode: Int { // ... } // é”™è¯¯ä¿¡æ¯ public var errorUserInfo: [String: Any] { // ... } } GWSeverError GWSeverErroræ˜¯æœåŠ¡ç«¯é”™è¯¯ï¼Œæ˜¯æœåŠ¡ç«¯å¼‚å¸¸çš„å°è£…ï¼ŒåŒæ ·åˆ†åˆ«å®ç°äº†LocalizedErrorã€CustomNSErrorï¼Œç›®å‰å®šä¹‰å¦‚ä¸‹ï¼š public enum GWSeverError: Swift.Error { // èµ„è®¯è¯„è®ºä¸å­˜åœ¨(å›å¤è¯„è®º) case newsCommentNotExist // åŠ¨æ€è¯„è®ºä¸å­˜åœ¨(å›å¤è¯„è®º) case dynamicCommentNotExist // åŠ¨æ€è¯„è®ºä¸å­˜åœ¨(æŸ¥è¯¢è¯„è®º) case dynamicCommentNotExistOnQuery // åŠ¨æ€ä¸å­˜åœ¨ case dynamicNotExist // ç»“æœå¼‚å¸¸ case resultException(code: Int, msg: String?, statusCode: Int?) // ä¸šåŠ¡å¼‚å¸¸ static let businessErrors: [GWSeverError] = [ // ... ] // æ ¹æ®codeåŒ¹é…ä¸šåŠ¡å¼‚å¸¸ static func getError(code: Int, msg: String?, statusCode: Int?) -> GWSeverError { // ... } // çŠ¶æ€ç  public var statusCode: Int? { // ... } // é”™è¯¯æç¤º public var message: String { // ... } // é”™è¯¯ç  public var code: String { // ... } } å®ç°äº†CustomNSErrorçš„errorCode,errorCodeåº”è¯¥å’ŒæœåŠ¡ç«¯é”™è¯¯codeä¿æŒä¸€è‡´ï¼š extension GWSeverError: LocalizedError { // é”™è¯¯æè¿° public var errorDescription: String? { // ... } } extension GWSeverError: CustomNSError {/// The domain of the error. public static var errorDomain: String = \"com.gwm.error.server\" // é”™è¯¯ç  public var errorCode: Int { switch self { // èµ„è®¯è¯„è®ºä¸å­˜åœ¨(å›å¤è¯„è®º) case .newsCommentNotExist: return 710009 // åŠ¨æ€è¯„è®ºä¸å­˜åœ¨(å›å¤è¯„è®º) case .dynamicCommentNotExist: return 712123 // åŠ¨æ€è¯„è®ºä¸å­˜åœ¨(æŸ¥è¯¢è¯„è®º) case .dynamicCommentNotExistOnQuery: return 712197 // åŠ¨æ€ä¸å­˜åœ¨ case .dynamicNotExist: return 712200 case .resultException(let code, msg: _, statusCode: _): return code } } // é”™è¯¯ä¿¡æ¯ public var errorUserInfo: [String: Any] { // ... } } æœåŠ¡ç«¯é€šç”¨é”™è¯¯ å½“æœåŠ¡ç«¯è¿”å›çš„é”™è¯¯ç ä¸åŒ¹é…æˆ‘ä»¬çº¦å®šçš„errorCodeæ—¶ï¼Œæˆ‘ä»¬ç»Ÿä¸€ä½¿ç”¨resultExceptionè¿™ä¸ªæœåŠ¡å™¨é”™è¯¯ï¼ŒresultExceptionæœ‰codeã€msgã€statusCodeä¸‰ä¸ªå…³è”å±æ€§ã€‚ // ä¸šåŠ¡å¼‚å¸¸ static let businessErrors: [GWSeverError] = [ .newsCommentNotExist, .dynamicCommentNotExist, .dynamicNotExist, .dynamicCommentNotExistOnQuery ] // æ ¹æ®codeåŒ¹é…ä¸šåŠ¡å¼‚å¸¸ static func getError(code: Int, msg: String?, statusCode: Int?) -> GWSeverError { if let customError = businessErrors.filter({ $0.errorCode == code }).first { return customError } return .resultException(code: code, msg: msg, statusCode: statusCode) } å¦‚ä½•ä½¿ç”¨ å®¢æˆ·ç«¯é”™è¯¯çš„ä½¿ç”¨ï¼Œä¸‹é¢æ˜¯æ²¡æœ‰ç½‘ç»œçš„æ—¶å€™è¿”å›äº†noNetworkå¼‚å¸¸ï¼š if NetworkReachabilityManager()?.isReachable == false { failedCallBack?(.client(.noNetwork)) return nil } æœåŠ¡ç«¯é”™è¯¯çš„ä½¿ç”¨ï¼Œä¸‹é¢æ˜¯åˆ¤æ–­è¯„è®ºä¸å­˜åœ¨è¿”å›äº†newsCommentNotExistå¼‚å¸¸ï¼š }, onError: { (error) in // åŒ¹é…è‡ªå®šä¹‰é”™è¯¯ if let gwError = error as? GWError { if gwError.code == GWSeverError.newsCommentNotExist.code { observer.onError(GWError.server(.newsCommentNotExist)) observer.onCompleted() return } } observer.onError(GWError.client(.postComment)) observer.onCompleted() }) "},"pages/å…¶ä»–/Swiftæ³¨é‡Š.html":{"url":"pages/å…¶ä»–/Swiftæ³¨é‡Š.html","title":"Swiftæ³¨é‡Š","keywords":"","body":"Swiftæ³¨é‡Š å¿«æ·é”®ï¼š å…‰æ ‡æ”¾åœ¨æ–¹æ³•é‚£ä¸€è¡Œï¼Œoption + command + / å¯ä»¥è‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„æ³¨é‡Š å•è¡Œæ³¨é‡Šï¼š // ä½ è¦æ³¨é‡Šçš„å†…å®¹ å¤šè¡Œæ³¨é‡Šï¼š /* ä½ è¦æ³¨é‡Šçš„å†…å®¹ */ å¤šè¡ŒåµŒå¥—æ³¨é‡Šï¼š /*è¿™æ˜¯ç¬¬ä¸€ä¸ªå¤šè¡Œæ³¨é‡Šçš„å¼€å¤´ /*è¿™æ˜¯ç¬¬äºŒä¸ªè¢«åµŒå¥—çš„å¤šè¡Œæ³¨é‡Š*/ è¿™æ˜¯ç¬¬ä¸€ä¸ªå¤šè¡Œæ³¨é‡Šçš„ç»“å°¾*/ æ–‡æ¡£æ³¨é‡Šï¼š /// - Parameters: å‚æ•° /// - item1: This is item1 /// - item2: This is item2 /// - Returns: the result string. è¿”å›å€¼ /// - Throws: `MyError.BothNilError` if both item1 and item2 are nil. æŠ›å‡ºå¼‚å¸¸ /// - Author: liuyubobobo ä½œè€… - æ— åºåˆ—è¡¨ 1. æœ‰åºåˆ—è¡¨ ``` ä»£ç  # æ ‡é¢˜ * _ ç”¨äºæ–œä½“ ** ç²—ä½“ å…¶å®ƒï¼š // MARK: - Methods // TODO: changeColor() // FIXME: Support Swift 2.2 é™„ï¼š Swift5.1â€”æ³¨é‡Š Swift æ³¨é‡Šè§„èŒƒå’Œæ–‡æ¡£æ³¨é‡Š "},"pages/å…¶ä»–/Universal_Links.html":{"url":"pages/å…¶ä»–/Universal_Links.html","title":"Universal Links","keywords":"","body":"Universal Links https://www.soga.ga/apple-app-site-association å‚è€ƒæ–‡ç«  2020 iOS å¾®ä¿¡åˆ†äº«/Universal Links å‚è€ƒé…ç½® å‚è€ƒé…ç½®2 æµ‹è¯•é“¾æ¥(applinks:soga.ga) å®˜æ–¹æ–‡æ¡£ UniversalLinkså’ŒWeb Credentialsé…ç½® iOSé€šç”¨é“¾æ¥ï¼ˆUniversalLinkï¼‰é…ç½®è¯¦ç»†æµç¨‹ iOS H5æ‰“å¼€App(é€šç”¨é“¾æ¥) https://cdn-h5-html.gwmcloud.com/.well-known/apple-app-site-association Universal Link ç”¨ä¼ä¸šè¯ä¹¦buildåŒ…ï¼Œå¯ä»¥é€šè¿‡é“¾æ¥æ‹‰èµ·ç»‘å®šçš„App(å®¢æˆ·ç«¯) iOS JMLink SDK å¸¸è§é—®é¢˜ iOS 9 é€šç”¨é“¾æ¥ï¼ˆUniversal Linksï¼‰ http://cdn-th-h5-html.gwmcloud.com/.well-known/outlink.html http://cdn-th-h5-html.gwmcloud.com/.well-known/apple-app-site-association "},"pages/å…¶ä»–/Configurations.html":{"url":"pages/å…¶ä»–/Configurations.html","title":"Configurations","keywords":"","body":"Configurations ç”¨xcconfigæ–‡ä»¶é…ç½®iOS appç¯å¢ƒå˜é‡ "},"pages/å…¶ä»–/iOSé›†æˆFlutter.html":{"url":"pages/å…¶ä»–/iOSé›†æˆFlutter.html","title":"iOSé›†æˆFlutter","keywords":"","body":"iOSé›†æˆFlutter flutterå¼€æºåœ°å€ flutterä¸­æ–‡æ–‡æ¡£ flutterè‹±æ–‡æ–‡æ¡£ ä¸€ã€flutterç¯å¢ƒé…ç½® å‚è€ƒ ç¬¬1æ­¥ï¼šä¸‹è½½æœ€æ–°çš„SDK ä¸‹è½½åœ°å€ æˆ‘è¿™é‡ŒSDKæ–‡ä»¶æ”¾åœ¨ç”¨æˆ·ç›®å½•ä¸‹ï¼Œè§£å‹åå¯ä»¥çœ‹åˆ°åœ¨ç”¨æˆ·ç›®å½•ä¸‹å¤šäº†ä¸€ä¸ªflutteræ–‡ä»¶å¤¹ã€‚ ç¬¬2æ­¥ï¼šé…ç½®flutterå‘½ä»¤ åœ¨ç”¨æˆ·ç›®å½•ä¸‹æ‰¾åˆ°.bash_profileï¼Œå¯ä»¥ç›´æ¥ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ï¼Œæˆ–åˆ™ä½¿ç”¨viå‘½ä»¤ï¼š vi ~/.bash_profile åœ¨.bash_profileä¸­å†™å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œå®Œæˆé…ç½® export PATH=~/flutter/bin:$PATH ç¬¬3æ­¥ï¼šæ£€æµ‹flutterå‘½ä»¤ å¸®åŠ© flutter -h flutterå®‰è£…åœ°å€ which flutter dartå®‰è£…åœ°å€ which flutter dart ç¬¬4æ­¥ï¼šè¿è¡Œ flutter doctor å‘½ä»¤ flutter doctor 1.é—®é¢˜1 ğŸ‰ î‚° ~ î‚° flutter doctor Doctor summary (to see all details, run flutter doctor -v): [âœ“] Flutter (Channel stable, 2.2.1, on Mac OS X 10.15.7 19H114 darwin-x64, locale zh-Hans-CN) [âœ—] Android toolchain - develop for Android devices âœ— Unable to locate Android SDK. Install Android Studio from: https://developer.android.com/studio/index.html On first launch it will assist you in installing the Android SDK components. (or visit https://flutter.dev/docs/get-started/install/macos#android-setup for detailed instructions). If the Android SDK has been installed to a custom location, please use `flutter config --android-sdk` to update to that location. [âœ“] Xcode - develop for iOS and macOS [âœ“] Chrome - develop for the web [!] Android Studio (not installed) [âœ“] Connected device (1 available) ! Error: é™ˆé•¿é’çš„ iPhone is not connected. Xcode will continue when é™ˆé•¿é’çš„ iPhone is connected. (code -13) å°†iPhoneè¿æ¥åˆ°ç”µè„‘ï¼Œå¹¶ä¸”è§£é”ï¼Œè§£å†³é—®é¢˜ï¼š ğŸ‰ î‚° ~ î‚° flutter doctor Doctor summary (to see all details, run flutter doctor -v): [âœ“] Flutter (Channel stable, 2.2.1, on Mac OS X 10.15.7 19H114 darwin-x64, locale zh-Hans-CN) [âœ—] Android toolchain - develop for Android devices âœ— Unable to locate Android SDK. Install Android Studio from: https://developer.android.com/studio/index.html On first launch it will assist you in installing the Android SDK components. (or visit https://flutter.dev/docs/get-started/install/macos#android-setup for detailed instructions). If the Android SDK has been installed to a custom location, please use `flutter config --android-sdk` to update to that location. [âœ“] Xcode - develop for iOS and macOS [âœ“] Chrome - develop for the web [!] Android Studio (not installed) [âœ“] Connected device (2 available) 1.é—®é¢˜2 [âœ—] Android toolchain - develop for Android devices âœ— Unable to locate Android SDK. Install Android Studio from: https://developer.android.com/studio/index.html On first launch it will assist you in installing the Android SDK components. (or visit https://flutter.dev/docs/get-started/install/macos#android-setup for detailed instructions). If the Android SDK has been installed to a custom location, please use `flutter config --android-sdk` to update to that location. äºŒã€è®¾ç½® iOS å¼€å‘ç¯å¢ƒ ç¬¬1æ­¥ï¼šå®‰è£… Xcode 1.é€šè¿‡ ç›´æ¥ä¸‹è½½ æˆ–è€…é€šè¿‡ Mac App Store æ¥å®‰è£…æœ€æ–°ç¨³å®šç‰ˆ Xcode 2.é€šè¿‡åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥é…ç½® Xcode command-line tools: sudo xcode-select --switch /Applications/Xcode.app/Contents/Developer sudo xcodebuild -runFirstLaunch å½“ä½ å®‰è£…äº†æœ€æ–°ç‰ˆæœ¬çš„ Xcodeï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„è·¯å¾„éƒ½æ˜¯ä¸€æ ·çš„ã€‚ä½†å¦‚æœä½ å®‰è£…äº†ä¸åŒç‰ˆæœ¬çš„ Xcodeï¼Œä½ å¯èƒ½è¦æ›´æ”¹ä¸€ä¸‹ä¸Šè¿°å‘½ä»¤ä¸­çš„è·¯å¾„ã€‚ 3.è¿è¡Œä¸€æ¬¡ Xcode æˆ–è€…é€šè¿‡è¾“å…¥å‘½ä»¤ sudo xcodebuild -license æ¥ç¡®ä¿å·²ç»åŒæ„ Xcode çš„è®¸å¯åè®®ã€‚ ç¬¬2æ­¥ï¼šé…ç½® iOS æ¨¡æ‹Ÿå™¨ open -a Simulator ä¸‰ã€åˆ›å»ºå¹¶è¿è¡Œä¸€ä¸ªç®€å•çš„ Flutter åº”ç”¨ é€šè¿‡ä»¥ä¸‹æ­¥éª¤æ¥åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ª Flutter åº”ç”¨å¹¶è¿›è¡Œæµ‹è¯•ï¼š 1.é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ Flutter åº”ç”¨ï¼š flutter create my_app 2.ä¸Šè¿°å‘½ä»¤åˆ›å»ºäº†ä¸€ä¸ª my_app çš„ç›®å½•ï¼ŒåŒ…å«äº† Flutter åˆå§‹çš„åº”ç”¨æ¨¡ç‰ˆï¼Œåˆ‡æ¢è·¯å¾„åˆ°è¿™ä¸ªç›®å½•å†…ï¼š cd my_app 3.ç¡®ä¿æ¨¡æ‹Ÿå™¨å·²ç»å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨åº”ç”¨ï¼š flutter run é—®é¢˜1: ğŸ‰ î‚° ~/Desktop/ä»£ç /flutter/my_app î‚° flutter run Multiple devices found: é™ˆé•¿é’çš„ iPhone (mobile) â€¢ ac82c56391c359c3313eb0f84cfe5f9c6fb45ca5 â€¢ ios â€¢ iOS 14.4.2 iPhone 12 Pro Max (mobile) â€¢ 4594BEED-D4F8-4CE4-A566-BF483F2A7565 â€¢ ios â€¢ com.apple.CoreSimulator.SimRuntime.iOS-14-4 (simulator) Chrome (web) â€¢ chrome â€¢ web-javascript â€¢ Google Chrome 90.0.4430.212 [1]: é™ˆé•¿é’çš„ iPhone (ac82c56391c359c3313eb0f84cfe5f9c6fb45ca5) [2]: iPhone 12 Pro Max (4594BEED-D4F8-4CE4-A566-BF483F2A7565) [3]: Chrome (chrome) Please choose one (To quit, press \"q/Q\"): è¿™é‡Œç›´æ¥é€‰æ‹©2ï¼Œ2æ˜¯æˆ‘åˆšæ‰æ‰“å¼€çš„æ¨¡æ‹Ÿå™¨ï¼Œæ¥ä¸‹æ¥ä¼šçœ‹åˆ°ï¼š Please choose one (To quit, press \"q/Q\"): 2 Launching lib/main.dart on iPhone 12 Pro Max in debug mode... Running Xcode build... â””â”€Compiling, linking and signing... 10.8s Xcode build done. 39.8s Syncing files to device iPhone 12 Pro Max... 89ms Flutter run key commands. r Hot reload. ğŸ”¥ğŸ”¥ğŸ”¥ R Hot restart. h Repeat this help message. d Detach (terminate \"flutter run\" but leave application running). c Clear the screen q Quit (terminate the application on the device). ğŸ’ª Running with sound null safety ğŸ’ª An Observatory debugger and profiler on iPhone 12 Pro Max is available at: http://127.0.0.1:54602/2Xt-Ae85-qk=/ Activating Dart DevTools... 24.5s The Flutter DevTools debugger and profiler on iPhone 12 Pro Max is available at: http://127.0.0.1:9100?uri=http%3A%2F%2F127.0.0.1%3A54602%2F2Xt-Ae85-qk%3D%2F è¿™ä¸ªæ—¶å€™ï¼Œåˆ‡æ¢è‡³æ¨¡æ‹Ÿå™¨ï¼Œå°±å¯ä»¥çœ‹åˆ°åº”ç”¨çš„ç•Œé¢äº†ï¼ æ³¨æ„ï¼šå¦‚æœé€‰æ‹©1çœŸæœºçš„è¯ï¼Œéœ€è¦æ‰“å¼€Runner.xcworkspaceï¼Œåœ¨xcodeä¸­é…ç½®å¥½è¯ä¹¦æè¿°æ–‡ä»¶ã€‚ å››ã€è§£å†³ç°æœ‰flutteré¡¹ç›®é—®é¢˜ é—®é¢˜1 Invalid Podfile file: cannot load such file -- ../my_flutter/.ios/Flutter/podhelper.rb. å‚è€ƒ é—®é¢˜2 Version solving failed. #18937 é—®é¢˜3 pub get failed (server unavailable) é—®é¢˜4 Include of non-modular header inside framework module error "},"pages/å…¶ä»–/è£…æœºå¿…å¤‡.html":{"url":"pages/å…¶ä»–/è£…æœºå¿…å¤‡.html","title":"è£…æœºå¿…å¤‡","keywords":"","body":"è£…æœºå¿…å¤‡ ä¸€ã€å‡çº§ç³»ç»Ÿ Macç³»ç»Ÿå¦‚ä½•æ˜¾ç¤ºéšè—æ–‡ä»¶ macè½¯ä»¶ç½‘å€ xcodeä¸‹è½½ å¦‚ä½•ç”Ÿæˆ SSH å¯†é’¥ äºŒã€è§¦æ‘¸æ¿è®¾ç½® è½»ç‚¹æ¥ç‚¹æŒ‰ï¼šä¸ç”¨æŒ‰å‹è§¦æ‘¸æ¿å³å¯ç‚¹å‡» ä¸‰æŒ‡æ‹–æ‹½ï¼šè¾…åŠ©åŠŸèƒ½->æŒ‡é’ˆæ§åˆ¶->è§¦æ‘¸æ¿é€‰é¡¹->é¼ æ ‡ä¸è§¦æ‘¸æ¿->å¯ç”¨æ‹–åŠ¨->ä¸‰æŒ‡æ‹–ç§» ä¸‰ã€è½¯ä»¶å®‰è£… Amphetamineï¼šé˜»æ­¢macç¡çœ  Sourcetreeï¼šä»£ç ç®¡ç† The Unarchiverï¼šè§£å‹ç¼© Google Chromeï¼šæµè§ˆå™¨ ClashXï¼šç¿»å¢™ DevCleanerï¼šæ¸…ç†Xcode Xcodeï¼šå¼€å‘ Sumblime Textï¼šæ–‡æœ¬ç¼–è¾‘ OmniDiskSweeper TeamViewer royaltsxï¼šæœåŠ¡å™¨ä¸Šä¼  AE/AI/DW/InDesign/PR/Sketch/Principle/å­—é­‚ï¼šè®¾è®¡ç±» Word/Excel/PPTï¼šå¾®è½¯ MenuMetersï¼šç›‘æ§CPU aifred3ï¼šçº¢å¸½å­ oh-my-zsh/iTermï¼šå‘½ä»¤è¡Œ SwitchHostsï¼šåˆ‡Host My Hosts 185.199.108.133 raw.githubusercontent.com 199.232.68.133 user-images.githubusercontent.com 199.232.68.133 avatars2.githubusercontent.com 199.232.68.133 avatars1.githubusercontent.com Postmanï¼šè¯·æ±‚æµ‹è¯• SwiftFormat for Xcode OBSï¼šå½•å±å¹• MachOView/iOS App Signerï¼šè¶Šç‹± DeepLï¼šç¿»è¯‘ Wacomï¼šæ•°ä½æ¿ Woodpeckerï¼šiOSå±å¹•æµ‹è¯• libreofficeï¼šæ‰“å¼€word Paintbrushï¼šç”»æ¿ Vysorï¼šAndroidæ‰‹æœºæŠ•å±ç”µè„‘ Android File Transferï¼šAndroidæ•°æ®ä¼ è¾“ VLC media player Charles WiresShark å››ã€å®‰è£…brew macoså¦‚ä½•ç§‘å­¦çš„å®‰è£…homebrewè·Ÿnpm? brew update æŠ¥é”™ \"fatal: Could not resolve HEAD to a revision\" å®‰è£…brewçš„æ­£ç¡®å§¿åŠ¿ Macå®‰è£…gitï¼Œbrewå‡ºç°çš„é—®é¢˜ äº”ã€å®‰è£…node MAC å®‰è£…BREWè·ŸNODE macç®¡ç†åŠæ›´æ–°nodeç‰ˆæœ¬ å…­ã€å®‰è£…gitbook GitBook å®‰è£…ä»¥åŠä½¿ç”¨ å®‰è£…Gitbook GitBookå¿«é€Ÿç”ŸæˆPDF é…ç½®ebooké—®é¢˜ $ sudo ln -s ~/Applications/calibre.app/Contents/MacOS/ebook-convert /usr/bin ä¸ƒã€å®‰è£…CocoaPods rubyç®¡ç† iOS å®‰è£…CocoaPods ä¸´æ—¶è§£å†³GitHubçš„raw.githubusercontent.comæ— æ³•è¿æ¥é—®é¢˜ å…«ã€å®‰è£…PS Adobe Photoshop 2021 For Mac v22.3 PSä¸­æ–‡ç ´è§£ç‰ˆ ä¹ã€Flutter flutter2.2.1 "},"pages/å…¶ä»–/å¸¸ç”¨é“¾æ¥.html":{"url":"pages/å…¶ä»–/å¸¸ç”¨é“¾æ¥.html","title":"å¸¸ç”¨é“¾æ¥","keywords":"","body":"å¸¸ç”¨é“¾æ¥ iOSÂ·é—®é¢˜æ±‡æ€» UITextField PlaceHolderå±…ä¸­æ˜¾ç¤ºé—®é¢˜ iOS 10ã€è®¾ç½®å¯¼èˆªæ å…¨é€æ˜ ä¸¤ç§iOSéšè—å¯¼èˆªæ çš„æ­£ç¡®æ–¹æ³• è®©è¶…å‡ºçˆ¶è§†å›¾èŒƒå›´çš„å­è§†å›¾å“åº”äº‹ä»¶ï¼Œåœ¨UIViewèŒƒå›´å¤–å“åº”ç‚¹å‡» iOSæ—¶é—´çš„å¤„ç† ios æ¶ˆé™¤ å­—ç¬¦ä¸² é¦–å°¾ç©ºæ ¼ iOSä¼˜ç¾çš„ä¾§æ»‘è¿”å›FDFullscreenPopGesture iOS è®¾ç½®å±å¹•å¸¸äº®ï¼Œå»¶é•¿ä¼‘çœ æ—¶é—´ arm64ã€armv7ã€armv7s iOSè·å–æ‰‹æœºå‹å· Cannot find protocol definition for XXX ios â€“ å¥‡æ€ªçš„UIView-Encapsulated-Layout-Heighté”™è¯¯ fix:iOS 13.1.3,textViewç‚¹å‡»å›è°ƒ3æ¬¡ \"Double-quoted\" issue in latest version of Firebase remå¸ƒå±€åœ¨webviewä¸­é¡µé¢é”™ä¹±è§£å†³åŠæ³• è§£æ±ºUIWebView target = '_blank'ä¸èƒ½å½ˆå‡º Cocoapod with optional subspecs is not installing, if subspecs in the Podfile and another dependent Cocoapod podspec doesn't match Can I have an init func in a protocol? æ„é€ æ–¹æ³•ä¸è§¦å‘didSet iOS9ä¸­è°ƒç”¨å…¶ä»–APPæ—¶å‡ºç°This app is not allowed to query å¾®ä¿¡æ€ä¹ˆå”¤èµ·app? facebooké“¾æ¥ä¸­åˆ†äº«çš„å›¾ç‰‡ lineé“¾æ¥ä¸­åˆ†äº«çš„å›¾ç‰‡ Swift - encode URL Class Only Protocols In Swift 5 gitåˆ é™¤è¿œç¨‹åˆ†æ”¯æŠ¥é”™:remote ref does not exist ERROR | [iOS] unknown: Encountered an unknown error (/usr/bin/xcrun simctl list -j devices Macè§£ç–‘ï¼šå¤„ç† Adobe Genuine Software Integrity Service assigning to â€˜NSString *_strongâ€™ from â€˜const NSStringâ€™ discards qualifiers iOS10 NSLogé™åˆ¶ä¸º1024ä¸ªå­—ç¬¦å­—ç¬¦ä¸² Auto property synthesis will not synthesize property â€˜delegateâ€™;it will be implemented by its superc NSPredicate è°“è¯ æ›´æ”¹ macOS ç”¨æˆ·å¸æˆ·å’Œä¸ªäººæ–‡ä»¶å¤¹çš„åç§° è‹¹æœ iOS 13 æ–°å¢çš„ sign with Apple API æ˜¯å¦‚ä½•å®ç°éšç§ä¿æŠ¤çš„ï¼Ÿ Xcode 11æ–°å»ºé¡¹ç›®å¤šäº†Scenedelegate ä½¿ç”¨ Xcode 13.2.1 å’Œ iOS 15.4 è®¾å¤‡ åœ†è§’å’Œé˜´å½±å¹¶å­˜ï¼ˆSwiftå’ŒOCï¼‰ Swiftlint warning : For Where Violation: where clauses are preferred over a single if inside a for. (for_where) ã€iosã€‘_UITemporaryLayoutWidthæ˜¯ä»€éº¼ï¼Œç‚ºä»€éº¼å®ƒæ‰“ç ´äº†æˆ‘çš„ç´„æŸï¼Ÿ Git æäº¤é”™äº†ä¸ç”¨æ…Œï¼Œè¿™ä¸‰æ‹›å¸®ä½ ä¿®æ”¹è®°å½• è§£å†³Xcode14 podç­¾åé—®é¢˜ iOS UILabel æ·»åŠ æŸ¥çœ‹æ›´å¤š UILabelä¸­çš„NSAttributedStringå°¾éƒ¨æˆªæ–­ UITableViewæˆ–UICollectionViewçš„cellä¸­åµŒå¥—UICollectionViewå,ç¬¬äºŒå±‚çš„CollectionViewCellç‚¹å‡»æ— å“åº”çš„é—®é¢˜ ScrollViewåµŒå¥— iOSå¼€å‘å®æˆ˜ - è§£å†³UIScrollViewåµŒå¥—æ»‘åŠ¨æ‰‹åŠ¿å†²çª LYEmbedScrollView JXCategoryView MXParallaxHeader å…³äºåµŒå¥—æ»šåŠ¨ç°å®çš„è®¨è®º iOSÂ·æ–°çŸ¥è¯† ä½¿ç”¨ Swift Package Manager é›†æˆä¾èµ–åº“ SwiftåŒ–é›¶ä¸ºæ•´ï¼šReduceæ–¹æ³•è¯¦è§£ swift3.0ä¸­fileprivateï¼Œprivateä½¿ç”¨ Swiftä¸æ³›å‹ç¼–ç¨‹ç¬¬å››å¼¹ï¼šç±»å‹æ“¦é™¤ iOS æ’ä»¶åŒ–å¼€å‘(åŠ¨æ€åº“ç ”ç©¶) åœ¨ iOS ä¸Šä¸‹è½½æ–‡ä»¶ iOSå½’æ¡£çœ‹è¿™ç¯‡å°±å¤Ÿäº† ios - Swift URLæŸ¥è¯¢å­—ç¬¦ä¸²è·å–å‚æ•° Swiftæ‰“å°å˜é‡å†…å­˜åœ°å€ swiftå°çŸ¥è¯†ç‚¹ä¹‹æ‰“å°å¯¹è±¡çš„åœ°å€ Swift å¦‚ä½•å£°æ˜æŸä¸ªå±æ€§å·²è¿‡æœŸ swift5.0 å­—ç¬¦ä¸²æˆªå– iOSå¼€å‘ä¹‹å­—ç¬¦ä¸²(NSString)çš„æ‹¼æ¥ iOS - NSDateåˆ†ç±»-åˆ¤æ–­æ—¶é—´æ˜¯å¦ä¸ºä»Šå¤©,æ˜¨å¤©,ä¸€å‘¨å†…,å¹´æœˆæ—¥ IOS ä¿ç•™å°æ•°ç‚¹åå‡ ä½ Swiftå¼€å‘å°æŠ€å·§ç³»åˆ— - æµ®ç‚¹å‹æ•°æ®çš„å››èˆäº”å…¥ UIPresentationControllerç®€ä»‹ ä¸è¦ç”¨å­ç±»ï¼Swiftçš„æ ¸å¿ƒæ˜¯é¢å‘åè®® APPé€Ÿåº¦ä¼˜åŒ–--å¯åŠ¨ä¼˜åŒ– Swiftåªæœ‰ä¸ŠåŠéƒ¨åˆ†åœ†è§’View XCodeæ¨¡æ‹Ÿå™¨å±å¹•å½•åˆ¶/å½•å± UIViewçš„autoresizingMask å…³äºSwiftï¼šå¦‚ä½•å¯¹æ•°ç»„è¿›è¡Œåˆ†ç»„ SnapKit å…³äºæ•°ç»„Arrayçš„æ‰©å±•â€”â€” è‡ªé€‚åº”å®½åº¦ã€å‚ç›´ã€æ°´å¹³ã€ä¹å®«æ ¼å¸ƒå±€ do whileå¦™ç”¨ iOSä¸­å–æ¶ˆå»¶è¿Ÿæ‰§è¡Œå‡½æ•° iOS é˜¿æ‹‰ä¼¯è¯­ RTLé€‚é… Swift - å®ç°å›¾ç‰‡ï¼ˆUIImageï¼‰çš„æ°´å¹³ç¿»è½¬(é•œåƒ)ï¼Œå‚ç›´ç¿»è½¬ UIViewåŠ¨ç”» Swift å›¾ç‰‡æ‹‰ä¼¸ï¼Œå±¡è¯•ä¸çˆ½ï¼ï¼ï¼ ä¸ºä»€ä¹ˆæˆ‘ä»¬åº”è¯¥é¿å…åœ¨ Swift ç»“æ„ä¸­ä½¿ç”¨é—­åŒ…ï¼Ÿ CocoaPodsæ¸…ç†æœ¬åœ°ç¼“å­˜ ExclusiveTouch OCä¸­åŸºäºRuntimeæœºåˆ¶hookå‡½æ•°çš„å¤šç§æ–¹æ³• iOSè‡ªå®šä¹‰TableViewç´¢å¼• è‡ªå®šä¹‰æ¨¡æ¿ iOS é«˜æ•ˆå¼€å‘ä¹‹ - 3åˆ†é’Ÿå®ç°è‡ªå®šä¹‰ Xcode åˆå§‹åŒ–çš„æ¨¡æ¿ Xcode è‡ªå®šä¹‰æ¨¡æ¿ iOSÂ·å®¡æ ¸ æ£€æŸ¥iOSé¡¹ç›®ä¸­æ˜¯å¦è¿˜æœ‰ä½¿ç”¨UIWebView iOS APPå†…æµ‹é‚€è¯·ä¹‹TestFlight iOSÂ·å¤šçº¿ç¨‹ å®ç°è‡ªå®šä¹‰NSOperation å¼€å§‹ä½¿ç”¨Operation Queueå§ iOSå¼€å‘ è‡ªå®šä¹‰NSOPeration NSOperation property overrides (isExecuting / isFinished) å¹¶å‘æ•™ç¨‹ iOS å¤šçº¿ç¨‹ - Operation iOSÂ·æ€§èƒ½ä¼˜åŒ– iOS å…³äºåå°æŒç»­è¿è¡Œ iOSæ€§èƒ½ä¼˜åŒ– iOSæŒ‰é’®å€’è®¡æ—¶åœ¨è¿›å…¥åå°ä¸ç»§ç»­è®¡æ—¶çš„å¤„ç† iOS åå°æ•°æ®å¤„ç† background fetch åŠ¨ç”» iOSåŠ¨ç”»äº‹ç‰©ï¼ˆCATransactionï¼‰ å·¥å…· ç†ŠçŒ«å‹ç¼© è¿œç¨‹ udidè·å– JSONæ ¼å¼åŒ– ä»£ç æ ¼å¼åŒ–æ’ä»¶ Appå›¾æ ‡åœ¨çº¿åˆ¶ä½œ å‹ç¼©ä¸€ä¸ªPDFæ–‡ä»¶ UIImage äºŒåˆ†å‹ç¼©å›¾ç‰‡ Woodpeckeâ€ªrâ€¬ å›¾ç‰‡è£å‰ª ä¸´æ—¶é‚®ç®±ã€ä¸´æ—¶é‚®ã€ä¸´æ—¶ç”µå­é‚®ç®±ã€24å°æ—¶é‚®ç®± JSONæ ¼å¼åŒ– Woodpeckerä½¿ç”¨ Xcodeè‡ªå®šä¹‰ä»£ç å— æ—¶é—´æˆ³cuo google play store é¢œè‰²ä»£ç è¡¨ é˜¿é‡Œç½‘ç›˜èµ„æº åœ¨çº¿å·¥å…· è¯­æ³•æ£€æŸ¥ Gitbook æ–°ç‰ˆgitbookå¯¼å‡ºpdf gitbookæ•™ç¨‹ æ¨è12ä¸ªå®ç”¨çš„gitbookæ’ä»¶ mermaidæ’ä»¶ mermaid-gb3 mermaidæ–‡æ¡£ GitBook æ’ä»¶ PlantUML ç®€ä»‹ GitBookW3C Gitbookè¯¦è§£ï¼ˆå››ï¼‰-é…ç½®å’Œè¯´æ˜è¯¦è§£ å®šä¹‰å³é¢é¡µé¢çš„å®½åº¦ npmjs GitBook æœ¬åœ°ä½¿ç”¨æ’é›·ï¼ŒåŠå¯¼å‡ºåŸºæœ¬å¯ç”¨çš„ PDF ç‰ˆæœ¬ æ¡ˆä¾‹ ç™¾åº¦ç»Ÿè®¡ Gitbook é™æ€ç«™ç‚¹ åŠ å…¥è°·æ­Œåˆ†æç­‰ç½‘ç«™ç»Ÿè®¡ä»£ç  ç™¾åº¦ç»Ÿè®¡åŠ©æ‰‹ ç™¾åº¦ç»Ÿè®¡åå° Markdown ç”¨ Markdown åˆ¶ä½œç®€å† Markdown Guide MarkDownä»£ç å—é«˜äº® åœ¨ markdown ä¸­ç”Ÿæˆå¹¶å¯¼å‡ºæ€ç»´å¯¼å›¾çš„ Gitbook æ’ä»¶ gitbook 3.2.3åŠä¹‹åæµç¨‹å›¾è§£å†³æ–¹æ¡ˆ Markdown ä¸­æ–‡æ–‡æ¡£ markdownç¼–è¾‘ å­¦ç”Ÿã€å·¥ä½œäººå£«å¦‚ä½•æ‰èƒ½æ›´ä¼˜é›…åœ°è®°ç¬”è®°ã€å†™æ–‡æ¡£?ï¼ˆMarkdownæ•™ç¨‹ï¼Œè¯¦ç»†åˆ°è¶…ä¹ä½ æƒ³è±¡ï¼‰ ä½¿ç”¨ Markdown æ—¶ï¼Œå¦‚ä½•ä¸ºæ–‡å­—åŠ ä¸‹åˆ’çº¿ï¼Ÿ Markdown ç®€ä»‹ MarkDownä¸­å¦‚ä½•æ¢è¡Œï¼Ÿ ç®€å† iOSç¨‹åºå‘˜ç®€å†æ¨¡æ¿ å¥½çœ‹çš„åšå®¢ bawn YouXianMing ç¬‘å¿˜ä¹¦åº— å…«å¹´iOSæ¶æ„å¸ˆæ•™ä½ å¦‚ä½•ä¸€ä¸¾æ‹¿ä¸‹iOSå·¥ç¨‹å¸ˆçš„Offer,ï¼ˆé™„é¢è¯•æŠ€å·§ï¼‰ Cocoapods CocoaPodså®‰è£…æ–¹æ³•-2020.05.25 XCode 10ä¸­ä¿®æ”¹cocoapodsä¸­çš„æºç ç¼–è¯‘ä¸ç”Ÿæ•ˆçš„è§£å†³æ–¹æ³• Cocoapodsæ•´ç†ï¼ˆä¸‰ï¼‰â€”â€”ç¼–å†™podspecæ–‡ä»¶ è£…æœºæ­¥éª¤ iOS å®‰è£…CocoaPods Macç³»ç»Ÿå¦‚ä½•æ˜¾ç¤ºéšè—æ–‡ä»¶ ä¸´æ—¶è§£å†³GitHubçš„raw.githubusercontent.comæ— æ³•è¿æ¥é—®é¢˜ Macå®‰è£…gitï¼Œbrewå‡ºç°çš„é—®é¢˜ macoså¦‚ä½•ç§‘å­¦çš„å®‰è£…homebrewè·Ÿnpm? å®‰è£…brewçš„æ­£ç¡®å§¿åŠ¿ GitBook å®‰è£…ä»¥åŠä½¿ç”¨ macç®¡ç†åŠæ›´æ–°nodeç‰ˆæœ¬ å®‰è£…Gitbook macè½¯ä»¶ç½‘å€ xcodeä¸‹è½½ å¼€æºé¡¹ç›® iOSExperience functionList GitBook ä¸Šæœ‰å“ªäº›ååˆ†ä¼˜ç§€çš„å·²ç»å®Œæˆçš„ä¹¦ï¼Ÿ æ»´æ»´çš„å“†å•¦Aæ¢¦ç»„ä»¶ iOS æ‰“ç‚¹ é—ªå±demo QGTextField URLNavigator ç½‘ç»œç›‘æ§ Swift-30-Projects iOSKeyPointExploration è¯­æ³•ç³– TTBaseUIKit GAppFramework SwiftTheme NerdyUI Tangram-iOS YNSearch IOSç½‘ç»œè¯·æ±‚çš„ç®€å•å°è£…è®¾è®¡ YTKNetwork QMUI_iOS ä»£ç åˆ†ç±» å¥½åº“ç¼–ç¨‹ç½‘ SDUserDefaults LCHelper geniusDemo 2018 iOS ä¸‰æ–¹åº“(ä»…ä¾›æ–¹é¢æŸ¥çœ‹) macos 12.3.1 Xcode 13.3 æœ€æ–°objc 838æºç æ›´æ–° å›½å®¶icon Stevia MVVM MVVMReactiveCocoa BigShow1949 Monkey MHDevelopExample_Objective_C MVVMDemo åœ°å›¾ map BMKLocationKit iOSåœ¨APPä¸­è°ƒç”¨ç¬¬ä¸‰æ–¹åœ°å›¾åœ°å›¾ï¼ˆè‹¹æœ,é«˜å¾·ï¼Œç™¾åº¦ï¼Œè…¾è®¯ï¼‰ ç»çº¬åº¦æŸ¥è¯¢ å­¦ä¹  å°šå¾· è‡ªè€ƒ æ½­å·è¯¾å ‚ swift51 csdn è‹¹æœå®˜æ–¹æ–‡æ¡£ è‹¹æœå®˜æ–¹æ–‡æ¡£-cn è‹¹æœå®˜æ–¹æ–‡æ¡£-en ios-resolution æŸ¥è¯¢åºåˆ—å· OpenGL iOS-OpenGL-Tutorials OpenGLES RxSwift Swift - RxSwiftçš„ä½¿ç”¨è¯¦è§£1ï¼ˆåŸºæœ¬ä»‹ç»ã€å®‰è£…é…ç½®ï¼‰ RxSwiftçš„å­¦ä¹ ä¹‹è·¯ï¼ˆäºŒï¼‰â€”â€”Subjects ä½¿ç”¨ RxTest æ¥å»ºç«‹åŸºäº RxSwift çš„è‡ªåŠ¨åŒ–æµ‹è¯• RxSwiftä¸­æ–‡æ–‡æ¡£ RxSwiftå­¦ä¹  - share(replay:scope:) RXSwiftä¸­Driverçš„ä½¿ç”¨ RxSwift+Moyaç½‘ç»œè¯·æ±‚ä¹‹é¡¹ç›®å®æˆ˜ RxMultiCounter RxSwift Error Handling RxDataSource ä½¿ç”¨å¥—è·¯ä¸è§£é‡Š RxSwift ä¸­çš„è€å¸æœº VPN cx vpnÂ·å‘¨ vpnÂ·æ æœ‰å…è´¹çš„æ¢¯å­è½¯ä»¶ å¯¼èˆªæ  iOSç³»ç»Ÿä¸­å¯¼èˆªæ çš„è½¬åœºè§£å†³æ–¹æ¡ˆä¸æœ€ä½³å®è·µ IOS-FDFullscreenPopGestureçš„ä½¿ç”¨ æˆ‘çš„iOSå¼€å‘ç¬”è®°â€”â€”å³æ»‘è¿”å›æ‰‹åŠ¿å¤±æ•ˆæ€ä¹ˆåŠï¼Ÿ iOS å¯¼èˆªæ çš„é‚£äº›äº‹å„¿ Swift - å¯¼èˆªæ æ»‘åŠ¨é€æ˜æ¸å˜æ•ˆæœçš„å®ç°ï¼ˆé€æ˜åº¦éšè§†å›¾æ»šåŠ¨è€Œæ”¹å˜ï¼‰ iOSÂ·UI è¯¦è§£intrinsicContentSize åŠ çº¦æŸä¼˜å…ˆçº§ï¼content Huggingï¼content Compression Resistance iOSå¼€å‘ç¬”è®°å¸¸ç”¨å·¥å…·ä¹‹æ–‡æœ¬å®½åº¦å’Œé«˜åº¦è®¡ç®— iOS è·å–webviewé«˜åº¦å°ç»“ iOS Swift åˆ¤æ–­æ‰‹æœºæœºå‹ å·²æ›´æ–° è‡³iPhone12 iOSåˆ¤æ–­åˆ˜æµ·å±å¹•æœºå‹ æ‰€æœ‰æœºå‹ iOS è®¾ç½®åœ†è§’ã€æŒ‡å®šä½ç½®åœ†è§’åŠ iOS 11åœ†è§’è®¾ç½® iOS9 Programming - Autolayout (I) è„šæœ¬ sudo pip install openpyxl å¿«æ·é”® æ³¨é‡Šï¼šcommand+option+/ æ‰“å¼€xcodeæ–‡æ¡£ï¼šcommand+shift+0 ç°åœ¨åœ¨Xcodeä¸­åˆ‡æ¢æ ‡ç­¾çš„å¿«æ·æ–¹å¼ï¼Ÿ Android Studioå¸¸ç”¨å¿«æ·é”®æ±‡æ€»ï¼ˆmacï¼‰ Flutter Flutter å¼€å‘æ–‡æ¡£ å…¶å®ƒ åŒ»é™¢ç­‰çº§æŸ¥è¯¢ å¿«é€Ÿè®° shell Shell å‡½æ•° shellè„šæœ¬ä¸­åˆ¤æ–­ä¸Šä¸€ä¸ªå‘½ä»¤æ˜¯å¦æ‰§è¡ŒæˆåŠŸ shell bashåˆ¤æ–­æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ shellè„šæœ¬ï¼šåˆ é™¤å½“å‰ç›®å½•ä¸‹é™¤äº†æŸå‡ ä¸ªæ–‡ä»¶ä¹‹å¤–çš„å…¶ä»–æ–‡ä»¶ ruby Ruby æ•™ç¨‹ webviewç¼“å­˜ iOS html5ä½¿ç”¨ç¼“å­˜å¹¶åŠæ—¶æ›´æ–°æ–¹æ¡ˆæ€»ç»“ Cache-control iOS webViewç¼“å­˜ï¼Œä¿è¯åŠ è½½æœ€æ–°html iOS: èŠèŠ UIWebView ç¼“å­˜ H5 å’Œç§»åŠ¨ç«¯ WebView ç¼“å­˜æœºåˆ¶è§£æä¸å®æˆ˜ iOS-WKWebViewç¼“å­˜å¹¶ä¿è¯å®æ—¶æ€§ iOSä»£ç æ··æ·†å·¥å…· webviewå¼€å¯æ— å›¾ iOSå®šåˆ¶NSURLProtocolå®ç°ç¦»çº¿ç¼“å­˜ webç¦»çº¿æŠ€æœ¯åŸç† iOS å¼€å‘ä¸­ä½¿ç”¨ NSURLProtocol æ‹¦æˆª HTTP è¯·æ±‚ ä½¿ç”¨ NSURLProtocol æ‹¦æˆª APP å†…çš„ç½‘ç»œè¯·æ±‚ ç§»åŠ¨ H5 é¦–å±ç§’å¼€ä¼˜åŒ–æ–¹æ¡ˆæ¢è®¨ JWNetAutoCache tableView https://www.jianshu.com/p/af4bc69839d8 ä¼˜åŒ–UITableViewCellé«˜åº¦è®¡ç®—çš„é‚£äº›äº‹ ä»£ç è§„èŒƒ ã€ŠEffective Objective-Cã€‹å¹²è´§ä¸‰éƒ¨æ›²ï¼ˆäºŒï¼‰ï¼šè§„èŒƒç¯‡ Swift å¦‚ä½•å£°æ˜æŸä¸ªå±æ€§å·²è¿‡æœŸ å•å…ƒæµ‹è¯• iOS å•å…ƒæµ‹è¯•--å¼‚æ­¥æµ‹è¯• OCå®ç°ç±»ä¼¼æ³›å‹æ•ˆæœçš„jsonæ•°æ®è§£æ æ¶æ„ iOSåº”ç”¨æ¶æ„è°ˆ ç½‘ç»œå±‚è®¾è®¡æ–¹æ¡ˆ iOS - AFNetWorkingæ‰“å°è¯·æ±‚æ—¶çš„ç›¸å…³ä¿¡æ¯ ä¸€é”®ç™»å½• IOSå®¢æˆ·ç«¯æ¥å…¥ gcd iOS GCDå¤„ç†å¤šä¸ªç½‘ç»œè¯·æ±‚å¹¶å‘é—®é¢˜ iOS-GCDçš„ä¸²è¡Œé˜Ÿåˆ—å’Œå¹¶è¡Œé˜Ÿåˆ—çš„ä»»åŠ¡åŠå®ç° iOS GCDçº¿ç¨‹åŒæ­¥ä»¥åŠAFNetworkingå¤šæ¬¡è¯·æ±‚çº¿ç¨‹ä¾èµ– c++ C++ ä¸­çš„ inline ç”¨æ³• åœ¨å­—ç¬¦ä¸²stringä¸­å®ç°ä¸€ä¸ªåˆ¤æ–­å‡½æ•°ï¼Œè¯¥å‡½æ•°åŠŸèƒ½æ˜¯ç»Ÿè®¡æŸä¸€å­—ç¬¦ä¸²ç±»å¯¹è±¡(ä»…ç”±å•è¯å’Œç©ºæ ¼ç»„æˆ)æœ‰å¤šå°‘ä¸ªå•è¯ IMèŠå¤© ç¯ä¿¡Â·IM ç¯ä¿¡Â·iOS SDK å¿«é€Ÿé›†æˆ ç¯ä¿¡Â·é›†æˆ iOS SDK å‰çš„å‡†å¤‡å·¥ä½œ ç”µå½± ä½ çš„åå­— åç«¯ docker è…¾è®¯äº‘ ç®—æ³• ç®—æ³•å­¦ä¹ ç¬”è®°ï¼ˆç›®å½•ï¼‰ èœé¸Ÿç®—æ³• Swift - Codable Swift - Codableä½¿ç”¨å°è®° Swift - Codable textview iOSå¼€å‘ï¼UITextViewæ–‡å­—æ’ç‰ˆ UITextViewæ¢è¡Œé—®é¢˜è§£å†³åŠæ³• android studio ç”¨æˆ·æŒ‡å— é˜¿è¯­é€‚é… iOS å›½é™…åŒ– - é˜¿æ‹‰ä¼¯è¯­çš„RTL è¸©å‘å¿ƒå¾— Working with Unicode code points in Swift Swiftè¿›é˜¶ä¹:å­—ç¬¦ä¸² å®Œæ•´çš„Unicodeåœ°å€ iOSæ£€æµ‹å­—ç¬¦ä¸²çš„è¯­è¨€ï¼ˆç”¨äºç¿»è¯‘ä¹‹å‰æ£€æµ‹ï¼‰ Detect Language of NSString è§£å†³å…³äºswiftçš„Array repeating åˆå§‹åŒ–å¤šä¸ªå¯¹è±¡é—®é¢˜ ç®€å†ä¼˜åŒ– iOSå¼€å‘æ±‚èŒè€…ï¼Œå†™ä¸€ä»½æˆåŠŸçš„ç®€å†ï¼Ÿ 7å¹´iOSå¼€å‘ç»éªŒï¼Œæ•™ä½ å†™ä¸€ä»½è„±é¢–è€Œå‡ºçš„ç®€å†ï¼Œè¿›å…¥å¤§å‚æœºä¼šç¿»3å€ï¼ æ€ä¹ˆæ ·åœ¨ç®€å†ä¸­ä½“ç°å‡ºè‡ªå·±çš„èƒ½åŠ›ä¸ä»·å€¼? IOSå¼€å‘å·¥ç¨‹å¸ˆç®€å†èŒƒæ–‡ï¼Œã€å·¥ä½œç»å†+é¡¹ç›®ç»éªŒ+è‡ªæˆ‘è¯„ä»·ã€‘æ€ä¹ˆå†™ iOSé«˜çº§é¢è¯•ç®€å†æŒ‡å¯¼ å›¾ç‰‡ å¤´åƒ è¡¨ CJIABAè¿™ä¸ªç‰Œå­çš„æ‰‹è¡¨ä¸€èˆ¬çš„ä»·æ ¼æ˜¯å¤šå°‘ casio æµªç´efcoæ˜¯ä»€ä¹ˆæ¡£æ¬¡ https://wen.baidu.com/question/1839889959679620900.html Longines æµªç´ tianbo å¤©åšæ‰‹è¡¨ æœºæ¢° wilonæ‰‹è¡¨ æœºæ¢° å¨æ–¯ç™» swatch åŠ³åŠ›å£«ï¼ˆROLEXï¼‰ ç¾æ ¼å°”(MEGIR)æ‰‹è¡¨ moosie rosdn leier fila "},"pages/Git/ç›¸å…³é“¾æ¥.html":{"url":"pages/Git/ç›¸å…³é“¾æ¥.html","title":"ç›¸å…³é“¾æ¥","keywords":"","body":"ç›¸å…³é“¾æ¥ gitå¦‚ä½•åˆ é™¤è¿œç«¯ä¸å­˜åœ¨çš„æœ¬åœ°åˆ†æ”¯ï¼Ÿ å…³äºGitåä½œï¼Œé™¤äº†çŸ¥é“mergeï¼Œä½ å¯èƒ½è¿˜éœ€è¦çŸ¥é“rebase gitå†™é”™åˆ†æ”¯ï¼Œå¦‚ä½•å°†ä¸€ä¸ªåˆ†æ”¯ä¸Šçš„ä¿®æ”¹è½¬ç§»åˆ°å¦ä¸€ä¸ªåˆ†æ”¯ä¸Š Xcodeè¿æ¥git@osc Rebase git rebase è¿˜æ˜¯ mergeçš„ä½¿ç”¨åœºæ™¯æœ€é€šä¿—çš„è§£é‡Š git rebase -iåˆå¹¶å¤šæ¬¡æäº¤ GITä¸Šforkçš„é¡¹ç›®è·å–æœ€æ–°æºä»£ç  Git å‘½ä»¤æ”¶é›† Git åˆ é™¤æŸä¸€æ¬¡æäº¤ Git rebaseåˆå¹¶å¤šæ¡commitè®°å½• git cherry-pick æ•™ç¨‹ git stash ç”¨æ³•æ€»ç»“å’Œæ³¨æ„ç‚¹ "},"pages/Git/rebaseä½¿ç”¨.html":{"url":"pages/Git/rebaseä½¿ç”¨.html","title":"rebaseä½¿ç”¨","keywords":"","body":"rebaseä½¿ç”¨ æŸ¥çœ‹æ—¥å¿— git log --oneline -10 git reflog æ‹‰å–è¿œç¨‹ git fetch team åŸºå˜ git rebase team/feature/v3.7.0 git rebase --continue git rebase -i cea405e6f å¼ºæ¨ git push origin feature/v3.7.0 -f git reflog git cherry-pick a89dbd17f git config --global pull.rebase true "},"pages/C++ç¨‹åºè®¾è®¡/ç¬¬ä¸€ç« _C++è¯­è¨€ç®€ä»‹.html":{"url":"pages/C++ç¨‹åºè®¾è®¡/ç¬¬ä¸€ç« _C++è¯­è¨€ç®€ä»‹.html","title":"ç¬¬ä¸€ç«  C++è¯­è¨€ç®€ä»‹","keywords":"","body":"ç¬¬ä¸€ç«  C++è¯­è¨€ç®€ä»‹ "},"pages/C++ç¨‹åºè®¾è®¡/ç¬¬äºŒç« _é¢å‘å¯¹è±¡çš„åŸºæœ¬æ¦‚å¿µ.html":{"url":"pages/C++ç¨‹åºè®¾è®¡/ç¬¬äºŒç« _é¢å‘å¯¹è±¡çš„åŸºæœ¬æ¦‚å¿µ.html","title":"ç¬¬äºŒç«  é¢å‘å¯¹è±¡çš„åŸºæœ¬æ¦‚å¿µ","keywords":"","body":"ç¬¬äºŒç«  é¢å‘å¯¹è±¡çš„åŸºæœ¬æ¦‚å¿µ "},"pages/C++ç¨‹åºè®¾è®¡/ç¬¬ä¸‰ç« _ç±»å’Œå¯¹è±¡è¿›é˜¶.html":{"url":"pages/C++ç¨‹åºè®¾è®¡/ç¬¬ä¸‰ç« _ç±»å’Œå¯¹è±¡è¿›é˜¶.html","title":"ç¬¬ä¸‰ç«  ç±»å’Œå¯¹è±¡è¿›é˜¶","keywords":"","body":"ç¬¬ä¸‰ç«  ç±»å’Œå¯¹è±¡è¿›é˜¶ "},"pages/C++ç¨‹åºè®¾è®¡/ç¬¬å››ç« _è¿ç®—ç¬¦é‡è½½.html":{"url":"pages/C++ç¨‹åºè®¾è®¡/ç¬¬å››ç« _è¿ç®—ç¬¦é‡è½½.html","title":"ç¬¬å››ç«  è¿ç®—ç¬¦é‡è½½","keywords":"","body":"ç¬¬å››ç«  è¿ç®—ç¬¦é‡è½½ "},"pages/C++ç¨‹åºè®¾è®¡/ç¬¬äº”ç« _ç±»çš„ç»§æ‰¿ä¸æ´¾ç”Ÿ.html":{"url":"pages/C++ç¨‹åºè®¾è®¡/ç¬¬äº”ç« _ç±»çš„ç»§æ‰¿ä¸æ´¾ç”Ÿ.html","title":"ç¬¬äº”ç«  ç±»çš„ç»§æ‰¿ä¸æ´¾ç”Ÿ","keywords":"","body":"ç¬¬äº”ç«  ç±»çš„ç»§æ‰¿ä¸æ´¾ç”Ÿ "},"pages/C++ç¨‹åºè®¾è®¡/ç¬¬å…­ç« _å¤šæ€ä¸è™šå‡½æ•°.html":{"url":"pages/C++ç¨‹åºè®¾è®¡/ç¬¬å…­ç« _å¤šæ€ä¸è™šå‡½æ•°.html","title":"ç¬¬å…­ç«  å¤šæ€ä¸è™šå‡½æ•°","keywords":"","body":"ç¬¬å…­ç«  å¤šæ€ä¸è™šå‡½æ•° "},"pages/C++ç¨‹åºè®¾è®¡/ç¬¬ä¸ƒç« _è¾“å…¥_è¾“å‡ºæµ.html":{"url":"pages/C++ç¨‹åºè®¾è®¡/ç¬¬ä¸ƒç« _è¾“å…¥_è¾“å‡ºæµ.html","title":"ç¬¬ä¸ƒç«  è¾“å…¥/è¾“å‡ºæµ","keywords":"","body":"ç¬¬ä¸ƒç«  è¾“å…¥/è¾“å‡ºæµ "},"pages/C++ç¨‹åºè®¾è®¡/ç¬¬å…«ç« _æ–‡ä»¶æ“ä½œ.html":{"url":"pages/C++ç¨‹åºè®¾è®¡/ç¬¬å…«ç« _æ–‡ä»¶æ“ä½œ.html","title":"ç¬¬å…«ç«  æ–‡ä»¶æ“ä½œ","keywords":"","body":"ç¬¬å…«ç«  æ–‡ä»¶æ“ä½œ "},"pages/C++ç¨‹åºè®¾è®¡/ç¬¬ä¹ç« _å‡½æ•°æ¨¡ç‰ˆä¸ç±»æ¨¡æ¿.html":{"url":"pages/C++ç¨‹åºè®¾è®¡/ç¬¬ä¹ç« _å‡½æ•°æ¨¡ç‰ˆä¸ç±»æ¨¡æ¿.html","title":"ç¬¬ä¹ç«  å‡½æ•°æ¨¡ç‰ˆä¸ç±»æ¨¡æ¿","keywords":"","body":"ç¬¬ä¹ç«  å‡½æ•°æ¨¡ç‰ˆä¸ç±»æ¨¡æ¿ "},"pages/æ—…æ¸¸å®‰æ’/ä¸œæå²›.html":{"url":"pages/æ—…æ¸¸å®‰æ’/ä¸œæå²›.html","title":"ä¸œæå²›","keywords":"","body":"ä¸œæå²› "},"pages/æ¨é€/ç›¸å…³é“¾æ¥.html":{"url":"pages/æ¨é€/ç›¸å…³é“¾æ¥.html","title":"ç›¸å…³é“¾æ¥","keywords":"","body":"ç›¸å…³é“¾æ¥ å®¢æˆ·ç«¯æŠ€æœ¯ï¼šä¸€æ–‡å¸¦ä½ äº†è§£ iOS æ¶ˆæ¯æ¨é€æœºåˆ¶ iOSå¼€å‘â€”â€”iOSé™é»˜æ¨é€ä»‹ç»åŠä½¿ç”¨åœºæ™¯ iOS10 æ¨é€extensionä¹‹ Service Extensionä½ ç©è¿‡äº†å—ï¼Ÿ æå…‰ "},"./":{"url":"./","title":"æœ€è¿‘æ›´æ–°","keywords":"","body":"Macä¸‹MYSQLçš„å®‰è£… ç¯å¢ƒï¼šmacos 11.7.4 ä¸€ã€MYSQLä¸‹è½½ 1ã€è¿›å…¥å®˜ç½‘ï¼Œæ»‘åŠ¨è‡³æœ€ä¸‹æ–¹ï¼Œæ‰¾åˆ°Downloadsï¼Œç‚¹å‡»MySQL Community Serverã€‚2ã€ç‚¹å‡»Archivesï¼Œé€‰æ‹©Product Version:5.7.31ï¼Œé€‰æ‹©Operating System:macOSã€‚3ã€ä¸‹è½½â€œmacOS 10.14 (x86, 64-bit), Compressed TAR Archiveâ€ã€‚4ã€è§£å‹ç¼©ï¼š cd /usr/local/ sudo mkdir src sudo mv ~/Downloads/mysql-5.7.31-macos10.14-x86_64.tar.gz src sudo tar -xzvf mysql-5.7.31-macos10.14-x86_64.tar.gz sudo ln -sf mysql-5.7.31-macos10.14-x86_64 mysql sudo chown -R chenchangqing:staff mysql* äºŒã€é…ç½®ç¯å¢ƒå˜é‡ 1ã€ vi ~/.bash_profileï¼Œåœ¨ ~/.bashrc ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®é¡¹ã€‚ MYSQL_HOME=/usr/local/mysql export PATH=$PATH:$MYSQL_HOME/bin:$MYSQL_HOME/support-files 2ã€source ~/.bash_profileã€‚3ã€mysql --versionã€‚ chenchangqingdeMacBook-Pro-2:sdxy chenchangqing$ mysql --version mysql Ver 14.14 Distrib 5.7.31, for macos10.14 (x86_64) using EditLine wrapper 4ã€é”™è¯¯åˆ†æï¼š dyld: Symbol not found: __ZTTNSt3__118basic_stringstreamIcNS_11char_traitsIcEENS_9allocatorIcEEEE Referenced from: /usr/local/mysql/bin/mysql (which was built for Mac OS X 12.0) Expected in: /usr/lib/libc++.1.dylib in /usr/local/mysql/bin/mysql Abort trap: 6 å¦‚æœå‡ºç°ä»¥ä¸Šé”™è¯¯ï¼Œè¯´æ˜ä¸‹è½½çš„mysqlç‰ˆæœ¬å’Œå½“å‰çš„macosç³»ç»Ÿä¸åŒ¹é…ï¼Œæ¯”å¦‚â€œmacos 11.7.4â€ä¸‹è½½äº†â€œmacOS 13 (x86, 64-bit), Compressed TAR Archiveâ€ï¼Œå°±ä¼šå‡ºç°ä¸Šé¢çš„é”™è¯¯ã€‚ -bash: /usr/local/mysql/bin/mysql: Bad CPU type in executableã€‚ å¦‚æœå‡ºç°ä»¥ä¸Šé”™è¯¯ï¼Œè¯´æ˜ä¸‹è½½çš„mysqlç‰ˆæœ¬ä¸å½“å‰macosç³»ç»Ÿä¸åŒ¹é…CPUæ¶æ„ä¸åŒ¹é…ï¼Œæ¯”å¦‚â€œmacos 11.7.4â€ä¸‹è½½äº†â€œmacOS 12 (ARM, 64-bit), Compressed TAR Archiveâ€ï¼Œå°±ä¼šå‡ºç°ä¸Šé¢çš„é”™è¯¯ã€‚ ä¸‰ã€åˆå§‹åŒ–root chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysqld --initialize-insecure 2023-03-24T17:25:46.055794Z 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details). 2023-03-24T17:25:46.057786Z 0 [Warning] Setting lower_case_table_names=2 because file system for /usr/local/mysql-5.7.31-macos10.14-x86_64/data/ is case insensitive 2023-03-24T17:25:46.237798Z 0 [Warning] InnoDB: New log files created, LSN=45790 2023-03-24T17:25:46.269409Z 0 [Warning] InnoDB: Creating foreign key constraint system tables. 2023-03-24T17:25:46.329085Z 0 [Warning] No existing UUID has been found, so we assume that this is the first time that this server has been started. Generating a new UUID: e99f3ed4-ca68-11ed-b222-0a4a56d116f7. 2023-03-24T17:25:46.340828Z 0 [Warning] Gtid table is not ready to be used. Table 'mysql.gtid_executed' cannot be opened. 2023-03-24T17:25:46.790867Z 0 [Warning] CA certificate ca.pem is self signed. 2023-03-24T17:25:46.937195Z 1 [Warning] root@localhost is created with an empty password ! Please consider switching off the --initialize-insecure option. ä»è¾“å‡ºå¯ä»¥çœ‹åˆ°ï¼Œmysqld å·²ç»å¸®æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª root ç”¨æˆ·ï¼Œä¸”è¯¥ root ç”¨æˆ·çš„ password ä¸ºç©ºã€‚ å››ã€å¯åŠ¨MYSQL chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysql.server start Starting MySQL . SUCCESS! äº”ã€ç™»å½•root chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysql -uroot -p Enter password: Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 2 Server version: 5.7.31 MySQL Community Server (GPL) Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql> å…­ã€ç»™rootç”¨æˆ·åˆ›å»ºå¯†ç  mysql> ALTER USER root@localhost IDENTIFIED WITH caching_sha2_password BY '123456'; -> ; ERROR 1524 (HY000): Plugin 'caching_sha2_password' is not loaded MySQLæ–°ç‰ˆé»˜è®¤ä½¿ç”¨caching_sha2_passwordä½œä¸ºèº«ä»½éªŒè¯æ’ä»¶ï¼Œè€Œæ—§ç‰ˆæ˜¯ä½¿ç”¨mysql_native_passwordã€‚å½“è¿æ¥MySQLæ—¶æŠ¥é”™â€œplugin caching_sha2_password could not be loadedâ€æ—¶ï¼Œå¯æ¢å›æ—§ç‰ˆæ’ä»¶ã€‚ mysql> ALTER USER root@localhost IDENTIFIED WITH mysql_native_password BY '123456'; Query OK, 0 rows affected (0.00 sec) mysql> FLUSH PRIVILEGES; Query OK, 0 rows affected (0.00 sec) mysql> quit Bye ä¸ƒã€å¸¸ç”¨å‘½ä»¤ 1ã€å¯åŠ¨MYSQL chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysql.server start Starting MySQL SUCCESS! 2ã€åœæ­¢MYSQL chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysql.server stop Shutting down MySQL .. SUCCESS! 3ã€é‡å¯MYSQL chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysql.server restart ERROR! MySQL server PID file could not be found! Starting MySQL . SUCCESS! 4ã€æ£€æŸ¥ MySQL è¿è¡ŒçŠ¶æ€ chenchangqingdeMacBook-Pro-2:local chenchangqing$ mysql.server status SUCCESS! MySQL running (1725) å…«ã€å‚è€ƒ https://learnku.com/articles/62379 https://blog.csdn.net/weixin_33728077/article/details/113902283 https://www.cnblogs.com/yjmyzz/p/how-to-install-mysql8-on-mac-using-tar-gz.html å¤‡æ¡ˆå·ï¼š -->æ²ªICPå¤‡2022002183å·-1 "}}